var path = require("path");

/**
 * GET /assets/js/mvc/loginpage/main-loginpage.pack.c671060fbf5f48a63eb447b6598635cc.js
 *
 * host: rain.okta1.com:1802
 * connection: keep-alive
 * user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:48.0) Gecko/20100101 Firefox/48.0
 * accept: * / *
 * accept-encoding: gzip
 * accept-language: en-US
 * cookie: DT=DI00gCQTZFlRa2lC9c1_CUR5A; t=default; JSESSIONID=4803575FC985D74993BDB42BD8194D15
 * cache-control: no-cache, no-store
 * pragma: no-cache
 */

module.exports = function (req, res) {
  res.statusCode = 200;

  res.setHeader("server", "Apache-Coyote/1.1");
  res.setHeader("accept-ranges", "bytes");
  res.setHeader("etag", "W/\"1782172-1502281784000\"");
  res.setHeader("last-modified", "Wed, 09 Aug 2017 12:29:44 GMT");
  res.setHeader("content-type", "text/javascript");
  res.setHeader("content-length", "1782172");
  res.setHeader("date", "Thu, 10 Aug 2017 22:13:22 GMT");

  res.setHeader("x-yakbak-tape", path.basename(__filename, ".js"));

  res.write(new Buffer("dmFyIGluaXRMb2dpblBhZ2UgPQovKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAl2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9OwoKLyoqKioqKi8gCS8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uCi8qKioqKiovIAlmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7CgovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCWlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKQovKioqKioqLyAJCQlyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKCi8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKLyoqKioqKi8gCQl2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCWV4cG9ydHM6IHt9LAovKioqKioqLyAJCQlpZDogbW9kdWxlSWQsCi8qKioqKiovIAkJCWxvYWRlZDogZmFsc2UKLyoqKioqKi8gCQl9OwoKLyoqKioqKi8gCQkvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb24KLyoqKioqKi8gCQltb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTsKCi8qKioqKiovIAkJLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAovKioqKioqLyAJCW1vZHVsZS5sb2FkZWQgPSB0cnVlOwoKLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KCgovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXykKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7CgovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7CgovKioqKioqLyAJLy8gX193ZWJwYWNrX3B1YmxpY19wYXRoX18KLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ucCA9ICIiOwoKLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7Ci8qKioqKiovIH0pCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIChbCi8qIDAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCS8qIGVzbGludCBtYXgtcGFyYW1zOiBbMiwgNl0sIG1heC1zdGF0ZW1lbnRzOiBbMiwgMzBdICovCgkvKiBnbG9iYWwgZ29vZ2xlLCBtb2R1bGUgKi8KCgl2YXIgT2t0YVNpZ25JbiA9IF9fd2VicGFja19yZXF1aXJlX18oMSksCgkgICAgVXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18oMyksCgkgICAgQWNjb3VudENob29zZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKSwKCSAgICBpbml0TW9iaWxlU1NPID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMyksCgkgICAgJCA9IF9fd2VicGFja19yZXF1aXJlX18oNCksCgkgICAgXyA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7CgoJX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoY29uZmlnKSB7CgoJICB2YXIgdXNlcm5hbWU7CgkgIHZhciBpc0Nocm9tZU9zID0gZmFsc2U7CgkgIHZhciBjaHJvbWVPc0FkZCA9ICQuRGVmZXJyZWQoKTsKCSAgdmFyIGNocm9tZU9zQ29tcGxldGUgPSAkLkRlZmVycmVkKCk7CgkgIHZhciB3YWl0Rm9yQ2hyb21lT3NDYWxsYmFjayA9IGZhbHNlOwoKCSAgZnVuY3Rpb24gc3VjY2Vzc0Z1bmMocmVzKSB7CgkgICAgLy8gTW9iaWxlIGFwcCBleHRlbnNpb24KCSAgICBpZiAoY29uZmlnLmlzTW9iaWxlQ2xpZW50TG9naW4pIHsKCSAgICAgIHdpbmRvdy53ZWJraXQubWVzc2FnZUhhbmRsZXJzLmxvZ2luTWVzc2FnZS5wb3N0TWVzc2FnZSh7CgkgICAgICAgIHRva2VuOiByZXMuc2Vzc2lvbi50b2tlbgoJICAgICAgfSk7CgkgICAgICByZXR1cm47CgkgICAgfQoKCSAgICAvLyBTQU1MIFNQLWluaXQ6IFJlcG9zdCBpcyBuZWNlc3NhcnkgYmVjYXVzZSBzb21ldGltZXMgdGhlIHBvc3QgcGFyYW1zIG1ha2UKCSAgICAvLyB0aGUgcmVkaXJlY3RVcmkgdG9vIGxvbmcgKGJyb3dzZXJzIGFjY2VwdCBhcm91bmQgMjAwMCBjaGFycykuCgkgICAgLy8gVGhpcyB3aWxsIG5vIGxvbmdlciBiZSBuZWNlc3Nhcnkgb25jZSB3ZSBzdGFydCBjYWNoaW5nIHRoZSBzYW1sIHBhcmFtcy4KCSAgICBpZiAoY29uZmlnLnJlcG9zdCkgewoJICAgICAgVXRpbC5wb3N0VG9VcmwoY29uZmlnLnNpZ25Jbi5iYXNlVXJsICsgJy9sb2dpbi9zZXNzaW9uQ29va2llUmVkaXJlY3Q/Y2hlY2tBY2NvdW50U2V0dXBDb21wbGV0ZT10cnVlJnJlcG9zdD10cnVlJyArICcmdG9rZW49JyArIGVuY29kZVVSSUNvbXBvbmVudChyZXMuc2Vzc2lvbi50b2tlbikgKwoJICAgICAgLy8gZnJvbVVyaSAocmVsYXRpdmUgdXJsKSBpcyB1c2VkIHJhdGhlciB0aGFuIHJlZGlyZWN0VXJsIChhYnNvbHV0ZSB1cmwpIGJlY2F1c2UKCSAgICAgIC8vIGN1cnJlbnRseSBvbmx5IHJlbGF0aXZlIHVybHMgYXJlIHJlcG9zdGVkIHByb3Blcmx5ICh1c2luZyBmb3J3YXJkKQoJICAgICAgJyZyZWRpcmVjdFVybD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGNvbmZpZy5mcm9tVXJpKSwgJCgnYm9keScpKTsKCSAgICAgIHJldHVybjsKCSAgICB9CgoJICAgIC8vIE9LVEEtMTAyMjE3IEhBQ0sgdG8gZml4IG5ldyByZWxlYXNlIG9mIE1pY3Jvc29mdCBhcHBzIGZvciBpT1MgMTAsIHdoaWNoIHRyaWdnZXIgZG91YmxlIHJlcXVlc3QgdG8gdGhpcyBVUkwKCSAgICAvL2lmIChVdGlsLnVzZXJBZ2VudElzSW9zMTAobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHsKCSAgICBpZiAoY29uZmlnLmF2b2lkRG91YmxlUmVxdWVzdE1TSW9zQXBwICYmIFV0aWwudXNlckFnZW50SXNJb3MxMChuYXZpZ2F0b3IudXNlckFnZW50KSkgewoJICAgICAgaGFja1JlZGlyZWN0V2l0aFBvcnRBZGRlZE9yUmVtb3ZlZChyZXMpOwoJICAgICAgcmV0dXJuOwoJICAgIH0KCgkgICAgLy8gTm9ybWFsIGZsb3c6IE5hdmlnYXRlIHRvIHRoZSBzZXNzaW9uQ29va2llUmVkaXJlY3QgZW5kcG9pbnQKCSAgICByZXMuc2Vzc2lvbi5zZXRDb29raWVBbmRSZWRpcmVjdChjb25maWcucmVkaXJlY3RVcmkpOwoJICB9CgoJICBmdW5jdGlvbiBoYWNrUmVkaXJlY3RXaXRoUG9ydEFkZGVkT3JSZW1vdmVkKHJlcykgewoJICAgIC8vIEhhY2sgaGVyZSBpcyB0byBhcHBlbmQgOjgwIG9yIDo0NDMgdG8gYmFzZVVybCAob3IgcmVtb3ZlIGl0KSBhbmQgcmVkaXJlY3QgdG8gdGhhdCBiYXNlIFVSTC4KCSAgICAvLyBGb3Igc29tZSByZWFzb24sIHRoaXMgcHJldmVudHMgdGhlIGRvdWJsZSByZXF1ZXN0IGNhdXNlZCBieSBNaWNyb3NvZnQgYXBwcyBmb3IgaU9TIDEwIHdoaWNoIGludmFsaWRhdGVzIHRoZSBPVFQKCSAgICB2YXIgaGFja0hvc3RuYW1lVXJsID0gVXRpbC5iYXNlVXJsV2l0aFBvcnRBZGRlZE9yUmVtb3ZlZChjb25maWcuc2lnbkluLmJhc2VVcmwpOwoKCSAgICAvLyBVUkwgY29uc3RydWN0aW9uIGxvZ2ljIGNvdXJ0ZXN5IG9mIHNldENvb2tpZUFuZFJlZGlyZWN0KCkncyBpbXBsCgkgICAgLy8gQXBwZW5kaW5nICdtb2RpZmllZEJhc2VVcmw9dHJ1ZScgZm9yIHRyYWNraW5nIHB1cnBvc2VzCgkgICAgdmFyIHF1ZXJ5UGFyYW1zID0gVXRpbC50b1F1ZXJ5UGFyYW1zKHsKCSAgICAgICdjaGVja0FjY291bnRTZXR1cENvbXBsZXRlJzogdHJ1ZSwKCSAgICAgICd0b2tlbic6IHJlcy5zZXNzaW9uLnRva2VuLAoJICAgICAgJ3JlZGlyZWN0VXJsJzogY29uZmlnLnJlZGlyZWN0VXJpLAoJICAgICAgJ21vZGlmaWVkQmFzZVVybCc6IHRydWUgfSk7CgkgICAgdmFyIGhhY2tSZWRpcmVjdFVybCA9IGhhY2tIb3N0bmFtZVVybCArICcvbG9naW4vc2Vzc2lvbkNvb2tpZVJlZGlyZWN0JyArIHF1ZXJ5UGFyYW1zOwoKCSAgICB3aW5kb3cubG9jYXRpb24gPSBoYWNrUmVkaXJlY3RVcmw7CgkgIH0KCgkgIGZ1bmN0aW9uIG5vdGlmeUFjY291bnRDaG9vc2VyKHJlcywgYWNjb3VudENob29zZXIpIHsKCSAgICB2YXIgc3VjY2VzcyA9IF8ucGFydGlhbChzdWNjZXNzRnVuYywgcmVzKTsKCSAgICBpZiAoYWNjb3VudENob29zZXIpIHsKCSAgICAgIGFjY291bnRDaG9vc2VyLmxvZ2luKHJlcy51c2VyLnByb2ZpbGUsIHN1Y2Nlc3MpOwoJICAgIH0gZWxzZSB7CgkgICAgICAvLyBFTkdfQUNDT1VOVF9DSE9PU0VSX1BVQkxJU0ggZmVhdHVyZSBpcyBub3QgZW5hYmxlZCAtIHBlcmZvcm0gc3VjY2VzcwoJICAgICAgLy8gYWN0aW9ucyBpbW1lZGlhdGVseS4KCSAgICAgIHN1Y2Nlc3MoKTsKCSAgICB9CgkgIH0KCgkgIGZ1bmN0aW9uIHByb2Nlc3NDcmVkcyhjcmVkcykgewoJICAgIGlmICghaXNDaHJvbWVPcykgewoJICAgICAgcmV0dXJuOwoJICAgIH0KCSAgICB1c2VybmFtZSA9IGNyZWRzLnVzZXJuYW1lOwoJICAgIHZhciBkZXRhaWxzID0gewoJICAgICAgdG9rZW46IGNyZWRzLnVzZXJuYW1lLAoJICAgICAgdXNlcjogY3JlZHMudXNlcm5hbWUsCgkgICAgICBwYXNzd29yZEJ5dGVzOiBjcmVkcy5wYXNzd29yZCwKCSAgICAgIGtleVR5cGU6ICdLRVlfVFlQRV9QQVNTV09SRF9QTEFJTicKCSAgICB9OwoJICAgIGlmIChjaHJvbWVPc0FkZC5zdGF0ZSgpICE9PSAncGVuZGluZycpIHsKCSAgICAgIGNocm9tZU9zQWRkID0gJC5EZWZlcnJlZCgpOwoJICAgIH0KCSAgICB3YWl0Rm9yQ2hyb21lT3NDYWxsYmFjayA9IHRydWU7CgkgICAgZ29vZ2xlLnByaW5jaXBhbC5hZGQoZGV0YWlscywgZnVuY3Rpb24gKCkgewoJICAgICAgY2hyb21lT3NBZGQucmVzb2x2ZSgpOwoJICAgIH0pOwoJICB9CgoJICAvLyBUaGlzIHByZXZlbnRzIGFuIGVtcHR5IGN1c3RvbSBrZXkgdGhhdCBjb21lIGluIGZyb20gdGhlIGFkbWluIGN1c3RvbWl6YXRpb24KCSAgLy8gZnJvbSBvdmVycmlkaW5nIGEgbG9jYWxpemVkIGxvZ2luIGtleS4KCSAgdmFyIG92ZXJyaWRlcyA9IGNvbmZpZy5zaWduSW4uaTE4bltjb25maWcuc2lnbkluLmxhbmd1YWdlXTsKCSAgXy5lYWNoKG92ZXJyaWRlcywgZnVuY3Rpb24gKHZhbHVlLCBsYWJlbCkgewoJICAgIGlmICghdmFsdWUpIHsKCSAgICAgIGRlbGV0ZSBvdmVycmlkZXNbbGFiZWxdOwoJICAgIH0KCSAgfSk7CgoJICBjb25maWcuc2lnbkluLmFzc2V0cy5yZXdyaXRlID0gVXRpbC5hc3NldFJld3JpdGU7CgoJICBjb25maWcuc2lnbkluLmZlYXR1cmVzLnJvdXRlciA9IFV0aWwuc3VwcG9ydHNSb3V0ZXIoKTsKCgkgIHZhciBhY2NvdW50Q2hvb3NlcjsKCSAgaWYgKGNvbmZpZy5wdWJsaXNoVG9BY2NvdW50Q2hvb3NlcikgewoJICAgIGFjY291bnRDaG9vc2VyID0gbmV3IEFjY291bnRDaG9vc2VyKHsKCSAgICAgIGRpc2NvdmVyeVVybDogY29uZmlnLmFjY291bnRDaG9vc2VyRGlzY292ZXJ5VXJsCgkgICAgfSk7CgkgIH0KCgkgIC8qIGVzbGludCBjb21wbGV4aXR5OiBbMiwgOF0qLwoJICBpZiAoY29uZmlnLmVuYWJsZVVybEZpeEZvckVtYmVkZGVkQnJvd3NlcnMgJiYgVXRpbC5pc0xvZ2luVXJsU3RhbGUoY29uZmlnLmxvZ2luUGFnZVVybFJlZGlyZWN0LCBsb2NhdGlvbi5ocmVmKSkgewoJICAgIC8vRm9yIGNlcnRhaW4gZW1iZWRkZWQgYnJvd3NlcnMgKGFkb2JlIGFpcikgd2hpbGUgbG9hZGluZyB0aGUgbG9naW4gcGFnZSBhZnRlciBhIDMwMiByZWRpcmVjdGlvbiBmb3IKCSAgICAvL25vbi1sb2dnZWQgaW4gdXNlcnMsIHRoZSBwcm9ibGVtIGlzIHRoYXQgdGhlIHdpbmRvdy5sb2NhdGlvbiBvYmplY3QgKHdoaWNoIGhvbGRzIGF0dHJpYnV0ZWQgbGlrZSBocmVmLAoJICAgIC8vcGF0aG5hbWUgYW5kIHNlYXJjaCkgaXMgZGlmZmVyZW50IGNvbXBhcmVkIHRvIHRoYXQgb24gdGhlIGJyb3dzZXIuCgkgICAgLy9IZW5jZSB0aGUgbG9jYXRpb24uaHJlZiBuZWVkcyB0byBiZSBhZGp1c3RlZCB0byBpbmNsdWRlIHRoZSBmdWxsIGZyb21VUkkgdmFsdWUKCSAgICAvL3NvIHRoYXQgdGhlIHJvdXRpbmcgd29ya3MgY29ycmVjdGx5Lk9LVEEtMTA5MTQxCgkgICAgVXRpbC5hZGp1c3RVcmxQYXRoKGNvbmZpZy5sb2dpblBhZ2VVcmxSZWRpcmVjdCk7CgkgIH0KCgkgIHZhciBva3RhU2lnbkluID0gbmV3IE9rdGFTaWduSW4oY29uZmlnLnNpZ25Jbik7CgkgIG9rdGFTaWduSW4ucmVuZGVyRWwoewoJICAgIGVsOiBjb25maWcuc2lnbkluLmVsLAoJICAgIHByb2Nlc3NDcmVkczogcHJvY2Vzc0NyZWRzCgkgIH0sIGZ1bmN0aW9uIChyZXMpIHsKCSAgICAvLyBPa3RhIGxvZ2luIHBhZ2UgZG9lcyBub3QgY2FyZSBhYm91dCBub24tc3VjY2VzcyByZXNwb25zZXMKCSAgICBpZiAocmVzLnN0YXR1cyAhPT0gJ1NVQ0NFU1MnKSB7CgkgICAgICByZXR1cm47CgkgICAgfQoKCSAgICAvKgoJICAgICAqIEZvciBpbmZvIG9uIHdhaXRGb3JDaHJvbWVPc0NhbGxiYWNrLCBsb29rIGF0IE9LVEEtMTI3MzUzLgoJICAgICAqIElmIHNpZ24gaW4gd2lkZ2V0IHdhcyBsb2FkZWQgb24gYSBjaHJvbWUgZGV2aWNlIGRpcmVjdGx5IG9uIE1GQSBwYWdlLCBwcm9jZXNzIGNyZWRzIHdpbGwgbm90IGJlIGNhbGxlZC4KCSAgICAgKiBDaGVjayBpZiBpdCBoYXMgYmVlbiBjYWxsZWQgYW5kIG9ubHkgdGhlbiBnbyB0aHJvdWdoIHRoaXMgYmxvY2suCgkgICAgICovCgkgICAgaWYgKGNvbmZpZy5oYXNDaHJvbWVPU0ZlYXR1cmUgJiYgaXNDaHJvbWVPcyAmJiB3YWl0Rm9yQ2hyb21lT3NDYWxsYmFjaykgewoJICAgICAgJC53aGVuKGNocm9tZU9zQWRkKS50aGVuKGZ1bmN0aW9uICgpIHsKCSAgICAgICAgZ29vZ2xlLnByaW5jaXBhbC5jb21wbGV0ZSh7IHRva2VuOiB1c2VybmFtZSB9LCBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgY2hyb21lT3NDb21wbGV0ZS5yZXNvbHZlKCk7CgkgICAgICAgIH0pOwoJICAgICAgfSk7CgkgICAgICAkLndoZW4oY2hyb21lT3NBZGQsIGNocm9tZU9zQ29tcGxldGUpLnRoZW4oZnVuY3Rpb24gKCkgewoJICAgICAgICBub3RpZnlBY2NvdW50Q2hvb3NlcihyZXMsIGFjY291bnRDaG9vc2VyKTsKCSAgICAgIH0pOwoJICAgIH0gZWxzZSB7CgkgICAgICBub3RpZnlBY2NvdW50Q2hvb3NlcihyZXMsIGFjY291bnRDaG9vc2VyKTsKCSAgICB9CgkgIH0pOwoKCSAgVXRpbC5jbGVhckJlZW5Ub0hvbWVQYWdlKCk7CgkgIFV0aWwucmVzZXRBdXRvTGF1bmNoKCk7CgoJICBpZiAoY29uZmlnLmlzTW9iaWxlU1NPKSB7CgkgICAgaW5pdE1vYmlsZVNTTyhjb25maWcucmVkaXJlY3RVcmksIGNvbmZpZy5saW5rUGFyYW1zKTsKCSAgfQoKCSAgaWYgKGNvbmZpZy5oYXNDaHJvbWVPU0ZlYXR1cmUpIHsKCSAgICBnb29nbGUgJiYgZ29vZ2xlLnByaW5jaXBhbC5pbml0aWFsaXplKGZ1bmN0aW9uICgpIHsKCSAgICAgIGlzQ2hyb21lT3MgPSB0cnVlOwoJICAgIH0pOwoJICB9CgoJICBpZiAoY29uZmlnLnNob3dMaW5rVG9BcHBTdG9yZSkgewoJICAgICQuc21hcnRiYW5uZXIoeyAndGl0bGUnOiAnT2t0YSBNb2JpbGUnLCAnYXV0aG9yJzogJ09rdGEsIEluYy4nIH0pOwoJICB9CgkgIC8vIFRvIGRpc2FibGUgdGhlIHZhcmlvdXMgYnJvd3NlcnMnIG1lY2hhbmlzbXMgZm9yIHNhdmluZyBwYXNzd29yZHMsIHdlIGRvIHRoaXM6CgkgIC8vIFRoZSBzaWduLWluIHdpZGdldCBzZXRzIG9mZiBhIHRyaWdnZXIgb25jZSB0aGUgcHJpbWFyeSBhdXRoIC8gcmVzZXQgcGFzc3dvcmQgZm9ybSBpcyBsb2FkZWQKCSAgLy8gV2UgY2FwdHVyZSB0aGUgZXZlbnQgaGVyZSBhbmQgYWRkIGJyb3dzZXIgc3BlY2lmaWMgcGFzc3dvcmQgamFtbWVycyBhcyBiZWxvdzoKCSAgLy8gMSkgU2FmYXJpIHJlcXVpcmVzIGFuIGVtcHR5IGV4dHJhIHBhc3N3b3JkIGZpZWxkIGF0IHRoZSB0b3AsCgkgIC8vICAgIHdoaWNoIGlzICJ2aXNpYmxlIiBhbmQgb24gdGhlIHNjcmVlbi4gV2UgZ2V0IGFyb3VuZCB0aGlzIHdpdGggaW5qZWN0aW5nCgkgIC8vICAgIGVsZW1lbnRzIHdpdGggd2lkdGggYW5kIGhlaWdodCBlcXVhbCB0byB6ZXJvCgkgIC8vIDIpIEZpcmVmb3ggcmVxdWlyZXMgZXh0cmEgYm9ndXMgZmlsbGVkIHBhc3N3b3JkIGVsZW1lbnRzCgkgIC8vIDMpIENocm9tZSBsb29rcyBmb3IgYSBwYXNzd29yZCBmaWVsZHMgYW5kIGEgbmVhcmVzdCB0ZXh0CgkgIC8vICAgIGZpZWxkIHRvIGRldGVjdCB1c2VybmFtZS1wYXNzd29yZCBwYWlyLiBXZSBnZXQKCSAgLy8gICAgYXJvdW5kIHRoaXMgYnkgYWRkaW5nIGFkZGl0aW9uYWwgdXNlcm5hbWUtcGFzc3dvcmQgcGFpcnMKCSAgLy8gICAgdG8gdHJpY2sgdGhlIGJyb3dzZXIuCgkgIC8vICAgIEFkZGl0aW9uYWxseSwgY2hyb21lIHJlcXVpcmVzIHRoZSBhZGRpdGlvbmFsIGVsZW1lbnRzIHRvCgkgIC8vICAgIGJlIHByZXBlbmRlZAoJICAvLyA0KSBUT0RPOiBPdGhlciBicm93c2VycyAoSUUpCgoJICBpZiAoY29uZmlnLnByZXZlbnRCcm93c2VyRnJvbVNhdmluZ09rdGFQYXNzd29yZCkgewoJICAgIG9rdGFTaWduSW4ub24oJ3BhZ2VSZW5kZXJlZCcsIGZ1bmN0aW9uICgpIHsKCSAgICAgIC8vIE9uY2UgcGFnZSBpcyByZW5kZXJlZCwgYWRkIHBhc3N3b3JkIGphbW1lcnMgaWYgcGFzc3dvcmQgaW5wdXRzCgkgICAgICAvLyBhcmUgcHJlc2VudCBvbiB0aGUgcmVuZGVyZWQgcGFnZQoJICAgICAgdmFyIHBhc3N3b3JkRmllbGRzID0gJCgnI29rdGEtc2lnbi1pbiA6cGFzc3dvcmQnKTsKCSAgICAgIGlmIChwYXNzd29yZEZpZWxkcy5sZW5ndGggPiAwKSB7CgkgICAgICAgIFV0aWwuYWRkUGFzc3dvcmRKYW1tZXJzKCQoJyNva3RhLXNpZ24taW4gZm9ybScpKTsKCSAgICAgIH0KCSAgICB9KTsKCSAgfQoJfTsKCi8qKiovIH0sCi8qIDEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyohCgkgKiBDb3B5cmlnaHQgKGMpIDIwMTUtMjAxNiwgT2t0YSwgSW5jLiBhbmQvb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCgkgKiBUaGUgT2t0YSBzb2Z0d2FyZSBhY2NvbXBhbmllZCBieSB0aGlzIG5vdGljZSBpcyBwcm92aWRlZCBwdXJzdWFudCB0byB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UuIikKCSAqIAoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMC4KCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQKCSAqIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIAoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqIAoJICovCgkhZnVuY3Rpb24odCxlKXsgdHJ1ZT9tb2R1bGUuZXhwb3J0cz1lKF9fd2VicGFja19yZXF1aXJlX18oMikpOiJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFsianF1ZXJ5Il0sZSk6Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzP2V4cG9ydHMuT2t0YVNpZ25Jbj1lKHJlcXVpcmUoImpxdWVyeSIpKTp0Lk9rdGFTaWduSW49ZSh0LmpRdWVyeSl9KHRoaXMsZnVuY3Rpb24oX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV82X18pe3JldHVybiBmdW5jdGlvbih0KXtmdW5jdGlvbiBlKG4pe2lmKGlbbl0pcmV0dXJuIGlbbl0uZXhwb3J0czt2YXIgcj1pW25dPXtleHBvcnRzOnt9LGlkOm4sbG9hZGVkOiExfTtyZXR1cm4gdFtuXS5jYWxsKHIuZXhwb3J0cyxyLHIuZXhwb3J0cyxlKSxyLmxvYWRlZD0hMCxyLmV4cG9ydHN9dmFyIGk9e307cmV0dXJuIGUubT10LGUuYz1pLGUucD0iIixlKDApfShbZnVuY3Rpb24odCxlLGkpe3ZhciBuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUsaSxuKXtmdW5jdGlvbiBzKGUpe3Quc2Vzc2lvbi5leGlzdHMoKS50aGVuKGUpfWZ1bmN0aW9uIG8oZSl7dC5zZXNzaW9uLmNsb3NlKCkudGhlbihlKS5mYWlsKGZ1bmN0aW9uKCl7ZSgiVGhlcmUgd2FzIGEgcHJvYmxlbSBjbG9zaW5nIHRoZSBzZXNzaW9uIil9KX1mdW5jdGlvbiBhKGUpe3Quc2Vzc2lvbi5yZWZyZXNoKCkudGhlbihlKS5mYWlsKGZ1bmN0aW9uKCl7ZSh7c3RhdHVzOiJJTkFDVElWRSJ9KX0pfWZ1bmN0aW9uIGwoZSxpLG4pe3QuaWRUb2tlbi5yZWZyZXNoKG4pLnRoZW4oaSkuZmFpbChmdW5jdGlvbigpe2koIlRoZXJlIHdhcyBhIHByb2JsZW0gcmVmcmVzaGluZyB0aGUgaWRfdG9rZW4iKX0pfWZ1bmN0aW9uIGMoZSl7dC5zZXNzaW9uLmdldCgpLnRoZW4oZnVuY3Rpb24odCl7IkFDVElWRSI9PT10LnN0YXR1cyYmdC51c2VyJiYodC51c2VyPXIucGljayh0LnVzZXIsImlkIiwicHJvZmlsZSIsInBhc3N3b3JkQ2hhbmdlZCIpKSxlKHQpfSl9ZnVuY3Rpb24gdShpLHMsbyl7aWYoXyl0aHJvdyJBbiBpbnN0YW5jZSBvZiB0aGUgd2lkZ2V0IGhhcyBhbHJlYWR5IGJlZW4gcmVuZGVyZWQuIENhbGwgcmVtb3ZlKCkgZmlyc3QuIjtfPW5ldyBlKHIuZXh0ZW5kKHt9LG4saSx7YXV0aENsaWVudDp0LGdsb2JhbFN1Y2Nlc3NGbjpzLGdsb2JhbEVycm9yRm46b30pKSxfLnN0YXJ0KCl9ZnVuY3Rpb24gZCgpe18mJl8uaGlkZSgpfWZ1bmN0aW9uIGgoKXtfJiZfLnNob3coKX1mdW5jdGlvbiBwKCl7XyYmKF8ucmVtb3ZlKCksXz12b2lkIDApfWZ1bmN0aW9uIGYoKXtyZXR1cm4gaS5oYXNUb2tlbnNJbkhhc2god2luZG93LmxvY2F0aW9uLmhhc2gpfWZ1bmN0aW9uIG0oZSxpKXt0LnRva2VuLnBhcnNlRnJvbVVybCgpLnRoZW4oZSkuZmFpbChpKX12YXIgXztyZXR1cm57cmVuZGVyRWw6dSxzaWduT3V0Om8saWRUb2tlbjp7cmVmcmVzaDpsfSxzZXNzaW9uOntjbG9zZTpvLGV4aXN0czpzLGdldDpjLHJlZnJlc2g6YX0sdG9rZW46e2hhc1Rva2Vuc0luVXJsOmYscGFyc2VUb2tlbnNGcm9tVXJsOm19LHRva2VuTWFuYWdlcjp0LnRva2VuTWFuYWdlcixoaWRlOmQsc2hvdzpoLHJlbW92ZTpwfX1mdW5jdGlvbiBlKGUpe3ZhciBzLG8sYSxsO2koMiksaSg0KSxpKDUpLHM9aSg4KSxvPWkoMzEpLGw9aSgyOTApLGE9bmV3IHMoe3VybDplLmJhc2VVcmwsdHJhbnNmb3JtRXJyb3JYSFI6by50cmFuc2Zvcm1FcnJvclhIUixoZWFkZXJzOnsiWC1Pa3RhLVVzZXItQWdlbnQtRXh0ZW5kZWQiOiJva3RhLXNpZ25pbi13aWRnZXQtIituLnZlcnNpb259LGNsaWVudElkOmUuY2xpZW50SWQscmVkaXJlY3RVcmk6ZS5yZWRpcmVjdFVyaX0pLHIuZXh0ZW5kKHRoaXMsbC5wcm90b3R5cGUuRXZlbnRzLHQoYSxsLG8sZSkpLHRoaXMubGlzdGVuVG8obC5wcm90b3R5cGUsImFsbCIsdGhpcy50cmlnZ2VyKX12YXIgbj1pKDEpLHI9aSgyKTtyZXR1cm4gZX0oKTt0LmV4cG9ydHM9bn0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9e3ZlcnNpb246IjIuMS4wIixzdXBwb3J0ZWRMYW5ndWFnZXM6WyJlbiIsImNzIiwiZGEiLCJkZSIsImVzIiwiZmkiLCJmciIsImh1IiwiaWQiLCJpbiIsIml0IiwiamEiLCJrbyIsIm1zIiwibmwtTkwiLCJwbCIsInB0LUJSIiwicm8iLCJydSIsInN2IiwidGgiLCJ1ayIsInpoLUNOIiwiemgtVFciXX19LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMyksaSg0KV0scj1mdW5jdGlvbih0LGUpe3ZhciBpPXQubm9Db25mbGljdCgpO3JldHVybiBpLm1peGluKHtyZXN1bHRDdHg6ZnVuY3Rpb24odCxlLG4scil7dmFyIHM9aS5pc09iamVjdCh0KT90W2VdOnZvaWQgMDtyZXR1cm4gaS5pc0Z1bmN0aW9uKHMpJiYocz1zLmNhbGwobnx8dCkpLHM/czppLmlzVW5kZWZpbmVkKHIpP3M6cn0saXNJbnRlZ2VyOmZ1bmN0aW9uKHQpe3JldHVybiBpLmlzTnVtYmVyKHQpJiZ0JTE9PT0wfSx0ZW1wbGF0ZTpmdW5jdGlvbih0LGkpe3ZhciBuPWUuY29tcGlsZSh0KTtyZXR1cm4gaT9uKGkpOmZ1bmN0aW9uKHQpe3JldHVybiBuKHQpfX19KSxpfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyOy8vICAgICBVbmRlcnNjb3JlLmpzIDEuOC4zCgkvLyAgICAgKGMpIDIwMDktMjAxNSBKZXJlbXkgQXNoa2VuYXMsIERvY3VtZW50Q2xvdWQgYW5kIEludmVzdGlnYXRpdmUgUmVwb3J0ZXJzICYgRWRpdG9ycwoJLy8gICAgIFVuZGVyc2NvcmUgbWF5IGJlIGZyZWVseSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuCgkoZnVuY3Rpb24oKXtmdW5jdGlvbiBpKHQpe2Z1bmN0aW9uIGUoZSxpLG4scixzLG8pe2Zvcig7cz49MCYmczxvO3MrPXQpe3ZhciBhPXI/cltzXTpzO249aShuLGVbYV0sYSxlKX1yZXR1cm4gbn1yZXR1cm4gZnVuY3Rpb24oaSxuLHIscyl7bj1rKG4scyw0KTt2YXIgbz0hWShpKSYmTS5rZXlzKGkpLGE9KG98fGkpLmxlbmd0aCxsPXQ+MD8wOmEtMTtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aDwzJiYocj1pW28/b1tsXTpsXSxsKz10KSxlKGksbixyLG8sbCxhKX19ZnVuY3Rpb24gcyh0KXtyZXR1cm4gZnVuY3Rpb24oZSxpLG4pe2k9VChpLG4pO2Zvcih2YXIgcj1EKGUpLHM9dD4wPzA6ci0xO3M+PTAmJnM8cjtzKz10KWlmKGkoZVtzXSxzLGUpKXJldHVybiBzO3JldHVybi0xfX1mdW5jdGlvbiBvKHQsZSxpKXtyZXR1cm4gZnVuY3Rpb24obixyLHMpe3ZhciBvPTAsYT1EKG4pO2lmKCJudW1iZXIiPT10eXBlb2Ygcyl0PjA/bz1zPj0wP3M6TWF0aC5tYXgocythLG8pOmE9cz49MD9NYXRoLm1pbihzKzEsYSk6cythKzE7ZWxzZSBpZihpJiZzJiZhKXJldHVybiBzPWkobixyKSxuW3NdPT09cj9zOi0xO2lmKHIhPT1yKXJldHVybiBzPWUoZi5jYWxsKG4sbyxhKSxNLmlzTmFOKSxzPj0wP3MrbzotMTtmb3Iocz10PjA/bzphLTE7cz49MCYmczxhO3MrPXQpaWYobltzXT09PXIpcmV0dXJuIHM7cmV0dXJuLTF9fWZ1bmN0aW9uIGEodCxlKXt2YXIgaT1JLmxlbmd0aCxuPXQuY29uc3RydWN0b3Iscj1NLmlzRnVuY3Rpb24obikmJm4ucHJvdG90eXBlfHxkLHM9ImNvbnN0cnVjdG9yIjtmb3IoTS5oYXModCxzKSYmIU0uY29udGFpbnMoZSxzKSYmZS5wdXNoKHMpO2ktLTspcz1JW2ldLHMgaW4gdCYmdFtzXSE9PXJbc10mJiFNLmNvbnRhaW5zKGUscykmJmUucHVzaChzKX12YXIgbD10aGlzLGM9bC5fLHU9QXJyYXkucHJvdG90eXBlLGQ9T2JqZWN0LnByb3RvdHlwZSxoPUZ1bmN0aW9uLnByb3RvdHlwZSxwPXUucHVzaCxmPXUuc2xpY2UsbT1kLnRvU3RyaW5nLF89ZC5oYXNPd25Qcm9wZXJ0eSxnPUFycmF5LmlzQXJyYXksdj1PYmplY3Qua2V5cyx5PWguYmluZCxiPU9iamVjdC5jcmVhdGUsdz1mdW5jdGlvbigpe30sTT1mdW5jdGlvbih0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIE0/dDp0aGlzIGluc3RhbmNlb2YgTT92b2lkKHRoaXMuX3dyYXBwZWQ9dCk6bmV3IE0odCl9OyJ1bmRlZmluZWQiIT10eXBlb2YgdCYmdC5leHBvcnRzJiYoZT10LmV4cG9ydHM9TSksZS5fPU0sTS5WRVJTSU9OPSIxLjguMyI7dmFyIGs9ZnVuY3Rpb24odCxlLGkpe2lmKHZvaWQgMD09PWUpcmV0dXJuIHQ7c3dpdGNoKG51bGw9PWk/MzppKXtjYXNlIDE6cmV0dXJuIGZ1bmN0aW9uKGkpe3JldHVybiB0LmNhbGwoZSxpKX07Y2FzZSAyOnJldHVybiBmdW5jdGlvbihpLG4pe3JldHVybiB0LmNhbGwoZSxpLG4pfTtjYXNlIDM6cmV0dXJuIGZ1bmN0aW9uKGksbixyKXtyZXR1cm4gdC5jYWxsKGUsaSxuLHIpfTtjYXNlIDQ6cmV0dXJuIGZ1bmN0aW9uKGksbixyLHMpe3JldHVybiB0LmNhbGwoZSxpLG4scixzKX19cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQuYXBwbHkoZSxhcmd1bWVudHMpfX0sVD1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIG51bGw9PXQ/TS5pZGVudGl0eTpNLmlzRnVuY3Rpb24odCk/ayh0LGUsaSk6TS5pc09iamVjdCh0KT9NLm1hdGNoZXIodCk6TS5wcm9wZXJ0eSh0KX07TS5pdGVyYXRlZT1mdW5jdGlvbih0LGUpe3JldHVybiBUKHQsZSwxLzApfTt2YXIgUz1mdW5jdGlvbih0LGUpe3JldHVybiBmdW5jdGlvbihpKXt2YXIgbj1hcmd1bWVudHMubGVuZ3RoO2lmKG48Mnx8bnVsbD09aSlyZXR1cm4gaTtmb3IodmFyIHI9MTtyPG47cisrKWZvcih2YXIgcz1hcmd1bWVudHNbcl0sbz10KHMpLGE9by5sZW5ndGgsbD0wO2w8YTtsKyspe3ZhciBjPW9bbF07ZSYmdm9pZCAwIT09aVtjXXx8KGlbY109c1tjXSl9cmV0dXJuIGl9fSxMPWZ1bmN0aW9uKHQpe2lmKCFNLmlzT2JqZWN0KHQpKXJldHVybnt9O2lmKGIpcmV0dXJuIGIodCk7dy5wcm90b3R5cGU9dDt2YXIgZT1uZXcgdztyZXR1cm4gdy5wcm90b3R5cGU9bnVsbCxlfSx4PWZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZT92b2lkIDA6ZVt0XX19LEU9TWF0aC5wb3coMiw1MyktMSxEPXgoImxlbmd0aCIpLFk9ZnVuY3Rpb24odCl7dmFyIGU9RCh0KTtyZXR1cm4ibnVtYmVyIj09dHlwZW9mIGUmJmU+PTAmJmU8PUV9O00uZWFjaD1NLmZvckVhY2g9ZnVuY3Rpb24odCxlLGkpe2U9ayhlLGkpO3ZhciBuLHI7aWYoWSh0KSlmb3Iobj0wLHI9dC5sZW5ndGg7bjxyO24rKyllKHRbbl0sbix0KTtlbHNle3ZhciBzPU0ua2V5cyh0KTtmb3Iobj0wLHI9cy5sZW5ndGg7bjxyO24rKyllKHRbc1tuXV0sc1tuXSx0KX1yZXR1cm4gdH0sTS5tYXA9TS5jb2xsZWN0PWZ1bmN0aW9uKHQsZSxpKXtlPVQoZSxpKTtmb3IodmFyIG49IVkodCkmJk0ua2V5cyh0KSxyPShufHx0KS5sZW5ndGgscz1BcnJheShyKSxvPTA7bzxyO28rKyl7dmFyIGE9bj9uW29dOm87c1tvXT1lKHRbYV0sYSx0KX1yZXR1cm4gc30sTS5yZWR1Y2U9TS5mb2xkbD1NLmluamVjdD1pKDEpLE0ucmVkdWNlUmlnaHQ9TS5mb2xkcj1pKC0xKSxNLmZpbmQ9TS5kZXRlY3Q9ZnVuY3Rpb24odCxlLGkpe3ZhciBuO2lmKG49WSh0KT9NLmZpbmRJbmRleCh0LGUsaSk6TS5maW5kS2V5KHQsZSxpKSx2b2lkIDAhPT1uJiZuIT09LTEpcmV0dXJuIHRbbl19LE0uZmlsdGVyPU0uc2VsZWN0PWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1bXTtyZXR1cm4gZT1UKGUsaSksTS5lYWNoKHQsZnVuY3Rpb24odCxpLHIpe2UodCxpLHIpJiZuLnB1c2godCl9KSxufSxNLnJlamVjdD1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIE0uZmlsdGVyKHQsTS5uZWdhdGUoVChlKSksaSl9LE0uZXZlcnk9TS5hbGw9ZnVuY3Rpb24odCxlLGkpe2U9VChlLGkpO2Zvcih2YXIgbj0hWSh0KSYmTS5rZXlzKHQpLHI9KG58fHQpLmxlbmd0aCxzPTA7czxyO3MrKyl7dmFyIG89bj9uW3NdOnM7aWYoIWUodFtvXSxvLHQpKXJldHVybiExfXJldHVybiEwfSxNLnNvbWU9TS5hbnk9ZnVuY3Rpb24odCxlLGkpe2U9VChlLGkpO2Zvcih2YXIgbj0hWSh0KSYmTS5rZXlzKHQpLHI9KG58fHQpLmxlbmd0aCxzPTA7czxyO3MrKyl7dmFyIG89bj9uW3NdOnM7aWYoZSh0W29dLG8sdCkpcmV0dXJuITB9cmV0dXJuITF9LE0uY29udGFpbnM9TS5pbmNsdWRlcz1NLmluY2x1ZGU9ZnVuY3Rpb24odCxlLGksbil7cmV0dXJuIFkodCl8fCh0PU0udmFsdWVzKHQpKSwoIm51bWJlciIhPXR5cGVvZiBpfHxuKSYmKGk9MCksTS5pbmRleE9mKHQsZSxpKT49MH0sTS5pbnZva2U9ZnVuY3Rpb24odCxlKXt2YXIgaT1mLmNhbGwoYXJndW1lbnRzLDIpLG49TS5pc0Z1bmN0aW9uKGUpO3JldHVybiBNLm1hcCh0LGZ1bmN0aW9uKHQpe3ZhciByPW4/ZTp0W2VdO3JldHVybiBudWxsPT1yP3I6ci5hcHBseSh0LGkpfSl9LE0ucGx1Y2s9ZnVuY3Rpb24odCxlKXtyZXR1cm4gTS5tYXAodCxNLnByb3BlcnR5KGUpKX0sTS53aGVyZT1mdW5jdGlvbih0LGUpe3JldHVybiBNLmZpbHRlcih0LE0ubWF0Y2hlcihlKSl9LE0uZmluZFdoZXJlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIE0uZmluZCh0LE0ubWF0Y2hlcihlKSl9LE0ubWF4PWZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyLHM9LSgxLzApLG89LSgxLzApO2lmKG51bGw9PWUmJm51bGwhPXQpe3Q9WSh0KT90Ok0udmFsdWVzKHQpO2Zvcih2YXIgYT0wLGw9dC5sZW5ndGg7YTxsO2ErKyluPXRbYV0sbj5zJiYocz1uKX1lbHNlIGU9VChlLGkpLE0uZWFjaCh0LGZ1bmN0aW9uKHQsaSxuKXtyPWUodCxpLG4pLChyPm98fHI9PT0tKDEvMCkmJnM9PT0tKDEvMCkpJiYocz10LG89cil9KTtyZXR1cm4gc30sTS5taW49ZnVuY3Rpb24odCxlLGkpe3ZhciBuLHIscz0xLzAsbz0xLzA7aWYobnVsbD09ZSYmbnVsbCE9dCl7dD1ZKHQpP3Q6TS52YWx1ZXModCk7Zm9yKHZhciBhPTAsbD10Lmxlbmd0aDthPGw7YSsrKW49dFthXSxuPHMmJihzPW4pfWVsc2UgZT1UKGUsaSksTS5lYWNoKHQsZnVuY3Rpb24odCxpLG4pe3I9ZSh0LGksbiksKHI8b3x8cj09PTEvMCYmcz09PTEvMCkmJihzPXQsbz1yKX0pO3JldHVybiBzfSxNLnNodWZmbGU9ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGk9WSh0KT90Ok0udmFsdWVzKHQpLG49aS5sZW5ndGgscj1BcnJheShuKSxzPTA7czxuO3MrKyllPU0ucmFuZG9tKDAscyksZSE9PXMmJihyW3NdPXJbZV0pLHJbZV09aVtzXTtyZXR1cm4gcn0sTS5zYW1wbGU9ZnVuY3Rpb24odCxlLGkpe3JldHVybiBudWxsPT1lfHxpPyhZKHQpfHwodD1NLnZhbHVlcyh0KSksdFtNLnJhbmRvbSh0Lmxlbmd0aC0xKV0pOk0uc2h1ZmZsZSh0KS5zbGljZSgwLE1hdGgubWF4KDAsZSkpfSxNLnNvcnRCeT1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIGU9VChlLGkpLE0ucGx1Y2soTS5tYXAodCxmdW5jdGlvbih0LGksbil7cmV0dXJue3ZhbHVlOnQsaW5kZXg6aSxjcml0ZXJpYTplKHQsaSxuKX19KS5zb3J0KGZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5jcml0ZXJpYSxuPWUuY3JpdGVyaWE7aWYoaSE9PW4pe2lmKGk+bnx8dm9pZCAwPT09aSlyZXR1cm4gMTtpZihpPG58fHZvaWQgMD09PW4pcmV0dXJuLTF9cmV0dXJuIHQuaW5kZXgtZS5pbmRleH0pLCJ2YWx1ZSIpfTt2YXIgQz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSxpLG4pe3ZhciByPXt9O3JldHVybiBpPVQoaSxuKSxNLmVhY2goZSxmdW5jdGlvbihuLHMpe3ZhciBvPWkobixzLGUpO3QocixuLG8pfSkscn19O00uZ3JvdXBCeT1DKGZ1bmN0aW9uKHQsZSxpKXtNLmhhcyh0LGkpP3RbaV0ucHVzaChlKTp0W2ldPVtlXX0pLE0uaW5kZXhCeT1DKGZ1bmN0aW9uKHQsZSxpKXt0W2ldPWV9KSxNLmNvdW50Qnk9QyhmdW5jdGlvbih0LGUsaSl7TS5oYXModCxpKT90W2ldKys6dFtpXT0xfSksTS50b0FycmF5PWZ1bmN0aW9uKHQpe3JldHVybiB0P00uaXNBcnJheSh0KT9mLmNhbGwodCk6WSh0KT9NLm1hcCh0LE0uaWRlbnRpdHkpOk0udmFsdWVzKHQpOltdfSxNLnNpemU9ZnVuY3Rpb24odCl7cmV0dXJuIG51bGw9PXQ/MDpZKHQpP3QubGVuZ3RoOk0ua2V5cyh0KS5sZW5ndGh9LE0ucGFydGl0aW9uPWZ1bmN0aW9uKHQsZSxpKXtlPVQoZSxpKTt2YXIgbj1bXSxyPVtdO3JldHVybiBNLmVhY2godCxmdW5jdGlvbih0LGkscyl7KGUodCxpLHMpP246cikucHVzaCh0KX0pLFtuLHJdfSxNLmZpcnN0PU0uaGVhZD1NLnRha2U9ZnVuY3Rpb24odCxlLGkpe2lmKG51bGwhPXQpcmV0dXJuIG51bGw9PWV8fGk/dFswXTpNLmluaXRpYWwodCx0Lmxlbmd0aC1lKX0sTS5pbml0aWFsPWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gZi5jYWxsKHQsMCxNYXRoLm1heCgwLHQubGVuZ3RoLShudWxsPT1lfHxpPzE6ZSkpKX0sTS5sYXN0PWZ1bmN0aW9uKHQsZSxpKXtpZihudWxsIT10KXJldHVybiBudWxsPT1lfHxpP3RbdC5sZW5ndGgtMV06TS5yZXN0KHQsTWF0aC5tYXgoMCx0Lmxlbmd0aC1lKSl9LE0ucmVzdD1NLnRhaWw9TS5kcm9wPWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gZi5jYWxsKHQsbnVsbD09ZXx8aT8xOmUpfSxNLmNvbXBhY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIE0uZmlsdGVyKHQsTS5pZGVudGl0eSl9O3ZhciBBPWZ1bmN0aW9uKHQsZSxpLG4pe2Zvcih2YXIgcj1bXSxzPTAsbz1ufHwwLGE9RCh0KTtvPGE7bysrKXt2YXIgbD10W29dO2lmKFkobCkmJihNLmlzQXJyYXkobCl8fE0uaXNBcmd1bWVudHMobCkpKXtlfHwobD1BKGwsZSxpKSk7dmFyIGM9MCx1PWwubGVuZ3RoO2ZvcihyLmxlbmd0aCs9dTtjPHU7KXJbcysrXT1sW2MrK119ZWxzZSBpfHwocltzKytdPWwpfXJldHVybiByfTtNLmZsYXR0ZW49ZnVuY3Rpb24odCxlKXtyZXR1cm4gQSh0LGUsITEpfSxNLndpdGhvdXQ9ZnVuY3Rpb24odCl7cmV0dXJuIE0uZGlmZmVyZW5jZSh0LGYuY2FsbChhcmd1bWVudHMsMSkpfSxNLnVuaXE9TS51bmlxdWU9ZnVuY3Rpb24odCxlLGksbil7TS5pc0Jvb2xlYW4oZSl8fChuPWksaT1lLGU9ITEpLG51bGwhPWkmJihpPVQoaSxuKSk7Zm9yKHZhciByPVtdLHM9W10sbz0wLGE9RCh0KTtvPGE7bysrKXt2YXIgbD10W29dLGM9aT9pKGwsbyx0KTpsO2U/KG8mJnM9PT1jfHxyLnB1c2gobCkscz1jKTppP00uY29udGFpbnMocyxjKXx8KHMucHVzaChjKSxyLnB1c2gobCkpOk0uY29udGFpbnMocixsKXx8ci5wdXNoKGwpfXJldHVybiByfSxNLnVuaW9uPWZ1bmN0aW9uKCl7cmV0dXJuIE0udW5pcShBKGFyZ3VtZW50cywhMCwhMCkpfSxNLmludGVyc2VjdGlvbj1mdW5jdGlvbih0KXtmb3IodmFyIGU9W10saT1hcmd1bWVudHMubGVuZ3RoLG49MCxyPUQodCk7bjxyO24rKyl7dmFyIHM9dFtuXTtpZighTS5jb250YWlucyhlLHMpKXtmb3IodmFyIG89MTtvPGkmJk0uY29udGFpbnMoYXJndW1lbnRzW29dLHMpO28rKyk7bz09PWkmJmUucHVzaChzKX19cmV0dXJuIGV9LE0uZGlmZmVyZW5jZT1mdW5jdGlvbih0KXt2YXIgZT1BKGFyZ3VtZW50cywhMCwhMCwxKTtyZXR1cm4gTS5maWx0ZXIodCxmdW5jdGlvbih0KXtyZXR1cm4hTS5jb250YWlucyhlLHQpfSl9LE0uemlwPWZ1bmN0aW9uKCl7cmV0dXJuIE0udW56aXAoYXJndW1lbnRzKX0sTS51bnppcD1mdW5jdGlvbih0KXtmb3IodmFyIGU9dCYmTS5tYXgodCxEKS5sZW5ndGh8fDAsaT1BcnJheShlKSxuPTA7bjxlO24rKylpW25dPU0ucGx1Y2sodCxuKTtyZXR1cm4gaX0sTS5vYmplY3Q9ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9e30sbj0wLHI9RCh0KTtuPHI7bisrKWU/aVt0W25dXT1lW25dOmlbdFtuXVswXV09dFtuXVsxXTtyZXR1cm4gaX0sTS5maW5kSW5kZXg9cygxKSxNLmZpbmRMYXN0SW5kZXg9cygtMSksTS5zb3J0ZWRJbmRleD1mdW5jdGlvbih0LGUsaSxuKXtpPVQoaSxuLDEpO2Zvcih2YXIgcj1pKGUpLHM9MCxvPUQodCk7czxvOyl7dmFyIGE9TWF0aC5mbG9vcigocytvKS8yKTtpKHRbYV0pPHI/cz1hKzE6bz1hfXJldHVybiBzfSxNLmluZGV4T2Y9bygxLE0uZmluZEluZGV4LE0uc29ydGVkSW5kZXgpLE0ubGFzdEluZGV4T2Y9bygtMSxNLmZpbmRMYXN0SW5kZXgpLE0ucmFuZ2U9ZnVuY3Rpb24odCxlLGkpe251bGw9PWUmJihlPXR8fDAsdD0wKSxpPWl8fDE7Zm9yKHZhciBuPU1hdGgubWF4KE1hdGguY2VpbCgoZS10KS9pKSwwKSxyPUFycmF5KG4pLHM9MDtzPG47cysrLHQrPWkpcltzXT10O3JldHVybiByfTt2YXIgTz1mdW5jdGlvbih0LGUsaSxuLHIpe2lmKCEobiBpbnN0YW5jZW9mIGUpKXJldHVybiB0LmFwcGx5KGkscik7dmFyIHM9TCh0LnByb3RvdHlwZSksbz10LmFwcGx5KHMscik7cmV0dXJuIE0uaXNPYmplY3Qobyk/bzpzfTtNLmJpbmQ9ZnVuY3Rpb24odCxlKXtpZih5JiZ0LmJpbmQ9PT15KXJldHVybiB5LmFwcGx5KHQsZi5jYWxsKGFyZ3VtZW50cywxKSk7aWYoIU0uaXNGdW5jdGlvbih0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJCaW5kIG11c3QgYmUgY2FsbGVkIG9uIGEgZnVuY3Rpb24iKTt2YXIgaT1mLmNhbGwoYXJndW1lbnRzLDIpLG49ZnVuY3Rpb24oKXtyZXR1cm4gTyh0LG4sZSx0aGlzLGkuY29uY2F0KGYuY2FsbChhcmd1bWVudHMpKSl9O3JldHVybiBufSxNLnBhcnRpYWw9ZnVuY3Rpb24odCl7dmFyIGU9Zi5jYWxsKGFyZ3VtZW50cywxKSxpPWZ1bmN0aW9uKCl7Zm9yKHZhciBuPTAscj1lLmxlbmd0aCxzPUFycmF5KHIpLG89MDtvPHI7bysrKXNbb109ZVtvXT09PU0/YXJndW1lbnRzW24rK106ZVtvXTtmb3IoO248YXJndW1lbnRzLmxlbmd0aDspcy5wdXNoKGFyZ3VtZW50c1tuKytdKTtyZXR1cm4gTyh0LGksdGhpcyx0aGlzLHMpfTtyZXR1cm4gaX0sTS5iaW5kQWxsPWZ1bmN0aW9uKHQpe3ZhciBlLGksbj1hcmd1bWVudHMubGVuZ3RoO2lmKG48PTEpdGhyb3cgbmV3IEVycm9yKCJiaW5kQWxsIG11c3QgYmUgcGFzc2VkIGZ1bmN0aW9uIG5hbWVzIik7Zm9yKGU9MTtlPG47ZSsrKWk9YXJndW1lbnRzW2VdLHRbaV09TS5iaW5kKHRbaV0sdCk7cmV0dXJuIHR9LE0ubWVtb2l6ZT1mdW5jdGlvbih0LGUpe3ZhciBpPWZ1bmN0aW9uKG4pe3ZhciByPWkuY2FjaGUscz0iIisoZT9lLmFwcGx5KHRoaXMsYXJndW1lbnRzKTpuKTtyZXR1cm4gTS5oYXMocixzKXx8KHJbc109dC5hcHBseSh0aGlzLGFyZ3VtZW50cykpLHJbc119O3JldHVybiBpLmNhY2hlPXt9LGl9LE0uZGVsYXk9ZnVuY3Rpb24odCxlKXt2YXIgaT1mLmNhbGwoYXJndW1lbnRzLDIpO3JldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmV0dXJuIHQuYXBwbHkobnVsbCxpKX0sZSl9LE0uZGVmZXI9TS5wYXJ0aWFsKE0uZGVsYXksTSwxKSxNLnRocm90dGxlPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyLHMsbz1udWxsLGE9MDtpfHwoaT17fSk7dmFyIGw9ZnVuY3Rpb24oKXthPWkubGVhZGluZz09PSExPzA6TS5ub3coKSxvPW51bGwscz10LmFwcGx5KG4sciksb3x8KG49cj1udWxsKX07cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9TS5ub3coKTthfHxpLmxlYWRpbmchPT0hMXx8KGE9Yyk7dmFyIHU9ZS0oYy1hKTtyZXR1cm4gbj10aGlzLHI9YXJndW1lbnRzLHU8PTB8fHU+ZT8obyYmKGNsZWFyVGltZW91dChvKSxvPW51bGwpLGE9YyxzPXQuYXBwbHkobixyKSxvfHwobj1yPW51bGwpKTpvfHxpLnRyYWlsaW5nPT09ITF8fChvPXNldFRpbWVvdXQobCx1KSksc319LE0uZGVib3VuY2U9ZnVuY3Rpb24odCxlLGkpe3ZhciBuLHIscyxvLGEsbD1mdW5jdGlvbigpe3ZhciBjPU0ubm93KCktbztjPGUmJmM+PTA/bj1zZXRUaW1lb3V0KGwsZS1jKToobj1udWxsLGl8fChhPXQuYXBwbHkocyxyKSxufHwocz1yPW51bGwpKSl9O3JldHVybiBmdW5jdGlvbigpe3M9dGhpcyxyPWFyZ3VtZW50cyxvPU0ubm93KCk7dmFyIGM9aSYmIW47cmV0dXJuIG58fChuPXNldFRpbWVvdXQobCxlKSksYyYmKGE9dC5hcHBseShzLHIpLHM9cj1udWxsKSxhfX0sTS53cmFwPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIE0ucGFydGlhbChlLHQpfSxNLm5lZ2F0ZT1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4hdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSxNLmNvbXBvc2U9ZnVuY3Rpb24oKXt2YXIgdD1hcmd1bWVudHMsZT10Lmxlbmd0aC0xO3JldHVybiBmdW5jdGlvbigpe2Zvcih2YXIgaT1lLG49dFtlXS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aS0tOyluPXRbaV0uY2FsbCh0aGlzLG4pO3JldHVybiBufX0sTS5hZnRlcj1mdW5jdGlvbih0LGUpe3JldHVybiBmdW5jdGlvbigpe2lmKC0tdDwxKXJldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19LE0uYmVmb3JlPWZ1bmN0aW9uKHQsZSl7dmFyIGk7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuLS10PjAmJihpPWUuYXBwbHkodGhpcyxhcmd1bWVudHMpKSx0PD0xJiYoZT1udWxsKSxpfX0sTS5vbmNlPU0ucGFydGlhbChNLmJlZm9yZSwyKTt2YXIgTj0he3RvU3RyaW5nOm51bGx9LnByb3BlcnR5SXNFbnVtZXJhYmxlKCJ0b1N0cmluZyIpLEk9WyJ2YWx1ZU9mIiwiaXNQcm90b3R5cGVPZiIsInRvU3RyaW5nIiwicHJvcGVydHlJc0VudW1lcmFibGUiLCJoYXNPd25Qcm9wZXJ0eSIsInRvTG9jYWxlU3RyaW5nIl07TS5rZXlzPWZ1bmN0aW9uKHQpe2lmKCFNLmlzT2JqZWN0KHQpKXJldHVybltdO2lmKHYpcmV0dXJuIHYodCk7dmFyIGU9W107Zm9yKHZhciBpIGluIHQpTS5oYXModCxpKSYmZS5wdXNoKGkpO3JldHVybiBOJiZhKHQsZSksZX0sTS5hbGxLZXlzPWZ1bmN0aW9uKHQpe2lmKCFNLmlzT2JqZWN0KHQpKXJldHVybltdO3ZhciBlPVtdO2Zvcih2YXIgaSBpbiB0KWUucHVzaChpKTtyZXR1cm4gTiYmYSh0LGUpLGV9LE0udmFsdWVzPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1NLmtleXModCksaT1lLmxlbmd0aCxuPUFycmF5KGkpLHI9MDtyPGk7cisrKW5bcl09dFtlW3JdXTtyZXR1cm4gbn0sTS5tYXBPYmplY3Q9ZnVuY3Rpb24odCxlLGkpe2U9VChlLGkpO2Zvcih2YXIgbixyPU0ua2V5cyh0KSxzPXIubGVuZ3RoLG89e30sYT0wO2E8czthKyspbj1yW2FdLG9bbl09ZSh0W25dLG4sdCk7cmV0dXJuIG99LE0ucGFpcnM9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPU0ua2V5cyh0KSxpPWUubGVuZ3RoLG49QXJyYXkoaSkscj0wO3I8aTtyKyspbltyXT1bZVtyXSx0W2Vbcl1dXTtyZXR1cm4gbn0sTS5pbnZlcnQ9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXt9LGk9TS5rZXlzKHQpLG49MCxyPWkubGVuZ3RoO248cjtuKyspZVt0W2lbbl1dXT1pW25dO3JldHVybiBlfSxNLmZ1bmN0aW9ucz1NLm1ldGhvZHM9ZnVuY3Rpb24odCl7dmFyIGU9W107Zm9yKHZhciBpIGluIHQpTS5pc0Z1bmN0aW9uKHRbaV0pJiZlLnB1c2goaSk7cmV0dXJuIGUuc29ydCgpfSxNLmV4dGVuZD1TKE0uYWxsS2V5cyksTS5leHRlbmRPd249TS5hc3NpZ249UyhNLmtleXMpLE0uZmluZEtleT1mdW5jdGlvbih0LGUsaSl7ZT1UKGUsaSk7Zm9yKHZhciBuLHI9TS5rZXlzKHQpLHM9MCxvPXIubGVuZ3RoO3M8bztzKyspaWYobj1yW3NdLGUodFtuXSxuLHQpKXJldHVybiBufSxNLnBpY2s9ZnVuY3Rpb24odCxlLGkpe3ZhciBuLHIscz17fSxvPXQ7aWYobnVsbD09bylyZXR1cm4gcztNLmlzRnVuY3Rpb24oZSk/KHI9TS5hbGxLZXlzKG8pLG49ayhlLGkpKToocj1BKGFyZ3VtZW50cywhMSwhMSwxKSxuPWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gZSBpbiBpfSxvPU9iamVjdChvKSk7Zm9yKHZhciBhPTAsbD1yLmxlbmd0aDthPGw7YSsrKXt2YXIgYz1yW2FdLHU9b1tjXTtuKHUsYyxvKSYmKHNbY109dSl9cmV0dXJuIHN9LE0ub21pdD1mdW5jdGlvbih0LGUsaSl7aWYoTS5pc0Z1bmN0aW9uKGUpKWU9TS5uZWdhdGUoZSk7ZWxzZXt2YXIgbj1NLm1hcChBKGFyZ3VtZW50cywhMSwhMSwxKSxTdHJpbmcpO2U9ZnVuY3Rpb24odCxlKXtyZXR1cm4hTS5jb250YWlucyhuLGUpfX1yZXR1cm4gTS5waWNrKHQsZSxpKX0sTS5kZWZhdWx0cz1TKE0uYWxsS2V5cywhMCksTS5jcmVhdGU9ZnVuY3Rpb24odCxlKXt2YXIgaT1MKHQpO3JldHVybiBlJiZNLmV4dGVuZE93bihpLGUpLGl9LE0uY2xvbmU9ZnVuY3Rpb24odCl7cmV0dXJuIE0uaXNPYmplY3QodCk/TS5pc0FycmF5KHQpP3Quc2xpY2UoKTpNLmV4dGVuZCh7fSx0KTp0fSxNLnRhcD1mdW5jdGlvbih0LGUpe3JldHVybiBlKHQpLHR9LE0uaXNNYXRjaD1mdW5jdGlvbih0LGUpe3ZhciBpPU0ua2V5cyhlKSxuPWkubGVuZ3RoO2lmKG51bGw9PXQpcmV0dXJuIW47Zm9yKHZhciByPU9iamVjdCh0KSxzPTA7czxuO3MrKyl7dmFyIG89aVtzXTtpZihlW29dIT09cltvXXx8IShvIGluIHIpKXJldHVybiExfXJldHVybiEwfTt2YXIgUD1mdW5jdGlvbih0LGUsaSxuKXtpZih0PT09ZSlyZXR1cm4gMCE9PXR8fDEvdD09PTEvZTtpZihudWxsPT10fHxudWxsPT1lKXJldHVybiB0PT09ZTt0IGluc3RhbmNlb2YgTSYmKHQ9dC5fd3JhcHBlZCksZSBpbnN0YW5jZW9mIE0mJihlPWUuX3dyYXBwZWQpO3ZhciByPW0uY2FsbCh0KTtpZihyIT09bS5jYWxsKGUpKXJldHVybiExO3N3aXRjaChyKXtjYXNlIltvYmplY3QgUmVnRXhwXSI6Y2FzZSJbb2JqZWN0IFN0cmluZ10iOnJldHVybiIiK3Q9PSIiK2U7Y2FzZSJbb2JqZWN0IE51bWJlcl0iOnJldHVybit0IT09K3Q/K2UhPT0rZTowPT09K3Q/MS8rdD09PTEvZTordD09PStlO2Nhc2UiW29iamVjdCBEYXRlXSI6Y2FzZSJbb2JqZWN0IEJvb2xlYW5dIjpyZXR1cm4rdD09PStlfXZhciBzPSJbb2JqZWN0IEFycmF5XSI9PT1yO2lmKCFzKXtpZigib2JqZWN0IiE9dHlwZW9mIHR8fCJvYmplY3QiIT10eXBlb2YgZSlyZXR1cm4hMTt2YXIgbz10LmNvbnN0cnVjdG9yLGE9ZS5jb25zdHJ1Y3RvcjtpZihvIT09YSYmIShNLmlzRnVuY3Rpb24obykmJm8gaW5zdGFuY2VvZiBvJiZNLmlzRnVuY3Rpb24oYSkmJmEgaW5zdGFuY2VvZiBhKSYmImNvbnN0cnVjdG9yImluIHQmJiJjb25zdHJ1Y3RvciJpbiBlKXJldHVybiExfWk9aXx8W10sbj1ufHxbXTtmb3IodmFyIGw9aS5sZW5ndGg7bC0tOylpZihpW2xdPT09dClyZXR1cm4gbltsXT09PWU7aWYoaS5wdXNoKHQpLG4ucHVzaChlKSxzKXtpZihsPXQubGVuZ3RoLGwhPT1lLmxlbmd0aClyZXR1cm4hMTtmb3IoO2wtLTspaWYoIVAodFtsXSxlW2xdLGksbikpcmV0dXJuITF9ZWxzZXt2YXIgYyx1PU0ua2V5cyh0KTtpZihsPXUubGVuZ3RoLE0ua2V5cyhlKS5sZW5ndGghPT1sKXJldHVybiExO2Zvcig7bC0tOylpZihjPXVbbF0sIU0uaGFzKGUsYyl8fCFQKHRbY10sZVtjXSxpLG4pKXJldHVybiExfXJldHVybiBpLnBvcCgpLG4ucG9wKCksITB9O00uaXNFcXVhbD1mdW5jdGlvbih0LGUpe3JldHVybiBQKHQsZSl9LE0uaXNFbXB0eT1mdW5jdGlvbih0KXtyZXR1cm4gbnVsbD09dHx8KFkodCkmJihNLmlzQXJyYXkodCl8fE0uaXNTdHJpbmcodCl8fE0uaXNBcmd1bWVudHModCkpPzA9PT10Lmxlbmd0aDowPT09TS5rZXlzKHQpLmxlbmd0aCl9LE0uaXNFbGVtZW50PWZ1bmN0aW9uKHQpe3JldHVybiEoIXR8fDEhPT10Lm5vZGVUeXBlKX0sTS5pc0FycmF5PWd8fGZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IEFycmF5XSI9PT1tLmNhbGwodCl9LE0uaXNPYmplY3Q9ZnVuY3Rpb24odCl7dmFyIGU9dHlwZW9mIHQ7cmV0dXJuImZ1bmN0aW9uIj09PWV8fCJvYmplY3QiPT09ZSYmISF0fSxNLmVhY2goWyJBcmd1bWVudHMiLCJGdW5jdGlvbiIsIlN0cmluZyIsIk51bWJlciIsIkRhdGUiLCJSZWdFeHAiLCJFcnJvciJdLGZ1bmN0aW9uKHQpe01bImlzIit0XT1mdW5jdGlvbihlKXtyZXR1cm4gbS5jYWxsKGUpPT09IltvYmplY3QgIit0KyJdIn19KSxNLmlzQXJndW1lbnRzKGFyZ3VtZW50cyl8fChNLmlzQXJndW1lbnRzPWZ1bmN0aW9uKHQpe3JldHVybiBNLmhhcyh0LCJjYWxsZWUiKX0pLCJmdW5jdGlvbiIhPXR5cGVvZi8uLyYmIm9iamVjdCIhPXR5cGVvZiBJbnQ4QXJyYXkmJihNLmlzRnVuY3Rpb249ZnVuY3Rpb24odCl7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIHR8fCExfSksTS5pc0Zpbml0ZT1mdW5jdGlvbih0KXtyZXR1cm4gaXNGaW5pdGUodCkmJiFpc05hTihwYXJzZUZsb2F0KHQpKX0sTS5pc05hTj1mdW5jdGlvbih0KXtyZXR1cm4gTS5pc051bWJlcih0KSYmdCE9PSt0fSxNLmlzQm9vbGVhbj1mdW5jdGlvbih0KXtyZXR1cm4gdD09PSEwfHx0PT09ITF8fCJbb2JqZWN0IEJvb2xlYW5dIj09PW0uY2FsbCh0KX0sTS5pc051bGw9ZnVuY3Rpb24odCl7cmV0dXJuIG51bGw9PT10fSxNLmlzVW5kZWZpbmVkPWZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10fSxNLmhhcz1mdW5jdGlvbih0LGUpe3JldHVybiBudWxsIT10JiZfLmNhbGwodCxlKX0sTS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIGwuXz1jLHRoaXN9LE0uaWRlbnRpdHk9ZnVuY3Rpb24odCl7cmV0dXJuIHR9LE0uY29uc3RhbnQ9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHR9fSxNLm5vb3A9ZnVuY3Rpb24oKXt9LE0ucHJvcGVydHk9eCxNLnByb3BlcnR5T2Y9ZnVuY3Rpb24odCl7cmV0dXJuIG51bGw9PXQ/ZnVuY3Rpb24oKXt9OmZ1bmN0aW9uKGUpe3JldHVybiB0W2VdfX0sTS5tYXRjaGVyPU0ubWF0Y2hlcz1mdW5jdGlvbih0KXtyZXR1cm4gdD1NLmV4dGVuZE93bih7fSx0KSxmdW5jdGlvbihlKXtyZXR1cm4gTS5pc01hdGNoKGUsdCl9fSxNLnRpbWVzPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1BcnJheShNYXRoLm1heCgwLHQpKTtlPWsoZSxpLDEpO2Zvcih2YXIgcj0wO3I8dDtyKyspbltyXT1lKHIpO3JldHVybiBufSxNLnJhbmRvbT1mdW5jdGlvbih0LGUpe3JldHVybiBudWxsPT1lJiYoZT10LHQ9MCksdCtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKGUtdCsxKSl9LE0ubm93PURhdGUubm93fHxmdW5jdGlvbigpe3JldHVybihuZXcgRGF0ZSkuZ2V0VGltZSgpfTt2YXIgUj17IiYiOiImYW1wOyIsIjwiOiImbHQ7IiwiPiI6IiZndDsiLCciJzoiJnF1b3Q7IiwiJyI6IiYjeDI3OyIsImAiOiImI3g2MDsifSxIPU0uaW52ZXJ0KFIpLGo9ZnVuY3Rpb24odCl7dmFyIGU9ZnVuY3Rpb24oZSl7cmV0dXJuIHRbZV19LGk9Iig/OiIrTS5rZXlzKHQpLmpvaW4oInwiKSsiKSIsbj1SZWdFeHAoaSkscj1SZWdFeHAoaSwiZyIpO3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gdD1udWxsPT10PyIiOiIiK3Qsbi50ZXN0KHQpP3QucmVwbGFjZShyLGUpOnR9fTtNLmVzY2FwZT1qKFIpLE0udW5lc2NhcGU9aihIKSxNLnJlc3VsdD1mdW5jdGlvbih0LGUsaSl7dmFyIG49bnVsbD09dD92b2lkIDA6dFtlXTtyZXR1cm4gdm9pZCAwPT09biYmKG49aSksTS5pc0Z1bmN0aW9uKG4pP24uY2FsbCh0KTpufTt2YXIgRj0wO00udW5pcXVlSWQ9ZnVuY3Rpb24odCl7dmFyIGU9KytGKyIiO3JldHVybiB0P3QrZTplfSxNLnRlbXBsYXRlU2V0dGluZ3M9e2V2YWx1YXRlOi88JShbXHNcU10rPyklPi9nLGludGVycG9sYXRlOi88JT0oW1xzXFNdKz8pJT4vZyxlc2NhcGU6LzwlLShbXHNcU10rPyklPi9nfTt2YXIgVT0vKC4pXi8sVz17IiciOiInIiwiXFwiOiJcXCIsIlxyIjoiciIsIlxuIjoibiIsIlx1MjAyOCI6InUyMDI4IiwiXHUyMDI5IjoidTIwMjkifSxCPS9cXHwnfFxyfFxufFx1MjAyOHxcdTIwMjkvZyx6PWZ1bmN0aW9uKHQpe3JldHVybiJcXCIrV1t0XX07TS50ZW1wbGF0ZT1mdW5jdGlvbih0LGUsaSl7IWUmJmkmJihlPWkpLGU9TS5kZWZhdWx0cyh7fSxlLE0udGVtcGxhdGVTZXR0aW5ncyk7dmFyIG49UmVnRXhwKFsoZS5lc2NhcGV8fFUpLnNvdXJjZSwoZS5pbnRlcnBvbGF0ZXx8VSkuc291cmNlLChlLmV2YWx1YXRlfHxVKS5zb3VyY2VdLmpvaW4oInwiKSsifCQiLCJnIikscj0wLHM9Il9fcCs9JyI7dC5yZXBsYWNlKG4sZnVuY3Rpb24oZSxpLG4sbyxhKXtyZXR1cm4gcys9dC5zbGljZShyLGEpLnJlcGxhY2UoQix6KSxyPWErZS5sZW5ndGgsaT9zKz0iJytcbigoX190PSgiK2krIikpPT1udWxsPycnOl8uZXNjYXBlKF9fdCkpK1xuJyI6bj9zKz0iJytcbigoX190PSgiK24rIikpPT1udWxsPycnOl9fdCkrXG4nIjpvJiYocys9Iic7XG4iK28rIlxuX19wKz0nIiksZX0pLHMrPSInO1xuIixlLnZhcmlhYmxlfHwocz0id2l0aChvYmp8fHt9KXtcbiIrcysifVxuIikscz0idmFyIF9fdCxfX3A9JycsX19qPUFycmF5LnByb3RvdHlwZS5qb2luLHByaW50PWZ1bmN0aW9uKCl7X19wKz1fX2ouY2FsbChhcmd1bWVudHMsJycpO307XG4iK3MrInJldHVybiBfX3A7XG4iO3RyeXt2YXIgbz1uZXcgRnVuY3Rpb24oZS52YXJpYWJsZXx8Im9iaiIsIl8iLHMpfWNhdGNoKGEpe3Rocm93IGEuc291cmNlPXMsYX12YXIgbD1mdW5jdGlvbih0KXtyZXR1cm4gby5jYWxsKHRoaXMsdCxNKX0sYz1lLnZhcmlhYmxlfHwib2JqIjtyZXR1cm4gbC5zb3VyY2U9ImZ1bmN0aW9uKCIrYysiKXtcbiIrcysifSIsbH0sTS5jaGFpbj1mdW5jdGlvbih0KXt2YXIgZT1NKHQpO3JldHVybiBlLl9jaGFpbj0hMCxlfTt2YXIgVj1mdW5jdGlvbih0LGUpe3JldHVybiB0Ll9jaGFpbj9NKGUpLmNoYWluKCk6ZX07TS5taXhpbj1mdW5jdGlvbih0KXtNLmVhY2goTS5mdW5jdGlvbnModCksZnVuY3Rpb24oZSl7dmFyIGk9TVtlXT10W2VdO00ucHJvdG90eXBlW2VdPWZ1bmN0aW9uKCl7dmFyIHQ9W3RoaXMuX3dyYXBwZWRdO3JldHVybiBwLmFwcGx5KHQsYXJndW1lbnRzKSxWKHRoaXMsaS5hcHBseShNLHQpKX19KX0sTS5taXhpbihNKSxNLmVhY2goWyJwb3AiLCJwdXNoIiwicmV2ZXJzZSIsInNoaWZ0Iiwic29ydCIsInNwbGljZSIsInVuc2hpZnQiXSxmdW5jdGlvbih0KXt2YXIgZT11W3RdO00ucHJvdG90eXBlW3RdPWZ1bmN0aW9uKCl7dmFyIGk9dGhpcy5fd3JhcHBlZDtyZXR1cm4gZS5hcHBseShpLGFyZ3VtZW50cyksInNoaWZ0IiE9PXQmJiJzcGxpY2UiIT09dHx8MCE9PWkubGVuZ3RofHxkZWxldGUgaVswXSxWKHRoaXMsaSl9fSksTS5lYWNoKFsiY29uY2F0Iiwiam9pbiIsInNsaWNlIl0sZnVuY3Rpb24odCl7dmFyIGU9dVt0XTtNLnByb3RvdHlwZVt0XT1mdW5jdGlvbigpe3JldHVybiBWKHRoaXMsZS5hcHBseSh0aGlzLl93cmFwcGVkLGFyZ3VtZW50cykpfX0pLE0ucHJvdG90eXBlLnZhbHVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dyYXBwZWR9LE0ucHJvdG90eXBlLnZhbHVlT2Y9TS5wcm90b3R5cGUudG9KU09OPU0ucHJvdG90eXBlLnZhbHVlLE0ucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIiIrdGhpcy5fd3JhcHBlZH0sbj1bXSxyPWZ1bmN0aW9uKCl7cmV0dXJuIE19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0pLmNhbGwodGhpcyl9LGZ1bmN0aW9uKHQsZSxpKXsvKiEKCgkJIGhhbmRsZWJhcnMgdjQuMC41CgoJCUNvcHlyaWdodCAoQykgMjAxMS0yMDE1IGJ5IFllaHVkYSBLYXR6CgoJCVBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKCQlvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbAoJCWluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMKCQl0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCgkJY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCgkJZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKCgkJVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KCQlhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCgkJVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKCQlJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKCQlGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUKCQlBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCgkJTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKCQlPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOCgkJVEhFIFNPRlRXQVJFLgoKCQlAbGljZW5zZQoJCSovCgkhZnVuY3Rpb24oZSxpKXt0LmV4cG9ydHM9aSgpfSh0aGlzLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUobil7aWYoaVtuXSlyZXR1cm4gaVtuXS5leHBvcnRzO3ZhciByPWlbbl09e2V4cG9ydHM6e30saWQ6bixsb2FkZWQ6ITF9O3JldHVybiB0W25dLmNhbGwoci5leHBvcnRzLHIsci5leHBvcnRzLGUpLHIubG9hZGVkPSEwLHIuZXhwb3J0c312YXIgaT17fTtyZXR1cm4gZS5tPXQsZS5jPWksZS5wPSIiLGUoMCl9KFtmdW5jdGlvbih0LGUsaSl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oKXt2YXIgdD1nKCk7cmV0dXJuIHQuY29tcGlsZT1mdW5jdGlvbihlLGkpe3JldHVybiB1LmNvbXBpbGUoZSxpLHQpfSx0LnByZWNvbXBpbGU9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdS5wcmVjb21waWxlKGUsaSx0KX0sdC5BU1Q9bFsiZGVmYXVsdCJdLHQuQ29tcGlsZXI9dS5Db21waWxlcix0LkphdmFTY3JpcHRDb21waWxlcj1oWyJkZWZhdWx0Il0sdC5QYXJzZXI9Yy5wYXJzZXIsdC5wYXJzZT1jLnBhcnNlLHR9dmFyIHI9aSgxKVsiZGVmYXVsdCJdO2UuX19lc01vZHVsZT0hMDt2YXIgcz1pKDIpLG89cihzKSxhPWkoMjEpLGw9cihhKSxjPWkoMjIpLHU9aSgyNyksZD1pKDI4KSxoPXIoZCkscD1pKDI1KSxmPXIocCksbT1pKDIwKSxfPXIobSksZz1vWyJkZWZhdWx0Il0uY3JlYXRlLHY9bigpO3YuY3JlYXRlPW4sX1siZGVmYXVsdCJdKHYpLHYuVmlzaXRvcj1mWyJkZWZhdWx0Il0sdlsiZGVmYXVsdCJdPXYsZVsiZGVmYXVsdCJdPXYsdC5leHBvcnRzPWVbImRlZmF1bHQiXX0sZnVuY3Rpb24odCxlKXsidXNlIHN0cmljdCI7ZVsiZGVmYXVsdCJdPWZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ImRlZmF1bHQiOnR9fSxlLl9fZXNNb2R1bGU9ITB9LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbigpe3ZhciB0PW5ldyBhLkhhbmRsZWJhcnNFbnZpcm9ubWVudDtyZXR1cm4gcC5leHRlbmQodCxhKSx0LlNhZmVTdHJpbmc9Y1siZGVmYXVsdCJdLHQuRXhjZXB0aW9uPWRbImRlZmF1bHQiXSx0LlV0aWxzPXAsdC5lc2NhcGVFeHByZXNzaW9uPXAuZXNjYXBlRXhwcmVzc2lvbix0LlZNPW0sdC50ZW1wbGF0ZT1mdW5jdGlvbihlKXtyZXR1cm4gbS50ZW1wbGF0ZShlLHQpfSx0fXZhciByPWkoMylbImRlZmF1bHQiXSxzPWkoMSlbImRlZmF1bHQiXTtlLl9fZXNNb2R1bGU9ITA7dmFyIG89aSg0KSxhPXIobyksbD1pKDE4KSxjPXMobCksdT1pKDYpLGQ9cyh1KSxoPWkoNSkscD1yKGgpLGY9aSgxOSksbT1yKGYpLF89aSgyMCksZz1zKF8pLHY9bigpO3YuY3JlYXRlPW4sZ1siZGVmYXVsdCJdKHYpLHZbImRlZmF1bHQiXT12LGVbImRlZmF1bHQiXT12LHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSl7InVzZSBzdHJpY3QiO2VbImRlZmF1bHQiXT1mdW5jdGlvbih0KXtpZih0JiZ0Ll9fZXNNb2R1bGUpcmV0dXJuIHQ7dmFyIGU9e307aWYobnVsbCE9dClmb3IodmFyIGkgaW4gdClPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxpKSYmKGVbaV09dFtpXSk7cmV0dXJuIGVbImRlZmF1bHQiXT10LGV9LGUuX19lc01vZHVsZT0hMH0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKHQsZSxpKXt0aGlzLmhlbHBlcnM9dHx8e30sdGhpcy5wYXJ0aWFscz1lfHx7fSx0aGlzLmRlY29yYXRvcnM9aXx8e30sbC5yZWdpc3RlckRlZmF1bHRIZWxwZXJzKHRoaXMpLGMucmVnaXN0ZXJEZWZhdWx0RGVjb3JhdG9ycyh0aGlzKX12YXIgcj1pKDEpWyJkZWZhdWx0Il07ZS5fX2VzTW9kdWxlPSEwLGUuSGFuZGxlYmFyc0Vudmlyb25tZW50PW47dmFyIHM9aSg1KSxvPWkoNiksYT1yKG8pLGw9aSg3KSxjPWkoMTUpLHU9aSgxNyksZD1yKHUpLGg9IjQuMC41IjtlLlZFUlNJT049aDt2YXIgcD03O2UuQ09NUElMRVJfUkVWSVNJT049cDt2YXIgZj17MToiPD0gMS4wLnJjLjIiLDI6Ij09IDEuMC4wLXJjLjMiLDM6Ij09IDEuMC4wLXJjLjQiLDQ6Ij09IDEueC54Iiw1OiI9PSAyLjAuMC1hbHBoYS54Iiw2OiI+PSAyLjAuMC1iZXRhLjEiLDc6Ij49IDQuMC4wIn07ZS5SRVZJU0lPTl9DSEFOR0VTPWY7dmFyIG09IltvYmplY3QgT2JqZWN0XSI7bi5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOm4sbG9nZ2VyOmRbImRlZmF1bHQiXSxsb2c6ZFsiZGVmYXVsdCJdLmxvZyxyZWdpc3RlckhlbHBlcjpmdW5jdGlvbih0LGUpe2lmKHMudG9TdHJpbmcuY2FsbCh0KT09PW0pe2lmKGUpdGhyb3cgbmV3IGFbImRlZmF1bHQiXSgiQXJnIG5vdCBzdXBwb3J0ZWQgd2l0aCBtdWx0aXBsZSBoZWxwZXJzIik7cy5leHRlbmQodGhpcy5oZWxwZXJzLHQpfWVsc2UgdGhpcy5oZWxwZXJzW3RdPWV9LHVucmVnaXN0ZXJIZWxwZXI6ZnVuY3Rpb24odCl7ZGVsZXRlIHRoaXMuaGVscGVyc1t0XX0scmVnaXN0ZXJQYXJ0aWFsOmZ1bmN0aW9uKHQsZSl7aWYocy50b1N0cmluZy5jYWxsKHQpPT09bSlzLmV4dGVuZCh0aGlzLnBhcnRpYWxzLHQpO2Vsc2V7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiBlKXRocm93IG5ldyBhWyJkZWZhdWx0Il0oJ0F0dGVtcHRpbmcgdG8gcmVnaXN0ZXIgYSBwYXJ0aWFsIGNhbGxlZCAiJyt0KyciIGFzIHVuZGVmaW5lZCcpO3RoaXMucGFydGlhbHNbdF09ZX19LHVucmVnaXN0ZXJQYXJ0aWFsOmZ1bmN0aW9uKHQpe2RlbGV0ZSB0aGlzLnBhcnRpYWxzW3RdfSxyZWdpc3RlckRlY29yYXRvcjpmdW5jdGlvbih0LGUpe2lmKHMudG9TdHJpbmcuY2FsbCh0KT09PW0pe2lmKGUpdGhyb3cgbmV3IGFbImRlZmF1bHQiXSgiQXJnIG5vdCBzdXBwb3J0ZWQgd2l0aCBtdWx0aXBsZSBkZWNvcmF0b3JzIik7cy5leHRlbmQodGhpcy5kZWNvcmF0b3JzLHQpfWVsc2UgdGhpcy5kZWNvcmF0b3JzW3RdPWV9LHVucmVnaXN0ZXJEZWNvcmF0b3I6ZnVuY3Rpb24odCl7ZGVsZXRlIHRoaXMuZGVjb3JhdG9yc1t0XX19O3ZhciBfPWRbImRlZmF1bHQiXS5sb2c7ZS5sb2c9XyxlLmNyZWF0ZUZyYW1lPXMuY3JlYXRlRnJhbWUsZS5sb2dnZXI9ZFsiZGVmYXVsdCJdfSxmdW5jdGlvbih0LGUpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBpKHQpe3JldHVybiB1W3RdfWZ1bmN0aW9uIG4odCl7Zm9yKHZhciBlPTE7ZTxhcmd1bWVudHMubGVuZ3RoO2UrKylmb3IodmFyIGkgaW4gYXJndW1lbnRzW2VdKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhcmd1bWVudHNbZV0saSkmJih0W2ldPWFyZ3VtZW50c1tlXVtpXSk7cmV0dXJuIHR9ZnVuY3Rpb24gcih0LGUpe2Zvcih2YXIgaT0wLG49dC5sZW5ndGg7aTxuO2krKylpZih0W2ldPT09ZSlyZXR1cm4gaTtyZXR1cm4tMX1mdW5jdGlvbiBzKHQpe2lmKCJzdHJpbmciIT10eXBlb2YgdCl7aWYodCYmdC50b0hUTUwpcmV0dXJuIHQudG9IVE1MKCk7aWYobnVsbD09dClyZXR1cm4iIjtpZighdClyZXR1cm4gdCsiIjt0PSIiK3R9cmV0dXJuIGgudGVzdCh0KT90LnJlcGxhY2UoZCxpKTp0fWZ1bmN0aW9uIG8odCl7cmV0dXJuIXQmJjAhPT10fHwhKCFtKHQpfHwwIT09dC5sZW5ndGgpfWZ1bmN0aW9uIGEodCl7dmFyIGU9bih7fSx0KTtyZXR1cm4gZS5fcGFyZW50PXQsZX1mdW5jdGlvbiBsKHQsZSl7cmV0dXJuIHQucGF0aD1lLHR9ZnVuY3Rpb24gYyh0LGUpe3JldHVybih0P3QrIi4iOiIiKStlfWUuX19lc01vZHVsZT0hMCxlLmV4dGVuZD1uLGUuaW5kZXhPZj1yLGUuZXNjYXBlRXhwcmVzc2lvbj1zLGUuaXNFbXB0eT1vLGUuY3JlYXRlRnJhbWU9YSxlLmJsb2NrUGFyYW1zPWwsZS5hcHBlbmRDb250ZXh0UGF0aD1jO3ZhciB1PXsiJiI6IiZhbXA7IiwiPCI6IiZsdDsiLCI+IjoiJmd0OyIsJyInOiImcXVvdDsiLCInIjoiJiN4Mjc7IiwiYCI6IiYjeDYwOyIsIj0iOiImI3gzRDsifSxkPS9bJjw+IidgPV0vZyxoPS9bJjw+IidgPV0vLHA9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztlLnRvU3RyaW5nPXA7dmFyIGY9ZnVuY3Rpb24odCl7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIHR9O2YoL3gvKSYmKGUuaXNGdW5jdGlvbj1mPWZ1bmN0aW9uKHQpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiB0JiYiW29iamVjdCBGdW5jdGlvbl0iPT09cC5jYWxsKHQpfSksZS5pc0Z1bmN0aW9uPWY7dmFyIG09QXJyYXkuaXNBcnJheXx8ZnVuY3Rpb24odCl7cmV0dXJuISghdHx8Im9iamVjdCIhPXR5cGVvZiB0KSYmIltvYmplY3QgQXJyYXldIj09PXAuY2FsbCh0KX07ZS5pc0FycmF5PW19LGZ1bmN0aW9uKHQsZSl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGkodCxlKXt2YXIgcj1lJiZlLmxvYyxzPXZvaWQgMCxvPXZvaWQgMDtyJiYocz1yLnN0YXJ0LmxpbmUsbz1yLnN0YXJ0LmNvbHVtbix0Kz0iIC0gIitzKyI6IitvKTtmb3IodmFyIGE9RXJyb3IucHJvdG90eXBlLmNvbnN0cnVjdG9yLmNhbGwodGhpcyx0KSxsPTA7bDxuLmxlbmd0aDtsKyspdGhpc1tuW2xdXT1hW25bbF1dO0Vycm9yLmNhcHR1cmVTdGFja1RyYWNlJiZFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLGkpLHImJih0aGlzLmxpbmVOdW1iZXI9cyx0aGlzLmNvbHVtbj1vKX1lLl9fZXNNb2R1bGU9ITA7dmFyIG49WyJkZXNjcmlwdGlvbiIsImZpbGVOYW1lIiwibGluZU51bWJlciIsIm1lc3NhZ2UiLCJuYW1lIiwibnVtYmVyIiwic3RhY2siXTtpLnByb3RvdHlwZT1uZXcgRXJyb3IsZVsiZGVmYXVsdCJdPWksdC5leHBvcnRzPWVbImRlZmF1bHQiXX0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKHQpe29bImRlZmF1bHQiXSh0KSxsWyJkZWZhdWx0Il0odCksdVsiZGVmYXVsdCJdKHQpLGhbImRlZmF1bHQiXSh0KSxmWyJkZWZhdWx0Il0odCksX1siZGVmYXVsdCJdKHQpLHZbImRlZmF1bHQiXSh0KX12YXIgcj1pKDEpWyJkZWZhdWx0Il07ZS5fX2VzTW9kdWxlPSEwLGUucmVnaXN0ZXJEZWZhdWx0SGVscGVycz1uO3ZhciBzPWkoOCksbz1yKHMpLGE9aSg5KSxsPXIoYSksYz1pKDEwKSx1PXIoYyksZD1pKDExKSxoPXIoZCkscD1pKDEyKSxmPXIocCksbT1pKDEzKSxfPXIobSksZz1pKDE0KSx2PXIoZyl9LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZS5fX2VzTW9kdWxlPSEwO3ZhciBuPWkoNSk7ZVsiZGVmYXVsdCJdPWZ1bmN0aW9uKHQpe3QucmVnaXN0ZXJIZWxwZXIoImJsb2NrSGVscGVyTWlzc2luZyIsZnVuY3Rpb24oZSxpKXt2YXIgcj1pLmludmVyc2Uscz1pLmZuO2lmKGU9PT0hMClyZXR1cm4gcyh0aGlzKTtpZihlPT09ITF8fG51bGw9PWUpcmV0dXJuIHIodGhpcyk7aWYobi5pc0FycmF5KGUpKXJldHVybiBlLmxlbmd0aD4wPyhpLmlkcyYmKGkuaWRzPVtpLm5hbWVdKSx0LmhlbHBlcnMuZWFjaChlLGkpKTpyKHRoaXMpO2lmKGkuZGF0YSYmaS5pZHMpe3ZhciBvPW4uY3JlYXRlRnJhbWUoaS5kYXRhKTtvLmNvbnRleHRQYXRoPW4uYXBwZW5kQ29udGV4dFBhdGgoaS5kYXRhLmNvbnRleHRQYXRoLGkubmFtZSksaT17ZGF0YTpvfX1yZXR1cm4gcyhlLGkpfSl9LHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7dmFyIG49aSgxKVsiZGVmYXVsdCJdO2UuX19lc01vZHVsZT0hMDt2YXIgcj1pKDUpLHM9aSg2KSxvPW4ocyk7ZVsiZGVmYXVsdCJdPWZ1bmN0aW9uKHQpe3QucmVnaXN0ZXJIZWxwZXIoImVhY2giLGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaShlLGkscyl7YyYmKGMua2V5PWUsYy5pbmRleD1pLGMuZmlyc3Q9MD09PWksYy5sYXN0PSEhcyx1JiYoYy5jb250ZXh0UGF0aD11K2UpKSxsKz1uKHRbZV0se2RhdGE6YyxibG9ja1BhcmFtczpyLmJsb2NrUGFyYW1zKFt0W2VdLGVdLFt1K2UsbnVsbF0pfSl9aWYoIWUpdGhyb3cgbmV3IG9bImRlZmF1bHQiXSgiTXVzdCBwYXNzIGl0ZXJhdG9yIHRvICNlYWNoIik7dmFyIG49ZS5mbixzPWUuaW52ZXJzZSxhPTAsbD0iIixjPXZvaWQgMCx1PXZvaWQgMDtpZihlLmRhdGEmJmUuaWRzJiYodT1yLmFwcGVuZENvbnRleHRQYXRoKGUuZGF0YS5jb250ZXh0UGF0aCxlLmlkc1swXSkrIi4iKSxyLmlzRnVuY3Rpb24odCkmJih0PXQuY2FsbCh0aGlzKSksZS5kYXRhJiYoYz1yLmNyZWF0ZUZyYW1lKGUuZGF0YSkpLHQmJiJvYmplY3QiPT10eXBlb2YgdClpZihyLmlzQXJyYXkodCkpZm9yKHZhciBkPXQubGVuZ3RoO2E8ZDthKyspYSBpbiB0JiZpKGEsYSxhPT09dC5sZW5ndGgtMSk7ZWxzZXt2YXIgaD12b2lkIDA7Zm9yKHZhciBwIGluIHQpdC5oYXNPd25Qcm9wZXJ0eShwKSYmKHZvaWQgMCE9PWgmJmkoaCxhLTEpLGg9cCxhKyspO3ZvaWQgMCE9PWgmJmkoaCxhLTEsITApfXJldHVybiAwPT09YSYmKGw9cyh0aGlzKSksbH0pfSx0LmV4cG9ydHM9ZVsiZGVmYXVsdCJdfSxmdW5jdGlvbih0LGUsaSl7InVzZSBzdHJpY3QiO3ZhciBuPWkoMSlbImRlZmF1bHQiXTtlLl9fZXNNb2R1bGU9ITA7dmFyIHI9aSg2KSxzPW4ocik7ZVsiZGVmYXVsdCJdPWZ1bmN0aW9uKHQpe3QucmVnaXN0ZXJIZWxwZXIoImhlbHBlck1pc3NpbmciLGZ1bmN0aW9uKCl7aWYoMSE9PWFyZ3VtZW50cy5sZW5ndGgpdGhyb3cgbmV3IHNbImRlZmF1bHQiXSgnTWlzc2luZyBoZWxwZXI6ICInK2FyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoLTFdLm5hbWUrJyInKX0pfSx0LmV4cG9ydHM9ZVsiZGVmYXVsdCJdfSxmdW5jdGlvbih0LGUsaSl7InVzZSBzdHJpY3QiO2UuX19lc01vZHVsZT0hMDt2YXIgbj1pKDUpO2VbImRlZmF1bHQiXT1mdW5jdGlvbih0KXt0LnJlZ2lzdGVySGVscGVyKCJpZiIsZnVuY3Rpb24odCxlKXtyZXR1cm4gbi5pc0Z1bmN0aW9uKHQpJiYodD10LmNhbGwodGhpcykpLCFlLmhhc2guaW5jbHVkZVplcm8mJiF0fHxuLmlzRW1wdHkodCk/ZS5pbnZlcnNlKHRoaXMpOmUuZm4odGhpcyl9KSx0LnJlZ2lzdGVySGVscGVyKCJ1bmxlc3MiLGZ1bmN0aW9uKGUsaSl7cmV0dXJuIHQuaGVscGVyc1siaWYiXS5jYWxsKHRoaXMsZSx7Zm46aS5pbnZlcnNlLGludmVyc2U6aS5mbixoYXNoOmkuaGFzaH0pfSl9LHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSl7InVzZSBzdHJpY3QiO2UuX19lc01vZHVsZT0hMCxlWyJkZWZhdWx0Il09ZnVuY3Rpb24odCl7dC5yZWdpc3RlckhlbHBlcigibG9nIixmdW5jdGlvbigpe2Zvcih2YXIgZT1bdm9pZCAwXSxpPWFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoLTFdLG49MDtuPGFyZ3VtZW50cy5sZW5ndGgtMTtuKyspZS5wdXNoKGFyZ3VtZW50c1tuXSk7dmFyIHI9MTtudWxsIT1pLmhhc2gubGV2ZWw/cj1pLmhhc2gubGV2ZWw6aS5kYXRhJiZudWxsIT1pLmRhdGEubGV2ZWwmJihyPWkuZGF0YS5sZXZlbCksZVswXT1yLHQubG9nLmFwcGx5KHQsZSl9KX0sdC5leHBvcnRzPWVbImRlZmF1bHQiXX0sZnVuY3Rpb24odCxlKXsidXNlIHN0cmljdCI7ZS5fX2VzTW9kdWxlPSEwLGVbImRlZmF1bHQiXT1mdW5jdGlvbih0KXt0LnJlZ2lzdGVySGVscGVyKCJsb29rdXAiLGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQmJnRbZV19KX0sdC5leHBvcnRzPWVbImRlZmF1bHQiXX0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtlLl9fZXNNb2R1bGU9ITA7dmFyIG49aSg1KTtlWyJkZWZhdWx0Il09ZnVuY3Rpb24odCl7dC5yZWdpc3RlckhlbHBlcigid2l0aCIsZnVuY3Rpb24odCxlKXtuLmlzRnVuY3Rpb24odCkmJih0PXQuY2FsbCh0aGlzKSk7dmFyIGk9ZS5mbjtpZihuLmlzRW1wdHkodCkpcmV0dXJuIGUuaW52ZXJzZSh0aGlzKTt2YXIgcj1lLmRhdGE7cmV0dXJuIGUuZGF0YSYmZS5pZHMmJihyPW4uY3JlYXRlRnJhbWUoZS5kYXRhKSxyLmNvbnRleHRQYXRoPW4uYXBwZW5kQ29udGV4dFBhdGgoZS5kYXRhLmNvbnRleHRQYXRoLGUuaWRzWzBdKSksaSh0LHtkYXRhOnIsYmxvY2tQYXJhbXM6bi5ibG9ja1BhcmFtcyhbdF0sW3ImJnIuY29udGV4dFBhdGhdKX0pfSl9LHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbih0KXtvWyJkZWZhdWx0Il0odCl9dmFyIHI9aSgxKVsiZGVmYXVsdCJdO2UuX19lc01vZHVsZT0hMCxlLnJlZ2lzdGVyRGVmYXVsdERlY29yYXRvcnM9bjt2YXIgcz1pKDE2KSxvPXIocyl9LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZS5fX2VzTW9kdWxlPSEwO3ZhciBuPWkoNSk7ZVsiZGVmYXVsdCJdPWZ1bmN0aW9uKHQpe3QucmVnaXN0ZXJEZWNvcmF0b3IoImlubGluZSIsZnVuY3Rpb24odCxlLGkscil7dmFyIHM9dDtyZXR1cm4gZS5wYXJ0aWFsc3x8KGUucGFydGlhbHM9e30scz1mdW5jdGlvbihyLHMpe3ZhciBvPWkucGFydGlhbHM7aS5wYXJ0aWFscz1uLmV4dGVuZCh7fSxvLGUucGFydGlhbHMpO3ZhciBhPXQocixzKTtyZXR1cm4gaS5wYXJ0aWFscz1vLGF9KSxlLnBhcnRpYWxzW3IuYXJnc1swXV09ci5mbixzfSl9LHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZS5fX2VzTW9kdWxlPSEwO3ZhciBuPWkoNSkscj17bWV0aG9kTWFwOlsiZGVidWciLCJpbmZvIiwid2FybiIsImVycm9yIl0sbGV2ZWw6ImluZm8iLGxvb2t1cExldmVsOmZ1bmN0aW9uKHQpe2lmKCJzdHJpbmciPT10eXBlb2YgdCl7dmFyIGU9bi5pbmRleE9mKHIubWV0aG9kTWFwLHQudG9Mb3dlckNhc2UoKSk7dD1lPj0wP2U6cGFyc2VJbnQodCwxMCl9cmV0dXJuIHR9LGxvZzpmdW5jdGlvbih0KXtpZih0PXIubG9va3VwTGV2ZWwodCksInVuZGVmaW5lZCIhPXR5cGVvZiBjb25zb2xlJiZyLmxvb2t1cExldmVsKHIubGV2ZWwpPD10KXt2YXIgZT1yLm1ldGhvZE1hcFt0XTtjb25zb2xlW2VdfHwoZT0ibG9nIik7Zm9yKHZhciBpPWFyZ3VtZW50cy5sZW5ndGgsbj1BcnJheShpPjE/aS0xOjApLHM9MTtzPGk7cysrKW5bcy0xXT1hcmd1bWVudHNbc107Y29uc29sZVtlXS5hcHBseShjb25zb2xlLG4pfX19O2VbImRlZmF1bHQiXT1yLHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGkodCl7dGhpcy5zdHJpbmc9dH1lLl9fZXNNb2R1bGU9ITAsaS5wcm90b3R5cGUudG9TdHJpbmc9aS5wcm90b3R5cGUudG9IVE1MPWZ1bmN0aW9uKCl7cmV0dXJuIiIrdGhpcy5zdHJpbmd9LGVbImRlZmF1bHQiXT1pLHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbih0KXt2YXIgZT10JiZ0WzBdfHwxLGk9Zy5DT01QSUxFUl9SRVZJU0lPTjtpZihlIT09aSl7aWYoZTxpKXt2YXIgbj1nLlJFVklTSU9OX0NIQU5HRVNbaV0scj1nLlJFVklTSU9OX0NIQU5HRVNbZV07dGhyb3cgbmV3IF9bImRlZmF1bHQiXSgiVGVtcGxhdGUgd2FzIHByZWNvbXBpbGVkIHdpdGggYW4gb2xkZXIgdmVyc2lvbiBvZiBIYW5kbGViYXJzIHRoYW4gdGhlIGN1cnJlbnQgcnVudGltZS4gUGxlYXNlIHVwZGF0ZSB5b3VyIHByZWNvbXBpbGVyIHRvIGEgbmV3ZXIgdmVyc2lvbiAoIituKyIpIG9yIGRvd25ncmFkZSB5b3VyIHJ1bnRpbWUgdG8gYW4gb2xkZXIgdmVyc2lvbiAoIityKyIpLiIpfXRocm93IG5ldyBfWyJkZWZhdWx0Il0oIlRlbXBsYXRlIHdhcyBwcmVjb21waWxlZCB3aXRoIGEgbmV3ZXIgdmVyc2lvbiBvZiBIYW5kbGViYXJzIHRoYW4gdGhlIGN1cnJlbnQgcnVudGltZS4gUGxlYXNlIHVwZGF0ZSB5b3VyIHJ1bnRpbWUgdG8gYSBuZXdlciB2ZXJzaW9uICgiK3RbMV0rIikuIil9fWZ1bmN0aW9uIHIodCxlKXtmdW5jdGlvbiBpKGksbixyKXtyLmhhc2gmJihuPWYuZXh0ZW5kKHt9LG4sci5oYXNoKSxyLmlkcyYmKHIuaWRzWzBdPSEwKSksaT1lLlZNLnJlc29sdmVQYXJ0aWFsLmNhbGwodGhpcyxpLG4scik7dmFyIHM9ZS5WTS5pbnZva2VQYXJ0aWFsLmNhbGwodGhpcyxpLG4scik7aWYobnVsbD09cyYmZS5jb21waWxlJiYoci5wYXJ0aWFsc1tyLm5hbWVdPWUuY29tcGlsZShpLHQuY29tcGlsZXJPcHRpb25zLGUpLHM9ci5wYXJ0aWFsc1tyLm5hbWVdKG4scikpLG51bGwhPXMpe2lmKHIuaW5kZW50KXtmb3IodmFyIG89cy5zcGxpdCgiXG4iKSxhPTAsbD1vLmxlbmd0aDthPGwmJihvW2FdfHxhKzEhPT1sKTthKyspb1thXT1yLmluZGVudCtvW2FdO3M9by5qb2luKCJcbiIpfXJldHVybiBzfXRocm93IG5ldyBfWyJkZWZhdWx0Il0oIlRoZSBwYXJ0aWFsICIrci5uYW1lKyIgY291bGQgbm90IGJlIGNvbXBpbGVkIHdoZW4gcnVubmluZyBpbiBydW50aW1lLW9ubHkgbW9kZSIpfWZ1bmN0aW9uIG4oZSl7ZnVuY3Rpb24gaShlKXtyZXR1cm4iIit0Lm1haW4ocixlLHIuaGVscGVycyxyLnBhcnRpYWxzLG8sbCxhKX12YXIgcz1hcmd1bWVudHMubGVuZ3RoPD0xfHx2b2lkIDA9PT1hcmd1bWVudHNbMV0/e306YXJndW1lbnRzWzFdLG89cy5kYXRhO24uX3NldHVwKHMpLCFzLnBhcnRpYWwmJnQudXNlRGF0YSYmKG89YyhlLG8pKTt2YXIgYT12b2lkIDAsbD10LnVzZUJsb2NrUGFyYW1zP1tdOnZvaWQgMDtyZXR1cm4gdC51c2VEZXB0aHMmJihhPXMuZGVwdGhzP2UhPT1zLmRlcHRoc1swXT9bZV0uY29uY2F0KHMuZGVwdGhzKTpzLmRlcHRoczpbZV0pLChpPXUodC5tYWluLGkscixzLmRlcHRoc3x8W10sbyxsKSkoZSxzKX1pZighZSl0aHJvdyBuZXcgX1siZGVmYXVsdCJdKCJObyBlbnZpcm9ubWVudCBwYXNzZWQgdG8gdGVtcGxhdGUiKTtpZighdHx8IXQubWFpbil0aHJvdyBuZXcgX1siZGVmYXVsdCJdKCJVbmtub3duIHRlbXBsYXRlIG9iamVjdDogIit0eXBlb2YgdCk7dC5tYWluLmRlY29yYXRvcj10Lm1haW5fZCxlLlZNLmNoZWNrUmV2aXNpb24odC5jb21waWxlcik7dmFyIHI9e3N0cmljdDpmdW5jdGlvbih0LGUpe2lmKCEoZSBpbiB0KSl0aHJvdyBuZXcgX1siZGVmYXVsdCJdKCciJytlKyciIG5vdCBkZWZpbmVkIGluICcrdCk7cmV0dXJuIHRbZV19LGxvb2t1cDpmdW5jdGlvbih0LGUpe2Zvcih2YXIgaT10Lmxlbmd0aCxuPTA7bjxpO24rKylpZih0W25dJiZudWxsIT10W25dW2VdKXJldHVybiB0W25dW2VdfSxsYW1iZGE6ZnVuY3Rpb24odCxlKXtyZXR1cm4iZnVuY3Rpb24iPT10eXBlb2YgdD90LmNhbGwoZSk6dH0sZXNjYXBlRXhwcmVzc2lvbjpmLmVzY2FwZUV4cHJlc3Npb24saW52b2tlUGFydGlhbDppLGZuOmZ1bmN0aW9uKGUpe3ZhciBpPXRbZV07cmV0dXJuIGkuZGVjb3JhdG9yPXRbZSsiX2QiXSxpfSxwcm9ncmFtczpbXSxwcm9ncmFtOmZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIG89dGhpcy5wcm9ncmFtc1t0XSxhPXRoaXMuZm4odCk7cmV0dXJuIGV8fHJ8fG58fGk/bz1zKHRoaXMsdCxhLGUsaSxuLHIpOm98fChvPXRoaXMucHJvZ3JhbXNbdF09cyh0aGlzLHQsYSkpLG99LGRhdGE6ZnVuY3Rpb24odCxlKXtmb3IoO3QmJmUtLTspdD10Ll9wYXJlbnQ7cmV0dXJuIHR9LG1lcmdlOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dHx8ZTtyZXR1cm4gdCYmZSYmdCE9PWUmJihpPWYuZXh0ZW5kKHt9LGUsdCkpLGl9LG5vb3A6ZS5WTS5ub29wLGNvbXBpbGVySW5mbzp0LmNvbXBpbGVyfTtyZXR1cm4gbi5pc1RvcD0hMCxuLl9zZXR1cD1mdW5jdGlvbihpKXtpLnBhcnRpYWw/KHIuaGVscGVycz1pLmhlbHBlcnMsci5wYXJ0aWFscz1pLnBhcnRpYWxzLHIuZGVjb3JhdG9ycz1pLmRlY29yYXRvcnMpOihyLmhlbHBlcnM9ci5tZXJnZShpLmhlbHBlcnMsZS5oZWxwZXJzKSx0LnVzZVBhcnRpYWwmJihyLnBhcnRpYWxzPXIubWVyZ2UoaS5wYXJ0aWFscyxlLnBhcnRpYWxzKSksKHQudXNlUGFydGlhbHx8dC51c2VEZWNvcmF0b3JzKSYmKHIuZGVjb3JhdG9ycz1yLm1lcmdlKGkuZGVjb3JhdG9ycyxlLmRlY29yYXRvcnMpKSl9LG4uX2NoaWxkPWZ1bmN0aW9uKGUsaSxuLG8pe2lmKHQudXNlQmxvY2tQYXJhbXMmJiFuKXRocm93IG5ldyBfWyJkZWZhdWx0Il0oIm11c3QgcGFzcyBibG9jayBwYXJhbXMiKTtpZih0LnVzZURlcHRocyYmIW8pdGhyb3cgbmV3IF9bImRlZmF1bHQiXSgibXVzdCBwYXNzIHBhcmVudCBkZXB0aHMiKTtyZXR1cm4gcyhyLGUsdFtlXSxpLDAsbixvKX0sbn1mdW5jdGlvbiBzKHQsZSxpLG4scixzLG8pe2Z1bmN0aW9uIGEoZSl7dmFyIHI9YXJndW1lbnRzLmxlbmd0aDw9MXx8dm9pZCAwPT09YXJndW1lbnRzWzFdP3t9OmFyZ3VtZW50c1sxXSxhPW87cmV0dXJuIG8mJmUhPT1vWzBdJiYoYT1bZV0uY29uY2F0KG8pKSxpKHQsZSx0LmhlbHBlcnMsdC5wYXJ0aWFscyxyLmRhdGF8fG4scyYmW3IuYmxvY2tQYXJhbXNdLmNvbmNhdChzKSxhKX1yZXR1cm4gYT11KGksYSx0LG8sbixzKSxhLnByb2dyYW09ZSxhLmRlcHRoPW8/by5sZW5ndGg6MCxhLmJsb2NrUGFyYW1zPXJ8fDAsYX1mdW5jdGlvbiBvKHQsZSxpKXtyZXR1cm4gdD90LmNhbGx8fGkubmFtZXx8KGkubmFtZT10LHQ9aS5wYXJ0aWFsc1t0XSk6dD0iQHBhcnRpYWwtYmxvY2siPT09aS5uYW1lP2kuZGF0YVsicGFydGlhbC1ibG9jayJdOmkucGFydGlhbHNbaS5uYW1lXSx0fWZ1bmN0aW9uIGEodCxlLGkpe2kucGFydGlhbD0hMCxpLmlkcyYmKGkuZGF0YS5jb250ZXh0UGF0aD1pLmlkc1swXXx8aS5kYXRhLmNvbnRleHRQYXRoKTt2YXIgbj12b2lkIDA7aWYoaS5mbiYmaS5mbiE9PWwmJihpLmRhdGE9Zy5jcmVhdGVGcmFtZShpLmRhdGEpLG49aS5kYXRhWyJwYXJ0aWFsLWJsb2NrIl09aS5mbixuLnBhcnRpYWxzJiYoaS5wYXJ0aWFscz1mLmV4dGVuZCh7fSxpLnBhcnRpYWxzLG4ucGFydGlhbHMpKSksdm9pZCAwPT09dCYmbiYmKHQ9biksdm9pZCAwPT09dCl0aHJvdyBuZXcgX1siZGVmYXVsdCJdKCJUaGUgcGFydGlhbCAiK2kubmFtZSsiIGNvdWxkIG5vdCBiZSBmb3VuZCIpO2lmKHQgaW5zdGFuY2VvZiBGdW5jdGlvbilyZXR1cm4gdChlLGkpfWZ1bmN0aW9uIGwoKXtyZXR1cm4iIn1mdW5jdGlvbiBjKHQsZSl7cmV0dXJuIGUmJiJyb290ImluIGV8fChlPWU/Zy5jcmVhdGVGcmFtZShlKTp7fSxlLnJvb3Q9dCksZX1mdW5jdGlvbiB1KHQsZSxpLG4scixzKXtpZih0LmRlY29yYXRvcil7dmFyIG89e307ZT10LmRlY29yYXRvcihlLG8saSxuJiZuWzBdLHIscyxuKSxmLmV4dGVuZChlLG8pfXJldHVybiBlfXZhciBkPWkoMylbImRlZmF1bHQiXSxoPWkoMSlbImRlZmF1bHQiXTtlLl9fZXNNb2R1bGU9ITAsZS5jaGVja1JldmlzaW9uPW4sZS50ZW1wbGF0ZT1yLGUud3JhcFByb2dyYW09cyxlLnJlc29sdmVQYXJ0aWFsPW8sZS5pbnZva2VQYXJ0aWFsPWEsZS5ub29wPWw7dmFyIHA9aSg1KSxmPWQocCksbT1pKDYpLF89aChtKSxnPWkoNCl9LGZ1bmN0aW9uKHQsZSl7KGZ1bmN0aW9uKGkpeyJ1c2Ugc3RyaWN0IjtlLl9fZXNNb2R1bGU9ITAsZVsiZGVmYXVsdCJdPWZ1bmN0aW9uKHQpe3ZhciBlPSJ1bmRlZmluZWQiIT10eXBlb2YgaT9pOndpbmRvdyxuPWUuSGFuZGxlYmFyczt0Lm5vQ29uZmxpY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gZS5IYW5kbGViYXJzPT09dCYmKGUuSGFuZGxlYmFycz1uKSx0fX0sdC5leHBvcnRzPWVbImRlZmF1bHQiXX0pLmNhbGwoZSxmdW5jdGlvbigpe3JldHVybiB0aGlzfSgpKX0sZnVuY3Rpb24odCxlKXsidXNlIHN0cmljdCI7ZS5fX2VzTW9kdWxlPSEwO3ZhciBpPXtoZWxwZXJzOntoZWxwZXJFeHByZXNzaW9uOmZ1bmN0aW9uKHQpe3JldHVybiJTdWJFeHByZXNzaW9uIj09PXQudHlwZXx8KCJNdXN0YWNoZVN0YXRlbWVudCI9PT10LnR5cGV8fCJCbG9ja1N0YXRlbWVudCI9PT10LnR5cGUpJiYhISh0LnBhcmFtcyYmdC5wYXJhbXMubGVuZ3RofHx0Lmhhc2gpfSxzY29wZWRJZDpmdW5jdGlvbih0KXtyZXR1cm4vXlwufHRoaXNcYi8udGVzdCh0Lm9yaWdpbmFsKX0sc2ltcGxlSWQ6ZnVuY3Rpb24odCl7cmV0dXJuIDE9PT10LnBhcnRzLmxlbmd0aCYmIWkuaGVscGVycy5zY29wZWRJZCh0KSYmIXQuZGVwdGh9fX07ZVsiZGVmYXVsdCJdPWksdC5leHBvcnRzPWVbImRlZmF1bHQiXX0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKHQsZSl7aWYoIlByb2dyYW0iPT09dC50eXBlKXJldHVybiB0O2FbImRlZmF1bHQiXS55eT1wLHAubG9jSW5mbz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IHAuU291cmNlTG9jYXRpb24oZSYmZS5zcmNOYW1lLHQpfTt2YXIgaT1uZXcgY1siZGVmYXVsdCJdKGUpO3JldHVybiBpLmFjY2VwdChhWyJkZWZhdWx0Il0ucGFyc2UodCkpfXZhciByPWkoMSlbImRlZmF1bHQiXSxzPWkoMylbImRlZmF1bHQiXTtlLl9fZXNNb2R1bGU9ITAsZS5wYXJzZT1uO3ZhciBvPWkoMjMpLGE9cihvKSxsPWkoMjQpLGM9cihsKSx1PWkoMjYpLGQ9cyh1KSxoPWkoNSk7ZS5wYXJzZXI9YVsiZGVmYXVsdCJdO3ZhciBwPXt9O2guZXh0ZW5kKHAsZCl9LGZ1bmN0aW9uKHQsZSl7InVzZSBzdHJpY3QiO3ZhciBpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMueXk9e319dmFyIGU9e3RyYWNlOmZ1bmN0aW9uKCl7fSx5eTp7fSxzeW1ib2xzXzp7ZXJyb3I6Mixyb290OjMscHJvZ3JhbTo0LEVPRjo1LHByb2dyYW1fcmVwZXRpdGlvbjA6NixzdGF0ZW1lbnQ6NyxtdXN0YWNoZTo4LGJsb2NrOjkscmF3QmxvY2s6MTAscGFydGlhbDoxMSxwYXJ0aWFsQmxvY2s6MTIsY29udGVudDoxMyxDT01NRU5UOjE0LENPTlRFTlQ6MTUsb3BlblJhd0Jsb2NrOjE2LHJhd0Jsb2NrX3JlcGV0aXRpb25fcGx1czA6MTcsRU5EX1JBV19CTE9DSzoxOCxPUEVOX1JBV19CTE9DSzoxOSxoZWxwZXJOYW1lOjIwLG9wZW5SYXdCbG9ja19yZXBldGl0aW9uMDoyMSxvcGVuUmF3QmxvY2tfb3B0aW9uMDoyMixDTE9TRV9SQVdfQkxPQ0s6MjMsb3BlbkJsb2NrOjI0LGJsb2NrX29wdGlvbjA6MjUsY2xvc2VCbG9jazoyNixvcGVuSW52ZXJzZToyNyxibG9ja19vcHRpb24xOjI4LE9QRU5fQkxPQ0s6Mjksb3BlbkJsb2NrX3JlcGV0aXRpb24wOjMwLG9wZW5CbG9ja19vcHRpb24wOjMxLG9wZW5CbG9ja19vcHRpb24xOjMyLENMT1NFOjMzLE9QRU5fSU5WRVJTRTozNCxvcGVuSW52ZXJzZV9yZXBldGl0aW9uMDozNSxvcGVuSW52ZXJzZV9vcHRpb24wOjM2LG9wZW5JbnZlcnNlX29wdGlvbjE6Mzcsb3BlbkludmVyc2VDaGFpbjozOCxPUEVOX0lOVkVSU0VfQ0hBSU46Mzksb3BlbkludmVyc2VDaGFpbl9yZXBldGl0aW9uMDo0MCxvcGVuSW52ZXJzZUNoYWluX29wdGlvbjA6NDEsb3BlbkludmVyc2VDaGFpbl9vcHRpb24xOjQyLGludmVyc2VBbmRQcm9ncmFtOjQzLElOVkVSU0U6NDQsaW52ZXJzZUNoYWluOjQ1LGludmVyc2VDaGFpbl9vcHRpb24wOjQ2LE9QRU5fRU5EQkxPQ0s6NDcsT1BFTjo0OCxtdXN0YWNoZV9yZXBldGl0aW9uMDo0OSxtdXN0YWNoZV9vcHRpb24wOjUwLE9QRU5fVU5FU0NBUEVEOjUxLG11c3RhY2hlX3JlcGV0aXRpb24xOjUyLG11c3RhY2hlX29wdGlvbjE6NTMsQ0xPU0VfVU5FU0NBUEVEOjU0LE9QRU5fUEFSVElBTDo1NSxwYXJ0aWFsTmFtZTo1NixwYXJ0aWFsX3JlcGV0aXRpb24wOjU3LHBhcnRpYWxfb3B0aW9uMDo1OCxvcGVuUGFydGlhbEJsb2NrOjU5LE9QRU5fUEFSVElBTF9CTE9DSzo2MCxvcGVuUGFydGlhbEJsb2NrX3JlcGV0aXRpb24wOjYxLG9wZW5QYXJ0aWFsQmxvY2tfb3B0aW9uMDo2MixwYXJhbTo2MyxzZXhwcjo2NCxPUEVOX1NFWFBSOjY1LHNleHByX3JlcGV0aXRpb24wOjY2LHNleHByX29wdGlvbjA6NjcsQ0xPU0VfU0VYUFI6NjgsaGFzaDo2OSxoYXNoX3JlcGV0aXRpb25fcGx1czA6NzAsaGFzaFNlZ21lbnQ6NzEsSUQ6NzIsRVFVQUxTOjczLGJsb2NrUGFyYW1zOjc0LE9QRU5fQkxPQ0tfUEFSQU1TOjc1LGJsb2NrUGFyYW1zX3JlcGV0aXRpb25fcGx1czA6NzYsQ0xPU0VfQkxPQ0tfUEFSQU1TOjc3LHBhdGg6NzgsZGF0YU5hbWU6NzksU1RSSU5HOjgwLE5VTUJFUjo4MSxCT09MRUFOOjgyLFVOREVGSU5FRDo4MyxOVUxMOjg0LERBVEE6ODUscGF0aFNlZ21lbnRzOjg2LFNFUDo4NywkYWNjZXB0OjAsJGVuZDoxfSx0ZXJtaW5hbHNfOnsyOiJlcnJvciIsNToiRU9GIiwxNDoiQ09NTUVOVCIsMTU6IkNPTlRFTlQiLDE4OiJFTkRfUkFXX0JMT0NLIiwxOToiT1BFTl9SQVdfQkxPQ0siLDIzOiJDTE9TRV9SQVdfQkxPQ0siLDI5OiJPUEVOX0JMT0NLIiwzMzoiQ0xPU0UiLDM0OiJPUEVOX0lOVkVSU0UiLDM5OiJPUEVOX0lOVkVSU0VfQ0hBSU4iLDQ0OiJJTlZFUlNFIiw0NzoiT1BFTl9FTkRCTE9DSyIsNDg6Ik9QRU4iLDUxOiJPUEVOX1VORVNDQVBFRCIsNTQ6IkNMT1NFX1VORVNDQVBFRCIsNTU6Ik9QRU5fUEFSVElBTCIsNjA6Ik9QRU5fUEFSVElBTF9CTE9DSyIsNjU6Ik9QRU5fU0VYUFIiLDY4OiJDTE9TRV9TRVhQUiIsNzI6IklEIiw3MzoiRVFVQUxTIiw3NToiT1BFTl9CTE9DS19QQVJBTVMiLDc3OiJDTE9TRV9CTE9DS19QQVJBTVMiLDgwOiJTVFJJTkciLDgxOiJOVU1CRVIiLDgyOiJCT09MRUFOIiw4MzoiVU5ERUZJTkVEIiw4NDoiTlVMTCIsODU6IkRBVEEiLDg3OiJTRVAifSxwcm9kdWN0aW9uc186WzAsWzMsMl0sWzQsMV0sWzcsMV0sWzcsMV0sWzcsMV0sWzcsMV0sWzcsMV0sWzcsMV0sWzcsMV0sWzEzLDFdLFsxMCwzXSxbMTYsNV0sWzksNF0sWzksNF0sWzI0LDZdLFsyNyw2XSxbMzgsNl0sWzQzLDJdLFs0NSwzXSxbNDUsMV0sWzI2LDNdLFs4LDVdLFs4LDVdLFsxMSw1XSxbMTIsM10sWzU5LDVdLFs2MywxXSxbNjMsMV0sWzY0LDVdLFs2OSwxXSxbNzEsM10sWzc0LDNdLFsyMCwxXSxbMjAsMV0sWzIwLDFdLFsyMCwxXSxbMjAsMV0sWzIwLDFdLFsyMCwxXSxbNTYsMV0sWzU2LDFdLFs3OSwyXSxbNzgsMV0sWzg2LDNdLFs4NiwxXSxbNiwwXSxbNiwyXSxbMTcsMV0sWzE3LDJdLFsyMSwwXSxbMjEsMl0sWzIyLDBdLFsyMiwxXSxbMjUsMF0sWzI1LDFdLFsyOCwwXSxbMjgsMV0sWzMwLDBdLFszMCwyXSxbMzEsMF0sWzMxLDFdLFszMiwwXSxbMzIsMV0sWzM1LDBdLFszNSwyXSxbMzYsMF0sWzM2LDFdLFszNywwXSxbMzcsMV0sWzQwLDBdLFs0MCwyXSxbNDEsMF0sWzQxLDFdLFs0MiwwXSxbNDIsMV0sWzQ2LDBdLFs0NiwxXSxbNDksMF0sWzQ5LDJdLFs1MCwwXSxbNTAsMV0sWzUyLDBdLFs1MiwyXSxbNTMsMF0sWzUzLDFdLFs1NywwXSxbNTcsMl0sWzU4LDBdLFs1OCwxXSxbNjEsMF0sWzYxLDJdLFs2MiwwXSxbNjIsMV0sWzY2LDBdLFs2NiwyXSxbNjcsMF0sWzY3LDFdLFs3MCwxXSxbNzAsMl0sWzc2LDFdLFs3NiwyXV0scGVyZm9ybUFjdGlvbjpmdW5jdGlvbih0LGUsaSxuLHIscyxvKXt2YXIgYT1zLmxlbmd0aC0xO3N3aXRjaChyKXtjYXNlIDE6cmV0dXJuIHNbYS0xXTtjYXNlIDI6dGhpcy4kPW4ucHJlcGFyZVByb2dyYW0oc1thXSk7YnJlYWs7Y2FzZSAzOnRoaXMuJD1zW2FdO2JyZWFrO2Nhc2UgNDp0aGlzLiQ9c1thXTticmVhaztjYXNlIDU6dGhpcy4kPXNbYV07YnJlYWs7Y2FzZSA2OnRoaXMuJD1zW2FdO2JyZWFrO2Nhc2UgNzp0aGlzLiQ9c1thXTticmVhaztjYXNlIDg6dGhpcy4kPXNbYV07YnJlYWs7Y2FzZSA5OnRoaXMuJD17dHlwZToiQ29tbWVudFN0YXRlbWVudCIsdmFsdWU6bi5zdHJpcENvbW1lbnQoc1thXSksc3RyaXA6bi5zdHJpcEZsYWdzKHNbYV0sc1thXSksbG9jOm4ubG9jSW5mbyh0aGlzLl8kKX07YnJlYWs7Y2FzZSAxMDp0aGlzLiQ9e3R5cGU6IkNvbnRlbnRTdGF0ZW1lbnQiLG9yaWdpbmFsOnNbYV0sdmFsdWU6c1thXSxsb2M6bi5sb2NJbmZvKHRoaXMuXyQpfTticmVhaztjYXNlIDExOnRoaXMuJD1uLnByZXBhcmVSYXdCbG9jayhzW2EtMl0sc1thLTFdLHNbYV0sdGhpcy5fJCk7YnJlYWs7Y2FzZSAxMjp0aGlzLiQ9e3BhdGg6c1thLTNdLHBhcmFtczpzW2EtMl0saGFzaDpzW2EtMV19O2JyZWFrO2Nhc2UgMTM6dGhpcy4kPW4ucHJlcGFyZUJsb2NrKHNbYS0zXSxzW2EtMl0sc1thLTFdLHNbYV0sITEsdGhpcy5fJCk7YnJlYWs7Y2FzZSAxNDp0aGlzLiQ9bi5wcmVwYXJlQmxvY2soc1thLTNdLHNbYS0yXSxzW2EtMV0sc1thXSwhMCx0aGlzLl8kKTticmVhaztjYXNlIDE1OnRoaXMuJD17b3BlbjpzW2EtNV0scGF0aDpzW2EtNF0scGFyYW1zOnNbYS0zXSxoYXNoOnNbYS0yXSxibG9ja1BhcmFtczpzW2EtMV0sc3RyaXA6bi5zdHJpcEZsYWdzKHNbYS01XSxzW2FdKX07YnJlYWs7Y2FzZSAxNjp0aGlzLiQ9e3BhdGg6c1thLTRdLHBhcmFtczpzW2EtM10saGFzaDpzW2EtMl0sYmxvY2tQYXJhbXM6c1thLTFdLHN0cmlwOm4uc3RyaXBGbGFncyhzW2EtNV0sc1thXSl9O2JyZWFrO2Nhc2UgMTc6dGhpcy4kPXtwYXRoOnNbYS00XSxwYXJhbXM6c1thLTNdLGhhc2g6c1thLTJdLGJsb2NrUGFyYW1zOnNbYS0xXSxzdHJpcDpuLnN0cmlwRmxhZ3Moc1thLTVdLHNbYV0pfTticmVhaztjYXNlIDE4OnRoaXMuJD17c3RyaXA6bi5zdHJpcEZsYWdzKHNbYS0xXSxzW2EtMV0pLHByb2dyYW06c1thXX07YnJlYWs7Y2FzZSAxOTp2YXIgbD1uLnByZXBhcmVCbG9jayhzW2EtMl0sc1thLTFdLHNbYV0sc1thXSwhMSx0aGlzLl8kKSxjPW4ucHJlcGFyZVByb2dyYW0oW2xdLHNbYS0xXS5sb2MpO2MuY2hhaW5lZD0hMCx0aGlzLiQ9e3N0cmlwOnNbYS0yXS5zdHJpcCxwcm9ncmFtOmMsY2hhaW46ITB9O2JyZWFrO2Nhc2UgMjA6dGhpcy4kPXNbYV07YnJlYWs7Y2FzZSAyMTp0aGlzLiQ9e3BhdGg6c1thLTFdLHN0cmlwOm4uc3RyaXBGbGFncyhzW2EtMl0sc1thXSl9O2JyZWFrO2Nhc2UgMjI6dGhpcy4kPW4ucHJlcGFyZU11c3RhY2hlKHNbYS0zXSxzW2EtMl0sc1thLTFdLHNbYS00XSxuLnN0cmlwRmxhZ3Moc1thLTRdLHNbYV0pLHRoaXMuXyQpO2JyZWFrO2Nhc2UgMjM6dGhpcy4kPW4ucHJlcGFyZU11c3RhY2hlKHNbYS0zXSxzW2EtMl0sc1thLTFdLHNbYS00XSxuLnN0cmlwRmxhZ3Moc1thLTRdLHNbYV0pLHRoaXMuXyQpO2JyZWFrO2Nhc2UgMjQ6dGhpcy4kPXt0eXBlOiJQYXJ0aWFsU3RhdGVtZW50IixuYW1lOnNbYS0zXSxwYXJhbXM6c1thLTJdLGhhc2g6c1thLTFdLGluZGVudDoiIixzdHJpcDpuLnN0cmlwRmxhZ3Moc1thLTRdLHNbYV0pLGxvYzpuLmxvY0luZm8odGhpcy5fJCl9O2JyZWFrO2Nhc2UgMjU6dGhpcy4kPW4ucHJlcGFyZVBhcnRpYWxCbG9jayhzW2EtMl0sc1thLTFdLHNbYV0sdGhpcy5fJCk7YnJlYWs7Y2FzZSAyNjp0aGlzLiQ9e3BhdGg6c1thLTNdLHBhcmFtczpzW2EtMl0saGFzaDpzW2EtMV0sc3RyaXA6bi5zdHJpcEZsYWdzKHNbYS00XSxzW2FdKX07YnJlYWs7Y2FzZSAyNzp0aGlzLiQ9c1thXTticmVhaztjYXNlIDI4OnRoaXMuJD1zW2FdO2JyZWFrO2Nhc2UgMjk6dGhpcy4kPXt0eXBlOiJTdWJFeHByZXNzaW9uIixwYXRoOnNbYS0zXSxwYXJhbXM6c1thLTJdLGhhc2g6c1thLTFdLGxvYzpuLmxvY0luZm8odGhpcy5fJCl9O2JyZWFrO2Nhc2UgMzA6dGhpcy4kPXt0eXBlOiJIYXNoIixwYWlyczpzW2FdLGxvYzpuLmxvY0luZm8odGhpcy5fJCl9O2JyZWFrO2Nhc2UgMzE6dGhpcy4kPXt0eXBlOiJIYXNoUGFpciIsa2V5Om4uaWQoc1thLTJdKSx2YWx1ZTpzW2FdLGxvYzpuLmxvY0luZm8odGhpcy5fJCl9O2JyZWFrO2Nhc2UgMzI6dGhpcy4kPW4uaWQoc1thLTFdKTticmVhaztjYXNlIDMzOnRoaXMuJD1zW2FdO2JyZWFrO2Nhc2UgMzQ6dGhpcy4kPXNbYV07YnJlYWs7Y2FzZSAzNTp0aGlzLiQ9e3R5cGU6IlN0cmluZ0xpdGVyYWwiLHZhbHVlOnNbYV0sb3JpZ2luYWw6c1thXSxsb2M6bi5sb2NJbmZvKHRoaXMuXyQpfTticmVhaztjYXNlIDM2OnRoaXMuJD17dHlwZToiTnVtYmVyTGl0ZXJhbCIsdmFsdWU6TnVtYmVyKHNbYV0pLG9yaWdpbmFsOk51bWJlcihzW2FdKSxsb2M6bi5sb2NJbmZvKHRoaXMuXyQpfTticmVhaztjYXNlIDM3OnRoaXMuJD17dHlwZToiQm9vbGVhbkxpdGVyYWwiLHZhbHVlOiJ0cnVlIj09PXNbYV0sb3JpZ2luYWw6InRydWUiPT09c1thXSxsb2M6bi5sb2NJbmZvKHRoaXMuXyQpfTticmVhaztjYXNlIDM4OnRoaXMuJD17dHlwZToiVW5kZWZpbmVkTGl0ZXJhbCIsb3JpZ2luYWw6dm9pZCAwLHZhbHVlOnZvaWQgMCxsb2M6bi5sb2NJbmZvKHRoaXMuXyQpfTticmVhaztjYXNlIDM5OnRoaXMuJD17dHlwZToiTnVsbExpdGVyYWwiLG9yaWdpbmFsOm51bGwsdmFsdWU6bnVsbCxsb2M6bi5sb2NJbmZvKHRoaXMuXyQpfTticmVhaztjYXNlIDQwOnRoaXMuJD1zW2FdO2JyZWFrO2Nhc2UgNDE6dGhpcy4kPXNbYV07YnJlYWs7Y2FzZSA0Mjp0aGlzLiQ9bi5wcmVwYXJlUGF0aCghMCxzW2FdLHRoaXMuXyQpO2JyZWFrO2Nhc2UgNDM6dGhpcy4kPW4ucHJlcGFyZVBhdGgoITEsc1thXSx0aGlzLl8kKTticmVhaztjYXNlIDQ0OnNbYS0yXS5wdXNoKHtwYXJ0Om4uaWQoc1thXSksb3JpZ2luYWw6c1thXSxzZXBhcmF0b3I6c1thLTFdfSksdGhpcy4kPXNbYS0yXTticmVhaztjYXNlIDQ1OnRoaXMuJD1be3BhcnQ6bi5pZChzW2FdKSxvcmlnaW5hbDpzW2FdfV07YnJlYWs7Y2FzZSA0Njp0aGlzLiQ9W107YnJlYWs7Y2FzZSA0NzpzW2EtMV0ucHVzaChzW2FdKTticmVhaztjYXNlIDQ4OnRoaXMuJD1bc1thXV07YnJlYWs7Y2FzZSA0OTpzW2EtMV0ucHVzaChzW2FdKTticmVhaztjYXNlIDUwOnRoaXMuJD1bXTticmVhaztjYXNlIDUxOnNbYS0xXS5wdXNoKHNbYV0pO2JyZWFrO2Nhc2UgNTg6dGhpcy4kPVtdO2JyZWFrO2Nhc2UgNTk6c1thLTFdLnB1c2goc1thXSk7YnJlYWs7Y2FzZSA2NDp0aGlzLiQ9W107YnJlYWs7Y2FzZSA2NTpzW2EtMV0ucHVzaChzW2FdKTticmVhaztjYXNlIDcwOnRoaXMuJD1bXTticmVhaztjYXNlIDcxOnNbYS0xXS5wdXNoKHNbYV0pO2JyZWFrO2Nhc2UgNzg6dGhpcy4kPVtdO2JyZWFrO2Nhc2UgNzk6c1thLTFdLnB1c2goc1thXSk7YnJlYWs7Y2FzZSA4Mjp0aGlzLiQ9W107YnJlYWs7Y2FzZSA4MzpzW2EtMV0ucHVzaChzW2FdKTticmVhaztjYXNlIDg2OnRoaXMuJD1bXTticmVhaztjYXNlIDg3OnNbYS0xXS5wdXNoKHNbYV0pO2JyZWFrO2Nhc2UgOTA6dGhpcy4kPVtdO2JyZWFrO2Nhc2UgOTE6c1thLTFdLnB1c2goc1thXSk7YnJlYWs7Y2FzZSA5NDp0aGlzLiQ9W107YnJlYWs7Y2FzZSA5NTpzW2EtMV0ucHVzaChzW2FdKTticmVhaztjYXNlIDk4OnRoaXMuJD1bc1thXV07YnJlYWs7Y2FzZSA5OTpzW2EtMV0ucHVzaChzW2FdKTticmVhaztjYXNlIDEwMDp0aGlzLiQ9W3NbYV1dO2JyZWFrO2Nhc2UgMTAxOnNbYS0xXS5wdXNoKHNbYV0pfX0sdGFibGU6W3szOjEsNDoyLDU6WzIsNDZdLDY6MywxNDpbMiw0Nl0sMTU6WzIsNDZdLDE5OlsyLDQ2XSwyOTpbMiw0Nl0sMzQ6WzIsNDZdLDQ4OlsyLDQ2XSw1MTpbMiw0Nl0sNTU6WzIsNDZdLDYwOlsyLDQ2XX0sezE6WzNdfSx7NTpbMSw0XX0sezU6WzIsMl0sNzo1LDg6Niw5OjcsMTA6OCwxMTo5LDEyOjEwLDEzOjExLDE0OlsxLDEyXSwxNTpbMSwyMF0sMTY6MTcsMTk6WzEsMjNdLDI0OjE1LDI3OjE2LDI5OlsxLDIxXSwzNDpbMSwyMl0sMzk6WzIsMl0sNDQ6WzIsMl0sNDc6WzIsMl0sNDg6WzEsMTNdLDUxOlsxLDE0XSw1NTpbMSwxOF0sNTk6MTksNjA6WzEsMjRdfSx7MTpbMiwxXX0sezU6WzIsNDddLDE0OlsyLDQ3XSwxNTpbMiw0N10sMTk6WzIsNDddLDI5OlsyLDQ3XSwzNDpbMiw0N10sMzk6WzIsNDddLDQ0OlsyLDQ3XSw0NzpbMiw0N10sNDg6WzIsNDddLDUxOlsyLDQ3XSw1NTpbMiw0N10sNjA6WzIsNDddfSx7NTpbMiwzXSwxNDpbMiwzXSwxNTpbMiwzXSwxOTpbMiwzXSwyOTpbMiwzXSwzNDpbMiwzXSwzOTpbMiwzXSw0NDpbMiwzXSw0NzpbMiwzXSw0ODpbMiwzXSw1MTpbMiwzXSw1NTpbMiwzXSw2MDpbMiwzXX0sezU6WzIsNF0sMTQ6WzIsNF0sMTU6WzIsNF0sMTk6WzIsNF0sMjk6WzIsNF0sMzQ6WzIsNF0sMzk6WzIsNF0sNDQ6WzIsNF0sNDc6WzIsNF0sNDg6WzIsNF0sNTE6WzIsNF0sNTU6WzIsNF0sNjA6WzIsNF19LHs1OlsyLDVdLDE0OlsyLDVdLDE1OlsyLDVdLDE5OlsyLDVdLDI5OlsyLDVdLDM0OlsyLDVdLDM5OlsyLDVdLDQ0OlsyLDVdLDQ3OlsyLDVdLDQ4OlsyLDVdLDUxOlsyLDVdLDU1OlsyLDVdLDYwOlsyLDVdfSx7NTpbMiw2XSwxNDpbMiw2XSwxNTpbMiw2XSwxOTpbMiw2XSwyOTpbMiw2XSwzNDpbMiw2XSwzOTpbMiw2XSw0NDpbMiw2XSw0NzpbMiw2XSw0ODpbMiw2XSw1MTpbMiw2XSw1NTpbMiw2XSw2MDpbMiw2XX0sezU6WzIsN10sMTQ6WzIsN10sMTU6WzIsN10sMTk6WzIsN10sMjk6WzIsN10sMzQ6WzIsN10sMzk6WzIsN10sNDQ6WzIsN10sNDc6WzIsN10sNDg6WzIsN10sNTE6WzIsN10sNTU6WzIsN10sNjA6WzIsN119LHs1OlsyLDhdLDE0OlsyLDhdLDE1OlsyLDhdLDE5OlsyLDhdLDI5OlsyLDhdLDM0OlsyLDhdLDM5OlsyLDhdLDQ0OlsyLDhdLDQ3OlsyLDhdLDQ4OlsyLDhdLDUxOlsyLDhdLDU1OlsyLDhdLDYwOlsyLDhdfSx7NTpbMiw5XSwxNDpbMiw5XSwxNTpbMiw5XSwxOTpbMiw5XSwyOTpbMiw5XSwzNDpbMiw5XSwzOTpbMiw5XSw0NDpbMiw5XSw0NzpbMiw5XSw0ODpbMiw5XSw1MTpbMiw5XSw1NTpbMiw5XSw2MDpbMiw5XX0sezIwOjI1LDcyOlsxLDM1XSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezIwOjM2LDcyOlsxLDM1XSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezQ6MzcsNjozLDE0OlsyLDQ2XSwxNTpbMiw0Nl0sMTk6WzIsNDZdLDI5OlsyLDQ2XSwzNDpbMiw0Nl0sMzk6WzIsNDZdLDQ0OlsyLDQ2XSw0NzpbMiw0Nl0sNDg6WzIsNDZdLDUxOlsyLDQ2XSw1NTpbMiw0Nl0sNjA6WzIsNDZdfSx7NDozOCw2OjMsMTQ6WzIsNDZdLDE1OlsyLDQ2XSwxOTpbMiw0Nl0sMjk6WzIsNDZdLDM0OlsyLDQ2XSw0NDpbMiw0Nl0sNDc6WzIsNDZdLDQ4OlsyLDQ2XSw1MTpbMiw0Nl0sNTU6WzIsNDZdLDYwOlsyLDQ2XX0sezEzOjQwLDE1OlsxLDIwXSwxNzozOX0sezIwOjQyLDU2OjQxLDY0OjQzLDY1OlsxLDQ0XSw3MjpbMSwzNV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHs0OjQ1LDY6MywxNDpbMiw0Nl0sMTU6WzIsNDZdLDE5OlsyLDQ2XSwyOTpbMiw0Nl0sMzQ6WzIsNDZdLDQ3OlsyLDQ2XSw0ODpbMiw0Nl0sNTE6WzIsNDZdLDU1OlsyLDQ2XSw2MDpbMiw0Nl19LHs1OlsyLDEwXSwxNDpbMiwxMF0sMTU6WzIsMTBdLDE4OlsyLDEwXSwxOTpbMiwxMF0sMjk6WzIsMTBdLDM0OlsyLDEwXSwzOTpbMiwxMF0sNDQ6WzIsMTBdLDQ3OlsyLDEwXSw0ODpbMiwxMF0sNTE6WzIsMTBdLDU1OlsyLDEwXSw2MDpbMiwxMF19LHsyMDo0Niw3MjpbMSwzNV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHsyMDo0Nyw3MjpbMSwzNV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHsyMDo0OCw3MjpbMSwzNV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHsyMDo0Miw1Njo0OSw2NDo0Myw2NTpbMSw0NF0sNzI6WzEsMzVdLDc4OjI2LDc5OjI3LDgwOlsxLDI4XSw4MTpbMSwyOV0sODI6WzEsMzBdLDgzOlsxLDMxXSw4NDpbMSwzMl0sODU6WzEsMzRdLDg2OjMzfSx7MzM6WzIsNzhdLDQ5OjUwLDY1OlsyLDc4XSw3MjpbMiw3OF0sODA6WzIsNzhdLDgxOlsyLDc4XSw4MjpbMiw3OF0sODM6WzIsNzhdLDg0OlsyLDc4XSw4NTpbMiw3OF19LHsyMzpbMiwzM10sMzM6WzIsMzNdLDU0OlsyLDMzXSw2NTpbMiwzM10sNjg6WzIsMzNdLDcyOlsyLDMzXSw3NTpbMiwzM10sODA6WzIsMzNdLDgxOlsyLDMzXSw4MjpbMiwzM10sODM6WzIsMzNdLDg0OlsyLDMzXSw4NTpbMiwzM119LHsyMzpbMiwzNF0sMzM6WzIsMzRdLDU0OlsyLDM0XSw2NTpbMiwzNF0sNjg6WzIsMzRdLDcyOlsyLDM0XSw3NTpbMiwzNF0sODA6WzIsMzRdLDgxOlsyLDM0XSw4MjpbMiwzNF0sODM6WzIsMzRdLDg0OlsyLDM0XSw4NTpbMiwzNF19LHsyMzpbMiwzNV0sMzM6WzIsMzVdLDU0OlsyLDM1XSw2NTpbMiwzNV0sNjg6WzIsMzVdLDcyOlsyLDM1XSw3NTpbMiwzNV0sODA6WzIsMzVdLDgxOlsyLDM1XSw4MjpbMiwzNV0sODM6WzIsMzVdLDg0OlsyLDM1XSw4NTpbMiwzNV19LHsyMzpbMiwzNl0sMzM6WzIsMzZdLDU0OlsyLDM2XSw2NTpbMiwzNl0sNjg6WzIsMzZdLDcyOlsyLDM2XSw3NTpbMiwzNl0sODA6WzIsMzZdLDgxOlsyLDM2XSw4MjpbMiwzNl0sODM6WzIsMzZdLDg0OlsyLDM2XSw4NTpbMiwzNl19LHsyMzpbMiwzN10sMzM6WzIsMzddLDU0OlsyLDM3XSw2NTpbMiwzN10sNjg6WzIsMzddLDcyOlsyLDM3XSw3NTpbMiwzN10sODA6WzIsMzddLDgxOlsyLDM3XSw4MjpbMiwzN10sODM6WzIsMzddLDg0OlsyLDM3XSw4NTpbMiwzN119LHsyMzpbMiwzOF0sMzM6WzIsMzhdLDU0OlsyLDM4XSw2NTpbMiwzOF0sNjg6WzIsMzhdLDcyOlsyLDM4XSw3NTpbMiwzOF0sODA6WzIsMzhdLDgxOlsyLDM4XSw4MjpbMiwzOF0sODM6WzIsMzhdLDg0OlsyLDM4XSw4NTpbMiwzOF19LHsyMzpbMiwzOV0sMzM6WzIsMzldLDU0OlsyLDM5XSw2NTpbMiwzOV0sNjg6WzIsMzldLDcyOlsyLDM5XSw3NTpbMiwzOV0sODA6WzIsMzldLDgxOlsyLDM5XSw4MjpbMiwzOV0sODM6WzIsMzldLDg0OlsyLDM5XSw4NTpbMiwzOV19LHsyMzpbMiw0M10sMzM6WzIsNDNdLDU0OlsyLDQzXSw2NTpbMiw0M10sNjg6WzIsNDNdLDcyOlsyLDQzXSw3NTpbMiw0M10sODA6WzIsNDNdLDgxOlsyLDQzXSw4MjpbMiw0M10sODM6WzIsNDNdLDg0OlsyLDQzXSw4NTpbMiw0M10sODc6WzEsNTFdfSx7NzI6WzEsMzVdLDg2OjUyfSx7MjM6WzIsNDVdLDMzOlsyLDQ1XSw1NDpbMiw0NV0sNjU6WzIsNDVdLDY4OlsyLDQ1XSw3MjpbMiw0NV0sNzU6WzIsNDVdLDgwOlsyLDQ1XSw4MTpbMiw0NV0sODI6WzIsNDVdLDgzOlsyLDQ1XSw4NDpbMiw0NV0sODU6WzIsNDVdLDg3OlsyLDQ1XX0sezUyOjUzLDU0OlsyLDgyXSw2NTpbMiw4Ml0sNzI6WzIsODJdLDgwOlsyLDgyXSw4MTpbMiw4Ml0sODI6WzIsODJdLDgzOlsyLDgyXSw4NDpbMiw4Ml0sODU6WzIsODJdfSx7MjU6NTQsMzg6NTYsMzk6WzEsNThdLDQzOjU3LDQ0OlsxLDU5XSw0NTo1NSw0NzpbMiw1NF19LHsyODo2MCw0Mzo2MSw0NDpbMSw1OV0sNDc6WzIsNTZdfSx7MTM6NjMsMTU6WzEsMjBdLDE4OlsxLDYyXX0sezE1OlsyLDQ4XSwxODpbMiw0OF19LHszMzpbMiw4Nl0sNTc6NjQsNjU6WzIsODZdLDcyOlsyLDg2XSw4MDpbMiw4Nl0sODE6WzIsODZdLDgyOlsyLDg2XSw4MzpbMiw4Nl0sODQ6WzIsODZdLDg1OlsyLDg2XX0sezMzOlsyLDQwXSw2NTpbMiw0MF0sNzI6WzIsNDBdLDgwOlsyLDQwXSw4MTpbMiw0MF0sODI6WzIsNDBdLDgzOlsyLDQwXSw4NDpbMiw0MF0sODU6WzIsNDBdfSx7MzM6WzIsNDFdLDY1OlsyLDQxXSw3MjpbMiw0MV0sODA6WzIsNDFdLDgxOlsyLDQxXSw4MjpbMiw0MV0sODM6WzIsNDFdLDg0OlsyLDQxXSw4NTpbMiw0MV19LHsyMDo2NSw3MjpbMSwzNV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHsyNjo2Niw0NzpbMSw2N119LHszMDo2OCwzMzpbMiw1OF0sNjU6WzIsNThdLDcyOlsyLDU4XSw3NTpbMiw1OF0sODA6WzIsNThdLDgxOlsyLDU4XSw4MjpbMiw1OF0sODM6WzIsNThdLDg0OlsyLDU4XSw4NTpbMiw1OF19LHszMzpbMiw2NF0sMzU6NjksNjU6WzIsNjRdLDcyOlsyLDY0XSw3NTpbMiw2NF0sODA6WzIsNjRdLDgxOlsyLDY0XSw4MjpbMiw2NF0sODM6WzIsNjRdLDg0OlsyLDY0XSw4NTpbMiw2NF19LHsyMTo3MCwyMzpbMiw1MF0sNjU6WzIsNTBdLDcyOlsyLDUwXSw4MDpbMiw1MF0sODE6WzIsNTBdLDgyOlsyLDUwXSw4MzpbMiw1MF0sODQ6WzIsNTBdLDg1OlsyLDUwXX0sezMzOlsyLDkwXSw2MTo3MSw2NTpbMiw5MF0sNzI6WzIsOTBdLDgwOlsyLDkwXSw4MTpbMiw5MF0sODI6WzIsOTBdLDgzOlsyLDkwXSw4NDpbMiw5MF0sODU6WzIsOTBdfSx7MjA6NzUsMzM6WzIsODBdLDUwOjcyLDYzOjczLDY0Ojc2LDY1OlsxLDQ0XSw2OTo3NCw3MDo3Nyw3MTo3OCw3MjpbMSw3OV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHs3MjpbMSw4MF19LHsyMzpbMiw0Ml0sMzM6WzIsNDJdLDU0OlsyLDQyXSw2NTpbMiw0Ml0sNjg6WzIsNDJdLDcyOlsyLDQyXSw3NTpbMiw0Ml0sODA6WzIsNDJdLDgxOlsyLDQyXSw4MjpbMiw0Ml0sODM6WzIsNDJdLDg0OlsyLDQyXSw4NTpbMiw0Ml0sODc6WzEsNTFdfSx7MjA6NzUsNTM6ODEsNTQ6WzIsODRdLDYzOjgyLDY0Ojc2LDY1OlsxLDQ0XSw2OTo4Myw3MDo3Nyw3MTo3OCw3MjpbMSw3OV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHsyNjo4NCw0NzpbMSw2N119LHs0NzpbMiw1NV19LHs0Ojg1LDY6MywxNDpbMiw0Nl0sMTU6WzIsNDZdLDE5OlsyLDQ2XSwyOTpbMiw0Nl0sMzQ6WzIsNDZdLDM5OlsyLDQ2XSw0NDpbMiw0Nl0sNDc6WzIsNDZdLDQ4OlsyLDQ2XSw1MTpbMiw0Nl0sNTU6WzIsNDZdLDYwOlsyLDQ2XX0sezQ3OlsyLDIwXX0sezIwOjg2LDcyOlsxLDM1XSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezQ6ODcsNjozLDE0OlsyLDQ2XSwxNTpbMiw0Nl0sMTk6WzIsNDZdLDI5OlsyLDQ2XSwzNDpbMiw0Nl0sNDc6WzIsNDZdLDQ4OlsyLDQ2XSw1MTpbMiw0Nl0sNTU6WzIsNDZdLDYwOlsyLDQ2XX0sezI2Ojg4LDQ3OlsxLDY3XX0sezQ3OlsyLDU3XX0sezU6WzIsMTFdLDE0OlsyLDExXSwxNTpbMiwxMV0sMTk6WzIsMTFdLDI5OlsyLDExXSwzNDpbMiwxMV0sMzk6WzIsMTFdLDQ0OlsyLDExXSw0NzpbMiwxMV0sNDg6WzIsMTFdLDUxOlsyLDExXSw1NTpbMiwxMV0sNjA6WzIsMTFdfSx7MTU6WzIsNDldLDE4OlsyLDQ5XX0sezIwOjc1LDMzOlsyLDg4XSw1ODo4OSw2Mzo5MCw2NDo3Niw2NTpbMSw0NF0sNjk6OTEsNzA6NzcsNzE6NzgsNzI6WzEsNzldLDc4OjI2LDc5OjI3LDgwOlsxLDI4XSw4MTpbMSwyOV0sODI6WzEsMzBdLDgzOlsxLDMxXSw4NDpbMSwzMl0sODU6WzEsMzRdLDg2OjMzfSx7NjU6WzIsOTRdLDY2OjkyLDY4OlsyLDk0XSw3MjpbMiw5NF0sODA6WzIsOTRdLDgxOlsyLDk0XSw4MjpbMiw5NF0sODM6WzIsOTRdLDg0OlsyLDk0XSw4NTpbMiw5NF19LHs1OlsyLDI1XSwxNDpbMiwyNV0sMTU6WzIsMjVdLDE5OlsyLDI1XSwyOTpbMiwyNV0sMzQ6WzIsMjVdLDM5OlsyLDI1XSw0NDpbMiwyNV0sNDc6WzIsMjVdLDQ4OlsyLDI1XSw1MTpbMiwyNV0sNTU6WzIsMjVdLDYwOlsyLDI1XX0sezIwOjkzLDcyOlsxLDM1XSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezIwOjc1LDMxOjk0LDMzOlsyLDYwXSw2Mzo5NSw2NDo3Niw2NTpbMSw0NF0sNjk6OTYsNzA6NzcsNzE6NzgsNzI6WzEsNzldLDc1OlsyLDYwXSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezIwOjc1LDMzOlsyLDY2XSwzNjo5Nyw2Mzo5OCw2NDo3Niw2NTpbMSw0NF0sNjk6OTksNzA6NzcsNzE6NzgsNzI6WzEsNzldLDc1OlsyLDY2XSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezIwOjc1LDIyOjEwMCwyMzpbMiw1Ml0sNjM6MTAxLDY0Ojc2LDY1OlsxLDQ0XSw2OToxMDIsNzA6NzcsNzE6NzgsNzI6WzEsNzldLDc4OjI2LDc5OjI3LDgwOlsxLDI4XSw4MTpbMSwyOV0sODI6WzEsMzBdLDgzOlsxLDMxXSw4NDpbMSwzMl0sODU6WzEsMzRdLDg2OjMzfSx7MjA6NzUsMzM6WzIsOTJdLDYyOjEwMyw2MzoxMDQsNjQ6NzYsNjU6WzEsNDRdLDY5OjEwNSw3MDo3Nyw3MTo3OCw3MjpbMSw3OV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHszMzpbMSwxMDZdfSx7MzM6WzIsNzldLDY1OlsyLDc5XSw3MjpbMiw3OV0sODA6WzIsNzldLDgxOlsyLDc5XSw4MjpbMiw3OV0sODM6WzIsNzldLDg0OlsyLDc5XSw4NTpbMiw3OV19LHszMzpbMiw4MV19LHsyMzpbMiwyN10sMzM6WzIsMjddLDU0OlsyLDI3XSw2NTpbMiwyN10sNjg6WzIsMjddLDcyOlsyLDI3XSw3NTpbMiwyN10sODA6WzIsMjddLDgxOlsyLDI3XSw4MjpbMiwyN10sODM6WzIsMjddLDg0OlsyLDI3XSw4NTpbMiwyN119LHsyMzpbMiwyOF0sMzM6WzIsMjhdLDU0OlsyLDI4XSw2NTpbMiwyOF0sNjg6WzIsMjhdLDcyOlsyLDI4XSw3NTpbMiwyOF0sODA6WzIsMjhdLDgxOlsyLDI4XSw4MjpbMiwyOF0sODM6WzIsMjhdLDg0OlsyLDI4XSw4NTpbMiwyOF19LHsyMzpbMiwzMF0sMzM6WzIsMzBdLDU0OlsyLDMwXSw2ODpbMiwzMF0sNzE6MTA3LDcyOlsxLDEwOF0sNzU6WzIsMzBdfSx7MjM6WzIsOThdLDMzOlsyLDk4XSw1NDpbMiw5OF0sNjg6WzIsOThdLDcyOlsyLDk4XSw3NTpbMiw5OF19LHsyMzpbMiw0NV0sMzM6WzIsNDVdLDU0OlsyLDQ1XSw2NTpbMiw0NV0sNjg6WzIsNDVdLDcyOlsyLDQ1XSw3MzpbMSwxMDldLDc1OlsyLDQ1XSw4MDpbMiw0NV0sODE6WzIsNDVdLDgyOlsyLDQ1XSw4MzpbMiw0NV0sODQ6WzIsNDVdLDg1OlsyLDQ1XSw4NzpbMiw0NV19LHsyMzpbMiw0NF0sMzM6WzIsNDRdLDU0OlsyLDQ0XSw2NTpbMiw0NF0sNjg6WzIsNDRdLDcyOlsyLDQ0XSw3NTpbMiw0NF0sODA6WzIsNDRdLDgxOlsyLDQ0XSw4MjpbMiw0NF0sODM6WzIsNDRdLDg0OlsyLDQ0XSw4NTpbMiw0NF0sODc6WzIsNDRdfSx7NTQ6WzEsMTEwXX0sezU0OlsyLDgzXSw2NTpbMiw4M10sNzI6WzIsODNdLDgwOlsyLDgzXSw4MTpbMiw4M10sODI6WzIsODNdLDgzOlsyLDgzXSw4NDpbMiw4M10sODU6WzIsODNdfSx7NTQ6WzIsODVdfSx7NTpbMiwxM10sMTQ6WzIsMTNdLDE1OlsyLDEzXSwxOTpbMiwxM10sMjk6WzIsMTNdLDM0OlsyLDEzXSwzOTpbMiwxM10sNDQ6WzIsMTNdLDQ3OlsyLDEzXSw0ODpbMiwxM10sNTE6WzIsMTNdLDU1OlsyLDEzXSw2MDpbMiwxM119LHszODo1NiwzOTpbMSw1OF0sNDM6NTcsNDQ6WzEsNTldLDQ1OjExMiw0NjoxMTEsNDc6WzIsNzZdfSx7MzM6WzIsNzBdLDQwOjExMyw2NTpbMiw3MF0sNzI6WzIsNzBdLDc1OlsyLDcwXSw4MDpbMiw3MF0sODE6WzIsNzBdLDgyOlsyLDcwXSw4MzpbMiw3MF0sODQ6WzIsNzBdLDg1OlsyLDcwXX0sezQ3OlsyLDE4XX0sezU6WzIsMTRdLDE0OlsyLDE0XSwxNTpbMiwxNF0sMTk6WzIsMTRdLDI5OlsyLDE0XSwzNDpbMiwxNF0sMzk6WzIsMTRdLDQ0OlsyLDE0XSw0NzpbMiwxNF0sNDg6WzIsMTRdLDUxOlsyLDE0XSw1NTpbMiwxNF0sNjA6WzIsMTRdfSx7MzM6WzEsMTE0XX0sezMzOlsyLDg3XSw2NTpbMiw4N10sNzI6WzIsODddLDgwOlsyLDg3XSw4MTpbMiw4N10sODI6WzIsODddLDgzOlsyLDg3XSw4NDpbMiw4N10sODU6WzIsODddfSx7MzM6WzIsODldfSx7MjA6NzUsNjM6MTE2LDY0Ojc2LDY1OlsxLDQ0XSw2NzoxMTUsNjg6WzIsOTZdLDY5OjExNyw3MDo3Nyw3MTo3OCw3MjpbMSw3OV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHszMzpbMSwxMThdfSx7MzI6MTE5LDMzOlsyLDYyXSw3NDoxMjAsNzU6WzEsMTIxXX0sezMzOlsyLDU5XSw2NTpbMiw1OV0sNzI6WzIsNTldLDc1OlsyLDU5XSw4MDpbMiw1OV0sODE6WzIsNTldLDgyOlsyLDU5XSw4MzpbMiw1OV0sODQ6WzIsNTldLDg1OlsyLDU5XX0sezMzOlsyLDYxXSw3NTpbMiw2MV19LHszMzpbMiw2OF0sMzc6MTIyLDc0OjEyMyw3NTpbMSwxMjFdfSx7MzM6WzIsNjVdLDY1OlsyLDY1XSw3MjpbMiw2NV0sNzU6WzIsNjVdLDgwOlsyLDY1XSw4MTpbMiw2NV0sODI6WzIsNjVdLDgzOlsyLDY1XSw4NDpbMiw2NV0sODU6WzIsNjVdfSx7MzM6WzIsNjddLDc1OlsyLDY3XX0sezIzOlsxLDEyNF19LHsyMzpbMiw1MV0sNjU6WzIsNTFdLDcyOlsyLDUxXSw4MDpbMiw1MV0sODE6WzIsNTFdLDgyOlsyLDUxXSw4MzpbMiw1MV0sODQ6WzIsNTFdLDg1OlsyLDUxXX0sezIzOlsyLDUzXX0sezMzOlsxLDEyNV19LHszMzpbMiw5MV0sNjU6WzIsOTFdLDcyOlsyLDkxXSw4MDpbMiw5MV0sODE6WzIsOTFdLDgyOlsyLDkxXSw4MzpbMiw5MV0sODQ6WzIsOTFdLDg1OlsyLDkxXX0sezMzOlsyLDkzXX0sezU6WzIsMjJdLDE0OlsyLDIyXSwxNTpbMiwyMl0sMTk6WzIsMjJdLDI5OlsyLDIyXSwzNDpbMiwyMl0sMzk6WzIsMjJdLDQ0OlsyLDIyXSw0NzpbMiwyMl0sNDg6WzIsMjJdLDUxOlsyLDIyXSw1NTpbMiwyMl0sNjA6WzIsMjJdfSx7MjM6WzIsOTldLDMzOlsyLDk5XSw1NDpbMiw5OV0sNjg6WzIsOTldLDcyOlsyLDk5XSw3NTpbMiw5OV19LHs3MzpbMSwxMDldfSx7MjA6NzUsNjM6MTI2LDY0Ojc2LDY1OlsxLDQ0XSw3MjpbMSwzNV0sNzg6MjYsNzk6MjcsODA6WzEsMjhdLDgxOlsxLDI5XSw4MjpbMSwzMF0sODM6WzEsMzFdLDg0OlsxLDMyXSw4NTpbMSwzNF0sODY6MzN9LHs1OlsyLDIzXSwxNDpbMiwyM10sMTU6WzIsMjNdLDE5OlsyLDIzXSwyOTpbMiwyM10sMzQ6WzIsMjNdLDM5OlsyLDIzXSw0NDpbMiwyM10sNDc6WzIsMjNdLDQ4OlsyLDIzXSw1MTpbMiwyM10sNTU6WzIsMjNdLDYwOlsyLDIzXX0sezQ3OlsyLDE5XX0sezQ3OlsyLDc3XX0sezIwOjc1LDMzOlsyLDcyXSw0MToxMjcsNjM6MTI4LDY0Ojc2LDY1OlsxLDQ0XSw2OToxMjksNzA6NzcsNzE6NzgsNzI6WzEsNzldLDc1OlsyLDcyXSw3ODoyNiw3OToyNyw4MDpbMSwyOF0sODE6WzEsMjldLDgyOlsxLDMwXSw4MzpbMSwzMV0sODQ6WzEsMzJdLDg1OlsxLDM0XSw4NjozM30sezU6WzIsMjRdLDE0OlsyLDI0XSwxNTpbMiwyNF0sMTk6WzIsMjRdLDI5OlsyLDI0XSwzNDpbMiwyNF0sMzk6WzIsMjRdLDQ0OlsyLDI0XSw0NzpbMiwyNF0sNDg6WzIsMjRdLDUxOlsyLDI0XSw1NTpbMiwyNF0sNjA6WzIsMjRdfSx7Njg6WzEsMTMwXX0sezY1OlsyLDk1XSw2ODpbMiw5NV0sNzI6WzIsOTVdLDgwOlsyLDk1XSw4MTpbMiw5NV0sODI6WzIsOTVdLDgzOlsyLDk1XSw4NDpbMiw5NV0sODU6WzIsOTVdfSx7Njg6WzIsOTddfSx7NTpbMiwyMV0sMTQ6WzIsMjFdLDE1OlsyLDIxXSwxOTpbMiwyMV0sMjk6WzIsMjFdLDM0OlsyLDIxXSwzOTpbMiwyMV0sNDQ6WzIsMjFdLDQ3OlsyLDIxXSw0ODpbMiwyMV0sNTE6WzIsMjFdLDU1OlsyLDIxXSw2MDpbMiwyMV19LHszMzpbMSwxMzFdfSx7MzM6WzIsNjNdfSx7NzI6WzEsMTMzXSw3NjoxMzJ9LHszMzpbMSwxMzRdfSx7MzM6WzIsNjldfSx7MTU6WzIsMTJdfSx7MTQ6WzIsMjZdLDE1OlsyLDI2XSwxOTpbMiwyNl0sMjk6WzIsMjZdLDM0OlsyLDI2XSw0NzpbMiwyNl0sNDg6WzIsMjZdLDUxOlsyLDI2XSw1NTpbMiwyNl0sNjA6WzIsMjZdfSx7MjM6WzIsMzFdLDMzOlsyLDMxXSw1NDpbMiwzMV0sNjg6WzIsMzFdLDcyOlsyLDMxXSw3NTpbMiwzMV19LHszMzpbMiw3NF0sNDI6MTM1LDc0OjEzNiw3NTpbMSwxMjFdfSx7MzM6WzIsNzFdLDY1OlsyLDcxXSw3MjpbMiw3MV0sNzU6WzIsNzFdLDgwOlsyLDcxXSw4MTpbMiw3MV0sODI6WzIsNzFdLDgzOlsyLDcxXSw4NDpbMiw3MV0sODU6WzIsNzFdfSx7MzM6WzIsNzNdLDc1OlsyLDczXX0sezIzOlsyLDI5XSwzMzpbMiwyOV0sNTQ6WzIsMjldLDY1OlsyLDI5XSw2ODpbMiwyOV0sNzI6WzIsMjldLDc1OlsyLDI5XSw4MDpbMiwyOV0sODE6WzIsMjldLDgyOlsyLDI5XSw4MzpbMiwyOV0sODQ6WzIsMjldLDg1OlsyLDI5XX0sezE0OlsyLDE1XSwxNTpbMiwxNV0sMTk6WzIsMTVdLDI5OlsyLDE1XSwzNDpbMiwxNV0sMzk6WzIsMTVdLDQ0OlsyLDE1XSw0NzpbMiwxNV0sNDg6WzIsMTVdLDUxOlsyLDE1XSw1NTpbMiwxNV0sNjA6WzIsMTVdfSx7NzI6WzEsMTM4XSw3NzpbMSwxMzddfSx7NzI6WzIsMTAwXSw3NzpbMiwxMDBdfSx7MTQ6WzIsMTZdLDE1OlsyLDE2XSwxOTpbMiwxNl0sMjk6WzIsMTZdLDM0OlsyLDE2XSw0NDpbMiwxNl0sNDc6WzIsMTZdLDQ4OlsyLDE2XSw1MTpbMiwxNl0sNTU6WzIsMTZdLDYwOlsyLDE2XX0sezMzOlsxLDEzOV19LHszMzpbMiw3NV19LHszMzpbMiwzMl19LHs3MjpbMiwxMDFdLDc3OlsyLDEwMV19LHsxNDpbMiwxN10sMTU6WzIsMTddLDE5OlsyLDE3XSwyOTpbMiwxN10sMzQ6WzIsMTddLDM5OlsyLDE3XSw0NDpbMiwxN10sCgk0NzpbMiwxN10sNDg6WzIsMTddLDUxOlsyLDE3XSw1NTpbMiwxN10sNjA6WzIsMTddfV0sZGVmYXVsdEFjdGlvbnM6ezQ6WzIsMV0sNTU6WzIsNTVdLDU3OlsyLDIwXSw2MTpbMiw1N10sNzQ6WzIsODFdLDgzOlsyLDg1XSw4NzpbMiwxOF0sOTE6WzIsODldLDEwMjpbMiw1M10sMTA1OlsyLDkzXSwxMTE6WzIsMTldLDExMjpbMiw3N10sMTE3OlsyLDk3XSwxMjA6WzIsNjNdLDEyMzpbMiw2OV0sMTI0OlsyLDEyXSwxMzY6WzIsNzVdLDEzNzpbMiwzMl19LHBhcnNlRXJyb3I6ZnVuY3Rpb24odCxlKXt0aHJvdyBuZXcgRXJyb3IodCl9LHBhcnNlOmZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoKXt2YXIgdDtyZXR1cm4gdD1pLmxleGVyLmxleCgpfHwxLCJudW1iZXIiIT10eXBlb2YgdCYmKHQ9aS5zeW1ib2xzX1t0XXx8dCksdH12YXIgaT10aGlzLG49WzBdLHI9W251bGxdLHM9W10sbz10aGlzLnRhYmxlLGE9IiIsbD0wLGM9MCx1PTA7dGhpcy5sZXhlci5zZXRJbnB1dCh0KSx0aGlzLmxleGVyLnl5PXRoaXMueXksdGhpcy55eS5sZXhlcj10aGlzLmxleGVyLHRoaXMueXkucGFyc2VyPXRoaXMsInVuZGVmaW5lZCI9PXR5cGVvZiB0aGlzLmxleGVyLnl5bGxvYyYmKHRoaXMubGV4ZXIueXlsbG9jPXt9KTt2YXIgZD10aGlzLmxleGVyLnl5bGxvYztzLnB1c2goZCk7dmFyIGg9dGhpcy5sZXhlci5vcHRpb25zJiZ0aGlzLmxleGVyLm9wdGlvbnMucmFuZ2VzOyJmdW5jdGlvbiI9PXR5cGVvZiB0aGlzLnl5LnBhcnNlRXJyb3ImJih0aGlzLnBhcnNlRXJyb3I9dGhpcy55eS5wYXJzZUVycm9yKTtmb3IodmFyIHAsZixtLF8sZyx2LHksYix3LE09e307Oyl7aWYobT1uW24ubGVuZ3RoLTFdLHRoaXMuZGVmYXVsdEFjdGlvbnNbbV0/Xz10aGlzLmRlZmF1bHRBY3Rpb25zW21dOihudWxsIT09cCYmInVuZGVmaW5lZCIhPXR5cGVvZiBwfHwocD1lKCkpLF89b1ttXSYmb1ttXVtwXSksInVuZGVmaW5lZCI9PXR5cGVvZiBffHwhXy5sZW5ndGh8fCFfWzBdKXt2YXIgaz0iIjtpZighdSl7dz1bXTtmb3IodiBpbiBvW21dKXRoaXMudGVybWluYWxzX1t2XSYmdj4yJiZ3LnB1c2goIiciK3RoaXMudGVybWluYWxzX1t2XSsiJyIpO2s9dGhpcy5sZXhlci5zaG93UG9zaXRpb24/IlBhcnNlIGVycm9yIG9uIGxpbmUgIisobCsxKSsiOlxuIit0aGlzLmxleGVyLnNob3dQb3NpdGlvbigpKyJcbkV4cGVjdGluZyAiK3cuam9pbigiLCAiKSsiLCBnb3QgJyIrKHRoaXMudGVybWluYWxzX1twXXx8cCkrIiciOiJQYXJzZSBlcnJvciBvbiBsaW5lICIrKGwrMSkrIjogVW5leHBlY3RlZCAiKygxPT1wPyJlbmQgb2YgaW5wdXQiOiInIisodGhpcy50ZXJtaW5hbHNfW3BdfHxwKSsiJyIpLHRoaXMucGFyc2VFcnJvcihrLHt0ZXh0OnRoaXMubGV4ZXIubWF0Y2gsdG9rZW46dGhpcy50ZXJtaW5hbHNfW3BdfHxwLGxpbmU6dGhpcy5sZXhlci55eWxpbmVubyxsb2M6ZCxleHBlY3RlZDp3fSl9fWlmKF9bMF1pbnN0YW5jZW9mIEFycmF5JiZfLmxlbmd0aD4xKXRocm93IG5ldyBFcnJvcigiUGFyc2UgRXJyb3I6IG11bHRpcGxlIGFjdGlvbnMgcG9zc2libGUgYXQgc3RhdGU6ICIrbSsiLCB0b2tlbjogIitwKTtzd2l0Y2goX1swXSl7Y2FzZSAxOm4ucHVzaChwKSxyLnB1c2godGhpcy5sZXhlci55eXRleHQpLHMucHVzaCh0aGlzLmxleGVyLnl5bGxvYyksbi5wdXNoKF9bMV0pLHA9bnVsbCxmPyhwPWYsZj1udWxsKTooYz10aGlzLmxleGVyLnl5bGVuZyxhPXRoaXMubGV4ZXIueXl0ZXh0LGw9dGhpcy5sZXhlci55eWxpbmVubyxkPXRoaXMubGV4ZXIueXlsbG9jLHU+MCYmdS0tKTticmVhaztjYXNlIDI6aWYoeT10aGlzLnByb2R1Y3Rpb25zX1tfWzFdXVsxXSxNLiQ9cltyLmxlbmd0aC15XSxNLl8kPXtmaXJzdF9saW5lOnNbcy5sZW5ndGgtKHl8fDEpXS5maXJzdF9saW5lLGxhc3RfbGluZTpzW3MubGVuZ3RoLTFdLmxhc3RfbGluZSxmaXJzdF9jb2x1bW46c1tzLmxlbmd0aC0oeXx8MSldLmZpcnN0X2NvbHVtbixsYXN0X2NvbHVtbjpzW3MubGVuZ3RoLTFdLmxhc3RfY29sdW1ufSxoJiYoTS5fJC5yYW5nZT1bc1tzLmxlbmd0aC0oeXx8MSldLnJhbmdlWzBdLHNbcy5sZW5ndGgtMV0ucmFuZ2VbMV1dKSxnPXRoaXMucGVyZm9ybUFjdGlvbi5jYWxsKE0sYSxjLGwsdGhpcy55eSxfWzFdLHIscyksInVuZGVmaW5lZCIhPXR5cGVvZiBnKXJldHVybiBnO3kmJihuPW4uc2xpY2UoMCwtMSp5KjIpLHI9ci5zbGljZSgwLC0xKnkpLHM9cy5zbGljZSgwLC0xKnkpKSxuLnB1c2godGhpcy5wcm9kdWN0aW9uc19bX1sxXV1bMF0pLHIucHVzaChNLiQpLHMucHVzaChNLl8kKSxiPW9bbltuLmxlbmd0aC0yXV1bbltuLmxlbmd0aC0xXV0sbi5wdXNoKGIpO2JyZWFrO2Nhc2UgMzpyZXR1cm4hMH19cmV0dXJuITB9fSxpPWZ1bmN0aW9uKCl7dmFyIHQ9e0VPRjoxLHBhcnNlRXJyb3I6ZnVuY3Rpb24odCxlKXtpZighdGhpcy55eS5wYXJzZXIpdGhyb3cgbmV3IEVycm9yKHQpO3RoaXMueXkucGFyc2VyLnBhcnNlRXJyb3IodCxlKX0sc2V0SW5wdXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2lucHV0PXQsdGhpcy5fbW9yZT10aGlzLl9sZXNzPXRoaXMuZG9uZT0hMSx0aGlzLnl5bGluZW5vPXRoaXMueXlsZW5nPTAsdGhpcy55eXRleHQ9dGhpcy5tYXRjaGVkPXRoaXMubWF0Y2g9IiIsdGhpcy5jb25kaXRpb25TdGFjaz1bIklOSVRJQUwiXSx0aGlzLnl5bGxvYz17Zmlyc3RfbGluZToxLGZpcnN0X2NvbHVtbjowLGxhc3RfbGluZToxLGxhc3RfY29sdW1uOjB9LHRoaXMub3B0aW9ucy5yYW5nZXMmJih0aGlzLnl5bGxvYy5yYW5nZT1bMCwwXSksdGhpcy5vZmZzZXQ9MCx0aGlzfSxpbnB1dDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2lucHV0WzBdO3RoaXMueXl0ZXh0Kz10LHRoaXMueXlsZW5nKyssdGhpcy5vZmZzZXQrKyx0aGlzLm1hdGNoKz10LHRoaXMubWF0Y2hlZCs9dDt2YXIgZT10Lm1hdGNoKC8oPzpcclxuP3xcbikuKi9nKTtyZXR1cm4gZT8odGhpcy55eWxpbmVubysrLHRoaXMueXlsbG9jLmxhc3RfbGluZSsrKTp0aGlzLnl5bGxvYy5sYXN0X2NvbHVtbisrLHRoaXMub3B0aW9ucy5yYW5nZXMmJnRoaXMueXlsbG9jLnJhbmdlWzFdKyssdGhpcy5faW5wdXQ9dGhpcy5faW5wdXQuc2xpY2UoMSksdH0sdW5wdXQ6ZnVuY3Rpb24odCl7dmFyIGU9dC5sZW5ndGgsaT10LnNwbGl0KC8oPzpcclxuP3xcbikvZyk7dGhpcy5faW5wdXQ9dCt0aGlzLl9pbnB1dCx0aGlzLnl5dGV4dD10aGlzLnl5dGV4dC5zdWJzdHIoMCx0aGlzLnl5dGV4dC5sZW5ndGgtZS0xKSx0aGlzLm9mZnNldC09ZTt2YXIgbj10aGlzLm1hdGNoLnNwbGl0KC8oPzpcclxuP3xcbikvZyk7dGhpcy5tYXRjaD10aGlzLm1hdGNoLnN1YnN0cigwLHRoaXMubWF0Y2gubGVuZ3RoLTEpLHRoaXMubWF0Y2hlZD10aGlzLm1hdGNoZWQuc3Vic3RyKDAsdGhpcy5tYXRjaGVkLmxlbmd0aC0xKSxpLmxlbmd0aC0xJiYodGhpcy55eWxpbmVuby09aS5sZW5ndGgtMSk7dmFyIHI9dGhpcy55eWxsb2MucmFuZ2U7cmV0dXJuIHRoaXMueXlsbG9jPXtmaXJzdF9saW5lOnRoaXMueXlsbG9jLmZpcnN0X2xpbmUsbGFzdF9saW5lOnRoaXMueXlsaW5lbm8rMSxmaXJzdF9jb2x1bW46dGhpcy55eWxsb2MuZmlyc3RfY29sdW1uLGxhc3RfY29sdW1uOmk/KGkubGVuZ3RoPT09bi5sZW5ndGg/dGhpcy55eWxsb2MuZmlyc3RfY29sdW1uOjApK25bbi5sZW5ndGgtaS5sZW5ndGhdLmxlbmd0aC1pWzBdLmxlbmd0aDp0aGlzLnl5bGxvYy5maXJzdF9jb2x1bW4tZX0sdGhpcy5vcHRpb25zLnJhbmdlcyYmKHRoaXMueXlsbG9jLnJhbmdlPVtyWzBdLHJbMF0rdGhpcy55eWxlbmctZV0pLHRoaXN9LG1vcmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbW9yZT0hMA==", "base64"));
  res.write(new Buffer("LHRoaXN9LGxlc3M6ZnVuY3Rpb24odCl7dGhpcy51bnB1dCh0aGlzLm1hdGNoLnNsaWNlKHQpKX0scGFzdElucHV0OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5tYXRjaGVkLnN1YnN0cigwLHRoaXMubWF0Y2hlZC5sZW5ndGgtdGhpcy5tYXRjaC5sZW5ndGgpO3JldHVybih0Lmxlbmd0aD4yMD8iLi4uIjoiIikrdC5zdWJzdHIoLTIwKS5yZXBsYWNlKC9cbi9nLCIiKX0sdXBjb21pbmdJbnB1dDpmdW5jdGlvbigpe3ZhciB0PXRoaXMubWF0Y2g7cmV0dXJuIHQubGVuZ3RoPDIwJiYodCs9dGhpcy5faW5wdXQuc3Vic3RyKDAsMjAtdC5sZW5ndGgpKSwodC5zdWJzdHIoMCwyMCkrKHQubGVuZ3RoPjIwPyIuLi4iOiIiKSkucmVwbGFjZSgvXG4vZywiIil9LHNob3dQb3NpdGlvbjpmdW5jdGlvbigpe3ZhciB0PXRoaXMucGFzdElucHV0KCksZT1uZXcgQXJyYXkodC5sZW5ndGgrMSkuam9pbigiLSIpO3JldHVybiB0K3RoaXMudXBjb21pbmdJbnB1dCgpKyJcbiIrZSsiXiJ9LG5leHQ6ZnVuY3Rpb24oKXtpZih0aGlzLmRvbmUpcmV0dXJuIHRoaXMuRU9GO3RoaXMuX2lucHV0fHwodGhpcy5kb25lPSEwKTt2YXIgdCxlLGksbixyO3RoaXMuX21vcmV8fCh0aGlzLnl5dGV4dD0iIix0aGlzLm1hdGNoPSIiKTtmb3IodmFyIHM9dGhpcy5fY3VycmVudFJ1bGVzKCksbz0wO288cy5sZW5ndGgmJihpPXRoaXMuX2lucHV0Lm1hdGNoKHRoaXMucnVsZXNbc1tvXV0pLCFpfHxlJiYhKGlbMF0ubGVuZ3RoPmVbMF0ubGVuZ3RoKXx8KGU9aSxuPW8sdGhpcy5vcHRpb25zLmZsZXgpKTtvKyspO3JldHVybiBlPyhyPWVbMF0ubWF0Y2goLyg/OlxyXG4/fFxuKS4qL2cpLHImJih0aGlzLnl5bGluZW5vKz1yLmxlbmd0aCksdGhpcy55eWxsb2M9e2ZpcnN0X2xpbmU6dGhpcy55eWxsb2MubGFzdF9saW5lLGxhc3RfbGluZTp0aGlzLnl5bGluZW5vKzEsZmlyc3RfY29sdW1uOnRoaXMueXlsbG9jLmxhc3RfY29sdW1uLGxhc3RfY29sdW1uOnI/cltyLmxlbmd0aC0xXS5sZW5ndGgtcltyLmxlbmd0aC0xXS5tYXRjaCgvXHI/XG4/LylbMF0ubGVuZ3RoOnRoaXMueXlsbG9jLmxhc3RfY29sdW1uK2VbMF0ubGVuZ3RofSx0aGlzLnl5dGV4dCs9ZVswXSx0aGlzLm1hdGNoKz1lWzBdLHRoaXMubWF0Y2hlcz1lLHRoaXMueXlsZW5nPXRoaXMueXl0ZXh0Lmxlbmd0aCx0aGlzLm9wdGlvbnMucmFuZ2VzJiYodGhpcy55eWxsb2MucmFuZ2U9W3RoaXMub2Zmc2V0LHRoaXMub2Zmc2V0Kz10aGlzLnl5bGVuZ10pLHRoaXMuX21vcmU9ITEsdGhpcy5faW5wdXQ9dGhpcy5faW5wdXQuc2xpY2UoZVswXS5sZW5ndGgpLHRoaXMubWF0Y2hlZCs9ZVswXSx0PXRoaXMucGVyZm9ybUFjdGlvbi5jYWxsKHRoaXMsdGhpcy55eSx0aGlzLHNbbl0sdGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aC0xXSksdGhpcy5kb25lJiZ0aGlzLl9pbnB1dCYmKHRoaXMuZG9uZT0hMSksdD90OnZvaWQgMCk6IiI9PT10aGlzLl9pbnB1dD90aGlzLkVPRjp0aGlzLnBhcnNlRXJyb3IoIkxleGljYWwgZXJyb3Igb24gbGluZSAiKyh0aGlzLnl5bGluZW5vKzEpKyIuIFVucmVjb2duaXplZCB0ZXh0LlxuIit0aGlzLnNob3dQb3NpdGlvbigpLHt0ZXh0OiIiLHRva2VuOm51bGwsbGluZTp0aGlzLnl5bGluZW5vfSl9LGxleDpmdW5jdGlvbigpe3ZhciB0PXRoaXMubmV4dCgpO3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgdD90OnRoaXMubGV4KCl9LGJlZ2luOmZ1bmN0aW9uKHQpe3RoaXMuY29uZGl0aW9uU3RhY2sucHVzaCh0KX0scG9wU3RhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25kaXRpb25TdGFjay5wb3AoKX0sX2N1cnJlbnRSdWxlczpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbmRpdGlvbnNbdGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aC0xXV0ucnVsZXN9LHRvcFN0YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29uZGl0aW9uU3RhY2tbdGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGgtMl19LHB1c2hTdGF0ZTpmdW5jdGlvbih0KXt0aGlzLmJlZ2luKHQpfX07cmV0dXJuIHQub3B0aW9ucz17fSx0LnBlcmZvcm1BY3Rpb249ZnVuY3Rpb24odCxlLGksbil7ZnVuY3Rpb24gcih0LGkpe3JldHVybiBlLnl5dGV4dD1lLnl5dGV4dC5zdWJzdHIodCxlLnl5bGVuZy1pKX1zd2l0Y2goaSl7Y2FzZSAwOmlmKCJcXFxcIj09PWUueXl0ZXh0LnNsaWNlKC0yKT8ocigwLDEpLHRoaXMuYmVnaW4oIm11IikpOiJcXCI9PT1lLnl5dGV4dC5zbGljZSgtMSk/KHIoMCwxKSx0aGlzLmJlZ2luKCJlbXUiKSk6dGhpcy5iZWdpbigibXUiKSxlLnl5dGV4dClyZXR1cm4gMTU7YnJlYWs7Y2FzZSAxOnJldHVybiAxNTtjYXNlIDI6cmV0dXJuIHRoaXMucG9wU3RhdGUoKSwxNTtjYXNlIDM6cmV0dXJuIHRoaXMuYmVnaW4oInJhdyIpLDE1O2Nhc2UgNDpyZXR1cm4gdGhpcy5wb3BTdGF0ZSgpLCJyYXciPT09dGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aC0xXT8xNTooZS55eXRleHQ9ZS55eXRleHQuc3Vic3RyKDUsZS55eWxlbmctOSksIkVORF9SQVdfQkxPQ0siKTtjYXNlIDU6cmV0dXJuIDE1O2Nhc2UgNjpyZXR1cm4gdGhpcy5wb3BTdGF0ZSgpLDE0O2Nhc2UgNzpyZXR1cm4gNjU7Y2FzZSA4OnJldHVybiA2ODtjYXNlIDk6cmV0dXJuIDE5O2Nhc2UgMTA6cmV0dXJuIHRoaXMucG9wU3RhdGUoKSx0aGlzLmJlZ2luKCJyYXciKSwyMztjYXNlIDExOnJldHVybiA1NTtjYXNlIDEyOnJldHVybiA2MDtjYXNlIDEzOnJldHVybiAyOTtjYXNlIDE0OnJldHVybiA0NztjYXNlIDE1OnJldHVybiB0aGlzLnBvcFN0YXRlKCksNDQ7Y2FzZSAxNjpyZXR1cm4gdGhpcy5wb3BTdGF0ZSgpLDQ0O2Nhc2UgMTc6cmV0dXJuIDM0O2Nhc2UgMTg6cmV0dXJuIDM5O2Nhc2UgMTk6cmV0dXJuIDUxO2Nhc2UgMjA6cmV0dXJuIDQ4O2Nhc2UgMjE6dGhpcy51bnB1dChlLnl5dGV4dCksdGhpcy5wb3BTdGF0ZSgpLHRoaXMuYmVnaW4oImNvbSIpO2JyZWFrO2Nhc2UgMjI6cmV0dXJuIHRoaXMucG9wU3RhdGUoKSwxNDtjYXNlIDIzOnJldHVybiA0ODtjYXNlIDI0OnJldHVybiA3MztjYXNlIDI1OnJldHVybiA3MjtjYXNlIDI2OnJldHVybiA3MjtjYXNlIDI3OnJldHVybiA4NztjYXNlIDI4OmJyZWFrO2Nhc2UgMjk6cmV0dXJuIHRoaXMucG9wU3RhdGUoKSw1NDtjYXNlIDMwOnJldHVybiB0aGlzLnBvcFN0YXRlKCksMzM7Y2FzZSAzMTpyZXR1cm4gZS55eXRleHQ9cigxLDIpLnJlcGxhY2UoL1xcIi9nLCciJyksODA7Y2FzZSAzMjpyZXR1cm4gZS55eXRleHQ9cigxLDIpLnJlcGxhY2UoL1xcJy9nLCInIiksODA7Y2FzZSAzMzpyZXR1cm4gODU7Y2FzZSAzNDpyZXR1cm4gODI7Y2FzZSAzNTpyZXR1cm4gODI7Y2FzZSAzNjpyZXR1cm4gODM7Y2FzZSAzNzpyZXR1cm4gODQ7Y2FzZSAzODpyZXR1cm4gODE7Y2FzZSAzOTpyZXR1cm4gNzU7Y2FzZSA0MDpyZXR1cm4gNzc7Y2FzZSA0MTpyZXR1cm4gNzI7Y2FzZSA0MjpyZXR1cm4gZS55eXRleHQ9ZS55eXRleHQucmVwbGFjZSgvXFwoW1xcXF1dKS9nLCIkMSIpLDcyO2Nhc2UgNDM6cmV0dXJuIklOVkFMSUQiO2Nhc2UgNDQ6cmV0dXJuIDV9fSx0LnJ1bGVzPVsvXig/OlteXHgwMF0qPyg/PShce1x7KSkpLywvXig/OlteXHgwMF0rKS8sL14oPzpbXlx4MDBdezIsfT8oPz0oXHtce3xcXFx7XHt8XFxcXFx7XHt8JCkpKS8sL14oPzpce1x7XHtceyg/PVteXC9dKSkvLC9eKD86XHtce1x7XHtcL1teXHMhIiMlLSxcLlwvOy0+QFxbLVxeYFx7LX5dKyg/PVs9fVxzXC8uXSlcfVx9XH1cfSkvLC9eKD86W15ceDAwXSo/KD89KFx7XHtce1x7KSkpLywvXig/Oltcc1xTXSo/LS0ofik/XH1cfSkvLC9eKD86XCgpLywvXig/OlwpKS8sL14oPzpce1x7XHtceykvLC9eKD86XH1cfVx9XH0pLywvXig/Olx7XHsofik/PikvLC9eKD86XHtceyh+KT8jPikvLC9eKD86XHtceyh+KT8jXCo/KS8sL14oPzpce1x7KH4pP1wvKS8sL14oPzpce1x7KH4pP1xeXHMqKH4pP1x9XH0pLywvXig/Olx7XHsofik/XHMqZWxzZVxzKih+KT9cfVx9KS8sL14oPzpce1x7KH4pP1xeKS8sL14oPzpce1x7KH4pP1xzKmVsc2VcYikvLC9eKD86XHtceyh+KT9ceykvLC9eKD86XHtceyh+KT8mKS8sL14oPzpce1x7KH4pPyEtLSkvLC9eKD86XHtceyh+KT8hW1xzXFNdKj9cfVx9KS8sL14oPzpce1x7KH4pP1wqPykvLC9eKD86PSkvLC9eKD86XC5cLikvLC9eKD86XC4oPz0oWz1+fVxzXC8uKXxdKSkpLywvXig/OltcLy5dKS8sL14oPzpccyspLywvXig/Olx9KH4pP1x9XH0pLywvXig/Oih+KT9cfVx9KS8sL14oPzoiKFxcWyJdfFteIl0pKiIpLywvXig/OicoXFxbJ118W14nXSkqJykvLC9eKD86QCkvLC9eKD86dHJ1ZSg/PShbfn1ccyldKSkpLywvXig/OmZhbHNlKD89KFt+fVxzKV0pKSkvLC9eKD86dW5kZWZpbmVkKD89KFt+fVxzKV0pKSkvLC9eKD86bnVsbCg/PShbfn1ccyldKSkpLywvXig/Oi0/WzAtOV0rKD86XC5bMC05XSspPyg/PShbfn1ccyldKSkpLywvXig/OmFzXHMrXHwpLywvXig/Olx8KS8sL14oPzooW15ccyEiIyUtLFwuXC87LT5AXFstXF5gXHstfl0rKD89KFs9fn1cc1wvLil8XSkpKSkvLC9eKD86XFsoXFxcXXxbXlxdXSkqXF0pLywvXig/Oi4pLywvXig/OiQpL10sdC5jb25kaXRpb25zPXttdTp7cnVsZXM6WzcsOCw5LDEwLDExLDEyLDEzLDE0LDE1LDE2LDE3LDE4LDE5LDIwLDIxLDIyLDIzLDI0LDI1LDI2LDI3LDI4LDI5LDMwLDMxLDMyLDMzLDM0LDM1LDM2LDM3LDM4LDM5LDQwLDQxLDQyLDQzLDQ0XSxpbmNsdXNpdmU6ITF9LGVtdTp7cnVsZXM6WzJdLGluY2x1c2l2ZTohMX0sY29tOntydWxlczpbNl0saW5jbHVzaXZlOiExfSxyYXc6e3J1bGVzOlszLDQsNV0saW5jbHVzaXZlOiExfSxJTklUSUFMOntydWxlczpbMCwxLDQ0XSxpbmNsdXNpdmU6ITB9fSx0fSgpO3JldHVybiBlLmxleGVyPWksdC5wcm90b3R5cGU9ZSxlLlBhcnNlcj10LG5ldyB0fSgpO2UuX19lc01vZHVsZT0hMCxlWyJkZWZhdWx0Il09aX0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKCl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aDw9MHx8dm9pZCAwPT09YXJndW1lbnRzWzBdP3t9OmFyZ3VtZW50c1swXTt0aGlzLm9wdGlvbnM9dH1mdW5jdGlvbiByKHQsZSxpKXt2b2lkIDA9PT1lJiYoZT10Lmxlbmd0aCk7dmFyIG49dFtlLTFdLHI9dFtlLTJdO3JldHVybiBuPyJDb250ZW50U3RhdGVtZW50Ij09PW4udHlwZT8ocnx8IWk/L1xyP1xuXHMqPyQvOi8oXnxccj9cbilccyo/JC8pLnRlc3Qobi5vcmlnaW5hbCk6dm9pZCAwOml9ZnVuY3Rpb24gcyh0LGUsaSl7dm9pZCAwPT09ZSYmKGU9LTEpO3ZhciBuPXRbZSsxXSxyPXRbZSsyXTtyZXR1cm4gbj8iQ29udGVudFN0YXRlbWVudCI9PT1uLnR5cGU/KHJ8fCFpPy9eXHMqP1xyP1xuLzovXlxzKj8oXHI/XG58JCkvKS50ZXN0KG4ub3JpZ2luYWwpOnZvaWQgMDppfWZ1bmN0aW9uIG8odCxlLGkpe3ZhciBuPXRbbnVsbD09ZT8wOmUrMV07aWYobiYmIkNvbnRlbnRTdGF0ZW1lbnQiPT09bi50eXBlJiYoaXx8IW4ucmlnaHRTdHJpcHBlZCkpe3ZhciByPW4udmFsdWU7bi52YWx1ZT1uLnZhbHVlLnJlcGxhY2UoaT8vXlxzKy86L15bIFx0XSpccj9cbj8vLCIiKSxuLnJpZ2h0U3RyaXBwZWQ9bi52YWx1ZSE9PXJ9fWZ1bmN0aW9uIGEodCxlLGkpe3ZhciBuPXRbbnVsbD09ZT90Lmxlbmd0aC0xOmUtMV07aWYobiYmIkNvbnRlbnRTdGF0ZW1lbnQiPT09bi50eXBlJiYoaXx8IW4ubGVmdFN0cmlwcGVkKSl7dmFyIHI9bi52YWx1ZTtyZXR1cm4gbi52YWx1ZT1uLnZhbHVlLnJlcGxhY2UoaT8vXHMrJC86L1sgXHRdKyQvLCIiKSxuLmxlZnRTdHJpcHBlZD1uLnZhbHVlIT09cixuLmxlZnRTdHJpcHBlZH19dmFyIGw9aSgxKVsiZGVmYXVsdCJdO2UuX19lc01vZHVsZT0hMDt2YXIgYz1pKDI1KSx1PWwoYyk7bi5wcm90b3R5cGU9bmV3IHVbImRlZmF1bHQiXSxuLnByb3RvdHlwZS5Qcm9ncmFtPWZ1bmN0aW9uKHQpe3ZhciBlPSF0aGlzLm9wdGlvbnMuaWdub3JlU3RhbmRhbG9uZSxpPSF0aGlzLmlzUm9vdFNlZW47dGhpcy5pc1Jvb3RTZWVuPSEwO2Zvcih2YXIgbj10LmJvZHksbD0wLGM9bi5sZW5ndGg7bDxjO2wrKyl7dmFyIHU9bltsXSxkPXRoaXMuYWNjZXB0KHUpO2lmKGQpe3ZhciBoPXIobixsLGkpLHA9cyhuLGwsaSksZj1kLm9wZW5TdGFuZGFsb25lJiZoLG09ZC5jbG9zZVN0YW5kYWxvbmUmJnAsXz1kLmlubGluZVN0YW5kYWxvbmUmJmgmJnA7ZC5jbG9zZSYmbyhuLGwsITApLGQub3BlbiYmYShuLGwsITApLGUmJl8mJihvKG4sbCksYShuLGwpJiYiUGFydGlhbFN0YXRlbWVudCI9PT11LnR5cGUmJih1LmluZGVudD0vKFsgXHRdKyQpLy5leGVjKG5bbC0xXS5vcmlnaW5hbClbMV0pKSxlJiZmJiYobygodS5wcm9ncmFtfHx1LmludmVyc2UpLmJvZHkpLGEobixsKSksZSYmbSYmKG8obixsKSxhKCh1LmludmVyc2V8fHUucHJvZ3JhbSkuYm9keSkpfX1yZXR1cm4gdH0sbi5wcm90b3R5cGUuQmxvY2tTdGF0ZW1lbnQ9bi5wcm90b3R5cGUuRGVjb3JhdG9yQmxvY2s9bi5wcm90b3R5cGUuUGFydGlhbEJsb2NrU3RhdGVtZW50PWZ1bmN0aW9uKHQpe3RoaXMuYWNjZXB0KHQucHJvZ3JhbSksdGhpcy5hY2NlcHQodC5pbnZlcnNlKTt2YXIgZT10LnByb2dyYW18fHQuaW52ZXJzZSxpPXQucHJvZ3JhbSYmdC5pbnZlcnNlLG49aSxsPWk7aWYoaSYmaS5jaGFpbmVkKWZvcihuPWkuYm9keVswXS5wcm9ncmFtO2wuY2hhaW5lZDspbD1sLmJvZHlbbC5ib2R5Lmxlbmd0aC0xXS5wcm9ncmFtO3ZhciBjPXtvcGVuOnQub3BlblN0cmlwLm9wZW4sY2xvc2U6dC5jbG9zZVN0cmlwLmNsb3NlLG9wZW5TdGFuZGFsb25lOnMoZS5ib2R5KSxjbG9zZVN0YW5kYWxvbmU6cigobnx8ZSkuYm9keSl9O2lmKHQub3BlblN0cmlwLmNsb3NlJiZvKGUuYm9keSxudWxsLCEwKSxpKXt2YXIgdT10LmludmVyc2VTdHJpcDt1Lm9wZW4mJmEoZS5ib2R5LG51bGwsITApLHUuY2xvc2UmJm8obi5ib2R5LG51bGwsITApLHQuY2xvc2VTdHJpcC5vcGVuJiZhKGwuYm9keSxudWxsLCEwKSwhdGhpcy5vcHRpb25zLmlnbm9yZVN0YW5kYWxvbmUmJnIoZS5ib2R5KSYmcyhuLmJvZHkpJiYoYShlLmJvZHkpLG8obi5ib2R5KSl9ZWxzZSB0LmNsb3NlU3RyaXAub3BlbiYmYShlLmJvZHksbnVsbCwhMCk7cmV0dXJuIGN9LG4ucHJvdG90eXBlLkRlY29yYXRvcj1uLnByb3RvdHlwZS5NdXN0YWNoZVN0YXRlbWVudD1mdW5jdGlvbih0KXtyZXR1cm4gdC5zdHJpcH0sbi5wcm90b3R5cGUuUGFydGlhbFN0YXRlbWVudD1uLnByb3RvdHlwZS5Db21tZW50U3RhdGVtZW50PWZ1bmN0aW9uKHQpe3ZhciBlPXQuc3RyaXB8fHt9O3JldHVybntpbmxpbmVTdGFuZGFsb25lOiEwLG9wZW46ZS5vcGVuLGNsb3NlOmUuY2xvc2V9fSxlWyJkZWZhdWx0Il09bix0LmV4cG9ydHM9ZVsiZGVmYXVsdCJdfSxmdW5jdGlvbih0LGUsaSl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oKXt0aGlzLnBhcmVudHM9W119ZnVuY3Rpb24gcih0KXt0aGlzLmFjY2VwdFJlcXVpcmVkKHQsInBhdGgiKSx0aGlzLmFjY2VwdEFycmF5KHQucGFyYW1zKSx0aGlzLmFjY2VwdEtleSh0LCJoYXNoIil9ZnVuY3Rpb24gcyh0KXtyLmNhbGwodGhpcyx0KSx0aGlzLmFjY2VwdEtleSh0LCJwcm9ncmFtIiksdGhpcy5hY2NlcHRLZXkodCwiaW52ZXJzZSIpfWZ1bmN0aW9uIG8odCl7dGhpcy5hY2NlcHRSZXF1aXJlZCh0LCJuYW1lIiksdGhpcy5hY2NlcHRBcnJheSh0LnBhcmFtcyksdGhpcy5hY2NlcHRLZXkodCwiaGFzaCIpfXZhciBhPWkoMSlbImRlZmF1bHQiXTtlLl9fZXNNb2R1bGU9ITA7dmFyIGw9aSg2KSxjPWEobCk7bi5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOm4sbXV0YXRpbmc6ITEsYWNjZXB0S2V5OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5hY2NlcHQodFtlXSk7aWYodGhpcy5tdXRhdGluZyl7aWYoaSYmIW4ucHJvdG90eXBlW2kudHlwZV0pdGhyb3cgbmV3IGNbImRlZmF1bHQiXSgnVW5leHBlY3RlZCBub2RlIHR5cGUgIicraS50eXBlKyciIGZvdW5kIHdoZW4gYWNjZXB0aW5nICcrZSsiIG9uICIrdC50eXBlKTt0W2VdPWl9fSxhY2NlcHRSZXF1aXJlZDpmdW5jdGlvbih0LGUpe2lmKHRoaXMuYWNjZXB0S2V5KHQsZSksIXRbZV0pdGhyb3cgbmV3IGNbImRlZmF1bHQiXSh0LnR5cGUrIiByZXF1aXJlcyAiK2UpfSxhY2NlcHRBcnJheTpmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxpPXQubGVuZ3RoO2U8aTtlKyspdGhpcy5hY2NlcHRLZXkodCxlKSx0W2VdfHwodC5zcGxpY2UoZSwxKSxlLS0saS0tKX0sYWNjZXB0OmZ1bmN0aW9uKHQpe2lmKHQpe2lmKCF0aGlzW3QudHlwZV0pdGhyb3cgbmV3IGNbImRlZmF1bHQiXSgiVW5rbm93biB0eXBlOiAiK3QudHlwZSx0KTt0aGlzLmN1cnJlbnQmJnRoaXMucGFyZW50cy51bnNoaWZ0KHRoaXMuY3VycmVudCksdGhpcy5jdXJyZW50PXQ7dmFyIGU9dGhpc1t0LnR5cGVdKHQpO3JldHVybiB0aGlzLmN1cnJlbnQ9dGhpcy5wYXJlbnRzLnNoaWZ0KCksIXRoaXMubXV0YXRpbmd8fGU/ZTplIT09ITE/dDp2b2lkIDB9fSxQcm9ncmFtOmZ1bmN0aW9uKHQpe3RoaXMuYWNjZXB0QXJyYXkodC5ib2R5KX0sTXVzdGFjaGVTdGF0ZW1lbnQ6cixEZWNvcmF0b3I6cixCbG9ja1N0YXRlbWVudDpzLERlY29yYXRvckJsb2NrOnMsUGFydGlhbFN0YXRlbWVudDpvLFBhcnRpYWxCbG9ja1N0YXRlbWVudDpmdW5jdGlvbih0KXtvLmNhbGwodGhpcyx0KSx0aGlzLmFjY2VwdEtleSh0LCJwcm9ncmFtIil9LENvbnRlbnRTdGF0ZW1lbnQ6ZnVuY3Rpb24oKXt9LENvbW1lbnRTdGF0ZW1lbnQ6ZnVuY3Rpb24oKXt9LFN1YkV4cHJlc3Npb246cixQYXRoRXhwcmVzc2lvbjpmdW5jdGlvbigpe30sU3RyaW5nTGl0ZXJhbDpmdW5jdGlvbigpe30sTnVtYmVyTGl0ZXJhbDpmdW5jdGlvbigpe30sQm9vbGVhbkxpdGVyYWw6ZnVuY3Rpb24oKXt9LFVuZGVmaW5lZExpdGVyYWw6ZnVuY3Rpb24oKXt9LE51bGxMaXRlcmFsOmZ1bmN0aW9uKCl7fSxIYXNoOmZ1bmN0aW9uKHQpe3RoaXMuYWNjZXB0QXJyYXkodC5wYWlycyl9LEhhc2hQYWlyOmZ1bmN0aW9uKHQpe3RoaXMuYWNjZXB0UmVxdWlyZWQodCwidmFsdWUiKX19LGVbImRlZmF1bHQiXT1uLHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbih0LGUpe2lmKGU9ZS5wYXRoP2UucGF0aC5vcmlnaW5hbDplLHQucGF0aC5vcmlnaW5hbCE9PWUpe3ZhciBpPXtsb2M6dC5wYXRoLmxvY307dGhyb3cgbmV3IF9bImRlZmF1bHQiXSh0LnBhdGgub3JpZ2luYWwrIiBkb2Vzbid0IG1hdGNoICIrZSxpKX19ZnVuY3Rpb24gcih0LGUpe3RoaXMuc291cmNlPXQsdGhpcy5zdGFydD17bGluZTplLmZpcnN0X2xpbmUsY29sdW1uOmUuZmlyc3RfY29sdW1ufSx0aGlzLmVuZD17bGluZTplLmxhc3RfbGluZSxjb2x1bW46ZS5sYXN0X2NvbHVtbn19ZnVuY3Rpb24gcyh0KXtyZXR1cm4vXlxbLipcXSQvLnRlc3QodCk/dC5zdWJzdHIoMSx0Lmxlbmd0aC0yKTp0fWZ1bmN0aW9uIG8odCxlKXtyZXR1cm57b3BlbjoifiI9PT10LmNoYXJBdCgyKSxjbG9zZToifiI9PT1lLmNoYXJBdChlLmxlbmd0aC0zKX19ZnVuY3Rpb24gYSh0KXtyZXR1cm4gdC5yZXBsYWNlKC9eXHtce34/XCEtPy0/LywiIikucmVwbGFjZSgvLT8tP34/XH1cfSQvLCIiKX1mdW5jdGlvbiBsKHQsZSxpKXtpPXRoaXMubG9jSW5mbyhpKTtmb3IodmFyIG49dD8iQCI6IiIscj1bXSxzPTAsbz0iIixhPTAsbD1lLmxlbmd0aDthPGw7YSsrKXt2YXIgYz1lW2FdLnBhcnQsdT1lW2FdLm9yaWdpbmFsIT09YztpZihuKz0oZVthXS5zZXBhcmF0b3J8fCIiKStjLHV8fCIuLiIhPT1jJiYiLiIhPT1jJiYidGhpcyIhPT1jKXIucHVzaChjKTtlbHNle2lmKHIubGVuZ3RoPjApdGhyb3cgbmV3IF9bImRlZmF1bHQiXSgiSW52YWxpZCBwYXRoOiAiK24se2xvYzppfSk7Ii4uIj09PWMmJihzKyssbys9Ii4uLyIpfX1yZXR1cm57dHlwZToiUGF0aEV4cHJlc3Npb24iLGRhdGE6dCxkZXB0aDpzLHBhcnRzOnIsb3JpZ2luYWw6bixsb2M6aX19ZnVuY3Rpb24gYyh0LGUsaSxuLHIscyl7dmFyIG89bi5jaGFyQXQoMyl8fG4uY2hhckF0KDIpLGE9InsiIT09byYmIiYiIT09byxsPS9cKi8udGVzdChuKTtyZXR1cm57dHlwZTpsPyJEZWNvcmF0b3IiOiJNdXN0YWNoZVN0YXRlbWVudCIscGF0aDp0LHBhcmFtczplLGhhc2g6aSxlc2NhcGVkOmEsc3RyaXA6cixsb2M6dGhpcy5sb2NJbmZvKHMpfX1mdW5jdGlvbiB1KHQsZSxpLHIpe24odCxpKSxyPXRoaXMubG9jSW5mbyhyKTt2YXIgcz17dHlwZToiUHJvZ3JhbSIsYm9keTplLHN0cmlwOnt9LGxvYzpyfTtyZXR1cm57dHlwZToiQmxvY2tTdGF0ZW1lbnQiLHBhdGg6dC5wYXRoLHBhcmFtczp0LnBhcmFtcyxoYXNoOnQuaGFzaCxwcm9ncmFtOnMsb3BlblN0cmlwOnt9LGludmVyc2VTdHJpcDp7fSxjbG9zZVN0cmlwOnt9LGxvYzpyfX1mdW5jdGlvbiBkKHQsZSxpLHIscyxvKXtyJiZyLnBhdGgmJm4odCxyKTt2YXIgYT0vXCovLnRlc3QodC5vcGVuKTtlLmJsb2NrUGFyYW1zPXQuYmxvY2tQYXJhbXM7dmFyIGw9dm9pZCAwLGM9dm9pZCAwO2lmKGkpe2lmKGEpdGhyb3cgbmV3IF9bImRlZmF1bHQiXSgiVW5leHBlY3RlZCBpbnZlcnNlIGJsb2NrIG9uIGRlY29yYXRvciIsaSk7aS5jaGFpbiYmKGkucHJvZ3JhbS5ib2R5WzBdLmNsb3NlU3RyaXA9ci5zdHJpcCksYz1pLnN0cmlwLGw9aS5wcm9ncmFtfXJldHVybiBzJiYocz1sLGw9ZSxlPXMpLHt0eXBlOmE/IkRlY29yYXRvckJsb2NrIjoiQmxvY2tTdGF0ZW1lbnQiLHBhdGg6dC5wYXRoLHBhcmFtczp0LnBhcmFtcyxoYXNoOnQuaGFzaCxwcm9ncmFtOmUsaW52ZXJzZTpsLG9wZW5TdHJpcDp0LnN0cmlwLGludmVyc2VTdHJpcDpjLGNsb3NlU3RyaXA6ciYmci5zdHJpcCxsb2M6dGhpcy5sb2NJbmZvKG8pfX1mdW5jdGlvbiBoKHQsZSl7aWYoIWUmJnQubGVuZ3RoKXt2YXIgaT10WzBdLmxvYyxuPXRbdC5sZW5ndGgtMV0ubG9jO2kmJm4mJihlPXtzb3VyY2U6aS5zb3VyY2Usc3RhcnQ6e2xpbmU6aS5zdGFydC5saW5lLGNvbHVtbjppLnN0YXJ0LmNvbHVtbn0sZW5kOntsaW5lOm4uZW5kLmxpbmUsY29sdW1uOm4uZW5kLmNvbHVtbn19KX1yZXR1cm57dHlwZToiUHJvZ3JhbSIsYm9keTp0LHN0cmlwOnt9LGxvYzplfX1mdW5jdGlvbiBwKHQsZSxpLHIpe3JldHVybiBuKHQsaSkse3R5cGU6IlBhcnRpYWxCbG9ja1N0YXRlbWVudCIsbmFtZTp0LnBhdGgscGFyYW1zOnQucGFyYW1zLGhhc2g6dC5oYXNoLHByb2dyYW06ZSxvcGVuU3RyaXA6dC5zdHJpcCxjbG9zZVN0cmlwOmkmJmkuc3RyaXAsbG9jOnRoaXMubG9jSW5mbyhyKX19dmFyIGY9aSgxKVsiZGVmYXVsdCJdO2UuX19lc01vZHVsZT0hMCxlLlNvdXJjZUxvY2F0aW9uPXIsZS5pZD1zLGUuc3RyaXBGbGFncz1vLGUuc3RyaXBDb21tZW50PWEsZS5wcmVwYXJlUGF0aD1sLGUucHJlcGFyZU11c3RhY2hlPWMsZS5wcmVwYXJlUmF3QmxvY2s9dSxlLnByZXBhcmVCbG9jaz1kLGUucHJlcGFyZVByb2dyYW09aCxlLnByZXBhcmVQYXJ0aWFsQmxvY2s9cDt2YXIgbT1pKDYpLF89ZihtKX0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKCl7fWZ1bmN0aW9uIHIodCxlLGkpe2lmKG51bGw9PXR8fCJzdHJpbmciIT10eXBlb2YgdCYmIlByb2dyYW0iIT09dC50eXBlKXRocm93IG5ldyB1WyJkZWZhdWx0Il0oIllvdSBtdXN0IHBhc3MgYSBzdHJpbmcgb3IgSGFuZGxlYmFycyBBU1QgdG8gSGFuZGxlYmFycy5wcmVjb21waWxlLiBZb3UgcGFzc2VkICIrdCk7ZT1lfHx7fSwiZGF0YSJpbiBlfHwoZS5kYXRhPSEwKSxlLmNvbXBhdCYmKGUudXNlRGVwdGhzPSEwKTt2YXIgbj1pLnBhcnNlKHQsZSkscj0obmV3IGkuQ29tcGlsZXIpLmNvbXBpbGUobixlKTtyZXR1cm4obmV3IGkuSmF2YVNjcmlwdENvbXBpbGVyKS5jb21waWxlKHIsZSl9ZnVuY3Rpb24gcyh0LGUsaSl7ZnVuY3Rpb24gbigpe3ZhciBuPWkucGFyc2UodCxlKSxyPShuZXcgaS5Db21waWxlcikuY29tcGlsZShuLGUpLHM9KG5ldyBpLkphdmFTY3JpcHRDb21waWxlcikuY29tcGlsZShyLGUsdm9pZCAwLCEwKTtyZXR1cm4gaS50ZW1wbGF0ZShzKX1mdW5jdGlvbiByKHQsZSl7cmV0dXJuIHN8fChzPW4oKSkscy5jYWxsKHRoaXMsdCxlKX1pZih2b2lkIDA9PT1lJiYoZT17fSksbnVsbD09dHx8InN0cmluZyIhPXR5cGVvZiB0JiYiUHJvZ3JhbSIhPT10LnR5cGUpdGhyb3cgbmV3IHVbImRlZmF1bHQiXSgiWW91IG11c3QgcGFzcyBhIHN0cmluZyBvciBIYW5kbGViYXJzIEFTVCB0byBIYW5kbGViYXJzLmNvbXBpbGUuIFlvdSBwYXNzZWQgIit0KTsiZGF0YSJpbiBlfHwoZS5kYXRhPSEwKSxlLmNvbXBhdCYmKGUudXNlRGVwdGhzPSEwKTt2YXIgcz12b2lkIDA7cmV0dXJuIHIuX3NldHVwPWZ1bmN0aW9uKHQpe3JldHVybiBzfHwocz1uKCkpLHMuX3NldHVwKHQpfSxyLl9jaGlsZD1mdW5jdGlvbih0LGUsaSxyKXtyZXR1cm4gc3x8KHM9bigpKSxzLl9jaGlsZCh0LGUsaSxyKX0scn1mdW5jdGlvbiBvKHQsZSl7aWYodD09PWUpcmV0dXJuITA7aWYoZC5pc0FycmF5KHQpJiZkLmlzQXJyYXkoZSkmJnQubGVuZ3RoPT09ZS5sZW5ndGgpe2Zvcih2YXIgaT0wO2k8dC5sZW5ndGg7aSsrKWlmKCFvKHRbaV0sZVtpXSkpcmV0dXJuITE7cmV0dXJuITB9fWZ1bmN0aW9uIGEodCl7aWYoIXQucGF0aC5wYXJ0cyl7dmFyIGU9dC5wYXRoO3QucGF0aD17dHlwZToiUGF0aEV4cHJlc3Npb24iLGRhdGE6ITEsZGVwdGg6MCxwYXJ0czpbZS5vcmlnaW5hbCsiIl0sb3JpZ2luYWw6ZS5vcmlnaW5hbCsiIixsb2M6ZS5sb2N9fX12YXIgbD1pKDEpWyJkZWZhdWx0Il07ZS5fX2VzTW9kdWxlPSEwLGUuQ29tcGlsZXI9bixlLnByZWNvbXBpbGU9cixlLmNvbXBpbGU9czt2YXIgYz1pKDYpLHU9bChjKSxkPWkoNSksaD1pKDIxKSxwPWwoaCksZj1bXS5zbGljZTtuLnByb3RvdHlwZT17Y29tcGlsZXI6bixlcXVhbHM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5vcGNvZGVzLmxlbmd0aDtpZih0Lm9wY29kZXMubGVuZ3RoIT09ZSlyZXR1cm4hMTtmb3IodmFyIGk9MDtpPGU7aSsrKXt2YXIgbj10aGlzLm9wY29kZXNbaV0scj10Lm9wY29kZXNbaV07aWYobi5vcGNvZGUhPT1yLm9wY29kZXx8IW8obi5hcmdzLHIuYXJncykpcmV0dXJuITF9ZT10aGlzLmNoaWxkcmVuLmxlbmd0aDtmb3IodmFyIGk9MDtpPGU7aSsrKWlmKCF0aGlzLmNoaWxkcmVuW2ldLmVxdWFscyh0LmNoaWxkcmVuW2ldKSlyZXR1cm4hMTtyZXR1cm4hMH0sZ3VpZDowLGNvbXBpbGU6ZnVuY3Rpb24odCxlKXt0aGlzLnNvdXJjZU5vZGU9W10sdGhpcy5vcGNvZGVzPVtdLHRoaXMuY2hpbGRyZW49W10sdGhpcy5vcHRpb25zPWUsdGhpcy5zdHJpbmdQYXJhbXM9ZS5zdHJpbmdQYXJhbXMsdGhpcy50cmFja0lkcz1lLnRyYWNrSWRzLGUuYmxvY2tQYXJhbXM9ZS5ibG9ja1BhcmFtc3x8W107dmFyIGk9ZS5rbm93bkhlbHBlcnM7aWYoZS5rbm93bkhlbHBlcnM9e2hlbHBlck1pc3Npbmc6ITAsYmxvY2tIZWxwZXJNaXNzaW5nOiEwLGVhY2g6ITAsImlmIjohMCx1bmxlc3M6ITAsIndpdGgiOiEwLGxvZzohMCxsb29rdXA6ITB9LGkpZm9yKHZhciBuIGluIGkpbiBpbiBpJiYoZS5rbm93bkhlbHBlcnNbbl09aVtuXSk7cmV0dXJuIHRoaXMuYWNjZXB0KHQpfSxjb21waWxlUHJvZ3JhbTpmdW5jdGlvbih0KXt2YXIgZT1uZXcgdGhpcy5jb21waWxlcixpPWUuY29tcGlsZSh0LHRoaXMub3B0aW9ucyksbj10aGlzLmd1aWQrKztyZXR1cm4gdGhpcy51c2VQYXJ0aWFsPXRoaXMudXNlUGFydGlhbHx8aS51c2VQYXJ0aWFsLHRoaXMuY2hpbGRyZW5bbl09aSx0aGlzLnVzZURlcHRocz10aGlzLnVzZURlcHRoc3x8aS51c2VEZXB0aHMsbn0sYWNjZXB0OmZ1bmN0aW9uKHQpe2lmKCF0aGlzW3QudHlwZV0pdGhyb3cgbmV3IHVbImRlZmF1bHQiXSgiVW5rbm93biB0eXBlOiAiK3QudHlwZSx0KTt0aGlzLnNvdXJjZU5vZGUudW5zaGlmdCh0KTt2YXIgZT10aGlzW3QudHlwZV0odCk7cmV0dXJuIHRoaXMuc291cmNlTm9kZS5zaGlmdCgpLGV9LFByb2dyYW06ZnVuY3Rpb24odCl7dGhpcy5vcHRpb25zLmJsb2NrUGFyYW1zLnVuc2hpZnQodC5ibG9ja1BhcmFtcyk7Zm9yKHZhciBlPXQuYm9keSxpPWUubGVuZ3RoLG49MDtuPGk7bisrKXRoaXMuYWNjZXB0KGVbbl0pO3JldHVybiB0aGlzLm9wdGlvbnMuYmxvY2tQYXJhbXMuc2hpZnQoKSx0aGlzLmlzU2ltcGxlPTE9PT1pLHRoaXMuYmxvY2tQYXJhbXM9dC5ibG9ja1BhcmFtcz90LmJsb2NrUGFyYW1zLmxlbmd0aDowLHRoaXN9LEJsb2NrU3RhdGVtZW50OmZ1bmN0aW9uKHQpe2EodCk7dmFyIGU9dC5wcm9ncmFtLGk9dC5pbnZlcnNlO2U9ZSYmdGhpcy5jb21waWxlUHJvZ3JhbShlKSxpPWkmJnRoaXMuY29tcGlsZVByb2dyYW0oaSk7dmFyIG49dGhpcy5jbGFzc2lmeVNleHByKHQpOyJoZWxwZXIiPT09bj90aGlzLmhlbHBlclNleHByKHQsZSxpKToic2ltcGxlIj09PW4/KHRoaXMuc2ltcGxlU2V4cHIodCksdGhpcy5vcGNvZGUoInB1c2hQcm9ncmFtIixlKSx0aGlzLm9wY29kZSgicHVzaFByb2dyYW0iLGkpLHRoaXMub3Bjb2RlKCJlbXB0eUhhc2giKSx0aGlzLm9wY29kZSgiYmxvY2tWYWx1ZSIsdC5wYXRoLm9yaWdpbmFsKSk6KHRoaXMuYW1iaWd1b3VzU2V4cHIodCxlLGkpLHRoaXMub3Bjb2RlKCJwdXNoUHJvZ3JhbSIsZSksdGhpcy5vcGNvZGUoInB1c2hQcm9ncmFtIixpKSx0aGlzLm9wY29kZSgiZW1wdHlIYXNoIiksdGhpcy5vcGNvZGUoImFtYmlndW91c0Jsb2NrVmFsdWUiKSksdGhpcy5vcGNvZGUoImFwcGVuZCIpfSxEZWNvcmF0b3JCbG9jazpmdW5jdGlvbih0KXt2YXIgZT10LnByb2dyYW0mJnRoaXMuY29tcGlsZVByb2dyYW0odC5wcm9ncmFtKSxpPXRoaXMuc2V0dXBGdWxsTXVzdGFjaGVQYXJhbXModCxlLHZvaWQgMCksbj10LnBhdGg7dGhpcy51c2VEZWNvcmF0b3JzPSEwLHRoaXMub3Bjb2RlKCJyZWdpc3RlckRlY29yYXRvciIsaS5sZW5ndGgsbi5vcmlnaW5hbCl9LFBhcnRpYWxTdGF0ZW1lbnQ6ZnVuY3Rpb24odCl7dGhpcy51c2VQYXJ0aWFsPSEwO3ZhciBlPXQucHJvZ3JhbTtlJiYoZT10aGlzLmNvbXBpbGVQcm9ncmFtKHQucHJvZ3JhbSkpO3ZhciBpPXQucGFyYW1zO2lmKGkubGVuZ3RoPjEpdGhyb3cgbmV3IHVbImRlZmF1bHQiXSgiVW5zdXBwb3J0ZWQgbnVtYmVyIG9mIHBhcnRpYWwgYXJndW1lbnRzOiAiK2kubGVuZ3RoLHQpO2kubGVuZ3RofHwodGhpcy5vcHRpb25zLmV4cGxpY2l0UGFydGlhbENvbnRleHQ/dGhpcy5vcGNvZGUoInB1c2hMaXRlcmFsIiwidW5kZWZpbmVkIik6aS5wdXNoKHt0eXBlOiJQYXRoRXhwcmVzc2lvbiIscGFydHM6W10sZGVwdGg6MH0pKTt2YXIgbj10Lm5hbWUub3JpZ2luYWwscj0iU3ViRXhwcmVzc2lvbiI9PT10Lm5hbWUudHlwZTtyJiZ0aGlzLmFjY2VwdCh0Lm5hbWUpLHRoaXMuc2V0dXBGdWxsTXVzdGFjaGVQYXJhbXModCxlLHZvaWQgMCwhMCk7dmFyIHM9dC5pbmRlbnR8fCIiO3RoaXMub3B0aW9ucy5wcmV2ZW50SW5kZW50JiZzJiYodGhpcy5vcGNvZGUoImFwcGVuZENvbnRlbnQiLHMpLHM9IiIpLHRoaXMub3Bjb2RlKCJpbnZva2VQYXJ0aWFsIixyLG4scyksdGhpcy5vcGNvZGUoImFwcGVuZCIpfSxQYXJ0aWFsQmxvY2tTdGF0ZW1lbnQ6ZnVuY3Rpb24odCl7dGhpcy5QYXJ0aWFsU3RhdGVtZW50KHQpfSxNdXN0YWNoZVN0YXRlbWVudDpmdW5jdGlvbih0KXt0aGlzLlN1YkV4cHJlc3Npb24odCksdC5lc2NhcGVkJiYhdGhpcy5vcHRpb25zLm5vRXNjYXBlP3RoaXMub3Bjb2RlKCJhcHBlbmRFc2NhcGVkIik6dGhpcy5vcGNvZGUoImFwcGVuZCIpfSxEZWNvcmF0b3I6ZnVuY3Rpb24odCl7dGhpcy5EZWNvcmF0b3JCbG9jayh0KX0sQ29udGVudFN0YXRlbWVudDpmdW5jdGlvbih0KXt0LnZhbHVlJiZ0aGlzLm9wY29kZSgiYXBwZW5kQ29udGVudCIsdC52YWx1ZSl9LENvbW1lbnRTdGF0ZW1lbnQ6ZnVuY3Rpb24oKXt9LFN1YkV4cHJlc3Npb246ZnVuY3Rpb24odCl7YSh0KTt2YXIgZT10aGlzLmNsYXNzaWZ5U2V4cHIodCk7InNpbXBsZSI9PT1lP3RoaXMuc2ltcGxlU2V4cHIodCk6ImhlbHBlciI9PT1lP3RoaXMuaGVscGVyU2V4cHIodCk6dGhpcy5hbWJpZ3VvdXNTZXhwcih0KX0sYW1iaWd1b3VzU2V4cHI6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXQucGF0aCxyPW4ucGFydHNbMF0scz1udWxsIT1lfHxudWxsIT1pO3RoaXMub3Bjb2RlKCJnZXRDb250ZXh0IixuLmRlcHRoKSx0aGlzLm9wY29kZSgicHVzaFByb2dyYW0iLGUpLHRoaXMub3Bjb2RlKCJwdXNoUHJvZ3JhbSIsaSksbi5zdHJpY3Q9ITAsdGhpcy5hY2NlcHQobiksdGhpcy5vcGNvZGUoImludm9rZUFtYmlndW91cyIscixzKX0sc2ltcGxlU2V4cHI6ZnVuY3Rpb24odCl7dmFyIGU9dC5wYXRoO2Uuc3RyaWN0PSEwLHRoaXMuYWNjZXB0KGUpLHRoaXMub3Bjb2RlKCJyZXNvbHZlUG9zc2libGVMYW1iZGEiKX0saGVscGVyU2V4cHI6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXRoaXMuc2V0dXBGdWxsTXVzdGFjaGVQYXJhbXModCxlLGkpLHI9dC5wYXRoLHM9ci5wYXJ0c1swXTtpZih0aGlzLm9wdGlvbnMua25vd25IZWxwZXJzW3NdKXRoaXMub3Bjb2RlKCJpbnZva2VLbm93bkhlbHBlciIsbi5sZW5ndGgscyk7ZWxzZXtpZih0aGlzLm9wdGlvbnMua25vd25IZWxwZXJzT25seSl0aHJvdyBuZXcgdVsiZGVmYXVsdCJdKCJZb3Ugc3BlY2lmaWVkIGtub3duSGVscGVyc09ubHksIGJ1dCB1c2VkIHRoZSB1bmtub3duIGhlbHBlciAiK3MsdCk7ci5zdHJpY3Q9ITAsci5mYWxzeT0hMCx0aGlzLmFjY2VwdChyKSx0aGlzLm9wY29kZSgiaW52b2tlSGVscGVyIixuLmxlbmd0aCxyLm9yaWdpbmFsLHBbImRlZmF1bHQiXS5oZWxwZXJzLnNpbXBsZUlkKHIpKX19LFBhdGhFeHByZXNzaW9uOmZ1bmN0aW9uKHQpe3RoaXMuYWRkRGVwdGgodC5kZXB0aCksdGhpcy5vcGNvZGUoImdldENvbnRleHQiLHQuZGVwdGgpO3ZhciBlPXQucGFydHNbMF0saT1wWyJkZWZhdWx0Il0uaGVscGVycy5zY29wZWRJZCh0KSxuPSF0LmRlcHRoJiYhaSYmdGhpcy5ibG9ja1BhcmFtSW5kZXgoZSk7bj90aGlzLm9wY29kZSgibG9va3VwQmxvY2tQYXJhbSIsbix0LnBhcnRzKTplP3QuZGF0YT8odGhpcy5vcHRpb25zLmRhdGE9ITAsdGhpcy5vcGNvZGUoImxvb2t1cERhdGEiLHQuZGVwdGgsdC5wYXJ0cyx0LnN0cmljdCkpOnRoaXMub3Bjb2RlKCJsb29rdXBPbkNvbnRleHQiLHQucGFydHMsdC5mYWxzeSx0LnN0cmljdCxpKTp0aGlzLm9wY29kZSgicHVzaENvbnRleHQiKX0sU3RyaW5nTGl0ZXJhbDpmdW5jdGlvbih0KXt0aGlzLm9wY29kZSgicHVzaFN0cmluZyIsdC52YWx1ZSl9LE51bWJlckxpdGVyYWw6ZnVuY3Rpb24odCl7dGhpcy5vcGNvZGUoInB1c2hMaXRlcmFsIix0LnZhbHVlKX0sQm9vbGVhbkxpdGVyYWw6ZnVuY3Rpb24odCl7dGhpcy5vcGNvZGUoInB1c2hMaXRlcmFsIix0LnZhbHVlKX0sVW5kZWZpbmVkTGl0ZXJhbDpmdW5jdGlvbigpe3RoaXMub3Bjb2RlKCJwdXNoTGl0ZXJhbCIsInVuZGVmaW5lZCIpfSxOdWxsTGl0ZXJhbDpmdW5jdGlvbigpe3RoaXMub3Bjb2RlKCJwdXNoTGl0ZXJhbCIsIm51bGwiKX0sSGFzaDpmdW5jdGlvbih0KXt2YXIgZT10LnBhaXJzLGk9MCxuPWUubGVuZ3RoO2Zvcih0aGlzLm9wY29kZSgicHVzaEhhc2giKTtpPG47aSsrKXRoaXMucHVzaFBhcmFtKGVbaV0udmFsdWUpO2Zvcig7aS0tOyl0aGlzLm9wY29kZSgiYXNzaWduVG9IYXNoIixlW2ldLmtleSk7dGhpcy5vcGNvZGUoInBvcEhhc2giKX0sb3Bjb2RlOmZ1bmN0aW9uKHQpe3RoaXMub3Bjb2Rlcy5wdXNoKHtvcGNvZGU6dCxhcmdzOmYuY2FsbChhcmd1bWVudHMsMSksbG9jOnRoaXMuc291cmNlTm9kZVswXS5sb2N9KX0sYWRkRGVwdGg6ZnVuY3Rpb24odCl7dCYmKHRoaXMudXNlRGVwdGhzPSEwKX0sY2xhc3NpZnlTZXhwcjpmdW5jdGlvbih0KXt2YXIgZT1wWyJkZWZhdWx0Il0uaGVscGVycy5zaW1wbGVJZCh0LnBhdGgpLGk9ZSYmISF0aGlzLmJsb2NrUGFyYW1JbmRleCh0LnBhdGgucGFydHNbMF0pLG49IWkmJnBbImRlZmF1bHQiXS5oZWxwZXJzLmhlbHBlckV4cHJlc3Npb24odCkscj0haSYmKG58fGUpO2lmKHImJiFuKXt2YXIgcz10LnBhdGgucGFydHNbMF0sbz10aGlzLm9wdGlvbnM7by5rbm93bkhlbHBlcnNbc10/bj0hMDpvLmtub3duSGVscGVyc09ubHkmJihyPSExKX1yZXR1cm4gbj8iaGVscGVyIjpyPyJhbWJpZ3VvdXMiOiJzaW1wbGUifSxwdXNoUGFyYW1zOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLGk9dC5sZW5ndGg7ZTxpO2UrKyl0aGlzLnB1c2hQYXJhbSh0W2VdKX0scHVzaFBhcmFtOmZ1bmN0aW9uKHQpe3ZhciBlPW51bGwhPXQudmFsdWU/dC52YWx1ZTp0Lm9yaWdpbmFsfHwiIjtpZih0aGlzLnN0cmluZ1BhcmFtcyllLnJlcGxhY2UmJihlPWUucmVwbGFjZSgvXihcLj9cLlwvKSovZywiIikucmVwbGFjZSgvXC8vZywiLiIpKSx0LmRlcHRoJiZ0aGlzLmFkZERlcHRoKHQuZGVwdGgpLHRoaXMub3Bjb2RlKCJnZXRDb250ZXh0Iix0LmRlcHRofHwwKSx0aGlzLm9wY29kZSgicHVzaFN0cmluZ1BhcmFtIixlLHQudHlwZSksIlN1YkV4cHJlc3Npb24iPT09dC50eXBlJiZ0aGlzLmFjY2VwdCh0KTtlbHNle2lmKHRoaXMudHJhY2tJZHMpe3ZhciBpPXZvaWQgMDtpZighdC5wYXJ0c3x8cFsiZGVmYXVsdCJdLmhlbHBlcnMuc2NvcGVkSWQodCl8fHQuZGVwdGh8fChpPXRoaXMuYmxvY2tQYXJhbUluZGV4KHQucGFydHNbMF0pKSxpKXt2YXIgbj10LnBhcnRzLnNsaWNlKDEpLmpvaW4oIi4iKTt0aGlzLm9wY29kZSgicHVzaElkIiwiQmxvY2tQYXJhbSIsaSxuKX1lbHNlIGU9dC5vcmlnaW5hbHx8ZSxlLnJlcGxhY2UmJihlPWUucmVwbGFjZSgvXnRoaXMoPzpcLnwkKS8sIiIpLnJlcGxhY2UoL15cLlwvLywiIikucmVwbGFjZSgvXlwuJC8sIiIpKSx0aGlzLm9wY29kZSgicHVzaElkIix0LnR5cGUsZSl9dGhpcy5hY2NlcHQodCl9fSxzZXR1cEZ1bGxNdXN0YWNoZVBhcmFtczpmdW5jdGlvbih0LGUsaSxuKXt2YXIgcj10LnBhcmFtcztyZXR1cm4gdGhpcy5wdXNoUGFyYW1zKHIpLHRoaXMub3Bjb2RlKCJwdXNoUHJvZ3JhbSIsZSksdGhpcy5vcGNvZGUoInB1c2hQcm9ncmFtIixpKSx0Lmhhc2g/dGhpcy5hY2NlcHQodC5oYXNoKTp0aGlzLm9wY29kZSgiZW1wdHlIYXNoIixuKSxyfSxibG9ja1BhcmFtSW5kZXg6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsaT10aGlzLm9wdGlvbnMuYmxvY2tQYXJhbXMubGVuZ3RoO2U8aTtlKyspe3ZhciBuPXRoaXMub3B0aW9ucy5ibG9ja1BhcmFtc1tlXSxyPW4mJmQuaW5kZXhPZihuLHQpO2lmKG4mJnI+PTApcmV0dXJuW2Uscl19fX19LGZ1bmN0aW9uKHQsZSxpKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbih0KXt0aGlzLnZhbHVlPXR9ZnVuY3Rpb24gcigpe31mdW5jdGlvbiBzKHQsZSxpLG4pe3ZhciByPWUucG9wU3RhY2soKSxzPTAsbz1pLmxlbmd0aDtmb3IodCYmby0tO3M8bztzKyspcj1lLm5hbWVMb29rdXAocixpW3NdLG4pO3JldHVybiB0P1tlLmFsaWFzYWJsZSgiY29udGFpbmVyLnN0cmljdCIpLCIoIixyLCIsICIsZS5xdW90ZWRTdHJpbmcoaVtzXSksIikiXTpyfXZhciBvPWkoMSlbImRlZmF1bHQiXTtlLl9fZXNNb2R1bGU9ITA7dmFyIGE9aSg0KSxsPWkoNiksYz1vKGwpLHU9aSg1KSxkPWkoMjkpLGg9byhkKTtyLnByb3RvdHlwZT17bmFtZUxvb2t1cDpmdW5jdGlvbih0LGUpe3JldHVybiByLmlzVmFsaWRKYXZhU2NyaXB0VmFyaWFibGVOYW1lKGUpP1t0LCIuIixlXTpbdCwiWyIsSlNPTi5zdHJpbmdpZnkoZSksIl0iXX0sZGVwdGhlZExvb2t1cDpmdW5jdGlvbih0KXtyZXR1cm5bdGhpcy5hbGlhc2FibGUoImNvbnRhaW5lci5sb29rdXAiKSwnKGRlcHRocywgIicsdCwnIiknXX0sY29tcGlsZXJJbmZvOmZ1bmN0aW9uKCl7dmFyIHQ9YS5DT01QSUxFUl9SRVZJU0lPTixlPWEuUkVWSVNJT05fQ0hBTkdFU1t0XTtyZXR1cm5bdCxlXX0sYXBwZW5kVG9CdWZmZXI6ZnVuY3Rpb24odCxlLGkpe3JldHVybiB1LmlzQXJyYXkodCl8fCh0PVt0XSksdD10aGlzLnNvdXJjZS53cmFwKHQsZSksdGhpcy5lbnZpcm9ubWVudC5pc1NpbXBsZT9bInJldHVybiAiLHQsIjsiXTppP1siYnVmZmVyICs9ICIsdCwiOyJdOih0LmFwcGVuZFRvQnVmZmVyPSEwLHQpfSxpbml0aWFsaXplQnVmZmVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucXVvdGVkU3RyaW5nKCIiKX0sY29tcGlsZTpmdW5jdGlvbih0LGUsaSxuKXt0aGlzLmVudmlyb25tZW50PXQsdGhpcy5vcHRpb25zPWUsdGhpcy5zdHJpbmdQYXJhbXM9dGhpcy5vcHRpb25zLnN0cmluZ1BhcmFtcyx0aGlzLnRyYWNrSWRzPXRoaXMub3B0aW9ucy50cmFja0lkcyx0aGlzLnByZWNvbXBpbGU9IW4sdGhpcy5uYW1lPXRoaXMuZW52aXJvbm1lbnQubmFtZSx0aGlzLmlzQ2hpbGQ9ISFpLHRoaXMuY29udGV4dD1pfHx7ZGVjb3JhdG9yczpbXSxwcm9ncmFtczpbXSxlbnZpcm9ubWVudHM6W119LHRoaXMucHJlYW1ibGUoKSx0aGlzLnN0YWNrU2xvdD0wLHRoaXMuc3RhY2tWYXJzPVtdLHRoaXMuYWxpYXNlcz17fSx0aGlzLnJlZ2lzdGVycz17bGlzdDpbXX0sdGhpcy5oYXNoZXM9W10sdGhpcy5jb21waWxlU3RhY2s9W10sdGhpcy5pbmxpbmVTdGFjaz1bXSx0aGlzLmJsb2NrUGFyYW1zPVtdLHRoaXMuY29tcGlsZUNoaWxkcmVuKHQsZSksdGhpcy51c2VEZXB0aHM9dGhpcy51c2VEZXB0aHN8fHQudXNlRGVwdGhzfHx0LnVzZURlY29yYXRvcnN8fHRoaXMub3B0aW9ucy5jb21wYXQsdGhpcy51c2VCbG9ja1BhcmFtcz10aGlzLnVzZUJsb2NrUGFyYW1zfHx0LnVzZUJsb2NrUGFyYW1zO3ZhciByPXQub3Bjb2RlcyxzPXZvaWQgMCxvPXZvaWQgMCxhPXZvaWQgMCxsPXZvaWQgMDtmb3IoYT0wLGw9ci5sZW5ndGg7YTxsO2ErKylzPXJbYV0sdGhpcy5zb3VyY2UuY3VycmVudExvY2F0aW9uPXMubG9jLG89b3x8cy5sb2MsdGhpc1tzLm9wY29kZV0uYXBwbHkodGhpcyxzLmFyZ3MpO2lmKHRoaXMuc291cmNlLmN1cnJlbnRMb2NhdGlvbj1vLHRoaXMucHVzaFNvdXJjZSgiIiksdGhpcy5zdGFja1Nsb3R8fHRoaXMuaW5saW5lU3RhY2subGVuZ3RofHx0aGlzLmNvbXBpbGVTdGFjay5sZW5ndGgpdGhyb3cgbmV3IGNbImRlZmF1bHQiXSgiQ29tcGlsZSBjb21wbGV0ZWQgd2l0aCBjb250ZW50IGxlZnQgb24gc3RhY2siKTt0aGlzLmRlY29yYXRvcnMuaXNFbXB0eSgpP3RoaXMuZGVjb3JhdG9ycz12b2lkIDA6KHRoaXMudXNlRGVjb3JhdG9ycz0hMCx0aGlzLmRlY29yYXRvcnMucHJlcGVuZCgidmFyIGRlY29yYXRvcnMgPSBjb250YWluZXIuZGVjb3JhdG9ycztcbiIpLHRoaXMuZGVjb3JhdG9ycy5wdXNoKCJyZXR1cm4gZm47Iiksbj90aGlzLmRlY29yYXRvcnM9RnVuY3Rpb24uYXBwbHkodGhpcyxbImZuIiwicHJvcHMiLCJjb250YWluZXIiLCJkZXB0aDAiLCJkYXRhIiwiYmxvY2tQYXJhbXMiLCJkZXB0aHMiLHRoaXMuZGVjb3JhdG9ycy5tZXJnZSgpXSk6KHRoaXMuZGVjb3JhdG9ycy5wcmVwZW5kKCJmdW5jdGlvbihmbiwgcHJvcHMsIGNvbnRhaW5lciwgZGVwdGgwLCBkYXRhLCBibG9ja1BhcmFtcywgZGVwdGhzKSB7XG4iKSx0aGlzLmRlY29yYXRvcnMucHVzaCgifVxuIiksdGhpcy5kZWNvcmF0b3JzPXRoaXMuZGVjb3JhdG9ycy5tZXJnZSgpKSk7dmFyIHU9dGhpcy5jcmVhdGVGdW5jdGlvbkNvbnRleHQobik7aWYodGhpcy5pc0NoaWxkKXJldHVybiB1O3ZhciBkPXtjb21waWxlcjp0aGlzLmNvbXBpbGVySW5mbygpLG1haW46dX07dGhpcy5kZWNvcmF0b3JzJiYoZC5tYWluX2Q9dGhpcy5kZWNvcmF0b3JzLGQudXNlRGVjb3JhdG9ycz0hMCk7dmFyIGg9dGhpcy5jb250ZXh0LHA9aC5wcm9ncmFtcyxmPWguZGVjb3JhdG9ycztmb3IoYT0wLGw9cC5sZW5ndGg7YTxsO2ErKylwW2FdJiYoZFthXT1wW2FdLGZbYV0mJihkW2ErIl9kIl09ZlthXSxkLnVzZURlY29yYXRvcnM9ITApKTtyZXR1cm4gdGhpcy5lbnZpcm9ubWVudC51c2VQYXJ0aWFsJiYoZC51c2VQYXJ0aWFsPSEwKSx0aGlzLm9wdGlvbnMuZGF0YSYmKGQudXNlRGF0YT0hMCksdGhpcy51c2VEZXB0aHMmJihkLnVzZURlcHRocz0hMCksdGhpcy51c2VCbG9ja1BhcmFtcyYmKGQudXNlQmxvY2tQYXJhbXM9ITApLHRoaXMub3B0aW9ucy5jb21wYXQmJihkLmNvbXBhdD0hMCksbj9kLmNvbXBpbGVyT3B0aW9ucz10aGlzLm9wdGlvbnM6KGQuY29tcGlsZXI9SlNPTi5zdHJpbmdpZnkoZC5jb21waWxlciksdGhpcy5zb3VyY2UuY3VycmVudExvY2F0aW9uPXtzdGFydDp7bGluZToxLGNvbHVtbjowfX0sZD10aGlzLm9iamVjdExpdGVyYWwoZCksZS5zcmNOYW1lPyhkPWQudG9TdHJpbmdXaXRoU291cmNlTWFwKHtmaWxlOmUuZGVzdE5hbWV9KSxkLm1hcD1kLm1hcCYmZC5tYXAudG9TdHJpbmcoKSk6ZD1kLnRvU3RyaW5nKCkpLGR9LHByZWFtYmxlOmZ1bmN0aW9uKCl7dGhpcy5sYXN0Q29udGV4dD0wLHRoaXMuc291cmNlPW5ldyBoWyJkZWZhdWx0Il0odGhpcy5vcHRpb25zLnNyY05hbWUpLHRoaXMuZGVjb3JhdG9ycz1uZXcgaFsiZGVmYXVsdCJdKHRoaXMub3B0aW9ucy5zcmNOYW1lKX0sY3JlYXRlRnVuY3Rpb25Db250ZXh0OmZ1bmN0aW9uKHQpe3ZhciBlPSIiLGk9dGhpcy5zdGFja1ZhcnMuY29uY2F0KHRoaXMucmVnaXN0ZXJzLmxpc3QpO2kubGVuZ3RoPjAmJihlKz0iLCAiK2kuam9pbigiLCAiKSk7dmFyIG49MDtmb3IodmFyIHIgaW4gdGhpcy5hbGlhc2VzKXt2YXIgcz10aGlzLmFsaWFzZXNbcl07dGhpcy5hbGlhc2VzLmhhc093blByb3BlcnR5KHIpJiZzLmNoaWxkcmVuJiZzLnJlZmVyZW5jZUNvdW50PjEmJihlKz0iLCBhbGlhcyIrICsrbisiPSIrcixzLmNoaWxkcmVuWzBdPSJhbGlhcyIrbil9dmFyIG89WyJjb250YWluZXIiLCJkZXB0aDAiLCJoZWxwZXJzIiwicGFydGlhbHMiLCJkYXRhIl07KHRoaXMudXNlQmxvY2tQYXJhbXN8fHRoaXMudXNlRGVwdGhzKSYmby5wdXNoKCJibG9ja1BhcmFtcyIpLHRoaXMudXNlRGVwdGhzJiZvLnB1c2goImRlcHRocyIpO3ZhciBhPXRoaXMubWVyZ2VTb3VyY2UoZSk7cmV0dXJuIHQ/KG8ucHVzaChhKSxGdW5jdGlvbi5hcHBseSh0aGlzLG8pKTp0aGlzLnNvdXJjZS53cmFwKFsiZnVuY3Rpb24oIixvLmpvaW4oIiwiKSwiKSB7XG4gICIsYSwifSJdKX0sbWVyZ2VTb3VyY2U6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5lbnZpcm9ubWVudC5pc1NpbXBsZSxpPSF0aGlzLmZvcmNlQnVmZmVyLG49dm9pZCAwLHI9dm9pZCAwLHM9dm9pZCAwLG89dm9pZCAwO3JldHVybiB0aGlzLnNvdXJjZS5lYWNoKGZ1bmN0aW9uKHQpe3QuYXBwZW5kVG9CdWZmZXI/KHM/dC5wcmVwZW5kKCIgICsgIik6cz10LG89dCk6KHMmJihyP3MucHJlcGVuZCgiYnVmZmVyICs9ICIpOm49ITAsby5hZGQoIjsiKSxzPW89dm9pZCAwKSxyPSEwLGV8fChpPSExKSl9KSxpP3M/KHMucHJlcGVuZCgicmV0dXJuICIpLG8uYWRkKCI7IikpOnJ8fHRoaXMuc291cmNlLnB1c2goJ3JldHVybiAiIjsnKToodCs9IiwgYnVmZmVyID0gIisobj8iIjp0aGlzLmluaXRpYWxpemVCdWZmZXIoKSkscz8ocy5wcmVwZW5kKCJyZXR1cm4gYnVmZmVyICsgIiksby5hZGQoIjsiKSk6dGhpcy5zb3VyY2UucHVzaCgicmV0dXJuIGJ1ZmZlcjsiKSksdCYmdGhpcy5zb3VyY2UucHJlcGVuZCgidmFyICIrdC5zdWJzdHJpbmcoMikrKG4/IiI6IjtcbiIpKSx0aGlzLnNvdXJjZS5tZXJnZSgpfSxibG9ja1ZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuYWxpYXNhYmxlKCJoZWxwZXJzLmJsb2NrSGVscGVyTWlzc2luZyIpLGk9W3RoaXMuY29udGV4dE5hbWUoMCldO3RoaXMuc2V0dXBIZWxwZXJBcmdzKHQsMCxpKTt2YXIgbj10aGlzLnBvcFN0YWNrKCk7aS5zcGxpY2UoMSwwLG4pLHRoaXMucHVzaCh0aGlzLnNvdXJjZS5mdW5jdGlvbkNhbGwoZSwiY2FsbCIsaSkpfSxhbWJpZ3VvdXNCbG9ja1ZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5hbGlhc2FibGUoImhlbHBlcnMuYmxvY2tIZWxwZXJNaXNzaW5nIiksZT1bdGhpcy5jb250ZXh0TmFtZSgwKV07dGhpcy5zZXR1cEhlbHBlckFyZ3MoIiIsMCxlLCEwKSx0aGlzLmZsdXNoSW5saW5lKCk7dmFyIGk9dGhpcy50b3BTdGFjaygpO2Uuc3BsaWNlKDEsMCxpKSx0aGlzLnB1c2hTb3VyY2UoWyJpZiAoISIsdGhpcy5sYXN0SGVscGVyLCIpIHsgIixpLCIgPSAiLHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbCh0LCJjYWxsIixlKSwifSJdKX0sYXBwZW5kQ29udGVudDpmdW5jdGlvbih0KXt0aGlzLnBlbmRpbmdDb250ZW50P3Q9dGhpcy5wZW5kaW5nQ29udGVudCt0OnRoaXMucGVuZGluZ0xvY2F0aW9uPXRoaXMuc291cmNlLmN1cnJlbnRMb2NhdGlvbix0aGlzLnBlbmRpbmdDb250ZW50PXR9LGFwcGVuZDpmdW5jdGlvbigpe2lmKHRoaXMuaXNJbmxpbmUoKSl0aGlzLnJlcGxhY2VTdGFjayhmdW5jdGlvbih0KXtyZXR1cm5bIiAhPSBudWxsID8gIix0LCcgOiAiIiddfSksdGhpcy5wdXNoU291cmNlKHRoaXMuYXBwZW5kVG9CdWZmZXIodGhpcy5wb3BTdGFjaygpKSk7ZWxzZXt2YXIgdD10aGlzLnBvcFN0YWNrKCk7dGhpcy5wdXNoU291cmNlKFsiaWYgKCIsdCwiICE9IG51bGwpIHsgIix0aGlzLmFwcGVuZFRvQnVmZmVyKHQsdm9pZCAwLCEwKSwiIH0iXSksdGhpcy5lbnZpcm9ubWVudC5pc1NpbXBsZSYmdGhpcy5wdXNoU291cmNlKFsiZWxzZSB7ICIsdGhpcy5hcHBlbmRUb0J1ZmZlcigiJyciLHZvaWQgMCwhMCksIiB9Il0pfX0sYXBwZW5kRXNjYXBlZDpmdW5jdGlvbigpe3RoaXMucHVzaFNvdXJjZSh0aGlzLmFwcGVuZFRvQnVmZmVyKFt0aGlzLmFsaWFzYWJsZSgiY29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb24iKSwiKCIsdGhpcy5wb3BTdGFjaygpLCIpIl0pKX0sZ2V0Q29udGV4dDpmdW5jdGlvbih0KXt0aGlzLmxhc3RDb250ZXh0PXR9LHB1c2hDb250ZXh0OmZ1bmN0aW9uKCl7dGhpcy5wdXNoU3RhY2tMaXRlcmFsKHRoaXMuY29udGV4dE5hbWUodGhpcy5sYXN0Q29udGV4dCkpfSxsb29rdXBPbkNvbnRleHQ6ZnVuY3Rpb24odCxlLGksbil7dmFyIHI9MDtufHwhdGhpcy5vcHRpb25zLmNvbXBhdHx8dGhpcy5sYXN0Q29udGV4dD90aGlzLnB1c2hDb250ZXh0KCk6dGhpcy5wdXNoKHRoaXMuZGVwdGhlZExvb2t1cCh0W3IrK10pKSx0aGlzLnJlc29sdmVQYXRoKCJjb250ZXh0Iix0LHIsZSxpKX0sbG9va3VwQmxvY2tQYXJhbTpmdW5jdGlvbih0LGUpe3RoaXMudXNlQmxvY2tQYXJhbXM9ITAsdGhpcy5wdXNoKFsiYmxvY2tQYXJhbXNbIix0WzBdLCJdWyIsdFsxXSwiXSJdKSx0aGlzLnJlc29sdmVQYXRoKCJjb250ZXh0IixlLDEpfSxsb29rdXBEYXRhOmZ1bmN0aW9uKHQsZSxpKXt0P3RoaXMucHVzaFN0YWNrTGl0ZXJhbCgiY29udGFpbmVyLmRhdGEoZGF0YSwgIit0KyIpIik6dGhpcy5wdXNoU3RhY2tMaXRlcmFsKCJkYXRhIiksdGhpcy5yZXNvbHZlUGF0aCgiZGF0YSIsZSwwLCEwLGkpfSxyZXNvbHZlUGF0aDpmdW5jdGlvbih0LGUsaSxuLHIpe3ZhciBvPXRoaXM7aWYodGhpcy5vcHRpb25zLnN0cmljdHx8dGhpcy5vcHRpb25zLmFzc3VtZU9iamVjdHMpcmV0dXJuIHZvaWQgdGhpcy5wdXNoKHModGhpcy5vcHRpb25zLnN0cmljdCYmcix0aGlzLGUsdCkpO2Zvcih2YXIgYT1lLmxlbmd0aDtpPGE7aSsrKXRoaXMucmVwbGFjZVN0YWNrKGZ1bmN0aW9uKHIpe3ZhciBzPW8ubmFtZUxvb2t1cChyLGVbaV0sdCk7cmV0dXJuIG4/WyIgJiYgIixzXTpbIiAhPSBudWxsID8gIixzLCIgOiAiLHJdfSl9LHJlc29sdmVQb3NzaWJsZUxhbWJkYTpmdW5jdGlvbigpe3RoaXMucHVzaChbdGhpcy5hbGlhc2FibGUoImNvbnRhaW5lci5sYW1iZGEiKSwiKCIsdGhpcy5wb3BTdGFjaygpLCIsICIsdGhpcy5jb250ZXh0TmFtZSgwKSwiKSJdKX0scHVzaFN0cmluZ1BhcmFtOmZ1bmN0aW9uKHQsZSl7dGhpcy5wdXNoQ29udGV4dCgpLHRoaXMucHVzaFN0cmluZyhlKSwiU3ViRXhwcmVzc2lvbiIhPT1lJiYoInN0cmluZyI9PXR5cGVvZiB0P3RoaXMucHVzaFN0cmluZyh0KTp0aGlzLnB1c2hTdGFja0xpdGVyYWwodCkpfSxlbXB0eUhhc2g6ZnVuY3Rpb24odCl7dGhpcy50cmFja0lkcyYmdGhpcy5wdXNoKCJ7fSIpLHRoaXMuc3RyaW5nUGFyYW1zJiYodGhpcy5wdXNoKCJ7fSIpLHRoaXMucHVzaCgie30iKSksdGhpcy5wdXNoU3RhY2tMaXRlcmFsKHQ/InVuZGVmaW5lZCI6Int9Iil9LHB1c2hIYXNoOmZ1bmN0aW9uKCl7dGhpcy5oYXNoJiZ0aGlzLmhhc2hlcy5wdXNoKHRoaXMuaGFzaCksdGhpcy5oYXNoPXt2YWx1ZXM6W10sdHlwZXM6W10sY29udGV4dHM6W10saWRzOltdfX0scG9wSGFzaDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuaGFzaDt0aGlzLmhhc2g9dGhpcy5oYXNoZXMucG9wKCksdGhpcy50cmFja0lkcyYmdGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbCh0LmlkcykpLHRoaXMuc3RyaW5nUGFyYW1zJiYodGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbCh0LmNvbnRleHRzKSksdGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbCh0LnR5cGVzKSkpLHRoaXMucHVzaCh0aGlzLm9iamVjdExpdGVyYWwodC52YWx1ZXMpKX0scHVzaFN0cmluZzpmdW5jdGlvbih0KXt0aGlzLnB1c2hTdGFja0xpdGVyYWwodGhpcy5xdW90ZWRTdHJpbmcodCkpfSxwdXNoTGl0ZXJhbDpmdW5jdGlvbih0KXt0aGlzLnB1c2hTdGFja0xpdGVyYWwodCl9LHB1c2hQcm9ncmFtOmZ1bmN0aW9uKHQpe251bGwhPXQ/dGhpcy5wdXNoU3RhY2tMaXRlcmFsKHRoaXMucHJvZ3JhbUV4cHJlc3Npb24odCkpOnRoaXMucHVzaFN0YWNrTGl0ZXJhbChudWxsKX0scmVnaXN0ZXJEZWNvcmF0b3I6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLm5hbWVMb29rdXAoImRlY29yYXRvcnMiLGUsImRlY29yYXRvciIpLG49dGhpcy5zZXR1cEhlbHBlckFyZ3MoZSx0KTt0aGlzLmRlY29yYXRvcnMucHVzaChbImZuID0gIix0aGlzLmRlY29yYXRvcnMuZnVuY3Rpb25DYWxsKGksIiIsWyJmbiIsInByb3BzIiwiY29udGFpbmVyIixuXSksIiB8fCBmbjsiXSl9LGludm9rZUhlbHBlcjpmdW5jdGlvbih0LGUsaSl7dmFyIG49dGhpcy5wb3BTdGFjaygpLHI9dGhpcy5zZXR1cEhlbHBlcih0LGUpLHM9aT9bci5uYW1lLCIgfHwgIl06IiIsbz1bIigiXS5jb25jYXQocyxuKTt0aGlzLm9wdGlvbnMuc3RyaWN0fHxvLnB1c2goIiB8fCAiLHRoaXMuYWxpYXNhYmxlKCJoZWxwZXJzLmhlbHBlck1pc3NpbmciKSksby5wdXNoKCIpIiksdGhpcy5wdXNoKHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbChvLCJjYWxsIixyLmNhbGxQYXJhbXMpKX0saW52b2tlS25vd25IZWxwZXI6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLnNldHVwSGVscGVyKHQsZSk7dGhpcy5wdXNoKHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbChpLm5hbWUsImNhbGwiLGkuY2FsbFBhcmFtcykpfSxpbnZva2VBbWJpZ3VvdXM6ZnVuY3Rpb24odCxlKXt0aGlzLnVzZVJlZ2lzdGVyKCJoZWxwZXIiKTt2YXIgaT10aGlzLnBvcFN0YWNrKCk7dGhpcy5lbXB0eUhhc2goKTt2YXIgbj10aGlzLnNldHVwSGVscGVyKDAsdCxlKSxyPXRoaXMubGFzdEhlbHBlcj10aGlzLm5hbWVMb29rdXAoImhlbHBlcnMiLHQsImhlbHBlciIpLHM9WyIoIiwiKGhlbHBlciA9ICIsciwiIHx8ICIsaSwiKSJdO3RoaXMub3B0aW9ucy5zdHJpY3R8fChzWzBdPSIoaGVscGVyID0gIixzLnB1c2goIiAhPSBudWxsID8gaGVscGVyIDogIix0aGlzLmFsaWFzYWJsZSgiaGVscGVycy5oZWxwZXJNaXNzaW5nIikpKSx0aGlzLnB1c2goWyIoIixzLG4ucGFyYW1zSW5pdD9bIiksKCIsbi5wYXJhbXNJbml0XTpbXSwiKSwiLCIodHlwZW9mIGhlbHBlciA9PT0gIix0aGlzLmFsaWFzYWJsZSgnImZ1bmN0aW9uIicpLCIgPyAiLHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbCgiaGVscGVyIiwiY2FsbCIsbi5jYWxsUGFyYW1zKSwiIDogaGVscGVyKSkiXSl9LGludm9rZVBhcnRpYWw6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPVtdLHI9dGhpcy5zZXR1cFBhcmFtcyhlLDEsbik7dCYmKGU9dGhpcy5wb3BTdGFjaygpLGRlbGV0ZSByLm5hbWUpLGkmJihyLmluZGVudD1KU09OLnN0cmluZ2lmeShpKSksci5oZWxwZXJzPSJoZWxwZXJzIixyLnBhcnRpYWxzPSJwYXJ0aWFscyIsci5kZWNvcmF0b3JzPSJjb250YWluZXIuZGVjb3JhdG9ycyIsdD9uLnVuc2hpZnQoZSk6bi51bnNoaWZ0KHRoaXMubmFtZUxvb2t1cCgicGFydGlhbHMiLGUsInBhcnRpYWwiKSksdGhpcy5vcHRpb25zLmNvbXBhdCYmKHIuZGVwdGhzPSJkZXB0aHMiKSxyPXRoaXMub2JqZWN0TGl0ZXJhbChyKSxuLnB1c2gociksdGhpcy5wdXNoKHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbCgiY29udGFpbmVyLmludm9rZVBhcnRpYWwiLCIiLG4pKX0sYXNzaWduVG9IYXNoOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMucG9wU3RhY2soKSxpPXZvaWQgMCxuPXZvaWQgMCxyPXZvaWQgMDt0aGlzLnRyYWNrSWRzJiYocj10aGlzLnBvcFN0YWNrKCkpLAoJdGhpcy5zdHJpbmdQYXJhbXMmJihuPXRoaXMucG9wU3RhY2soKSxpPXRoaXMucG9wU3RhY2soKSk7dmFyIHM9dGhpcy5oYXNoO2kmJihzLmNvbnRleHRzW3RdPWkpLG4mJihzLnR5cGVzW3RdPW4pLHImJihzLmlkc1t0XT1yKSxzLnZhbHVlc1t0XT1lfSxwdXNoSWQ6ZnVuY3Rpb24odCxlLGkpeyJCbG9ja1BhcmFtIj09PXQ/dGhpcy5wdXNoU3RhY2tMaXRlcmFsKCJibG9ja1BhcmFtc1siK2VbMF0rIl0ucGF0aFsiK2VbMV0rIl0iKyhpPyIgKyAiK0pTT04uc3RyaW5naWZ5KCIuIitpKToiIikpOiJQYXRoRXhwcmVzc2lvbiI9PT10P3RoaXMucHVzaFN0cmluZyhlKToiU3ViRXhwcmVzc2lvbiI9PT10P3RoaXMucHVzaFN0YWNrTGl0ZXJhbCgidHJ1ZSIpOnRoaXMucHVzaFN0YWNrTGl0ZXJhbCgibnVsbCIpfSxjb21waWxlcjpyLGNvbXBpbGVDaGlsZHJlbjpmdW5jdGlvbih0LGUpe2Zvcih2YXIgaT10LmNoaWxkcmVuLG49dm9pZCAwLHI9dm9pZCAwLHM9MCxvPWkubGVuZ3RoO3M8bztzKyspe249aVtzXSxyPW5ldyB0aGlzLmNvbXBpbGVyO3ZhciBhPXRoaXMubWF0Y2hFeGlzdGluZ1Byb2dyYW0obik7bnVsbD09YT8odGhpcy5jb250ZXh0LnByb2dyYW1zLnB1c2goIiIpLGE9dGhpcy5jb250ZXh0LnByb2dyYW1zLmxlbmd0aCxuLmluZGV4PWEsbi5uYW1lPSJwcm9ncmFtIithLHRoaXMuY29udGV4dC5wcm9ncmFtc1thXT1yLmNvbXBpbGUobixlLHRoaXMuY29udGV4dCwhdGhpcy5wcmVjb21waWxlKSx0aGlzLmNvbnRleHQuZGVjb3JhdG9yc1thXT1yLmRlY29yYXRvcnMsdGhpcy5jb250ZXh0LmVudmlyb25tZW50c1thXT1uLHRoaXMudXNlRGVwdGhzPXRoaXMudXNlRGVwdGhzfHxyLnVzZURlcHRocyx0aGlzLnVzZUJsb2NrUGFyYW1zPXRoaXMudXNlQmxvY2tQYXJhbXN8fHIudXNlQmxvY2tQYXJhbXMpOihuLmluZGV4PWEsbi5uYW1lPSJwcm9ncmFtIithLHRoaXMudXNlRGVwdGhzPXRoaXMudXNlRGVwdGhzfHxuLnVzZURlcHRocyx0aGlzLnVzZUJsb2NrUGFyYW1zPXRoaXMudXNlQmxvY2tQYXJhbXN8fG4udXNlQmxvY2tQYXJhbXMpfX0sbWF0Y2hFeGlzdGluZ1Byb2dyYW06ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsaT10aGlzLmNvbnRleHQuZW52aXJvbm1lbnRzLmxlbmd0aDtlPGk7ZSsrKXt2YXIgbj10aGlzLmNvbnRleHQuZW52aXJvbm1lbnRzW2VdO2lmKG4mJm4uZXF1YWxzKHQpKXJldHVybiBlfX0scHJvZ3JhbUV4cHJlc3Npb246ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5lbnZpcm9ubWVudC5jaGlsZHJlblt0XSxpPVtlLmluZGV4LCJkYXRhIixlLmJsb2NrUGFyYW1zXTtyZXR1cm4odGhpcy51c2VCbG9ja1BhcmFtc3x8dGhpcy51c2VEZXB0aHMpJiZpLnB1c2goImJsb2NrUGFyYW1zIiksdGhpcy51c2VEZXB0aHMmJmkucHVzaCgiZGVwdGhzIiksImNvbnRhaW5lci5wcm9ncmFtKCIraS5qb2luKCIsICIpKyIpIn0sdXNlUmVnaXN0ZXI6ZnVuY3Rpb24odCl7dGhpcy5yZWdpc3RlcnNbdF18fCh0aGlzLnJlZ2lzdGVyc1t0XT0hMCx0aGlzLnJlZ2lzdGVycy5saXN0LnB1c2godCkpfSxwdXNoOmZ1bmN0aW9uKHQpe3JldHVybiB0IGluc3RhbmNlb2Ygbnx8KHQ9dGhpcy5zb3VyY2Uud3JhcCh0KSksdGhpcy5pbmxpbmVTdGFjay5wdXNoKHQpLHR9LHB1c2hTdGFja0xpdGVyYWw6ZnVuY3Rpb24odCl7dGhpcy5wdXNoKG5ldyBuKHQpKX0scHVzaFNvdXJjZTpmdW5jdGlvbih0KXt0aGlzLnBlbmRpbmdDb250ZW50JiYodGhpcy5zb3VyY2UucHVzaCh0aGlzLmFwcGVuZFRvQnVmZmVyKHRoaXMuc291cmNlLnF1b3RlZFN0cmluZyh0aGlzLnBlbmRpbmdDb250ZW50KSx0aGlzLnBlbmRpbmdMb2NhdGlvbikpLHRoaXMucGVuZGluZ0NvbnRlbnQ9dm9pZCAwKSx0JiZ0aGlzLnNvdXJjZS5wdXNoKHQpfSxyZXBsYWNlU3RhY2s6ZnVuY3Rpb24odCl7dmFyIGU9WyIoIl0saT12b2lkIDAscj12b2lkIDAscz12b2lkIDA7aWYoIXRoaXMuaXNJbmxpbmUoKSl0aHJvdyBuZXcgY1siZGVmYXVsdCJdKCJyZXBsYWNlU3RhY2sgb24gbm9uLWlubGluZSIpO3ZhciBvPXRoaXMucG9wU3RhY2soITApO2lmKG8gaW5zdGFuY2VvZiBuKWk9W28udmFsdWVdLGU9WyIoIixpXSxzPSEwO2Vsc2V7cj0hMDt2YXIgYT10aGlzLmluY3JTdGFjaygpO2U9WyIoKCIsdGhpcy5wdXNoKGEpLCIgPSAiLG8sIikiXSxpPXRoaXMudG9wU3RhY2soKX12YXIgbD10LmNhbGwodGhpcyxpKTtzfHx0aGlzLnBvcFN0YWNrKCksciYmdGhpcy5zdGFja1Nsb3QtLSx0aGlzLnB1c2goZS5jb25jYXQobCwiKSIpKX0saW5jclN0YWNrOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhY2tTbG90KyssdGhpcy5zdGFja1Nsb3Q+dGhpcy5zdGFja1ZhcnMubGVuZ3RoJiZ0aGlzLnN0YWNrVmFycy5wdXNoKCJzdGFjayIrdGhpcy5zdGFja1Nsb3QpLHRoaXMudG9wU3RhY2tOYW1lKCl9LHRvcFN0YWNrTmFtZTpmdW5jdGlvbigpe3JldHVybiJzdGFjayIrdGhpcy5zdGFja1Nsb3R9LGZsdXNoSW5saW5lOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5pbmxpbmVTdGFjazt0aGlzLmlubGluZVN0YWNrPVtdO2Zvcih2YXIgZT0wLGk9dC5sZW5ndGg7ZTxpO2UrKyl7dmFyIHI9dFtlXTtpZihyIGluc3RhbmNlb2Ygbil0aGlzLmNvbXBpbGVTdGFjay5wdXNoKHIpO2Vsc2V7dmFyIHM9dGhpcy5pbmNyU3RhY2soKTt0aGlzLnB1c2hTb3VyY2UoW3MsIiA9ICIsciwiOyJdKSx0aGlzLmNvbXBpbGVTdGFjay5wdXNoKHMpfX19LGlzSW5saW5lOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5saW5lU3RhY2subGVuZ3RofSxwb3BTdGFjazpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmlzSW5saW5lKCksaT0oZT90aGlzLmlubGluZVN0YWNrOnRoaXMuY29tcGlsZVN0YWNrKS5wb3AoKTtpZighdCYmaSBpbnN0YW5jZW9mIG4pcmV0dXJuIGkudmFsdWU7aWYoIWUpe2lmKCF0aGlzLnN0YWNrU2xvdCl0aHJvdyBuZXcgY1siZGVmYXVsdCJdKCJJbnZhbGlkIHN0YWNrIHBvcCIpO3RoaXMuc3RhY2tTbG90LS19cmV0dXJuIGl9LHRvcFN0YWNrOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5pc0lubGluZSgpP3RoaXMuaW5saW5lU3RhY2s6dGhpcy5jb21waWxlU3RhY2ssZT10W3QubGVuZ3RoLTFdO3JldHVybiBlIGluc3RhbmNlb2Ygbj9lLnZhbHVlOmV9LGNvbnRleHROYW1lOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnVzZURlcHRocyYmdD8iZGVwdGhzWyIrdCsiXSI6ImRlcHRoIit0fSxxdW90ZWRTdHJpbmc6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc291cmNlLnF1b3RlZFN0cmluZyh0KX0sb2JqZWN0TGl0ZXJhbDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zb3VyY2Uub2JqZWN0TGl0ZXJhbCh0KX0sYWxpYXNhYmxlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuYWxpYXNlc1t0XTtyZXR1cm4gZT8oZS5yZWZlcmVuY2VDb3VudCsrLGUpOihlPXRoaXMuYWxpYXNlc1t0XT10aGlzLnNvdXJjZS53cmFwKHQpLGUuYWxpYXNhYmxlPSEwLGUucmVmZXJlbmNlQ291bnQ9MSxlKX0sc2V0dXBIZWxwZXI6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPVtdLHI9dGhpcy5zZXR1cEhlbHBlckFyZ3MoZSx0LG4saSkscz10aGlzLm5hbWVMb29rdXAoImhlbHBlcnMiLGUsImhlbHBlciIpLG89dGhpcy5hbGlhc2FibGUodGhpcy5jb250ZXh0TmFtZSgwKSsiICE9IG51bGwgPyAiK3RoaXMuY29udGV4dE5hbWUoMCkrIiA6IHt9Iik7cmV0dXJue3BhcmFtczpuLHBhcmFtc0luaXQ6cixuYW1lOnMsY2FsbFBhcmFtczpbb10uY29uY2F0KG4pfX0sc2V0dXBQYXJhbXM6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXt9LHI9W10scz1bXSxvPVtdLGE9IWksbD12b2lkIDA7YSYmKGk9W10pLG4ubmFtZT10aGlzLnF1b3RlZFN0cmluZyh0KSxuLmhhc2g9dGhpcy5wb3BTdGFjaygpLHRoaXMudHJhY2tJZHMmJihuLmhhc2hJZHM9dGhpcy5wb3BTdGFjaygpKSx0aGlzLnN0cmluZ1BhcmFtcyYmKG4uaGFzaFR5cGVzPXRoaXMucG9wU3RhY2soKSxuLmhhc2hDb250ZXh0cz10aGlzLnBvcFN0YWNrKCkpO3ZhciBjPXRoaXMucG9wU3RhY2soKSx1PXRoaXMucG9wU3RhY2soKTsodXx8YykmJihuLmZuPXV8fCJjb250YWluZXIubm9vcCIsbi5pbnZlcnNlPWN8fCJjb250YWluZXIubm9vcCIpO2Zvcih2YXIgZD1lO2QtLTspbD10aGlzLnBvcFN0YWNrKCksaVtkXT1sLHRoaXMudHJhY2tJZHMmJihvW2RdPXRoaXMucG9wU3RhY2soKSksdGhpcy5zdHJpbmdQYXJhbXMmJihzW2RdPXRoaXMucG9wU3RhY2soKSxyW2RdPXRoaXMucG9wU3RhY2soKSk7cmV0dXJuIGEmJihuLmFyZ3M9dGhpcy5zb3VyY2UuZ2VuZXJhdGVBcnJheShpKSksdGhpcy50cmFja0lkcyYmKG4uaWRzPXRoaXMuc291cmNlLmdlbmVyYXRlQXJyYXkobykpLHRoaXMuc3RyaW5nUGFyYW1zJiYobi50eXBlcz10aGlzLnNvdXJjZS5nZW5lcmF0ZUFycmF5KHMpLG4uY29udGV4dHM9dGhpcy5zb3VyY2UuZ2VuZXJhdGVBcnJheShyKSksdGhpcy5vcHRpb25zLmRhdGEmJihuLmRhdGE9ImRhdGEiKSx0aGlzLnVzZUJsb2NrUGFyYW1zJiYobi5ibG9ja1BhcmFtcz0iYmxvY2tQYXJhbXMiKSxufSxzZXR1cEhlbHBlckFyZ3M6ZnVuY3Rpb24odCxlLGksbil7dmFyIHI9dGhpcy5zZXR1cFBhcmFtcyh0LGUsaSk7cmV0dXJuIHI9dGhpcy5vYmplY3RMaXRlcmFsKHIpLG4/KHRoaXMudXNlUmVnaXN0ZXIoIm9wdGlvbnMiKSxpLnB1c2goIm9wdGlvbnMiKSxbIm9wdGlvbnM9IixyXSk6aT8oaS5wdXNoKHIpLCIiKTpyfX0sZnVuY3Rpb24oKXtmb3IodmFyIHQ9ImJyZWFrIGVsc2UgbmV3IHZhciBjYXNlIGZpbmFsbHkgcmV0dXJuIHZvaWQgY2F0Y2ggZm9yIHN3aXRjaCB3aGlsZSBjb250aW51ZSBmdW5jdGlvbiB0aGlzIHdpdGggZGVmYXVsdCBpZiB0aHJvdyBkZWxldGUgaW4gdHJ5IGRvIGluc3RhbmNlb2YgdHlwZW9mIGFic3RyYWN0IGVudW0gaW50IHNob3J0IGJvb2xlYW4gZXhwb3J0IGludGVyZmFjZSBzdGF0aWMgYnl0ZSBleHRlbmRzIGxvbmcgc3VwZXIgY2hhciBmaW5hbCBuYXRpdmUgc3luY2hyb25pemVkIGNsYXNzIGZsb2F0IHBhY2thZ2UgdGhyb3dzIGNvbnN0IGdvdG8gcHJpdmF0ZSB0cmFuc2llbnQgZGVidWdnZXIgaW1wbGVtZW50cyBwcm90ZWN0ZWQgdm9sYXRpbGUgZG91YmxlIGltcG9ydCBwdWJsaWMgbGV0IHlpZWxkIGF3YWl0IG51bGwgdHJ1ZSBmYWxzZSIuc3BsaXQoIiAiKSxlPXIuUkVTRVJWRURfV09SRFM9e30saT0wLG49dC5sZW5ndGg7aTxuO2krKyllW3RbaV1dPSEwfSgpLHIuaXNWYWxpZEphdmFTY3JpcHRWYXJpYWJsZU5hbWU9ZnVuY3Rpb24odCl7cmV0dXJuIXIuUkVTRVJWRURfV09SRFNbdF0mJi9eW2EtekEtWl8kXVswLTlhLXpBLVpfJF0qJC8udGVzdCh0KX0sZVsiZGVmYXVsdCJdPXIsdC5leHBvcnRzPWVbImRlZmF1bHQiXX0sZnVuY3Rpb24odCxlLGkpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKHQsZSxpKXtpZihzLmlzQXJyYXkodCkpe2Zvcih2YXIgbj1bXSxyPTAsbz10Lmxlbmd0aDtyPG87cisrKW4ucHVzaChlLndyYXAodFtyXSxpKSk7cmV0dXJuIG59cmV0dXJuImJvb2xlYW4iPT10eXBlb2YgdHx8Im51bWJlciI9PXR5cGVvZiB0P3QrIiI6dH1mdW5jdGlvbiByKHQpe3RoaXMuc3JjRmlsZT10LHRoaXMuc291cmNlPVtdfWUuX19lc01vZHVsZT0hMDt2YXIgcz1pKDUpLG89dm9pZCAwO3RyeXt9Y2F0Y2goYSl7fW98fChvPWZ1bmN0aW9uKHQsZSxpLG4pe3RoaXMuc3JjPSIiLG4mJnRoaXMuYWRkKG4pfSxvLnByb3RvdHlwZT17YWRkOmZ1bmN0aW9uKHQpe3MuaXNBcnJheSh0KSYmKHQ9dC5qb2luKCIiKSksdGhpcy5zcmMrPXR9LHByZXBlbmQ6ZnVuY3Rpb24odCl7cy5pc0FycmF5KHQpJiYodD10LmpvaW4oIiIpKSx0aGlzLnNyYz10K3RoaXMuc3JjfSx0b1N0cmluZ1dpdGhTb3VyY2VNYXA6ZnVuY3Rpb24oKXtyZXR1cm57Y29kZTp0aGlzLnRvU3RyaW5nKCl9fSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNyY319KSxyLnByb3RvdHlwZT17aXNFbXB0eTpmdW5jdGlvbigpe3JldHVybiF0aGlzLnNvdXJjZS5sZW5ndGh9LHByZXBlbmQ6ZnVuY3Rpb24odCxlKXt0aGlzLnNvdXJjZS51bnNoaWZ0KHRoaXMud3JhcCh0LGUpKX0scHVzaDpmdW5jdGlvbih0LGUpe3RoaXMuc291cmNlLnB1c2godGhpcy53cmFwKHQsZSkpfSxtZXJnZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZW1wdHkoKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGUpe3QuYWRkKFsiICAiLGUsIlxuIl0pfSksdH0sZWFjaDpmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxpPXRoaXMuc291cmNlLmxlbmd0aDtlPGk7ZSsrKXQodGhpcy5zb3VyY2VbZV0pfSxlbXB0eTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuY3VycmVudExvY2F0aW9ufHx7c3RhcnQ6e319O3JldHVybiBuZXcgbyh0LnN0YXJ0LmxpbmUsdC5zdGFydC5jb2x1bW4sdGhpcy5zcmNGaWxlKX0sd3JhcDpmdW5jdGlvbih0KXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoPD0xfHx2b2lkIDA9PT1hcmd1bWVudHNbMV0/dGhpcy5jdXJyZW50TG9jYXRpb258fHtzdGFydDp7fX06YXJndW1lbnRzWzFdO3JldHVybiB0IGluc3RhbmNlb2Ygbz90Oih0PW4odCx0aGlzLGUpLG5ldyBvKGUuc3RhcnQubGluZSxlLnN0YXJ0LmNvbHVtbix0aGlzLnNyY0ZpbGUsdCkpfSxmdW5jdGlvbkNhbGw6ZnVuY3Rpb24odCxlLGkpe3JldHVybiBpPXRoaXMuZ2VuZXJhdGVMaXN0KGkpLHRoaXMud3JhcChbdCxlPyIuIitlKyIoIjoiKCIsaSwiKSJdKX0scXVvdGVkU3RyaW5nOmZ1bmN0aW9uKHQpe3JldHVybiciJysodCsiIikucmVwbGFjZSgvXFwvZywiXFxcXCIpLnJlcGxhY2UoLyIvZywnXFwiJykucmVwbGFjZSgvXG4vZywiXFxuIikucmVwbGFjZSgvXHIvZywiXFxyIikucmVwbGFjZSgvXHUyMDI4L2csIlxcdTIwMjgiKS5yZXBsYWNlKC9cdTIwMjkvZywiXFx1MjAyOSIpKyciJ30sb2JqZWN0TGl0ZXJhbDpmdW5jdGlvbih0KXt2YXIgZT1bXTtmb3IodmFyIGkgaW4gdClpZih0Lmhhc093blByb3BlcnR5KGkpKXt2YXIgcj1uKHRbaV0sdGhpcyk7InVuZGVmaW5lZCIhPT1yJiZlLnB1c2goW3RoaXMucXVvdGVkU3RyaW5nKGkpLCI6IixyXSl9dmFyIHM9dGhpcy5nZW5lcmF0ZUxpc3QoZSk7cmV0dXJuIHMucHJlcGVuZCgieyIpLHMuYWRkKCJ9Iiksc30sZ2VuZXJhdGVMaXN0OmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10aGlzLmVtcHR5KCksaT0wLHI9dC5sZW5ndGg7aTxyO2krKylpJiZlLmFkZCgiLCIpLGUuYWRkKG4odFtpXSx0aGlzKSk7cmV0dXJuIGV9LGdlbmVyYXRlQXJyYXk6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZW5lcmF0ZUxpc3QodCk7cmV0dXJuIGUucHJlcGVuZCgiWyIpLGUuYWRkKCJdIiksZX19LGVbImRlZmF1bHQiXT1yLHQuZXhwb3J0cz1lWyJkZWZhdWx0Il19XSl9KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg2KSxpKDcpXSxyPWZ1bmN0aW9uKHQpe3JldHVybiB0KGZ1bmN0aW9uKCl7dC5hamF4U2V0dXAoe2hlYWRlcnM6eyJYLU9rdGEtWHNyZlRva2VuIjp0KCIjX3hzcmZUb2tlbiIpLnRleHQoKX0sY29udmVydGVyczp7InRleHQgc2VjdXJlSlNPTiI6ZnVuY3Rpb24odCl7cmV0dXJuIndoaWxlKDEpe307Ij09PXQuc3Vic3RyaW5nKDAsMTEpJiYodD10LnN1YnN0cmluZygxMSkpLEpTT04ucGFyc2UodCl9fX0pfSksd2luZG93LmpRdWVyeUNvdXJhZ2U9dCx0fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSl7dC5leHBvcnRzPV9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfNl9ffSxmdW5jdGlvbihtb2R1bGUsZXhwb3J0cyl7Im9iamVjdCIhPXR5cGVvZiBKU09OJiYoSlNPTj17fSksZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZih0KXtyZXR1cm4gdDwxMD8iMCIrdDp0fWZ1bmN0aW9uIHF1b3RlKHQpe3JldHVybiBlc2NhcGFibGUubGFzdEluZGV4PTAsZXNjYXBhYmxlLnRlc3QodCk/JyInK3QucmVwbGFjZShlc2NhcGFibGUsZnVuY3Rpb24odCl7dmFyIGU9bWV0YVt0XTtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIGU/ZToiXFx1IisoIjAwMDAiK3QuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikpLnNsaWNlKC00KX0pKyciJzonIicrdCsnIid9ZnVuY3Rpb24gc3RyKHQsZSl7dmFyIGksbixyLHMsbyxhPWdhcCxsPWVbdF07c3dpdGNoKGwmJiJvYmplY3QiPT10eXBlb2YgbCYmImZ1bmN0aW9uIj09dHlwZW9mIGwudG9KU09OJiYobD1sLnRvSlNPTih0KSksImZ1bmN0aW9uIj09dHlwZW9mIHJlcCYmKGw9cmVwLmNhbGwoZSx0LGwpKSx0eXBlb2YgbCl7Y2FzZSJzdHJpbmciOnJldHVybiBxdW90ZShsKTtjYXNlIm51bWJlciI6cmV0dXJuIGlzRmluaXRlKGwpP1N0cmluZyhsKToibnVsbCI7Y2FzZSJib29sZWFuIjpjYXNlIm51bGwiOnJldHVybiBTdHJpbmcobCk7Y2FzZSJvYmplY3QiOmlmKCFsKXJldHVybiJudWxsIjtpZihnYXArPWluZGVudCxvPVtdLCJbb2JqZWN0IEFycmF5XSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmFwcGx5KGwpKXtmb3Iocz1sLmxlbmd0aCxpPTA7aTxzO2krPTEpb1tpXT1zdHIoaSxsKXx8Im51bGwiO3JldHVybiByPTA9PT1vLmxlbmd0aD8iW10iOmdhcD8iW1xuIitnYXArby5qb2luKCIsXG4iK2dhcCkrIlxuIithKyJdIjoiWyIrby5qb2luKCIsIikrIl0iLGdhcD1hLHJ9aWYocmVwJiYib2JqZWN0Ij09dHlwZW9mIHJlcClmb3Iocz1yZXAubGVuZ3RoLGk9MDtpPHM7aSs9MSkic3RyaW5nIj09dHlwZW9mIHJlcFtpXSYmKG49cmVwW2ldLHI9c3RyKG4sbCksciYmby5wdXNoKHF1b3RlKG4pKyhnYXA/IjogIjoiOiIpK3IpKTtlbHNlIGZvcihuIGluIGwpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGwsbikmJihyPXN0cihuLGwpLHImJm8ucHVzaChxdW90ZShuKSsoZ2FwPyI6ICI6IjoiKStyKSk7cmV0dXJuIHI9MD09PW8ubGVuZ3RoPyJ7fSI6Z2FwPyJ7XG4iK2dhcCtvLmpvaW4oIixcbiIrZ2FwKSsiXG4iK2ErIn0iOiJ7IitvLmpvaW4oIiwiKSsifSIsZ2FwPWEscn19ImZ1bmN0aW9uIiE9dHlwZW9mIERhdGUucHJvdG90eXBlLnRvSlNPTiYmKERhdGUucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbih0KXtyZXR1cm4gaXNGaW5pdGUodGhpcy52YWx1ZU9mKCkpP3RoaXMuZ2V0VVRDRnVsbFllYXIoKSsiLSIrZih0aGlzLmdldFVUQ01vbnRoKCkrMSkrIi0iK2YodGhpcy5nZXRVVENEYXRlKCkpKyJUIitmKHRoaXMuZ2V0VVRDSG91cnMoKSkrIjoiK2YodGhpcy5nZXRVVENNaW51dGVzKCkpKyI6IitmKHRoaXMuZ2V0VVRDU2Vjb25kcygpKSsiWiI6bnVsbH0sU3RyaW5nLnByb3RvdHlwZS50b0pTT049TnVtYmVyLnByb3RvdHlwZS50b0pTT049Qm9vbGVhbi5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnZhbHVlT2YoKX0pO3ZhciBjeD0vW1x1MDAwMFx1MDBhZFx1MDYwMC1cdTA2MDRcdTA3MGZcdTE3YjRcdTE3YjVcdTIwMGMtXHUyMDBmXHUyMDI4LVx1MjAyZlx1MjA2MC1cdTIwNmZcdWZlZmZcdWZmZjAtXHVmZmZmXS9nLGVzY2FwYWJsZT0vW1xcXCJceDAwLVx4MWZceDdmLVx4OWZcdTAwYWRcdTA2MDAtXHUwNjA0XHUwNzBmXHUxN2I0XHUxN2I1XHUyMDBjLVx1MjAwZlx1MjAyOC1cdTIwMmZcdTIwNjAtXHUyMDZmXHVmZWZmXHVmZmYwLVx1ZmZmZl0vZyxnYXAsaW5kZW50LG1ldGE9eyJcYiI6IlxcYiIsIlx0IjoiXFx0IiwiXG4iOiJcXG4iLCJcZiI6IlxcZiIsIlxyIjoiXFxyIiwnIic6J1xcIicsIlxcIjoiXFxcXCJ9LHJlcDsiZnVuY3Rpb24iIT10eXBlb2YgSlNPTi5zdHJpbmdpZnkmJihKU09OLnN0cmluZ2lmeT1mdW5jdGlvbih0LGUsaSl7dmFyIG47aWYoZ2FwPSIiLGluZGVudD0iIiwibnVtYmVyIj09dHlwZW9mIGkpZm9yKG49MDtuPGk7bis9MSlpbmRlbnQrPSIgIjtlbHNlInN0cmluZyI9PXR5cGVvZiBpJiYoaW5kZW50PWkpO2lmKHJlcD1lLGUmJiJmdW5jdGlvbiIhPXR5cGVvZiBlJiYoIm9iamVjdCIhPXR5cGVvZiBlfHwibnVtYmVyIiE9dHlwZW9mIGUubGVuZ3RoKSl0aHJvdyBuZXcgRXJyb3IoIkpTT04uc3RyaW5naWZ5Iik7cmV0dXJuIHN0cigiIix7IiI6dH0pfSksImZ1bmN0aW9uIiE9dHlwZW9mIEpTT04ucGFyc2UmJihKU09OLnBhcnNlPWZ1bmN0aW9uKHRleHQscmV2aXZlcil7ZnVuY3Rpb24gd2Fsayh0LGUpe3ZhciBpLG4scj10W2VdO2lmKHImJiJvYmplY3QiPT10eXBlb2Ygcilmb3IoaSBpbiByKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChyLGkpJiYobj13YWxrKHIsaSksdm9pZCAwIT09bj9yW2ldPW46ZGVsZXRlIHJbaV0pO3JldHVybiByZXZpdmVyLmNhbGwodCxlLHIpfXZhciBqO2lmKHRleHQ9U3RyaW5nKHRleHQpLGN4Lmxhc3RJbmRleD0wLGN4LnRlc3QodGV4dCkmJih0ZXh0PXRleHQucmVwbGFjZShjeCxmdW5jdGlvbih0KXtyZXR1cm4iXFx1IisoIjAwMDAiK3QuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikpLnNsaWNlKC00KX0pKSwvXltcXSw6e31cc10qJC8udGVzdCh0ZXh0LnJlcGxhY2UoL1xcKD86WyJcXFwvYmZucnRdfHVbMC05YS1mQS1GXXs0fSkvZywiQCIpLnJlcGxhY2UoLyJbXiJcXFxuXHJdKiJ8dHJ1ZXxmYWxzZXxudWxsfC0/XGQrKD86XC5cZCopPyg/OltlRV1bK1wtXT9cZCspPy9nLCJdIikucmVwbGFjZSgvKD86Xnw6fCwpKD86XHMqXFspKy9nLCIiKSkpcmV0dXJuIGo9ZXZhbCgiKCIrdGV4dCsiKSIpLCJmdW5jdGlvbiI9PXR5cGVvZiByZXZpdmVyP3dhbGsoeyIiOmp9LCIiKTpqO3Rocm93IG5ldyBTeW50YXhFcnJvcigiSlNPTi5wYXJzZSIpfSl9KCl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1pKDkpO3QuZXhwb3J0cz1pKDEwKShuKX0sZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCxlLGkpe3ZhciBuPXIuRGVmZXJyZWQoKTtyZXR1cm4gci5hamF4KHt0eXBlOnQsdXJsOmUsaGVhZGVyczppLmhlYWRlcnMsZGF0YTpKU09OLnN0cmluZ2lmeShpLmRhdGEpLHhockZpZWxkczp7d2l0aENyZWRlbnRpYWxzOiEwfX0pLnRoZW4oZnVuY3Rpb24odCxlLGkpe2RlbGV0ZSBpLnRoZW4sbi5yZXNvbHZlKGkpfSxmdW5jdGlvbih0KXtkZWxldGUgdC50aGVuLG4ucmVqZWN0KHQpfSksbn12YXIgcj1pKDYpO3QuZXhwb3J0cz1ufSxmdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gbih0KXt2YXIgZT10aGlzO2lmKCF0KXRocm93IG5ldyBjKCJObyBhcmd1bWVudHMgcGFzc2VkIHRvIGNvbnN0cnVjdG9yLiBSZXF1aXJlZCB1c2FnZTogbmV3IE9rdGFBdXRoKGFyZ3MpIik7aWYoIXQudXJsKXRocm93IG5ldyBjKCdObyB1cmwgcGFzc2VkIHRvIGNvbnN0cnVjdG9yLiBSZXF1aXJlZCB1c2FnZTogbmV3IE9rdGFBdXRoKHt1cmw6ICJodHRwczovL3NhbXBsZS5va3RhLmNvbSJ9KScpO3RoaXMub3B0aW9ucz17dXJsOnIucmVtb3ZlVHJhaWxpbmdTbGFzaCh0LnVybCksY2xpZW50SWQ6dC5jbGllbnRJZCxpc3N1ZXI6ci5yZW1vdmVUcmFpbGluZ1NsYXNoKHQuaXNzdWVyKSxhdXRob3JpemVVcmw6ci5yZW1vdmVUcmFpbGluZ1NsYXNoKHQuYXV0aG9yaXplVXJsKSx1c2VyaW5mb1VybDpyLnJlbW92ZVRyYWlsaW5nU2xhc2godC51c2VyaW5mb1VybCkscmVkaXJlY3RVcmk6dC5yZWRpcmVjdFVyaSxhamF4UmVxdWVzdDp0LmFqYXhSZXF1ZXN0LHRyYW5zZm9ybUVycm9yWEhSOnQudHJhbnNmb3JtRXJyb3JYSFIsaGVhZGVyczp0LmhlYWRlcnN9LHQubWF4Q2xvY2tTa2V3fHwwPT09dC5tYXhDbG9ja1NrZXc/dGhpcy5vcHRpb25zLm1heENsb2NrU2tldz10Lm1heENsb2NrU2tldzp0aGlzLm9wdGlvbnMubWF4Q2xvY2tTa2V3PXUuREVGQVVMVF9NQVhfQ0xPQ0tfU0tFVyxlLnNlc3Npb249e2Nsb3NlOnIuYmluZChvLmNsb3NlU2Vzc2lvbixudWxsLGUpLGV4aXN0czpyLmJpbmQoby5zZXNzaW9uRXhpc3RzLG51bGwsZSksZ2V0OnIuYmluZChvLmdldFNlc3Npb24sbnVsbCxlKSxyZWZyZXNoOnIuYmluZChvLnJlZnJlc2hTZXNzaW9uLG51bGwsZSksc2V0Q29va2llQW5kUmVkaXJlY3Q6ci5iaW5kKG8uc2V0Q29va2llQW5kUmVkaXJlY3QsbnVsbCxlKX0sZS50eD17c3RhdHVzOnIuYmluZChzLnRyYW5zYWN0aW9uU3RhdHVzLG51bGwsZSkscmVzdW1lOnIuYmluZChzLnJlc3VtZVRyYW5zYWN0aW9uLG51bGwsZSksZXhpc3RzOnIuYmluZChzLnRyYW5zYWN0aW9uRXhpc3RzLG51bGwsZSl9LGUudHguZXhpc3RzLl9nZXRDb29raWU9ZnVuY3Rpb24odCl7cmV0dXJuIGEuZ2V0Q29va2llKHQpfSxlLmlkVG9rZW49e2F1dGhvcml6ZTpyLmRlcHJlY2F0ZVdyYXAoIlVzZSB0b2tlbi5nZXRXaXRob3V0UHJvbXB0LCB0b2tlbi5nZXRXaXRoUG9wdXAsIG9yIHRva2VuLmdldFdpdGhSZWRpcmVjdCBpbnN0ZWFkIG9mIGlkVG9rZW4uYXV0aG9yaXplLiIsci5iaW5kKGwuZ2V0VG9rZW4sbnVsbCxlKSksdmVyaWZ5OnIuZGVwcmVjYXRlV3JhcCgiVXNlIHRva2VuLnZlcmlmeSBpbnN0ZWFkIG9mIGlkVG9rZW4udmVyaWZ5IixyLmJpbmQobC52ZXJpZnlJZFRva2VuLG51bGwsZSkpLHJlZnJlc2g6ci5kZXByZWNhdGVXcmFwKCJVc2UgdG9rZW4ucmVmcmVzaCBpbnN0ZWFkIG9mIGlkVG9rZW4ucmVmcmVzaCIsci5iaW5kKGwucmVmcmVzaElkVG9rZW4sbnVsbCxlKSksZGVjb2RlOnIuZGVwcmVjYXRlV3JhcCgiVXNlIHRva2VuLmRlY29kZSBpbnN0ZWFkIG9mIGlkVG9rZW4uZGVjb2RlIixsLmRlY29kZVRva2VuKX0sZS5pZFRva2VuLmF1dGhvcml6ZS5fZ2V0TG9jYXRpb25IcmVmPWZ1bmN0aW9uKCl7cmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5ocmVmfSxlLnRva2VuPXtnZXRXaXRob3V0UHJvbXB0OnIuYmluZChsLmdldFdpdGhvdXRQcm9tcHQsbnVsbCxlKSxnZXRXaXRoUG9wdXA6ci5iaW5kKGwuZ2V0V2l0aFBvcHVwLG51bGwsZSksZ2V0V2l0aFJlZGlyZWN0OnIuYmluZChsLmdldFdpdGhSZWRpcmVjdCxudWxsLGUpLHBhcnNlRnJvbVVybDpyLmJpbmQobC5wYXJzZUZyb21VcmwsbnVsbCxlKSxkZWNvZGU6bC5kZWNvZGVUb2tlbixyZWZyZXNoOnIuYmluZChsLnJlZnJlc2hUb2tlbixudWxsLGUpLGdldFVzZXJJbmZvOnIuYmluZChsLmdldFVzZXJJbmZvLG51bGwsZSksdmVyaWZ5OnIuYmluZChsLnZlcmlmeVRva2VuLG51bGwsZSl9LGUudG9rZW4uZ2V0V2l0aFJlZGlyZWN0Ll9zZXRMb2NhdGlvbj1mdW5jdGlvbih0KXt3aW5kb3cubG9jYXRpb249dH0sZS50b2tlbi5wYXJzZUZyb21VcmwuX2dldExvY2F0aW9uSGFzaD1mdW5jdGlvbih0KXtyZXR1cm4gd2luZG93LmxvY2F0aW9uLmhhc2h9LGUudG9rZW5NYW5hZ2VyPW5ldyBkKGUsdC50b2tlbk1hbmFnZXIpfWkoMTEpO3ZhciByPWkoMTMpLHM9aSgxNCksbz1pKDI0KSxhPWkoMTYpLGw9aSgyNSksYz1pKDE5KSx1PWkoMjApLGQ9aSgyOSksaD1uLnByb3RvdHlwZTtoLmZlYXR1cmVzPXt9LGguZmVhdHVyZXMuaXNQb3B1cFBvc3RNZXNzYWdlU3VwcG9ydGVkPWZ1bmN0aW9uKCl7dmFyIHQ9ZG9jdW1lbnQuZG9jdW1lbnRNb2RlJiZkb2N1bWVudC5kb2N1bWVudE1vZGU8MTA7cmV0dXJuISghd2luZG93LnBvc3RNZXNzYWdlfHx0KX0saC5mZWF0dXJlcy5pc1Rva2VuVmVyaWZ5U3VwcG9ydGVkPWZ1bmN0aW9uKCl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBjcnlwdG8mJmNyeXB0by5zdWJ0bGUmJiJ1bmRlZmluZWQiIT10eXBlb2YgVWludDhBcnJheX0saC5zaWduSW49ZnVuY3Rpb24odCl7cmV0dXJuIHMucG9zdFRvVHJhbnNhY3Rpb24odGhpcywiL2FwaS92MS9hdXRobiIsdCl9LGguc2lnbk91dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNlc3Npb24uY2xvc2UoKX0saC5mb3Jnb3RQYXNzd29yZD1mdW5jdGlvbih0KXtyZXR1cm4gcy5wb3N0VG9UcmFuc2FjdGlvbih0aGlzLCIvYXBpL3YxL2F1dGhuL3JlY292ZXJ5L3Bhc3N3b3JkIix0KX0saC51bmxvY2tBY2NvdW50PWZ1bmN0aW9uKHQpe3JldHVybiBzLnBvc3RUb1RyYW5zYWN0aW9uKHRoaXMsIi9hcGkvdjEvYXV0aG4vcmVjb3ZlcnkvdW5sb2NrIix0KX0saC52ZXJpZnlSZWNvdmVyeVRva2VuPWZ1bmN0aW9uKHQpe3JldHVybiBzLnBvc3RUb1RyYW5zYWN0aW9uKHRoaXMsIi9hcGkvdjEvYXV0aG4vcmVjb3ZlcnkvdG9rZW4iLHQpfSx0LmV4cG9ydHM9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShpKXtyZXR1cm4gdGhpcyBpbnN0YW5jZW9mIGU/KGkmJiFpLmFqYXhSZXF1ZXN0JiYoaS5hamF4UmVxdWVzdD10KSx2b2lkIHIuYmluZChuLHRoaXMpKGkpKTpuZXcgZShpKX1yZXR1cm4gZS5wcm90b3R5cGU9bi5wcm90b3R5cGUsZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSxlfX0sZnVuY3Rpb24odCxlLGkpe2koMTIpLEFycmF5LnByb3RvdHlwZS5pbmRleE9mfHwoQXJyYXkucHJvdG90eXBlLmluZGV4T2Y9ZnVuY3Rpb24odCxlKXt2YXIgaTtpZihudWxsPT10aGlzKXRocm93IG5ldyBUeXBlRXJyb3IoJyJ0aGlzIiBpcyBudWxsIG9yIG5vdCBkZWZpbmVkJyk7dmFyIG49T2JqZWN0KHRoaXMpLHI9bi5sZW5ndGg+Pj4wO2lmKDA9PT1yKXJldHVybi0xO3ZhciBzPStlfHwwO2lmKE1hdGguYWJzKHMpPT09MS8wJiYocz0wKSxzPj1yKXJldHVybi0xO2ZvcihpPU1hdGgubWF4KHM+PTA/czpyLU1hdGguYWJzKHMpLDApO2k8cjspe2lmKGkgaW4gbiYmbltpXT09PXQpcmV0dXJuIGk7aSsrfXJldHVybi0xfSksQXJyYXkuaXNBcnJheXx8KEFycmF5LmlzQXJyYXk9ZnVuY3Rpb24odCl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXt0aGlzLm1lc3NhZ2U9dH12YXIgaT1lLG49IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89Ijt0LnByb3RvdHlwZT1uZXcgRXJyb3IsdC5wcm90b3R5cGUubmFtZT0iSW52YWxpZENoYXJhY3RlckVycm9yIixpLmJ0b2F8fChpLmJ0b2E9ZnVuY3Rpb24oZSl7Zm9yKHZhciBpLHIscz1TdHJpbmcoZSksbz0wLGE9bixsPSIiO3MuY2hhckF0KDB8byl8fChhPSI9IixvJTEpO2wrPWEuY2hhckF0KDYzJmk+PjgtbyUxKjgpKXtpZihyPXMuY2hhckNvZGVBdChvKz0uNzUpLHI+MjU1KXRocm93IG5ldyB0KCInYnRvYScgZmFpbGVkOiBUaGUgc3RyaW5nIHRvIGJlIGVuY29kZWQgY29udGFpbnMgY2hhcmFjdGVycyBvdXRzaWRlIG9mIHRoZSBMYXRpbjEgcmFuZ2UuIik7aT1pPDw4fHJ9cmV0dXJuIGx9KSxpLmF0b2J8fChpLmF0b2I9ZnVuY3Rpb24oZSl7dmFyIGk9U3RyaW5nKGUpLnJlcGxhY2UoLz0rJC8sIiIpO2lmKGkubGVuZ3RoJTQ9PTEpdGhyb3cgbmV3IHQoIidhdG9iJyBmYWlsZWQ6IFRoZSBzdHJpbmcgdG8gYmUgZGVjb2RlZCBpcyBub3QgY29ycmVjdGx5IGVuY29kZWQuIik7Zm9yKHZhciByLHMsbz0wLGE9MCxsPSIiO3M9aS5jaGFyQXQoYSsrKTt+cyYmKHI9byU0PzY0KnIrczpzLG8rKyU0KT9sKz1TdHJpbmcuZnJvbUNoYXJDb2RlKDI1NSZyPj4oLTIqbyY2KSk6MClzPW4uaW5kZXhPZihzKTtyZXR1cm4gbH0pfSgpfSxmdW5jdGlvbih0LGUpe3ZhciBpPXQuZXhwb3J0cztpLmJhc2U2NFVybFRvQmFzZTY0PWZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoL1wtL2csIisiKS5yZXBsYWNlKC9fL2csIi8iKX0saS5iYXNlNjRVcmxUb1N0cmluZz1mdW5jdGlvbih0KXt2YXIgZT1pLmJhc2U2NFVybFRvQmFzZTY0KHQpO3N3aXRjaChlLmxlbmd0aCU0KXtjYXNlIDA6YnJlYWs7Y2FzZSAyOmUrPSI9PSI7YnJlYWs7Y2FzZSAzOmUrPSI9IjticmVhaztkZWZhdWx0OnRocm93Ik5vdCBhIHZhbGlkIEJhc2U2NFVybCJ9dmFyIG49YXRvYihlKTt0cnl7cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUobikpfWNhdGNoKHIpe3JldHVybiBufX0saS5zdHJpbmdUb0J1ZmZlcj1mdW5jdGlvbih0KXtmb3IodmFyIGU9bmV3IFVpbnQ4QXJyYXkodC5sZW5ndGgpLGk9MDtpPHQubGVuZ3RoO2krKyllW2ldPXQuY2hhckNvZGVBdChpKTtyZXR1cm4gZX0saS5iYXNlNjRVcmxEZWNvZGU9ZnVuY3Rpb24odCl7cmV0dXJuIGF0b2IoaS5iYXNlNjRVcmxUb0Jhc2U2NCh0KSl9LGkuYmluZD1mdW5jdGlvbih0LGUpe3ZhciBpPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgbj1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO3JldHVybiBuPWkuY29uY2F0KG4pLHQuYXBwbHkoZSxuKX19LGkuaXNBYnNvbHV0ZVVybD1mdW5jdGlvbih0KXtyZXR1cm4vXig/OlthLXpdKzopP1wvXC8vaS50ZXN0KHQpfSxpLmlzU3RyaW5nPWZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IFN0cmluZ10iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfSxpLmlzT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IE9iamVjdF0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfSxpLmlzTnVtYmVyPWZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IE51bWJlcl0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfSxpLmlzQXJyYXk9ZnVuY3Rpb24odCl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0saS5pc29Ub1VUQ1N0cmluZz1mdW5jdGlvbih0KXt2YXIgZT10Lm1hdGNoKC9cZCsvZyksaT1EYXRlLlVUQyhlWzBdLGVbMV0tMSxlWzJdLGVbM10sZVs0XSxlWzVdKSxuPW5ldyBEYXRlKGkpO3JldHVybiBuLnRvVVRDU3RyaW5nKCl9LGkudG9RdWVyeVBhcmFtcz1mdW5jdGlvbih0KXt2YXIgZT1bXTtpZihudWxsIT09dClmb3IodmFyIGkgaW4gdCl0Lmhhc093blByb3BlcnR5KGkpJiZ2b2lkIDAhPT10W2ldJiZudWxsIT09dFtpXSYmZS5wdXNoKGkrIj0iK2VuY29kZVVSSUNvbXBvbmVudCh0W2ldKSk7cmV0dXJuIGUubGVuZ3RoPyI/IitlLmpvaW4oIiYiKToiIn0saS5nZW5SYW5kb21TdHJpbmc9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPSJhYmNkZWZnaGlqa2xub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5IixpPSIiLG49MCxyPWUubGVuZ3RoO248dDsrK24paSs9ZVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqcildO3JldHVybiBpfSxpLmV4dGVuZD1mdW5jdGlvbih0LGUpe2Zvcih2YXIgaSBpbiBlKWUuaGFzT3duUHJvcGVydHkoaSkmJih0W2ldPWVbaV0pfSxpLnJlbW92ZU5pbHM9ZnVuY3Rpb24odCl7dmFyIGU9e307Zm9yKHZhciBpIGluIHQpaWYodC5oYXNPd25Qcm9wZXJ0eShpKSl7dmFyIG49dFtpXTtudWxsIT09biYmdm9pZCAwIT09biYmKGVbaV09bil9cmV0dXJuIGV9LGkuY2xvbmU9ZnVuY3Rpb24odCl7aWYodCl7dmFyIGU9SlNPTi5zdHJpbmdpZnkodCk7aWYoZSlyZXR1cm4gSlNPTi5wYXJzZShlKX1yZXR1cm4gdH0saS5vbWl0PWZ1bmN0aW9uKHQpe3ZhciBlPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSxuPXt9O2Zvcih2YXIgciBpbiB0KXQuaGFzT3duUHJvcGVydHkocikmJmUuaW5kZXhPZihyKT09LTEmJihuW3JdPXRbcl0pO3JldHVybiBpLmNsb25lKG4pfSxpLmZpbmQ9ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9dC5sZW5ndGg7aS0tOyl7dmFyIG49dFtpXSxyPSEwO2Zvcih2YXIgcyBpbiBlKWlmKGUuaGFzT3duUHJvcGVydHkocykmJm5bc10hPT1lW3NdKXtyPSExO2JyZWFrfWlmKHIpcmV0dXJuIG59fSxpLmdldExpbms9ZnVuY3Rpb24odCxlLG4pe2lmKHQmJnQuX2xpbmtzKXt2YXIgcj1pLmNsb25lKHQuX2xpbmtzW2VdKTtyZXR1cm4gciYmci5uYW1lJiZuP3IubmFtZT09PW4/cjp2b2lkIDA6cn19LGkuZ2V0TmF0aXZlQ29uc29sZT1mdW5jdGlvbigpe3JldHVybiB3aW5kb3cuY29uc29sZX0saS5nZXRDb25zb2xlPWZ1bmN0aW9uKCl7dmFyIHQ9aS5nZXROYXRpdmVDb25zb2xlKCk7cmV0dXJuIHQmJnQubG9nP3Q6e2xvZzpmdW5jdGlvbigpe319fSxpLndhcm49ZnVuY3Rpb24odCl7aS5nZXRDb25zb2xlKCkubG9nKCJbb2t0YS1hdXRoLXNka10gV0FSTjogIit0KX0saS5kZXByZWNhdGU9ZnVuY3Rpb24odCl7aS5nZXRDb25zb2xlKCkubG9nKCJbb2t0YS1hdXRoLXNka10gREVQUkVDQVRJT046ICIrdCl9LGkuZGVwcmVjYXRlV3JhcD1mdW5jdGlvbih0LGUpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBpLmRlcHJlY2F0ZSh0KSxlLmFwcGx5KG51bGwsYXJndW1lbnRzKX19LGkucmVtb3ZlVHJhaWxpbmdTbGFzaD1mdW5jdGlvbih0KXtpZih0KXJldHVybiIvIj09PXQuc2xpY2UoLTEpP3Quc2xpY2UoMCwtMSk6dH19LGZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKHQsZSl7dmFyIGk9bS5jbG9uZShlKXx8e307cmV0dXJuIWkuc3RhdGVUb2tlbiYmdC5zdGF0ZVRva2VuJiYoaS5zdGF0ZVRva2VuPXQuc3RhdGVUb2tlbiksaX1mdW5jdGlvbiByKHQpe3JldHVybiBuKHQpfWZ1bmN0aW9uIHModCxlKXtyZXR1cm4gZT1uKHQsZSksZi5wb3N0KHQsdC5vcHRpb25zLnVybCsiL2FwaS92MS9hdXRobiIsZSl9ZnVuY3Rpb24gbyh0LGUpe2lmKCFlfHwhZS5zdGF0ZVRva2VuKXt2YXIgaT10LnR4LmV4aXN0cy5fZ2V0Q29va2llKHkuU1RBVEVfVE9LRU5fQ09PS0lFX05BTUUpO2lmKCFpKXJldHVybiBfLnJlamVjdChuZXcgZygiTm8gdHJhbnNhY3Rpb24gdG8gcmVzdW1lIikpO2U9e3N0YXRlVG9rZW46aX19cmV0dXJuIHQudHguc3RhdHVzKGUpLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBwKHQsZSl9KX1mdW5jdGlvbiBhKHQpe3JldHVybiEhdC50eC5leGlzdHMuX2dldENvb2tpZSh5LlNUQVRFX1RPS0VOX0NPT0tJRV9OQU1FKX1mdW5jdGlvbiBsKHQsZSxpKXtyZXR1cm4gZi5wb3N0KHQsZSxpKS50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiBuZXcgcCh0LGUpfSl9ZnVuY3Rpb24gYyh0LGUsaSl7cmV0dXJuIGZ1bmN0aW9uKG4pe2Z1bmN0aW9uIHMoKXt2YXIgaT1sLmhyZWY7cmV0dXJuIGEmJihpKz0iP3JlbWVtYmVyRGV2aWNlPXRydWUiKSxmLnBvc3QodCxpLHIoZSkse3NhdmVBdXRoblN0YXRlOiExfSl9dmFyIG8sYTttLmlzTnVtYmVyKG4pP289bjptLmlzT2JqZWN0KG4pJiYobz1uLmRlbGF5LGE9bi5yZW1lbWJlckRldmljZSksb3x8MD09PW98fChvPXkuREVGQVVMVF9QT0xMSU5HX0RFTEFZKTt2YXIgbD1tLmdldExpbmsoZSwibmV4dCIsInBvbGwiKTtpLmlzUG9sbGluZz0hMDt2YXIgYz0wLHU9ZnVuY3Rpb24oKXtyZXR1cm4gaS5pc1BvbGxpbmc/cygpLnRoZW4oZnVuY3Rpb24oZSl7aWYoYz0wLGUuZmFjdG9yUmVzdWx0JiYiV0FJVElORyI9PT1lLmZhY3RvclJlc3VsdCl7aWYoIWkuaXNQb2xsaW5nKXRocm93IG5ldyB2O3JldHVybiBfLmRlbGF5KG8pLnRoZW4odSl9cmV0dXJuIGkuaXNQb2xsaW5nPSExLG5ldyBwKHQsZSl9KS5mYWlsKGZ1bmN0aW9uKHQpe2lmKHQueGhyJiYoMD09PXQueGhyLnN0YXR1c3x8NDI5PT09dC54aHIuc3RhdHVzKSYmYzw9NCl7dmFyIGU9MWUzKk1hdGgucG93KDIsYyk7cmV0dXJuIGMrKyxfLmRlbGF5KGUpLnRoZW4odSl9dGhyb3cgdH0pOl8ucmVqZWN0KG5ldyB2KX07cmV0dXJuIHUoKS5mYWlsKGZ1bmN0aW9uKHQpe3Rocm93IGkuaXNQb2xsaW5nPSExLHR9KX19ZnVuY3Rpb24gdSh0LGUsaSxyLHMpe2lmKEFycmF5LmlzQXJyYXkocikpcmV0dXJuIGZ1bmN0aW9uKG4sbyl7aWYoIW4pdGhyb3cgbmV3IGcoIk11c3QgcHJvdmlkZSBhIGxpbmsgbmFtZSIpO3ZhciBhPW0uZmluZChyLHtuYW1lOm59KTtpZighYSl0aHJvdyBuZXcgZygiTm8gbGluayBmb3VuZCBmb3IgdGhhdCBuYW1lIik7cmV0dXJuIHUodCxlLGksYSxzKShvKX07aWYoci5oaW50cyYmci5oaW50cy5hbGxvdyYmMT09PXIuaGludHMuYWxsb3cubGVuZ3RoKXt2YXIgbz1yLmhpbnRzLmFsbG93WzBdO3N3aXRjaChvKXtjYXNlIkdFVCI6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGYuZ2V0KHQsci5ocmVmKX07Y2FzZSJQT1NUIjpyZXR1cm4gZnVuY3Rpb24obyl7cyYmcy5pc1BvbGxpbmcmJihzLmlzUG9sbGluZz0hMSk7dmFyIGE9bihlLG8pOyJNRkFfRU5ST0xMIj09PWUuc3RhdHVzJiZtLmV4dGVuZChhLHtmYWN0b3JUeXBlOmkuZmFjdG9yVHlwZSxwcm92aWRlcjppLnByb3ZpZGVyfSk7dmFyIGM9ci5ocmVmO3JldHVybiB2b2lkIDAhPT1hLnJlbWVtYmVyRGV2aWNlPyhhLnJlbWVtYmVyRGV2aWNlJiYoYys9Ij9yZW1lbWJlckRldmljZT10cnVlIiksYT1tLm9taXQoYSwicmVtZW1iZXJEZXZpY2UiKSk6YS5wcm9maWxlJiZ2b2lkIDAhPT1hLnByb2ZpbGUudXBkYXRlUGhvbmUmJihhLnByb2ZpbGUudXBkYXRlUGhvbmUmJihjKz0iP3VwZGF0ZVBob25lPXRydWUiKSxhLnByb2ZpbGU9bS5vbWl0KGEucHJvZmlsZSwidXBkYXRlUGhvbmUiKSksbCh0LGMsYSl9fX19ZnVuY3Rpb24gZCh0LGUsaSxuKXt2YXIgcj17fTtmb3IodmFyIHMgaW4gaS5fbGlua3MpaWYoaS5fbGlua3MuaGFzT3duUHJvcGVydHkocykpe3ZhciBvPWkuX2xpbmtzW3NdO2lmKCJuZXh0Ij09PXMmJihzPW8ubmFtZSksby50eXBlKXJbc109bztlbHNlIHN3aXRjaChzKXtjYXNlInBvbGwiOnIucG9sbD1jKHQsZSxuKTticmVhaztkZWZhdWx0OnZhciBhPXUodCxlLGksbyxuKTthJiYocltzXT1hKX19cmV0dXJuIHJ9ZnVuY3Rpb24gaCh0LGUsaSxuKXtpZihpPWl8fGUsaT1tLmNsb25lKGkpLEFycmF5LmlzQXJyYXkoaSkpe2Zvcih2YXIgcj1bXSxzPTAsbz1pLmxlbmd0aDtzPG87cysrKXIucHVzaChoKHQsZSxpW3NdLG4pKTtyZXR1cm4gcn12YXIgYT1pLl9lbWJlZGRlZHx8e307Zm9yKHZhciBsIGluIGEpYS5oYXNPd25Qcm9wZXJ0eShsKSYmKG0uaXNPYmplY3QoYVtsXSl8fEFycmF5LmlzQXJyYXkoYVtsXSkpJiYoYVtsXT1oKHQsZSxhW2xdLG4pKTt2YXIgYz1kKHQsZSxpLG4pO3JldHVybiBtLmV4dGVuZChhLGMpLGk9bS5vbWl0KGksIl9lbWJlZGRlZCIsIl9saW5rcyIpLG0uZXh0ZW5kKGksYSksaX1mdW5jdGlvbiBwKHQsZSl7ZSYmKHRoaXMuZGF0YT1lLG0uZXh0ZW5kKHRoaXMsaCh0LGUsZSx7fSkpLGRlbGV0ZSB0aGlzLnN0YXRlVG9rZW4sIlJFQ09WRVJZX0NIQUxMRU5HRSIhPT1lLnN0YXR1c3x8ZS5fbGlua3N8fCh0aGlzLmNhbmNlbD1mdW5jdGlvbigpe3JldHVybiBuZXcgXyhuZXcgcCh0KSl9KSl9dmFyIGY9aSgxNSksbT1pKDEzKSxfPWkoMjEpLGc9aSgxOSksdj1pKDIzKSx5PWkoMjApO3QuZXhwb3J0cz17dHJhbnNhY3Rpb25TdGF0dXM6cyxyZXN1bWVUcmFuc2FjdGlvbjpvLHRyYW5zYWN0aW9uRXhpc3RzOmEscG9zdFRvVHJhbnNhY3Rpb246bH19LGZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKHQsZSl7ZT1lfHx7fTt2YXIgaT1lLnVybCxuPWUubWV0aG9kLHI9ZS5hcmdzLHM9ZS5zYXZlQXV0aG5TdGF0ZSxoPWUuYWNjZXNzVG9rZW4scD1sLmdldEh0dHBDYWNoZSgpO2lmKGUuY2FjaGVSZXNwb25zZSl7dmFyIGY9cC5nZXRTdG9yYWdlKCksbT1mW2ldO2lmKG0mJkRhdGUubm93KCkvMWUzPG0uZXhwaXJlc0F0KXJldHVybiBjLnJlc29sdmUobS5yZXNwb25zZSl9dmFyIF89e0FjY2VwdDoiYXBwbGljYXRpb24vanNvbiIsIkNvbnRlbnQtVHlwZSI6ImFwcGxpY2F0aW9uL2pzb24iLCJYLU9rdGEtVXNlci1BZ2VudC1FeHRlbmRlZCI6Im9rdGEtYXV0aC1qcy0iK2QuU0RLX1ZFUlNJT059O28uZXh0ZW5kKF8sdC5vcHRpb25zLmhlYWRlcnN8fHt9KSxoJiZvLmlzU3RyaW5nKGgpJiYoXy5BdXRob3JpemF0aW9uPSJCZWFyZXIgIitoKTt2YXIgZyx2LHk9e2hlYWRlcnM6XyxkYXRhOnJ8fHZvaWQgMH07cmV0dXJuIG5ldyBjKHQub3B0aW9ucy5hamF4UmVxdWVzdChuLGkseSkpLnRoZW4oZnVuY3Rpb24odCl7cmV0dXJuIHY9dC5yZXNwb25zZVRleHQsdiYmby5pc1N0cmluZyh2KSYmKHY9SlNPTi5wYXJzZSh2KSkscyYmKHYuc3RhdGVUb2tlbnx8YS5kZWxldGVDb29raWUoZC5TVEFURV9UT0tFTl9DT09LSUVfTkFNRSkpLHYmJnYuc3RhdGVUb2tlbiYmdi5leHBpcmVzQXQmJmEuc2V0Q29va2llKGQuU1RBVEVfVE9LRU5fQ09PS0lFX05BTUUsdi5zdGF0ZVRva2VuLHYuZXhwaXJlc0F0KSx2JiZlLmNhY2hlUmVzcG9uc2UmJnAudXBkYXRlU3RvcmFnZShpLHtleHBpcmVzQXQ6TWF0aC5mbG9vcihEYXRlLm5vdygpLzFlMykrZC5ERUZBVUxUX0NBQ0hFX0RVUkFUSU9OLHJlc3BvbnNlOnZ9KSx2fSkuZmFpbChmdW5jdGlvbihlKXt2YXIgaT1lLnJlc3BvbnNlVGV4dHx8e307aWYoby5pc1N0cmluZyhpKSl0cnl7aT1KU09OLnBhcnNlKGkpfWNhdGNoKG4pe2k9e2Vycm9yU3VtbWFyeToiVW5rbm93biBlcnJvciJ9fXRocm93IGUuc3RhdHVzPj01MDAmJihpLmVycm9yU3VtbWFyeT0iVW5rbm93biBlcnJvciIpLHQub3B0aW9ucy50cmFuc2Zvcm1FcnJvclhIUiYmKGU9dC5vcHRpb25zLnRyYW5zZm9ybUVycm9yWEhSKG8uY2xvbmUoZSkpKSxnPW5ldyB1KGksZSksIkUwMDAwMDExIj09PWcuZXJyb3JDb2RlJiZhLmRlbGV0ZUNvb2tpZShkLlNUQVRFX1RPS0VOX0NPT0tJRV9OQU1FKSxnfSl9ZnVuY3Rpb24gcih0LGUsaSl7ZT1vLmlzQWJzb2x1dGVVcmwoZSk/ZTp0Lm9wdGlvbnMudXJsK2U7dmFyIHI9e3VybDplLG1ldGhvZDoiR0VUIn07cmV0dXJuIG8uZXh0ZW5kKHIsaSksbih0LHIpfWZ1bmN0aW9uIHModCxlLGkscil7ZT1vLmlzQWJzb2x1dGVVcmwoZSk/ZTp0Lm9wdGlvbnMudXJsK2U7dmFyIHM9e3VybDplLG1ldGhvZDoiUE9TVCIsYXJnczppLHNhdmVBdXRoblN0YXRlOiEwfTtyZXR1cm4gby5leHRlbmQocyxyKSxuKHQscyl9dmFyIG89aSgxMyksYT1pKDE2KSxsPWkoMTcpLGM9aSgyMSksdT1pKDIyKSxkPWkoMjApO3QuZXhwb3J0cz17Z2V0OnIscG9zdDpzLGh0dHBSZXF1ZXN0Om59fSxmdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gbih0LGUsaSl7dmFyIHI9IiI7aSYmKHI9IiBleHBpcmVzPSIrby5pc29Ub1VUQ1N0cmluZyhpKSsiOyIpO3ZhciBzPXQrIj0iK2UrIjsgcGF0aD0vOyIrcjtyZXR1cm4gbi5fc2V0RG9jdW1lbnRDb29raWUocyksc31mdW5jdGlvbiByKHQpe3ZhciBlPW5ldyBSZWdFeHAodCsiPShbXjtdKikiKSxpPXIuX2dldERvY3VtZW50Q29va2llKCkubWF0Y2goZSk7aWYoaSl7dmFyIG49aVsxXTtyZXR1cm4gbn19ZnVuY3Rpb24gcyh0KXtuKHQsIiIsIjE5NzAtMDEtMDFUMDA6MDA6MDBaIil9dmFyIG89aSgxMyk7bi5fc2V0RG9jdW1lbnRDb29raWU9ZnVuY3Rpb24odCl7ZG9jdW1lbnQuY29va2llPXR9LHIuX2dldERvY3VtZW50Q29va2llPWZ1bmN0aW9uKCl7cmV0dXJuIGRvY3VtZW50LmNvb2tpZX0sdC5leHBvcnRzPXtzZXRDb29raWU6bixnZXRDb29raWU6cixkZWxldGVDb29raWU6c319LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1pKDE2KSxyPWkoMTgpLHM9aSgyMCksbz17fTtvLmJyb3dzZXJIYXNMb2NhbFN0b3JhZ2U9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuISFvLmdldExvY2FsU3RvcmFnZSgpfWNhdGNoKHQpe3JldHVybiExfX0sby5icm93c2VySGFzU2Vzc2lvblN0b3JhZ2U9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuISFvLmdldFNlc3Npb25TdG9yYWdlKCl9Y2F0Y2godCl7cmV0dXJuITF9fSxvLmdldEh0dHBDYWNoZT1mdW5jdGlvbigpe3JldHVybiBvLmJyb3dzZXJIYXNMb2NhbFN0b3JhZ2UoKT9yKG8uZ2V0TG9jYWxTdG9yYWdlKCkscy5DQUNIRV9TVE9SQUdFX05BTUUpOm8uYnJvd3Nlckhhc1Nlc3Npb25TdG9yYWdlKCk/cihvLmdldFNlc3Npb25TdG9yYWdlKCkscy5DQUNIRV9TVE9SQUdFX05BTUUpOnIoby5nZXRDb29raWVTdG9yYWdlKCkscy5DQUNIRV9TVE9SQUdFX05BTUUpfSxvLmdldExvY2FsU3RvcmFnZT1mdW5jdGlvbigpe3JldHVybiBsb2NhbFN0b3JhZ2V9LG8uZ2V0U2Vzc2lvblN0b3JhZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gc2Vzc2lvblN0b3JhZ2V9LG8uZ2V0Q29va2llU3RvcmFnZT1mdW5jdGlvbigpe3JldHVybntnZXRJdGVtOm4uZ2V0Q29va2llLHNldEl0ZW06ZnVuY3Rpb24odCxlKXtuLnNldENvb2tpZSh0LGUsIjIwMzgtMDEtMTlUMDM6MTQ6MDcuMDAwWiIpfX19LHQuZXhwb3J0cz1vfSxmdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gbih0LGUpe2Z1bmN0aW9uIGkoKXt2YXIgaT10LmdldEl0ZW0oZSk7aT1pfHwie30iO3RyeXtyZXR1cm4gSlNPTi5wYXJzZShpKX1jYXRjaChuKXt0aHJvdyBuZXcgcigiVW5hYmxlIHRvIHBhcnNlIHN0b3JhZ2Ugc3RyaW5nOiAiK2UpfX1mdW5jdGlvbiBuKGkpe3RyeXt2YXIgbj1KU09OLnN0cmluZ2lmeShpKTt0LnNldEl0ZW0oZSxuKX1jYXRjaChzKXt0aHJvdyBuZXcgcigiVW5hYmxlIHRvIHNldCBzdG9yYWdlOiAiK2UpfX1mdW5jdGlvbiBzKHQpe3R8fG4oe30pO3ZhciBlPWkoKTtkZWxldGUgZVt0XSxuKGUpfWZ1bmN0aW9uIG8odCxlKXt2YXIgcj1pKCk7clt0XT1lLG4ocil9cmV0dXJue2dldFN0b3JhZ2U6aSxzZXRTdG9yYWdlOm4sY2xlYXJTdG9yYWdlOnMsdXBkYXRlU3RvcmFnZTpvfX12YXIgcj1pKDE5KTt0LmV4cG9ydHM9bn0sZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKHQsZSl7dGhpcy5uYW1lPSJBdXRoU2RrRXJyb3IiLHRoaXMubWVzc2FnZT10LHRoaXMuZXJyb3JDb2RlPSJJTlRFUk5BTCIsdGhpcy5lcnJvclN1bW1hcnk9dCx0aGlzLmVycm9yTGluaz0iSU5URVJOQUwiLHRoaXMuZXJyb3JJZD0iSU5URVJOQUwiLHRoaXMuZXJyb3JDYXVzZXM9W10sZSYmKHRoaXMueGhyPWUpfWkucHJvdG90eXBlPW5ldyBFcnJvcix0LmV4cG9ydHM9aX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9e1NUQVRFX1RPS0VOX0NPT0tJRV9OQU1FOiJva3RhU3RhdGVUb2tlbiIsREVGQVVMVF9QT0xMSU5HX0RFTEFZOjUwMCxERUZBVUxUX01BWF9DTE9DS19TS0VXOjMwMCxERUZBVUxUX0NBQ0hFX0RVUkFUSU9OOjg2NDAwLEZSQU1FX0lEOiJva3RhLW9hdXRoLWhlbHBlci1mcmFtZSIsUkVESVJFQ1RfT0FVVEhfUEFSQU1TX0NPT0tJRV9OQU1FOiJva3RhLW9hdXRoLXJlZGlyZWN0LXBhcmFtcyIsUkVESVJFQ1RfU1RBVEVfQ09PS0lFX05BTUU6Im9rdGEtb2F1dGgtc3RhdGUiLFJFRElSRUNUX05PTkNFX0NPT0tJRV9OQU1FOiJva3RhLW9hdXRoLW5vbmNlIixUT0tFTl9TVE9SQUdFX05BTUU6Im9rdGEtdG9rZW4tc3RvcmFnZSIsQ0FDSEVfU1RPUkFHRV9OQU1FOiJva3RhLWNhY2hlLXN0b3JhZ2UiLFNES19WRVJTSU9OOiIxLjguMCJ9fSxmdW5jdGlvbih0LGUsaSl7LyohCgkJICoKCQkgKiBDb3B5cmlnaHQgMjAwOS0yMDEyIEtyaXMgS293YWwgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNSVQKCQkgKiBsaWNlbnNlIGZvdW5kIGF0IGh0dHA6Ly9naXRodWIuY29tL2tyaXNrb3dhbC9xL3Jhdy9tYXN0ZXIvTElDRU5TRQoJCSAqCgkJICogV2l0aCBwYXJ0cyBieSBUeWxlciBDbG9zZQoJCSAqIENvcHlyaWdodCAyMDA3LTIwMDkgVHlsZXIgQ2xvc2UgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBNSVQgWCBsaWNlbnNlIGZvdW5kCgkJICogYXQgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5odG1sCgkJICogRm9ya2VkIGF0IHJlZl9zZW5kLmpzIHZlcnNpb246IDIwMDktMDUtMTEKCQkgKgoJCSAqIFdpdGggcGFydHMgYnkgTWFyayBNaWxsZXIKCQkgKiBDb3B5cmlnaHQgKEMpIDIwMTEgR29vZ2xlIEluYy4KCQkgKgoJCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCQkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCQkgKgoJCSAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJCSAqCgkJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJCSAqCgkJICovCgkhZnVuY3Rpb24oZSl7InVzZSBzdHJpY3QiO2lmKCJmdW5jdGlvbiI9PXR5cGVvZiBib290c3RyYXApYm9vdHN0cmFwKCJwcm9taXNlIixlKTtlbHNle3QuZXhwb3J0cz1lKCl9fShmdW5jdGlvbigpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiB0KHQpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBHLmFwcGx5KHQsYXJndW1lbnRzKX19ZnVuY3Rpb24gZSh0KXtyZXR1cm4gdD09PU9iamVjdCh0KX1mdW5jdGlvbiBpKHQpe3JldHVybiJbb2JqZWN0IFN0b3BJdGVyYXRpb25dIj09PWl0KHQpfHx0IGluc3RhbmNlb2Ygen1mdW5jdGlvbiBuKHQsZSl7aWYoVSYmZS5zdGFjayYmIm9iamVjdCI9PXR5cGVvZiB0JiZudWxsIT09dCYmdC5zdGFjayYmdC5zdGFjay5pbmRleE9mKG50KT09PS0xKXtmb3IodmFyIGk9W10sbj1lO247bj1uLnNvdXJjZSluLnN0YWNrJiZpLnVuc2hpZnQobi5zdGFjayk7aS51bnNoaWZ0KHQuc3RhY2spO3ZhciBzPWkuam9pbigiXG4iK250KyJcbiIpO3Quc3RhY2s9cihzKX19ZnVuY3Rpb24gcih0KXtmb3IodmFyIGU9dC5zcGxpdCgiXG4iKSxpPVtdLG49MDtuPGUubGVuZ3RoOysrbil7dmFyIHI9ZVtuXTthKHIpfHxzKHIpfHwhcnx8aS5wdXNoKHIpfXJldHVybiBpLmpvaW4oIlxuIil9ZnVuY3Rpb24gcyh0KXtyZXR1cm4gdC5pbmRleE9mKCIobW9kdWxlLmpzOiIpIT09LTF8fHQuaW5kZXhPZigiKG5vZGUuanM6IikhPT0tMX1mdW5jdGlvbiBvKHQpe3ZhciBlPS9hdCAuKyBcKCguKyk6KFxkKyk6KD86XGQrKVwpJC8uZXhlYyh0KTtpZihlKXJldHVybltlWzFdLE51bWJlcihlWzJdKV07dmFyIGk9L2F0IChbXiBdKyk6KFxkKyk6KD86XGQrKSQvLmV4ZWModCk7aWYoaSlyZXR1cm5baVsxXSxOdW1iZXIoaVsyXSldO3ZhciBuPS8uKkAoLispOihcZCspJC8uZXhlYyh0KTtyZXR1cm4gbj9bblsxXSxOdW1iZXIoblsyXSldOnZvaWQgMH1mdW5jdGlvbiBhKHQpe3ZhciBlPW8odCk7aWYoIWUpcmV0dXJuITE7dmFyIGk9ZVswXSxuPWVbMV07cmV0dXJuIGk9PT1CJiZuPj1WJiZuPD1sdH1mdW5jdGlvbiBsKCl7aWYoVSl0cnl7dGhyb3cgbmV3IEVycm9yfWNhdGNoKHQpe3ZhciBlPXQuc3RhY2suc3BsaXQoIlxuIiksaT1lWzBdLmluZGV4T2YoIkAiKT4wP2VbMV06ZVsyXSxuPW8oaSk7aWYoIW4pcmV0dXJuO3JldHVybiBCPW5bMF0sblsxXX19ZnVuY3Rpb24gYyh0LGUsaSl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBjb25zb2xlJiYiZnVuY3Rpb24iPT10eXBlb2YgY29uc29sZS53YXJuJiZjb25zb2xlLndhcm4oZSsiIGlzIGRlcHJlY2F0ZWQsIHVzZSAiK2krIiBpbnN0ZWFkLiIsbmV3IEVycm9yKCIiKS5zdGFjayksdC5hcHBseSh0LGFyZ3VtZW50cyl9fWZ1bmN0aW9uIHUodCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBmP3Q6dih0KT94KHQpOkwodCl9ZnVuY3Rpb24gZCgpe2Z1bmN0aW9uIHQodCl7ZT10LHMuc291cmNlPXQsSyhpLGZ1bmN0aW9uKGUsaSl7dS5uZXh0VGljayhmdW5jdGlvbigpe3QucHJvbWlzZURpc3BhdGNoLmFwcGx5KHQsaSl9KX0sdm9pZCAwKSxpPXZvaWQgMCxuPXZvaWQgMH12YXIgZSxpPVtdLG49W10scj1aKGQucHJvdG90eXBlKSxzPVooZi5wcm90b3R5cGUpO2lmKHMucHJvbWlzZURpc3BhdGNoPWZ1bmN0aW9uKHQscixzKXt2YXIgbz1KKGFyZ3VtZW50cyk7aT8oaS5wdXNoKG8pLCJ3aGVuIj09PXImJnNbMV0mJm4ucHVzaChzWzFdKSk6dS5uZXh0VGljayhmdW5jdGlvbigpe2UucHJvbWlzZURpc3BhdGNoLmFwcGx5KGUsbyl9KX0scy52YWx1ZU9mPWZ1bmN0aW9uKCl7aWYoaSlyZXR1cm4gczt2YXIgdD1fKGUpO3JldHVybiBnKHQpJiYoZT10KSx0fSxzLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gZT9lLmluc3BlY3QoKTp7c3RhdGU6InBlbmRpbmcifX0sdS5sb25nU3RhY2tTdXBwb3J0JiZVKXRyeXt0aHJvdyBuZXcgRXJyb3J9Y2F0Y2gobyl7cy5zdGFjaz1vLnN0YWNrLnN1YnN0cmluZyhvLnN0YWNrLmluZGV4T2YoIlxuIikrMSl9cmV0dXJuIHIucHJvbWlzZT1zLHIucmVzb2x2ZT1mdW5jdGlvbihpKXtlfHx0KHUoaSkpfSxyLmZ1bGZpbGw9ZnVuY3Rpb24oaSl7ZXx8dChMKGkpKX0sci5yZWplY3Q9ZnVuY3Rpb24oaSl7ZXx8dChTKGkpKX0sci5ub3RpZnk9ZnVuY3Rpb24odCl7ZXx8SyhuLGZ1bmN0aW9uKGUsaSl7dS5uZXh0VGljayhmdW5jdGlvbigpe2kodCl9KX0sdm9pZCAwKX0scn1mdW5jdGlvbiBoKHQpe2lmKCJmdW5jdGlvbiIhPXR5cGVvZiB0KXRocm93IG5ldyBUeXBlRXJyb3IoInJlc29sdmVyIG11c3QgYmUgYSBmdW5jdGlvbi4iKTt2YXIgZT1kKCk7dHJ5e3QoZS5yZXNvbHZlLGUucmVqZWN0LGUubm90aWZ5KX1jYXRjaChpKXtlLnJlamVjdChpKX1yZXR1cm4gZS5wcm9taXNlfWZ1bmN0aW9uIHAodCl7cmV0dXJuIGgoZnVuY3Rpb24oZSxpKXtmb3IodmFyIG49MCxyPXQubGVuZ3RoO248cjtuKyspdSh0W25dKS50aGVuKGUsaSl9KX1mdW5jdGlvbiBmKHQsZSxpKXt2b2lkIDA9PT1lJiYoZT1mdW5jdGlvbih0KXtyZXR1cm4gUyhuZXcgRXJyb3IoIlByb21pc2UgZG9lcyBub3Qgc3VwcG9ydCBvcGVyYXRpb246ICIrdCkpfSksdm9pZCAwPT09aSYmKGk9ZnVuY3Rpb24oKXtyZXR1cm57c3RhdGU6InVua25vd24ifX0pO3ZhciBuPVooZi5wcm90b3R5cGUpO2lmKG4ucHJvbWlzZURpc3BhdGNoPWZ1bmN0aW9uKGkscixzKXt2YXIgbzt0cnl7bz10W3JdP3Rbcl0uYXBwbHkobixzKTplLmNhbGwobixyLHMpfWNhdGNoKGEpe289UyhhKX1pJiZpKG8pfSxuLmluc3BlY3Q9aSxpKXt2YXIgcj1pKCk7InJlamVjdGVkIj09PXIuc3RhdGUmJihuLmV4Y2VwdGlvbj1yLnJlYXNvbiksbi52YWx1ZU9mPWZ1bmN0aW9uKCl7dmFyIHQ9aSgpO3JldHVybiJwZW5kaW5nIj09PXQuc3RhdGV8fCJyZWplY3RlZCI9PT10LnN0YXRlP246dC52YWx1ZX19cmV0dXJuIG59ZnVuY3Rpb24gbSh0LGUsaSxuKXtyZXR1cm4gdSh0KS50aGVuKGUsaSxuKX1mdW5jdGlvbiBfKHQpe2lmKGcodCkpe3ZhciBlPXQuaW5zcGVjdCgpO2lmKCJmdWxmaWxsZWQiPT09ZS5zdGF0ZSlyZXR1cm4gZS52YWx1ZX1yZXR1cm4gdH1mdW5jdGlvbiBnKHQpe3JldHVybiB0IGluc3RhbmNlb2YgZn1mdW5jdGlvbiB2KHQpe3JldHVybiBlKHQpJiYiZnVuY3Rpb24iPT10eXBlb2YgdC50aGVufWZ1bmN0aW9uIHkodCl7cmV0dXJuIGcodCkmJiJwZW5kaW5nIj09PXQuaW5zcGVjdCgpLnN0YXRlfWZ1bmN0aW9uIGIodCl7cmV0dXJuIWcodCl8fCJmdWxmaWxsZWQiPT09dC5pbnNwZWN0KCkuc3RhdGV9ZnVuY3Rpb24gdyh0KXtyZXR1cm4gZyh0KSYmInJlamVjdGVkIj09PXQuaW5zcGVjdCgpLnN0YXRlfWZ1bmN0aW9uIE0oKXtydC5sZW5ndGg9MCxzdC5sZW5ndGg9MCxhdHx8KGF0PSEwKX1mdW5jdGlvbiBrKHQsZSl7YXQmJigib2JqZWN0Ij09dHlwZW9mIHByb2Nlc3MmJiJmdW5jdGlvbiI9PXR5cGVvZiBwcm9jZXNzLmVtaXQmJnUubmV4dFRpY2sucnVuQWZ0ZXIoZnVuY3Rpb24oKXtRKHN0LHQpIT09LTEmJihwcm9jZXNzLmVtaXQoInVuaGFuZGxlZFJlamVjdGlvbiIsZSx0KSxvdC5wdXNoKHQpKX0pLHN0LnB1c2godCksZSYmInVuZGVmaW5lZCIhPXR5cGVvZiBlLnN0YWNrP3J0LnB1c2goZS5zdGFjayk6cnQucHVzaCgiKG5vIHN0YWNrKSAiK2UpKX1mdW5jdGlvbiBUKHQpe2lmKGF0KXt2YXIgZT1RKHN0LHQpO2UhPT0tMSYmKCJvYmplY3QiPT10eXBlb2YgcHJvY2VzcyYmImZ1bmN0aW9uIj09dHlwZW9mIHByb2Nlc3MuZW1pdCYmdS5uZXh0VGljay5ydW5BZnRlcihmdW5jdGlvbigpe3ZhciBpPVEob3QsdCk7aSE9PS0xJiYocHJvY2Vzcy5lbWl0KCJyZWplY3Rpb25IYW5kbGVkIixydFtlXSx0KSxvdC5zcGxpY2UoaSwxKSl9KSxzdC5zcGxpY2UoZSwxKSxydC5zcGxpY2UoZSwxKSl9fWZ1bmN0aW9uIFModCl7dmFyIGU9Zih7d2hlbjpmdW5jdGlvbihlKXtyZXR1cm4gZSYmVCh0aGlzKSxlP2UodCk6dGhpc319LGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LGZ1bmN0aW9uKCl7cmV0dXJue3N0YXRlOiJyZWplY3RlZCIscmVhc29uOnR9fSk7cmV0dXJuIGsoZSx0KSxlfWZ1bmN0aW9uIEwodCl7cmV0dXJuIGYoe3doZW46ZnVuY3Rpb24oKXtyZXR1cm4gdH0sZ2V0OmZ1bmN0aW9uKGUpe3JldHVybiB0W2VdfSxzZXQ6ZnVuY3Rpb24oZSxpKXt0W2VdPWl9LCJkZWxldGUiOmZ1bmN0aW9uKGUpe2RlbGV0ZSB0W2VdfSxwb3N0OmZ1bmN0aW9uKGUsaSl7cmV0dXJuIG51bGw9PT1lfHx2b2lkIDA9PT1lP3QuYXBwbHkodm9pZCAwLGkpOnRbZV0uYXBwbHkodCxpKX0sYXBwbHk6ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdC5hcHBseShlLGkpfSxrZXlzOmZ1bmN0aW9uKCl7cmV0dXJuIGV0KHQpfX0sdm9pZCAwLGZ1bmN0aW9uKCl7cmV0dXJue3N0YXRlOiJmdWxmaWxsZWQiLHZhbHVlOnR9fSl9ZnVuY3Rpb24geCh0KXt2YXIgZT1kKCk7cmV0dXJuIHUubmV4dFRpY2soZnVuY3Rpb24oKXt0cnl7dC50aGVuKGUucmVzb2x2ZSxlLnJlamVjdCxlLm5vdGlmeSl9Y2F0Y2goaSl7ZS5yZWplY3QoaSl9fSksZS5wcm9taXNlfWZ1bmN0aW9uIEUodCl7cmV0dXJuIGYoe2lzRGVmOmZ1bmN0aW9uKCl7fX0sZnVuY3Rpb24oZSxpKXtyZXR1cm4gTih0LGUsaSl9LGZ1bmN0aW9uKCl7cmV0dXJuIHUodCkuaW5zcGVjdCgpfSl9ZnVuY3Rpb24gRCh0LGUsaSl7cmV0dXJuIHUodCkuc3ByZWFkKGUsaSl9ZnVuY3Rpb24gWSh0KXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsZSl7dmFyIG87aWYoInVuZGVmaW5lZCI9PXR5cGVvZiBTdG9wSXRlcmF0aW9uKXt0cnl7bz1uW3RdKGUpfWNhdGNoKGEpe3JldHVybiBTKGEpfXJldHVybiBvLmRvbmU/dShvLnZhbHVlKTptKG8udmFsdWUscixzKX10cnl7bz1uW3RdKGUpfWNhdGNoKGEpe3JldHVybiBpKGEpP3UoYS52YWx1ZSk6UyhhKX1yZXR1cm4gbShvLHIscyl9dmFyIG49dC5hcHBseSh0aGlzLGFyZ3VtZW50cykscj1lLmJpbmQoZSwibmV4dCIpLHM9ZS5iaW5kKGUsInRocm93Iik7cmV0dXJuIHIoKX19ZnVuY3Rpb24gQyh0KXt1LmRvbmUodS5hc3luYyh0KSgpKX1mdW5jdGlvbiBBKHQpe3Rocm93IG5ldyB6KHQpfWZ1bmN0aW9uIE8odCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIEQoW3RoaXMsSShhcmd1bWVudHMpXSxmdW5jdGlvbihlLGkpe3JldHVybiB0LmFwcGx5KGUsaSl9KX19ZnVuY3Rpb24gTih0LGUsaSl7cmV0dXJuIHUodCkuZGlzcGF0Y2goZSxpKX1mdW5jdGlvbiBJKHQpe3JldHVybiBtKHQsZnVuY3Rpb24odCl7dmFyIGU9MCxpPWQoKTtyZXR1cm4gSyh0LGZ1bmN0aW9uKG4scixzKXt2YXIgbztnKHIpJiYiZnVsZmlsbGVkIj09PShvPXIuaW5zcGVjdCgpKS5zdGF0ZT90W3NdPW8udmFsdWU6KCsrZSxtKHIsZnVuY3Rpb24obil7dFtzXT1uLDA9PT0tLWUmJmkucmVzb2x2ZSh0KX0saS5yZWplY3QsZnVuY3Rpb24odCl7aS5ub3RpZnkoe2luZGV4OnMsdmFsdWU6dH0pfSkpfSx2b2lkIDApLDA9PT1lJiZpLnJlc29sdmUodCksaS5wcm9taXNlfSl9ZnVuY3Rpb24gUCh0KXtpZigwPT09dC5sZW5ndGgpcmV0dXJuIHUucmVzb2x2ZSgpO3ZhciBlPXUuZGVmZXIoKSxpPTA7cmV0dXJuIEsodCxmdW5jdGlvbihuLHIscyl7ZnVuY3Rpb24gbyh0KXtlLnJlc29sdmUodCl9ZnVuY3Rpb24gYSgpe2ktLSwwPT09aSYmZS5yZWplY3QobmV3IEVycm9yKCJDYW4ndCBnZXQgZnVsZmlsbG1lbnQgdmFsdWUgZnJvbSBhbnkgcHJvbWlzZSwgYWxsIHByb21pc2VzIHdlcmUgcmVqZWN0ZWQuIikpfWZ1bmN0aW9uIGwodCl7ZS5ub3RpZnkoe2luZGV4OnMsdmFsdWU6dH0pfXZhciBjPXRbc107aSsrLG0oYyxvLGEsbCl9LHZvaWQgMCksZS5wcm9taXNlfWZ1bmN0aW9uIFIodCl7cmV0dXJuIG0odCxmdW5jdGlvbih0KXtyZXR1cm4gdD1YKHQsdSksbShJKFgodCxmdW5jdGlvbih0KXtyZXR1cm4gbSh0LCQsJCl9KSksZnVuY3Rpb24oKXtyZXR1cm4gdH0pfSl9ZnVuY3Rpb24gSCh0KXtyZXR1cm4gdSh0KS5hbGxTZXR0bGVkKCl9ZnVuY3Rpb24gaih0LGUpe3JldHVybiB1KHQpLnRoZW4odm9pZCAwLHZvaWQgMCxlKX1mdW5jdGlvbiBGKHQsZSl7cmV0dXJuIHUodCkubm9kZWlmeShlKX12YXIgVT0hMTt0cnl7dGhyb3cgbmV3IEVycm9yfWNhdGNoKFcpe1U9ISFXLnN0YWNrfXZhciBCLHosVj1sKCksJD1mdW5jdGlvbigpe30scT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXtmb3IodmFyIHQsbjtpLm5leHQ7KWk9aS5uZXh0LHQ9aS50YXNrLGkudGFzaz12b2lkIDAsbj1pLmRvbWFpbixuJiYoaS5kb21haW49dm9pZCAwLG4uZW50ZXIoKSksZSh0LG4pO2Zvcig7YS5sZW5ndGg7KXQ9YS5wb3AoKSxlKHQpO3I9ITF9ZnVuY3Rpb24gZShlLGkpe3RyeXtlKCl9Y2F0Y2gobil7aWYobyl0aHJvdyBpJiZpLmV4aXQoKSxzZXRUaW1lb3V0KHQsMCksaSYmaS5lbnRlcigpLG47c2V0VGltZW91dChmdW5jdGlvbigpe3Rocm93IG59LDApfWkmJmkuZXhpdCgpfXZhciBpPXt0YXNrOnZvaWQgMCxuZXh0Om51bGx9LG49aSxyPSExLHM9dm9pZCAwLG89ITEsYT1bXTtpZihxPWZ1bmN0aW9uKHQpe249bi5uZXh0PXt0YXNrOnQsZG9tYWluOm8mJnByb2Nlc3MuZG9tYWluLG5leHQ6bnVsbH0scnx8KHI9ITAscygpKX0sIm9iamVjdCI9PXR5cGVvZiBwcm9jZXNzJiYiW29iamVjdCBwcm9jZXNzXSI9PT1wcm9jZXNzLnRvU3RyaW5nKCkmJnByb2Nlc3MubmV4dFRpY2spbz0hMCxzPWZ1bmN0aW9uKCl7cHJvY2Vzcy5uZXh0VGljayh0KX07ZWxzZSBpZigiZnVuY3Rpb24iPT10eXBlb2Ygc2V0SW1tZWRpYXRlKXM9InVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3c/c2V0SW1tZWRpYXRlLmJpbmQod2luZG93LHQpOmZ1bmN0aW9uKCl7c2V0SW1tZWRpYXRlKHQpfTtlbHNlIGlmKCJ1bmRlZmluZWQiIT10eXBlb2YgTWVzc2FnZUNoYW5uZWwpe3ZhciBsPW5ldyBNZXNzYWdlQ2hhbm5lbDtsLnBvcnQxLm9ubWVzc2FnZT1mdW5jdGlvbigpe3M9YyxsLnBvcnQxLm9ubWVzc2FnZT10LHQoKX07dmFyIGM9ZnVuY3Rpb24oKXtsLnBvcnQyLnBvc3RNZXNzYWdlKDApfTtzPWZ1bmN0aW9uKCl7c2V0VGltZW91dCh0LDApLGMoKX19ZWxzZSBzPWZ1bmN0aW9uKCl7c2V0VGltZW91dCh0LDApfTtyZXR1cm4gcS5ydW5BZnRlcj1mdW5jdGlvbih0KXthLnB1c2godCkscnx8KHI9ITAscygpKX0scX0oKSxHPUZ1bmN0aW9uLmNhbGwsSj10KEFycmF5LnByb3RvdHlwZS5zbGljZSksSz10KEFycmF5LnByb3RvdHlwZS5yZWR1Y2V8fGZ1bmN0aW9uKHQsZSl7dmFyIGk9MCxuPXRoaXMubGVuZ3RoO2lmKDE9PT1hcmd1bWVudHMubGVuZ3RoKWZvcig7Oyl7aWYoaSBpbiB0aGlzKXtlPXRoaXNbaSsrXTticmVha31pZigrK2k+PW4pdGhyb3cgbmV3IFR5cGVFcnJvcn1mb3IoO2k8bjtpKyspaSBpbiB0aGlzJiYoZT10KGUsdGhpc1tpXSxpKSk7cmV0dXJuIGV9KSxRPXQoQXJyYXkucHJvdG90eXBlLmluZGV4T2Z8fGZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wO2U8dGhpcy5sZW5ndGg7ZSsrKWlmKHRoaXNbZV09PT10KXJldHVybiBlO3JldHVybi0xfSksWD10KEFycmF5LnByb3RvdHlwZS5tYXB8fGZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcyxuPVtdO3JldHVybiBLKGksZnVuY3Rpb24ocixzLG8pe24ucHVzaCh0LmNhbGwoZSxzLG8saSkpfSx2b2lkIDApLG59KSxaPU9iamVjdC5jcmVhdGV8fGZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoKXt9cmV0dXJuIGUucHJvdG90eXBlPXQsbmV3IGV9LHR0PXQoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSksZXQ9T2JqZWN0LmtleXN8fGZ1bmN0aW9uKHQpe3ZhciBlPVtdO2Zvcih2YXIgaSBpbiB0KXR0KHQsaSkmJmUucHVzaChpKTtyZXR1cm4gZX0saXQ9dChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nKTt6PSJ1bmRlZmluZWQiIT10eXBlb2YgUmV0dXJuVmFsdWU/UmV0dXJuVmFsdWU6ZnVuY3Rpb24odCl7dGhpcy52YWx1ZT10fTt2YXIgbnQ9IkZyb20gcHJldmlvdXMgZXZlbnQ6Ijt1LnJlc29sdmU9dSx1Lm5leHRUaWNrPXEsdS5sb25nU3RhY2tTdXBwb3J0PSExLCJvYmplY3QiPT10eXBlb2YgcHJvY2VzcyYmcHJvY2VzcyYmcHJvY2Vzcy5lbnYmJnByb2Nlc3MuZW52LlFfREVCVUcmJih1LmxvbmdTdGFja1N1cHBvcnQ9ITApLHUuZGVmZXI9ZCxkLnByb3RvdHlwZS5tYWtlTm9kZVJlc29sdmVyPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcztyZXR1cm4gZnVuY3Rpb24oZSxpKXtlP3QucmVqZWN0KGUpOmFyZ3VtZW50cy5sZW5ndGg+Mj90LnJlc29sdmUoSihhcmd1bWVudHMsMSkpOnQucmVzb2x2ZShpKX19LHUuUHJvbWlzZT1oLHUucHJvbWlzZT1oLGgucmFjZT1wLGguYWxsPUksaC5yZWplY3Q9UyxoLnJlc29sdmU9dSx1LnBhc3NCeUNvcHk9ZnVuY3Rpb24odCl7cmV0dXJuIHR9LGYucHJvdG90eXBlLnBhc3NCeUNvcHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sdS5qb2luPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHUodCkuam9pbihlKX0sZi5wcm90b3R5cGUuam9pbj1mdW5jdGlvbih0KXtyZXR1cm4gdShbdGhpcyx0XSkuc3ByZWFkKGZ1bmN0aW9uKHQsZSl7aWYodD09PWUpcmV0dXJuIHQ7dGhyb3cgbmV3IEVycm9yKCJDYW4ndCBqb2luOiBub3QgdGhlIHNhbWU6ICIrdCsiICIrZSl9KX0sdS5yYWNlPXAsZi5wcm90b3R5cGUucmFjZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRoZW4odS5yYWNlKX0sdS5tYWtlUHJvbWlzZT1mLGYucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIltvYmplY3QgUHJvbWlzZV0ifSxmLnByb3RvdHlwZS50aGVuPWZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiByKGUpe3RyeXtyZXR1cm4iZnVuY3Rpb24iPT10eXBlb2YgdD90KGUpOmV9Y2F0Y2goaSl7cmV0dXJuIFMoaSl9fWZ1bmN0aW9uIHModCl7aWYoImZ1bmN0aW9uIj09dHlwZW9mIGUpe24odCxhKTt0cnl7cmV0dXJuIGUodCl9Y2F0Y2goaSl7cmV0dXJuIFMoaSl9fXJldHVybiBTKHQpfWZ1bmN0aW9uIG8odCl7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIGk/aSh0KTp0fXZhciBhPXRoaXMsbD1kKCksYz0hMTtyZXR1cm4gdS5uZXh0VGljayhmdW5jdGlvbigpe2EucHJvbWlzZURpc3BhdGNoKGZ1bmN0aW9uKHQpe2N8fChjPSEwLGwucmVzb2x2ZShyKHQpKSl9LCJ3aGVuIixbZnVuY3Rpb24odCl7Y3x8KGM9ITAsbC5yZXNvbHZlKHModCkpKX1dKX0pLGEucHJvbWlzZURpc3BhdGNoKHZvaWQgMCwid2hlbiIsW3ZvaWQgMCxmdW5jdGlvbih0KXt2YXIgZSxpPSExO3RyeXtlPW8odCl9Y2F0Y2gobil7aWYoaT0hMCwhdS5vbmVycm9yKXRocm93IG47dS5vbmVycm9yKG4pfWl8fGwubm90aWZ5KGUpfV0pLGwucHJvbWlzZX0sdS50YXA9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdSh0KS50YXAoZSl9LGYucHJvdG90eXBlLnRhcD1mdW5jdGlvbih0KXtyZXR1cm4gdD11KHQpLHRoaXMudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gdC5mY2FsbChlKS50aGVuUmVzb2x2ZShlKX0pfSx1LndoZW49bSxmLnByb3RvdHlwZS50aGVuUmVzb2x2ZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHR9KX0sdS50aGVuUmVzb2x2ZT1mdW5jdGlvbih0LGUpe3JldHVybiB1KHQpLnRoZW5SZXNvbHZlKGUpfSxmLnByb3RvdHlwZS50aGVuUmVqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRoZW4oZnVuY3Rpb24oKXt0aHJvdyB0fSl9LHUudGhlblJlamVjdD1mdW5jdGlvbih0LGUpe3JldHVybiB1KHQpLnRoZW5SZWplY3QoZSl9LHUubmVhcmVyPV8sdS5pc1Byb21pc2U9Zyx1LmlzUHJvbWlzZUFsaWtlPXYsdS5pc1BlbmRpbmc9eSxmLnByb3RvdHlwZS5pc1BlbmRpbmc9ZnVuY3Rpb24oKXtyZXR1cm4icGVuZGluZyI9PT10aGlzLmluc3BlY3QoKS5zdGF0ZX0sdS5pc0Z1bGZpbGxlZD1iLGYucHJvdG90eXBlLmlzRnVsZmlsbGVkPWZ1bmN0aW9uKCl7cmV0dXJuImZ1bGZpbGxlZCI9PT10aGlzLmluc3BlY3QoKS5zdGF0ZX0sdS5pc1JlamVjdGVkPXcsZi5wcm90b3R5cGUuaXNSZWplY3RlZD1mdW5jdGlvbigpe3JldHVybiJyZWplY3RlZCI9PT10aGlzLmluc3BlY3QoKS5zdGF0ZX07dmFyIHJ0PVtdLHN0PVtdLG90PVtdLGF0PSEwO3UucmVzZXRVbmhhbmRsZWRSZWplY3Rpb25zPU0sdS5nZXRVbmhhbmRsZWRSZWFzb25zPWZ1bmN0aW9uKCl7cmV0dXJuIHJ0LnNsaWNlKCl9LHUuc3RvcFVuaGFuZGxlZFJlamVjdGlvblRyYWNraW5nPWZ1bmN0aW9uKCl7TSgpLGF0PSExfSxNKCksdS5yZWplY3Q9Uyx1LmZ1bGZpbGw9TCx1Lm1hc3Rlcj1FLHUuc3ByZWFkPUQsZi5wcm90b3R5cGUuc3ByZWFkPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuYWxsKCkudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gdC5hcHBseSh2b2lkIDAsZSl9LGUpfSx1LmFzeW5jPVksdS5zcGF3bj1DLHVbInJldHVybiJdPUEsdS5wcm9taXNlZD1PLHUuZGlzcGF0Y2g9TixmLnByb3RvdHlwZS5kaXNwYXRjaD1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMsbj1kKCk7cmV0dXJuIHUubmV4dFRpY2soZnVuY3Rpb24oKXtpLnByb21pc2VEaXNwYXRjaChuLnJlc29sdmUsdCxlKX0pLG4ucHJvbWlzZX0sdS5nZXQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdSh0KS5kaXNwYXRjaCgiZ2V0IixbZV0pfSxmLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZGlzcGF0Y2goImdldCIsW3RdKX0sdS5zZXQ9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB1KHQpLmRpc3BhdGNoKCJzZXQiLFtlLGldKX0sZi5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuZGlzcGF0Y2goInNldCIsW3QsZV0pfSx1LmRlbD11WyJkZWxldGUiXT1mdW5jdGlvbih0LGUpe3JldHVybiB1KHQpLmRpc3BhdGNoKCJkZWxldGUiLFtlXSl9LGYucHJvdG90eXBlLmRlbD1mLnByb3RvdHlwZVsiZGVsZXRlIl09ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZGlzcGF0Y2goImRlbGV0ZSIsW3RdKX0sdS5tYXBwbHk9dS5wb3N0PWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdSh0KS5kaXNwYXRjaCgicG9zdCIsW2UsaV0pfSxmLnByb3RvdHlwZS5tYXBwbHk9Zi5wcm90b3R5cGUucG9zdD1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmRpc3BhdGNoKCJwb3N0IixbdCxlXSl9LHUuc2VuZD11Lm1jYWxsPXUuaW52b2tlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHUodCkuZGlzcGF0Y2goInBvc3QiLFtlLEooYXJndW1lbnRzLDIpXSl9LGYucHJvdG90eXBlLnNlbmQ9Zi5wcm90b3R5cGUubWNhbGw9Zi5wcm90b3R5cGUuaW52b2tlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRpc3BhdGNoKCJwb3N0IixbdCxKKGFyZ3VtZW50cywxKV0pfSx1LmZhcHBseT1mdW5jdGlvbih0LGUpe3JldHVybiB1KHQpLmRpc3BhdGNoKCJhcHBseSIsW3ZvaWQgMCxlXSl9LGYucHJvdG90eXBlLmZhcHBseT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5kaXNwYXRjaCgiYXBwbHkiLFt2b2lkIDAsdF0pfSx1WyJ0cnkiXT11LmZjYWxsPWZ1bmN0aW9uKHQpe3JldA==", "base64"));
  res.write(new Buffer("dXJuIHUodCkuZGlzcGF0Y2goImFwcGx5Iixbdm9pZCAwLEooYXJndW1lbnRzLDEpXSl9LGYucHJvdG90eXBlLmZjYWxsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzcGF0Y2goImFwcGx5Iixbdm9pZCAwLEooYXJndW1lbnRzKV0pfSx1LmZiaW5kPWZ1bmN0aW9uKHQpe3ZhciBlPXUodCksaT1KKGFyZ3VtZW50cywxKTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZS5kaXNwYXRjaCgiYXBwbHkiLFt0aGlzLGkuY29uY2F0KEooYXJndW1lbnRzKSldKX19LGYucHJvdG90eXBlLmZiaW5kPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxlPUooYXJndW1lbnRzKTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdC5kaXNwYXRjaCgiYXBwbHkiLFt0aGlzLGUuY29uY2F0KEooYXJndW1lbnRzKSldKX19LHUua2V5cz1mdW5jdGlvbih0KXtyZXR1cm4gdSh0KS5kaXNwYXRjaCgia2V5cyIsW10pfSxmLnByb3RvdHlwZS5rZXlzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzcGF0Y2goImtleXMiLFtdKX0sdS5hbGw9SSxmLnByb3RvdHlwZS5hbGw9ZnVuY3Rpb24oKXtyZXR1cm4gSSh0aGlzKX0sdS5hbnk9UCxmLnByb3RvdHlwZS5hbnk9ZnVuY3Rpb24oKXtyZXR1cm4gUCh0aGlzKX0sdS5hbGxSZXNvbHZlZD1jKFIsImFsbFJlc29sdmVkIiwiYWxsU2V0dGxlZCIpLGYucHJvdG90eXBlLmFsbFJlc29sdmVkPWZ1bmN0aW9uKCl7cmV0dXJuIFIodGhpcyl9LHUuYWxsU2V0dGxlZD1ILGYucHJvdG90eXBlLmFsbFNldHRsZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiBJKFgodCxmdW5jdGlvbih0KXtmdW5jdGlvbiBlKCl7cmV0dXJuIHQuaW5zcGVjdCgpfXJldHVybiB0PXUodCksdC50aGVuKGUsZSl9KSl9KX0sdS5mYWlsPXVbImNhdGNoIl09ZnVuY3Rpb24odCxlKXtyZXR1cm4gdSh0KS50aGVuKHZvaWQgMCxlKX0sZi5wcm90b3R5cGUuZmFpbD1mLnByb3RvdHlwZVsiY2F0Y2giXT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy50aGVuKHZvaWQgMCx0KX0sdS5wcm9ncmVzcz1qLGYucHJvdG90eXBlLnByb2dyZXNzPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRoZW4odm9pZCAwLHZvaWQgMCx0KX0sdS5maW49dVsiZmluYWxseSJdPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHUodClbImZpbmFsbHkiXShlKX0sZi5wcm90b3R5cGUuZmluPWYucHJvdG90eXBlWyJmaW5hbGx5Il09ZnVuY3Rpb24odCl7cmV0dXJuIHQ9dSh0KSx0aGlzLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIHQuZmNhbGwoKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGV9KX0sZnVuY3Rpb24oZSl7cmV0dXJuIHQuZmNhbGwoKS50aGVuKGZ1bmN0aW9uKCl7dGhyb3cgZX0pfSl9LHUuZG9uZT1mdW5jdGlvbih0LGUsaSxuKXtyZXR1cm4gdSh0KS5kb25lKGUsaSxuKX0sZi5wcm90b3R5cGUuZG9uZT1mdW5jdGlvbih0LGUsaSl7dmFyIHI9ZnVuY3Rpb24odCl7dS5uZXh0VGljayhmdW5jdGlvbigpe2lmKG4odCxzKSwhdS5vbmVycm9yKXRocm93IHQ7dS5vbmVycm9yKHQpfSl9LHM9dHx8ZXx8aT90aGlzLnRoZW4odCxlLGkpOnRoaXM7Im9iamVjdCI9PXR5cGVvZiBwcm9jZXNzJiZwcm9jZXNzJiZwcm9jZXNzLmRvbWFpbiYmKHI9cHJvY2Vzcy5kb21haW4uYmluZChyKSkscy50aGVuKHZvaWQgMCxyKX0sdS50aW1lb3V0PWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdSh0KS50aW1lb3V0KGUsaSl9LGYucHJvdG90eXBlLnRpbWVvdXQ9ZnVuY3Rpb24odCxlKXt2YXIgaT1kKCksbj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZSYmInN0cmluZyIhPXR5cGVvZiBlfHwoZT1uZXcgRXJyb3IoZXx8IlRpbWVkIG91dCBhZnRlciAiK3QrIiBtcyIpLGUuY29kZT0iRVRJTUVET1VUIiksaS5yZWplY3QoZSl9LHQpO3JldHVybiB0aGlzLnRoZW4oZnVuY3Rpb24odCl7Y2xlYXJUaW1lb3V0KG4pLGkucmVzb2x2ZSh0KX0sZnVuY3Rpb24odCl7Y2xlYXJUaW1lb3V0KG4pLGkucmVqZWN0KHQpfSxpLm5vdGlmeSksaS5wcm9taXNlfSx1LmRlbGF5PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPXQsdD12b2lkIDApLHUodCkuZGVsYXkoZSl9LGYucHJvdG90eXBlLmRlbGF5PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRoZW4oZnVuY3Rpb24oZSl7dmFyIGk9ZCgpO3JldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7aS5yZXNvbHZlKGUpfSx0KSxpLnByb21pc2V9KX0sdS5uZmFwcGx5PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHUodCkubmZhcHBseShlKX0sZi5wcm90b3R5cGUubmZhcHBseT1mdW5jdGlvbih0KXt2YXIgZT1kKCksaT1KKHQpO3JldHVybiBpLnB1c2goZS5tYWtlTm9kZVJlc29sdmVyKCkpLHRoaXMuZmFwcGx5KGkpLmZhaWwoZS5yZWplY3QpLGUucHJvbWlzZX0sdS5uZmNhbGw9ZnVuY3Rpb24odCl7dmFyIGU9Sihhcmd1bWVudHMsMSk7cmV0dXJuIHUodCkubmZhcHBseShlKX0sZi5wcm90b3R5cGUubmZjYWxsPWZ1bmN0aW9uKCl7dmFyIHQ9Sihhcmd1bWVudHMpLGU9ZCgpO3JldHVybiB0LnB1c2goZS5tYWtlTm9kZVJlc29sdmVyKCkpLHRoaXMuZmFwcGx5KHQpLmZhaWwoZS5yZWplY3QpLGUucHJvbWlzZX0sdS5uZmJpbmQ9dS5kZW5vZGVpZnk9ZnVuY3Rpb24odCl7dmFyIGU9Sihhcmd1bWVudHMsMSk7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGk9ZS5jb25jYXQoSihhcmd1bWVudHMpKSxuPWQoKTtyZXR1cm4gaS5wdXNoKG4ubWFrZU5vZGVSZXNvbHZlcigpKSx1KHQpLmZhcHBseShpKS5mYWlsKG4ucmVqZWN0KSxuLnByb21pc2V9fSxmLnByb3RvdHlwZS5uZmJpbmQ9Zi5wcm90b3R5cGUuZGVub2RlaWZ5PWZ1bmN0aW9uKCl7dmFyIHQ9Sihhcmd1bWVudHMpO3JldHVybiB0LnVuc2hpZnQodGhpcyksdS5kZW5vZGVpZnkuYXBwbHkodm9pZCAwLHQpfSx1Lm5iaW5kPWZ1bmN0aW9uKHQsZSl7dmFyIGk9Sihhcmd1bWVudHMsMik7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuY3Rpb24gbigpe3JldHVybiB0LmFwcGx5KGUsYXJndW1lbnRzKX12YXIgcj1pLmNvbmNhdChKKGFyZ3VtZW50cykpLHM9ZCgpO3JldHVybiByLnB1c2gocy5tYWtlTm9kZVJlc29sdmVyKCkpLHUobikuZmFwcGx5KHIpLmZhaWwocy5yZWplY3QpLHMucHJvbWlzZX19LGYucHJvdG90eXBlLm5iaW5kPWZ1bmN0aW9uKCl7dmFyIHQ9Sihhcmd1bWVudHMsMCk7cmV0dXJuIHQudW5zaGlmdCh0aGlzKSx1Lm5iaW5kLmFwcGx5KHZvaWQgMCx0KX0sdS5ubWFwcGx5PXUubnBvc3Q9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB1KHQpLm5wb3N0KGUsaSl9LGYucHJvdG90eXBlLm5tYXBwbHk9Zi5wcm90b3R5cGUubnBvc3Q9ZnVuY3Rpb24odCxlKXt2YXIgaT1KKGV8fFtdKSxuPWQoKTtyZXR1cm4gaS5wdXNoKG4ubWFrZU5vZGVSZXNvbHZlcigpKSx0aGlzLmRpc3BhdGNoKCJwb3N0IixbdCxpXSkuZmFpbChuLnJlamVjdCksbi5wcm9taXNlfSx1Lm5zZW5kPXUubm1jYWxsPXUubmludm9rZT1mdW5jdGlvbih0LGUpe3ZhciBpPUooYXJndW1lbnRzLDIpLG49ZCgpO3JldHVybiBpLnB1c2gobi5tYWtlTm9kZVJlc29sdmVyKCkpLHUodCkuZGlzcGF0Y2goInBvc3QiLFtlLGldKS5mYWlsKG4ucmVqZWN0KSxuLnByb21pc2V9LGYucHJvdG90eXBlLm5zZW5kPWYucHJvdG90eXBlLm5tY2FsbD1mLnByb3RvdHlwZS5uaW52b2tlPWZ1bmN0aW9uKHQpe3ZhciBlPUooYXJndW1lbnRzLDEpLGk9ZCgpO3JldHVybiBlLnB1c2goaS5tYWtlTm9kZVJlc29sdmVyKCkpLHRoaXMuZGlzcGF0Y2goInBvc3QiLFt0LGVdKS5mYWlsKGkucmVqZWN0KSxpLnByb21pc2V9LHUubm9kZWlmeT1GLGYucHJvdG90eXBlLm5vZGVpZnk9ZnVuY3Rpb24odCl7cmV0dXJuIHQ/dm9pZCB0aGlzLnRoZW4oZnVuY3Rpb24oZSl7dS5uZXh0VGljayhmdW5jdGlvbigpe3QobnVsbCxlKX0pfSxmdW5jdGlvbihlKXt1Lm5leHRUaWNrKGZ1bmN0aW9uKCl7dChlKX0pfSk6dGhpc30sdS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKCJRLm5vQ29uZmxpY3Qgb25seSB3b3JrcyB3aGVuIFEgaXMgdXNlZCBhcyBhIGdsb2JhbCIpfTt2YXIgbHQ9bCgpO3JldHVybiB1fSl9LGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSh0LGUpe3RoaXMubmFtZT0iQXV0aEFwaUVycm9yIix0aGlzLm1lc3NhZ2U9dC5lcnJvclN1bW1hcnksdGhpcy5lcnJvclN1bW1hcnk9dC5lcnJvclN1bW1hcnksdGhpcy5lcnJvckNvZGU9dC5lcnJvckNvZGUsdGhpcy5lcnJvckxpbms9dC5lcnJvckxpbmssdGhpcy5lcnJvcklkPXQuZXJyb3JJZCx0aGlzLmVycm9yQ2F1c2VzPXQuZXJyb3JDYXVzZXMsZSYmKHRoaXMueGhyPWUpfWkucHJvdG90eXBlPW5ldyBFcnJvcix0LmV4cG9ydHM9aX0sZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKCl7dGhpcy5uYW1lPSJBdXRoUG9sbFN0b3BFcnJvciIsdGhpcy5tZXNzYWdlPSJUaGUgcG9sbCB3YXMgc3RvcHBlZCBieSB0aGUgc2RrIn1pLnByb3RvdHlwZT1uZXcgRXJyb3IsdC5leHBvcnRzPWl9LGZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKHQpe3JldHVybiB0LnNlc3Npb24uZ2V0KCkudGhlbihmdW5jdGlvbih0KXtyZXR1cm4iQUNUSVZFIj09PXQuc3RhdHVzfSkuZmFpbChmdW5jdGlvbigpe3JldHVybiExfSl9ZnVuY3Rpb24gcih0KXtyZXR1cm4gYy5nZXQodCwiL2FwaS92MS9zZXNzaW9ucy9tZSIpLnRoZW4oZnVuY3Rpb24oZSl7dmFyIGk9bC5vbWl0KGUsIl9saW5rcyIpO3JldHVybiBpLnJlZnJlc2g9ZnVuY3Rpb24oKXtyZXR1cm4gYy5wb3N0KHQsbC5nZXRMaW5rKGUsInJlZnJlc2giKS5ocmVmKX0saS51c2VyPWZ1bmN0aW9uKCl7cmV0dXJuIGMuZ2V0KHQsbC5nZXRMaW5rKGUsInVzZXIiKS5ocmVmKX0saX0pLmZhaWwoZnVuY3Rpb24oKXtyZXR1cm57c3RhdHVzOiJJTkFDVElWRSJ9fSl9ZnVuY3Rpb24gcyh0KXtyZXR1cm4gYy5odHRwUmVxdWVzdCh0LHt1cmw6dC5vcHRpb25zLnVybCsiL2FwaS92MS9zZXNzaW9ucy9tZSIsbWV0aG9kOiJERUxFVEUifSl9ZnVuY3Rpb24gbyh0KXtyZXR1cm4gYy5wb3N0KHQsIi9hcGkvdjEvc2Vzc2lvbnMvbWUvbGlmZWN5Y2xlL3JlZnJlc2giKX1mdW5jdGlvbiBhKHQsZSxpKXtpPWl8fHdpbmRvdy5sb2NhdGlvbi5ocmVmLHdpbmRvdy5sb2NhdGlvbj10Lm9wdGlvbnMudXJsKyIvbG9naW4vc2Vzc2lvbkNvb2tpZVJlZGlyZWN0IitsLnRvUXVlcnlQYXJhbXMoe2NoZWNrQWNjb3VudFNldHVwQ29tcGxldGU6ITAsdG9rZW46ZSxyZWRpcmVjdFVybDppfSl9dmFyIGw9aSgxMyksYz1pKDE1KTt0LmV4cG9ydHM9e3Nlc3Npb25FeGlzdHM6bixnZXRTZXNzaW9uOnIsY2xvc2VTZXNzaW9uOnMscmVmcmVzaFNlc3Npb246byxzZXRDb29raWVBbmRSZWRpcmVjdDphfX0sZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCl7dmFyIGUsaT10LnNwbGl0KCIuIik7dHJ5e2U9e2hlYWRlcjpKU09OLnBhcnNlKHcuYmFzZTY0VXJsVG9TdHJpbmcoaVswXSkpLHBheWxvYWQ6SlNPTi5wYXJzZSh3LmJhc2U2NFVybFRvU3RyaW5nKGlbMV0pKSxzaWduYXR1cmU6aVsyXX19Y2F0Y2gobil7dGhyb3cgbmV3IFMoIk1hbGZvcm1lZCB0b2tlbiIpfXJldHVybiBlfWZ1bmN0aW9uIHIodCxlLGkpe2Z1bmN0aW9uIG4odCl7dmFyIGU7aWYoZT1pLmV4cGlyYXRpb25UaW1lfHwwPT09aS5leHBpcmF0aW9uVGltZT9pLmV4cGlyYXRpb25UaW1lOk1hdGguZmxvb3IoRGF0ZS5ub3coKS8xZTMpLHQmJnQ+ZSlyZXR1cm4hMH1mdW5jdGlvbiByKHQpe2lmKCFpLmF1ZGllbmNlKXJldHVybiEwO2Zvcih2YXIgZT1BcnJheS5pc0FycmF5KGkuYXVkaWVuY2UpP2kuYXVkaWVuY2U6W2kuYXVkaWVuY2VdLG49QXJyYXkuaXNBcnJheSh0KT90Olt0XSxyPWUubGVuZ3RoO3ItLTspe3ZhciBzPWVbcl07aWYobi5pbmRleE9mKHMpIT09LTEpcmV0dXJuITB9fXJldHVybiBpPWl8fHt9LHQuZmVhdHVyZXMuaXNUb2tlblZlcmlmeVN1cHBvcnRlZCgpP00uZ2V0V2VsbEtub3duKHQpLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIGIuZ2V0KHQsZS5qd2tzX3VyaSl9KS50aGVuKGZ1bmN0aW9uKHQpe3ZhciBpPXQua2V5c1swXTtyZXR1cm4gVC52ZXJpZnlUb2tlbihlLGkpfSkudGhlbihmdW5jdGlvbihzKXtpZighcylyZXR1cm4hMTt2YXIgbz10LnRva2VuLmRlY29kZShlKTtyZXR1cm4hbihvLnBheWxvYWQuZXhwKSYmKCEhcihvLnBheWxvYWQuYXVkKSYmKCFpLmlzc3Vlcnx8aS5pc3N1ZXI9PT1vLnBheWxvYWQuaXNzKSl9KTprLnJlamVjdChuZXcgUygiVGhpcyBicm93c2VyIGRvZXNuJ3Qgc3VwcG9ydCBjcnlwdG8uc3VidGxlIikpfWZ1bmN0aW9uIHModCxlLGkscil7cmV0dXJuKG5ldyBrKS50aGVuKGZ1bmN0aW9uKCl7aWYoIWV8fCFlLmlkVG9rZW4pdGhyb3cgbmV3IFMoIk9ubHkgaWRUb2tlbnMgbWF5IGJlIHZlcmlmaWVkIik7dmFyIHM9bihlLmlkVG9rZW4pO3JldHVybiBNLnZhbGlkYXRlQ2xhaW1zKHQscy5wYXlsb2FkLGUuY2xpZW50SWQsZS5pc3N1ZXIsaSkscnx8IXQuZmVhdHVyZXMuaXNUb2tlblZlcmlmeVN1cHBvcnRlZCgpP2U6TS5nZXRLZXkodCxlLmlzc3VlcixzLmhlYWRlci5raWQpLnRoZW4oZnVuY3Rpb24odCl7cmV0dXJuIFQudmVyaWZ5VG9rZW4oZS5pZFRva2VuLHQpfSkudGhlbihmdW5jdGlvbih0KXtpZighdCl0aHJvdyBuZXcgUygiVGhlIHRva2VuIHNpZ25hdHVyZSBpcyBub3QgdmFsaWQiKTtyZXR1cm4gZX0pfSl9ZnVuY3Rpb24gbyh0LGUpe3JldHVybiBlPWV8fHt9LGUuZGlzcGxheT1udWxsLGUucHJvbXB0PSJub25lIixwKHQsZSl9ZnVuY3Rpb24gYSh0LGUsaSl7ZnVuY3Rpb24gbihlKXshZS5kYXRhfHxlLm9yaWdpbiE9PXQub3B0aW9ucy51cmx8fGUuZGF0YSYmdy5pc1N0cmluZyhpKSYmZS5kYXRhLnN0YXRlIT09aXx8ci5yZXNvbHZlKGUuZGF0YSl9dmFyIHI9ay5kZWZlcigpO3JldHVybiBNLmFkZExpc3RlbmVyKHdpbmRvdywibWVzc2FnZSIsbiksci5wcm9taXNlLnRpbWVvdXQoZXx8MTJlNCxuZXcgUygiT0F1dGggZmxvdyB0aW1lZCBvdXQiKSkuZmluKGZ1bmN0aW9uKCl7TS5yZW1vdmVMaXN0ZW5lcih3aW5kb3csIm1lc3NhZ2UiLG4pfSl9ZnVuY3Rpb24gbCh0LGUsaSl7ZnVuY3Rpb24gbigpe3RyeXtlJiZlLmxvY2F0aW9uJiZlLmxvY2F0aW9uLmhhc2g/ci5yZXNvbHZlKE0uaGFzaFRvT2JqZWN0KGUubG9jYXRpb24uaGFzaCkpOmUmJiFlLmNsb3NlZCYmc2V0VGltZW91dChuLDUwMCl9Y2F0Y2godCl7c2V0VGltZW91dChuLDUwMCl9fXZhciByPWsuZGVmZXIoKTtyZXR1cm4gbigpLHIucHJvbWlzZS50aW1lb3V0KGl8fDEyZTQsbmV3IFMoIk9BdXRoIGZsb3cgdGltZWQgb3V0IikpfWZ1bmN0aW9uIGModCxlLGksbil7bj1ufHx7fTt2YXIgcj1lLnJlc3BvbnNlVHlwZSxvPXcuY2xvbmUoZS5zY29wZXMpLGE9ZS5jbGllbnRJZHx8dC5vcHRpb25zLmNsaWVudElkO3JldHVybihuZXcgaykudGhlbihmdW5jdGlvbigpe2lmKGkuZXJyb3J8fGkuZXJyb3JfZGVzY3JpcHRpb24pdGhyb3cgbmV3IEwoaS5lcnJvcixpLmVycm9yX2Rlc2NyaXB0aW9uKTtpZihpLnN0YXRlIT09ZS5zdGF0ZSl0aHJvdyBuZXcgUygiT0F1dGggZmxvdyByZXNwb25zZSBzdGF0ZSBkb2Vzbid0IG1hdGNoIHJlcXVlc3Qgc3RhdGUiKTt2YXIgcj17fTtpZihpLmFjY2Vzc190b2tlbiYmKHIudG9rZW49e2FjY2Vzc1Rva2VuOmkuYWNjZXNzX3Rva2VuLGV4cGlyZXNBdDpOdW1iZXIoaS5leHBpcmVzX2luKStNYXRoLmZsb29yKERhdGUubm93KCkvMWUzKSx0b2tlblR5cGU6aS50b2tlbl90eXBlLHNjb3BlczpvLGF1dGhvcml6ZVVybDpuLmF1dGhvcml6ZVVybCx1c2VyaW5mb1VybDpuLnVzZXJpbmZvVXJsfSksaS5jb2RlJiYoci5jb2RlPXthdXRob3JpemF0aW9uQ29kZTppLmNvZGV9KSxpLmlkX3Rva2VuKXt2YXIgbD10LnRva2VuLmRlY29kZShpLmlkX3Rva2VuKSxjPXtpZFRva2VuOmkuaWRfdG9rZW4sY2xhaW1zOmwucGF5bG9hZCxleHBpcmVzQXQ6bC5wYXlsb2FkLmV4cCxzY29wZXM6byxhdXRob3JpemVVcmw6bi5hdXRob3JpemVVcmwsaXNzdWVyOm4uaXNzdWVyLGNsaWVudElkOmF9O3JldHVybiBzKHQsYyxlLm5vbmNlLCEwKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiByLmlkX3Rva2VuPWMscn0pfXJldHVybiByfSkudGhlbihmdW5jdGlvbih0KXtpZighQXJyYXkuaXNBcnJheShyKSlyZXR1cm4gdFtyXTtpZighdC50b2tlbiYmIXQuaWRfdG9rZW4pdGhyb3cgbmV3IFMoIlVuYWJsZSB0byBwYXJzZSBPQXV0aCBmbG93IHJlc3BvbnNlIik7cmV0dXJuIHIubWFwKGZ1bmN0aW9uKGUpe3JldHVybiB0W2VdfSl9KX1mdW5jdGlvbiB1KHQsZSl7ZT13LmNsb25lKGUpfHx7fSxlLnNjb3BlJiYody5kZXByZWNhdGUoJ1RoZSBwYXJhbSAic2NvcGUiIGlzIGVxdWl2YWxlbnQgdG8gInNjb3BlcyIuIFVzZSAic2NvcGVzIiBpbnN0ZWFkLicpLGUuc2NvcGVzPWUuc2NvcGUsZGVsZXRlIGUuc2NvcGUpO3ZhciBpPXtjbGllbnRJZDp0Lm9wdGlvbnMuY2xpZW50SWQscmVkaXJlY3RVcmk6dC5vcHRpb25zLnJlZGlyZWN0VXJpfHx3aW5kb3cubG9jYXRpb24uaHJlZixyZXNwb25zZVR5cGU6ImlkX3Rva2VuIixyZXNwb25zZU1vZGU6Im9rdGFfcG9zdF9tZXNzYWdlIixzdGF0ZTp3LmdlblJhbmRvbVN0cmluZyg2NCksbm9uY2U6dy5nZW5SYW5kb21TdHJpbmcoNjQpLHNjb3BlczpbIm9wZW5pZCIsImVtYWlsIl19O3JldHVybiB3LmV4dGVuZChpLGUpLGl9ZnVuY3Rpb24gZCh0KXtpZighdC5jbGllbnRJZCl0aHJvdyBuZXcgUygiQSBjbGllbnRJZCBtdXN0IGJlIHNwZWNpZmllZCBpbiB0aGUgT2t0YUF1dGggY29uc3RydWN0b3IgdG8gZ2V0IGEgdG9rZW4iKTtpZih3LmlzU3RyaW5nKHQucmVzcG9uc2VUeXBlKSYmdC5yZXNwb25zZVR5cGUuaW5kZXhPZigiICIpIT09LTEpdGhyb3cgbmV3IFMoIk11bHRpcGxlIE9BdXRoIHJlc3BvbnNlVHlwZXMgbXVzdCBiZSBkZWZpbmVkIGFzIGFuIGFycmF5Iik7dmFyIGU9dy5yZW1vdmVOaWxzKHtjbGllbnRfaWQ6dC5jbGllbnRJZCxyZWRpcmVjdF91cmk6dC5yZWRpcmVjdFVyaSxyZXNwb25zZV90eXBlOnQucmVzcG9uc2VUeXBlLHJlc3BvbnNlX21vZGU6dC5yZXNwb25zZU1vZGUsc3RhdGU6dC5zdGF0ZSxub25jZTp0Lm5vbmNlLHByb21wdDp0LnByb21wdCxkaXNwbGF5OnQuZGlzcGxheSxzZXNzaW9uVG9rZW46dC5zZXNzaW9uVG9rZW4saWRwOnQuaWRwLG1heF9hZ2U6dC5tYXhBZ2V9KTtpZihBcnJheS5pc0FycmF5KGUucmVzcG9uc2VfdHlwZSkmJihlLnJlc3BvbnNlX3R5cGU9ZS5yZXNwb25zZV90eXBlLmpvaW4oIiAiKSksdC5yZXNwb25zZVR5cGUuaW5kZXhPZigiaWRfdG9rZW4iKSE9PS0xJiZ0LnNjb3Blcy5pbmRleE9mKCJvcGVuaWQiKT09PS0xKXRocm93IG5ldyBTKCJvcGVuaWQgc2NvcGUgbXVzdCBiZSBzcGVjaWZpZWQgaW4gdGhlIHNjb3BlcyBhcmd1bWVudCB3aGVuIHJlcXVlc3RpbmcgYW4gaWRfdG9rZW4iKTtyZXR1cm4gZS5zY29wZT10LnNjb3Blcy5qb2luKCIgIiksZX1mdW5jdGlvbiBoKHQpe3ZhciBlPWQodCk7cmV0dXJuIHcudG9RdWVyeVBhcmFtcyhlKX1mdW5jdGlvbiBwKHQsZSxpKXtmdW5jdGlvbiBuKHQpe3ZhciBlPS9eKGh0dHBzP1w6XC9cLyk/KFteOlwvPyNdKig/Olw6WzAtOV0rKT8pLztyZXR1cm4gZS5leGVjKHQpWzBdfWZ1bmN0aW9uIHIodCl7dC5jbG9zZWQmJkUucmVqZWN0KG5ldyBTKCJVbmFibGUgdG8gcGFyc2UgT0F1dGggZmxvdyByZXNwb25zZSIpKX1lPWV8fHt9LGk9aXx8e307dmFyIHM9dSh0LGUpLG89e3Byb21wdDoibm9uZSIscmVzcG9uc2VNb2RlOiJva3RhX3Bvc3RfbWVzc2FnZSIsZGlzcGxheTpudWxsfSxkPXtkaXNwbGF5OiJwb3B1cCJ9O2Uuc2Vzc2lvblRva2VuP3cuZXh0ZW5kKHMsbyk6ZS5pZHAmJncuZXh0ZW5kKHMsZCk7dmFyIHAsZjt0cnl7Zj1NLmdldE9BdXRoVXJscyh0LHMsaSkscD1mLmF1dGhvcml6ZVVybCtoKHMpfWNhdGNoKG0pe3JldHVybiBrLnJlamVjdChtKX12YXIgXztzd2l0Y2goXz1zLnNlc3Npb25Ub2tlbnx8bnVsbD09PXMuZGlzcGxheT8iSUZSQU1FIjoicG9wdXAiPT09cy5kaXNwbGF5PyJQT1BVUCI6IklNUExJQ0lUIil7Y2FzZSJJRlJBTUUiOnZhciBnPWEodCxpLnRpbWVvdXQscy5zdGF0ZSksdj1NLmxvYWRGcmFtZShwKTtyZXR1cm4gZy50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiBjKHQscyxlLGYpfSkuZmluKGZ1bmN0aW9uKCl7ZG9jdW1lbnQuYm9keS5jb250YWlucyh2KSYmdi5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHYpfSk7Y2FzZSJQT1BVUCI6dmFyIHk7aWYoIm9rdGFfcG9zdF9tZXNzYWdlIj09PXMucmVzcG9uc2VNb2RlKXtpZighdC5mZWF0dXJlcy5pc1BvcHVwUG9zdE1lc3NhZ2VTdXBwb3J0ZWQoKSlyZXR1cm4gay5yZWplY3QobmV3IFMoIlRoaXMgYnJvd3NlciBkb2Vzbid0IGhhdmUgZnVsbCBwb3N0TWVzc2FnZSBzdXBwb3J0IikpO3k9YSh0LGkudGltZW91dCxzLnN0YXRlKX12YXIgYj17cG9wdXBUaXRsZTppLnBvcHVwVGl0bGV9LFQ9TS5sb2FkUG9wdXAocCxiKTtpZigiZnJhZ21lbnQiPT09cy5yZXNwb25zZU1vZGUpe3ZhciBMPW4odC5pZFRva2VuLmF1dGhvcml6ZS5fZ2V0TG9jYXRpb25IcmVmKCkpLHg9bihzLnJlZGlyZWN0VXJpKTtpZihMIT09eClyZXR1cm4gay5yZWplY3QobmV3IFMoIlVzaW5nIGZyYWdtZW50LCB0aGUgcmVkaXJlY3RVcmkgb3JpZ2luICgiK3grIikgbXVzdCBtYXRjaCB0aGUgb3JpZ2luIG9mIHRoaXMgcGFnZSAoIitMKyIpIikpO3k9bCh0LFQsaS50aW1lb3V0KX12YXIgRT1rLmRlZmVyKCksRD1zZXRJbnRlcnZhbChmdW5jdGlvbigpe3IoVCl9LDUwMCk7cmV0dXJuIHkudGhlbihmdW5jdGlvbih0KXtFLnJlc29sdmUodCl9KS5mYWlsKGZ1bmN0aW9uKHQpe0UucmVqZWN0KHQpfSksRS5wcm9taXNlLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIGModCxzLGUsZil9KS5maW4oZnVuY3Rpb24oKXtULmNsb3NlZHx8KGNsZWFySW50ZXJ2YWwoRCksVC5jbG9zZSgpKX0pO2RlZmF1bHQ6cmV0dXJuIGsucmVqZWN0KG5ldyBTKCJUaGUgZnVsbCBwYWdlIHJlZGlyZWN0IGZsb3cgaXMgbm90IHN1cHBvcnRlZCIpKX19ZnVuY3Rpb24gZih0LGUsaSl7dmFyIG49dy5jbG9uZShlKXx8e307cmV0dXJuIHcuZXh0ZW5kKG4se3Byb21wdDoibm9uZSIscmVzcG9uc2VNb2RlOiJva3RhX3Bvc3RfbWVzc2FnZSIsZGlzcGxheTpudWxsfSkscCh0LG4saSl9ZnVuY3Rpb24gbSh0LGUsaSl7dmFyIG49dy5jbG9uZShlKXx8e307cmV0dXJuIHcuZXh0ZW5kKG4se2Rpc3BsYXk6InBvcHVwIn0pLHAodCxuLGkpfWZ1bmN0aW9uIF8odCxlLGkpe2U9dy5jbG9uZShlKXx8e307dmFyIG49dSh0LGUpO2lmKCFlLnJlc3BvbnNlTW9kZSl7dmFyIHI9bi5yZXNwb25zZVR5cGU7ci5pbmRleE9mKCJjb2RlIikhPT0tMSYmKHcuaXNTdHJpbmcocil8fEFycmF5LmlzQXJyYXkocikmJjE9PT1yLmxlbmd0aCk/dy5leHRlbmQobix7cmVzcG9uc2VNb2RlOiJxdWVyeSJ9KTp3LmV4dGVuZChuLHtyZXNwb25zZU1vZGU6ImZyYWdtZW50In0pfXZhciBzPU0uZ2V0T0F1dGhVcmxzKHQsbixpKSxvPXMuYXV0aG9yaXplVXJsK2gobik7RS5zZXRDb29raWUoeC5SRURJUkVDVF9PQVVUSF9QQVJBTVNfQ09PS0lFX05BTUUsSlNPTi5zdHJpbmdpZnkoe3Jlc3BvbnNlVHlwZTpuLnJlc3BvbnNlVHlwZSxzdGF0ZTpuLnN0YXRlLG5vbmNlOm4ubm9uY2Usc2NvcGVzOm4uc2NvcGVzLHVybHM6c30pKSxFLnNldENvb2tpZSh4LlJFRElSRUNUX05PTkNFX0NPT0tJRV9OQU1FLG4ubm9uY2UpLEUuc2V0Q29va2llKHguUkVESVJFQ1RfU1RBVEVfQ09PS0lFX05BTUUsbi5zdGF0ZSksdC50b2tlbi5nZXRXaXRoUmVkaXJlY3QuX3NldExvY2F0aW9uKG8pfWZ1bmN0aW9uIGcodCxlKXtpZighTS5pc1Rva2VuKGUpKXJldHVybiBrLnJlamVjdChuZXcgUygiUmVmcmVzaCBtdXN0IGJlIHBhc3NlZCBhIHRva2VuIHdpdGggYW4gYXJyYXkgb2Ygc2NvcGVzIGFuZCBhbiBhY2Nlc3NUb2tlbiBvciBpZFRva2VuIikpO3ZhciBpO3JldHVybiBpPWUuYWNjZXNzVG9rZW4/InRva2VuIjoiaWRfdG9rZW4iLHQudG9rZW4uZ2V0V2l0aG91dFByb21wdCh7cmVzcG9uc2VUeXBlOmksc2NvcGVzOmUuc2NvcGVzfSx7YXV0aG9yaXplVXJsOmUuYXV0aG9yaXplVXJsLHVzZXJpbmZvVXJsOmUudXNlcmluZm9VcmwsaXNzdWVyOmUuaXNzdWVyfSl9ZnVuY3Rpb24gdih0LGUpe3ZhciBpPXQudG9rZW4ucGFyc2VGcm9tVXJsLl9nZXRMb2NhdGlvbkhhc2goKTtlJiYoaT1lLnN1YnN0cmluZyhlLmluZGV4T2YoIiMiKSkpO3ZhciBuPUUuZ2V0Q29va2llKHguUkVESVJFQ1RfT0FVVEhfUEFSQU1TX0NPT0tJRV9OQU1FKTtpZighaXx8IW4pcmV0dXJuIGsucmVqZWN0KG5ldyBTKCJVbmFibGUgdG8gcGFyc2UgYSB0b2tlbiBmcm9tIHRoZSB1cmwiKSk7dHJ5e3ZhciByPUpTT04ucGFyc2Uobikscz1yLnVybHM7ZGVsZXRlIHIudXJscyxFLmRlbGV0ZUNvb2tpZSh4LlJFRElSRUNUX09BVVRIX1BBUkFNU19DT09LSUVfTkFNRSl9Y2F0Y2gobyl7cmV0dXJuIGsucmVqZWN0KG5ldyBTKCJVbmFibGUgdG8gcGFyc2UgdGhlICIreC5SRURJUkVDVF9PQVVUSF9QQVJBTVNfQ09PS0lFX05BTUUrIiBjb29raWU6ICIrby5tZXNzYWdlKSl9cmV0dXJuIGsucmVzb2x2ZShNLmhhc2hUb09iamVjdChpKSkudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gYyh0LHIsZSxzKX0pfWZ1bmN0aW9uIHkodCxlKXtyZXR1cm4gZSYmKE0uaXNUb2tlbihlKXx8ZS5hY2Nlc3NUb2tlbnx8ZS51c2VyaW5mb1VybCk/Yi5odHRwUmVxdWVzdCh0LHt1cmw6ZS51c2VyaW5mb1VybCxtZXRob2Q6IkdFVCIsYWNjZXNzVG9rZW46ZS5hY2Nlc3NUb2tlbn0pLmZhaWwoZnVuY3Rpb24odCl7aWYodC54aHImJig0MDE9PT10Lnhoci5zdGF0dXN8fDQwMz09PXQueGhyLnN0YXR1cykpe3ZhciBlPXQueGhyLmdldFJlc3BvbnNlSGVhZGVyKCJXV1ctQXV0aGVudGljYXRlIik7aWYoZSl7dmFyIGk9ZS5tYXRjaCgvZXJyb3I9IiguKj8pIi8pfHxbXSxuPWUubWF0Y2goL2Vycm9yX2Rlc2NyaXB0aW9uPSIoLio/KSIvKXx8W10scj1pWzFdLHM9blsxXTtyJiZzJiYodD1uZXcgTChyLHMpKX19dGhyb3cgdH0pOmsucmVqZWN0KG5ldyBTKCJnZXRVc2VySW5mbyByZXF1aXJlcyBhbiBhY2Nlc3MgdG9rZW4gb2JqZWN0IikpfXZhciBiPWkoMTUpLHc9aSgxMyksTT1pKDI2KSxrPWkoMjEpLFQ9aSgyNyksUz1pKDE5KSxMPWkoMjgpLHg9aSgyMCksRT1pKDE2KTt0LmV4cG9ydHM9e2dldFRva2VuOnAsZ2V0V2l0aG91dFByb21wdDpmLGdldFdpdGhQb3B1cDptLGdldFdpdGhSZWRpcmVjdDpfLHBhcnNlRnJvbVVybDp2LHJlZnJlc2hJZFRva2VuOm8sZGVjb2RlVG9rZW46bix2ZXJpZnlJZFRva2VuOnIscmVmcmVzaFRva2VuOmcsZ2V0VXNlckluZm86eSx2ZXJpZnlUb2tlbjpzfX0sZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCl7cmV0dXJuISghdHx8IXQuYWNjZXNzVG9rZW4mJiF0LmlkVG9rZW58fCFBcnJheS5pc0FycmF5KHQuc2NvcGVzKSl9ZnVuY3Rpb24gcih0LGUsaSl7dC5hZGRFdmVudExpc3RlbmVyP3QuYWRkRXZlbnRMaXN0ZW5lcihlLGkpOnQuYXR0YWNoRXZlbnQoIm9uIitlLGkpfWZ1bmN0aW9uIHModCxlLGkpe3QucmVtb3ZlRXZlbnRMaXN0ZW5lcj90LnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxpKTp0LmRldGFjaEV2ZW50KCJvbiIrZSxpKX1mdW5jdGlvbiBvKHQpe3ZhciBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlmcmFtZSIpO3JldHVybiBlLnN0eWxlLmRpc3BsYXk9Im5vbmUiLGUuc3JjPXQsZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlKX1mdW5jdGlvbiBhKHQsZSl7dmFyIGk9ZS5wb3B1cFRpdGxlfHwiRXh0ZXJuYWwgSWRlbnRpdHkgUHJvdmlkZXIgVXNlciBBdXRoZW50aWNhdGlvbiIsbj0idG9vbGJhcj1ubywgc2Nyb2xsYmFycz15ZXMsIHJlc2l6YWJsZT15ZXMsIHRvcD0xMDAsIGxlZnQ9NTAwLCB3aWR0aD02MDAsIGhlaWdodD02MDAiO3JldHVybiB3aW5kb3cub3Blbih0LGksbil9ZnVuY3Rpb24gbCh0LGUpe3JldHVybiBwLmdldCh0LChlfHx0Lm9wdGlvbnMudXJsKSsiLy53ZWxsLWtub3duL29wZW5pZC1jb25maWd1cmF0aW9uIix7Y2FjaGVSZXNwb25zZTohMH0pfWZ1bmN0aW9uIGModCxlLGkpe3JldHVybiBsKHQsZSkudGhlbihmdW5jdGlvbihlKXt2YXIgbj1lLmp3a3NfdXJpLHI9Zy5nZXRTdG9yYWdlKCkscz1yW25dO2lmKHMmJkRhdGUubm93KCkvMWUzPHMuZXhwaXJlc0F0KXt2YXIgbz1mLmZpbmQocy5yZXNwb25zZS5rZXlzLHtraWQ6aX0pO2lmKG8pcmV0dXJuIG99cmV0dXJuIGcuY2xlYXJTdG9yYWdlKG4pLHAuZ2V0KHQsbix7Y2FjaGVSZXNwb25zZTohMH0pLnRoZW4oZnVuY3Rpb24odCl7dmFyIGU9Zi5maW5kKHQua2V5cyx7a2lkOml9KTtpZihlKXJldHVybiBlO3Rocm93IG5ldyBfKCJUaGUga2V5IGlkLCAiK2krIiwgd2FzIG5vdCBmb3VuZCBpbiB0aGUgc2VydmVyJ3Mga2V5cyIpfSl9KX1mdW5jdGlvbiB1KHQsZSxpLG4scil7aWYoIWV8fCFufHwhaSl0aHJvdyBuZXcgXygiVGhlIGp3dCwgaXNzLCBhbmQgYXVkIGFyZ3VtZW50cyBhcmUgYWxsIHJlcXVpcmVkIik7aWYociYmZS5ub25jZSE9PXIpdGhyb3cgbmV3IF8oIk9BdXRoIGZsb3cgcmVzcG9uc2Ugbm9uY2UgZG9lc24ndCBtYXRjaCByZXF1ZXN0IG5vbmNlIik7dmFyIHM9TWF0aC5mbG9vcigobmV3IERhdGUpLmdldFRpbWUoKS8xZTMpO2lmKGUuaXNzIT09bil0aHJvdyBuZXcgXygiVGhlIGlzc3VlciBbIitlLmlzcysiXSBkb2VzIG5vdCBtYXRjaCBbIituKyJdIik7aWYoZS5hdWQhPT1pKXRocm93IG5ldyBfKCJUaGUgYXVkaWVuY2UgWyIrZS5hdWQrIl0gZG9lcyBub3QgbWF0Y2ggWyIraSsiXSIpO2lmKGUuaWF0PmUuZXhwKXRocm93IG5ldyBfKCJUaGUgSldUIGV4cGlyZWQgYmVmb3JlIGl0IHdhcyBpc3N1ZWQiKTtpZihzLXQub3B0aW9ucy5tYXhDbG9ja1NrZXc+ZS5leHApdGhyb3cgbmV3IF8oIlRoZSBKV1QgZXhwaXJlZCBhbmQgaXMgbm8gbG9uZ2VyIHZhbGlkIik7aWYoZS5pYXQ+cyt0Lm9wdGlvbnMubWF4Q2xvY2tTa2V3KXRocm93IG5ldyBfKCJUaGUgSldUIHdhcyBpc3N1ZWQgaW4gdGhlIGZ1dHVyZSIpfWZ1bmN0aW9uIGQodCxlLGkpe2k9aXx8e307dmFyIG49Zi5yZW1vdmVUcmFpbGluZ1NsYXNoKGkuYXV0aG9yaXplVXJsKXx8dC5vcHRpb25zLmF1dGhvcml6ZVVybCxyPWYucmVtb3ZlVHJhaWxpbmdTbGFzaChpLmlzc3Vlcil8fHQub3B0aW9ucy5pc3N1ZXIscz1mLnJlbW92ZVRyYWlsaW5nU2xhc2goaS51c2VyaW5mb1VybCl8fHQub3B0aW9ucy51c2VyaW5mb1VybDtpZihyJiYhL15odHRwcz86Ly50ZXN0KHIpJiYocj10Lm9wdGlvbnMudXJsKyIvb2F1dGgyLyIrciksIXImJm4mJmUucmVzcG9uc2VUeXBlLmluZGV4T2YoImlkX3Rva2VuIikhPT0tMSl0aHJvdyBuZXcgXygiQ2Fubm90IHJlcXVlc3QgaWRUb2tlbiB3aXRoIGFuIGF1dGhvcml6ZVVybCB3aXRob3V0IGFuIGlzc3VlciIpO2lmKCFyJiZlLnJlc3BvbnNlVHlwZS5pbmRleE9mKCJ0b2tlbiIpIT09LTEpe2lmKG4mJiFzKXRocm93IG5ldyBfKCJDYW5ub3QgcmVxdWVzdCBhY2Nlc3NUb2tlbiB3aXRoIGFuIGF1dGhvcml6ZVVybCB3aXRob3V0IGFuIGlzc3VlciBvciB1c2VyaW5mb1VybCIpO2lmKHMmJiFuKXRocm93IG5ldyBfKCJDYW5ub3QgcmVxdWVzdCB0b2tlbiB3aXRoIGFuIHVzZXJpbmZvVXJsIHdpdGhvdXQgYW4gaXNzdWVyIG9yIGF1dGhvcml6ZVVybCIpfXZhciBvPW5ldyBSZWdFeHAoIl5odHRwcz86Ly8uKj8vb2F1dGgyLy4rIik7cmV0dXJuIHI9cnx8dC5vcHRpb25zLnVybCxvLnRlc3Qocik/KG49bnx8cisiL3YxL2F1dGhvcml6ZSIscz1zfHxyKyIvdjEvdXNlcmluZm8iKToobj1ufHxyKyIvb2F1dGgyL3YxL2F1dGhvcml6ZSIscz1zfHxyKyIvb2F1dGgyL3YxL3VzZXJpbmZvIikse2lzc3VlcjpyLGF1dGhvcml6ZVVybDpuLHVzZXJpbmZvVXJsOnN9fWZ1bmN0aW9uIGgodCl7Zm9yKHZhciBlLGk9L1wrL2csbj0vKFteJj1dKyk9PyhbXiZdKikvZyxyPXQuc3Vic3RyaW5nKDEpLHM9e307Oyl7aWYoZT1uLmV4ZWMociksIWUpYnJlYWs7dmFyIG89ZVsxXSxhPWVbMl07ImlkX3Rva2VuIj09PW98fCJhY2Nlc3NfdG9rZW4iPT09b3x8ImNvZGUiPT09bz9zW29dPWE6c1tvXT1kZWNvZGVVUklDb21wb25lbnQoYS5yZXBsYWNlKGksIiAiKSl9cmV0dXJuIHN9dmFyIHA9aSgxNSksZj1pKDEzKSxtPWkoMTcpLF89aSgxOSksZz1tLmdldEh0dHBDYWNoZSgpO3QuZXhwb3J0cz17Z2V0V2VsbEtub3duOmwsZ2V0S2V5OmMsdmFsaWRhdGVDbGFpbXM6dSxnZXRPQXV0aFVybHM6ZCxsb2FkRnJhbWU6byxsb2FkUG9wdXA6YSxoYXNoVG9PYmplY3Q6aCxpc1Rva2VuOm4sYWRkTGlzdGVuZXI6cixyZW1vdmVMaXN0ZW5lcjpzfX0sZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCxlKXtlPXIuY2xvbmUoZSk7dmFyIGk9Imp3ayIsbj17bmFtZToiUlNBU1NBLVBLQ1MxLXYxXzUiLGhhc2g6e25hbWU6IlNIQS0yNTYifX0scz0hMCxvPVsidmVyaWZ5Il07cmV0dXJuIGRlbGV0ZSBlLnVzZSxjcnlwdG8uc3VidGxlLmltcG9ydEtleShpLGUsbixzLG8pLnRoZW4oZnVuY3Rpb24oZSl7dmFyIGk9dC5zcGxpdCgiLiIpLHM9ci5zdHJpbmdUb0J1ZmZlcihpWzBdKyIuIitpWzFdKSxvPXIuYmFzZTY0VXJsRGVjb2RlKGlbMl0pLGE9ci5zdHJpbmdUb0J1ZmZlcihvKTtyZXR1cm4gY3J5cHRvLnN1YnRsZS52ZXJpZnkobixlLGEscyl9KX12YXIgcj1pKDEzKTt0LmV4cG9ydHM9e3ZlcmlmeVRva2VuOm59fSxmdW5jdGlvbih0LGUpe2Z1bmN0aW9uIGkodCxlKXt0aGlzLm5hbWU9Ik9BdXRoRXJyb3IiLHRoaXMubWVzc2FnZT1lLHRoaXMuZXJyb3JDb2RlPXQsdGhpcy5lcnJvclN1bW1hcnk9ZX1pLnByb3RvdHlwZT1uZXcgRXJyb3IsdC5leHBvcnRzPWl9LGZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKHQsZSxpKXt0LmVtaXR0ZXIuZW1pdCgiZXhwaXJlZCIsZSxpKX1mdW5jdGlvbiByKHQsZSl7Y2xlYXJUaW1lb3V0KHQucmVmcmVzaFRpbWVvdXRzW2VdKSxkZWxldGUgdC5yZWZyZXNoVGltZW91dHNbZV19ZnVuY3Rpb24gcyh0KXt2YXIgZT10LnJlZnJlc2hUaW1lb3V0cztmb3IodmFyIGkgaW4gZSllLmhhc093blByb3BlcnR5KGkpJiZyKHQsaSk7dC5yZWZyZXNoVGltZW91dHM9e319ZnVuY3Rpb24gbyh0LGUsaSxzLG8pe3ZhciBhPTFlMypvLmV4cGlyZXNBdC1EYXRlLm5vdygpO2E8MCYmKGE9MCk7dmFyIGw9c2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiBlLmF1dG9SZWZyZXNoP2QodCxlLGkscyk6dm9pZCgxZTMqby5leHBpcmVzQXQ8PURhdGUubm93KCkmJih1KGUsaSxzKSxuKGUscyxvKSkpfSxhKTtyKGUscyksZS5yZWZyZXNoVGltZW91dHNbc109bH1mdW5jdGlvbiBhKHQsZSxpKXt0cnl7dmFyIG49aS5nZXRTdG9yYWdlKCl9Y2F0Y2gocil7cmV0dXJuIHZvaWQgZS5lbWl0dGVyLmVtaXQoImVycm9yIixyKX1mb3IodmFyIHMgaW4gbilpZihuLmhhc093blByb3BlcnR5KHMpKXt2YXIgYT1uW3NdO28odCxlLGkscyxhKX19ZnVuY3Rpb24gbCh0LGUsaSxuLHIpe3ZhciBzPWkuZ2V0U3RvcmFnZSgpO2lmKCFmLmlzT2JqZWN0KHIpfHwhci5zY29wZXN8fCFyLmV4cGlyZXNBdCYmMCE9PXIuZXhwaXJlc0F0fHwhci5pZFRva2VuJiYhci5hY2Nlc3NUb2tlbil0aHJvdyBuZXcgbSgiVG9rZW4gbXVzdCBiZSBhbiBPYmplY3Qgd2l0aCBzY29wZXMsIGV4cGlyZXNBdCwgYW5kIGFuIGlkVG9rZW4gb3IgYWNjZXNzVG9rZW4gcHJvcGVydGllcyIpO3Nbbl09cixpLnNldFN0b3JhZ2Uocyksbyh0LGUsaSxuLHIpfWZ1bmN0aW9uIGModCxlKXt2YXIgaT10LmdldFN0b3JhZ2UoKTtyZXR1cm4gaVtlXX1mdW5jdGlvbiB1KHQsZSxpKXtyKHQsaSk7dmFyIG49ZS5nZXRTdG9yYWdlKCk7ZGVsZXRlIG5baV0sZS5zZXRTdG9yYWdlKG4pfWZ1bmN0aW9uIGQodCxlLGkscyl7dHJ5e3ZhciBvPWMoaSxzKTtpZighbyl0aHJvdyBuZXcgbSgiVGhlIHRva2VuTWFuYWdlciBoYXMgbm8gdG9rZW4gZm9yIHRoZSBrZXk6ICIrcyl9Y2F0Y2goYSl7cmV0dXJuIGcucmVqZWN0KGEpfXJldHVybiByKGUscyksdC50b2tlbi5yZWZyZXNoKG8pLnRoZW4oZnVuY3Rpb24obil7cmV0dXJuIGwodCxlLGkscyxuKSxlLmVtaXR0ZXIuZW1pdCgicmVmcmVzaGVkIixzLG4sbyksbn0pLmZhaWwoZnVuY3Rpb24odCl7dGhyb3ciT0F1dGhFcnJvciI9PT10Lm5hbWUmJih1KGUsaSxzKSxuKGUscyxvKSksdH0pfWZ1bmN0aW9uIGgodCxlKXtzKHQpLGUuY2xlYXJTdG9yYWdlKCl9ZnVuY3Rpb24gcCh0LGUpe2U9ZXx8e30sZS5zdG9yYWdlPWUuc3RvcmFnZXx8ImxvY2FsU3RvcmFnZSIsZS5hdXRvUmVmcmVzaHx8ZS5hdXRvUmVmcmVzaD09PSExfHwoZS5hdXRvUmVmcmVzaD0hMCksImxvY2FsU3RvcmFnZSIhPT1lLnN0b3JhZ2V8fF8uYnJvd3Nlckhhc0xvY2FsU3RvcmFnZSgpfHwoZi53YXJuKCJUaGlzIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IGxvY2FsU3RvcmFnZS4gU3dpdGNoaW5nIHRvIHNlc3Npb25TdG9yYWdlLiIpLGUuc3RvcmFnZT0ic2Vzc2lvblN0b3JhZ2UiKSwic2Vzc2lvblN0b3JhZ2UiIT09ZS5zdG9yYWdlfHxfLmJyb3dzZXJIYXNTZXNzaW9uU3RvcmFnZSgpfHwoZi53YXJuKCJUaGlzIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IHNlc3Npb25TdG9yYWdlLiBTd2l0Y2hpbmcgdG8gY29va2llLWJhc2VkIHN0b3JhZ2UuIiksZS5zdG9yYWdlPSJjb29raWUiKTt2YXIgaTtzd2l0Y2goZS5zdG9yYWdlKXtjYXNlImxvY2FsU3RvcmFnZSI6aT1iKGxvY2FsU3RvcmFnZSx5LlRPS0VOX1NUT1JBR0VfTkFNRSk7YnJlYWs7Y2FzZSJzZXNzaW9uU3RvcmFnZSI6aT1iKHNlc3Npb25TdG9yYWdlLHkuVE9LRU5fU1RPUkFHRV9OQU1FKTticmVhaztjYXNlImNvb2tpZSI6aT1iKF8uZ2V0Q29va2llU3RvcmFnZSgpLHkuVE9LRU5fU1RPUkFHRV9OQU1FKTticmVhaztkZWZhdWx0OnRocm93IG5ldyBtKCJVbnJlY29nbml6ZWQgc3RvcmFnZSBvcHRpb24iKX12YXIgbj17ZW1pdHRlcjpuZXcgdixhdXRvUmVmcmVzaDplLmF1dG9SZWZyZXNoLHJlZnJlc2hUaW1lb3V0czp7fX07dGhpcy5hZGQ9Zi5iaW5kKGwsdGhpcyx0LG4saSksdGhpcy5nZXQ9Zi5iaW5kKGMsdGhpcyxpKSx0aGlzLnJlbW92ZT1mLmJpbmQodSx0aGlzLG4saSksdGhpcy5jbGVhcj1mLmJpbmQoaCx0aGlzLG4saSksdGhpcy5yZWZyZXNoPWYuYmluZChkLHRoaXMsdCxuLGkpLHRoaXMub249Zi5iaW5kKG4uZW1pdHRlci5vbixuLmVtaXR0ZXIpLHRoaXMub2ZmPWYuYmluZChuLmVtaXR0ZXIub2ZmLG4uZW1pdHRlciksYSh0LG4saSl9dmFyIGY9aSgxMyksbT1pKDE5KSxfPWkoMTcpLGc9aSgyMSksdj1pKDMwKSx5PWkoMjApLGI9aSgxOCk7dC5leHBvcnRzPXB9LGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSgpe31pLnByb3RvdHlwZT17b246ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXRoaXMuZXx8KHRoaXMuZT17fSk7cmV0dXJuKG5bdF18fChuW3RdPVtdKSkucHVzaCh7Zm46ZSxjdHg6aX0pLHRoaXN9LG9uY2U6ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4oKXtyLm9mZih0LG4pLGUuYXBwbHkoaSxhcmd1bWVudHMpfXZhciByPXRoaXM7cmV0dXJuIG4uXz1lLHRoaXMub24odCxuLGkpfSxlbWl0OmZ1bmN0aW9uKHQpe3ZhciBlPVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLGk9KCh0aGlzLmV8fCh0aGlzLmU9e30pKVt0XXx8W10pLnNsaWNlKCksbj0wLHI9aS5sZW5ndGg7Zm9yKG47bjxyO24rKylpW25dLmZuLmFwcGx5KGlbbl0uY3R4LGUpO3JldHVybiB0aGlzfSxvZmY6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmV8fCh0aGlzLmU9e30pLG49aVt0XSxyPVtdO2lmKG4mJmUpZm9yKHZhciBzPTAsbz1uLmxlbmd0aDtzPG87cysrKW5bc10uZm4hPT1lJiZuW3NdLmZuLl8hPT1lJiZyLnB1c2gobltzXSk7cmV0dXJuIHIubGVuZ3RoP2lbdF09cjpkZWxldGUgaVt0XSx0aGlzfX0sdC5leHBvcnRzPWl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpXSxyPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUodCl7Zm9yKHZhciBlPVt0XSxpPXQuc3BsaXQoIi0iKTtpLnBvcCgpJiZpLmxlbmd0aD4wOyllLnB1c2goaS5qb2luKCItIikpO3JldHVybiBlfXZhciBpPXt9LG49dC5fO3JldHVybiBpLmhhc1Rva2Vuc0luSGFzaD1mdW5jdGlvbih0KXtyZXR1cm4vKChpZHxhY2Nlc3MpX3Rva2VuPSkvaS50ZXN0KHQpfSxpLnRyYW5zZm9ybUVycm9yWEhSPWZ1bmN0aW9uKGUpe2lmKDA9PT1lLnN0YXR1cyYmbi5pc0VtcHR5KGUucmVzcG9uc2VKU09OKSlyZXR1cm4gZS5yZXNwb25zZUpTT049e2Vycm9yU3VtbWFyeTp0LmxvYygiZXJyb3IubmV0d29yay5jb25uZWN0aW9uIiwibG9naW4iKX0sZTtpZighZS5yZXNwb25zZUpTT04pdHJ5e2UucmVzcG9uc2VKU09OPUpTT04ucGFyc2UoZS5yZXNwb25zZVRleHQpfWNhdGNoKGkpe3JldHVybiBlLnJlc3BvbnNlSlNPTj17ZXJyb3JTdW1tYXJ5OnQubG9jKCJvZm9ybS5lcnJvci51bmV4cGVjdGVkIiwibG9naW4iKX0sZX1pZihlLnJlc3BvbnNlSlNPTiYmZS5yZXNwb25zZUpTT04uZXJyb3JDYXVzZXMmJmUucmVzcG9uc2VKU09OLmVycm9yQ2F1c2VzLmxlbmd0aCYmKGUucmVzcG9uc2VKU09OLmVycm9yU3VtbWFyeT1lLnJlc3BvbnNlSlNPTi5lcnJvckNhdXNlc1swXS5lcnJvclN1bW1hcnkpLCFuLmlzRW1wdHkoZS5yZXNwb25zZUpTT04pKXt2YXIgcj10LmxvYygiZXJyb3JzLiIrZS5yZXNwb25zZUpTT04uZXJyb3JDb2RlLCJsb2dpbiIpO3IuaW5kZXhPZigiTDEwTl9FUlJPUlsiKT09PS0xJiYoZS5yZXNwb25zZUpTT04uZXJyb3JTdW1tYXJ5PXIpOwoJfXJldHVybiBlfSxpLnRvTG93ZXI9ZnVuY3Rpb24odCl7cmV0dXJuIG4ubWFwKHQsZnVuY3Rpb24odCl7cmV0dXJuIHQudG9Mb3dlckNhc2UoKX0pfSxpLmV4cGFuZExhbmd1YWdlcz1mdW5jdGlvbih0KXtyZXR1cm4gbi5jaGFpbih0KS5tYXAoZSkuZmxhdHRlbigpLnVuaXEoKS52YWx1ZSgpfSxpLmNhbGxBZnRlclRpbWVvdXQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gc2V0VGltZW91dCh0LGUpfSxpfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNSksaSgyKSxpKDQpLGkoMzYpLGkoMTM2KSxpKDEzOCksaSgzMyksaSgxMzkpLGkoMTQwKSxpKDE0MyksaSgxOTEpLGkoMTM5KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvLGEsbCxjLHUpe3ZhciBkPWwsaD1jLHA9dTtyZXR1cm57JDp0LF86ZSxtb21lbnQ6bixIYW5kbGViYXJzOmksbG9jOmguU3RyaW5nVXRpbC5sb2NhbGl6ZSxjcmVhdGVCdXR0b246aC5CdXR0b25GYWN0b3J5LmNyZWF0ZSxjcmVhdGVDYWxsb3V0OnAuY29tcG9uZW50cy5DYWxsb3V0LmNyZWF0ZSx0cGw6aC5UZW1wbGF0ZVV0aWwudHBsLE1vZGVsOnIsQmFzZU1vZGVsOnMsQ29sbGVjdGlvbjpvLFZpZXc6cC5CYXNlVmlldyxMaXN0VmlldzpwLkxpc3RWaWV3LFRhYmxlVmlldzpwLlRhYmxlVmlldyxSb3V0ZXI6aC5CYXNlUm91dGVyLFRhYmJlZFJvdXRlcjpoLlRhYmJlZFJvdXRlcixDb250cm9sbGVyOmguQmFzZUNvbnRyb2xsZXIsRGF0YUxpc3RDb250cm9sbGVyOmguRGF0YUxpc3RDb250cm9sbGVyLERhdGFMaXN0OnAuZGF0YWxpc3QuRGVhZFNpbXBsZURhdGFMaXN0LE1vZGFsRGlhbG9nOnAuY29tcG9uZW50cy5CYXNlTW9kYWxEaWFsb2csTXVsdGlWaWV3TW9kYWxEaWFsb2c6cC5jb21wb25lbnRzLk11bHRpVmlld01vZGFsRGlhbG9nLEZvcm06cC5mb3Jtcy5CYXNlRm9ybSxGb3JtRGlhbG9nOnAuY29tcG9uZW50cy5CYXNlRm9ybURpYWxvZyxEcm9wRG93bjpwLmNvbXBvbmVudHMuRHJvcERvd24sV2l6YXJkOmEsTG9nZ2VyOmguTG9nZ2VyLE1ldHJpY3M6aC5NZXRyaWNzLGludGVybmFsOntmcmFtZXdvcms6ZCx1dGlsOmgsdmlld3M6cH19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgzNCldLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5leHRlbmQoe3NlY3VyZUpTT046ITEsY29uc3RydWN0b3I6ZnVuY3Rpb24oKXt0LnJlc3VsdCh0aGlzLCJzZWN1cmVKU09OIikmJih0aGlzLnN5bmM9dC53cmFwKHRoaXMuc3luYyxmdW5jdGlvbihlLGksbixyKXtyZXR1cm4gZS5jYWxsKHRoaXMsaSxuLHQuZXh0ZW5kKHtkYXRhVHlwZToic2VjdXJlSlNPTiJ9LHIpKX0pKSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scixzOyFmdW5jdGlvbihvLGEpe3I9W2koMiksaSgzNSldLG49YSxzPSJmdW5jdGlvbiI9PXR5cGVvZiBuP24uYXBwbHkoZSxyKTpuLCEodm9pZCAwIT09cyYmKHQuZXhwb3J0cz1zKSl9KHRoaXMsZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKHQsZSl7dHJ5e3ZhciBpPXMoZS5nZXRSZXNwb25zZUhlYWRlcigibGluayIpKTt0W29dLnNldCh1LCEwKSx0LnNldFBhZ2luYXRpb24oaS5uZXh0LmhyZWYpfWNhdGNoKG4pe3Rbb10uZ2V0KHUpJiZ0LnNldFBhZ2luYXRpb24obnVsbCl9fWZ1bmN0aW9uIG4odCl7Zm9yKHZhciBlPXt9LGk9dCYmdC5zcGxpdCgiPyIpWzFdLG49aSYmZGVjb2RlVVJJQ29tcG9uZW50KGkuc3BsaXQoIiMiKVswXSkucmVwbGFjZSgvXCsvZywiICIpLHI9bj9uLnNwbGl0KCImIik6W10scz0wO3M8ci5sZW5ndGg7cysrKXt2YXIgbz1yW3NdLnNwbGl0KCI9Iik7ZVtvLnNoaWZ0KCldPW8uam9pbigiPSIpfXJldHVybiBlfWZ1bmN0aW9uIHIodCl7cmV0dXJuJyInPT10LmNoYXJBdCgwKSYmJyInPT10LmNoYXJBdCh0Lmxlbmd0aC0xKT90LnN1YnN0cmluZygxLHQubGVuZ3RoLTEpOnR9ZnVuY3Rpb24gcyh0KXtmb3IodmFyIGU9LzxbXj5dKj5ccyooXHMqO1xzKlteXChcKTw+QCw7OiJcL1xbXF1cPz17fSBcdF0rPSgoW15cKFwpPD5ALDs6IlwvXFtcXVw/PXt9IFx0XSspfCgiW14iXSoiKSkpKigsfCQpL2csaT0vW15cKFwpPD5ALDs6IlwvXFtcXVw/PXt9IFx0XSs9KChbXlwoXCk8PkAsOzoiXC9cW1xdXD89e30gXHRdKyl8KCJbXiJdKiIpKS9nLG49dC5tYXRjaChlKSxzPXt9LG89MDtvPG4ubGVuZ3RoO28rKyl7dmFyIGE9bltvXS5zcGxpdCgiPiIpLGw9YVswXS5zdWJzdHJpbmcoMSksYz17fTtjLmhyZWY9bDtmb3IodmFyIHU9YVsxXS5tYXRjaChpKSxkPTA7ZDx1Lmxlbmd0aDtkKyspe3ZhciBoPXVbZF0uc3BsaXQoIj0iKSxwPWhbMF07Y1twXT1yKGhbMV0pfXZvaWQgMCE9PWMucmVsJiYoc1tjLnJlbF09Yyl9cmV0dXJuIHN9dmFyIG89Il9fU1RBVEVfXyIsYT0iRkVUQ0hfREFUQSIsbD0iUEFHSU5BVElPTl9EQVRBIixjPSJERUZBVUxUX1BBUkFNUyIsdT0iTElOS19CWV9IRUFERVIiLGQ9IlhIUiI7cmV0dXJuIGUuQ29sbGVjdGlvbi5leHRlbmQoe3BhcmFtczp7fSxjb25zdHJ1Y3RvcjpmdW5jdGlvbihpLG4pe3ZhciByPXRoaXNbb109bmV3IGUuTW9kZWw7ci5zZXQoYyx0LmRlZmF1bHRzKG4mJm4ucGFyYW1zfHx7fSx0aGlzLnBhcmFtc3x8e30pKSxlLkNvbGxlY3Rpb24uYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzeW5jOmZ1bmN0aW9uKHQsbixyKXt2YXIgcz10aGlzLG89ci5zdWNjZXNzO3JldHVybiByLnN1Y2Nlc3M9ZnVuY3Rpb24odCxlLG4pe2kocyxuKSxvLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sZS5Db2xsZWN0aW9uLnByb3RvdHlwZS5zeW5jLmNhbGwodGhpcyx0LG4scil9LGZldGNoOmZ1bmN0aW9uKGkpe2l8fChpPXt9KTt2YXIgbj10aGlzW29dLHI9bi5nZXQoZCk7cmV0dXJuIGkuZGF0YT10LmV4dGVuZCh7fSxuLmdldChjKSxpLmRhdGF8fHt9KSxpLmZyb21GZXRjaD0hMCxuLnNldChhLGkuZGF0YSksciYmci5hYm9ydCYmaS5hYm9ydCE9PSExJiZyLmFib3J0KCkscj1lLkNvbGxlY3Rpb24ucHJvdG90eXBlLmZldGNoLmNhbGwodGhpcyxpKSxuLnNldChkLHIpLHJ9LHNldFBhZ2luYXRpb246ZnVuY3Rpb24oZSxpKXt0LmlzU3RyaW5nKGUpJiZlJiYoZT1uKGUpKSx0LmlzT2JqZWN0KGUpJiYhdC5pc0FycmF5KGUpJiZ0LnNpemUoZSk/aSYmaS5mcm9tRmV0Y2gmJihlPXQuZXh0ZW5kKHt9LHRoaXMuZ2V0RmV0Y2hEYXRhKCksZSkpOmU9bnVsbCx0aGlzW29dLnNldChsLGUpfSxnZXRGZXRjaERhdGE6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc1tvXS5nZXQoYSl8fHt9fSxnZXRQYWdpbmF0aW9uRGF0YTpmdW5jdGlvbigpe3JldHVybiB0aGlzW29dLmdldChsKXx8e319LGhhc01vcmU6ZnVuY3Rpb24oKXtyZXR1cm4gdC5zaXplKHRoaXMuZ2V0UGFnaW5hdGlvbkRhdGEoKSk+MH0sZmV0Y2hNb3JlOmZ1bmN0aW9uKCl7aWYoIXRoaXMuaGFzTW9yZSgpKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBSZXF1ZXN0Iik7cmV0dXJuIHRoaXMuZmV0Y2goe2RhdGE6dGhpcy5nZXRQYWdpbmF0aW9uRGF0YSgpLGFkZDohMCxyZW1vdmU6ITEsdXBkYXRlOiEwfSl9LHJlc2V0OmZ1bmN0aW9uKHQsaSl7cmV0dXJuIGl8fChpPXt9KSxpLmZyb21GZXRjaHx8dGhpcy5zZXRQYWdpbmF0aW9uKG51bGwpLGUuQ29sbGVjdGlvbi5wcm90b3R5cGUucmVzZXQuYXBwbHkodGhpcyxhcmd1bWVudHMpfSx3aGVyZTpmdW5jdGlvbihlLGkpe3JldHVybiB0LmlzRW1wdHkoZSk/aT92b2lkIDA6W106dGhpc1tpPyJmaW5kIjoiZmlsdGVyIl0oZnVuY3Rpb24odCl7Zm9yKHZhciBpIGluIGUpaWYoZVtpXSE9PXQuZ2V0KGkpKXJldHVybiExO3JldHVybiEwfSl9LGNyZWF0ZTpmdW5jdGlvbihpLG4pe3JldHVybiBufHwobj17fSksdC5yZXN1bHQoaSwidXJsUm9vdCIpfHwobi51cmw9dC5yZXN1bHQodGhpcywidXJsIikpLGUuQ29sbGVjdGlvbi5wcm90b3R5cGUuY3JlYXRlLmNhbGwodGhpcyxpLG4pfX0pfSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyOyhmdW5jdGlvbihzKXsKCS8vICAgICAoYykgMjAxMC0yMDE1IEplcmVteSBBc2hrZW5hcywgRG9jdW1lbnRDbG91ZCBhbmQgSW52ZXN0aWdhdGl2ZSBSZXBvcnRlcnMgJiBFZGl0b3JzCgkvLyAgICAgQmFja2JvbmUgbWF5IGJlIGZyZWVseSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuCgkhZnVuY3Rpb24obyl7dmFyIGE9Im9iamVjdCI9PXR5cGVvZiBzZWxmJiZzZWxmLnNlbGY9PXNlbGYmJnNlbGZ8fCJvYmplY3QiPT10eXBlb2YgcyYmcy5nbG9iYWw9PXMmJnM7bj1baSgzKSxpKDYpLGVdLHI9ZnVuY3Rpb24odCxlLGkpe2EuQmFja2JvbmU9byhhLGksdCxlKX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfShmdW5jdGlvbih0LGUsaSxuKXt2YXIgcj10LkJhY2tib25lLHM9W10uc2xpY2U7ZS5WRVJTSU9OPSIxLjIuMSIsZS4kPW4sZS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHQuQmFja2JvbmU9cix0aGlzfSxlLmVtdWxhdGVIVFRQPSExLGUuZW11bGF0ZUpTT049ITE7dmFyIG89ZnVuY3Rpb24odCxlLG4pe3N3aXRjaCh0KXtjYXNlIDE6cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGlbZV0odGhpc1tuXSl9O2Nhc2UgMjpyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIGlbZV0odGhpc1tuXSx0KX07Y2FzZSAzOnJldHVybiBmdW5jdGlvbih0LHIpe3JldHVybiBpW2VdKHRoaXNbbl0sdCxyKX07Y2FzZSA0OnJldHVybiBmdW5jdGlvbih0LHIscyl7cmV0dXJuIGlbZV0odGhpc1tuXSx0LHIscyl9O2RlZmF1bHQ6cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHQ9cy5jYWxsKGFyZ3VtZW50cyk7cmV0dXJuIHQudW5zaGlmdCh0aGlzW25dKSxpW2VdLmFwcGx5KGksdCl9fX0sYT1mdW5jdGlvbih0LGUsbil7aS5lYWNoKGUsZnVuY3Rpb24oZSxyKXtpW3JdJiYodC5wcm90b3R5cGVbcl09byhlLHIsbikpfSl9LGw9ZS5FdmVudHM9e30sYz0vXHMrLyx1PWZ1bmN0aW9uKHQsZSxuLHIscyl7dmFyIG8sYT0wO2lmKG4mJiJvYmplY3QiPT10eXBlb2Ygbil7dm9pZCAwIT09ciYmImNvbnRleHQiaW4gcyYmdm9pZCAwPT09cy5jb250ZXh0JiYocy5jb250ZXh0PXIpO2ZvcihvPWkua2V5cyhuKTthPG8ubGVuZ3RoO2ErKyllPXQoZSxvW2FdLG5bb1thXV0scyl9ZWxzZSBpZihuJiZjLnRlc3QobikpZm9yKG89bi5zcGxpdChjKTthPG8ubGVuZ3RoO2ErKyllPXQoZSxvW2FdLHIscyk7ZWxzZSBlPXQoZSxuLHIscyk7cmV0dXJuIGV9O2wub249ZnVuY3Rpb24odCxlLGkpe3JldHVybiBkKHRoaXMsdCxlLGkpfTt2YXIgZD1mdW5jdGlvbih0LGUsaSxuLHIpe2lmKHQuX2V2ZW50cz11KGgsdC5fZXZlbnRzfHx7fSxlLGkse2NvbnRleHQ6bixjdHg6dCxsaXN0ZW5pbmc6cn0pLHIpe3ZhciBzPXQuX2xpc3RlbmVyc3x8KHQuX2xpc3RlbmVycz17fSk7c1tyLmlkXT1yfXJldHVybiB0fTtsLmxpc3RlblRvPWZ1bmN0aW9uKHQsZSxuKXtpZighdClyZXR1cm4gdGhpczt2YXIgcj10Ll9saXN0ZW5JZHx8KHQuX2xpc3RlbklkPWkudW5pcXVlSWQoImwiKSkscz10aGlzLl9saXN0ZW5pbmdUb3x8KHRoaXMuX2xpc3RlbmluZ1RvPXt9KSxvPXNbcl07aWYoIW8pe3ZhciBhPXRoaXMuX2xpc3RlbklkfHwodGhpcy5fbGlzdGVuSWQ9aS51bmlxdWVJZCgibCIpKTtvPXNbcl09e29iajp0LG9iaklkOnIsaWQ6YSxsaXN0ZW5pbmdUbzpzLGNvdW50OjB9fXJldHVybiBkKHQsZSxuLHRoaXMsbyksdGhpc307dmFyIGg9ZnVuY3Rpb24odCxlLGksbil7aWYoaSl7dmFyIHI9dFtlXXx8KHRbZV09W10pLHM9bi5jb250ZXh0LG89bi5jdHgsYT1uLmxpc3RlbmluZzthJiZhLmNvdW50Kyssci5wdXNoKHtjYWxsYmFjazppLGNvbnRleHQ6cyxjdHg6c3x8byxsaXN0ZW5pbmc6YX0pfXJldHVybiB0fTtsLm9mZj1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIHRoaXMuX2V2ZW50cz8odGhpcy5fZXZlbnRzPXUocCx0aGlzLl9ldmVudHMsdCxlLHtjb250ZXh0OmksbGlzdGVuZXJzOnRoaXMuX2xpc3RlbmVyc30pLHRoaXMpOnRoaXN9LGwuc3RvcExpc3RlbmluZz1mdW5jdGlvbih0LGUsbil7dmFyIHI9dGhpcy5fbGlzdGVuaW5nVG87aWYoIXIpcmV0dXJuIHRoaXM7Zm9yKHZhciBzPXQ/W3QuX2xpc3RlbklkXTppLmtleXMociksbz0wO288cy5sZW5ndGg7bysrKXt2YXIgYT1yW3Nbb11dO2lmKCFhKWJyZWFrO2Eub2JqLm9mZihlLG4sdGhpcyl9cmV0dXJuIGkuaXNFbXB0eShyKSYmKHRoaXMuX2xpc3RlbmluZ1RvPXZvaWQgMCksdGhpc307dmFyIHA9ZnVuY3Rpb24odCxlLG4scil7aWYodCl7dmFyIHMsbz0wLGE9ci5jb250ZXh0LGw9ci5saXN0ZW5lcnM7aWYoZXx8bnx8YSl7Zm9yKHZhciBjPWU/W2VdOmkua2V5cyh0KTtvPGMubGVuZ3RoO28rKyl7ZT1jW29dO3ZhciB1PXRbZV07aWYoIXUpYnJlYWs7Zm9yKHZhciBkPVtdLGg9MDtoPHUubGVuZ3RoO2grKyl7dmFyIHA9dVtoXTtuJiZuIT09cC5jYWxsYmFjayYmbiE9PXAuY2FsbGJhY2suX2NhbGxiYWNrfHxhJiZhIT09cC5jb250ZXh0P2QucHVzaChwKToocz1wLmxpc3RlbmluZyxzJiYwPT09LS1zLmNvdW50JiYoZGVsZXRlIGxbcy5pZF0sZGVsZXRlIHMubGlzdGVuaW5nVG9bcy5vYmpJZF0pKX1kLmxlbmd0aD90W2VdPWQ6ZGVsZXRlIHRbZV19cmV0dXJuIGkuc2l6ZSh0KT90OnZvaWQgMH1mb3IodmFyIGY9aS5rZXlzKGwpO288Zi5sZW5ndGg7bysrKXM9bFtmW29dXSxkZWxldGUgbFtzLmlkXSxkZWxldGUgcy5saXN0ZW5pbmdUb1tzLm9iaklkXX19O2wub25jZT1mdW5jdGlvbih0LGUsbil7dmFyIHI9dShmLHt9LHQsZSxpLmJpbmQodGhpcy5vZmYsdGhpcykpO3JldHVybiB0aGlzLm9uKHIsdm9pZCAwLG4pfSxsLmxpc3RlblRvT25jZT1mdW5jdGlvbih0LGUsbil7dmFyIHI9dShmLHt9LGUsbixpLmJpbmQodGhpcy5zdG9wTGlzdGVuaW5nLHRoaXMsdCkpO3JldHVybiB0aGlzLmxpc3RlblRvKHQscil9O3ZhciBmPWZ1bmN0aW9uKHQsZSxuLHIpe2lmKG4pe3ZhciBzPXRbZV09aS5vbmNlKGZ1bmN0aW9uKCl7cihlLHMpLG4uYXBwbHkodGhpcyxhcmd1bWVudHMpfSk7cy5fY2FsbGJhY2s9bn1yZXR1cm4gdH07bC50cmlnZ2VyPWZ1bmN0aW9uKHQpe2lmKCF0aGlzLl9ldmVudHMpcmV0dXJuIHRoaXM7Zm9yKHZhciBlPU1hdGgubWF4KDAsYXJndW1lbnRzLmxlbmd0aC0xKSxpPUFycmF5KGUpLG49MDtuPGU7bisrKWlbbl09YXJndW1lbnRzW24rMV07cmV0dXJuIHUobSx0aGlzLl9ldmVudHMsdCx2b2lkIDAsaSksdGhpc307dmFyIG09ZnVuY3Rpb24odCxlLGksbil7aWYodCl7dmFyIHI9dFtlXSxzPXQuYWxsO3ImJnMmJihzPXMuc2xpY2UoKSksciYmXyhyLG4pLHMmJl8ocyxbZV0uY29uY2F0KG4pKX1yZXR1cm4gdH0sXz1mdW5jdGlvbih0LGUpe3ZhciBpLG49LTEscj10Lmxlbmd0aCxzPWVbMF0sbz1lWzFdLGE9ZVsyXTtzd2l0Y2goZS5sZW5ndGgpe2Nhc2UgMDpmb3IoOysrbjxyOykoaT10W25dKS5jYWxsYmFjay5jYWxsKGkuY3R4KTtyZXR1cm47Y2FzZSAxOmZvcig7KytuPHI7KShpPXRbbl0pLmNhbGxiYWNrLmNhbGwoaS5jdHgscyk7cmV0dXJuO2Nhc2UgMjpmb3IoOysrbjxyOykoaT10W25dKS5jYWxsYmFjay5jYWxsKGkuY3R4LHMsbyk7cmV0dXJuO2Nhc2UgMzpmb3IoOysrbjxyOykoaT10W25dKS5jYWxsYmFjay5jYWxsKGkuY3R4LHMsbyxhKTtyZXR1cm47ZGVmYXVsdDpmb3IoOysrbjxyOykoaT10W25dKS5jYWxsYmFjay5hcHBseShpLmN0eCxlKTtyZXR1cm59fTtsLmJpbmQ9bC5vbixsLnVuYmluZD1sLm9mZixpLmV4dGVuZChlLGwpO3ZhciBnPWUuTW9kZWw9ZnVuY3Rpb24odCxlKXt2YXIgbj10fHx7fTtlfHwoZT17fSksdGhpcy5jaWQ9aS51bmlxdWVJZCh0aGlzLmNpZFByZWZpeCksdGhpcy5hdHRyaWJ1dGVzPXt9LGUuY29sbGVjdGlvbiYmKHRoaXMuY29sbGVjdGlvbj1lLmNvbGxlY3Rpb24pLGUucGFyc2UmJihuPXRoaXMucGFyc2UobixlKXx8e30pLG49aS5kZWZhdWx0cyh7fSxuLGkucmVzdWx0KHRoaXMsImRlZmF1bHRzIikpLHRoaXMuc2V0KG4sZSksdGhpcy5jaGFuZ2VkPXt9LHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O2kuZXh0ZW5kKGcucHJvdG90eXBlLGwse2NoYW5nZWQ6bnVsbCx2YWxpZGF0aW9uRXJyb3I6bnVsbCxpZEF0dHJpYnV0ZToiaWQiLGNpZFByZWZpeDoiYyIsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe30sdG9KU09OOmZ1bmN0aW9uKHQpe3JldHVybiBpLmNsb25lKHRoaXMuYXR0cmlidXRlcyl9LHN5bmM6ZnVuY3Rpb24oKXtyZXR1cm4gZS5zeW5jLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZ2V0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXNbdF19LGVzY2FwZTpmdW5jdGlvbih0KXtyZXR1cm4gaS5lc2NhcGUodGhpcy5nZXQodCkpfSxoYXM6ZnVuY3Rpb24odCl7cmV0dXJuIG51bGwhPXRoaXMuZ2V0KHQpfSxtYXRjaGVzOmZ1bmN0aW9uKHQpe3JldHVybiEhaS5pdGVyYXRlZSh0LHRoaXMpKHRoaXMuYXR0cmlidXRlcyl9LHNldDpmdW5jdGlvbih0LGUsbil7aWYobnVsbD09dClyZXR1cm4gdGhpczt2YXIgcjtpZigib2JqZWN0Ij09dHlwZW9mIHQ/KHI9dCxuPWUpOihyPXt9KVt0XT1lLG58fChuPXt9KSwhdGhpcy5fdmFsaWRhdGUocixuKSlyZXR1cm4hMTt2YXIgcz1uLnVuc2V0LG89bi5zaWxlbnQsYT1bXSxsPXRoaXMuX2NoYW5naW5nO3RoaXMuX2NoYW5naW5nPSEwLGx8fCh0aGlzLl9wcmV2aW91c0F0dHJpYnV0ZXM9aS5jbG9uZSh0aGlzLmF0dHJpYnV0ZXMpLHRoaXMuY2hhbmdlZD17fSk7dmFyIGM9dGhpcy5hdHRyaWJ1dGVzLHU9dGhpcy5jaGFuZ2VkLGQ9dGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzO3RoaXMuaWRBdHRyaWJ1dGUgaW4gciYmKHRoaXMuaWQ9clt0aGlzLmlkQXR0cmlidXRlXSk7Zm9yKHZhciBoIGluIHIpZT1yW2hdLGkuaXNFcXVhbChjW2hdLGUpfHxhLnB1c2goaCksaS5pc0VxdWFsKGRbaF0sZSk/ZGVsZXRlIHVbaF06dVtoXT1lLHM/ZGVsZXRlIGNbaF06Y1toXT1lO2lmKCFvKXthLmxlbmd0aCYmKHRoaXMuX3BlbmRpbmc9bik7Zm9yKHZhciBwPTA7cDxhLmxlbmd0aDtwKyspdGhpcy50cmlnZ2VyKCJjaGFuZ2U6IithW3BdLHRoaXMsY1thW3BdXSxuKX1pZihsKXJldHVybiB0aGlzO2lmKCFvKWZvcig7dGhpcy5fcGVuZGluZzspbj10aGlzLl9wZW5kaW5nLHRoaXMuX3BlbmRpbmc9ITEsdGhpcy50cmlnZ2VyKCJjaGFuZ2UiLHRoaXMsbik7cmV0dXJuIHRoaXMuX3BlbmRpbmc9ITEsdGhpcy5fY2hhbmdpbmc9ITEsdGhpc30sdW5zZXQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5zZXQodCx2b2lkIDAsaS5leHRlbmQoe30sZSx7dW5zZXQ6ITB9KSl9LGNsZWFyOmZ1bmN0aW9uKHQpe3ZhciBlPXt9O2Zvcih2YXIgbiBpbiB0aGlzLmF0dHJpYnV0ZXMpZVtuXT12b2lkIDA7cmV0dXJuIHRoaXMuc2V0KGUsaS5leHRlbmQoe30sdCx7dW5zZXQ6ITB9KSl9LGhhc0NoYW5nZWQ6ZnVuY3Rpb24odCl7cmV0dXJuIG51bGw9PXQ/IWkuaXNFbXB0eSh0aGlzLmNoYW5nZWQpOmkuaGFzKHRoaXMuY2hhbmdlZCx0KX0sY2hhbmdlZEF0dHJpYnV0ZXM6ZnVuY3Rpb24odCl7aWYoIXQpcmV0dXJuISF0aGlzLmhhc0NoYW5nZWQoKSYmaS5jbG9uZSh0aGlzLmNoYW5nZWQpO3ZhciBlPXRoaXMuX2NoYW5naW5nP3RoaXMuX3ByZXZpb3VzQXR0cmlidXRlczp0aGlzLmF0dHJpYnV0ZXMsbj17fTtmb3IodmFyIHIgaW4gdCl7dmFyIHM9dFtyXTtpLmlzRXF1YWwoZVtyXSxzKXx8KG5bcl09cyl9cmV0dXJuISFpLnNpemUobikmJm59LHByZXZpb3VzOmZ1bmN0aW9uKHQpe3JldHVybiBudWxsIT10JiZ0aGlzLl9wcmV2aW91c0F0dHJpYnV0ZXM/dGhpcy5fcHJldmlvdXNBdHRyaWJ1dGVzW3RdOm51bGx9LHByZXZpb3VzQXR0cmlidXRlczpmdW5jdGlvbigpe3JldHVybiBpLmNsb25lKHRoaXMuX3ByZXZpb3VzQXR0cmlidXRlcyl9LGZldGNoOmZ1bmN0aW9uKHQpe3Q9aS5leHRlbmQoe3BhcnNlOiEwfSx0KTt2YXIgZT10aGlzLG49dC5zdWNjZXNzO3JldHVybiB0LnN1Y2Nlc3M9ZnVuY3Rpb24oaSl7dmFyIHI9dC5wYXJzZT9lLnBhcnNlKGksdCk6aTtyZXR1cm4hIWUuc2V0KHIsdCkmJihuJiZuLmNhbGwodC5jb250ZXh0LGUsaSx0KSx2b2lkIGUudHJpZ2dlcigic3luYyIsZSxpLHQpKX0saih0aGlzLHQpLHRoaXMuc3luYygicmVhZCIsdGhpcyx0KX0sc2F2ZTpmdW5jdGlvbih0LGUsbil7dmFyIHI7bnVsbD09dHx8Im9iamVjdCI9PXR5cGVvZiB0PyhyPXQsbj1lKToocj17fSlbdF09ZSxuPWkuZXh0ZW5kKHt2YWxpZGF0ZTohMCxwYXJzZTohMH0sbik7dmFyIHM9bi53YWl0O2lmKHImJiFzKXtpZighdGhpcy5zZXQocixuKSlyZXR1cm4hMX1lbHNlIGlmKCF0aGlzLl92YWxpZGF0ZShyLG4pKXJldHVybiExO3ZhciBvPXRoaXMsYT1uLnN1Y2Nlc3MsbD10aGlzLmF0dHJpYnV0ZXM7bi5zdWNjZXNzPWZ1bmN0aW9uKHQpe28uYXR0cmlidXRlcz1sO3ZhciBlPW4ucGFyc2U/by5wYXJzZSh0LG4pOnQ7cmV0dXJuIHMmJihlPWkuZXh0ZW5kKHt9LHIsZSkpLCEoZSYmIW8uc2V0KGUsbikpJiYoYSYmYS5jYWxsKG4uY29udGV4dCxvLHQsbiksdm9pZCBvLnRyaWdnZXIoInN5bmMiLG8sdCxuKSl9LGoodGhpcyxuKSxyJiZzJiYodGhpcy5hdHRyaWJ1dGVzPWkuZXh0ZW5kKHt9LGwscikpO3ZhciBjPXRoaXMuaXNOZXcoKT8iY3JlYXRlIjpuLnBhdGNoPyJwYXRjaCI6InVwZGF0ZSI7InBhdGNoIiE9PWN8fG4uYXR0cnN8fChuLmF0dHJzPXIpO3ZhciB1PXRoaXMuc3luYyhjLHRoaXMsbik7cmV0dXJuIHRoaXMuYXR0cmlidXRlcz1sLHV9LGRlc3Ryb3k6ZnVuY3Rpb24odCl7dD10P2kuY2xvbmUodCk6e307dmFyIGU9dGhpcyxuPXQuc3VjY2VzcyxyPXQud2FpdCxzPWZ1bmN0aW9uKCl7ZS5zdG9wTGlzdGVuaW5nKCksZS50cmlnZ2VyKCJkZXN0cm95IixlLGUuY29sbGVjdGlvbix0KX07dC5zdWNjZXNzPWZ1bmN0aW9uKGkpe3ImJnMoKSxuJiZuLmNhbGwodC5jb250ZXh0LGUsaSx0KSxlLmlzTmV3KCl8fGUudHJpZ2dlcigic3luYyIsZSxpLHQpfTt2YXIgbz0hMTtyZXR1cm4gdGhpcy5pc05ldygpP2kuZGVmZXIodC5zdWNjZXNzKTooaih0aGlzLHQpLG89dGhpcy5zeW5jKCJkZWxldGUiLHRoaXMsdCkpLHJ8fHMoKSxvfSx1cmw6ZnVuY3Rpb24oKXt2YXIgdD1pLnJlc3VsdCh0aGlzLCJ1cmxSb290Iil8fGkucmVzdWx0KHRoaXMuY29sbGVjdGlvbiwidXJsIil8fEgoKTtpZih0aGlzLmlzTmV3KCkpcmV0dXJuIHQ7dmFyIGU9dGhpcy5nZXQodGhpcy5pZEF0dHJpYnV0ZSk7cmV0dXJuIHQucmVwbGFjZSgvW15cL10kLywiJCYvIikrZW5jb2RlVVJJQ29tcG9uZW50KGUpfSxwYXJzZTpmdW5jdGlvbih0LGUpe3JldHVybiB0fSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLmF0dHJpYnV0ZXMpfSxpc05ldzpmdW5jdGlvbigpe3JldHVybiF0aGlzLmhhcyh0aGlzLmlkQXR0cmlidXRlKX0saXNWYWxpZDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fdmFsaWRhdGUoe30saS5kZWZhdWx0cyh7dmFsaWRhdGU6ITB9LHQpKX0sX3ZhbGlkYXRlOmZ1bmN0aW9uKHQsZSl7aWYoIWUudmFsaWRhdGV8fCF0aGlzLnZhbGlkYXRlKXJldHVybiEwO3Q9aS5leHRlbmQoe30sdGhpcy5hdHRyaWJ1dGVzLHQpO3ZhciBuPXRoaXMudmFsaWRhdGlvbkVycm9yPXRoaXMudmFsaWRhdGUodCxlKXx8bnVsbDtyZXR1cm4hbnx8KHRoaXMudHJpZ2dlcigiaW52YWxpZCIsdGhpcyxuLGkuZXh0ZW5kKGUse3ZhbGlkYXRpb25FcnJvcjpufSkpLCExKX19KTt2YXIgdj17a2V5czoxLHZhbHVlczoxLHBhaXJzOjEsaW52ZXJ0OjEscGljazowLG9taXQ6MCxjaGFpbjoxLGlzRW1wdHk6MX07YShnLHYsImF0dHJpYnV0ZXMiKTt2YXIgeT1lLkNvbGxlY3Rpb249ZnVuY3Rpb24odCxlKXtlfHwoZT17fSksZS5tb2RlbCYmKHRoaXMubW9kZWw9ZS5tb2RlbCksdm9pZCAwIT09ZS5jb21wYXJhdG9yJiYodGhpcy5jb21wYXJhdG9yPWUuY29tcGFyYXRvciksdGhpcy5fcmVzZXQoKSx0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpLHQmJnRoaXMucmVzZXQodCxpLmV4dGVuZCh7c2lsZW50OiEwfSxlKSl9LGI9e2FkZDohMCxyZW1vdmU6ITAsbWVyZ2U6ITB9LHc9e2FkZDohMCxyZW1vdmU6ITF9O2kuZXh0ZW5kKHkucHJvdG90eXBlLGwse21vZGVsOmcsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe30sdG9KU09OOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gZS50b0pTT04odCl9KX0sc3luYzpmdW5jdGlvbigpe3JldHVybiBlLnN5bmMuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxhZGQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5zZXQodCxpLmV4dGVuZCh7bWVyZ2U6ITF9LGUsdykpfSxyZW1vdmU6ZnVuY3Rpb24odCxlKXtlPWkuZXh0ZW5kKHt9LGUpO3ZhciBuPSFpLmlzQXJyYXkodCk7dD1uP1t0XTppLmNsb25lKHQpO3ZhciByPXRoaXMuX3JlbW92ZU1vZGVscyh0LGUpO3JldHVybiFlLnNpbGVudCYmciYmdGhpcy50cmlnZ2VyKCJ1cGRhdGUiLHRoaXMsZSksbj9yWzBdOnJ9LHNldDpmdW5jdGlvbih0LGUpe2U9aS5kZWZhdWx0cyh7fSxlLGIpLGUucGFyc2UmJiF0aGlzLl9pc01vZGVsKHQpJiYodD10aGlzLnBhcnNlKHQsZSkpO3ZhciBuPSFpLmlzQXJyYXkodCk7dD1uP3Q/W3RdOltdOnQuc2xpY2UoKTt2YXIgcixzLG8sYSxsLGM9ZS5hdDtudWxsIT1jJiYoYz0rYyksYzwwJiYoYys9dGhpcy5sZW5ndGgrMSk7Zm9yKHZhciB1PXRoaXMuY29tcGFyYXRvciYmbnVsbD09YyYmZS5zb3J0IT09ITEsZD1pLmlzU3RyaW5nKHRoaXMuY29tcGFyYXRvcik/dGhpcy5jb21wYXJhdG9yOm51bGwsaD1bXSxwPVtdLGY9e30sbT1lLmFkZCxfPWUubWVyZ2UsZz1lLnJlbW92ZSx2PSEodXx8IW18fCFnKSYmW10seT0hMSx3PTA7dzx0Lmxlbmd0aDt3Kyspe2lmKG89dFt3XSxhPXRoaXMuZ2V0KG8pKWcmJihmW2EuY2lkXT0hMCksXyYmbyE9PWEmJihvPXRoaXMuX2lzTW9kZWwobyk/by5hdHRyaWJ1dGVzOm8sZS5wYXJzZSYmKG89YS5wYXJzZShvLGUpKSxhLnNldChvLGUpLHUmJiFsJiZhLmhhc0NoYW5nZWQoZCkmJihsPSEwKSksdFt3XT1hO2Vsc2UgaWYobSl7aWYocz10W3ddPXRoaXMuX3ByZXBhcmVNb2RlbChvLGUpLCFzKWNvbnRpbnVlO2gucHVzaChzKSx0aGlzLl9hZGRSZWZlcmVuY2UocyxlKX1zPWF8fHMscyYmKHI9dGhpcy5tb2RlbElkKHMuYXR0cmlidXRlcyksIXZ8fCFzLmlzTmV3KCkmJmZbcl18fCh2LnB1c2gocykseT15fHwhdGhpcy5tb2RlbHNbd118fHMuY2lkIT09dGhpcy5tb2RlbHNbd10uY2lkKSxmW3JdPSEwKX1pZihnKXtmb3IodmFyIHc9MDt3PHRoaXMubGVuZ3RoO3crKylmWyhzPXRoaXMubW9kZWxzW3ddKS5jaWRdfHxwLnB1c2gocyk7cC5sZW5ndGgmJnRoaXMuX3JlbW92ZU1vZGVscyhwLGUpfWlmKGgubGVuZ3RofHx5KWlmKHUmJihsPSEwKSx0aGlzLmxlbmd0aCs9aC5sZW5ndGgsbnVsbCE9Yylmb3IodmFyIHc9MDt3PGgubGVuZ3RoO3crKyl0aGlzLm1vZGVscy5zcGxpY2UoYyt3LDAsaFt3XSk7ZWxzZXt2JiYodGhpcy5tb2RlbHMubGVuZ3RoPTApO2Zvcih2YXIgTT12fHxoLHc9MDt3PE0ubGVuZ3RoO3crKyl0aGlzLm1vZGVscy5wdXNoKE1bd10pfWlmKGwmJnRoaXMuc29ydCh7c2lsZW50OiEwfSksIWUuc2lsZW50KXtmb3IodmFyIGs9bnVsbCE9Yz9pLmNsb25lKGUpOmUsdz0wO3c8aC5sZW5ndGg7dysrKW51bGwhPWMmJihrLmluZGV4PWMrdyksKHM9aFt3XSkudHJpZ2dlcigiYWRkIixzLHRoaXMsayk7KGx8fHkpJiZ0aGlzLnRyaWdnZXIoInNvcnQiLHRoaXMsZSksKGgubGVuZ3RofHxwLmxlbmd0aCkmJnRoaXMudHJpZ2dlcigidXBkYXRlIix0aGlzLGUpfXJldHVybiBuP3RbMF06dH0scmVzZXQ6ZnVuY3Rpb24odCxlKXtlPWU/aS5jbG9uZShlKTp7fTtmb3IodmFyIG49MDtuPHRoaXMubW9kZWxzLmxlbmd0aDtuKyspdGhpcy5fcmVtb3ZlUmVmZXJlbmNlKHRoaXMubW9kZWxzW25dLGUpO3JldHVybiBlLnByZXZpb3VzTW9kZWxzPXRoaXMubW9kZWxzLHRoaXMuX3Jlc2V0KCksdD10aGlzLmFkZCh0LGkuZXh0ZW5kKHtzaWxlbnQ6ITB9LGUpKSxlLnNpbGVudHx8dGhpcy50cmlnZ2VyKCJyZXNldCIsdGhpcyxlKSx0fSxwdXNoOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuYWRkKHQsaS5leHRlbmQoe2F0OnRoaXMubGVuZ3RofSxlKSl9LHBvcDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmF0KHRoaXMubGVuZ3RoLTEpO3JldHVybiB0aGlzLnJlbW92ZShlLHQpfSx1bnNoaWZ0OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuYWRkKHQsaS5leHRlbmQoe2F0OjB9LGUpKX0sc2hpZnQ6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5hdCgwKTtyZXR1cm4gdGhpcy5yZW1vdmUoZSx0KX0sc2xpY2U6ZnVuY3Rpb24oKXtyZXR1cm4gcy5hcHBseSh0aGlzLm1vZGVscyxhcmd1bWVudHMpfSxnZXQ6ZnVuY3Rpb24odCl7aWYobnVsbCE9dCl7dmFyIGU9dGhpcy5tb2RlbElkKHRoaXMuX2lzTW9kZWwodCk/dC5hdHRyaWJ1dGVzOnQpO3JldHVybiB0aGlzLl9ieUlkW3RdfHx0aGlzLl9ieUlkW2VdfHx0aGlzLl9ieUlkW3QuY2lkXX19LGF0OmZ1bmN0aW9uKHQpe3JldHVybiB0PDAmJih0Kz10aGlzLmxlbmd0aCksdGhpcy5tb2RlbHNbdF19LHdoZXJlOmZ1bmN0aW9uKHQsZSl7dmFyIG49aS5tYXRjaGVzKHQpO3JldHVybiB0aGlzW2U/ImZpbmQiOiJmaWx0ZXIiXShmdW5jdGlvbih0KXtyZXR1cm4gbih0LmF0dHJpYnV0ZXMpfSl9LGZpbmRXaGVyZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy53aGVyZSh0LCEwKX0sc29ydDpmdW5jdGlvbih0KXtpZighdGhpcy5jb21wYXJhdG9yKXRocm93IG5ldyBFcnJvcigiQ2Fubm90IHNvcnQgYSBzZXQgd2l0aG91dCBhIGNvbXBhcmF0b3IiKTtyZXR1cm4gdHx8KHQ9e30pLGkuaXNTdHJpbmcodGhpcy5jb21wYXJhdG9yKXx8MT09PXRoaXMuY29tcGFyYXRvci5sZW5ndGg/dGhpcy5tb2RlbHM9dGhpcy5zb3J0QnkodGhpcy5jb21wYXJhdG9yLHRoaXMpOnRoaXMubW9kZWxzLnNvcnQoaS5iaW5kKHRoaXMuY29tcGFyYXRvcix0aGlzKSksdC5zaWxlbnR8fHRoaXMudHJpZ2dlcigic29ydCIsdGhpcyx0KSx0aGlzfSxwbHVjazpmdW5jdGlvbih0KXtyZXR1cm4gaS5pbnZva2UodGhpcy5tb2RlbHMsImdldCIsdCl9LGZldGNoOmZ1bmN0aW9uKHQpe3Q9aS5leHRlbmQoe3BhcnNlOiEwfSx0KTt2YXIgZT10LnN1Y2Nlc3Msbj10aGlzO3JldHVybiB0LnN1Y2Nlc3M9ZnVuY3Rpb24oaSl7dmFyIHI9dC5yZXNldD8icmVzZXQiOiJzZXQiO25bcl0oaSx0KSxlJiZlLmNhbGwodC5jb250ZXh0LG4saSx0KSxuLnRyaWdnZXIoInN5bmMiLG4saSx0KX0saih0aGlzLHQpLHRoaXMuc3luYygicmVhZCIsdGhpcyx0KX0sY3JlYXRlOmZ1bmN0aW9uKHQsZSl7ZT1lP2kuY2xvbmUoZSk6e307dmFyIG49ZS53YWl0O2lmKHQ9dGhpcy5fcHJlcGFyZU1vZGVsKHQsZSksIXQpcmV0dXJuITE7bnx8dGhpcy5hZGQodCxlKTt2YXIgcj10aGlzLHM9ZS5zdWNjZXNzO3JldHVybiBlLnN1Y2Nlc3M9ZnVuY3Rpb24odCxlLGkpe24mJnIuYWRkKHQsaSkscyYmcy5jYWxsKGkuY29udGV4dCx0LGUsaSl9LHQuc2F2ZShudWxsLGUpLHR9LHBhcnNlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHR9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMubW9kZWxzLHttb2RlbDp0aGlzLm1vZGVsLGNvbXBhcmF0b3I6dGhpcy5jb21wYXJhdG9yfSl9LG1vZGVsSWQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRbdGhpcy5tb2RlbC5wcm90b3R5cGUuaWRBdHRyaWJ1dGV8fCJpZCJdfSxfcmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLmxlbmd0aD0wLHRoaXMubW9kZWxzPVtdLHRoaXMuX2J5SWQ9e319LF9wcmVwYXJlTW9kZWw6ZnVuY3Rpb24odCxlKXtpZih0aGlzLl9pc01vZGVsKHQpKXJldHVybiB0LmNvbGxlY3Rpb258fCh0LmNvbGxlY3Rpb249dGhpcyksdDtlPWU/aS5jbG9uZShlKTp7fSxlLmNvbGxlY3Rpb249dGhpczt2YXIgbj1uZXcgdGhpcy5tb2RlbCh0LGUpO3JldHVybiBuLnZhbGlkYXRpb25FcnJvcj8odGhpcy50cmlnZ2VyKCJpbnZhbGlkIix0aGlzLG4udmFsaWRhdGlvbkVycm9yLGUpLCExKTpufSxfcmVtb3ZlTW9kZWxzOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPVtdLG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIHI9dGhpcy5nZXQodFtuXSk7aWYocil7dmFyIHM9dGhpcy5pbmRleE9mKHIpO3RoaXMubW9kZWxzLnNwbGljZShzLDEpLHRoaXMubGVuZ3RoLS0sZS5zaWxlbnR8fChlLmluZGV4PXMsci50cmlnZ2VyKCJyZW1vdmUiLHIsdGhpcyxlKSksaS5wdXNoKHIpLHRoaXMuX3JlbW92ZVJlZmVyZW5jZShyLGUpfX1yZXR1cm4hIWkubGVuZ3RoJiZpfSxfaXNNb2RlbDpmdW5jdGlvbih0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIGd9LF9hZGRSZWZlcmVuY2U6ZnVuY3Rpb24odCxlKXt0aGlzLl9ieUlkW3QuY2lkXT10O3ZhciBpPXRoaXMubW9kZWxJZCh0LmF0dHJpYnV0ZXMpO251bGwhPWkmJih0aGlzLl9ieUlkW2ldPXQpLHQub24oImFsbCIsdGhpcy5fb25Nb2RlbEV2ZW50LHRoaXMpfSxfcmVtb3ZlUmVmZXJlbmNlOmZ1bmN0aW9uKHQsZSl7ZGVsZXRlIHRoaXMuX2J5SWRbdC5jaWRdO3ZhciBpPXRoaXMubW9kZWxJZCh0LmF0dHJpYnV0ZXMpO251bGwhPWkmJmRlbGV0ZSB0aGlzLl9ieUlkW2ldLHRoaXM9PT10LmNvbGxlY3Rpb24mJmRlbGV0ZSB0LmNvbGxlY3Rpb24sdC5vZmYoImFsbCIsdGhpcy5fb25Nb2RlbEV2ZW50LHRoaXMpfSxfb25Nb2RlbEV2ZW50OmZ1bmN0aW9uKHQsZSxpLG4pe2lmKCJhZGQiIT09dCYmInJlbW92ZSIhPT10fHxpPT09dGhpcyl7aWYoImRlc3Ryb3kiPT09dCYmdGhpcy5yZW1vdmUoZSxuKSwiY2hhbmdlIj09PXQpe3ZhciByPXRoaXMubW9kZWxJZChlLnByZXZpb3VzQXR0cmlidXRlcygpKSxzPXRoaXMubW9kZWxJZChlLmF0dHJpYnV0ZXMpO3IhPT1zJiYobnVsbCE9ciYmZGVsZXRlIHRoaXMuX2J5SWRbcl0sbnVsbCE9cyYmKHRoaXMuX2J5SWRbc109ZSkpfXRoaXMudHJpZ2dlci5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fX0pO3ZhciBNPXtmb3JFYWNoOjMsZWFjaDozLG1hcDozLGNvbGxlY3Q6MyxyZWR1Y2U6NCxmb2xkbDo0LGluamVjdDo0LHJlZHVjZVJpZ2h0OjQsZm9sZHI6NCxmaW5kOjMsZGV0ZWN0OjMsZmlsdGVyOjMsc2VsZWN0OjMscmVqZWN0OjMsZXZlcnk6MyxhbGw6Myxzb21lOjMsYW55OjMsaW5jbHVkZToyLGNvbnRhaW5zOjIsaW52b2tlOjAsbWF4OjMsbWluOjMsdG9BcnJheToxLHNpemU6MSxmaXJzdDozLGhlYWQ6Myx0YWtlOjMsaW5pdGlhbDozLHJlc3Q6Myx0YWlsOjMsZHJvcDozLGxhc3Q6Myx3aXRob3V0OjAsZGlmZmVyZW5jZTowLGluZGV4T2Y6MyxzaHVmZmxlOjEsbGFzdEluZGV4T2Y6Myxpc0VtcHR5OjEsY2hhaW46MSxzYW1wbGU6MyxwYXJ0aXRpb246M307YSh5LE0sIm1vZGVscyIpO3ZhciBrPVsiZ3JvdXBCeSIsImNvdW50QnkiLCJzb3J0QnkiLCJpbmRleEJ5Il07aS5lYWNoKGssZnVuY3Rpb24odCl7aVt0XSYmKHkucHJvdG90eXBlW3RdPWZ1bmN0aW9uKGUsbil7dmFyIHI9aS5pc0Z1bmN0aW9uKGUpP2U6ZnVuY3Rpb24odCl7cmV0dXJuIHQuZ2V0KGUpfTtyZXR1cm4gaVt0XSh0aGlzLm1vZGVscyxyLG4pfSl9KTt2YXIgVD1lLlZpZXc9ZnVuY3Rpb24odCl7dGhpcy5jaWQ9aS51bmlxdWVJZCgidmlldyIpLGkuZXh0ZW5kKHRoaXMsaS5waWNrKHQsTCkpLHRoaXMuX2Vuc3VyZUVsZW1lbnQoKSx0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxTPS9eKFxTKylccyooLiopJC8sTD1bIm1vZGVsIiwiY29sbGVjdGlvbiIsImVsIiwiaWQiLCJhdHRyaWJ1dGVzIiwiY2xhc3NOYW1lIiwidGFnTmFtZSIsImV2ZW50cyJdO2kuZXh0ZW5kKFQucHJvdG90eXBlLGwse3RhZ05hbWU6ImRpdiIsJDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy4kZWwuZmluZCh0KX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe30scmVuZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LHJlbW92ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZW1vdmVFbGVtZW50KCksdGhpcy5zdG9wTGlzdGVuaW5nKCksdGhpc30sX3JlbW92ZUVsZW1lbnQ6ZnVuY3Rpb24oKXt0aGlzLiRlbC5yZW1vdmUoKX0sc2V0RWxlbWVudDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy51bmRlbGVnYXRlRXZlbnRzKCksdGhpcy5fc2V0RWxlbWVudCh0KSx0aGlzLmRlbGVnYXRlRXZlbnRzKCksdGhpc30sX3NldEVsZW1lbnQ6ZnVuY3Rpb24odCl7dGhpcy4kZWw9dCBpbnN0YW5jZW9mIGUuJD90OmUuJCh0KSx0aGlzLmVsPXRoaXMuJGVsWzBdfSxkZWxlZ2F0ZUV2ZW50czpmdW5jdGlvbih0KXtpZih0fHwodD1pLnJlc3VsdCh0aGlzLCJldmVudHMiKSksIXQpcmV0dXJuIHRoaXM7dGhpcy51bmRlbGVnYXRlRXZlbnRzKCk7Zm9yKHZhciBlIGluIHQpe3ZhciBuPXRbZV07aWYoaS5pc0Z1bmN0aW9uKG4pfHwobj10aGlzW25dKSxuKXt2YXIgcj1lLm1hdGNoKFMpO3RoaXMuZGVsZWdhdGUoclsxXSxyWzJdLGkuYmluZChuLHRoaXMpKX19cmV0dXJuIHRoaXN9LGRlbGVnYXRlOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdGhpcy4kZWwub24odCsiLmRlbGVnYXRlRXZlbnRzIit0aGlzLmNpZCxlLGkpLHRoaXN9LHVuZGVsZWdhdGVFdmVudHM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kZWwmJnRoaXMuJGVsLm9mZigiLmRlbGVnYXRlRXZlbnRzIit0aGlzLmNpZCksdGhpc30sdW5kZWxlZ2F0ZTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHRoaXMuJGVsLm9mZih0KyIuZGVsZWdhdGVFdmVudHMiK3RoaXMuY2lkLGUsaSksdGhpc30sX2NyZWF0ZUVsZW1lbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodCl9LF9lbnN1cmVFbGVtZW50OmZ1bmN0aW9uKCl7aWYodGhpcy5lbCl0aGlzLnNldEVsZW1lbnQoaS5yZXN1bHQodGhpcywiZWwiKSk7ZWxzZXt2YXIgdD1pLmV4dGVuZCh7fSxpLnJlc3VsdCh0aGlzLCJhdHRyaWJ1dGVzIikpO3RoaXMuaWQmJih0LmlkPWkucmVzdWx0KHRoaXMsImlkIikpLHRoaXMuY2xhc3NOYW1lJiYodFsiY2xhc3MiXT1pLnJlc3VsdCh0aGlzLCJjbGFzc05hbWUiKSksdGhpcy5zZXRFbGVtZW50KHRoaXMuX2NyZWF0ZUVsZW1lbnQoaS5yZXN1bHQodGhpcywidGFnTmFtZSIpKSksdGhpcy5fc2V0QXR0cmlidXRlcyh0KX19LF9zZXRBdHRyaWJ1dGVzOmZ1bmN0aW9uKHQpe3RoaXMuJGVsLmF0dHIodCl9fSksZS5zeW5jPWZ1bmN0aW9uKHQsbixyKXt2YXIgcz14W3RdO2kuZGVmYXVsdHMocnx8KHI9e30pLHtlbXVsYXRlSFRUUDplLmVtdWxhdGVIVFRQLGVtdWxhdGVKU09OOmUuZW11bGF0ZUpTT059KTt2YXIgbz17dHlwZTpzLGRhdGFUeXBlOiJqc29uIn07aWYoci51cmx8fChvLnVybD1pLnJlc3VsdChuLCJ1cmwiKXx8SCgpKSxudWxsIT1yLmRhdGF8fCFufHwiY3JlYXRlIiE9PXQmJiJ1cGRhdGUiIT09dCYmInBhdGNoIiE9PXR8fChvLmNvbnRlbnRUeXBlPSJhcHBsaWNhdGlvbi9qc29uIixvLmRhdGE9SlNPTi5zdHJpbmdpZnkoci5hdHRyc3x8bi50b0pTT04ocikpKSxyLmVtdWxhdGVKU09OJiYoby5jb250ZW50VHlwZT0iYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIixvLmRhdGE9by5kYXRhP3ttb2RlbDpvLmRhdGF9Ont9KSxyLmVtdWxhdGVIVFRQJiYoIlBVVCI9PT1zfHwiREVMRVRFIj09PXN8fCJQQVRDSCI9PT1zKSl7by50eXBlPSJQT1NUIixyLmVtdWxhdGVKU09OJiYoby5kYXRhLl9tZXRob2Q9cyk7dmFyIGE9ci5iZWZvcmVTZW5kO3IuYmVmb3JlU2VuZD1mdW5jdGlvbih0KXtpZih0LnNldFJlcXVlc3RIZWFkZXIoIlgtSFRUUC1NZXRob2QtT3ZlcnJpZGUiLHMpLGEpcmV0dXJuIGEuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0iR0VUIj09PW8udHlwZXx8ci5lbXVsYXRlSlNPTnx8KG8ucHJvY2Vzc0RhdGE9ITEpO3ZhciBsPXIuZXJyb3I7ci5lcnJvcj1mdW5jdGlvbih0LGUsaSl7ci50ZXh0U3RhdHVzPWUsci5lcnJvclRocm93bj1pLGwmJmwuY2FsbChyLmNvbnRleHQsdCxlLGkpfTt2YXIgYz1yLnhocj1lLmFqYXgoaS5leHRlbmQobyxyKSk7cmV0dXJuIG4udHJpZ2dlcigicmVxdWVzdCIsbixjLHIpLGN9O3ZhciB4PXtjcmVhdGU6IlBPU1QiLHVwZGF0ZToiUFVUIixwYXRjaDoiUEFUQ0giLCJkZWxldGUiOiJERUxFVEUiLHJlYWQ6IkdFVCJ9O2UuYWpheD1mdW5jdGlvbigpe3JldHVybiBlLiQuYWpheC5hcHBseShlLiQsYXJndW1lbnRzKX07dmFyIEU9ZS5Sb3V0ZXI9ZnVuY3Rpb24odCl7dHx8KHQ9e30pLHQucm91dGVzJiYodGhpcy5yb3V0ZXM9dC5yb3V0ZXMpLHRoaXMuX2JpbmRSb3V0ZXMoKSx0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxEPS9cKCguKj8pXCkvZyxZPS8oXChcPyk/Olx3Ky9nLEM9L1wqXHcrL2csQT0vW1wte31cW1xdKz8uLFxcXF4kfCNcc10vZztpLmV4dGVuZChFLnByb3RvdHlwZSxsLHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7fSxyb3V0ZTpmdW5jdGlvbih0LG4scil7aS5pc1JlZ0V4cCh0KXx8KHQ9dGhpcy5fcm91dGVUb1JlZ0V4cCh0KSksaS5pc0Z1bmN0aW9uKG4pJiYocj1uLG49IiIpLHJ8fChyPXRoaXNbbl0pO3ZhciBzPXRoaXM7cmV0dXJuIGUuaGlzdG9yeS5yb3V0ZSh0LGZ1bmN0aW9uKGkpe3ZhciBvPXMuX2V4dHJhY3RQYXJhbWV0ZXJzKHQsaSk7cy5leGVjdXRlKHIsbyxuKSE9PSExJiYocy50cmlnZ2VyLmFwcGx5KHMsWyJyb3V0ZToiK25dLmNvbmNhdChvKSkscy50cmlnZ2VyKCJyb3V0ZSIsbixvKSxlLmhpc3RvcnkudHJpZ2dlcigicm91dGUiLHMsbixvKSl9KSx0aGlzfSxleGVjdXRlOmZ1bmN0aW9uKHQsZSxpKXt0JiZ0LmFwcGx5KHRoaXMsZSl9LG5hdmlnYXRlOmZ1bmN0aW9uKHQsaSl7cmV0dXJuIGUuaGlzdG9yeS5uYXZpZ2F0ZSh0LGkpLHRoaXN9LF9iaW5kUm91dGVzOmZ1bmN0aW9uKCl7aWYodGhpcy5yb3V0ZXMpe3RoaXMucm91dGVzPWkucmVzdWx0KHRoaXMsInJvdXRlcyIpO2Zvcih2YXIgdCxlPWkua2V5cyh0aGlzLnJvdXRlcyk7bnVsbCE9KHQ9ZS5wb3AoKSk7KXRoaXMucm91dGUodCx0aGlzLnJvdXRlc1t0XSl9fSxfcm91dGVUb1JlZ0V4cDpmdW5jdGlvbih0KXtyZXR1cm4gdD10LnJlcGxhY2UoQSwiXFwkJiIpLnJlcGxhY2UoRCwiKD86JDEpPyIpLnJlcGxhY2UoWSxmdW5jdGlvbih0LGUpe3JldHVybiBlP3Q6IihbXi8/XSspIn0pLnJlcGxhY2UoQywiKFteP10qPykiKSxuZXcgUmVnRXhwKCJeIit0KyIoPzpcXD8oW1xcc1xcU10qKSk/JCIpfSxfZXh0cmFjdFBhcmFtZXRlcnM6ZnVuY3Rpb24odCxlKXt2YXIgbj10LmV4ZWMoZSkuc2xpY2UoMSk7cmV0dXJuIGkubWFwKG4sZnVuY3Rpb24odCxlKXtyZXR1cm4gZT09PW4ubGVuZ3RoLTE/dHx8bnVsbDp0P2RlY29kZVVSSUNvbXBvbmVudCh0KTpudWxsfSl9fSk7dmFyIE89ZS5IaXN0b3J5PWZ1bmN0aW9uKCl7dGhpcy5oYW5kbGVycz1bXSxpLmJpbmRBbGwodGhpcywiY2hlY2tVcmwiKSwidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmKHRoaXMubG9jYXRpb249d2luZG93LmxvY2F0aW9uLHRoaXMuaGlzdG9yeT13aW5kb3cuaGlzdG9yeSl9LE49L15bI1wvXXxccyskL2csST0vXlwvK3xcLyskL2csUD0vIy4qJC87Ty5zdGFydGVkPSExLGkuZXh0ZW5kKE8ucHJvdG90eXBlLGwse2ludGVydmFsOjUwLGF0Um9vdDpmdW5jdGlvbigpe3ZhciB0PXRoaXMubG9jYXRpb24ucGF0aG5hbWUucmVwbGFjZSgvW15cL10kLywiJCYvIik7cmV0dXJuIHQ9PT10aGlzLnJvb3QmJiF0aGlzLmdldFNlYXJjaCgpfSxtYXRjaFJvb3Q6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmRlY29kZUZyYWdtZW50KHRoaXMubG9jYXRpb24ucGF0aG5hbWUpLGU9dC5zbGljZSgwLHRoaXMucm9vdC5sZW5ndGgtMSkrIi8iO3JldHVybiBlPT09dGhpcy5yb290fSxkZWNvZGVGcmFnbWVudDpmdW5jdGlvbih0KXtyZXR1cm4gZGVjb2RlVVJJKHQucmVwbGFjZSgvJTI1L2csIiUyNTI1IikpfSxnZXRTZWFyY2g6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmxvY2F0aW9uLmhyZWYucmVwbGFjZSgvIy4qLywiIikubWF0Y2goL1w/LisvKTtyZXR1cm4gdD90WzBdOiIifSxnZXRIYXNoOmZ1bmN0aW9uKHQpe3ZhciBlPSh0fHx0aGlzKS5sb2NhdGlvbi5ocmVmLm1hdGNoKC8jKC4qKSQvKTtyZXR1cm4gZT9lWzFdOiIifSxnZXRQYXRoOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5kZWNvZGVGcmFnbWVudCh0aGlzLmxvY2F0aW9uLnBhdGhuYW1lK3RoaXMuZ2V0U2VhcmNoKCkpLnNsaWNlKHRoaXMucm9vdC5sZW5ndGgtMSk7cmV0dXJuIi8iPT09dC5jaGFyQXQoMCk/dC5zbGljZSgxKTp0fSxnZXRGcmFnbWVudDpmdW5jdGlvbih0KXtyZXR1cm4gbnVsbD09dCYmKHQ9dGhpcy5fdXNlUHVzaFN0YXRlfHwhdGhpcy5fd2FudHNIYXNoQ2hhbmdlP3RoaXMuZ2V0UGF0aCgpOnRoaXMuZ2V0SGFzaCgpKSx0LnJlcGxhY2UoTiwiIil9LHN0YXJ0OmZ1bmN0aW9uKHQpe2lmKE8uc3RhcnRlZCl0aHJvdyBuZXcgRXJyb3IoIkJhY2tib25lLmhpc3RvcnkgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIik7aWYoTy5zdGFydGVkPSEwLHRoaXMub3B0aW9ucz1pLmV4dGVuZCh7cm9vdDoiLyJ9LHRoaXMub3B0aW9ucyx0KSx0aGlzLnJvb3Q9dGhpcy5vcHRpb25zLnJvb3QsdGhpcy5fd2FudHNIYXNoQ2hhbmdlPXRoaXMub3B0aW9ucy5oYXNoQ2hhbmdlIT09ITEsdGhpcy5faGFzSGFzaENoYW5nZT0ib25oYXNoY2hhbmdlImluIHdpbmRvdyx0aGlzLl91c2VIYXNoQ2hhbmdlPXRoaXMuX3dhbnRzSGFzaENoYW5nZSYmdGhpcy5faGFzSGFzaENoYW5nZSx0aGlzLl93YW50c1B1c2hTdGF0ZT0hIXRoaXMub3B0aW9ucy5wdXNoU3RhdGUsdGhpcy5faGFzUHVzaFN0YXRlPSEoIXRoaXMuaGlzdG9yeXx8IXRoaXMuaGlzdG9yeS5wdXNoU3RhdGUpLHRoaXMuX3VzZVB1c2hTdGF0ZT10aGlzLl93YW50c1B1c2hTdGF0ZSYmdGhpcy5faGFzUHVzaFN0YXRlLHRoaXMuZnJhZ21lbnQ9dGhpcy5nZXRGcmFnbWVudCgpLHRoaXMucm9vdD0oIi8iK3RoaXMucm9vdCsiLyIpLnJlcGxhY2UoSSwiLyIpLHRoaXMuX3dhbnRzSGFzaENoYW5nZSYmdGhpcy5fd2FudHNQdXNoU3RhdGUpe2lmKCF0aGlzLl9oYXNQdXNoU3RhdGUmJiF0aGlzLmF0Um9vdCgpKXt2YXIgZT10aGlzLnJvb3Quc2xpY2UoMCwtMSl8fCIvIjtyZXR1cm4gdGhpcy5sb2NhdGlvbi5yZXBsYWNlKGUrIiMiK3RoaXMuZ2V0UGF0aCgpKSwhMH10aGlzLl9oYXNQdXNoU3RhdGUmJnRoaXMuYXRSb290KCkmJnRoaXMubmF2aWdhdGUodGhpcy5nZXRIYXNoKCkse3JlcGxhY2U6ITB9KX1pZighdGhpcy5faGFzSGFzaENoYW5nZSYmdGhpcy5fd2FudHNIYXNoQ2hhbmdlJiYhdGhpcy5fdXNlUHVzaFN0YXRlKXt0aGlzLmlmcmFtZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKSx0aGlzLmlmcmFtZS5zcmM9ImphdmFzY3JpcHQ6MCIsdGhpcy5pZnJhbWUuc3R5bGUuZGlzcGxheT0ibm9uZSIsdGhpcy5pZnJhbWUudGFiSW5kZXg9LTE7dmFyIG49ZG9jdW1lbnQuYm9keSxyPW4uaW5zZXJ0QmVmb3JlKHRoaXMuaWZyYW1lLG4uZmlyc3RDaGlsZCkuY29udGVudFdpbmRvdztyLmRvY3VtZW50Lm9wZW4oKSxyLmRvY3VtZW50LmNsb3NlKCksci5sb2NhdGlvbi5oYXNoPSIjIit0aGlzLmZyYWdtZW50fXZhciBzPXdpbmRvdy5hZGRFdmVudExpc3RlbmVyfHxmdW5jdGlvbih0LGUpe3JldHVybiBhdHRhY2hFdmVudCgib24iK3QsZSl9O2lmKHRoaXMuX3VzZVB1c2hTdGF0ZT9zKCJwb3BzdGF0ZSIsdGhpcy5jaGVja1VybCwhMSk6dGhpcy5fdXNlSGFzaENoYW5nZSYmIXRoaXMuaWZyYW1lP3MoImhhc2hjaGFuZ2UiLHRoaXMuY2hlY2tVcmwsITEpOnRoaXMuX3dhbnRzSGFzaENoYW5nZSYmKHRoaXMuX2NoZWNrVXJsSW50ZXJ2YWw9c2V0SW50ZXJ2YWwodGhpcy5jaGVja1VybCx0aGlzLmludGVydmFsKSksIXRoaXMub3B0aW9ucy5zaWxlbnQpcmV0dXJuIHRoaXMubG9hZFVybCgpfSxzdG9wOmZ1bmN0aW9uKCl7dmFyIHQ9d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXJ8fGZ1bmN0aW9uKHQsZSl7cmV0dXJuIGRldGFjaEV2ZW50KCJvbiIrdCxlKX07dGhpcy5fdXNlUHVzaFN0YXRlP3QoInBvcHN0YXRlIix0aGlzLmNoZWNrVXJsLCExKTp0aGlzLl91c2VIYXNoQ2hhbmdlJiYhdGhpcy5pZnJhbWUmJnQoImhhc2hjaGFuZ2UiLHRoaXMuY2hlY2tVcmwsITEpLHRoaXMuaWZyYW1lJiYoZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzLmlmcmFtZSksdGhpcy5pZnJhbWU9bnVsbCksdGhpcy5fY2hlY2tVcmxJbnRlcnZhbCYmY2xlYXJJbnRlcnZhbCh0aGlzLl9jaGVja1VybEludGVydmFsKSxPLnN0YXJ0ZWQ9ITF9LHJvdXRlOmZ1bmN0aW9uKHQsZSl7dGhpcy5oYW5kbGVycy51bnNoaWZ0KHtyb3V0ZTp0LGNhbGxiYWNrOmV9KX0sY2hlY2tVcmw6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRGcmFnbWVudCgpO3JldHVybiBlPT09dGhpcy5mcmFnbWVudCYmdGhpcy5pZnJhbWUmJihlPXRoaXMuZ2V0SGFzaCh0aGlzLmlmcmFtZS5jb250ZW50V2luZG93KSksZSE9PXRoaXMuZnJhZ21lbnQmJih0aGlzLmlmcmFtZSYmdGhpcy5uYXZpZ2F0ZShlKSx2b2lkIHRoaXMubG9hZFVybCgpKX0sbG9hZFVybDpmdW5jdGlvbih0KXtyZXR1cm4hIXRoaXMubWF0Y2hSb290KCkmJih0PXRoaXMuZnJhZ21lbnQ9dGhpcy5nZXRGcmFnbWVudCh0KSxpLmFueSh0aGlzLmhhbmRsZXJzLGZ1bmN0aW9uKGUpe2lmKGUucm91dGUudGVzdCh0KSlyZXR1cm4gZS5jYWxsYmFjayh0KSwhMH0pKX0sbmF2aWdhdGU6ZnVuY3Rpb24odCxlKXtpZighTy5zdGFydGVkKXJldHVybiExO2UmJmUhPT0hMHx8KGU9e3RyaWdnZXI6ISFlfSksdD10aGlzLmdldEZyYWdtZW50KHR8fCIiKTt2YXIgaT10aGlzLnJvb3Q7IiIhPT10JiYiPyIhPT10LmNoYXJBdCgwKXx8KGk9aS5zbGljZSgwLC0xKXx8Ii8iKTt2YXIgbj1pK3Q7aWYodD10aGlzLmRlY29kZUZyYWdtZW50KHQucmVwbGFjZShQLCIiKSksdGhpcy5mcmFnbWVudCE9PXQpe2lmKHRoaXMuZnJhZ21lbnQ9dCx0aGlzLl91c2VQdXNoU3RhdGUpdGhpcy5oaXN0b3J5W2UucmVwbGFjZT8icmVwbGFjZVN0YXRlIjoicHVzaFN0YXRlIl0oe30sZG9jdW1lbnQudGl0bGUsbik7ZWxzZXtpZighdGhpcy5fd2FudHNIYXNoQ2hhbmdlKXJldHVybiB0aGlzLmxvY2F0aW9uLmFzc2lnbihuKTtpZih0aGlzLl91cGRhdGVIYXNoKHRoaXMubG9jYXRpb24sdCxlLnJlcGxhY2UpLHRoaXMuaWZyYW1lJiZ0IT09dGhpcy5nZXRIYXNoKHRoaXMuaWZyYW1lLmNvbnRlbnRXaW5kb3cpKXt2YXIgcj10aGlzLmlmcmFtZS5jb250ZW50V2luZG93O2UucmVwbGFjZXx8KHIuZG9jdW1lbnQub3BlbigpLHIuZG9jdW1lbnQuY2xvc2UoKSksdGhpcy5fdXBkYXRlSGFzaChyLmxvY2F0aW9uLHQsZS5yZXBsYWNlKX19cmV0dXJuIGUudHJpZ2dlcj90aGlzLmxvYWRVcmwodCk6dm9pZCAwfX0sX3VwZGF0ZUhhc2g6ZnVuY3Rpb24odCxlLGkpe2lmKGkpe3ZhciBuPXQuaHJlZi5yZXBsYWNlKC8oamF2YXNjcmlwdDp8IykuKiQvLCIiKTt0LnJlcGxhY2UobisiIyIrZSl9ZWxzZSB0Lmhhc2g9IiMiK2V9fSksZS5oaXN0b3J5PW5ldyBPO3ZhciBSPWZ1bmN0aW9uKHQsZSl7dmFyIG4scj10aGlzO249dCYmaS5oYXModCwiY29uc3RydWN0b3IiKT90LmNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7cmV0dXJuIHIuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxpLmV4dGVuZChuLHIsZSk7dmFyIHM9ZnVuY3Rpb24oKXt0aGlzLmNvbnN0cnVjdG9yPW59O3JldHVybiBzLnByb3RvdHlwZT1yLnByb3RvdHlwZSxuLnByb3RvdHlwZT1uZXcgcyx0JiZpLmV4dGVuZChuLnByb3RvdHlwZSx0KSxuLl9fc3VwZXJfXz1yLnByb3RvdHlwZSxufTtnLmV4dGVuZD15LmV4dGVuZD1FLmV4dGVuZD1ULmV4dGVuZD1PLmV4dGVuZD1SO3ZhciBIPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKCdBICJ1cmwiIHByb3BlcnR5IG9yIGZ1bmN0aW9uIG11c3QgYmUgc3BlY2lmaWVkJyl9LGo9ZnVuY3Rpb24odCxlKXt2YXIgaT1lLmVycm9yO2UuZXJyb3I9ZnVuY3Rpb24obil7aSYmaS5jYWxsKGUuY29udGV4dCx0LG4sZSksdC50cmlnZ2VyKCJlcnJvciIsdCxuLGUpfX07cmV0dXJuIGV9KX0pLmNhbGwoZSxmdW5jdGlvbigpe3JldHVybiB0aGlzfSgpKX0sZnVuY3Rpb24odCxlLGkpeyhmdW5jdGlvbih0KXshZnVuY3Rpb24oZSxpKXt0LmV4cG9ydHM9aSgpfSh0aGlzLGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUoKXtyZXR1cm4gWmkuYXBwbHkobnVsbCxhcmd1bWVudHMpfWZ1bmN0aW9uIG4odCl7Wmk9dH1mdW5jdGlvbiByKHQpe3JldHVybiB0IGluc3RhbmNlb2YgQXJyYXl8fCJbb2JqZWN0IEFycmF5XSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9ZnVuY3Rpb24gcyh0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIERhdGV8fCJbb2JqZWN0IERhdGVdIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX1mdW5jdGlvbiBvKHQsZSl7dmFyIGksbj1bXTtmb3IoaT0wO2k8dC5sZW5ndGg7KytpKW4ucHVzaChlKHRbaV0saSkpO3JldHVybiBufWZ1bmN0aW9uIGEodCxlKXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsZSl9ZnVuY3Rpb24gbCh0LGUpe2Zvcih2YXIgaSBpbiBlKWEoZSxpKSYmKHRbaV09ZVtpXSk7cmV0dXJuIGEoZSwidG9TdHJpbmciKSYmKHQudG9TdHJpbmc9ZS50b1N0cmluZyksYShlLCJ2YWx1ZU9mIikmJih0LnZhbHVlT2Y9ZS52YWx1ZU9mKSx0fWZ1bmN0aW9uIGModCxlLGksbil7cmV0dXJuIFB0KHQsZSxpLG4sITApLnV0YygpfWZ1bmN0aW9uIHUoKXtyZXR1cm57ZW1wdHk6ITEsdW51c2VkVG9rZW5zOltdLHVudXNlZElucHV0OltdLG92ZXJmbG93Oi0yLGNoYXJzTGVmdE92ZXI6MCxudWxsSW5wdXQ6ITEsaW52YWxpZE1vbnRoOm51bGwsaW52YWxpZEZvcm1hdDohMSx1c2VySW52YWxpZGF0ZWQ6ITEsaXNvOiExfX1mdW5jdGlvbiBkKHQpe3JldHVybiBudWxsPT10Ll9wZiYmKHQuX3BmPXUoKSksdC5fcGZ9ZnVuY3Rpb24gaCh0KXtpZihudWxsPT10Ll9pc1ZhbGlkKXt2YXIgZT1kKHQpO3QuX2lzVmFsaWQ9IShpc05hTih0Ll9kLmdldFRpbWUoKSl8fCEoZS5vdmVyZmxvdzwwKXx8ZS5lbXB0eXx8ZS5pbnZhbGlkTW9udGh8fGUuaW52YWxpZFdlZWtkYXl8fGUubnVsbElucHV0fHxlLmludmFsaWRGb3JtYXR8fGUudXNlckludmFsaWRhdGVkKSx0Ll9zdHJpY3QmJih0Ll9pc1ZhbGlkPXQuX2lzVmFsaWQmJjA9PT1lLmNoYXJzTGVmdE92ZXImJjA9PT1lLnVudXNlZFRva2Vucy5sZW5ndGgmJnZvaWQgMD09PWUuYmlnSG91cil9cmV0dXJuIHQuX2lzVmFsaWR9ZnVuY3Rpb24gcCh0KXt2YXIgZT1jKE5hTik7cmV0dXJuIG51bGwhPXQ/bChkKGUpLHQpOmQoZSkudXNlckludmFsaWRhdGVkPSEwLGV9ZnVuY3Rpb24gZih0KXtyZXR1cm4gdm9pZCAwPT09dH1mdW5jdGlvbiBtKHQsZSl7dmFyIGksbixyO2lmKGYoZS5faXNBTW9tZW50T2JqZWN0KXx8KHQuX2lzQU1vbWVudE9iamVjdD1lLl9pc0FNb21lbnRPYmplY3QpLGYoZS5faSl8fCh0Ll9pPWUuX2kpLGYoZS5fZil8fCh0Ll9mPWUuX2YpLGYoZS5fbCl8fCh0Ll9sPWUuX2wpLGYoZS5fc3RyaWN0KXx8KHQuX3N0cmljdD1lLl9zdHJpY3QpLGYoZS5fdHptKXx8KHQuX3R6bT1lLl90em0pLGYoZS5faXNVVEMpfHwodC5faXNVVEM9ZS5faXNVVEMpLGYoZS5fb2Zmc2V0KXx8KHQuX29mZnNldD1lLl9vZmZzZXQpLGYoZS5fcGYpfHwodC5fcGY9ZChlKSksZihlLl9sb2NhbGUpfHwodC5fbG9jYWxlPWUuX2xvY2FsZSksdG4ubGVuZ3RoPjApZm9yKGkgaW4gdG4pbj10bltpXSxyPWVbbl0sZihyKXx8KHRbbl09cik7cmV0dXJuIHR9ZnVuY3Rpb24gXyh0KXttKHRoaXMsdCksdGhpcy5fZD1uZXcgRGF0ZShudWxsIT10Ll9kP3QuX2QuZ2V0VGltZSgpOk5hTiksZW49PT0hMSYmKGVuPSEwLGUudXBkYXRlT2Zmc2V0KHRoaXMpLGVuPSExKX1mdW5jdGlvbiBnKHQpe3JldHVybiB0IGluc3RhbmNlb2YgX3x8bnVsbCE9dCYmbnVsbCE9dC5faXNBTW9tZW50T2JqZWN0fWZ1bmN0aW9uIHYodCl7cmV0dXJuIHQ8MD9NYXRoLmNlaWwodCk6TWF0aC5mbG9vcih0KX1mdW5jdGlvbiB5KHQpe3ZhciBlPSt0LGk9MDtyZXR1cm4gMCE9PWUmJmlzRmluaXRlKGUpJiYoaT12KGUpKSxpfWZ1bmN0aW9uIGIodCxlLGkpe3ZhciBuLHI9TWF0aC5taW4odC5sZW5ndGgsZS5sZW5ndGgpLHM9TWF0aC5hYnModC5sZW5ndGgtZS5sZW5ndGgpLG89MDtmb3Iobj0wO248cjtuKyspKGkmJnRbbl0hPT1lW25dfHwhaSYmeSh0W25dKSE9PXkoZVtuXSkpJiZvKys7cmV0dXJuIG8rc31mdW5jdGlvbiB3KHQpe2Uuc3VwcHJlc3NEZXByZWNhdGlvbldhcm5pbmdzPT09ITEmJiJ1bmRlZmluZWQiIT10eXBlb2YgY29uc29sZSYmY29uc29sZS53YXJuJiZjb25zb2xlLndhcm4oIkRlcHJlY2F0aW9uIHdhcm5pbmc6ICIrdCl9ZnVuY3Rpb24gTSh0LGUpe3ZhciBpPSEwO3JldHVybiBsKGZ1bmN0aW9uKCl7cmV0dXJuIGkmJih3KHQrIlxuQXJndW1lbnRzOiAiK0FycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykuam9pbigiLCAiKSsiXG4iKyhuZXcgRXJyb3IpLnN0YWNrKSxpPSExKSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZSl9ZnVuY3Rpb24gayh0LGUpe25uW3RdfHwodyhlKSxublt0XT0hMCl9ZnVuY3Rpb24gVCh0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIEZ1bmN0aW9ufHwiW29iamVjdCBGdW5jdGlvbl0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfWZ1bmN0aW9uIFModCl7cmV0dXJuIltvYmplY3QgT2JqZWN0XSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9ZnVuY3Rpb24gTCh0KXt2YXIgZSxpO2ZvcihpIGluIHQpZT10W2ldLFQoZSk/dGhpc1tpXT1lOnRoaXNbIl8iK2ldPWU7dGhpcy5fY29uZmlnPXQsdGhpcy5fb3JkaW5hbFBhcnNlTGVuaWVudD1uZXcgUmVnRXhwKHRoaXMuX29yZGluYWxQYXJzZS5zb3VyY2UrInwiKy9cZHsxLDJ9Ly5zb3VyY2UpfWZ1bmN0aW9uIHgodCxlKXt2YXIgaSxuPWwoe30sdCk7Zm9yKGkgaW4gZSlhKGUsaSkmJihTKHRbaV0pJiZTKGVbaV0pPyhuW2ldPXt9LGwobltpXSx0W2ldKSxsKG5baV0sZVtpXSkpOm51bGwhPWVbaV0/bltpXT1lW2ldOmRlbGV0ZSBuW2ldKTtyZXR1cm4gbn1mdW5jdGlvbiBFKHQpe251bGwhPXQmJnRoaXMuc2V0KHQpfWZ1bmN0aW9uIEQodCl7cmV0dXJuIHQ/dC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoIl8iLCItIik6dH1mdW5jdGlvbiBZKHQpe2Zvcih2YXIgZSxpLG4scixzPTA7czx0Lmxlbmd0aDspe2ZvcihyPUQodFtzXSkuc3BsaXQoIi0iKSxlPXIubGVuZ3RoLGk9RCh0W3MrMV0pLGk9aT9pLnNwbGl0KCItIik6bnVsbDtlPjA7KXtpZihuPUMoci5zbGljZSgwLGUpLmpvaW4oIi0iKSkpcmV0dXJuIG47aWYoaSYmaS5sZW5ndGg+PWUmJmIocixpLCEwKT49ZS0xKWJyZWFrO2UtLX1zKyt9cmV0dXJuIG51bGx9ZnVuY3Rpb24gQyhlKXt2YXIgbj1udWxsO2lmKCFzbltlXSYmInVuZGVmaW5lZCIhPXR5cGVvZiB0JiZ0JiZ0LmV4cG9ydHMpdHJ5e249cm4uX2FiYnIsaSgzOCkoIi4vIitlKSxBKG4pfWNhdGNoKHIpe31yZXR1cm4gc25bZV19ZnVuY3Rpb24gQSh0LGUpe3ZhciBpO3JldHVybiB0JiYoaT1mKGUpP0kodCk6Tyh0LGUpLGkmJihybj1pKSkscm4uX2FiYnJ9ZnVuY3Rpb24gTyh0LGUpe3JldHVybiBudWxsIT09ZT8oZS5hYmJyPXQsbnVsbCE9c25bdF0/KGsoImRlZmluZUxvY2FsZU92ZXJyaWRlIiwidXNlIG1vbWVudC51cGRhdGVMb2NhbGUobG9jYWxlTmFtZSwgY29uZmlnKSB0byBjaGFuZ2UgYW4gZXhpc3RpbmcgbG9jYWxlLiBtb21lbnQuZGVmaW5lTG9jYWxlKGxvY2FsZU5hbWUsIGNvbmZpZykgc2hvdWxkIG9ubHkgYmUgdXNlZCBmb3IgY3JlYXRpbmcgYSBuZXcgbG9jYWxlIiksZT14KHNuW3RdLl9jb25maWcsZSkpOm51bGwhPWUucGFyZW50TG9jYWxlJiYobnVsbCE9c25bZS5wYXJlbnRMb2NhbGVdP2U9eChzbltlLnBhcmVudExvY2FsZV0uX2NvbmZpZyxlKTprKCJwYXJlbnRMb2NhbGVVbmRlZmluZWQiLCJzcGVjaWZpZWQgcGFyZW50TG9jYWxlIGlzIG5vdCBkZWZpbmVkIHlldCIpKSxzblt0XT1uZXcgRShlKSxBKHQpLHNuW3RdKTooZGVsZXRlIHNuW3RdLG51bGwpfWZ1bmN0aW9uIE4odCxlKXtpZihudWxsIT1lKXt2YXIgaTtudWxsIT1zblt0XSYmKGU9eChzblt0XS5fY29uZmlnLGUpKSxpPW5ldyBFKGUpLGkucGFyZW50TG9jYWxlPXNuW3RdLHNuW3RdPWksQSh0KX1lbHNlIG51bGwhPXNuW3RdJiYobnVsbCE9c25bdF0ucGFyZW50TG9jYWxlP3NuW3RdPXNuW3RdLnBhcmVudExvY2FsZTpudWxsIT1zblt0XSYmZGVsZXRlIHNuW3RdKTtyZXR1cm4gc25bdF19ZnVuY3Rpb24gSSh0KXt2YXIgZTtpZih0JiZ0Ll9sb2NhbGUmJnQuX2xvY2FsZS5fYWJiciYmKHQ9dC5fbG9jYWxlLl9hYmJyKSwhdClyZXR1cm4gcm47aWYoIXIodCkpe2lmKGU9Qyh0KSlyZXR1cm4gZTt0PVt0XX1yZXR1cm4gWSh0KX1mdW5jdGlvbiBQKCl7cmV0dXJuIE9iamVjdC5rZXlzKHNuKX1mdW5jdGlvbiBSKHQsZSl7dmFyIGk9dC50b0xvd2VyQ2FzZSgpO29uW2ldPW9uW2krInMiXT1vbltlXT10fWZ1bmN0aW9uIEgodCl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiB0P29uW3RdfHxvblt0LnRvTG93ZXJDYXNlKCldOnZvaWQgMH1mdW5jdGlvbiBqKHQpe3ZhciBlLGksbj17fTtmb3IoaSBpbiB0KWEodCxpKSYmKGU9SChpKSxlJiYobltlXT10W2ldKSk7cmV0dXJuIG59ZnVuY3Rpb24gRih0LGkpe3JldHVybiBmdW5jdGlvbihuKXtyZXR1cm4gbnVsbCE9bj8oVyh0aGlzLHQsbiksZS51cGRhdGVPZmZzZXQodGhpcyxpKSx0aGlzKTpVKHRoaXMsdCl9fWZ1bmN0aW9uIFUodCxlKXtyZXR1cm4gdC5pc1ZhbGlkKCk/dC5fZFsiZ2V0IisodC5faXNVVEM/IlVUQyI6IiIpK2VdKCk6TmFOfWZ1bmN0aW9uIFcodCxlLGkpe3QuaXNWYWxpZCgpJiZ0Ll9kWyJzZXQiKyh0Ll9pc1VUQz8iVVRDIjoiIikrZV0oaSl9ZnVuY3Rpb24gQih0LGUpe3ZhciBpO2lmKCJvYmplY3QiPT10eXBlb2YgdClmb3IoaSBpbiB0KXRoaXMuc2V0KGksdFtpXSk7ZWxzZSBpZih0PUgodCksVCh0aGlzW3RdKSlyZXR1cm4gdGhpc1t0XShlKTtyZXR1cm4gdGhpc31mdW5jdGlvbiB6KHQsZSxpKXt2YXIgbj0iIitNYXRoLmFicyh0KSxyPWUtbi5sZW5ndGgscz10Pj0wO3JldHVybihzP2k/IisiOiIiOiItIikrTWF0aC5wb3coMTAsTWF0aC5tYXgoMCxyKSkudG9TdHJpbmcoKS5zdWJzdHIoMSkrbn1mdW5jdGlvbiBWKHQsZSxpLG4pe3ZhciByPW47InN0cmluZyI9PXR5cGVvZiBuJiYocj1mdW5jdGlvbigpe3JldHVybiB0aGlzW25dKCl9KSx0JiYodW5bdF09ciksZSYmKHVuW2VbMF1dPWZ1bmN0aW9uKCl7cmV0dXJuIHooci5hcHBseSh0aGlzLGFyZ3VtZW50cyksZVsxXSxlWzJdKX0pLGkmJih1bltpXT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS5vcmRpbmFsKHIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHQpfSl9ZnVuY3Rpb24gJCh0KXtyZXR1cm4gdC5tYXRjaCgvXFtbXHNcU10vKT90LnJlcGxhY2UoL15cW3xcXSQvZywiIik6dC5yZXBsYWNlKC9cXC9nLCIiKX1mdW5jdGlvbiBxKHQpe3ZhciBlLGksbj10Lm1hdGNoKGFuKTtmb3IoZT0wLGk9bi5sZW5ndGg7ZTxpO2UrKyl1bltuW2VdXT9uW2VdPXVuW25bZV1dOm5bZV09JChuW2VdKTtyZXR1cm4gZnVuY3Rpb24ocil7dmFyIHM9IiI7Zm9yKGU9MDtlPGk7ZSsrKXMrPW5bZV1pbnN0YW5jZW9mIEZ1bmN0aW9uP25bZV0uY2FsbChyLHQpOm5bZV07cmV0dXJuIHN9fWZ1bmN0aW9uIEcodCxlKXtyZXR1cm4gdC5pc1ZhbGlkKCk/KGU9SihlLHQubG9jYWxlRGF0YSgpKSxjbltlXT1jbltlXXx8cShlKSxjbltlXSh0KSk6dC5sb2NhbGVEYXRhKCkuaW52YWxpZERhdGUoKX1mdW5jdGlvbiBKKHQsZSl7ZnVuY3Rpb24gaSh0KXtyZXR1cm4gZS5sb25nRGF0ZUZvcm1hdCh0KXx8dH12YXIgbj01O2Zvcihsbi5sYXN0SW5kZXg9MDtuPj0wJiZsbi50ZXN0KHQpOyl0PXQucmVwbGFjZShsbixpKSxsbi5sYXN0SW5kZXg9MCxuLT0xO3JldHVybiB0fWZ1bmN0aW9uIEsodCxlLGkpe0VuW3RdPVQoZSk/ZTpmdW5jdGlvbih0LG4pe3JldHVybiB0JiZpP2k6ZX19ZnVuY3Rpb24gUSh0LGUpe3JldHVybiBhKEVuLHQpP0VuW3RdKGUuX3N0cmljdCxlLl9sb2NhbGUpOm5ldyBSZWdFeHAoWCh0KSl9ZnVuY3Rpb24gWCh0KXtyZXR1cm4gWih0LnJlcGxhY2UoIlxcIiwiIikucmVwbGFjZSgvXFwoXFspfFxcKFxdKXxcWyhbXlxdXFtdKilcXXxcXCguKS9nLGZ1bmN0aW9uKHQsZSxpLG4scil7cmV0dXJuIGV8fGl8fG58fHJ9KSl9ZnVuY3Rpb24gWih0KXtyZXR1cm4gdC5yZXBsYWNlKC9bLVwvXFxeJCorPy4oKXxbXF17fV0vZywiXFwkJiIpfWZ1bmN0aW9uIHR0KHQsZSl7dmFyIGksbj1lO2Zvcigic3RyaW5nIj09dHlwZW9mIHQmJih0PVt0XSksIm51bWJlciI9PXR5cGVvZiBlJiYobj1mdW5jdGlvbih0LGkpe2lbZV09eSh0KX0pLGk9MDtpPHQubGVuZ3RoO2krKylEblt0W2ldXT1ufWZ1bmN0aW9uIGV0KHQsZSl7dHQodCxmdW5jdGlvbih0LGksbixyKXtuLl93PW4uX3d8fHt9LGUodCxuLl93LG4scil9KX1mdW5jdGlvbiBpdCh0LGUsaSl7bnVsbCE9ZSYmYShEbix0KSYmRG5bdF0oZSxpLl9hLGksdCl9ZnVuY3Rpb24gbnQodCxlKXtyZXR1cm4gbmV3IERhdGUoRGF0ZS5VVEModCxlKzEsMCkpLmdldFVUQ0RhdGUoKX1mdW5jdGlvbiBydCh0LGUpe3JldHVybiByKHRoaXMuX21vbnRocyk/dGhpcy5fbW9udGhzW3QubW9udGgoKV06dGhpcy5fbW9udGhzW2puLnRlc3QoZSk/ImZvcm1hdCI6InN0YW5kYWxvbmUiXVt0Lm1vbnRoKCldfWZ1bmN0aW9uIHN0KHQsZSl7cmV0dXJuIHIodGhpcy5fbW9udGhzU2hvcnQpP3RoaXMuX21vbnRoc1Nob3J0W3QubW9udGgoKV06dGhpcy5fbW9udGhzU2hvcnRbam4udGVzdChlKT8iZm9ybWF0Ijoic3RhbmRhbG9uZSJdW3QubW9udGgoKV19ZnVuY3Rpb24gb3QodCxlLGkpe3ZhciBuLHIscztmb3IodGhpcy5fbW9udGhzUGFyc2V8fCh0aGlzLl9tb250aHNQYXJzZT1bXSx0aGlzLl9sb25nTW9udGhzUGFyc2U9W10sdGhpcy5fc2hvcnRNb250aHNQYXJzZT1bXSksbj0wO248MTI7bisrKXtpZihyPWMoWzJlMyxuXSksaSYmIXRoaXMuX2xvbmdNb250aHNQYXJzZVtuXSYmKHRoaXMuX2xvbmdNb250aHNQYXJzZVtuXT1uZXcgUmVnRXhwKCJeIit0aGlzLm1vbnRocyhyLCIiKS5yZXBsYWNlKCIuIiwiIikrIiQiLCJpIiksdGhpcy5fc2hvcnRNb250aHNQYXJzZVtuXT1uZXcgUmVnRXhwKCJeIit0aGlzLm1vbnRoc1Nob3J0KHIsIiIpLnJlcGxhY2UoIi4iLCIiKSsiJCIsImkiKSksaXx8dGhpcy5fbW9udGhzUGFyc2Vbbl18fChzPSJeIit0aGlzLm1vbnRocyhyLCIiKSsifF4iK3RoaXMubW9udGhzU2hvcnQociwiIiksdGhpcy5fbW9udGhzUGFyc2Vbbl09bmV3IFJlZ0V4cChzLnJlcGxhY2UoIi4iLCIiKSwiaSIpKSxpJiYiTU1NTSI9PT1lJiZ0aGlzLl9sb25nTW9udGhzUGFyc2Vbbl0udGVzdCh0KSlyZXR1cm4gbjtpZihpJiYiTU1NIj09PWUmJnRoaXMuX3Nob3J0TW9udGhzUGFyc2Vbbl0udGVzdCh0KSlyZXR1cm4gbjtpZighaSYmdGhpcy5fbW9udGhzUGFyc2Vbbl0udGVzdCh0KSlyZXR1cm4gbn19ZnVuY3Rpb24gYXQodCxlKXt2YXIgaTtpZighdC5pc1ZhbGlkKCkpcmV0dXJuIHQ7aWYoInN0cmluZyI9PXR5cGVvZiBlKWlmKC9eXGQrJC8udGVzdChlKSllPXkoZSk7ZWxzZSBpZihlPXQubG9jYWxlRGF0YSgpLm1vbnRoc1BhcnNlKGUpLCJudW1iZXIiIT10eXBlb2YgZSlyZXR1cm4gdDtyZXR1cm4gaT1NYXRoLm1pbih0LmRhdGUoKSxudCh0LnllYXIoKSxlKSksdC5fZFsic2V0IisodC5faXNVVEM/IlVUQyI6IiIpKyJNb250aCJdKGUsaSksdH1mdW5jdGlvbiBsdCh0KXtyZXR1cm4gbnVsbCE9dD8oYXQodGhpcyx0KSxlLnVwZGF0ZU9mZnNldCh0aGlzLCEwKSx0aGlzKTpVKHRoaXMsIk1vbnRoIil9ZnVuY3Rpb24gY3QoKXtyZXR1cm4gbnQodGhpcy55ZWFyKCksdGhpcy5tb250aCgpKX1mdW5jdGlvbiB1dCh0KXtyZXR1cm4gdGhpcy5fbW9udGhzUGFyc2VFeGFjdD8oYSh0aGlzLCJfbW9udGhzUmVnZXgiKXx8aHQuY2FsbCh0aGlzKSx0P3RoaXMuX21vbnRoc1Nob3J0U3RyaWN0UmVnZXg6dGhpcy5fbW9udGhzU2hvcnRSZWdleCk6dGhpcy5fbW9udGhzU2hvcnRTdHJpY3RSZWdleCYmdD90aGlzLl9tb250aHNTaG9ydFN0cmljdFJlZ2V4OnRoaXMuX21vbnRoc1Nob3J0UmVnZXh9ZnVuY3Rpb24gZHQodCl7cmV0dXJuIHRoaXMuX21vbnRoc1BhcnNlRXhhY3Q/KGEodGhpcywiX21vbnRoc1JlZ2V4Iil8fGh0LmNhbGwodGhpcyksdD90aGlzLl9tb250aHNTdHJpY3RSZWdleDp0aGlzLl9tb250aHNSZWdleCk6dGhpcy5fbW9udGhzU3RyaWN0UmVnZXgmJnQ/dGhpcy5fbW9udGhzU3RyaWN0UmVnZXg6dGhpcy5fbW9udGhzUmVnZXh9ZnVuY3Rpb24gaHQoKXtmdW5jdGlvbiB0KHQsZSl7cmV0dXJuIGUubGVuZ3RoLXQubGVuZ3RofXZhciBlLGksbj1bXSxyPVtdLHM9W107Zm9yKGU9MDtlPDEyO2UrKylpPWMoWzJlMyxlXSksbi5wdXNoKHRoaXMubW9udGhzU2hvcnQoaSwiIikpLHIucHVzaCh0aGlzLm1vbnRocyhpLCIiKSkscy5wdXNoKHRoaXMubW9udGhzKGksIiIpKSxzLnB1c2godGhpcy5tb250aHNTaG9ydChpLCIiKSk7Zm9yKG4uc29ydCh0KSxyLnNvcnQodCkscy5zb3J0KHQpLGU9MDtlPDEyO2UrKyluW2VdPVoobltlXSkscltlXT1aKHJbZV0pLHNbZV09WihzW2VdKTt0aGlzLl9tb250aHNSZWdleD1uZXcgUmVnRXhwKCJeKCIrcy5qb2luKCJ8IikrIikiLCJpIiksdGhpcy5fbW9udGhzU2hvcnRSZWdleD10aGlzLl9tb250aHNSZWdleCx0aGlzLl9tb250aHNTdHJpY3RSZWdleD1uZXcgUmVnRXhwKCJeKCIrci5qb2luKCJ8IikrIikkIiwiaSIpLHRoaXMuX21vbnRoc1Nob3J0U3RyaWN0UmVnZXg9bmV3IFJlZ0V4cCgiXigiK24uam9pbigifCIpKyIpJCIsImkiKX1mdW5jdGlvbiBwdCh0KXt2YXIgZSxpPXQuX2E7cmV0dXJuIGkmJmQodCkub3ZlcmZsb3c9PT0tMiYmKGU9aVtDbl08MHx8aVtDbl0+MTE/Q246aVtBbl08MXx8aVtBbl0+bnQoaVtZbl0saVtDbl0pP0FuOmlbT25dPDB8fGlbT25dPjI0fHwyND09PWlbT25dJiYoMCE9PWlbTm5dfHwwIT09aVtJbl18fDAhPT1pW1BuXSk/T246aVtObl08MHx8aVtObl0+NTk/Tm46aVtJbl08MHx8aVtJbl0+NTk/SW46aVtQbl08MHx8aVtQbl0+OTk5P1BuOi0xLGQodCkuX292ZXJmbG93RGF5T2ZZZWFyJiYoZTxZbnx8ZT5BbikmJihlPUFuKSxkKHQpLl9vdmVyZmxvd1dlZWtzJiZlPT09LTEmJihlPVJuKSxkKHQpLl9vdmVyZmxvd1dlZWtkYXkmJmU9PT0tMSYmKGU9SG4pLGQodCkub3ZlcmZsb3c9ZSksdH1mdW5jdGlvbiBmdCh0KXt2YXIgZSxpLG4scixzLG8sYT10Ll9pLGw9em4uZXhlYyhhKXx8Vm4uZXhlYyhhKTtpZihsKXtmb3IoZCh0KS5pc289ITAsZT0wLGk9cW4ubGVuZ3RoO2U8aTtlKyspaWYocW5bZV1bMV0uZXhlYyhsWzFdKSl7cj1xbltlXVswXSxuPXFuW2VdWzJdIT09ITE7YnJlYWt9aWYobnVsbD09cilyZXR1cm4gdm9pZCh0Ll9pc1ZhbGlkPSExKTtpZihsWzNdKXtmb3IoZT0wLGk9R24ubGVuZ3RoO2U8aTtlKyspaWYoR25bZV1bMV0uZXhlYyhsWzNdKSl7cz0obFsyXXx8IiAiKStHbltlXVswXTticmVha31pZihudWxsPT1zKXJldHVybiB2b2lkKHQuX2lzVmFsaWQ9ITEpfWlmKCFuJiZudWxsIT1zKXJldHVybiB2b2lkKHQuX2lzVmFsaWQ9ITEpO2lmKGxbNF0pe2lmKCEkbi5leGVjKGxbNF0pKXJldHVybiB2b2lkKHQuX2lzVmFsaWQ9ITEpO289IloifXQuX2Y9cisoc3x8IiIpKyhvfHwiIiksRHQodCl9ZWxzZSB0Ll9pc1ZhbGlkPSExfWZ1bmN0aW9uIG10KHQpe3ZhciBpPUpuLmV4ZWModC5faSk7cmV0dXJuIG51bGwhPT1pP3ZvaWQodC5fZD1uZXcgRGF0ZSgoK2lbMV0pKSk6KGZ0KHQpLHZvaWQodC5faXNWYWxpZD09PSExJiYoZGVsZXRlIHQuX2lzVmFsaWQsZS5jcmVhdGVGcm9tSW5wdXRGYWxsYmFjayh0KSkpKX1mdW5jdGlvbiBfdCh0LGUsaSxuLHIscyxvKXt2YXIgYT1uZXcgRGF0ZSh0LGUsaSxuLHIscyxvKTtyZXR1cm4gdDwxMDAmJnQ+PTAmJmlzRmluaXRlKGEuZ2V0RnVsbFllYXIoKSkmJmEuc2V0RnVsbFllYXIodCksYX1mdW5jdGlvbiBndCh0KXt2YXIgZT1uZXcgRGF0ZShEYXRlLlVUQy5hcHBseShudWxsLGFyZ3VtZW50cykpO3JldHVybiB0PDEwMCYmdD49MCYmaXNGaW5pdGUoZS5nZXRVVENGdWxsWWVhcigpKSYmZS5zZXRVVENGdWxsWWVhcih0KSxlfWZ1bmN0aW9uIHZ0KHQpe3JldHVybiB5dCh0KT8zNjY6MzY1fWZ1bmN0aW9uIHl0KHQpewoJcmV0dXJuIHQlND09PTAmJnQlMTAwIT09MHx8dCU0MDA9PT0wfWZ1bmN0aW9uIGJ0KCl7cmV0dXJuIHl0KHRoaXMueWVhcigpKX1mdW5jdGlvbiB3dCh0LGUsaSl7dmFyIG49NytlLWkscj0oNytndCh0LDAsbikuZ2V0VVRDRGF5KCktZSklNztyZXR1cm4tcituLTF9ZnVuY3Rpb24gTXQodCxlLGksbixyKXt2YXIgcyxvLGE9KDcraS1uKSU3LGw9d3QodCxuLHIpLGM9MSs3KihlLTEpK2ErbDtyZXR1cm4gYzw9MD8ocz10LTEsbz12dChzKStjKTpjPnZ0KHQpPyhzPXQrMSxvPWMtdnQodCkpOihzPXQsbz1jKSx7eWVhcjpzLGRheU9mWWVhcjpvfX1mdW5jdGlvbiBrdCh0LGUsaSl7dmFyIG4scixzPXd0KHQueWVhcigpLGUsaSksbz1NYXRoLmZsb29yKCh0LmRheU9mWWVhcigpLXMtMSkvNykrMTtyZXR1cm4gbzwxPyhyPXQueWVhcigpLTEsbj1vK1R0KHIsZSxpKSk6bz5UdCh0LnllYXIoKSxlLGkpPyhuPW8tVHQodC55ZWFyKCksZSxpKSxyPXQueWVhcigpKzEpOihyPXQueWVhcigpLG49bykse3dlZWs6bix5ZWFyOnJ9fWZ1bmN0aW9uIFR0KHQsZSxpKXt2YXIgbj13dCh0LGUsaSkscj13dCh0KzEsZSxpKTtyZXR1cm4odnQodCktbityKS83fWZ1bmN0aW9uIFN0KHQsZSxpKXtyZXR1cm4gbnVsbCE9dD90Om51bGwhPWU/ZTppfWZ1bmN0aW9uIEx0KHQpe3ZhciBpPW5ldyBEYXRlKGUubm93KCkpO3JldHVybiB0Ll91c2VVVEM/W2kuZ2V0VVRDRnVsbFllYXIoKSxpLmdldFVUQ01vbnRoKCksaS5nZXRVVENEYXRlKCldOltpLmdldEZ1bGxZZWFyKCksaS5nZXRNb250aCgpLGkuZ2V0RGF0ZSgpXX1mdW5jdGlvbiB4dCh0KXt2YXIgZSxpLG4scixzPVtdO2lmKCF0Ll9kKXtmb3Iobj1MdCh0KSx0Ll93JiZudWxsPT10Ll9hW0FuXSYmbnVsbD09dC5fYVtDbl0mJkV0KHQpLHQuX2RheU9mWWVhciYmKHI9U3QodC5fYVtZbl0sbltZbl0pLHQuX2RheU9mWWVhcj52dChyKSYmKGQodCkuX292ZXJmbG93RGF5T2ZZZWFyPSEwKSxpPWd0KHIsMCx0Ll9kYXlPZlllYXIpLHQuX2FbQ25dPWkuZ2V0VVRDTW9udGgoKSx0Ll9hW0FuXT1pLmdldFVUQ0RhdGUoKSksZT0wO2U8MyYmbnVsbD09dC5fYVtlXTsrK2UpdC5fYVtlXT1zW2VdPW5bZV07Zm9yKDtlPDc7ZSsrKXQuX2FbZV09c1tlXT1udWxsPT10Ll9hW2VdPzI9PT1lPzE6MDp0Ll9hW2VdOzI0PT09dC5fYVtPbl0mJjA9PT10Ll9hW05uXSYmMD09PXQuX2FbSW5dJiYwPT09dC5fYVtQbl0mJih0Ll9uZXh0RGF5PSEwLHQuX2FbT25dPTApLHQuX2Q9KHQuX3VzZVVUQz9ndDpfdCkuYXBwbHkobnVsbCxzKSxudWxsIT10Ll90em0mJnQuX2Quc2V0VVRDTWludXRlcyh0Ll9kLmdldFVUQ01pbnV0ZXMoKS10Ll90em0pLHQuX25leHREYXkmJih0Ll9hW09uXT0yNCl9fWZ1bmN0aW9uIEV0KHQpe3ZhciBlLGksbixyLHMsbyxhLGw7ZT10Ll93LG51bGwhPWUuR0d8fG51bGwhPWUuV3x8bnVsbCE9ZS5FPyhzPTEsbz00LGk9U3QoZS5HRyx0Ll9hW1luXSxrdChSdCgpLDEsNCkueWVhciksbj1TdChlLlcsMSkscj1TdChlLkUsMSksKHI8MXx8cj43KSYmKGw9ITApKToocz10Ll9sb2NhbGUuX3dlZWsuZG93LG89dC5fbG9jYWxlLl93ZWVrLmRveSxpPVN0KGUuZ2csdC5fYVtZbl0sa3QoUnQoKSxzLG8pLnllYXIpLG49U3QoZS53LDEpLG51bGwhPWUuZD8ocj1lLmQsKHI8MHx8cj42KSYmKGw9ITApKTpudWxsIT1lLmU/KHI9ZS5lK3MsKGUuZTwwfHxlLmU+NikmJihsPSEwKSk6cj1zKSxuPDF8fG4+VHQoaSxzLG8pP2QodCkuX292ZXJmbG93V2Vla3M9ITA6bnVsbCE9bD9kKHQpLl9vdmVyZmxvd1dlZWtkYXk9ITA6KGE9TXQoaSxuLHIscyxvKSx0Ll9hW1luXT1hLnllYXIsdC5fZGF5T2ZZZWFyPWEuZGF5T2ZZZWFyKX1mdW5jdGlvbiBEdCh0KXtpZih0Ll9mPT09ZS5JU09fODYwMSlyZXR1cm4gdm9pZCBmdCh0KTt0Ll9hPVtdLGQodCkuZW1wdHk9ITA7dmFyIGksbixyLHMsbyxhPSIiK3QuX2ksbD1hLmxlbmd0aCxjPTA7Zm9yKHI9Sih0Ll9mLHQuX2xvY2FsZSkubWF0Y2goYW4pfHxbXSxpPTA7aTxyLmxlbmd0aDtpKyspcz1yW2ldLG49KGEubWF0Y2goUShzLHQpKXx8W10pWzBdLG4mJihvPWEuc3Vic3RyKDAsYS5pbmRleE9mKG4pKSxvLmxlbmd0aD4wJiZkKHQpLnVudXNlZElucHV0LnB1c2gobyksYT1hLnNsaWNlKGEuaW5kZXhPZihuKStuLmxlbmd0aCksYys9bi5sZW5ndGgpLHVuW3NdPyhuP2QodCkuZW1wdHk9ITE6ZCh0KS51bnVzZWRUb2tlbnMucHVzaChzKSxpdChzLG4sdCkpOnQuX3N0cmljdCYmIW4mJmQodCkudW51c2VkVG9rZW5zLnB1c2gocyk7ZCh0KS5jaGFyc0xlZnRPdmVyPWwtYyxhLmxlbmd0aD4wJiZkKHQpLnVudXNlZElucHV0LnB1c2goYSksZCh0KS5iaWdIb3VyPT09ITAmJnQuX2FbT25dPD0xMiYmdC5fYVtPbl0+MCYmKGQodCkuYmlnSG91cj12b2lkIDApLHQuX2FbT25dPVl0KHQuX2xvY2FsZSx0Ll9hW09uXSx0Ll9tZXJpZGllbSkseHQodCkscHQodCl9ZnVuY3Rpb24gWXQodCxlLGkpe3ZhciBuO3JldHVybiBudWxsPT1pP2U6bnVsbCE9dC5tZXJpZGllbUhvdXI/dC5tZXJpZGllbUhvdXIoZSxpKTpudWxsIT10LmlzUE0/KG49dC5pc1BNKGkpLG4mJmU8MTImJihlKz0xMiksbnx8MTIhPT1lfHwoZT0wKSxlKTplfWZ1bmN0aW9uIEN0KHQpe3ZhciBlLGksbixyLHM7aWYoMD09PXQuX2YubGVuZ3RoKXJldHVybiBkKHQpLmludmFsaWRGb3JtYXQ9ITAsdm9pZCh0Ll9kPW5ldyBEYXRlKE5hTikpO2ZvcihyPTA7cjx0Ll9mLmxlbmd0aDtyKyspcz0wLGU9bSh7fSx0KSxudWxsIT10Ll91c2VVVEMmJihlLl91c2VVVEM9dC5fdXNlVVRDKSxlLl9mPXQuX2Zbcl0sRHQoZSksaChlKSYmKHMrPWQoZSkuY2hhcnNMZWZ0T3ZlcixzKz0xMCpkKGUpLnVudXNlZFRva2Vucy5sZW5ndGgsZChlKS5zY29yZT1zLChudWxsPT1ufHxzPG4pJiYobj1zLGk9ZSkpO2wodCxpfHxlKX1mdW5jdGlvbiBBdCh0KXtpZighdC5fZCl7dmFyIGU9aih0Ll9pKTt0Ll9hPW8oW2UueWVhcixlLm1vbnRoLGUuZGF5fHxlLmRhdGUsZS5ob3VyLGUubWludXRlLGUuc2Vjb25kLGUubWlsbGlzZWNvbmRdLGZ1bmN0aW9uKHQpe3JldHVybiB0JiZwYXJzZUludCh0LDEwKX0pLHh0KHQpfX1mdW5jdGlvbiBPdCh0KXt2YXIgZT1uZXcgXyhwdChOdCh0KSkpO3JldHVybiBlLl9uZXh0RGF5JiYoZS5hZGQoMSwiZCIpLGUuX25leHREYXk9dm9pZCAwKSxlfWZ1bmN0aW9uIE50KHQpe3ZhciBlPXQuX2ksaT10Ll9mO3JldHVybiB0Ll9sb2NhbGU9dC5fbG9jYWxlfHxJKHQuX2wpLG51bGw9PT1lfHx2b2lkIDA9PT1pJiYiIj09PWU/cCh7bnVsbElucHV0OiEwfSk6KCJzdHJpbmciPT10eXBlb2YgZSYmKHQuX2k9ZT10Ll9sb2NhbGUucHJlcGFyc2UoZSkpLGcoZSk/bmV3IF8ocHQoZSkpOihyKGkpP0N0KHQpOmk/RHQodCk6cyhlKT90Ll9kPWU6SXQodCksaCh0KXx8KHQuX2Q9bnVsbCksdCkpfWZ1bmN0aW9uIEl0KHQpe3ZhciBpPXQuX2k7dm9pZCAwPT09aT90Ll9kPW5ldyBEYXRlKGUubm93KCkpOnMoaSk/dC5fZD1uZXcgRGF0ZSgoK2kpKToic3RyaW5nIj09dHlwZW9mIGk/bXQodCk6cihpKT8odC5fYT1vKGkuc2xpY2UoMCksZnVuY3Rpb24odCl7cmV0dXJuIHBhcnNlSW50KHQsMTApfSkseHQodCkpOiJvYmplY3QiPT10eXBlb2YgaT9BdCh0KToibnVtYmVyIj09dHlwZW9mIGk/dC5fZD1uZXcgRGF0ZShpKTplLmNyZWF0ZUZyb21JbnB1dEZhbGxiYWNrKHQpfWZ1bmN0aW9uIFB0KHQsZSxpLG4scil7dmFyIHM9e307cmV0dXJuImJvb2xlYW4iPT10eXBlb2YgaSYmKG49aSxpPXZvaWQgMCkscy5faXNBTW9tZW50T2JqZWN0PSEwLHMuX3VzZVVUQz1zLl9pc1VUQz1yLHMuX2w9aSxzLl9pPXQscy5fZj1lLHMuX3N0cmljdD1uLE90KHMpfWZ1bmN0aW9uIFJ0KHQsZSxpLG4pe3JldHVybiBQdCh0LGUsaSxuLCExKX1mdW5jdGlvbiBIdCh0LGUpe3ZhciBpLG47aWYoMT09PWUubGVuZ3RoJiZyKGVbMF0pJiYoZT1lWzBdKSwhZS5sZW5ndGgpcmV0dXJuIFJ0KCk7Zm9yKGk9ZVswXSxuPTE7bjxlLmxlbmd0aDsrK24pZVtuXS5pc1ZhbGlkKCkmJiFlW25dW3RdKGkpfHwoaT1lW25dKTtyZXR1cm4gaX1mdW5jdGlvbiBqdCgpe3ZhciB0PVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApO3JldHVybiBIdCgiaXNCZWZvcmUiLHQpfWZ1bmN0aW9uIEZ0KCl7dmFyIHQ9W10uc2xpY2UuY2FsbChhcmd1bWVudHMsMCk7cmV0dXJuIEh0KCJpc0FmdGVyIix0KX1mdW5jdGlvbiBVdCh0KXt2YXIgZT1qKHQpLGk9ZS55ZWFyfHwwLG49ZS5xdWFydGVyfHwwLHI9ZS5tb250aHx8MCxzPWUud2Vla3x8MCxvPWUuZGF5fHwwLGE9ZS5ob3VyfHwwLGw9ZS5taW51dGV8fDAsYz1lLnNlY29uZHx8MCx1PWUubWlsbGlzZWNvbmR8fDA7dGhpcy5fbWlsbGlzZWNvbmRzPSt1KzFlMypjKzZlNCpsKzM2ZTUqYSx0aGlzLl9kYXlzPStvKzcqcyx0aGlzLl9tb250aHM9K3IrMypuKzEyKmksdGhpcy5fZGF0YT17fSx0aGlzLl9sb2NhbGU9SSgpLHRoaXMuX2J1YmJsZSgpfWZ1bmN0aW9uIFd0KHQpe3JldHVybiB0IGluc3RhbmNlb2YgVXR9ZnVuY3Rpb24gQnQodCxlKXtWKHQsMCwwLGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy51dGNPZmZzZXQoKSxpPSIrIjtyZXR1cm4gdDwwJiYodD0tdCxpPSItIiksaSt6KH5+KHQvNjApLDIpK2Ureih+fnQlNjAsMil9KX1mdW5jdGlvbiB6dCh0LGUpe3ZhciBpPShlfHwiIikubWF0Y2godCl8fFtdLG49aVtpLmxlbmd0aC0xXXx8W10scj0obisiIikubWF0Y2godHIpfHxbIi0iLDAsMF0scz0rKDYwKnJbMV0pK3koclsyXSk7cmV0dXJuIisiPT09clswXT9zOi1zfWZ1bmN0aW9uIFZ0KHQsaSl7dmFyIG4scjtyZXR1cm4gaS5faXNVVEM/KG49aS5jbG9uZSgpLHI9KGcodCl8fHModCk/K3Q6K1J0KHQpKS0rbixuLl9kLnNldFRpbWUoK24uX2QrciksZS51cGRhdGVPZmZzZXQobiwhMSksbik6UnQodCkubG9jYWwoKX1mdW5jdGlvbiAkdCh0KXtyZXR1cm4gMTUqLU1hdGgucm91bmQodC5fZC5nZXRUaW1lem9uZU9mZnNldCgpLzE1KX1mdW5jdGlvbiBxdCh0LGkpe3ZhciBuLHI9dGhpcy5fb2Zmc2V0fHwwO3JldHVybiB0aGlzLmlzVmFsaWQoKT9udWxsIT10Pygic3RyaW5nIj09dHlwZW9mIHQ/dD16dChTbix0KTpNYXRoLmFicyh0KTwxNiYmKHQ9NjAqdCksIXRoaXMuX2lzVVRDJiZpJiYobj0kdCh0aGlzKSksdGhpcy5fb2Zmc2V0PXQsdGhpcy5faXNVVEM9ITAsbnVsbCE9biYmdGhpcy5hZGQobiwibSIpLHIhPT10JiYoIWl8fHRoaXMuX2NoYW5nZUluUHJvZ3Jlc3M/dWUodGhpcyxyZSh0LXIsIm0iKSwxLCExKTp0aGlzLl9jaGFuZ2VJblByb2dyZXNzfHwodGhpcy5fY2hhbmdlSW5Qcm9ncmVzcz0hMCxlLnVwZGF0ZU9mZnNldCh0aGlzLCEwKSx0aGlzLl9jaGFuZ2VJblByb2dyZXNzPW51bGwpKSx0aGlzKTp0aGlzLl9pc1VUQz9yOiR0KHRoaXMpOm51bGwhPXQ/dGhpczpOYU59ZnVuY3Rpb24gR3QodCxlKXtyZXR1cm4gbnVsbCE9dD8oInN0cmluZyIhPXR5cGVvZiB0JiYodD0tdCksdGhpcy51dGNPZmZzZXQodCxlKSx0aGlzKTotdGhpcy51dGNPZmZzZXQoKX1mdW5jdGlvbiBKdCh0KXtyZXR1cm4gdGhpcy51dGNPZmZzZXQoMCx0KX1mdW5jdGlvbiBLdCh0KXtyZXR1cm4gdGhpcy5faXNVVEMmJih0aGlzLnV0Y09mZnNldCgwLHQpLHRoaXMuX2lzVVRDPSExLHQmJnRoaXMuc3VidHJhY3QoJHQodGhpcyksIm0iKSksdGhpc31mdW5jdGlvbiBRdCgpe3JldHVybiB0aGlzLl90em0/dGhpcy51dGNPZmZzZXQodGhpcy5fdHptKToic3RyaW5nIj09dHlwZW9mIHRoaXMuX2kmJnRoaXMudXRjT2Zmc2V0KHp0KFRuLHRoaXMuX2kpKSx0aGlzfWZ1bmN0aW9uIFh0KHQpe3JldHVybiEhdGhpcy5pc1ZhbGlkKCkmJih0PXQ/UnQodCkudXRjT2Zmc2V0KCk6MCwodGhpcy51dGNPZmZzZXQoKS10KSU2MD09PTApfWZ1bmN0aW9uIFp0KCl7cmV0dXJuIHRoaXMudXRjT2Zmc2V0KCk+dGhpcy5jbG9uZSgpLm1vbnRoKDApLnV0Y09mZnNldCgpfHx0aGlzLnV0Y09mZnNldCgpPnRoaXMuY2xvbmUoKS5tb250aCg1KS51dGNPZmZzZXQoKX1mdW5jdGlvbiB0ZSgpe2lmKCFmKHRoaXMuX2lzRFNUU2hpZnRlZCkpcmV0dXJuIHRoaXMuX2lzRFNUU2hpZnRlZDt2YXIgdD17fTtpZihtKHQsdGhpcyksdD1OdCh0KSx0Ll9hKXt2YXIgZT10Ll9pc1VUQz9jKHQuX2EpOlJ0KHQuX2EpO3RoaXMuX2lzRFNUU2hpZnRlZD10aGlzLmlzVmFsaWQoKSYmYih0Ll9hLGUudG9BcnJheSgpKT4wfWVsc2UgdGhpcy5faXNEU1RTaGlmdGVkPSExO3JldHVybiB0aGlzLl9pc0RTVFNoaWZ0ZWR9ZnVuY3Rpb24gZWUoKXtyZXR1cm4hIXRoaXMuaXNWYWxpZCgpJiYhdGhpcy5faXNVVEN9ZnVuY3Rpb24gaWUoKXtyZXR1cm4hIXRoaXMuaXNWYWxpZCgpJiZ0aGlzLl9pc1VUQ31mdW5jdGlvbiBuZSgpe3JldHVybiEhdGhpcy5pc1ZhbGlkKCkmJih0aGlzLl9pc1VUQyYmMD09PXRoaXMuX29mZnNldCl9ZnVuY3Rpb24gcmUodCxlKXt2YXIgaSxuLHIscz10LG89bnVsbDtyZXR1cm4gV3QodCk/cz17bXM6dC5fbWlsbGlzZWNvbmRzLGQ6dC5fZGF5cyxNOnQuX21vbnRoc306Im51bWJlciI9PXR5cGVvZiB0PyhzPXt9LGU/c1tlXT10OnMubWlsbGlzZWNvbmRzPXQpOihvPWVyLmV4ZWModCkpPyhpPSItIj09PW9bMV0/LTE6MSxzPXt5OjAsZDp5KG9bQW5dKSppLGg6eShvW09uXSkqaSxtOnkob1tObl0pKmksczp5KG9bSW5dKSppLG1zOnkob1tQbl0pKml9KToobz1pci5leGVjKHQpKT8oaT0iLSI9PT1vWzFdPy0xOjEscz17eTpzZShvWzJdLGkpLE06c2Uob1szXSxpKSx3OnNlKG9bNF0saSksZDpzZShvWzVdLGkpLGg6c2Uob1s2XSxpKSxtOnNlKG9bN10saSksczpzZShvWzhdLGkpfSk6bnVsbD09cz9zPXt9OiJvYmplY3QiPT10eXBlb2YgcyYmKCJmcm9tImluIHN8fCJ0byJpbiBzKSYmKHI9YWUoUnQocy5mcm9tKSxSdChzLnRvKSkscz17fSxzLm1zPXIubWlsbGlzZWNvbmRzLHMuTT1yLm1vbnRocyksbj1uZXcgVXQocyksV3QodCkmJmEodCwiX2xvY2FsZSIpJiYobi5fbG9jYWxlPXQuX2xvY2FsZSksbn1mdW5jdGlvbiBzZSh0LGUpe3ZhciBpPXQmJnBhcnNlRmxvYXQodC5yZXBsYWNlKCIsIiwiLiIpKTtyZXR1cm4oaXNOYU4oaSk/MDppKSplfWZ1bmN0aW9uIG9lKHQsZSl7dmFyIGk9e21pbGxpc2Vjb25kczowLG1vbnRoczowfTtyZXR1cm4gaS5tb250aHM9ZS5tb250aCgpLXQubW9udGgoKSsxMiooZS55ZWFyKCktdC55ZWFyKCkpLHQuY2xvbmUoKS5hZGQoaS5tb250aHMsIk0iKS5pc0FmdGVyKGUpJiYtLWkubW9udGhzLGkubWlsbGlzZWNvbmRzPStlLSt0LmNsb25lKCkuYWRkKGkubW9udGhzLCJNIiksaX1mdW5jdGlvbiBhZSh0LGUpe3ZhciBpO3JldHVybiB0LmlzVmFsaWQoKSYmZS5pc1ZhbGlkKCk/KGU9VnQoZSx0KSx0LmlzQmVmb3JlKGUpP2k9b2UodCxlKTooaT1vZShlLHQpLGkubWlsbGlzZWNvbmRzPS1pLm1pbGxpc2Vjb25kcyxpLm1vbnRocz0taS5tb250aHMpLGkpOnttaWxsaXNlY29uZHM6MCxtb250aHM6MH19ZnVuY3Rpb24gbGUodCl7cmV0dXJuIHQ8MD9NYXRoLnJvdW5kKC0xKnQpKi0xOk1hdGgucm91bmQodCl9ZnVuY3Rpb24gY2UodCxlKXtyZXR1cm4gZnVuY3Rpb24oaSxuKXt2YXIgcixzO3JldHVybiBudWxsPT09bnx8aXNOYU4oK24pfHwoayhlLCJtb21lbnQoKS4iK2UrIihwZXJpb2QsIG51bWJlcikgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSBtb21lbnQoKS4iK2UrIihudW1iZXIsIHBlcmlvZCkuIikscz1pLGk9bixuPXMpLGk9InN0cmluZyI9PXR5cGVvZiBpPytpOmkscj1yZShpLG4pLHVlKHRoaXMscix0KSx0aGlzfX1mdW5jdGlvbiB1ZSh0LGksbixyKXt2YXIgcz1pLl9taWxsaXNlY29uZHMsbz1sZShpLl9kYXlzKSxhPWxlKGkuX21vbnRocyk7dC5pc1ZhbGlkKCkmJihyPW51bGw9PXJ8fHIscyYmdC5fZC5zZXRUaW1lKCt0Ll9kK3MqbiksbyYmVyh0LCJEYXRlIixVKHQsIkRhdGUiKStvKm4pLGEmJmF0KHQsVSh0LCJNb250aCIpK2EqbiksciYmZS51cGRhdGVPZmZzZXQodCxvfHxhKSl9ZnVuY3Rpb24gZGUodCxlKXt2YXIgaT10fHxSdCgpLG49VnQoaSx0aGlzKS5zdGFydE9mKCJkYXkiKSxyPXRoaXMuZGlmZihuLCJkYXlzIiwhMCkscz1yPC02PyJzYW1lRWxzZSI6cjwtMT8ibGFzdFdlZWsiOnI8MD8ibGFzdERheSI6cjwxPyJzYW1lRGF5IjpyPDI/Im5leHREYXkiOnI8Nz8ibmV4dFdlZWsiOiJzYW1lRWxzZSIsbz1lJiYoVChlW3NdKT9lW3NdKCk6ZVtzXSk7cmV0dXJuIHRoaXMuZm9ybWF0KG98fHRoaXMubG9jYWxlRGF0YSgpLmNhbGVuZGFyKHMsdGhpcyxSdChpKSkpfWZ1bmN0aW9uIGhlKCl7cmV0dXJuIG5ldyBfKHRoaXMpfWZ1bmN0aW9uIHBlKHQsZSl7dmFyIGk9Zyh0KT90OlJ0KHQpO3JldHVybiEoIXRoaXMuaXNWYWxpZCgpfHwhaS5pc1ZhbGlkKCkpJiYoZT1IKGYoZSk/Im1pbGxpc2Vjb25kIjplKSwibWlsbGlzZWNvbmQiPT09ZT8rdGhpcz4raToraTwrdGhpcy5jbG9uZSgpLnN0YXJ0T2YoZSkpfWZ1bmN0aW9uIGZlKHQsZSl7dmFyIGk9Zyh0KT90OlJ0KHQpO3JldHVybiEoIXRoaXMuaXNWYWxpZCgpfHwhaS5pc1ZhbGlkKCkpJiYoZT1IKGYoZSk/Im1pbGxpc2Vjb25kIjplKSwibWlsbGlzZWNvbmQiPT09ZT8rdGhpczwraTordGhpcy5jbG9uZSgpLmVuZE9mKGUpPCtpKX1mdW5jdGlvbiBtZSh0LGUsaSl7cmV0dXJuIHRoaXMuaXNBZnRlcih0LGkpJiZ0aGlzLmlzQmVmb3JlKA==", "base64"));
  res.write(new Buffer("ZSxpKX1mdW5jdGlvbiBfZSh0LGUpe3ZhciBpLG49Zyh0KT90OlJ0KHQpO3JldHVybiEoIXRoaXMuaXNWYWxpZCgpfHwhbi5pc1ZhbGlkKCkpJiYoZT1IKGV8fCJtaWxsaXNlY29uZCIpLCJtaWxsaXNlY29uZCI9PT1lPyt0aGlzPT09K246KGk9K24sK3RoaXMuY2xvbmUoKS5zdGFydE9mKGUpPD1pJiZpPD0rdGhpcy5jbG9uZSgpLmVuZE9mKGUpKSl9ZnVuY3Rpb24gZ2UodCxlKXtyZXR1cm4gdGhpcy5pc1NhbWUodCxlKXx8dGhpcy5pc0FmdGVyKHQsZSl9ZnVuY3Rpb24gdmUodCxlKXtyZXR1cm4gdGhpcy5pc1NhbWUodCxlKXx8dGhpcy5pc0JlZm9yZSh0LGUpfWZ1bmN0aW9uIHllKHQsZSxpKXt2YXIgbixyLHMsbztyZXR1cm4gdGhpcy5pc1ZhbGlkKCk/KG49VnQodCx0aGlzKSxuLmlzVmFsaWQoKT8ocj02ZTQqKG4udXRjT2Zmc2V0KCktdGhpcy51dGNPZmZzZXQoKSksZT1IKGUpLCJ5ZWFyIj09PWV8fCJtb250aCI9PT1lfHwicXVhcnRlciI9PT1lPyhvPWJlKHRoaXMsbiksInF1YXJ0ZXIiPT09ZT9vLz0zOiJ5ZWFyIj09PWUmJihvLz0xMikpOihzPXRoaXMtbixvPSJzZWNvbmQiPT09ZT9zLzFlMzoibWludXRlIj09PWU/cy82ZTQ6ImhvdXIiPT09ZT9zLzM2ZTU6ImRheSI9PT1lPyhzLXIpLzg2NGU1OiJ3ZWVrIj09PWU/KHMtcikvNjA0OGU1OnMpLGk/bzp2KG8pKTpOYU4pOk5hTn1mdW5jdGlvbiBiZSh0LGUpe3ZhciBpLG4scj0xMiooZS55ZWFyKCktdC55ZWFyKCkpKyhlLm1vbnRoKCktdC5tb250aCgpKSxzPXQuY2xvbmUoKS5hZGQociwibW9udGhzIik7cmV0dXJuIGUtczwwPyhpPXQuY2xvbmUoKS5hZGQoci0xLCJtb250aHMiKSxuPShlLXMpLyhzLWkpKTooaT10LmNsb25lKCkuYWRkKHIrMSwibW9udGhzIiksbj0oZS1zKS8oaS1zKSksLShyK24pfWZ1bmN0aW9uIHdlKCl7cmV0dXJuIHRoaXMuY2xvbmUoKS5sb2NhbGUoImVuIikuZm9ybWF0KCJkZGQgTU1NIEREIFlZWVkgSEg6bW06c3MgW0dNVF1aWiIpfWZ1bmN0aW9uIE1lKCl7dmFyIHQ9dGhpcy5jbG9uZSgpLnV0YygpO3JldHVybiAwPHQueWVhcigpJiZ0LnllYXIoKTw9OTk5OT9UKERhdGUucHJvdG90eXBlLnRvSVNPU3RyaW5nKT90aGlzLnRvRGF0ZSgpLnRvSVNPU3RyaW5nKCk6Ryh0LCJZWVlZLU1NLUREW1RdSEg6bW06c3MuU1NTW1pdIik6Ryh0LCJZWVlZWVktTU0tRERbVF1ISDptbTpzcy5TU1NbWl0iKX1mdW5jdGlvbiBrZSh0KXt2YXIgaT1HKHRoaXMsdHx8ZS5kZWZhdWx0Rm9ybWF0KTtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkucG9zdGZvcm1hdChpKX1mdW5jdGlvbiBUZSh0LGUpe3JldHVybiB0aGlzLmlzVmFsaWQoKSYmKGcodCkmJnQuaXNWYWxpZCgpfHxSdCh0KS5pc1ZhbGlkKCkpP3JlKHt0bzp0aGlzLGZyb206dH0pLmxvY2FsZSh0aGlzLmxvY2FsZSgpKS5odW1hbml6ZSghZSk6dGhpcy5sb2NhbGVEYXRhKCkuaW52YWxpZERhdGUoKX1mdW5jdGlvbiBTZSh0KXtyZXR1cm4gdGhpcy5mcm9tKFJ0KCksdCl9ZnVuY3Rpb24gTGUodCxlKXtyZXR1cm4gdGhpcy5pc1ZhbGlkKCkmJihnKHQpJiZ0LmlzVmFsaWQoKXx8UnQodCkuaXNWYWxpZCgpKT9yZSh7ZnJvbTp0aGlzLHRvOnR9KS5sb2NhbGUodGhpcy5sb2NhbGUoKSkuaHVtYW5pemUoIWUpOnRoaXMubG9jYWxlRGF0YSgpLmludmFsaWREYXRlKCl9ZnVuY3Rpb24geGUodCl7cmV0dXJuIHRoaXMudG8oUnQoKSx0KX1mdW5jdGlvbiBFZSh0KXt2YXIgZTtyZXR1cm4gdm9pZCAwPT09dD90aGlzLl9sb2NhbGUuX2FiYnI6KGU9SSh0KSxudWxsIT1lJiYodGhpcy5fbG9jYWxlPWUpLHRoaXMpfWZ1bmN0aW9uIERlKCl7cmV0dXJuIHRoaXMuX2xvY2FsZX1mdW5jdGlvbiBZZSh0KXtzd2l0Y2godD1IKHQpKXtjYXNlInllYXIiOnRoaXMubW9udGgoMCk7Y2FzZSJxdWFydGVyIjpjYXNlIm1vbnRoIjp0aGlzLmRhdGUoMSk7Y2FzZSJ3ZWVrIjpjYXNlImlzb1dlZWsiOmNhc2UiZGF5Ijp0aGlzLmhvdXJzKDApO2Nhc2UiaG91ciI6dGhpcy5taW51dGVzKDApO2Nhc2UibWludXRlIjp0aGlzLnNlY29uZHMoMCk7Y2FzZSJzZWNvbmQiOnRoaXMubWlsbGlzZWNvbmRzKDApfXJldHVybiJ3ZWVrIj09PXQmJnRoaXMud2Vla2RheSgwKSwiaXNvV2VlayI9PT10JiZ0aGlzLmlzb1dlZWtkYXkoMSksInF1YXJ0ZXIiPT09dCYmdGhpcy5tb250aCgzKk1hdGguZmxvb3IodGhpcy5tb250aCgpLzMpKSx0aGlzfWZ1bmN0aW9uIENlKHQpe3JldHVybiB0PUgodCksdm9pZCAwPT09dHx8Im1pbGxpc2Vjb25kIj09PXQ/dGhpczp0aGlzLnN0YXJ0T2YodCkuYWRkKDEsImlzb1dlZWsiPT09dD8id2VlayI6dCkuc3VidHJhY3QoMSwibXMiKX1mdW5jdGlvbiBBZSgpe3JldHVybit0aGlzLl9kLTZlNCoodGhpcy5fb2Zmc2V0fHwwKX1mdW5jdGlvbiBPZSgpe3JldHVybiBNYXRoLmZsb29yKCt0aGlzLzFlMyl9ZnVuY3Rpb24gTmUoKXtyZXR1cm4gdGhpcy5fb2Zmc2V0P25ldyBEYXRlKCgrdGhpcykpOnRoaXMuX2R9ZnVuY3Rpb24gSWUoKXt2YXIgdD10aGlzO3JldHVyblt0LnllYXIoKSx0Lm1vbnRoKCksdC5kYXRlKCksdC5ob3VyKCksdC5taW51dGUoKSx0LnNlY29uZCgpLHQubWlsbGlzZWNvbmQoKV19ZnVuY3Rpb24gUGUoKXt2YXIgdD10aGlzO3JldHVybnt5ZWFyczp0LnllYXIoKSxtb250aHM6dC5tb250aCgpLGRhdGU6dC5kYXRlKCksaG91cnM6dC5ob3VycygpLG1pbnV0ZXM6dC5taW51dGVzKCksc2Vjb25kczp0LnNlY29uZHMoKSxtaWxsaXNlY29uZHM6dC5taWxsaXNlY29uZHMoKX19ZnVuY3Rpb24gUmUoKXtyZXR1cm4gdGhpcy5pc1ZhbGlkKCk/dGhpcy50b0lTT1N0cmluZygpOm51bGx9ZnVuY3Rpb24gSGUoKXtyZXR1cm4gaCh0aGlzKX1mdW5jdGlvbiBqZSgpe3JldHVybiBsKHt9LGQodGhpcykpfWZ1bmN0aW9uIEZlKCl7cmV0dXJuIGQodGhpcykub3ZlcmZsb3d9ZnVuY3Rpb24gVWUoKXtyZXR1cm57aW5wdXQ6dGhpcy5faSxmb3JtYXQ6dGhpcy5fZixsb2NhbGU6dGhpcy5fbG9jYWxlLGlzVVRDOnRoaXMuX2lzVVRDLHN0cmljdDp0aGlzLl9zdHJpY3R9fWZ1bmN0aW9uIFdlKHQsZSl7VigwLFt0LHQubGVuZ3RoXSwwLGUpfWZ1bmN0aW9uIEJlKHQpe3JldHVybiBxZS5jYWxsKHRoaXMsdCx0aGlzLndlZWsoKSx0aGlzLndlZWtkYXkoKSx0aGlzLmxvY2FsZURhdGEoKS5fd2Vlay5kb3csdGhpcy5sb2NhbGVEYXRhKCkuX3dlZWsuZG95KX1mdW5jdGlvbiB6ZSh0KXtyZXR1cm4gcWUuY2FsbCh0aGlzLHQsdGhpcy5pc29XZWVrKCksdGhpcy5pc29XZWVrZGF5KCksMSw0KX1mdW5jdGlvbiBWZSgpe3JldHVybiBUdCh0aGlzLnllYXIoKSwxLDQpfWZ1bmN0aW9uICRlKCl7dmFyIHQ9dGhpcy5sb2NhbGVEYXRhKCkuX3dlZWs7cmV0dXJuIFR0KHRoaXMueWVhcigpLHQuZG93LHQuZG95KX1mdW5jdGlvbiBxZSh0LGUsaSxuLHIpe3ZhciBzO3JldHVybiBudWxsPT10P2t0KHRoaXMsbixyKS55ZWFyOihzPVR0KHQsbixyKSxlPnMmJihlPXMpLEdlLmNhbGwodGhpcyx0LGUsaSxuLHIpKX1mdW5jdGlvbiBHZSh0LGUsaSxuLHIpe3ZhciBzPU10KHQsZSxpLG4sciksbz1ndChzLnllYXIsMCxzLmRheU9mWWVhcik7cmV0dXJuIHRoaXMueWVhcihvLmdldFVUQ0Z1bGxZZWFyKCkpLHRoaXMubW9udGgoby5nZXRVVENNb250aCgpKSx0aGlzLmRhdGUoby5nZXRVVENEYXRlKCkpLHRoaXN9ZnVuY3Rpb24gSmUodCl7cmV0dXJuIG51bGw9PXQ/TWF0aC5jZWlsKCh0aGlzLm1vbnRoKCkrMSkvMyk6dGhpcy5tb250aCgzKih0LTEpK3RoaXMubW9udGgoKSUzKX1mdW5jdGlvbiBLZSh0KXtyZXR1cm4ga3QodCx0aGlzLl93ZWVrLmRvdyx0aGlzLl93ZWVrLmRveSkud2Vla31mdW5jdGlvbiBRZSgpe3JldHVybiB0aGlzLl93ZWVrLmRvd31mdW5jdGlvbiBYZSgpe3JldHVybiB0aGlzLl93ZWVrLmRveX1mdW5jdGlvbiBaZSh0KXt2YXIgZT10aGlzLmxvY2FsZURhdGEoKS53ZWVrKHRoaXMpO3JldHVybiBudWxsPT10P2U6dGhpcy5hZGQoNyoodC1lKSwiZCIpfWZ1bmN0aW9uIHRpKHQpe3ZhciBlPWt0KHRoaXMsMSw0KS53ZWVrO3JldHVybiBudWxsPT10P2U6dGhpcy5hZGQoNyoodC1lKSwiZCIpfWZ1bmN0aW9uIGVpKHQsZSl7cmV0dXJuInN0cmluZyIhPXR5cGVvZiB0P3Q6aXNOYU4odCk/KHQ9ZS53ZWVrZGF5c1BhcnNlKHQpLCJudW1iZXIiPT10eXBlb2YgdD90Om51bGwpOnBhcnNlSW50KHQsMTApfWZ1bmN0aW9uIGlpKHQsZSl7cmV0dXJuIHIodGhpcy5fd2Vla2RheXMpP3RoaXMuX3dlZWtkYXlzW3QuZGF5KCldOnRoaXMuX3dlZWtkYXlzW3RoaXMuX3dlZWtkYXlzLmlzRm9ybWF0LnRlc3QoZSk/ImZvcm1hdCI6InN0YW5kYWxvbmUiXVt0LmRheSgpXX1mdW5jdGlvbiBuaSh0KXtyZXR1cm4gdGhpcy5fd2Vla2RheXNTaG9ydFt0LmRheSgpXX1mdW5jdGlvbiByaSh0KXtyZXR1cm4gdGhpcy5fd2Vla2RheXNNaW5bdC5kYXkoKV19ZnVuY3Rpb24gc2kodCxlLGkpe3ZhciBuLHIscztmb3IodGhpcy5fd2Vla2RheXNQYXJzZXx8KHRoaXMuX3dlZWtkYXlzUGFyc2U9W10sdGhpcy5fbWluV2Vla2RheXNQYXJzZT1bXSx0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2U9W10sdGhpcy5fZnVsbFdlZWtkYXlzUGFyc2U9W10pLG49MDtuPDc7bisrKXtpZihyPVJ0KFsyZTMsMV0pLmRheShuKSxpJiYhdGhpcy5fZnVsbFdlZWtkYXlzUGFyc2Vbbl0mJih0aGlzLl9mdWxsV2Vla2RheXNQYXJzZVtuXT1uZXcgUmVnRXhwKCJeIit0aGlzLndlZWtkYXlzKHIsIiIpLnJlcGxhY2UoIi4iLCIuPyIpKyIkIiwiaSIpLHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZVtuXT1uZXcgUmVnRXhwKCJeIit0aGlzLndlZWtkYXlzU2hvcnQociwiIikucmVwbGFjZSgiLiIsIi4/IikrIiQiLCJpIiksdGhpcy5fbWluV2Vla2RheXNQYXJzZVtuXT1uZXcgUmVnRXhwKCJeIit0aGlzLndlZWtkYXlzTWluKHIsIiIpLnJlcGxhY2UoIi4iLCIuPyIpKyIkIiwiaSIpKSx0aGlzLl93ZWVrZGF5c1BhcnNlW25dfHwocz0iXiIrdGhpcy53ZWVrZGF5cyhyLCIiKSsifF4iK3RoaXMud2Vla2RheXNTaG9ydChyLCIiKSsifF4iK3RoaXMud2Vla2RheXNNaW4ociwiIiksdGhpcy5fd2Vla2RheXNQYXJzZVtuXT1uZXcgUmVnRXhwKHMucmVwbGFjZSgiLiIsIiIpLCJpIikpLGkmJiJkZGRkIj09PWUmJnRoaXMuX2Z1bGxXZWVrZGF5c1BhcnNlW25dLnRlc3QodCkpcmV0dXJuIG47aWYoaSYmImRkZCI9PT1lJiZ0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2Vbbl0udGVzdCh0KSlyZXR1cm4gbjtpZihpJiYiZGQiPT09ZSYmdGhpcy5fbWluV2Vla2RheXNQYXJzZVtuXS50ZXN0KHQpKXJldHVybiBuO2lmKCFpJiZ0aGlzLl93ZWVrZGF5c1BhcnNlW25dLnRlc3QodCkpcmV0dXJuIG59fWZ1bmN0aW9uIG9pKHQpe2lmKCF0aGlzLmlzVmFsaWQoKSlyZXR1cm4gbnVsbCE9dD90aGlzOk5hTjt2YXIgZT10aGlzLl9pc1VUQz90aGlzLl9kLmdldFVUQ0RheSgpOnRoaXMuX2QuZ2V0RGF5KCk7cmV0dXJuIG51bGwhPXQ/KHQ9ZWkodCx0aGlzLmxvY2FsZURhdGEoKSksdGhpcy5hZGQodC1lLCJkIikpOmV9ZnVuY3Rpb24gYWkodCl7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiBudWxsIT10P3RoaXM6TmFOO3ZhciBlPSh0aGlzLmRheSgpKzctdGhpcy5sb2NhbGVEYXRhKCkuX3dlZWsuZG93KSU3O3JldHVybiBudWxsPT10P2U6dGhpcy5hZGQodC1lLCJkIil9ZnVuY3Rpb24gbGkodCl7cmV0dXJuIHRoaXMuaXNWYWxpZCgpP251bGw9PXQ/dGhpcy5kYXkoKXx8Nzp0aGlzLmRheSh0aGlzLmRheSgpJTc/dDp0LTcpOm51bGwhPXQ/dGhpczpOYU59ZnVuY3Rpb24gY2kodCl7dmFyIGU9TWF0aC5yb3VuZCgodGhpcy5jbG9uZSgpLnN0YXJ0T2YoImRheSIpLXRoaXMuY2xvbmUoKS5zdGFydE9mKCJ5ZWFyIikpLzg2NGU1KSsxO3JldHVybiBudWxsPT10P2U6dGhpcy5hZGQodC1lLCJkIil9ZnVuY3Rpb24gdWkoKXtyZXR1cm4gdGhpcy5ob3VycygpJTEyfHwxMn1mdW5jdGlvbiBkaSh0LGUpe1YodCwwLDAsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkubWVyaWRpZW0odGhpcy5ob3VycygpLHRoaXMubWludXRlcygpLGUpfSl9ZnVuY3Rpb24gaGkodCxlKXtyZXR1cm4gZS5fbWVyaWRpZW1QYXJzZX1mdW5jdGlvbiBwaSh0KXtyZXR1cm4icCI9PT0odCsiIikudG9Mb3dlckNhc2UoKS5jaGFyQXQoMCl9ZnVuY3Rpb24gZmkodCxlLGkpe3JldHVybiB0PjExP2k/InBtIjoiUE0iOmk/ImFtIjoiQU0ifWZ1bmN0aW9uIG1pKHQsZSl7ZVtQbl09eSgxZTMqKCIwLiIrdCkpfWZ1bmN0aW9uIF9pKCl7cmV0dXJuIHRoaXMuX2lzVVRDPyJVVEMiOiIifWZ1bmN0aW9uIGdpKCl7cmV0dXJuIHRoaXMuX2lzVVRDPyJDb29yZGluYXRlZCBVbml2ZXJzYWwgVGltZSI6IiJ9ZnVuY3Rpb24gdmkodCl7cmV0dXJuIFJ0KDFlMyp0KX1mdW5jdGlvbiB5aSgpe3JldHVybiBSdC5hcHBseShudWxsLGFyZ3VtZW50cykucGFyc2Vab25lKCl9ZnVuY3Rpb24gYmkodCxlLGkpe3ZhciBuPXRoaXMuX2NhbGVuZGFyW3RdO3JldHVybiBUKG4pP24uY2FsbChlLGkpOm59ZnVuY3Rpb24gd2kodCl7dmFyIGU9dGhpcy5fbG9uZ0RhdGVGb3JtYXRbdF0saT10aGlzLl9sb25nRGF0ZUZvcm1hdFt0LnRvVXBwZXJDYXNlKCldO3JldHVybiBlfHwhaT9lOih0aGlzLl9sb25nRGF0ZUZvcm1hdFt0XT1pLnJlcGxhY2UoL01NTU18TU18RER8ZGRkZC9nLGZ1bmN0aW9uKHQpe3JldHVybiB0LnNsaWNlKDEpfSksdGhpcy5fbG9uZ0RhdGVGb3JtYXRbdF0pfWZ1bmN0aW9uIE1pKCl7cmV0dXJuIHRoaXMuX2ludmFsaWREYXRlfWZ1bmN0aW9uIGtpKHQpe3JldHVybiB0aGlzLl9vcmRpbmFsLnJlcGxhY2UoIiVkIix0KX1mdW5jdGlvbiBUaSh0KXtyZXR1cm4gdH1mdW5jdGlvbiBTaSh0LGUsaSxuKXt2YXIgcj10aGlzLl9yZWxhdGl2ZVRpbWVbaV07cmV0dXJuIFQocik/cih0LGUsaSxuKTpyLnJlcGxhY2UoLyVkL2ksdCl9ZnVuY3Rpb24gTGkodCxlKXt2YXIgaT10aGlzLl9yZWxhdGl2ZVRpbWVbdD4wPyJmdXR1cmUiOiJwYXN0Il07cmV0dXJuIFQoaSk/aShlKTppLnJlcGxhY2UoLyVzL2ksZSl9ZnVuY3Rpb24geGkodCxlLGksbil7dmFyIHI9SSgpLHM9YygpLnNldChuLGUpO3JldHVybiByW2ldKHMsdCl9ZnVuY3Rpb24gRWkodCxlLGksbixyKXtpZigibnVtYmVyIj09dHlwZW9mIHQmJihlPXQsdD12b2lkIDApLHQ9dHx8IiIsbnVsbCE9ZSlyZXR1cm4geGkodCxlLGkscik7dmFyIHMsbz1bXTtmb3Iocz0wO3M8bjtzKyspb1tzXT14aSh0LHMsaSxyKTtyZXR1cm4gb31mdW5jdGlvbiBEaSh0LGUpe3JldHVybiBFaSh0LGUsIm1vbnRocyIsMTIsIm1vbnRoIil9ZnVuY3Rpb24gWWkodCxlKXtyZXR1cm4gRWkodCxlLCJtb250aHNTaG9ydCIsMTIsIm1vbnRoIil9ZnVuY3Rpb24gQ2kodCxlKXtyZXR1cm4gRWkodCxlLCJ3ZWVrZGF5cyIsNywiZGF5Iil9ZnVuY3Rpb24gQWkodCxlKXtyZXR1cm4gRWkodCxlLCJ3ZWVrZGF5c1Nob3J0Iiw3LCJkYXkiKX1mdW5jdGlvbiBPaSh0LGUpe3JldHVybiBFaSh0LGUsIndlZWtkYXlzTWluIiw3LCJkYXkiKX1mdW5jdGlvbiBOaSgpe3ZhciB0PXRoaXMuX2RhdGE7cmV0dXJuIHRoaXMuX21pbGxpc2Vjb25kcz1Mcih0aGlzLl9taWxsaXNlY29uZHMpLHRoaXMuX2RheXM9THIodGhpcy5fZGF5cyksdGhpcy5fbW9udGhzPUxyKHRoaXMuX21vbnRocyksdC5taWxsaXNlY29uZHM9THIodC5taWxsaXNlY29uZHMpLHQuc2Vjb25kcz1Mcih0LnNlY29uZHMpLHQubWludXRlcz1Mcih0Lm1pbnV0ZXMpLHQuaG91cnM9THIodC5ob3VycyksdC5tb250aHM9THIodC5tb250aHMpLHQueWVhcnM9THIodC55ZWFycyksdGhpc31mdW5jdGlvbiBJaSh0LGUsaSxuKXt2YXIgcj1yZShlLGkpO3JldHVybiB0Ll9taWxsaXNlY29uZHMrPW4qci5fbWlsbGlzZWNvbmRzLHQuX2RheXMrPW4qci5fZGF5cyx0Ll9tb250aHMrPW4qci5fbW9udGhzLHQuX2J1YmJsZSgpfWZ1bmN0aW9uIFBpKHQsZSl7cmV0dXJuIElpKHRoaXMsdCxlLDEpfWZ1bmN0aW9uIFJpKHQsZSl7cmV0dXJuIElpKHRoaXMsdCxlLC0xKX1mdW5jdGlvbiBIaSh0KXtyZXR1cm4gdDwwP01hdGguZmxvb3IodCk6TWF0aC5jZWlsKHQpfWZ1bmN0aW9uIGppKCl7dmFyIHQsZSxpLG4scixzPXRoaXMuX21pbGxpc2Vjb25kcyxvPXRoaXMuX2RheXMsYT10aGlzLl9tb250aHMsbD10aGlzLl9kYXRhO3JldHVybiBzPj0wJiZvPj0wJiZhPj0wfHxzPD0wJiZvPD0wJiZhPD0wfHwocys9ODY0ZTUqSGkoVWkoYSkrbyksbz0wLGE9MCksbC5taWxsaXNlY29uZHM9cyUxZTMsdD12KHMvMWUzKSxsLnNlY29uZHM9dCU2MCxlPXYodC82MCksbC5taW51dGVzPWUlNjAsaT12KGUvNjApLGwuaG91cnM9aSUyNCxvKz12KGkvMjQpLHI9dihGaShvKSksYSs9cixvLT1IaShVaShyKSksbj12KGEvMTIpLGElPTEyLGwuZGF5cz1vLGwubW9udGhzPWEsbC55ZWFycz1uLHRoaXN9ZnVuY3Rpb24gRmkodCl7cmV0dXJuIDQ4MDAqdC8xNDYwOTd9ZnVuY3Rpb24gVWkodCl7cmV0dXJuIDE0NjA5Nyp0LzQ4MDB9ZnVuY3Rpb24gV2kodCl7dmFyIGUsaSxuPXRoaXMuX21pbGxpc2Vjb25kcztpZih0PUgodCksIm1vbnRoIj09PXR8fCJ5ZWFyIj09PXQpcmV0dXJuIGU9dGhpcy5fZGF5cytuLzg2NGU1LGk9dGhpcy5fbW9udGhzK0ZpKGUpLCJtb250aCI9PT10P2k6aS8xMjtzd2l0Y2goZT10aGlzLl9kYXlzK01hdGgucm91bmQoVWkodGhpcy5fbW9udGhzKSksdCl7Y2FzZSJ3ZWVrIjpyZXR1cm4gZS83K24vNjA0OGU1O2Nhc2UiZGF5IjpyZXR1cm4gZStuLzg2NGU1O2Nhc2UiaG91ciI6cmV0dXJuIDI0KmUrbi8zNmU1O2Nhc2UibWludXRlIjpyZXR1cm4gMTQ0MCplK24vNmU0O2Nhc2Uic2Vjb25kIjpyZXR1cm4gODY0MDAqZStuLzFlMztjYXNlIm1pbGxpc2Vjb25kIjpyZXR1cm4gTWF0aC5mbG9vcig4NjRlNSplKStuO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJVbmtub3duIHVuaXQgIit0KX19ZnVuY3Rpb24gQmkoKXtyZXR1cm4gdGhpcy5fbWlsbGlzZWNvbmRzKzg2NGU1KnRoaXMuX2RheXMrdGhpcy5fbW9udGhzJTEyKjI1OTJlNiszMTUzNmU2KnkodGhpcy5fbW9udGhzLzEyKX1mdW5jdGlvbiB6aSh0KXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hcyh0KX19ZnVuY3Rpb24gVmkodCl7cmV0dXJuIHQ9SCh0KSx0aGlzW3QrInMiXSgpfWZ1bmN0aW9uICRpKHQpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kYXRhW3RdfX1mdW5jdGlvbiBxaSgpe3JldHVybiB2KHRoaXMuZGF5cygpLzcpfWZ1bmN0aW9uIEdpKHQsZSxpLG4scil7cmV0dXJuIHIucmVsYXRpdmVUaW1lKGV8fDEsISFpLHQsbil9ZnVuY3Rpb24gSmkodCxlLGkpe3ZhciBuPXJlKHQpLmFicygpLHI9V3Iobi5hcygicyIpKSxzPVdyKG4uYXMoIm0iKSksbz1XcihuLmFzKCJoIikpLGE9V3Iobi5hcygiZCIpKSxsPVdyKG4uYXMoIk0iKSksYz1XcihuLmFzKCJ5IikpLHU9cjxCci5zJiZbInMiLHJdfHxzPD0xJiZbIm0iXXx8czxCci5tJiZbIm1tIixzXXx8bzw9MSYmWyJoIl18fG88QnIuaCYmWyJoaCIsb118fGE8PTEmJlsiZCJdfHxhPEJyLmQmJlsiZGQiLGFdfHxsPD0xJiZbIk0iXXx8bDxCci5NJiZbIk1NIixsXXx8Yzw9MSYmWyJ5Il18fFsieXkiLGNdO3JldHVybiB1WzJdPWUsdVszXT0rdD4wLHVbNF09aSxHaS5hcHBseShudWxsLHUpfWZ1bmN0aW9uIEtpKHQsZSl7cmV0dXJuIHZvaWQgMCE9PUJyW3RdJiYodm9pZCAwPT09ZT9Cclt0XTooQnJbdF09ZSwhMCkpfWZ1bmN0aW9uIFFpKHQpe3ZhciBlPXRoaXMubG9jYWxlRGF0YSgpLGk9SmkodGhpcywhdCxlKTtyZXR1cm4gdCYmKGk9ZS5wYXN0RnV0dXJlKCt0aGlzLGkpKSxlLnBvc3Rmb3JtYXQoaSl9ZnVuY3Rpb24gWGkoKXt2YXIgdCxlLGksbj16cih0aGlzLl9taWxsaXNlY29uZHMpLzFlMyxyPXpyKHRoaXMuX2RheXMpLHM9enIodGhpcy5fbW9udGhzKTt0PXYobi82MCksZT12KHQvNjApLG4lPTYwLHQlPTYwLGk9dihzLzEyKSxzJT0xMjt2YXIgbz1pLGE9cyxsPXIsYz1lLHU9dCxkPW4saD10aGlzLmFzU2Vjb25kcygpO3JldHVybiBoPyhoPDA/Ii0iOiIiKSsiUCIrKG8/bysiWSI6IiIpKyhhP2ErIk0iOiIiKSsobD9sKyJEIjoiIikrKGN8fHV8fGQ/IlQiOiIiKSsoYz9jKyJIIjoiIikrKHU/dSsiTSI6IiIpKyhkP2QrIlMiOiIiKToiUDBEIn12YXIgWmksdG49ZS5tb21lbnRQcm9wZXJ0aWVzPVtdLGVuPSExLG5uPXt9O2Uuc3VwcHJlc3NEZXByZWNhdGlvbldhcm5pbmdzPSExO3ZhciBybixzbj17fSxvbj17fSxhbj0vKFxbW15cW10qXF0pfChcXCk/KFtIaF1tbShzcyk/fE1vfE1NP00/TT98RG98REREb3xERD9EP0Q/fGRkZD9kP3xkbz98d1tvfHddP3xXW298V10/fFFvP3xZWVlZWVl8WVlZWVl8WVlZWXxZWXxnZyhnZ2c/KT98R0coR0dHPyk/fGV8RXxhfEF8aGg/fEhIP3xtbT98c3M/fFN7MSw5fXx4fFh8eno/fFpaP3wuKS9nLGxuPS8oXFtbXlxbXSpcXSl8KFxcKT8oTFRTfExUfExMP0w/TD98bHsxLDR9KS9nLGNuPXt9LHVuPXt9LGRuPS9cZC8saG49L1xkXGQvLHBuPS9cZHszfS8sZm49L1xkezR9Lyxtbj0vWystXT9cZHs2fS8sX249L1xkXGQ/Lyxnbj0vXGRcZFxkXGQ/Lyx2bj0vXGRcZFxkXGRcZFxkPy8seW49L1xkezEsM30vLGJuPS9cZHsxLDR9Lyx3bj0vWystXT9cZHsxLDZ9LyxNbj0vXGQrLyxrbj0vWystXT9cZCsvLFRuPS9afFsrLV1cZFxkOj9cZFxkL2dpLFNuPS9afFsrLV1cZFxkKD86Oj9cZFxkKT8vZ2ksTG49L1srLV0/XGQrKFwuXGR7MSwzfSk/Lyx4bj0vWzAtOV0qWydhLXpcdTAwQTAtXHUwNUZGXHUwNzAwLVx1RDdGRlx1RjkwMC1cdUZEQ0ZcdUZERjAtXHVGRkVGXSt8W1x1MDYwMC1cdTA2RkZcL10rKFxzKj9bXHUwNjAwLVx1MDZGRl0rKXsxLDJ9L2ksRW49e30sRG49e30sWW49MCxDbj0xLEFuPTIsT249MyxObj00LEluPTUsUG49NixSbj03LEhuPTg7VigiTSIsWyJNTSIsMl0sIk1vIixmdW5jdGlvbigpe3JldHVybiB0aGlzLm1vbnRoKCkrMX0pLFYoIk1NTSIsMCwwLGZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS5tb250aHNTaG9ydCh0aGlzLHQpfSksVigiTU1NTSIsMCwwLGZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS5tb250aHModGhpcyx0KX0pLFIoIm1vbnRoIiwiTSIpLEsoIk0iLF9uKSxLKCJNTSIsX24saG4pLEsoIk1NTSIsZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5tb250aHNTaG9ydFJlZ2V4KHQpfSksSygiTU1NTSIsZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5tb250aHNSZWdleCh0KX0pLHR0KFsiTSIsIk1NIl0sZnVuY3Rpb24odCxlKXtlW0NuXT15KHQpLTF9KSx0dChbIk1NTSIsIk1NTU0iXSxmdW5jdGlvbih0LGUsaSxuKXt2YXIgcj1pLl9sb2NhbGUubW9udGhzUGFyc2UodCxuLGkuX3N0cmljdCk7bnVsbCE9cj9lW0NuXT1yOmQoaSkuaW52YWxpZE1vbnRoPXR9KTt2YXIgam49L0Rbb0RdPyhcW1teXFtcXV0qXF18XHMrKStNTU1NPy8sRm49IkphbnVhcnlfRmVicnVhcnlfTWFyY2hfQXByaWxfTWF5X0p1bmVfSnVseV9BdWd1c3RfU2VwdGVtYmVyX09jdG9iZXJfTm92ZW1iZXJfRGVjZW1iZXIiLnNwbGl0KCJfIiksVW49Ikphbl9GZWJfTWFyX0Fwcl9NYXlfSnVuX0p1bF9BdWdfU2VwX09jdF9Ob3ZfRGVjIi5zcGxpdCgiXyIpLFduPXhuLEJuPXhuLHpuPS9eXHMqKCg/OlsrLV1cZHs2fXxcZHs0fSktKD86XGRcZC1cZFxkfFdcZFxkLVxkfFdcZFxkfFxkXGRcZHxcZFxkKSkoPzooVHwgKShcZFxkKD86OlxkXGQoPzo6XGRcZCg/OlsuLF1cZCspPyk/KT8pKFtcK1wtXVxkXGQoPzo6P1xkXGQpP3xccypaKT8pPy8sVm49L15ccyooKD86WystXVxkezZ9fFxkezR9KSg/OlxkXGRcZFxkfFdcZFxkXGR8V1xkXGR8XGRcZFxkfFxkXGQpKSg/OihUfCApKFxkXGQoPzpcZFxkKD86XGRcZCg/OlsuLF1cZCspPyk/KT8pKFtcK1wtXVxkXGQoPzo6P1xkXGQpP3xccypaKT8pPy8sJG49L1p8WystXVxkXGQoPzo6P1xkXGQpPy8scW49W1siWVlZWVlZLU1NLUREIiwvWystXVxkezZ9LVxkXGQtXGRcZC9dLFsiWVlZWS1NTS1ERCIsL1xkezR9LVxkXGQtXGRcZC9dLFsiR0dHRy1bV11XVy1FIiwvXGR7NH0tV1xkXGQtXGQvXSxbIkdHR0ctW1ddV1ciLC9cZHs0fS1XXGRcZC8sITFdLFsiWVlZWS1EREQiLC9cZHs0fS1cZHszfS9dLFsiWVlZWS1NTSIsL1xkezR9LVxkXGQvLCExXSxbIllZWVlZWU1NREQiLC9bKy1dXGR7MTB9L10sWyJZWVlZTU1ERCIsL1xkezh9L10sWyJHR0dHW1ddV1dFIiwvXGR7NH1XXGR7M30vXSxbIkdHR0dbV11XVyIsL1xkezR9V1xkezJ9LywhMV0sWyJZWVlZREREIiwvXGR7N30vXV0sR249W1siSEg6bW06c3MuU1NTUyIsL1xkXGQ6XGRcZDpcZFxkXC5cZCsvXSxbIkhIOm1tOnNzLFNTU1MiLC9cZFxkOlxkXGQ6XGRcZCxcZCsvXSxbIkhIOm1tOnNzIiwvXGRcZDpcZFxkOlxkXGQvXSxbIkhIOm1tIiwvXGRcZDpcZFxkL10sWyJISG1tc3MuU1NTUyIsL1xkXGRcZFxkXGRcZFwuXGQrL10sWyJISG1tc3MsU1NTUyIsL1xkXGRcZFxkXGRcZCxcZCsvXSxbIkhIbW1zcyIsL1xkXGRcZFxkXGRcZC9dLFsiSEhtbSIsL1xkXGRcZFxkL10sWyJISCIsL1xkXGQvXV0sSm49L15cLz9EYXRlXCgoXC0/XGQrKS9pO2UuY3JlYXRlRnJvbUlucHV0RmFsbGJhY2s9TSgibW9tZW50IGNvbnN0cnVjdGlvbiBmYWxscyBiYWNrIHRvIGpzIERhdGUuIFRoaXMgaXMgZGlzY291cmFnZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiB1cGNvbWluZyBtYWpvciByZWxlYXNlLiBQbGVhc2UgcmVmZXIgdG8gaHR0cHM6Ly9naXRodWIuY29tL21vbWVudC9tb21lbnQvaXNzdWVzLzE0MDcgZm9yIG1vcmUgaW5mby4iLGZ1bmN0aW9uKHQpe3QuX2Q9bmV3IERhdGUodC5faSsodC5fdXNlVVRDPyIgVVRDIjoiIikpfSksVigiWSIsMCwwLGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy55ZWFyKCk7cmV0dXJuIHQ8PTk5OTk/IiIrdDoiKyIrdH0pLFYoMCxbIllZIiwyXSwwLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueWVhcigpJTEwMH0pLFYoMCxbIllZWVkiLDRdLDAsInllYXIiKSxWKDAsWyJZWVlZWSIsNV0sMCwieWVhciIpLFYoMCxbIllZWVlZWSIsNiwhMF0sMCwieWVhciIpLFIoInllYXIiLCJ5IiksSygiWSIsa24pLEsoIllZIixfbixobiksSygiWVlZWSIsYm4sZm4pLEsoIllZWVlZIix3bixtbiksSygiWVlZWVlZIix3bixtbiksdHQoWyJZWVlZWSIsIllZWVlZWSJdLFluKSx0dCgiWVlZWSIsZnVuY3Rpb24odCxpKXtpW1luXT0yPT09dC5sZW5ndGg/ZS5wYXJzZVR3b0RpZ2l0WWVhcih0KTp5KHQpfSksdHQoIllZIixmdW5jdGlvbih0LGkpe2lbWW5dPWUucGFyc2VUd29EaWdpdFllYXIodCl9KSx0dCgiWSIsZnVuY3Rpb24odCxlKXtlW1luXT1wYXJzZUludCh0LDEwKX0pLGUucGFyc2VUd29EaWdpdFllYXI9ZnVuY3Rpb24odCl7cmV0dXJuIHkodCkrKHkodCk+Njg/MTkwMDoyZTMpfTt2YXIgS249RigiRnVsbFllYXIiLCExKTtlLklTT184NjAxPWZ1bmN0aW9uKCl7fTt2YXIgUW49TSgibW9tZW50KCkubWluIGlzIGRlcHJlY2F0ZWQsIHVzZSBtb21lbnQubWF4IGluc3RlYWQuIGh0dHBzOi8vZ2l0aHViLmNvbS9tb21lbnQvbW9tZW50L2lzc3Vlcy8xNTQ4IixmdW5jdGlvbigpe3ZhciB0PVJ0LmFwcGx5KG51bGwsYXJndW1lbnRzKTtyZXR1cm4gdGhpcy5pc1ZhbGlkKCkmJnQuaXNWYWxpZCgpP3Q8dGhpcz90aGlzOnQ6cCgpfSksWG49TSgibW9tZW50KCkubWF4IGlzIGRlcHJlY2F0ZWQsIHVzZSBtb21lbnQubWluIGluc3RlYWQuIGh0dHBzOi8vZ2l0aHViLmNvbS9tb21lbnQvbW9tZW50L2lzc3Vlcy8xNTQ4IixmdW5jdGlvbigpe3ZhciB0PVJ0LmFwcGx5KG51bGwsYXJndW1lbnRzKTtyZXR1cm4gdGhpcy5pc1ZhbGlkKCkmJnQuaXNWYWxpZCgpP3Q+dGhpcz90aGlzOnQ6cCgpfSksWm49ZnVuY3Rpb24oKXtyZXR1cm4gRGF0ZS5ub3c/RGF0ZS5ub3coKTorbmV3IERhdGV9O0J0KCJaIiwiOiIpLEJ0KCJaWiIsIiIpLEsoIloiLFNuKSxLKCJaWiIsU24pLHR0KFsiWiIsIlpaIl0sZnVuY3Rpb24odCxlLGkpe2kuX3VzZVVUQz0hMCxpLl90em09enQoU24sdCl9KTt2YXIgdHI9LyhbXCtcLV18XGRcZCkvZ2k7ZS51cGRhdGVPZmZzZXQ9ZnVuY3Rpb24oKXt9O3ZhciBlcj0vXihcLSk/KD86KFxkKilbLiBdKT8oXGQrKVw6KFxkKykoPzpcOihcZCspXC4/KFxkezN9KT9cZCopPyQvLGlyPS9eKC0pP1AoPzooWzAtOSwuXSopWSk/KD86KFswLTksLl0qKU0pPyg/OihbMC05LC5dKilXKT8oPzooWzAtOSwuXSopRCk/KD86VCg/OihbMC05LC5dKilIKT8oPzooWzAtOSwuXSopTSk/KD86KFswLTksLl0qKVMpPyk/JC87cmUuZm49VXQucHJvdG90eXBlO3ZhciBucj1jZSgxLCJhZGQiKSxycj1jZSgtMSwic3VidHJhY3QiKTtlLmRlZmF1bHRGb3JtYXQ9IllZWVktTU0tRERUSEg6bW06c3NaIjt2YXIgc3I9TSgibW9tZW50KCkubGFuZygpIGlzIGRlcHJlY2F0ZWQuIEluc3RlYWQsIHVzZSBtb21lbnQoKS5sb2NhbGVEYXRhKCkgdG8gZ2V0IHRoZSBsYW5ndWFnZSBjb25maWd1cmF0aW9uLiBVc2UgbW9tZW50KCkubG9jYWxlKCkgdG8gY2hhbmdlIGxhbmd1YWdlcy4iLGZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10P3RoaXMubG9jYWxlRGF0YSgpOnRoaXMubG9jYWxlKHQpfSk7VigwLFsiZ2ciLDJdLDAsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy53ZWVrWWVhcigpJTEwMH0pLFYoMCxbIkdHIiwyXSwwLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNvV2Vla1llYXIoKSUxMDB9KSxXZSgiZ2dnZyIsIndlZWtZZWFyIiksV2UoImdnZ2dnIiwid2Vla1llYXIiKSxXZSgiR0dHRyIsImlzb1dlZWtZZWFyIiksV2UoIkdHR0dHIiwiaXNvV2Vla1llYXIiKSxSKCJ3ZWVrWWVhciIsImdnIiksUigiaXNvV2Vla1llYXIiLCJHRyIpLEsoIkciLGtuKSxLKCJnIixrbiksSygiR0ciLF9uLGhuKSxLKCJnZyIsX24saG4pLEsoIkdHR0ciLGJuLGZuKSxLKCJnZ2dnIixibixmbiksSygiR0dHR0ciLHduLG1uKSxLKCJnZ2dnZyIsd24sbW4pLGV0KFsiZ2dnZyIsImdnZ2dnIiwiR0dHRyIsIkdHR0dHIl0sZnVuY3Rpb24odCxlLGksbil7ZVtuLnN1YnN0cigwLDIpXT15KHQpfSksZXQoWyJnZyIsIkdHIl0sZnVuY3Rpb24odCxpLG4scil7aVtyXT1lLnBhcnNlVHdvRGlnaXRZZWFyKHQpfSksVigiUSIsMCwiUW8iLCJxdWFydGVyIiksUigicXVhcnRlciIsIlEiKSxLKCJRIixkbiksdHQoIlEiLGZ1bmN0aW9uKHQsZSl7ZVtDbl09MyooeSh0KS0xKX0pLFYoInciLFsid3ciLDJdLCJ3byIsIndlZWsiKSxWKCJXIixbIldXIiwyXSwiV28iLCJpc29XZWVrIiksUigid2VlayIsInciKSxSKCJpc29XZWVrIiwiVyIpLEsoInciLF9uKSxLKCJ3dyIsX24saG4pLEsoIlciLF9uKSxLKCJXVyIsX24saG4pLGV0KFsidyIsInd3IiwiVyIsIldXIl0sZnVuY3Rpb24odCxlLGksbil7ZVtuLnN1YnN0cigwLDEpXT15KHQpfSk7dmFyIG9yPXtkb3c6MCxkb3k6Nn07VigiRCIsWyJERCIsMl0sIkRvIiwiZGF0ZSIpLFIoImRhdGUiLCJEIiksSygiRCIsX24pLEsoIkREIixfbixobiksSygiRG8iLGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQ/ZS5fb3JkaW5hbFBhcnNlOmUuX29yZGluYWxQYXJzZUxlbmllbnR9KSx0dChbIkQiLCJERCJdLEFuKSx0dCgiRG8iLGZ1bmN0aW9uKHQsZSl7ZVtBbl09eSh0Lm1hdGNoKF9uKVswXSwxMCl9KTt2YXIgYXI9RigiRGF0ZSIsITApO1YoImQiLDAsImRvIiwiZGF5IiksVigiZGQiLDAsMCxmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkud2Vla2RheXNNaW4odGhpcyx0KX0pLFYoImRkZCIsMCwwLGZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS53ZWVrZGF5c1Nob3J0KHRoaXMsdCl9KSxWKCJkZGRkIiwwLDAsZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLndlZWtkYXlzKHRoaXMsdCl9KSxWKCJlIiwwLDAsIndlZWtkYXkiKSxWKCJFIiwwLDAsImlzb1dlZWtkYXkiKSxSKCJkYXkiLCJkIiksUigid2Vla2RheSIsImUiKSxSKCJpc29XZWVrZGF5IiwiRSIpLEsoImQiLF9uKSxLKCJlIixfbiksSygiRSIsX24pLEsoImRkIix4biksSygiZGRkIix4biksSygiZGRkZCIseG4pLGV0KFsiZGQiLCJkZGQiLCJkZGRkIl0sZnVuY3Rpb24odCxlLGksbil7dmFyIHI9aS5fbG9jYWxlLndlZWtkYXlzUGFyc2UodCxuLGkuX3N0cmljdCk7bnVsbCE9cj9lLmQ9cjpkKGkpLmludmFsaWRXZWVrZGF5PXR9KSxldChbImQiLCJlIiwiRSJdLGZ1bmN0aW9uKHQsZSxpLG4pe2Vbbl09eSh0KX0pO3ZhciBscj0iU3VuZGF5X01vbmRheV9UdWVzZGF5X1dlZG5lc2RheV9UaHVyc2RheV9GcmlkYXlfU2F0dXJkYXkiLnNwbGl0KCJfIiksY3I9IlN1bl9Nb25fVHVlX1dlZF9UaHVfRnJpX1NhdCIuc3BsaXQoIl8iKSx1cj0iU3VfTW9fVHVfV2VfVGhfRnJfU2EiLnNwbGl0KCJfIik7VigiREREIixbIkREREQiLDNdLCJERERvIiwiZGF5T2ZZZWFyIiksUigiZGF5T2ZZZWFyIiwiREREIiksSygiREREIix5biksSygiRERERCIscG4pLHR0KFsiREREIiwiRERERCJdLGZ1bmN0aW9uKHQsZSxpKXtpLl9kYXlPZlllYXI9eSh0KX0pLFYoIkgiLFsiSEgiLDJdLDAsImhvdXIiKSxWKCJoIixbImhoIiwyXSwwLHVpKSxWKCJobW0iLDAsMCxmdW5jdGlvbigpe3JldHVybiIiK3VpLmFwcGx5KHRoaXMpK3oodGhpcy5taW51dGVzKCksMil9KSxWKCJobW1zcyIsMCwwLGZ1bmN0aW9uKCl7cmV0dXJuIiIrdWkuYXBwbHkodGhpcykreih0aGlzLm1pbnV0ZXMoKSwyKSt6KHRoaXMuc2Vjb25kcygpLDIpfSksVigiSG1tIiwwLDAsZnVuY3Rpb24oKXtyZXR1cm4iIit0aGlzLmhvdXJzKCkreih0aGlzLm1pbnV0ZXMoKSwyKX0pLFYoIkhtbXNzIiwwLDAsZnVuY3Rpb24oKXtyZXR1cm4iIit0aGlzLmhvdXJzKCkreih0aGlzLm1pbnV0ZXMoKSwyKSt6KHRoaXMuc2Vjb25kcygpLDIpfSksZGkoImEiLCEwKSxkaSgiQSIsITEpLFIoImhvdXIiLCJoIiksSygiYSIsaGkpLEsoIkEiLGhpKSxLKCJIIixfbiksSygiaCIsX24pLEsoIkhIIixfbixobiksSygiaGgiLF9uLGhuKSxLKCJobW0iLGduKSxLKCJobW1zcyIsdm4pLEsoIkhtbSIsZ24pLEsoIkhtbXNzIix2biksdHQoWyJIIiwiSEgiXSxPbiksdHQoWyJhIiwiQSJdLGZ1bmN0aW9uKHQsZSxpKXtpLl9pc1BtPWkuX2xvY2FsZS5pc1BNKHQpLGkuX21lcmlkaWVtPXR9KSx0dChbImgiLCJoaCJdLGZ1bmN0aW9uKHQsZSxpKXtlW09uXT15KHQpLGQoaSkuYmlnSG91cj0hMH0pLHR0KCJobW0iLGZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Lmxlbmd0aC0yO2VbT25dPXkodC5zdWJzdHIoMCxuKSksZVtObl09eSh0LnN1YnN0cihuKSksZChpKS5iaWdIb3VyPSEwfSksdHQoImhtbXNzIixmdW5jdGlvbih0LGUsaSl7dmFyIG49dC5sZW5ndGgtNCxyPXQubGVuZ3RoLTI7ZVtPbl09eSh0LnN1YnN0cigwLG4pKSxlW05uXT15KHQuc3Vic3RyKG4sMikpLGVbSW5dPXkodC5zdWJzdHIocikpLGQoaSkuYmlnSG91cj0hMH0pLHR0KCJIbW0iLGZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Lmxlbmd0aC0yO2VbT25dPXkodC5zdWJzdHIoMCxuKSksZVtObl09eSh0LnN1YnN0cihuKSl9KSx0dCgiSG1tc3MiLGZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Lmxlbmd0aC00LHI9dC5sZW5ndGgtMjtlW09uXT15KHQuc3Vic3RyKDAsbikpLGVbTm5dPXkodC5zdWJzdHIobiwyKSksZVtJbl09eSh0LnN1YnN0cihyKSl9KTt2YXIgZHI9L1thcF1cLj9tP1wuPy9pLGhyPUYoIkhvdXJzIiwhMCk7VigibSIsWyJtbSIsMl0sMCwibWludXRlIiksUigibWludXRlIiwibSIpLEsoIm0iLF9uKSxLKCJtbSIsX24saG4pLHR0KFsibSIsIm1tIl0sTm4pO3ZhciBwcj1GKCJNaW51dGVzIiwhMSk7VigicyIsWyJzcyIsMl0sMCwic2Vjb25kIiksUigic2Vjb25kIiwicyIpLEsoInMiLF9uKSxLKCJzcyIsX24saG4pLHR0KFsicyIsInNzIl0sSW4pO3ZhciBmcj1GKCJTZWNvbmRzIiwhMSk7VigiUyIsMCwwLGZ1bmN0aW9uKCl7cmV0dXJufn4odGhpcy5taWxsaXNlY29uZCgpLzEwMCl9KSxWKDAsWyJTUyIsMl0sMCxmdW5jdGlvbigpe3JldHVybn5+KHRoaXMubWlsbGlzZWNvbmQoKS8xMCl9KSxWKDAsWyJTU1MiLDNdLDAsIm1pbGxpc2Vjb25kIiksVigwLFsiU1NTUyIsNF0sMCxmdW5jdGlvbigpe3JldHVybiAxMCp0aGlzLm1pbGxpc2Vjb25kKCl9KSxWKDAsWyJTU1NTUyIsNV0sMCxmdW5jdGlvbigpe3JldHVybiAxMDAqdGhpcy5taWxsaXNlY29uZCgpfSksVigwLFsiU1NTU1NTIiw2XSwwLGZ1bmN0aW9uKCl7cmV0dXJuIDFlMyp0aGlzLm1pbGxpc2Vjb25kKCl9KSxWKDAsWyJTU1NTU1NTIiw3XSwwLGZ1bmN0aW9uKCl7cmV0dXJuIDFlNCp0aGlzLm1pbGxpc2Vjb25kKCl9KSxWKDAsWyJTU1NTU1NTUyIsOF0sMCxmdW5jdGlvbigpe3JldHVybiAxZTUqdGhpcy5taWxsaXNlY29uZCgpfSksVigwLFsiU1NTU1NTU1NTIiw5XSwwLGZ1bmN0aW9uKCl7cmV0dXJuIDFlNip0aGlzLm1pbGxpc2Vjb25kKCl9KSxSKCJtaWxsaXNlY29uZCIsIm1zIiksSygiUyIseW4sZG4pLEsoIlNTIix5bixobiksSygiU1NTIix5bixwbik7dmFyIG1yO2Zvcihtcj0iU1NTUyI7bXIubGVuZ3RoPD05O21yKz0iUyIpSyhtcixNbik7Zm9yKG1yPSJTIjttci5sZW5ndGg8PTk7bXIrPSJTIil0dChtcixtaSk7dmFyIF9yPUYoIk1pbGxpc2Vjb25kcyIsITEpO1YoInoiLDAsMCwiem9uZUFiYnIiKSxWKCJ6eiIsMCwwLCJ6b25lTmFtZSIpO3ZhciBncj1fLnByb3RvdHlwZTtnci5hZGQ9bnIsZ3IuY2FsZW5kYXI9ZGUsZ3IuY2xvbmU9aGUsZ3IuZGlmZj15ZSxnci5lbmRPZj1DZSxnci5mb3JtYXQ9a2UsZ3IuZnJvbT1UZSxnci5mcm9tTm93PVNlLGdyLnRvPUxlLGdyLnRvTm93PXhlLGdyLmdldD1CLGdyLmludmFsaWRBdD1GZSxnci5pc0FmdGVyPXBlLGdyLmlzQmVmb3JlPWZlLGdyLmlzQmV0d2Vlbj1tZSxnci5pc1NhbWU9X2UsZ3IuaXNTYW1lT3JBZnRlcj1nZSxnci5pc1NhbWVPckJlZm9yZT12ZSxnci5pc1ZhbGlkPUhlLGdyLmxhbmc9c3IsZ3IubG9jYWxlPUVlLGdyLmxvY2FsZURhdGE9RGUsZ3IubWF4PVhuLGdyLm1pbj1Rbixnci5wYXJzaW5nRmxhZ3M9amUsZ3Iuc2V0PUIsZ3Iuc3RhcnRPZj1ZZSxnci5zdWJ0cmFjdD1ycixnci50b0FycmF5PUllLGdyLnRvT2JqZWN0PVBlLGdyLnRvRGF0ZT1OZSxnci50b0lTT1N0cmluZz1NZSxnci50b0pTT049UmUsZ3IudG9TdHJpbmc9d2UsZ3IudW5peD1PZSxnci52YWx1ZU9mPUFlLGdyLmNyZWF0aW9uRGF0YT1VZSxnci55ZWFyPUtuLGdyLmlzTGVhcFllYXI9YnQsZ3Iud2Vla1llYXI9QmUsZ3IuaXNvV2Vla1llYXI9emUsZ3IucXVhcnRlcj1nci5xdWFydGVycz1KZSxnci5tb250aD1sdCxnci5kYXlzSW5Nb250aD1jdCxnci53ZWVrPWdyLndlZWtzPVplLGdyLmlzb1dlZWs9Z3IuaXNvV2Vla3M9dGksZ3Iud2Vla3NJblllYXI9JGUsZ3IuaXNvV2Vla3NJblllYXI9VmUsZ3IuZGF0ZT1hcixnci5kYXk9Z3IuZGF5cz1vaSxnci53ZWVrZGF5PWFpLGdyLmlzb1dlZWtkYXk9bGksZ3IuZGF5T2ZZZWFyPWNpLGdyLmhvdXI9Z3IuaG91cnM9aHIsZ3IubWludXRlPWdyLm1pbnV0ZXM9cHIsZ3Iuc2Vjb25kPWdyLnNlY29uZHM9ZnIsZ3IubWlsbGlzZWNvbmQ9Z3IubWlsbGlzZWNvbmRzPV9yLGdyLnV0Y09mZnNldD1xdCxnci51dGM9SnQsZ3IubG9jYWw9S3QsZ3IucGFyc2Vab25lPVF0LGdyLmhhc0FsaWduZWRIb3VyT2Zmc2V0PVh0LGdyLmlzRFNUPVp0LGdyLmlzRFNUU2hpZnRlZD10ZSxnci5pc0xvY2FsPWVlLGdyLmlzVXRjT2Zmc2V0PWllLGdyLmlzVXRjPW5lLGdyLmlzVVRDPW5lLGdyLnpvbmVBYmJyPV9pLGdyLnpvbmVOYW1lPWdpLGdyLmRhdGVzPU0oImRhdGVzIGFjY2Vzc29yIGlzIGRlcHJlY2F0ZWQuIFVzZSBkYXRlIGluc3RlYWQuIixhciksZ3IubW9udGhzPU0oIm1vbnRocyBhY2Nlc3NvciBpcyBkZXByZWNhdGVkLiBVc2UgbW9udGggaW5zdGVhZCIsbHQpLGdyLnllYXJzPU0oInllYXJzIGFjY2Vzc29yIGlzIGRlcHJlY2F0ZWQuIFVzZSB5ZWFyIGluc3RlYWQiLEtuKSxnci56b25lPU0oIm1vbWVudCgpLnpvbmUgaXMgZGVwcmVjYXRlZCwgdXNlIG1vbWVudCgpLnV0Y09mZnNldCBpbnN0ZWFkLiBodHRwczovL2dpdGh1Yi5jb20vbW9tZW50L21vbWVudC9pc3N1ZXMvMTc3OSIsR3QpO3ZhciB2cj1ncix5cj17c2FtZURheToiW1RvZGF5IGF0XSBMVCIsbmV4dERheToiW1RvbW9ycm93IGF0XSBMVCIsbmV4dFdlZWs6ImRkZGQgW2F0XSBMVCIsbGFzdERheToiW1llc3RlcmRheSBhdF0gTFQiLGxhc3RXZWVrOiJbTGFzdF0gZGRkZCBbYXRdIExUIixzYW1lRWxzZToiTCJ9LGJyPXtMVFM6Img6bW06c3MgQSIsTFQ6Img6bW0gQSIsTDoiTU0vREQvWVlZWSIsTEw6Ik1NTU0gRCwgWVlZWSIsTExMOiJNTU1NIEQsIFlZWVkgaDptbSBBIixMTExMOiJkZGRkLCBNTU1NIEQsIFlZWVkgaDptbSBBIn0sd3I9IkludmFsaWQgZGF0ZSIsTXI9IiVkIixrcj0vXGR7MSwyfS8sVHI9e2Z1dHVyZToiaW4gJXMiLHBhc3Q6IiVzIGFnbyIsczoiYSBmZXcgc2Vjb25kcyIsbToiYSBtaW51dGUiLG1tOiIlZCBtaW51dGVzIixoOiJhbiBob3VyIixoaDoiJWQgaG91cnMiLGQ6ImEgZGF5IixkZDoiJWQgZGF5cyIsTToiYSBtb250aCIsTU06IiVkIG1vbnRocyIseToiYSB5ZWFyIix5eToiJWQgeWVhcnMifSxTcj1FLnByb3RvdHlwZTtTci5fY2FsZW5kYXI9eXIsU3IuY2FsZW5kYXI9YmksU3IuX2xvbmdEYXRlRm9ybWF0PWJyLFNyLmxvbmdEYXRlRm9ybWF0PXdpLFNyLl9pbnZhbGlkRGF0ZT13cixTci5pbnZhbGlkRGF0ZT1NaSxTci5fb3JkaW5hbD1NcixTci5vcmRpbmFsPWtpLFNyLl9vcmRpbmFsUGFyc2U9a3IsU3IucHJlcGFyc2U9VGksU3IucG9zdGZvcm1hdD1UaSxTci5fcmVsYXRpdmVUaW1lPVRyLFNyLnJlbGF0aXZlVGltZT1TaSxTci5wYXN0RnV0dXJlPUxpLFNyLnNldD1MLFNyLm1vbnRocz1ydCxTci5fbW9udGhzPUZuLFNyLm1vbnRoc1Nob3J0PXN0LFNyLl9tb250aHNTaG9ydD1VbixTci5tb250aHNQYXJzZT1vdCxTci5fbW9udGhzUmVnZXg9Qm4sU3IubW9udGhzUmVnZXg9ZHQsU3IuX21vbnRoc1Nob3J0UmVnZXg9V24sU3IubW9udGhzU2hvcnRSZWdleD11dCxTci53ZWVrPUtlLFNyLl93ZWVrPW9yLFNyLmZpcnN0RGF5T2ZZZWFyPVhlLFNyLmZpcnN0RGF5T2ZXZWVrPVFlLFNyLndlZWtkYXlzPWlpLFNyLl93ZWVrZGF5cz1scixTci53ZWVrZGF5c01pbj1yaSxTci5fd2Vla2RheXNNaW49dXIsU3Iud2Vla2RheXNTaG9ydD1uaSxTci5fd2Vla2RheXNTaG9ydD1jcixTci53ZWVrZGF5c1BhcnNlPXNpLFNyLmlzUE09cGksU3IuX21lcmlkaWVtUGFyc2U9ZHIsU3IubWVyaWRpZW09ZmksQSgiZW4iLHtvcmRpbmFsUGFyc2U6L1xkezEsMn0odGh8c3R8bmR8cmQpLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3ZhciBlPXQlMTAsaT0xPT09eSh0JTEwMC8xMCk/InRoIjoxPT09ZT8ic3QiOjI9PT1lPyJuZCI6Mz09PWU/InJkIjoidGgiO3JldHVybiB0K2l9fSksZS5sYW5nPU0oIm1vbWVudC5sYW5nIGlzIGRlcHJlY2F0ZWQuIFVzZSBtb21lbnQubG9jYWxlIGluc3RlYWQuIixBKSxlLmxhbmdEYXRhPU0oIm1vbWVudC5sYW5nRGF0YSBpcyBkZXByZWNhdGVkLiBVc2UgbW9tZW50LmxvY2FsZURhdGEgaW5zdGVhZC4iLEkpO3ZhciBMcj1NYXRoLmFicyx4cj16aSgibXMiKSxFcj16aSgicyIpLERyPXppKCJtIiksWXI9emkoImgiKSxDcj16aSgiZCIpLEFyPXppKCJ3IiksT3I9emkoIk0iKSxOcj16aSgieSIpLElyPSRpKCJtaWxsaXNlY29uZHMiKSxQcj0kaSgic2Vjb25kcyIpLFJyPSRpKCJtaW51dGVzIiksSHI9JGkoImhvdXJzIiksanI9JGkoImRheXMiKSxGcj0kaSgibW9udGhzIiksVXI9JGkoInllYXJzIiksV3I9TWF0aC5yb3VuZCxCcj17czo0NSxtOjQ1LGg6MjIsZDoyNixNOjExfSx6cj1NYXRoLmFicyxWcj1VdC5wcm90b3R5cGU7VnIuYWJzPU5pLFZyLmFkZD1QaSxWci5zdWJ0cmFjdD1SaSxWci5hcz1XaSxWci5hc01pbGxpc2Vjb25kcz14cixWci5hc1NlY29uZHM9RXIsVnIuYXNNaW51dGVzPURyLFZyLmFzSG91cnM9WXIsVnIuYXNEYXlzPUNyLFZyLmFzV2Vla3M9QXIsVnIuYXNNb250aHM9T3IsVnIuYXNZZWFycz1OcixWci52YWx1ZU9mPUJpLFZyLl9idWJibGU9amksVnIuZ2V0PVZpLFZyLm1pbGxpc2Vjb25kcz1JcixWci5zZWNvbmRzPVByLFZyLm1pbnV0ZXM9UnIsVnIuaG91cnM9SHIsVnIuZGF5cz1qcixWci53ZWVrcz1xaSxWci5tb250aHM9RnIsVnIueWVhcnM9VXIsVnIuaHVtYW5pemU9UWksVnIudG9JU09TdHJpbmc9WGksVnIudG9TdHJpbmc9WGksVnIudG9KU09OPVhpLFZyLmxvY2FsZT1FZSxWci5sb2NhbGVEYXRhPURlLFZyLnRvSXNvU3RyaW5nPU0oInRvSXNvU3RyaW5nKCkgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSB0b0lTT1N0cmluZygpIGluc3RlYWQgKG5vdGljZSB0aGUgY2FwaXRhbHMpIixYaSksVnIubGFuZz1zcixWKCJYIiwwLDAsInVuaXgiKSxWKCJ4IiwwLDAsInZhbHVlT2YiKSxLKCJ4IixrbiksSygiWCIsTG4pLHR0KCJYIixmdW5jdGlvbih0LGUsaSl7aS5fZD1uZXcgRGF0ZSgxZTMqcGFyc2VGbG9hdCh0LDEwKSl9KSx0dCgieCIsZnVuY3Rpb24odCxlLGkpe2kuX2Q9bmV3IERhdGUoeSh0KSl9KSxlLnZlcnNpb249IjIuMTIuMCIsbihSdCksZS5mbj12cixlLm1pbj1qdCxlLm1heD1GdCxlLm5vdz1abixlLnV0Yz1jLGUudW5peD12aSxlLm1vbnRocz1EaSxlLmlzRGF0ZT1zLGUubG9jYWxlPUEsZS5pbnZhbGlkPXAsZS5kdXJhdGlvbj1yZSxlLmlzTW9tZW50PWcsZS53ZWVrZGF5cz1DaSxlLnBhcnNlWm9uZT15aSxlLmxvY2FsZURhdGE9SSxlLmlzRHVyYXRpb249V3QsZS5tb250aHNTaG9ydD1ZaSxlLndlZWtkYXlzTWluPU9pLGUuZGVmaW5lTG9jYWxlPU8sZS51cGRhdGVMb2NhbGU9TixlLmxvY2FsZXM9UCxlLndlZWtkYXlzU2hvcnQ9QWksZS5ub3JtYWxpemVVbml0cz1ILGUucmVsYXRpdmVUaW1lVGhyZXNob2xkPUtpLGUucHJvdG90eXBlPXZyO3ZhciAkcj1lO3JldHVybiAkcn0pfSkuY2FsbChlLGkoMzcpKHQpKX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9ZnVuY3Rpb24odCl7cmV0dXJuIHQud2VicGFja1BvbHlmaWxsfHwodC5kZXByZWNhdGU9ZnVuY3Rpb24oKXt9LHQucGF0aHM9W10sdC5jaGlsZHJlbj1bXSx0LndlYnBhY2tQb2x5ZmlsbD0xKSx0fX0sZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCl7cmV0dXJuIGkocih0KSl9ZnVuY3Rpb24gcih0KXtyZXR1cm4gc1t0XXx8ZnVuY3Rpb24oKXt0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIit0KyInLiIpfSgpfXZhciBzPXsiLi9hZiI6MzksIi4vYWYuanMiOjM5LCIuL2FyIjo0MCwiLi9hci1tYSI6NDEsIi4vYXItbWEuanMiOjQxLCIuL2FyLXNhIjo0MiwiLi9hci1zYS5qcyI6NDIsIi4vYXItdG4iOjQzLCIuL2FyLXRuLmpzIjo0MywiLi9hci5qcyI6NDAsIi4vYXoiOjQ0LCIuL2F6LmpzIjo0NCwiLi9iZSI6NDUsIi4vYmUuanMiOjQ1LCIuL2JnIjo0NiwiLi9iZy5qcyI6NDYsIi4vYm4iOjQ3LCIuL2JuLmpzIjo0NywiLi9ibyI6NDgsIi4vYm8uanMiOjQ4LCIuL2JyIjo0OSwiLi9ici5qcyI6NDksIi4vYnMiOjUwLCIuL2JzLmpzIjo1MCwiLi9jYSI6NTEsIi4vY2EuanMiOjUxLAoJIi4vY3MiOjUyLCIuL2NzLmpzIjo1MiwiLi9jdiI6NTMsIi4vY3YuanMiOjUzLCIuL2N5Ijo1NCwiLi9jeS5qcyI6NTQsIi4vZGEiOjU1LCIuL2RhLmpzIjo1NSwiLi9kZSI6NTYsIi4vZGUtYXQiOjU3LCIuL2RlLWF0LmpzIjo1NywiLi9kZS5qcyI6NTYsIi4vZHYiOjU4LCIuL2R2LmpzIjo1OCwiLi9lbCI6NTksIi4vZWwuanMiOjU5LCIuL2VuLWF1Ijo2MCwiLi9lbi1hdS5qcyI6NjAsIi4vZW4tY2EiOjYxLCIuL2VuLWNhLmpzIjo2MSwiLi9lbi1nYiI6NjIsIi4vZW4tZ2IuanMiOjYyLCIuL2VuLWllIjo2MywiLi9lbi1pZS5qcyI6NjMsIi4vZW4tbnoiOjY0LCIuL2VuLW56LmpzIjo2NCwiLi9lbyI6NjUsIi4vZW8uanMiOjY1LCIuL2VzIjo2NiwiLi9lcy5qcyI6NjYsIi4vZXQiOjY3LCIuL2V0LmpzIjo2NywiLi9ldSI6NjgsIi4vZXUuanMiOjY4LCIuL2ZhIjo2OSwiLi9mYS5qcyI6NjksIi4vZmkiOjcwLCIuL2ZpLmpzIjo3MCwiLi9mbyI6NzEsIi4vZm8uanMiOjcxLCIuL2ZyIjo3MiwiLi9mci1jYSI6NzMsIi4vZnItY2EuanMiOjczLCIuL2ZyLWNoIjo3NCwiLi9mci1jaC5qcyI6NzQsIi4vZnIuanMiOjcyLCIuL2Z5Ijo3NSwiLi9meS5qcyI6NzUsIi4vZ2QiOjc2LCIuL2dkLmpzIjo3NiwiLi9nbCI6NzcsIi4vZ2wuanMiOjc3LCIuL2hlIjo3OCwiLi9oZS5qcyI6NzgsIi4vaGkiOjc5LCIuL2hpLmpzIjo3OSwiLi9ociI6ODAsIi4vaHIuanMiOjgwLCIuL2h1Ijo4MSwiLi9odS5qcyI6ODEsIi4vaHktYW0iOjgyLCIuL2h5LWFtLmpzIjo4MiwiLi9pZCI6ODMsIi4vaWQuanMiOjgzLCIuL2lzIjo4NCwiLi9pcy5qcyI6ODQsIi4vaXQiOjg1LCIuL2l0LmpzIjo4NSwiLi9qYSI6ODYsIi4vamEuanMiOjg2LCIuL2p2Ijo4NywiLi9qdi5qcyI6ODcsIi4va2EiOjg4LCIuL2thLmpzIjo4OCwiLi9rayI6ODksIi4va2suanMiOjg5LCIuL2ttIjo5MCwiLi9rbS5qcyI6OTAsIi4va28iOjkxLCIuL2tvLmpzIjo5MSwiLi9sYiI6OTIsIi4vbGIuanMiOjkyLCIuL2xvIjo5MywiLi9sby5qcyI6OTMsIi4vbHQiOjk0LCIuL2x0LmpzIjo5NCwiLi9sdiI6OTUsIi4vbHYuanMiOjk1LCIuL21lIjo5NiwiLi9tZS5qcyI6OTYsIi4vbWsiOjk3LCIuL21rLmpzIjo5NywiLi9tbCI6OTgsIi4vbWwuanMiOjk4LCIuL21yIjo5OSwiLi9tci5qcyI6OTksIi4vbXMiOjEwMCwiLi9tcy1teSI6MTAxLCIuL21zLW15LmpzIjoxMDEsIi4vbXMuanMiOjEwMCwiLi9teSI6MTAyLCIuL215LmpzIjoxMDIsIi4vbmIiOjEwMywiLi9uYi5qcyI6MTAzLCIuL25lIjoxMDQsIi4vbmUuanMiOjEwNCwiLi9ubCI6MTA1LCIuL25sLmpzIjoxMDUsIi4vbm4iOjEwNiwiLi9ubi5qcyI6MTA2LCIuL3BhLWluIjoxMDcsIi4vcGEtaW4uanMiOjEwNywiLi9wbCI6MTA4LCIuL3BsLmpzIjoxMDgsIi4vcHQiOjEwOSwiLi9wdC1iciI6MTEwLCIuL3B0LWJyLmpzIjoxMTAsIi4vcHQuanMiOjEwOSwiLi9ybyI6MTExLCIuL3JvLmpzIjoxMTEsIi4vcnUiOjExMiwiLi9ydS5qcyI6MTEyLCIuL3NlIjoxMTMsIi4vc2UuanMiOjExMywiLi9zaSI6MTE0LCIuL3NpLmpzIjoxMTQsIi4vc2siOjExNSwiLi9zay5qcyI6MTE1LCIuL3NsIjoxMTYsIi4vc2wuanMiOjExNiwiLi9zcSI6MTE3LCIuL3NxLmpzIjoxMTcsIi4vc3IiOjExOCwiLi9zci1jeXJsIjoxMTksIi4vc3ItY3lybC5qcyI6MTE5LCIuL3NyLmpzIjoxMTgsIi4vc3YiOjEyMCwiLi9zdi5qcyI6MTIwLCIuL3N3IjoxMjEsIi4vc3cuanMiOjEyMSwiLi90YSI6MTIyLCIuL3RhLmpzIjoxMjIsIi4vdGUiOjEyMywiLi90ZS5qcyI6MTIzLCIuL3RoIjoxMjQsIi4vdGguanMiOjEyNCwiLi90bC1waCI6MTI1LCIuL3RsLXBoLmpzIjoxMjUsIi4vdGxoIjoxMjYsIi4vdGxoLmpzIjoxMjYsIi4vdHIiOjEyNywiLi90ci5qcyI6MTI3LCIuL3R6bCI6MTI4LCIuL3R6bC5qcyI6MTI4LCIuL3R6bSI6MTI5LCIuL3R6bS1sYXRuIjoxMzAsIi4vdHptLWxhdG4uanMiOjEzMCwiLi90em0uanMiOjEyOSwiLi91ayI6MTMxLCIuL3VrLmpzIjoxMzEsIi4vdXoiOjEzMiwiLi91ei5qcyI6MTMyLCIuL3ZpIjoxMzMsIi4vdmkuanMiOjEzMywiLi96aC1jbiI6MTM0LCIuL3poLWNuLmpzIjoxMzQsIi4vemgtdHciOjEzNSwiLi96aC10dy5qcyI6MTM1fTtuLmtleXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2JqZWN0LmtleXMocyl9LG4ucmVzb2x2ZT1yLHQuZXhwb3J0cz1uLG4uaWQ9Mzh9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImFmIix7bW9udGhzOiJKYW51YXJpZV9GZWJydWFyaWVfTWFhcnRfQXByaWxfTWVpX0p1bmllX0p1bGllX0F1Z3VzdHVzX1NlcHRlbWJlcl9Pa3RvYmVyX05vdmVtYmVyX0Rlc2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJKYW5fRmViX01hcl9BcHJfTWVpX0p1bl9KdWxfQXVnX1NlcF9Pa3RfTm92X0RlcyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiU29uZGFnX01hYW5kYWdfRGluc2RhZ19Xb2Vuc2RhZ19Eb25kZXJkYWdfVnJ5ZGFnX1NhdGVyZGFnIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlNvbl9NYWFfRGluX1dvZV9Eb25fVnJ5X1NhdCIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU29fTWFfRGlfV29fRG9fVnJfU2EiLnNwbGl0KCJfIiksbWVyaWRpZW1QYXJzZTovdm18bm0vaSxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybi9ebm0kL2kudGVzdCh0KX0sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PDEyP2k/InZtIjoiVk0iOmk/Im5tIjoiTk0ifSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltWYW5kYWcgb21dIExUIixuZXh0RGF5OiJbTcO0cmUgb21dIExUIixuZXh0V2VlazoiZGRkZCBbb21dIExUIixsYXN0RGF5OiJbR2lzdGVyIG9tXSBMVCIsbGFzdFdlZWs6IltMYWFzXSBkZGRkIFtvbV0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6Im9vciAlcyIscGFzdDoiJXMgZ2VsZWRlIixzOiInbiBwYWFyIHNla29uZGVzIixtOiInbiBtaW51dXQiLG1tOiIlZCBtaW51dGUiLGg6IiduIHV1ciIsaGg6IiVkIHVyZSIsZDoiJ24gZGFnIixkZDoiJWQgZGFlIixNOiInbiBtYWFuZCIsTU06IiVkIG1hYW5kZSIseToiJ24gamFhciIseXk6IiVkIGphYXIifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0oc3RlfGRlKS8sb3JkaW5hbDpmdW5jdGlvbih0KXtyZXR1cm4gdCsoMT09PXR8fDg9PT10fHx0Pj0yMD8ic3RlIjoiZGUiKX0sd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT17MToi2aEiLDI6ItmiIiwzOiLZoyIsNDoi2aQiLDU6ItmlIiw2OiLZpiIsNzoi2aciLDg6ItmoIiw5OiLZqSIsMDoi2aAifSxpPXsi2aEiOiIxIiwi2aIiOiIyIiwi2aMiOiIzIiwi2aQiOiI0Iiwi2aUiOiI1Iiwi2aYiOiI2Iiwi2aciOiI3Iiwi2agiOiI4Iiwi2akiOiI5Iiwi2aAiOiIwIn0sbj1mdW5jdGlvbih0KXtyZXR1cm4gMD09PXQ/MDoxPT09dD8xOjI9PT10PzI6dCUxMDA+PTMmJnQlMTAwPD0xMD8zOnQlMTAwPj0xMT80OjV9LHI9e3M6WyLYo9mC2YQg2YXZhiDYq9in2YbZitipIiwi2KvYp9mG2YrYqSDZiNin2K3Yr9ipIixbItir2KfZhtmK2KrYp9mGIiwi2KvYp9mG2YrYqtmK2YYiXSwiJWQg2KvZiNin2YYiLCIlZCDYq9in2YbZitipIiwiJWQg2KvYp9mG2YrYqSJdLG06WyLYo9mC2YQg2YXZhiDYr9mC2YrZgtipIiwi2K/ZgtmK2YLYqSDZiNin2K3Yr9ipIixbItiv2YLZitmC2KrYp9mGIiwi2K/ZgtmK2YLYqtmK2YYiXSwiJWQg2K/Zgtin2KbZgiIsIiVkINiv2YLZitmC2KkiLCIlZCDYr9mC2YrZgtipIl0saDpbItij2YLZhCDZhdmGINiz2KfYudipIiwi2LPYp9i52Kkg2YjYp9it2K/YqSIsWyLYs9in2LnYqtin2YYiLCLYs9in2LnYqtmK2YYiXSwiJWQg2LPYp9i52KfYqiIsIiVkINiz2KfYudipIiwiJWQg2LPYp9i52KkiXSxkOlsi2KPZgtmEINmF2YYg2YrZiNmFIiwi2YrZiNmFINmI2KfYrdivIixbItmK2YjZhdin2YYiLCLZitmI2YXZitmGIl0sIiVkINij2YrYp9mFIiwiJWQg2YrZiNmF2YvYpyIsIiVkINmK2YjZhSJdLE06WyLYo9mC2YQg2YXZhiDYtNmH2LEiLCLYtNmH2LEg2YjYp9it2K8iLFsi2LTZh9ix2KfZhiIsIti02YfYsdmK2YYiXSwiJWQg2KPYtNmH2LEiLCIlZCDYtNmH2LHYpyIsIiVkINi02YfYsSJdLHk6WyLYo9mC2YQg2YXZhiDYudin2YUiLCLYudin2YUg2YjYp9it2K8iLFsi2LnYp9mF2KfZhiIsIti52KfZhdmK2YYiXSwiJWQg2KPYudmI2KfZhSIsIiVkINi52KfZhdmL2KciLCIlZCDYudin2YUiXX0scz1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSxpLHMsbyl7dmFyIGE9bihlKSxsPXJbdF1bbihlKV07cmV0dXJuIDI9PT1hJiYobD1sW2k/MDoxXSksbC5yZXBsYWNlKC8lZC9pLGUpfX0sbz1bItmD2KfZhtmI2YYg2KfZhNir2KfZhtmKINmK2YbYp9mK2LEiLCLYtNio2KfYtyDZgdio2LHYp9mK2LEiLCLYotiw2KfYsSDZhdin2LHYsyIsItmG2YrYs9in2YYg2KPYqNix2YrZhCIsItij2YrYp9ixINmF2KfZitmIIiwi2K3YstmK2LHYp9mGINmK2YjZhtmK2YgiLCLYqtmF2YjYsiDZitmI2YTZitmIIiwi2KLYqCDYo9i62LPYt9izIiwi2KPZitmE2YjZhCDYs9io2KrZhdio2LEiLCLYqti02LHZitmGINin2YTYo9mI2YQg2KPZg9iq2YjYqNixIiwi2KrYtNix2YrZhiDYp9mE2KvYp9mG2Yog2YbZiNmB2YXYqNixIiwi2YPYp9mG2YjZhiDYp9mE2KPZiNmEINiv2YrYs9mF2KjYsSJdLGE9dC5kZWZpbmVMb2NhbGUoImFyIix7bW9udGhzOm8sbW9udGhzU2hvcnQ6byx3ZWVrZGF5czoi2KfZhNij2K3Yr1/Yp9mE2KXYq9mG2YrZhl/Yp9mE2KvZhNin2KvYp9ihX9in2YTYo9ix2KjYudin2KFf2KfZhNiu2YXZitizX9in2YTYrNmF2LnYqV/Yp9mE2LPYqNiqIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6Itij2K3Yr1/Ypdir2YbZitmGX9ir2YTYp9ir2KfYoV/Yo9ix2KjYudin2KFf2K7ZhdmK2LNf2KzZhdi52Klf2LPYqNiqIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLYrV/Zhl/Yq1/YsV/Yrl/YrF/YsyIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJEL+KAj00v4oCPWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQgTU1NTSBZWVlZIEhIOm1tIn0sbWVyaWRpZW1QYXJzZTov2LV82YUvLGlzUE06ZnVuY3Rpb24odCl7cmV0dXJuItmFIj09PXR9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDwxMj8i2LUiOiLZhSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb2KfZhNmK2YjZhSDYudmG2K8g2KfZhNiz2KfYudipXSBMVCIsbmV4dERheToiW9i62K/Zi9inINi52YbYryDYp9mE2LPYp9i52KldIExUIixuZXh0V2VlazoiZGRkZCBb2LnZhtivINin2YTYs9in2LnYqV0gTFQiLGxhc3REYXk6IlvYo9mF2LMg2LnZhtivINin2YTYs9in2LnYqV0gTFQiLGxhc3RXZWVrOiJkZGRkIFvYudmG2K8g2KfZhNiz2KfYudipXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi2KjYudivICVzIixwYXN0OiLZhdmG2LAgJXMiLHM6cygicyIpLG06cygibSIpLG1tOnMoIm0iKSxoOnMoImgiKSxoaDpzKCJoIiksZDpzKCJkIiksZGQ6cygiZCIpLE06cygiTSIpLE1NOnMoIk0iKSx5OnMoInkiKSx5eTpzKCJ5Iil9LHByZXBhcnNlOmZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoL1x1MjAwZi9nLCIiKS5yZXBsYWNlKC9b2aHZotmj2aTZpdmm2afZqNmp2aBdL2csZnVuY3Rpb24odCl7cmV0dXJuIGlbdF19KS5yZXBsYWNlKC/YjC9nLCIsIil9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pLnJlcGxhY2UoLywvZywi2IwiKX0sd2Vlazp7ZG93OjYsZG95OjEyfX0pO3JldHVybiBhfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImFyLW1hIix7bW9udGhzOiLZitmG2KfZitixX9mB2KjYsdin2YrYsV/Zhdin2LHYs1/Yo9io2LHZitmEX9mF2KfZil/ZitmI2YbZitmIX9mK2YjZhNmK2YjYsl/Yuti02Kpf2LTYqtmG2KjYsV/Yo9mD2KrZiNio2LFf2YbZiNmG2KjYsV/Yr9is2YbYqNixIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLZitmG2KfZitixX9mB2KjYsdin2YrYsV/Zhdin2LHYs1/Yo9io2LHZitmEX9mF2KfZil/ZitmI2YbZitmIX9mK2YjZhNmK2YjYsl/Yuti02Kpf2LTYqtmG2KjYsV/Yo9mD2KrZiNio2LFf2YbZiNmG2KjYsV/Yr9is2YbYqNixIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLYp9mE2KPYrdivX9in2YTYpdiq2YbZitmGX9in2YTYq9mE2KfYq9in2KFf2KfZhNij2LHYqNi52KfYoV/Yp9mE2K7ZhdmK2LNf2KfZhNis2YXYudipX9in2YTYs9io2KoiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi2KfYrdivX9in2KrZhtmK2YZf2KvZhNin2KvYp9ihX9in2LHYqNi52KfYoV/YrtmF2YrYs1/YrNmF2LnYqV/Ys9io2KoiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46ItitX9mGX9irX9ixX9iuX9isX9izIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb2KfZhNmK2YjZhSDYudmE2Ykg2KfZhNiz2KfYudipXSBMVCIsbmV4dERheToiW9i62K/YpyDYudmE2Ykg2KfZhNiz2KfYudipXSBMVCIsbmV4dFdlZWs6ImRkZGQgW9i52YTZiSDYp9mE2LPYp9i52KldIExUIixsYXN0RGF5OiJb2KPZhdizINi52YTZiSDYp9mE2LPYp9i52KldIExUIixsYXN0V2VlazoiZGRkZCBb2LnZhNmJINin2YTYs9in2LnYqV0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ItmB2YogJXMiLHBhc3Q6ItmF2YbYsCAlcyIsczoi2KvZiNin2YYiLG06Itiv2YLZitmC2KkiLG1tOiIlZCDYr9mC2KfYptmCIixoOiLYs9in2LnYqSIsaGg6IiVkINiz2KfYudin2KoiLGQ6ItmK2YjZhSIsZGQ6IiVkINij2YrYp9mFIixNOiLYtNmH2LEiLE1NOiIlZCDYo9i02YfYsSIseToi2LPZhtipIix5eToiJWQg2LPZhtmI2KfYqiJ9LHdlZWs6e2Rvdzo2LGRveToxMn19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXsxOiLZoSIsMjoi2aIiLDM6ItmjIiw0OiLZpCIsNToi2aUiLDY6ItmmIiw3OiLZpyIsODoi2agiLDk6ItmpIiwwOiLZoCJ9LGk9eyLZoSI6IjEiLCLZoiI6IjIiLCLZoyI6IjMiLCLZpCI6IjQiLCLZpSI6IjUiLCLZpiI6IjYiLCLZpyI6IjciLCLZqCI6IjgiLCLZqSI6IjkiLCLZoCI6IjAifSxuPXQuZGVmaW5lTG9jYWxlKCJhci1zYSIse21vbnRoczoi2YrZhtin2YrYsV/Zgdio2LHYp9mK2LFf2YXYp9ix2LNf2KPYqNix2YrZhF/Zhdin2YrZiF/ZitmI2YbZitmIX9mK2YjZhNmK2Yhf2KPYutiz2LfYs1/Ys9io2KrZhdio2LFf2KPZg9iq2YjYqNixX9mG2YjZgdmF2KjYsV/Yr9mK2LPZhdio2LEiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6ItmK2YbYp9mK2LFf2YHYqNix2KfZitixX9mF2KfYsdizX9ij2KjYsdmK2YRf2YXYp9mK2Yhf2YrZiNmG2YrZiF/ZitmI2YTZitmIX9ij2LrYs9i32LNf2LPYqNiq2YXYqNixX9ij2YPYqtmI2KjYsV/ZhtmI2YHZhdio2LFf2K/Zitiz2YXYqNixIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLYp9mE2KPYrdivX9in2YTYpdir2YbZitmGX9in2YTYq9mE2KfYq9in2KFf2KfZhNij2LHYqNi52KfYoV/Yp9mE2K7ZhdmK2LNf2KfZhNis2YXYudipX9in2YTYs9io2KoiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi2KPYrdivX9il2KvZhtmK2YZf2KvZhNin2KvYp9ihX9ij2LHYqNi52KfYoV/YrtmF2YrYs1/YrNmF2LnYqV/Ys9io2KoiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46ItitX9mGX9irX9ixX9iuX9isX9izIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LG1lcmlkaWVtUGFyc2U6L9i1fNmFLyxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybiLZhSI9PT10fSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/Iti1Ijoi2YUifSxjYWxlbmRhcjp7c2FtZURheToiW9in2YTZitmI2YUg2LnZhNmJINin2YTYs9in2LnYqV0gTFQiLG5leHREYXk6IlvYutiv2Kcg2LnZhNmJINin2YTYs9in2LnYqV0gTFQiLG5leHRXZWVrOiJkZGRkIFvYudmE2Ykg2KfZhNiz2KfYudipXSBMVCIsbGFzdERheToiW9ij2YXYsyDYudmE2Ykg2KfZhNiz2KfYudipXSBMVCIsbGFzdFdlZWs6ImRkZGQgW9i52YTZiSDYp9mE2LPYp9i52KldIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLZgdmKICVzIixwYXN0OiLZhdmG2LAgJXMiLHM6Itir2YjYp9mGIixtOiLYr9mC2YrZgtipIixtbToiJWQg2K/Zgtin2KbZgiIsaDoi2LPYp9i52KkiLGhoOiIlZCDYs9in2LnYp9iqIixkOiLZitmI2YUiLGRkOiIlZCDYo9mK2KfZhSIsTToi2LTZh9ixIixNTToiJWQg2KPYtNmH2LEiLHk6Itiz2YbYqSIseXk6IiVkINiz2YbZiNin2KoifSxwcmVwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9b2aHZotmj2aTZpdmm2afZqNmp2aBdL2csZnVuY3Rpb24odCl7cmV0dXJuIGlbdF19KS5yZXBsYWNlKC/YjC9nLCIsIil9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pLnJlcGxhY2UoLywvZywi2IwiKX0sd2Vlazp7ZG93OjYsZG95OjEyfX0pO3JldHVybiBufSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImFyLXRuIix7bW9udGhzOiLYrNin2YbZgdmKX9mB2YrZgdix2Ypf2YXYp9ix2LNf2KPZgdix2YrZhF/Zhdin2Ypf2KzZiNin2YZf2KzZiNmK2YTZitipX9ij2YjYql/Ys9io2KrZhdio2LFf2KPZg9iq2YjYqNixX9mG2YjZgdmF2KjYsV/Yr9mK2LPZhdio2LEiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Itis2KfZhtmB2Ypf2YHZitmB2LHZil/Zhdin2LHYs1/Yo9mB2LHZitmEX9mF2KfZil/YrNmI2KfZhl/YrNmI2YrZhNmK2Klf2KPZiNiqX9iz2KjYqtmF2KjYsV/Yo9mD2KrZiNio2LFf2YbZiNmB2YXYqNixX9iv2YrYs9mF2KjYsSIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi2KfZhNij2K3Yr1/Yp9mE2KXYq9mG2YrZhl/Yp9mE2KvZhNin2KvYp9ihX9in2YTYo9ix2KjYudin2KFf2KfZhNiu2YXZitizX9in2YTYrNmF2LnYqV/Yp9mE2LPYqNiqIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6Itij2K3Yr1/Ypdir2YbZitmGX9ir2YTYp9ir2KfYoV/Yo9ix2KjYudin2KFf2K7ZhdmK2LNf2KzZhdi52Klf2LPYqNiqIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLYrV/Zhl/Yq1/YsV/Yrl/YrF/YsyIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQgRCBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW9in2YTZitmI2YUg2LnZhNmJINin2YTYs9in2LnYqV0gTFQiLG5leHREYXk6IlvYutiv2Kcg2LnZhNmJINin2YTYs9in2LnYqV0gTFQiLG5leHRXZWVrOiJkZGRkIFvYudmE2Ykg2KfZhNiz2KfYudipXSBMVCIsbGFzdERheToiW9ij2YXYsyDYudmE2Ykg2KfZhNiz2KfYudipXSBMVCIsbGFzdFdlZWs6ImRkZGQgW9i52YTZiSDYp9mE2LPYp9i52KldIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLZgdmKICVzIixwYXN0OiLZhdmG2LAgJXMiLHM6Itir2YjYp9mGIixtOiLYr9mC2YrZgtipIixtbToiJWQg2K/Zgtin2KbZgiIsaDoi2LPYp9i52KkiLGhoOiIlZCDYs9in2LnYp9iqIixkOiLZitmI2YUiLGRkOiIlZCDYo9mK2KfZhSIsTToi2LTZh9ixIixNTToiJWQg2KPYtNmH2LEiLHk6Itiz2YbYqSIseXk6IiVkINiz2YbZiNin2KoifSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXsxOiItaW5jaSIsNToiLWluY2kiLDg6Ii1pbmNpIiw3MDoiLWluY2kiLDgwOiItaW5jaSIsMjoiLW5jaSIsNzoiLW5jaSIsMjA6Ii1uY2kiLDUwOiItbmNpIiwzOiItw7xuY8O8Iiw0OiItw7xuY8O8IiwxMDA6Ii3DvG5jw7wiLDY6Ii1uY8SxIiw5OiItdW5jdSIsMTA6Ii11bmN1IiwzMDoiLXVuY3UiLDYwOiItxLFuY8SxIiw5MDoiLcSxbmPEsSJ9LGk9dC5kZWZpbmVMb2NhbGUoImF6Iix7bW9udGhzOiJ5YW52YXJfZmV2cmFsX21hcnRfYXByZWxfbWF5X2l5dW5faXl1bF9hdnF1c3Rfc2VudHlhYnJfb2t0eWFicl9ub3lhYnJfZGVrYWJyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJ5YW5fZmV2X21hcl9hcHJfbWF5X2l5bl9peWxfYXZxX3Nlbl9va3Rfbm95X2RlayIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiQmF6YXJfQmF6YXIgZXJ0yZlzaV/Dh8mZcsWfyZluYsmZIGF4xZ9hbcSxX8OHyZlyxZ/JmW5iyZlfQ8O8bcmZIGF4xZ9hbcSxX0PDvG3JmV/FnsmZbmLJmSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJCYXpfQnpFX8OHQXhfw4fJmXJfQ0F4X0PDvG1fxZ7JmW4iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkJ6X0JFX8OHQV/Dh8mZX0NBX0PDvF/FnsmZIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW2J1Z8O8biBzYWF0XSBMVCIsbmV4dERheToiW3NhYmFoIHNhYXRdIExUIixuZXh0V2VlazoiW2fJmWzJmW4gaMmZZnTJmV0gZGRkZCBbc2FhdF0gTFQiLGxhc3REYXk6Iltkw7xuyZluXSBMVCIsbGFzdFdlZWs6IltrZcOnyZluIGjJmWZ0yZldIGRkZGQgW3NhYXRdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlcyBzb25yYSIscGFzdDoiJXMgyZl2dsmZbCIsczoiYmlybmXDp8mZIHNhbml5ecmZIixtOiJiaXIgZMmZcWlxyZkiLG1tOiIlZCBkyZlxaXHJmSIsaDoiYmlyIHNhYXQiLGhoOiIlZCBzYWF0IixkOiJiaXIgZ8O8biIsZGQ6IiVkIGfDvG4iLE06ImJpciBheSIsTU06IiVkIGF5Iix5OiJiaXIgaWwiLHl5OiIlZCBpbCJ9LG1lcmlkaWVtUGFyc2U6L2dlY8mZfHPJmWjJmXJ8Z8O8bmTDvHp8YXjFn2FtLyxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybi9eKGfDvG5kw7x6fGF4xZ9hbSkkLy50ZXN0KHQpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8iZ2VjyZkiOnQ8MTI/InPJmWjJmXIiOnQ8MTc/ImfDvG5kw7x6IjoiYXjFn2FtIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LSjEsW5jxLF8aW5jaXxuY2l8w7xuY8O8fG5jxLF8dW5jdSkvLG9yZGluYWw6ZnVuY3Rpb24odCl7aWYoMD09PXQpcmV0dXJuIHQrIi3EsW5jxLEiO3ZhciBpPXQlMTAsbj10JTEwMC1pLHI9dD49MTAwPzEwMDpudWxsO3JldHVybiB0KyhlW2ldfHxlW25dfHxlW3JdKX0sd2Vlazp7ZG93OjEsZG95Ojd9fSk7cmV0dXJuIGl9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQsZSl7dmFyIGk9dC5zcGxpdCgiXyIpO3JldHVybiBlJTEwPT09MSYmZSUxMDAhPT0xMT9pWzBdOmUlMTA+PTImJmUlMTA8PTQmJihlJTEwMDwxMHx8ZSUxMDA+PTIwKT9pWzFdOmlbMl19ZnVuY3Rpb24gaSh0LGksbil7dmFyIHI9e21tOmk/ItGF0LLRltC70ZbQvdCwX9GF0LLRltC70ZbQvdGLX9GF0LLRltC70ZbQvSI6ItGF0LLRltC70ZbQvdGDX9GF0LLRltC70ZbQvdGLX9GF0LLRltC70ZbQvSIsaGg6aT8i0LPQsNC00LfRltC90LBf0LPQsNC00LfRltC90Ytf0LPQsNC00LfRltC9Ijoi0LPQsNC00LfRltC90YNf0LPQsNC00LfRltC90Ytf0LPQsNC00LfRltC9IixkZDoi0LTQt9C10L3RjF/QtNC90ZZf0LTQt9GR0L0iLE1NOiLQvNC10YHRj9GGX9C80LXRgdGP0YbRi1/QvNC10YHRj9GG0LDRniIseXk6ItCz0L7QtF/Qs9Cw0LTRi1/Qs9Cw0LTQvtGeIn07cmV0dXJuIm0iPT09bj9pPyLRhdCy0ZbQu9GW0L3QsCI6ItGF0LLRltC70ZbQvdGDIjoiaCI9PT1uP2k/ItCz0LDQtNC30ZbQvdCwIjoi0LPQsNC00LfRltC90YMiOnQrIiAiK2UocltuXSwrdCl9dmFyIG49dC5kZWZpbmVMb2NhbGUoImJlIix7bW9udGhzOntmb3JtYXQ6ItGB0YLRg9C00LfQtdC90Y9f0LvRjtGC0LDQs9CwX9GB0LDQutCw0LLRltC60LBf0LrRgNCw0YHQsNCy0ZbQutCwX9GC0YDQsNGe0L3Rj1/Rh9GN0YDQstC10L3Rj1/Qu9GW0L/QtdC90Y9f0LbQvdGW0Z7QvdGPX9Cy0LXRgNCw0YHQvdGPX9C60LDRgdGC0YDRi9GH0L3RltC60LBf0LvRltGB0YLQsNC/0LDQtNCwX9GB0L3QtdC20L3RjyIuc3BsaXQoIl8iKSxzdGFuZGFsb25lOiLRgdGC0YPQtNC30LXQvdGMX9C70Y7RgtGLX9GB0LDQutCw0LLRltC6X9C60YDQsNGB0LDQstGW0Lpf0YLRgNCw0LLQtdC90Yxf0YfRjdGA0LLQtdC90Yxf0LvRltC/0LXQvdGMX9C20L3RltCy0LXQvdGMX9Cy0LXRgNCw0YHQtdC90Yxf0LrQsNGB0YLRgNGL0YfQvdGW0Lpf0LvRltGB0YLQsNC/0LDQtF/RgdC90LXQttCw0L3RjCIuc3BsaXQoIl8iKX0sbW9udGhzU2hvcnQ6ItGB0YLRg9C0X9C70Y7Rgl/RgdCw0Lpf0LrRgNCw0YFf0YLRgNCw0LJf0YfRjdGA0LJf0LvRltC/X9C20L3RltCyX9Cy0LXRgF/QutCw0YHRgl/Qu9GW0YHRgl/RgdC90LXQtiIuc3BsaXQoIl8iKSx3ZWVrZGF5czp7Zm9ybWF0OiLQvdGP0LTQt9C10LvRjl/Qv9Cw0L3Rj9C00LfQtdC70LDQul/QsNGe0YLQvtGA0LDQul/RgdC10YDQsNC00YNf0YfQsNGG0LLQtdGAX9C/0Y/RgtC90ZbRhtGDX9GB0YPQsdC+0YLRgyIuc3BsaXQoIl8iKSxzdGFuZGFsb25lOiLQvdGP0LTQt9C10LvRj1/Qv9Cw0L3Rj9C00LfQtdC70LDQul/QsNGe0YLQvtGA0LDQul/RgdC10YDQsNC00LBf0YfQsNGG0LLQtdGAX9C/0Y/RgtC90ZbRhtCwX9GB0YPQsdC+0YLQsCIuc3BsaXQoIl8iKSxpc0Zvcm1hdDovXFsgP1vQktCyXSA/KD860LzRltC90YPQu9GD0Y580L3QsNGB0YLRg9C/0L3Rg9GOKT8gP1xdID9kZGRkL30sd2Vla2RheXNTaG9ydDoi0L3QtF/Qv9C9X9Cw0YJf0YHRgF/Rh9GGX9C/0YJf0YHQsSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi0L3QtF/Qv9C9X9Cw0YJf0YHRgF/Rh9GGX9C/0YJf0YHQsSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRCBNTU1NIFlZWVkg0LMuIixMTEw6IkQgTU1NTSBZWVlZINCzLiwgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZINCzLiwgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW9Ch0ZHQvdC90Y8g0Z5dIExUIixuZXh0RGF5OiJb0JfQsNGe0YLRgNCwINGeXSBMVCIsbGFzdERheToiW9Cj0YfQvtGA0LAg0Z5dIExUIixuZXh0V2VlazpmdW5jdGlvbigpe3JldHVybiJb0KNdIGRkZGQgW9GeXSBMVCJ9LGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpjYXNlIDM6Y2FzZSA1OmNhc2UgNjpyZXR1cm4iW9CjINC80ZbQvdGD0LvRg9GOXSBkZGRkIFvRnl0gTFQiO2Nhc2UgMTpjYXNlIDI6Y2FzZSA0OnJldHVybiJb0KMg0LzRltC90YPQu9GLXSBkZGRkIFvRnl0gTFQifX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi0L/RgNCw0LcgJXMiLHBhc3Q6IiVzINGC0LDQvNGDIixzOiLQvdC10LrQsNC70YzQutGWINGB0LXQutGD0L3QtCIsbTppLG1tOmksaDppLGhoOmksZDoi0LTQt9C10L3RjCIsZGQ6aSxNOiLQvNC10YHRj9GGIixNTTppLHk6ItCz0L7QtCIseXk6aX0sbWVyaWRpZW1QYXJzZTov0L3QvtGH0Yt80YDQsNC90ZbRhtGLfNC00L3Rj3zQstC10YfQsNGA0LAvLGlzUE06ZnVuY3Rpb24odCl7cmV0dXJuL14o0LTQvdGPfNCy0LXRh9Cw0YDQsCkkLy50ZXN0KHQpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8i0L3QvtGH0YsiOnQ8MTI/ItGA0LDQvdGW0YbRiyI6dDwxNz8i0LTQvdGPIjoi0LLQtdGH0LDRgNCwIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LSjRlnzRi3zQs9CwKS8sb3JkaW5hbDpmdW5jdGlvbih0LGUpe3N3aXRjaChlKXtjYXNlIk0iOmNhc2UiZCI6Y2FzZSJEREQiOmNhc2UidyI6Y2FzZSJXIjpyZXR1cm4gdCUxMCE9PTImJnQlMTAhPT0zfHx0JTEwMD09PTEyfHx0JTEwMD09PTEzP3QrIi3RiyI6dCsiLdGWIjtjYXNlIkQiOnJldHVybiB0KyIt0LPQsCI7ZGVmYXVsdDpyZXR1cm4gdH19LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBufSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImJnIix7bW9udGhzOiLRj9C90YPQsNGA0Lhf0YTQtdCy0YDRg9Cw0YDQuF/QvNCw0YDRgl/QsNC/0YDQuNC7X9C80LDQuV/RjtC90Lhf0Y7Qu9C4X9Cw0LLQs9GD0YHRgl/RgdC10L/RgtC10LzQstGA0Lhf0L7QutGC0L7QvNCy0YDQuF/QvdC+0LXQvNCy0YDQuF/QtNC10LrQtdC80LLRgNC4Ii5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLRj9C90YBf0YTQtdCyX9C80LDRgF/QsNC/0YBf0LzQsNC5X9GO0L3QuF/RjtC70Lhf0LDQstCzX9GB0LXQv1/QvtC60YJf0L3QvtC1X9C00LXQuiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi0L3QtdC00LXQu9GPX9C/0L7QvdC10LTQtdC70L3QuNC6X9Cy0YLQvtGA0L3QuNC6X9GB0YDRj9C00LBf0YfQtdGC0LLRitGA0YLRitC6X9C/0LXRgtGK0Lpf0YHRitCx0L7RgtCwIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6ItC90LXQtF/Qv9C+0L1f0LLRgtC+X9GB0YDRj1/Rh9C10YJf0L/QtdGCX9GB0YrQsSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi0L3QtF/Qv9C9X9Cy0YJf0YHRgF/Rh9GCX9C/0YJf0YHQsSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6Ikg6bW0iLExUUzoiSDptbTpzcyIsTDoiRC5NTS5ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgSDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb0JTQvdC10YEg0LJdIExUIixuZXh0RGF5OiJb0KPRgtGA0LUg0LJdIExUIixuZXh0V2VlazoiZGRkZCBb0LJdIExUIixsYXN0RGF5OiJb0JLRh9C10YDQsCDQsl0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpjYXNlIDM6Y2FzZSA2OnJldHVybiJb0JIg0LjQt9C80LjQvdCw0LvQsNGC0LBdIGRkZGQgW9CyXSBMVCI7Y2FzZSAxOmNhc2UgMjpjYXNlIDQ6Y2FzZSA1OnJldHVybiJb0JIg0LjQt9C80LjQvdCw0LvQuNGPXSBkZGRkIFvQsl0gTFQifX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi0YHQu9C10LQgJXMiLHBhc3Q6ItC/0YDQtdC00LggJXMiLHM6ItC90Y/QutC+0LvQutC+INGB0LXQutGD0L3QtNC4IixtOiLQvNC40L3Rg9GC0LAiLG1tOiIlZCDQvNC40L3Rg9GC0LgiLGg6ItGH0LDRgSIsaGg6IiVkINGH0LDRgdCwIixkOiLQtNC10L0iLGRkOiIlZCDQtNC90LgiLE06ItC80LXRgdC10YYiLE1NOiIlZCDQvNC10YHQtdGG0LAiLHk6ItCz0L7QtNC40L3QsCIseXk6IiVkINCz0L7QtNC40L3QuCJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfS0o0LXQsnzQtdC9fNGC0Lh80LLQuHzRgNC4fNC80LgpLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3ZhciBlPXQlMTAsaT10JTEwMDtyZXR1cm4gMD09PXQ/dCsiLdC10LIiOjA9PT1pP3QrIi3QtdC9IjppPjEwJiZpPDIwP3QrIi3RgtC4IjoxPT09ZT90KyIt0LLQuCI6Mj09PWU/dCsiLdGA0LgiOjc9PT1lfHw4PT09ZT90KyIt0LzQuCI6dCsiLdGC0LgifSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXsxOiLgp6ciLDI6IuCnqCIsMzoi4KepIiw0OiLgp6oiLDU6IuCnqyIsNjoi4KesIiw3OiLgp60iLDg6IuCnriIsOToi4KevIiwwOiLgp6YifSxpPXsi4KenIjoiMSIsIuCnqCI6IjIiLCLgp6kiOiIzIiwi4KeqIjoiNCIsIuCnqyI6IjUiLCLgp6wiOiI2Iiwi4KetIjoiNyIsIuCnriI6IjgiLCLgp68iOiI5Iiwi4KemIjoiMCJ9LG49dC5kZWZpbmVMb2NhbGUoImJuIix7bW9udGhzOiLgppzgpr7gpqjgp4Hgp5/gpr7gprDgp4Bf4Kar4KeH4Kas4KeB4Kef4Ka+4Kaw4KeAX+CmruCmvuCmsOCnjeCmml/gpo/gpqrgp43gprDgpr/gprJf4Kau4KeHX+CmnOCngeCmqF/gppzgp4HgprLgpr7gpodf4KaF4KaX4Ka+4Ka44KeN4KafX+CmuOCnh+CmquCnjeCmn+Cnh+CmruCnjeCmrOCmsF/gpoXgppXgp43gpp/gp4vgpqzgprBf4Kao4Kat4KeH4Kau4KeN4Kas4KawX+CmoeCmv+CmuOCnh+CmruCnjeCmrOCmsCIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoi4Kac4Ka+4Kao4KeBX+Cmq+Cnh+CmrF/gpq7gpr7gprDgp43gpppf4KaP4Kaq4KawX+CmruCnh1/gppzgp4Hgpqhf4Kac4KeB4KayX+CmheCml1/gprjgp4fgpqrgp43gpp9f4KaF4KaV4KeN4Kaf4KeLX+CmqOCmrV/gpqHgpr/gprjgp4fgpq7gp40iLnNwbGl0KCJfIiksd2Vla2RheXM6IuCmsOCmrOCmv+CmrOCmvuCmsF/gprjgp4vgpq7gpqzgpr7gprBf4Kau4KaZ4KeN4KaX4Kay4Kas4Ka+4KawX+CmrOCngeCmp+CmrOCmvuCmsF/gpqzgp4Pgprngprjgp43gpqrgpqTgp43gpqTgpr/gpqzgpr7gprBf4Ka24KeB4KaV4KeN4Kaw4Kas4Ka+4KawX+CmtuCmqOCmv+CmrOCmvuCmsCIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLgprDgpqzgpr9f4Ka44KeL4KauX+CmruCmmeCnjeCml+Cmsl/gpqzgp4Hgpqdf4Kas4KeD4Ka54Ka44KeN4Kaq4Kak4KeN4Kak4Ka/X+CmtuCngeCmleCnjeCmsF/gprbgpqjgpr8iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IuCmsOCmrF/gprjgpq5f4Kau4KaZ4KeN4KaXX+CmrOCngV/gpqzgp43gprDgpr/gprlf4Ka24KeBX+CmtuCmqOCmvyIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkEgaDptbSDgprjgpq7gp58iLExUUzoiQSBoOm1tOnNzIOCmuOCmruCnnyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZLCBBIGg6bW0g4Ka44Kau4KefIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSwgQSBoOm1tIOCmuOCmruCnnyJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4KaG4KacXSBMVCIsbmV4dERheToiW+CmhuCml+CmvuCmruCngOCmleCmvuCmsl0gTFQiLG5leHRXZWVrOiJkZGRkLCBMVCIsbGFzdERheToiW+Cml+CmpOCmleCmvuCmsl0gTFQiLGxhc3RXZWVrOiJb4KaX4KakXSBkZGRkLCBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMg4Kaq4Kaw4KeHIixwYXN0OiIlcyDgpobgppfgp4ciLHM6IuCmleCnn+Cnh+CmlSDgprjgp4fgppXgp4fgpqjgp43gpqEiLG06IuCmj+CmlSDgpq7gpr/gpqjgpr/gpp8iLG1tOiIlZCDgpq7gpr/gpqjgpr/gpp8iLGg6IuCmj+CmlSDgppjgpqjgp43gpp/gpr4iLGhoOiIlZCDgppjgpqjgp43gpp/gpr4iLGQ6IuCmj+CmlSDgpqbgpr/gpqgiLGRkOiIlZCDgpqbgpr/gpqgiLE06IuCmj+CmlSDgpq7gpr7gprgiLE1NOiIlZCDgpq7gpr7gprgiLHk6IuCmj+CmlSDgpqzgppvgprAiLHl5OiIlZCDgpqzgppvgprAifSxwcmVwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9b4Ken4Keo4Kep4Keq4Ker4Kes4Ket4Keu4Kev4KemXS9nLGZ1bmN0aW9uKHQpe3JldHVybiBpW3RdfSl9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pfSxtZXJpZGllbVBhcnNlOi/gprDgpr7gpqR84Ka44KaV4Ka+4KayfOCmpuCngeCmquCngeCmsHzgpqzgpr/gppXgpr7gprJ84Kaw4Ka+4KakLyxtZXJpZGllbUhvdXI6ZnVuY3Rpb24odCxlKXtyZXR1cm4gMTI9PT10JiYodD0wKSwi4Kaw4Ka+4KakIj09PWUmJnQ+PTR8fCLgpqbgp4Hgpqrgp4HgprAiPT09ZSYmdDw1fHwi4Kas4Ka/4KaV4Ka+4KayIj09PWU/dCsxMjp0fSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8i4Kaw4Ka+4KakIjp0PDEwPyLgprjgppXgpr7gprIiOnQ8MTc/IuCmpuCngeCmquCngeCmsCI6dDwyMD8i4Kas4Ka/4KaV4Ka+4KayIjoi4Kaw4Ka+4KakIn0sd2Vlazp7ZG93OjAsZG95OjZ9fSk7cmV0dXJuIG59KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT17MToi4LyhIiwyOiLgvKIiLDM6IuC8oyIsNDoi4LykIiw1OiLgvKUiLDY6IuC8piIsNzoi4LynIiw4OiLgvKgiLDk6IuC8qSIsMDoi4LygIn0saT17IuC8oSI6IjEiLCLgvKIiOiIyIiwi4LyjIjoiMyIsIuC8pCI6IjQiLCLgvKUiOiI1Iiwi4LymIjoiNiIsIuC8pyI6IjciLCLgvKgiOiI4Iiwi4LypIjoiOSIsIuC8oCI6IjAifSxuPXQuZGVmaW5lTG9jYWxlKCJibyIse21vbnRoczoi4L2f4L6z4LyL4L2W4LyL4L2R4L2E4LyL4L2U4L28X+C9n+C+s+C8i+C9luC8i+C9guC9ieC9suC9puC8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvYLgvabgvbTgvZjgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2W4L2e4L2y4LyL4L2UX+C9n+C+s+C8i+C9luC8i+C9o+C+lOC8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvZHgvrLgvbTgvYLgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2W4L2R4L204L2T4LyL4L2UX+C9n+C+s+C8i+C9luC8i+C9luC9ouC+kuC+seC9keC8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvZHgvYLgvbTgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2W4L2F4L204LyL4L2UX+C9n+C+s+C8i+C9luC8i+C9luC9heC9tOC8i+C9guC9heC9suC9guC8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvZbgvYXgvbTgvIvgvYLgvYngvbLgvabgvIvgvZQiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IuC9n+C+s+C8i+C9luC8i+C9keC9hOC8i+C9lOC9vF/gvZ/gvrPgvIvgvZbgvIvgvYLgvYngvbLgvabgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2C4L2m4L204L2Y4LyL4L2UX+C9n+C+s+C8i+C9luC8i+C9luC9nuC9suC8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvaPgvpTgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2R4L6y4L204L2C4LyL4L2UX+C9n+C+s+C8i+C9luC8i+C9luC9keC9tOC9k+C8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvZbgvaLgvpLgvrHgvZHgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2R4L2C4L204LyL4L2UX+C9n+C+s+C8i+C9luC8i+C9luC9heC9tOC8i+C9lF/gvZ/gvrPgvIvgvZbgvIvgvZbgvYXgvbTgvIvgvYLgvYXgvbLgvYLgvIvgvZRf4L2f4L6z4LyL4L2W4LyL4L2W4L2F4L204LyL4L2C4L2J4L2y4L2m4LyL4L2UIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLgvYLgvZ/gvaDgvIvgvYngvbLgvIvgvZjgvItf4L2C4L2f4L2g4LyL4L2f4L6z4LyL4L2W4LyLX+C9guC9n+C9oOC8i+C9mOC9suC9guC8i+C9keC9mOC9ouC8i1/gvYLgvZ/gvaDgvIvgvaPgvrfgvYLgvIvgvZTgvItf4L2C4L2f4L2g4LyL4L2V4L204L2i4LyL4L2W4L20X+C9guC9n+C9oOC8i+C9lOC8i+C9puC9hOC9puC8i1/gvYLgvZ/gvaDgvIvgvabgvqTgvbrgvZPgvIvgvZTgvIsiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi4L2J4L2y4LyL4L2Y4LyLX+C9n+C+s+C8i+C9luC8i1/gvZjgvbLgvYLgvIvgvZHgvZjgvaLgvItf4L2j4L634L2C4LyL4L2U4LyLX+C9leC9tOC9ouC8i+C9luC9tF/gvZTgvIvgvabgvYTgvabgvItf4L2m4L6k4L264L2T4LyL4L2U4LyLIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLgvYngvbLgvIvgvZjgvItf4L2f4L6z4LyL4L2W4LyLX+C9mOC9suC9guC8i+C9keC9mOC9ouC8i1/gvaPgvrfgvYLgvIvgvZTgvItf4L2V4L204L2i4LyL4L2W4L20X+C9lOC8i+C9puC9hOC9puC8i1/gvabgvqTgvbrgvZPgvIvgvZTgvIsiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJBIGg6bW0iLExUUzoiQSBoOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVksIEEgaDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVksIEEgaDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4L2R4L2y4LyL4L2i4L2y4L2EXSBMVCIsbmV4dERheToiW+C9puC9hOC8i+C9ieC9suC9k10gTFQiLG5leHRXZWVrOiJb4L2W4L2R4L204L2T4LyL4L2V4L6y4L2C4LyL4L2i4L6X4L264L2m4LyL4L2YXSwgTFQiLGxhc3REYXk6IlvgvYHgvIvgvabgvYRdIExUIixsYXN0V2VlazoiW+C9luC9keC9tOC9k+C8i+C9leC+suC9guC8i+C9mOC9kOC9oOC8i+C9mF0gZGRkZCwgTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVzIOC9o+C8iyIscGFzdDoiJXMg4L2m4L6U4L2T4LyL4L2jIixzOiLgvaPgvZjgvIvgvabgvYQiLG06IuC9puC+kOC9ouC8i+C9mOC8i+C9guC9heC9suC9giIsbW06IiVkIOC9puC+kOC9ouC8i+C9mCIsaDoi4L2G4L204LyL4L2a4L284L2R4LyL4L2C4L2F4L2y4L2CIixoaDoiJWQg4L2G4L204LyL4L2a4L284L2RIixkOiLgvYngvbLgvZPgvIvgvYLgvYXgvbLgvYIiLGRkOiIlZCDgvYngvbLgvZPgvIsiLE06IuC9n+C+s+C8i+C9luC8i+C9guC9heC9suC9giIsTU06IiVkIOC9n+C+s+C8i+C9liIseToi4L2j4L284LyL4L2C4L2F4L2y4L2CIix5eToiJWQg4L2j4L28In0scHJlcGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvW+C8oeC8ouC8o+C8pOC8peC8puC8p+C8qOC8qeC8oF0vZyxmdW5jdGlvbih0KXtyZXR1cm4gaVt0XX0pfSxwb3N0Zm9ybWF0OmZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoL1xkL2csZnVuY3Rpb24odCl7cmV0dXJuIGVbdF19KX0sbWVyaWRpZW1QYXJzZTov4L2Y4L2a4L2T4LyL4L2Y4L28fOC9nuC9vOC9guC9puC8i+C9gOC9pnzgvYngvbLgvZPgvIvgvYLgvbTgvYR84L2R4L2C4L284L2E4LyL4L2R4L2CfOC9mOC9muC9k+C8i+C9mOC9vC8sbWVyaWRpZW1Ib3VyOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIDEyPT09dCYmKHQ9MCksIuC9mOC9muC9k+C8i+C9mOC9vCI9PT1lJiZ0Pj00fHwi4L2J4L2y4L2T4LyL4L2C4L204L2EIj09PWUmJnQ8NXx8IuC9keC9guC9vOC9hOC8i+C9keC9giI9PT1lP3QrMTI6dH0sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PDQ/IuC9mOC9muC9k+C8i+C9mOC9vCI6dDwxMD8i4L2e4L284L2C4L2m4LyL4L2A4L2mIjp0PDE3PyLgvYngvbLgvZPgvIvgvYLgvbTgvYQiOnQ8MjA/IuC9keC9guC9vOC9hOC8i+C9keC9giI6IuC9mOC9muC9k+C8i+C9mOC9vCJ9LHdlZWs6e2RvdzowLGRveTo2fX0pO3JldHVybiBufSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZSh0LGUsaSl7dmFyIG49e21tOiJtdW51dGVubiIsTU06Im1peiIsZGQ6ImRldmV6aCJ9O3JldHVybiB0KyIgIityKG5baV0sdCl9ZnVuY3Rpb24gaSh0KXtzd2l0Y2gobih0KSl7Y2FzZSAxOmNhc2UgMzpjYXNlIDQ6Y2FzZSA1OmNhc2UgOTpyZXR1cm4gdCsiIGJsb2F6IjtkZWZhdWx0OnJldHVybiB0KyIgdmxvYXoifX1mdW5jdGlvbiBuKHQpe3JldHVybiB0Pjk/bih0JTEwKTp0fWZ1bmN0aW9uIHIodCxlKXtyZXR1cm4gMj09PWU/cyh0KTp0fWZ1bmN0aW9uIHModCl7dmFyIGU9e206InYiLGI6InYiLGQ6InoifTtyZXR1cm4gdm9pZCAwPT09ZVt0LmNoYXJBdCgwKV0/dDplW3QuY2hhckF0KDApXSt0LnN1YnN0cmluZygxKX12YXIgbz10LmRlZmluZUxvY2FsZSgiYnIiLHttb250aHM6IkdlbnZlcl9DJ2h3ZXZyZXJfTWV1cnpoX0VicmVsX01hZV9NZXpoZXZlbl9Hb3VlcmVfRW9zdF9Hd2VuZ29sb19IZXJlX0R1X0tlcnp1Ii5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJHZW5fQydod2VfTWV1X0Vicl9NYWVfRXZlX0dvdV9Fb3NfR3dlX0hlcl9EdV9LZXIiLnNwbGl0KCJfIiksd2Vla2RheXM6IlN1bF9MdW5fTWV1cnpoX01lcmMnaGVyX1lhb3VfR3dlbmVyX1NhZG9ybiIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJTdWxfTHVuX01ldV9NZXJfWWFvX0d3ZV9TYWQiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IlN1X0x1X01lX01lcl9ZYV9Hd19TYSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6ImhbZV1tbSBBIixMVFM6ImhbZV1tbTpzcyBBIixMOiJERC9NTS9ZWVlZIixMTDoiRCBbYSB2aXpdIE1NTU0gWVlZWSIsTExMOiJEIFthIHZpel0gTU1NTSBZWVlZIGhbZV1tbSBBIixMTExMOiJkZGRkLCBEIFthIHZpel0gTU1NTSBZWVlZIGhbZV1tbSBBIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltIaXppdiBkYV0gTFQiLG5leHREYXk6IltXYXJjJ2hvYXpoIGRhXSBMVCIsbmV4dFdlZWs6ImRkZGQgW2RhXSBMVCIsbGFzdERheToiW0RlYydoIGRhXSBMVCIsbGFzdFdlZWs6ImRkZGQgW3Bhc2V0IGRhXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiYS1iZW5uICVzIixwYXN0OiIlcyAnem8iLHM6InVuIG5lYmV1ZCBzZWdvbmRlbm5vw7kiLG06InVyIHZ1bnV0ZW5uIixtbTplLGg6InVuIGV1ciIsaGg6IiVkIGV1ciIsZDoidW4gZGV2ZXpoIixkZDplLE06InVyIG1peiIsTU06ZSx5OiJ1ciBibG9heiIseXk6aX0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9KGHDsXx2ZXQpLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3ZhciBlPTE9PT10PyJhw7EiOiJ2ZXQiO3JldHVybiB0K2V9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBvfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZSh0LGUsaSl7dmFyIG49dCsiICI7c3dpdGNoKGkpe2Nhc2UibSI6cmV0dXJuIGU/ImplZG5hIG1pbnV0YSI6ImplZG5lIG1pbnV0ZSI7Y2FzZSJtbSI6cmV0dXJuIG4rPTE9PT10PyJtaW51dGEiOjI9PT10fHwzPT09dHx8ND09PXQ/Im1pbnV0ZSI6Im1pbnV0YSI7Y2FzZSJoIjpyZXR1cm4gZT8iamVkYW4gc2F0IjoiamVkbm9nIHNhdGEiO2Nhc2UiaGgiOnJldHVybiBuKz0xPT09dD8ic2F0IjoyPT09dHx8Mz09PXR8fDQ9PT10PyJzYXRhIjoic2F0aSI7Y2FzZSJkZCI6cmV0dXJuIG4rPTE9PT10PyJkYW4iOiJkYW5hIjtjYXNlIk1NIjpyZXR1cm4gbis9MT09PXQ/Im1qZXNlYyI6Mj09PXR8fDM9PT10fHw0PT09dD8ibWplc2VjYSI6Im1qZXNlY2kiO2Nhc2UieXkiOnJldHVybiBuKz0xPT09dD8iZ29kaW5hIjoyPT09dHx8Mz09PXR8fDQ9PT10PyJnb2RpbmUiOiJnb2RpbmEifX12YXIgaT10LmRlZmluZUxvY2FsZSgiYnMiLHttb250aHM6ImphbnVhcl9mZWJydWFyX21hcnRfYXByaWxfbWFqX2p1bmlfanVsaV9hdWd1c3Rfc2VwdGVtYmFyX29rdG9iYXJfbm92ZW1iYXJfZGVjZW1iYXIiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Imphbi5fZmViLl9tYXIuX2Fwci5fbWFqLl9qdW4uX2p1bC5fYXVnLl9zZXAuX29rdC5fbm92Ll9kZWMuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJuZWRqZWxqYV9wb25lZGplbGpha191dG9yYWtfc3JpamVkYV/EjWV0dnJ0YWtfcGV0YWtfc3Vib3RhIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6Im5lZC5fcG9uLl91dG8uX3NyaS5fxI1ldC5fcGV0Ll9zdWIuIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJuZV9wb191dF9zcl/EjWVfcGVfc3UiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IkRELiBNTS4gWVlZWSIsTEw6IkQuIE1NTU0gWVlZWSIsTExMOiJELiBNTU1NIFlZWVkgSDptbSIsTExMTDoiZGRkZCwgRC4gTU1NTSBZWVlZIEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW2RhbmFzIHVdIExUIixuZXh0RGF5OiJbc3V0cmEgdV0gTFQiLG5leHRXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpyZXR1cm4iW3VdIFtuZWRqZWxqdV0gW3VdIExUIjtjYXNlIDM6cmV0dXJuIlt1XSBbc3JpamVkdV0gW3VdIExUIjtjYXNlIDY6cmV0dXJuIlt1XSBbc3Vib3R1XSBbdV0gTFQiO2Nhc2UgMTpjYXNlIDI6Y2FzZSA0OmNhc2UgNTpyZXR1cm4iW3VdIGRkZGQgW3VdIExUIn19LGxhc3REYXk6IltqdcSNZXIgdV0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpjYXNlIDM6cmV0dXJuIltwcm/FoWx1XSBkZGRkIFt1XSBMVCI7Y2FzZSA2OnJldHVybiJbcHJvxaFsZV0gW3N1Ym90ZV0gW3VdIExUIjtjYXNlIDE6Y2FzZSAyOmNhc2UgNDpjYXNlIDU6cmV0dXJuIltwcm/FoWxpXSBkZGRkIFt1XSBMVCJ9fSxzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJ6YSAlcyIscGFzdDoicHJpamUgJXMiLHM6InBhciBzZWt1bmRpIixtOmUsbW06ZSxoOmUsaGg6ZSxkOiJkYW4iLGRkOmUsTToibWplc2VjIixNTTplLHk6ImdvZGludSIseXk6ZX0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95Ojd9fSk7cmV0dXJuIGl9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgiY2EiLHttb250aHM6ImdlbmVyX2ZlYnJlcl9tYXLDp19hYnJpbF9tYWlnX2p1bnlfanVsaW9sX2Fnb3N0X3NldGVtYnJlX29jdHVicmVfbm92ZW1icmVfZGVzZW1icmUiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Imdlbi5fZmVici5fbWFyLl9hYnIuX21haS5fanVuLl9qdWwuX2FnLl9zZXQuX29jdC5fbm92Ll9kZXMuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJkaXVtZW5nZV9kaWxsdW5zX2RpbWFydHNfZGltZWNyZXNfZGlqb3VzX2RpdmVuZHJlc19kaXNzYWJ0ZSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJkZy5fZGwuX2R0Ll9kYy5fZGouX2R2Ll9kcy4iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkRnX0RsX0R0X0RjX0RqX0R2X0RzIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSDptbSIsTFRTOiJIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6ZnVuY3Rpb24oKXtyZXR1cm4iW2F2dWkgYSAiKygxIT09dGhpcy5ob3VycygpPyJsZXMiOiJsYSIpKyJdIExUIn0sbmV4dERheTpmdW5jdGlvbigpe3JldHVybiJbZGVtw6AgYSAiKygxIT09dGhpcy5ob3VycygpPyJsZXMiOiJsYSIpKyJdIExUIn0sbmV4dFdlZWs6ZnVuY3Rpb24oKXtyZXR1cm4iZGRkZCBbYSAiKygxIT09dGhpcy5ob3VycygpPyJsZXMiOiJsYSIpKyJdIExUIn0sbGFzdERheTpmdW5jdGlvbigpe3JldHVybiJbYWhpciBhICIrKDEhPT10aGlzLmhvdXJzKCk/ImxlcyI6ImxhIikrIl0gTFQifSxsYXN0V2VlazpmdW5jdGlvbigpe3JldHVybiJbZWxdIGRkZGQgW3Bhc3NhdCBhICIrKDEhPT10aGlzLmhvdXJzKCk/ImxlcyI6ImxhIikrIl0gTFQifSxzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJlbiAlcyIscGFzdDoiZmEgJXMiLHM6InVucyBzZWdvbnMiLG06InVuIG1pbnV0IixtbToiJWQgbWludXRzIixoOiJ1bmEgaG9yYSIsaGg6IiVkIGhvcmVzIixkOiJ1biBkaWEiLGRkOiIlZCBkaWVzIixNOiJ1biBtZXMiLE1NOiIlZCBtZXNvcyIseToidW4gYW55Iix5eToiJWQgYW55cyJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfShyfG58dHzDqHxhKS8sb3JkaW5hbDpmdW5jdGlvbih0LGUpe3ZhciBpPTE9PT10PyJyIjoyPT09dD8ibiI6Mz09PXQ/InIiOjQ9PT10PyJ0Ijoiw6giO3JldHVybiJ3IiE9PWUmJiJXIiE9PWV8fChpPSJhIiksdCtpfSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCl7cmV0dXJuIHQ+MSYmdDw1JiYxIT09fn4odC8xMCl9ZnVuY3Rpb24gaSh0LGksbixyKXt2YXIgcz10KyIgIjtzd2l0Y2gobil7Y2FzZSJzIjpyZXR1cm4gaXx8cj8icMOhciBzZWt1bmQiOiJww6FyIHNla3VuZGFtaSI7Y2FzZSJtIjpyZXR1cm4gaT8ibWludXRhIjpyPyJtaW51dHUiOiJtaW51dG91IjtjYXNlIm1tIjpyZXR1cm4gaXx8cj9zKyhlKHQpPyJtaW51dHkiOiJtaW51dCIpOnMrIm1pbnV0YW1pIjtjYXNlImgiOnJldHVybiBpPyJob2RpbmEiOnI/ImhvZGludSI6ImhvZGlub3UiO2Nhc2UiaGgiOnJldHVybiBpfHxyP3MrKGUodCk/ImhvZGlueSI6ImhvZGluIik6cysiaG9kaW5hbWkiO2Nhc2UiZCI6cmV0dXJuIGl8fHI/ImRlbiI6ImRuZW0iO2Nhc2UiZGQiOnJldHVybiBpfHxyP3MrKGUodCk/ImRueSI6ImRuw60iKTpzKyJkbnkiO2Nhc2UiTSI6cmV0dXJuIGl8fHI/Im3Em3PDrWMiOiJtxJtzw61jZW0iO2Nhc2UiTU0iOnJldHVybiBpfHxyP3MrKGUodCk/Im3Em3PDrWNlIjoibcSbc8OtY8WvIik6cysibcSbc8OtY2kiO2Nhc2UieSI6cmV0dXJuIGl8fHI/InJvayI6InJva2VtIjtjYXNlInl5IjpyZXR1cm4gaXx8cj9zKyhlKHQpPyJyb2t5IjoibGV0Iik6cysibGV0eSJ9fXZhciBuPSJsZWRlbl/Dum5vcl9ixZllemVuX2R1YmVuX2t2xJt0ZW5fxI1lcnZlbl/EjWVydmVuZWNfc3JwZW5fesOhxZnDrV/FmcOtamVuX2xpc3RvcGFkX3Byb3NpbmVjIi5zcGxpdCgiXyIpLHI9ImxlZF/Dum5vX2LFmWVfZHViX2t2xJtfxI12bl/EjXZjX3NycF96w6HFmV/FmcOtal9saXNfcHJvIi5zcGxpdCgiXyIpLHM9dC5kZWZpbmVMb2NhbGUoImNzIix7bW9udGhzOm4sbW9udGhzU2hvcnQ6cixtb250aHNQYXJzZTpmdW5jdGlvbih0LGUpe3ZhciBpLG49W107Zm9yKGk9MDtpPDEyO2krKyluW2ldPW5ldyBSZWdFeHAoIl4iK3RbaV0rIiR8XiIrZVtpXSsiJCIsImkiKTtyZXR1cm4gbn0obixyKSxzaG9ydE1vbnRoc1BhcnNlOmZ1bmN0aW9uKHQpe3ZhciBlLGk9W107Zm9yKGU9MDtlPDEyO2UrKylpW2VdPW5ldyBSZWdFeHAoIl4iK3RbZV0rIiQiLCJpIik7cmV0dXJuIGl9KHIpLGxvbmdNb250aHNQYXJzZTpmdW5jdGlvbih0KXt2YXIgZSxpPVtdO2ZvcihlPTA7ZTwxMjtlKyspaVtlXT1uZXcgUmVnRXhwKCJeIit0W2VdKyIkIiwiaSIpO3JldHVybiBpfShuKSx3ZWVrZGF5czoibmVkxJtsZV9wb25kxJtsw61fw7p0ZXLDvV9zdMWZZWRhX8SNdHZydGVrX3DDoXRla19zb2JvdGEiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoibmVfcG9fw7p0X3N0X8SNdF9ww6Ffc28iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46Im5lX3BvX8O6dF9zdF/EjXRfcMOhX3NvIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSDptbSIsTFRTOiJIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRC4gTU1NTSBZWVlZIixMTEw6IkQuIE1NTU0gWVlZWSBIOm1tIixMTExMOiJkZGRkIEQuIE1NTU0gWVlZWSBIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltkbmVzIHZdIExUIixuZXh0RGF5OiJbesOtdHJhIHZdIExUIixuZXh0V2VlazpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6cmV0dXJuIlt2IG5lZMSbbGkgdl0gTFQiO2Nhc2UgMTpjYXNlIDI6cmV0dXJuIlt2XSBkZGRkIFt2XSBMVCI7Y2FzZSAzOnJldHVybiJbdmUgc3TFmWVkdSB2XSBMVCI7Y2FzZSA0OnJldHVybiJbdmUgxI10dnJ0ZWsgdl0gTFQiO2Nhc2UgNTpyZXR1cm4iW3YgcMOhdGVrIHZdIExUIjtjYXNlIDY6cmV0dXJuIlt2IHNvYm90dSB2XSBMVCJ9fSxsYXN0RGF5OiJbdsSNZXJhIHZdIExUIixsYXN0V2VlazpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6cmV0dXJuIlttaW51bG91IG5lZMSbbGkgdl0gTFQiO2Nhc2UgMTpjYXNlIDI6cmV0dXJuIlttaW51bMOpXSBkZGRkIFt2XSBMVCI7Y2FzZSAzOnJldHVybiJbbWludWxvdSBzdMWZZWR1IHZdIExUIjtjYXNlIDQ6Y2FzZSA1OnJldHVybiJbbWludWzDvV0gZGRkZCBbdl0gTFQiO2Nhc2UgNjpyZXR1cm4iW21pbnVsb3Ugc29ib3R1IHZdIExUIn19LHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6InphICVzIixwYXN0OiJwxZllZCAlcyIsczppLG06aSxtbTppLGg6aSxoaDppLGQ6aSxkZDppLE06aSxNTTppLHk6aSx5eTppfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gc30pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJjdiIse21vbnRoczoi0LrTkdGA0LvQsNGHX9C90LDRgNOR0YFf0L/Rg9GIX9Cw0LrQsF/QvNCw0Llf0qvTl9GA0YLQvNC1X9GD0YLTkV/Sq9GD0YDQu9CwX9Cw0LLTkdC9X9GO0L/QsF/Rh9Oz0Lpf0YDQsNGI0YLQsNCyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLQutOR0YBf0L3QsNGAX9C/0YPRiF/QsNC60LBf0LzQsNC5X9Kr05fRgF/Rg9GC05Ff0qvRg9GAX9Cw0LLQvV/RjtC/0LBf0YfTs9C6X9GA0LDRiCIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi0LLRi9GA0YHQsNGA0L3QuNC60YPQvV/RgtGD0L3RgtC40LrRg9C9X9GL0YLQu9Cw0YDQuNC60YPQvV/RjtC90LrRg9C9X9C605fSq9C90LXRgNC90LjQutGD0L1f0Y3RgNC90LXQutGD0L1f0YjTkdC80LDRgtC60YPQvSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLQstGL0YBf0YLRg9C9X9GL0YLQu1/RjtC9X9C605fSq1/RjdGA0L1f0YjTkdC8Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLQstGAX9GC0L1f0YvRgl/RjtC9X9C60qtf0Y3RgF/RiNC8Ii5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkRELU1NLVlZWVkiLExMOiJZWVlZIFvSq9GD0LvRhdC4XSBNTU1NIFvRg9C505HRhdOX0L1dIERbLdC805fRiNOXXSIsTExMOiJZWVlZIFvSq9GD0LvRhdC4XSBNTU1NIFvRg9C505HRhdOX0L1dIERbLdC805fRiNOXXSwgSEg6bW0iLExMTEw6ImRkZGQsIFlZWVkgW9Kr0YPQu9GF0LhdIE1NTU0gW9GD0LnTkdGF05fQvV0gRFst0LzTl9GI05ddLCBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb0J/QsNGP0L1dIExUIFvRgdC10YXQtdGC0YDQtV0iLG5leHREYXk6IlvQq9GA0LDQvV0gTFQgW9GB0LXRhdC10YLRgNC1XSIsbGFzdERheToiW9OW0L3QtdGAXSBMVCBb0YHQtdGF0LXRgtGA0LVdIixuZXh0V2VlazoiW9Kq0LjRgtC10YFdIGRkZGQgTFQgW9GB0LXRhdC10YLRgNC1XSIsbGFzdFdlZWs6IlvQmNGA0YLQvdOXXSBkZGRkIExUIFvRgdC10YXQtdGC0YDQtV0iLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ZnVuY3Rpb24odCl7dmFyIGU9L9GB0LXRhdC10YIkL2kuZXhlYyh0KT8i0YDQtdC9Ijov0qvRg9C7JC9pLmV4ZWModCk/ItGC0LDQvSI6ItGA0LDQvSI7cmV0dXJuIHQrZX0scGFzdDoiJXMg0LrQsNGP0LvQu9CwIixzOiLQv9OX0YAt0LjQuiDSq9C10LrQutGD0L3RgiIsbToi0L/Tl9GAINC80LjQvdGD0YIiLG1tOiIlZCDQvNC40L3Rg9GCIixoOiLQv9OX0YAg0YHQtdGF0LXRgiIsaGg6IiVkINGB0LXRhdC10YIiLGQ6ItC/05fRgCDQutGD0L0iLGRkOiIlZCDQutGD0L0iLE06ItC/05fRgCDRg9C505HRhSIsTU06IiVkINGD0LnTkdGFIix5OiLQv9OX0YAg0qvRg9C7Iix5eToiJWQg0qvRg9C7In0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LdC805fRiC8sb3JkaW5hbDoiJWQt0LzTl9GIIix3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJjeSIse21vbnRoczoiSW9uYXdyX0Nod2Vmcm9yX01hd3J0aF9FYnJpbGxfTWFpX01laGVmaW5fR29yZmZlbm5hZl9Bd3N0X01lZGlfSHlkcmVmX1RhY2h3ZWRkX1JoYWdmeXIiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Iklvbl9DaHdlX01hd19FYnJfTWFpX01laF9Hb3JfQXdzX01lZF9IeWRfVGFjaF9SaGFnIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJEeWRkIFN1bF9EeWRkIExsdW5fRHlkZCBNYXdydGhfRHlkZCBNZXJjaGVyX0R5ZGQgSWF1X0R5ZGQgR3dlbmVyX0R5ZGQgU2Fkd3JuIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlN1bF9MbHVuX01hd19NZXJfSWF1X0d3ZV9TYWQiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IlN1X0xsX01hX01lX0lhX0d3X1NhIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW0hlZGRpdyBhbV0gTFQiLG5leHREYXk6IltZZm9yeSBhbV0gTFQiLG5leHRXZWVrOiJkZGRkIFthbV0gTFQiLGxhc3REYXk6IltEZG9lIGFtXSBMVCIsbGFzdFdlZWs6ImRkZGQgW2Rpd2V0aGFmIGFtXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToibWV3biAlcyIscGFzdDoiJXMgeW4gw7RsIixzOiJ5Y2h5ZGlnIGVpbGlhZGF1IixtOiJtdW51ZCIsbW06IiVkIG11bnVkIixoOiJhd3IiLGhoOiIlZCBhd3IiLGQ6ImRpd3Jub2QiLGRkOiIlZCBkaXdybm9kIixNOiJtaXMiLE1NOiIlZCBtaXMiLHk6ImJsd3lkZHluIix5eToiJWQgZmx5bmVkZCJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfShmZWR8YWlufGFmfGlsfHlkZHxlZHxlZykvLG9yZGluYWw6ZnVuY3Rpb24odCl7dmFyIGU9dCxpPSIiLG49WyIiLCJhZiIsImlsIiwieWRkIiwieWRkIiwiZWQiLCJlZCIsImVkIiwiZmVkIiwiZmVkIiwiZmVkIiwiZWciLCJmZWQiLCJlZyIsImVnIiwiZmVkIiwiZWciLCJlZyIsImZlZCIsImVnIiwiZmVkIl07cmV0dXJuIGU+MjA/aT00MD09PWV8fDUwPT09ZXx8NjA9PT1lfHw4MD09PWV8fDEwMD09PWU/ImZlZCI6ImFpbiI6ZT4wJiYoaT1uW2VdKSx0K2l9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImRhIix7bW9udGhzOiJqYW51YXJfZmVicnVhcl9tYXJ0c19hcHJpbF9tYWpfanVuaV9qdWxpX2F1Z3VzdF9zZXB0ZW1iZXJfb2t0b2Jlcl9ub3ZlbWJlcl9kZWNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiamFuX2ZlYl9tYXJfYXByX21hal9qdW5fanVsX2F1Z19zZXBfb2t0X25vdl9kZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6InPDuG5kYWdfbWFuZGFnX3RpcnNkYWdfb25zZGFnX3RvcnNkYWdfZnJlZGFnX2zDuHJkYWciLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoic8O4bl9tYW5fdGlyX29uc190b3JfZnJlX2zDuHIiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46InPDuF9tYV90aV9vbl90b19mcl9sw7giLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQuIE1NTU0gWVlZWSIsTExMOiJELiBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQgW2QuXSBELiBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW0kgZGFnIGtsLl0gTFQiLG5leHREYXk6IltJIG1vcmdlbiBrbC5dIExUIixuZXh0V2VlazoiZGRkZCBba2wuXSBMVCIsbGFzdERheToiW0kgZ8OlciBrbC5dIExUIixsYXN0V2VlazoiW3NpZHN0ZV0gZGRkZCBba2xdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJvbSAlcyIscGFzdDoiJXMgc2lkZW4iLHM6ImbDpSBzZWt1bmRlciIsbToiZXQgbWludXQiLG1tOiIlZCBtaW51dHRlciIsaDoiZW4gdGltZSIsaGg6IiVkIHRpbWVyIixkOiJlbiBkYWciLGRkOiIlZCBkYWdlIixNOiJlbiBtw6VuZWQiLE1NOiIlZCBtw6VuZWRlciIseToiZXQgw6VyIix5eToiJWQgw6VyIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQsZSxpLG4pe3ZhciByPXttOlsiZWluZSBNaW51dGUiLCJlaW5lciBNaW51dGUiXSxoOlsiZWluZSBTdHVuZGUiLCJlaW5lciBTdHVuZGUiXSxkOlsiZWluIFRhZyIsImVpbmVtIFRhZyJdLGRkOlt0KyIgVGFnZSIsdCsiIFRhZ2VuIl0sTTpbImVpbiBNb25hdCIsImVpbmVtIE1vbmF0Il0sTU06W3QrIiBNb25hdGUiLHQrIiBNb25hdGVuIl0seTpbImVpbiBKYWhyIiwiZWluZW0gSmFociJdLHl5Olt0KyIgSmFocmUiLHQrIiBKYWhyZW4iXX07cmV0dXJuIGU/cltpXVswXTpyW2ldWzFdfXZhciBpPXQuZGVmaW5lTG9jYWxlKCJkZSIse21vbnRoczoiSmFudWFyX0ZlYnJ1YXJfTcOkcnpfQXByaWxfTWFpX0p1bmlfSnVsaV9BdWd1c3RfU2VwdGVtYmVyX09rdG9iZXJfTm92ZW1iZXJfRGV6ZW1iZXIiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Ikphbi5fRmVici5fTXJ6Ll9BcHIuX01haV9KdW4uX0p1bC5fQXVnLl9TZXB0Ll9Pa3QuX05vdi5fRGV6LiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiU29ubnRhZ19Nb250YWdfRGllbnN0YWdfTWl0dHdvY2hfRG9ubmVyc3RhZ19GcmVpdGFnX1NhbXN0YWciLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiU28uX01vLl9EaS5fTWkuX0RvLl9Gci5fU2EuIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJTb19Nb19EaV9NaV9Eb19Gcl9TYSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRC4gTU1NTSBZWVlZIixMTEw6IkQuIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCwgRC4gTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltoZXV0ZSB1bV0gTFQgW1Vocl0iLHNhbWVFbHNlOiJMIixuZXh0RGF5OiJbbW9yZ2VuIHVtXSBMVCBbVWhyXSIsbmV4dFdlZWs6ImRkZGQgW3VtXSBMVCBbVWhyXSIsbGFzdERheToiW2dlc3Rlcm4gdW1dIExUIFtVaHJdIixsYXN0V2VlazoiW2xldHp0ZW5dIGRkZGQgW3VtXSBMVCBbVWhyXSJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJpbiAlcyIscGFzdDoidm9yICVzIixzOiJlaW4gcGFhciBTZWt1bmRlbiIsbTplLG1tOiIlZCBNaW51dGVuIixoOmUsaGg6IiVkIFN0dW5kZW4iLGQ6ZSxkZDplLE06ZSxNTTplLHk6ZSx5eTplfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCxlLGksbil7dmFyIHI9e206WyJlaW5lIE1pbnV0ZSIsImVpbmVyIE1pbnV0ZSJdLGg6WyJlaW5lIFN0dW5kZSIsImVpbmVyIFN0dW5kZSJdLGQ6WyJlaW4gVGFnIiwiZWluZW0gVGFnIl0sZGQ6W3QrIiBUYWdlIix0KyIgVGFnZW4iXSxNOlsiZWluIE1vbmF0IiwiZWluZW0gTW9uYXQiXSxNTTpbdCsiIE1vbmF0ZSIsdCsiIE1vbmF0ZW4iXSx5OlsiZWluIEphaHIiLCJlaW5lbSBKYWhyIl0seXk6W3QrIiBKYWhyZSIsdCsiIEphaHJlbiJdfTtyZXR1cm4gZT9yW2ldWzBdOnJbaV1bMV19dmFyIGk9dC5kZWZpbmVMb2NhbGUoImRlLWF0Iix7bW9udGhzOiJKw6RubmVyX0ZlYnJ1YXJfTcOkcnpfQXByaWxfTWFpX0p1bmlfSnVsaV9BdWd1c3RfU2VwdGVtYmVyX09rdG9iZXJfTm92ZW1iZXJfRGV6ZW1iZXIiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IkrDpG4uX0ZlYnIuX01yei5fQXByLl9NYWlfSnVuLl9KdWwuX0F1Zy5fU2VwdC5fT2t0Ll9Ob3YuX0Rlei4iLnNwbGl0KCJfIiksd2Vla2RheXM6IlNvbm50YWdfTW9udGFnX0RpZW5zdGFnX01pdHR3b2NoX0Rvbm5lcnN0YWdfRnJlaXRhZ19TYW1zdGFnIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlNvLl9Nby5fRGkuX01pLl9Eby5fRnIuX1NhLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU29fTW9fRGlfTWlfRG9fRnJfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQuTU0uWVlZWSIsTEw6IkQuIE1NTU0gWVlZWSIsTExMOiJELiBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQuIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbaGV1dGUgdW1dIExUIFtVaHJdIixzYW1lRWxzZToiTCIsbmV4dERheToiW21vcmdlbiB1bV0gTFQgW1Vocl0iLG5leHRXZWVrOiJkZGRkIFt1bV0gTFQgW1Vocl0iLGxhc3REYXk6IltnZXN0ZXJuIHVtXSBMVCBbVWhyXSIsbGFzdFdlZWs6IltsZXR6dGVuXSBkZGRkIFt1bV0gTFQgW1Vocl0ifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiaW4gJXMiLHBhc3Q6InZvciAlcyIsczoiZWluIHBhYXIgU2VrdW5kZW4iLG06ZSxtbToiJWQgTWludXRlbiIsaDplLGhoOiIlZCBTdHVuZGVuIixkOmUsZGQ6ZSxNOmUsTU06ZSx5OmUseXk6ZX0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGl9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT1bIt6W3qzegt6q3ofept6D3qkiLCLeit6s3oTesN6D3qreh96m3oPeqSIsIt6J3qfeg96o3pfeqiIsIt6H3q3eld6w3oPeqd6N3qoiLCLeid6tIiwi3pbeq96C3rAiLCLelt6q3o3ept6H3qgiLCLeh96v3o7ept6Q3rDek96qIiwi3pDerN6V3rDek96s3onesN6E3qbeg96qIiwi3ofert6G3rDek96v3oTept6D3qoiLCLegt6u3ojerN6J3rDehN6m3oPeqiIsIt6R3qjekN6s3onesN6E3qbeg96qIl0saT1bIt6H3qfei96o3ofesN6M3qYiLCLegN6v3onepiIsIt6H3qbegt6w3o7ep96D3qYiLCLehN6q3ovepiIsIt6E3qreg96n3pDesN6K3qbejN6oIiwi3oDeqt6G3qreg96qIiwi3oDert6C3qjegN6o3oPeqiJdLG49dC5kZWZpbmVMb2NhbGUoImR2Iix7bW9udGhzOmUsbW9udGhzU2hvcnQ6ZSx3ZWVrZGF5czppLHdlZWtkYXlzU2hvcnQ6aSx3ZWVrZGF5c01pbjoi3ofep96L3qhf3oDer96J3qZf3ofept6C3rBf3oTeqt6L3qZf3oTeqt6D3qdf3oDeqt6G3qpf3oDert6C3qgiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiRC9NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LG1lcmlkaWVtUGFyc2U6L96J3oZ83oneii8saXNQTTpmdW5jdGlvbih0KXtyZXR1cm4i3oneiiI9PT10fSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/It6J3oYiOiLeid6KIn0sY2FsZW5kYXI6e3NhbWVEYXk6Ilveid6o3ofept6L3qpdIExUIixuZXh0RGF5OiJb3onep96L3qbeid6nXSBMVCIsbmV4dFdlZWs6ImRkZGQgTFQiLGxhc3REYXk6Ilveh96o3ofesN6U3qxdIExUIixsYXN0V2VlazoiW96K3qfeh96o3ozeqt6I3qhdIGRkZGQgTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6It6M3qzeg96t3o7ept6H3qggJXMiLHBhc3Q6It6G3qreg96o3oLesCAlcyIsczoi3pDeqN6G3qregt6w3ozeqt6G3q7ehd6s3ofesCIsbToi3oneqN6C3qjek96s3ofesCIsbW06It6J3qjegt6o3pPeqiAlZCIsaDoi3o7ept6R3qjeh96o3oPerN6H3rAiLGhoOiLejt6m3pHeqN6H3qjeg96qICVkIixkOiLei96q3ojept6A3qzeh96wIixkZDoi3oveqt6I3qbekN6wICVkIixNOiLeid6m3oDerN6H3rAiLE1NOiLeid6m3pDesCAlZCIseToi3ofept6A3qbeg96s3ofesCIseXk6It6H3qbegN6m3oPeqiAlZCJ9LHByZXBhcnNlOmZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoL9iML2csIiwiKX0scG9zdGZvcm1hdDpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC8sL2csItiMIil9LHdlZWs6e2Rvdzo3LGRveToxMn19KTtyZXR1cm4gbn0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBGdW5jdGlvbnx8IltvYmplY3QgRnVuY3Rpb25dIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX12YXIgaT10LmRlZmluZUxvY2FsZSgiZWwiLHttb250aHNOb21pbmF0aXZlRWw6Is6ZzrHOvc6/z4XOrM+BzrnOv8+CX86mzrXOss+Bzr/Phc6sz4HOuc6/z4JfzpzOrM+Bz4TOuc6/z4JfzpHPgM+Bzq/Ou865zr/Pgl/OnM6szrnOv8+CX86Zzr/Pjc69zrnOv8+CX86Zzr/Pjc67zrnOv8+CX86Rz43Os86/z4XPg8+Ezr/Pgl/Oo861z4DPhM6tzrzOss+BzrnOv8+CX86fzrrPhM+OzrLPgc65zr/Pgl/Onc6/zq3OvM6yz4HOuc6/z4JfzpTOtc66zq3OvM6yz4HOuc6/z4IiLnNwbGl0KCJfIiksbW9udGhzR2VuaXRpdmVFbDoizpnOsc69zr/Phc6xz4HOr86/z4VfzqbOtc6yz4HOv8+FzrHPgc6vzr/PhV/OnM6xz4HPhM6vzr/PhV/Okc+Az4HOuc67zq/Ov8+FX86czrHOkM6/z4VfzpnOv8+Fzr3Or86/z4VfzpnOv8+FzrvOr86/z4VfzpHPhc6zzr/Pjc+Dz4TOv8+FX86jzrXPgM+EzrXOvM6yz4HOr86/z4Vfzp/Ous+Ez4nOss+Bzq/Ov8+FX86dzr/Otc68zrLPgc6vzr/PhV/OlM61zrrOtc68zrLPgc6vzr/PhSIuc3BsaXQoIl8iKSxtb250aHM6ZnVuY3Rpb24odCxlKXtyZXR1cm4vRC8udGVzdChlLnN1YnN0cmluZygwLGUuaW5kZXhPZigiTU1NTSIpKSk/dGhpcy5fbW9udGhzR2VuaXRpdmVFbFt0Lm1vbnRoKCldOnRoaXMuX21vbnRoc05vbWluYXRpdmVFbFt0Lm1vbnRoKCldfSxtb250aHNTaG9ydDoizpnOsc69X86mzrXOsl/OnM6xz4FfzpHPgM+BX86czrHPil/Omc6/z4XOvV/Omc6/z4XOu1/Okc+FzrNfzqPOtc+AX86fzrrPhF/Onc6/zrVfzpTOtc66Ii5zcGxpdCgiXyIpLHdlZWtkYXlzOiLOms+Fz4HOuc6xzrrOrl/OlM61z4XPhM6tz4HOsV/OpM+Bzq/PhM63X86kzrXPhM6sz4HPhM63X86gzq3OvM+Az4TOt1/OoM6xz4HOsc+DzrrOtc+Fzq5fzqPOrM6yzrLOsc+Ezr8iLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoizprPhc+BX86UzrXPhV/OpM+BzrlfzqTOtc+EX86gzrXOvF/OoM6xz4FfzqPOsc6yIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLOms+FX86UzrVfzqTPgV/OpM61X86gzrVfzqDOsV/Oo86xIi5zcGxpdCgiXyIpLG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdD4xMT9pPyLOvM68IjoizpzOnCI6aT8iz4DOvCI6Is6gzpwifSxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybiLOvCI9PT0odCsiIikudG9Mb3dlckNhc2UoKVswXX0sbWVyaWRpZW1QYXJzZTovW86gzpxdXC4/zpw/XC4/L2ksCglsb25nRGF0ZUZvcm1hdDp7TFQ6Img6bW0gQSIsTFRTOiJoOm1tOnNzIEEiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBoOm1tIEEiLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIGg6bW0gQSJ9LGNhbGVuZGFyRWw6e3NhbWVEYXk6IlvOo86uzrzOtc+BzrEge31dIExUIixuZXh0RGF5OiJbzpHPjc+BzrnOvyB7fV0gTFQiLG5leHRXZWVrOiJkZGRkIFt7fV0gTFQiLGxhc3REYXk6IlvOp864zrXPgiB7fV0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgNjpyZXR1cm4iW8+Ezr8gz4DPgc6/zrfOs86/z43OvM61zr3Ov10gZGRkZCBbe31dIExUIjtkZWZhdWx0OnJldHVybiJbz4TOt869IM+Az4HOv863zrPOv8+NzrzOtc69zrddIGRkZGQgW3t9XSBMVCJ9fSxzYW1lRWxzZToiTCJ9LGNhbGVuZGFyOmZ1bmN0aW9uKHQsaSl7dmFyIG49dGhpcy5fY2FsZW5kYXJFbFt0XSxyPWkmJmkuaG91cnMoKTtyZXR1cm4gZShuKSYmKG49bi5hcHBseShpKSksbi5yZXBsYWNlKCJ7fSIsciUxMj09PTE/Is+Dz4TOtyI6Is+Dz4TOuc+CIil9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLPg861ICVzIixwYXN0OiIlcyDPgM+BzrnOvSIsczoizrvOr86zzrEgzrTOtc+Fz4TOtc+Bz4zOu861z4DPhM6xIixtOiLOrc69zrEgzrvOtc+Az4TPjCIsbW06IiVkIM67zrXPgM+EzqwiLGg6Is68zq/OsSDPjs+BzrEiLGhoOiIlZCDPjs+BzrXPgiIsZDoizrzOr86xIM68zq3Pgc6xIixkZDoiJWQgzrzOrc+BzrXPgiIsTToizq3Ovc6xz4IgzrzOrs69zrHPgiIsTU06IiVkIM68zq7Ovc61z4IiLHk6Is6tzr3Osc+CIM+Hz4HPjM69zr/PgiIseXk6IiVkIM+Hz4HPjM69zrnOsSJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfc63LyxvcmRpbmFsOiIlZM63Iix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJlbi1hdSIse21vbnRoczoiSmFudWFyeV9GZWJydWFyeV9NYXJjaF9BcHJpbF9NYXlfSnVuZV9KdWx5X0F1Z3VzdF9TZXB0ZW1iZXJfT2N0b2Jlcl9Ob3ZlbWJlcl9EZWNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX0ZlYl9NYXJfQXByX01heV9KdW5fSnVsX0F1Z19TZXBfT2N0X05vdl9EZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6IlN1bmRheV9Nb25kYXlfVHVlc2RheV9XZWRuZXNkYXlfVGh1cnNkYXlfRnJpZGF5X1NhdHVyZGF5Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlN1bl9Nb25fVHVlX1dlZF9UaHVfRnJpX1NhdCIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU3VfTW9fVHVfV2VfVGhfRnJfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJoOm1tIEEiLExUUzoiaDptbTpzcyBBIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgaDptbSBBIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBoOm1tIEEifSxjYWxlbmRhcjp7c2FtZURheToiW1RvZGF5IGF0XSBMVCIsbmV4dERheToiW1RvbW9ycm93IGF0XSBMVCIsbmV4dFdlZWs6ImRkZGQgW2F0XSBMVCIsbGFzdERheToiW1llc3RlcmRheSBhdF0gTFQiLGxhc3RXZWVrOiJbTGFzdF0gZGRkZCBbYXRdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJpbiAlcyIscGFzdDoiJXMgYWdvIixzOiJhIGZldyBzZWNvbmRzIixtOiJhIG1pbnV0ZSIsbW06IiVkIG1pbnV0ZXMiLGg6ImFuIGhvdXIiLGhoOiIlZCBob3VycyIsZDoiYSBkYXkiLGRkOiIlZCBkYXlzIixNOiJhIG1vbnRoIixNTToiJWQgbW9udGhzIix5OiJhIHllYXIiLHl5OiIlZCB5ZWFycyJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfShzdHxuZHxyZHx0aCkvLG9yZGluYWw6ZnVuY3Rpb24odCl7dmFyIGU9dCUxMCxpPTE9PT1+fih0JTEwMC8xMCk/InRoIjoxPT09ZT8ic3QiOjI9PT1lPyJuZCI6Mz09PWU/InJkIjoidGgiO3JldHVybiB0K2l9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImVuLWNhIix7bW9udGhzOiJKYW51YXJ5X0ZlYnJ1YXJ5X01hcmNoX0FwcmlsX01heV9KdW5lX0p1bHlfQXVndXN0X1NlcHRlbWJlcl9PY3RvYmVyX05vdmVtYmVyX0RlY2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJKYW5fRmViX01hcl9BcHJfTWF5X0p1bl9KdWxfQXVnX1NlcF9PY3RfTm92X0RlYyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiU3VuZGF5X01vbmRheV9UdWVzZGF5X1dlZG5lc2RheV9UaHVyc2RheV9GcmlkYXlfU2F0dXJkYXkiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiU3VuX01vbl9UdWVfV2VkX1RodV9GcmlfU2F0Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJTdV9Nb19UdV9XZV9UaF9Gcl9TYSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6Img6bW0gQSIsTFRTOiJoOm1tOnNzIEEiLEw6IllZWVktTU0tREQiLExMOiJNTU1NIEQsIFlZWVkiLExMTDoiTU1NTSBELCBZWVlZIGg6bW0gQSIsTExMTDoiZGRkZCwgTU1NTSBELCBZWVlZIGg6bW0gQSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbVG9kYXkgYXRdIExUIixuZXh0RGF5OiJbVG9tb3Jyb3cgYXRdIExUIixuZXh0V2VlazoiZGRkZCBbYXRdIExUIixsYXN0RGF5OiJbWWVzdGVyZGF5IGF0XSBMVCIsbGFzdFdlZWs6IltMYXN0XSBkZGRkIFthdF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImluICVzIixwYXN0OiIlcyBhZ28iLHM6ImEgZmV3IHNlY29uZHMiLG06ImEgbWludXRlIixtbToiJWQgbWludXRlcyIsaDoiYW4gaG91ciIsaGg6IiVkIGhvdXJzIixkOiJhIGRheSIsZGQ6IiVkIGRheXMiLE06ImEgbW9udGgiLE1NOiIlZCBtb250aHMiLHk6ImEgeWVhciIseXk6IiVkIHllYXJzIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9KHN0fG5kfHJkfHRoKS8sb3JkaW5hbDpmdW5jdGlvbih0KXt2YXIgZT10JTEwLGk9MT09PX5+KHQlMTAwLzEwKT8idGgiOjE9PT1lPyJzdCI6Mj09PWU/Im5kIjozPT09ZT8icmQiOiJ0aCI7cmV0dXJuIHQraX19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJlbi1nYiIse21vbnRoczoiSmFudWFyeV9GZWJydWFyeV9NYXJjaF9BcHJpbF9NYXlfSnVuZV9KdWx5X0F1Z3VzdF9TZXB0ZW1iZXJfT2N0b2Jlcl9Ob3ZlbWJlcl9EZWNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX0ZlYl9NYXJfQXByX01heV9KdW5fSnVsX0F1Z19TZXBfT2N0X05vdl9EZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6IlN1bmRheV9Nb25kYXlfVHVlc2RheV9XZWRuZXNkYXlfVGh1cnNkYXlfRnJpZGF5X1NhdHVyZGF5Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlN1bl9Nb25fVHVlX1dlZF9UaHVfRnJpX1NhdCIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU3VfTW9fVHVfV2VfVGhfRnJfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbVG9kYXkgYXRdIExUIixuZXh0RGF5OiJbVG9tb3Jyb3cgYXRdIExUIixuZXh0V2VlazoiZGRkZCBbYXRdIExUIixsYXN0RGF5OiJbWWVzdGVyZGF5IGF0XSBMVCIsbGFzdFdlZWs6IltMYXN0XSBkZGRkIFthdF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImluICVzIixwYXN0OiIlcyBhZ28iLHM6ImEgZmV3IHNlY29uZHMiLG06ImEgbWludXRlIixtbToiJWQgbWludXRlcyIsaDoiYW4gaG91ciIsaGg6IiVkIGhvdXJzIixkOiJhIGRheSIsZGQ6IiVkIGRheXMiLE06ImEgbW9udGgiLE1NOiIlZCBtb250aHMiLHk6ImEgeWVhciIseXk6IiVkIHllYXJzIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9KHN0fG5kfHJkfHRoKS8sb3JkaW5hbDpmdW5jdGlvbih0KXt2YXIgZT10JTEwLGk9MT09PX5+KHQlMTAwLzEwKT8idGgiOjE9PT1lPyJzdCI6Mj09PWU/Im5kIjozPT09ZT8icmQiOiJ0aCI7cmV0dXJuIHQraX0sd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odA==", "base64"));
  res.write(new Buffer("LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJlbi1pZSIse21vbnRoczoiSmFudWFyeV9GZWJydWFyeV9NYXJjaF9BcHJpbF9NYXlfSnVuZV9KdWx5X0F1Z3VzdF9TZXB0ZW1iZXJfT2N0b2Jlcl9Ob3ZlbWJlcl9EZWNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX0ZlYl9NYXJfQXByX01heV9KdW5fSnVsX0F1Z19TZXBfT2N0X05vdl9EZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6IlN1bmRheV9Nb25kYXlfVHVlc2RheV9XZWRuZXNkYXlfVGh1cnNkYXlfRnJpZGF5X1NhdHVyZGF5Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlN1bl9Nb25fVHVlX1dlZF9UaHVfRnJpX1NhdCIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU3VfTW9fVHVfV2VfVGhfRnJfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQtTU0tWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltUb2RheSBhdF0gTFQiLG5leHREYXk6IltUb21vcnJvdyBhdF0gTFQiLG5leHRXZWVrOiJkZGRkIFthdF0gTFQiLGxhc3REYXk6IltZZXN0ZXJkYXkgYXRdIExUIixsYXN0V2VlazoiW0xhc3RdIGRkZGQgW2F0XSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiaW4gJXMiLHBhc3Q6IiVzIGFnbyIsczoiYSBmZXcgc2Vjb25kcyIsbToiYSBtaW51dGUiLG1tOiIlZCBtaW51dGVzIixoOiJhbiBob3VyIixoaDoiJWQgaG91cnMiLGQ6ImEgZGF5IixkZDoiJWQgZGF5cyIsTToiYSBtb250aCIsTU06IiVkIG1vbnRocyIseToiYSB5ZWFyIix5eToiJWQgeWVhcnMifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0oc3R8bmR8cmR8dGgpLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3ZhciBlPXQlMTAsaT0xPT09fn4odCUxMDAvMTApPyJ0aCI6MT09PWU/InN0IjoyPT09ZT8ibmQiOjM9PT1lPyJyZCI6InRoIjtyZXR1cm4gdCtpfSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJlbi1ueiIse21vbnRoczoiSmFudWFyeV9GZWJydWFyeV9NYXJjaF9BcHJpbF9NYXlfSnVuZV9KdWx5X0F1Z3VzdF9TZXB0ZW1iZXJfT2N0b2Jlcl9Ob3ZlbWJlcl9EZWNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX0ZlYl9NYXJfQXByX01heV9KdW5fSnVsX0F1Z19TZXBfT2N0X05vdl9EZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6IlN1bmRheV9Nb25kYXlfVHVlc2RheV9XZWRuZXNkYXlfVGh1cnNkYXlfRnJpZGF5X1NhdHVyZGF5Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlN1bl9Nb25fVHVlX1dlZF9UaHVfRnJpX1NhdCIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU3VfTW9fVHVfV2VfVGhfRnJfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJoOm1tIEEiLExUUzoiaDptbTpzcyBBIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgaDptbSBBIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBoOm1tIEEifSxjYWxlbmRhcjp7c2FtZURheToiW1RvZGF5IGF0XSBMVCIsbmV4dERheToiW1RvbW9ycm93IGF0XSBMVCIsbmV4dFdlZWs6ImRkZGQgW2F0XSBMVCIsbGFzdERheToiW1llc3RlcmRheSBhdF0gTFQiLGxhc3RXZWVrOiJbTGFzdF0gZGRkZCBbYXRdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJpbiAlcyIscGFzdDoiJXMgYWdvIixzOiJhIGZldyBzZWNvbmRzIixtOiJhIG1pbnV0ZSIsbW06IiVkIG1pbnV0ZXMiLGg6ImFuIGhvdXIiLGhoOiIlZCBob3VycyIsZDoiYSBkYXkiLGRkOiIlZCBkYXlzIixNOiJhIG1vbnRoIixNTToiJWQgbW9udGhzIix5OiJhIHllYXIiLHl5OiIlZCB5ZWFycyJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfShzdHxuZHxyZHx0aCkvLG9yZGluYWw6ZnVuY3Rpb24odCl7dmFyIGU9dCUxMCxpPTE9PT1+fih0JTEwMC8xMCk/InRoIjoxPT09ZT8ic3QiOjI9PT1lPyJuZCI6Mz09PWU/InJkIjoidGgiO3JldHVybiB0K2l9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImVvIix7bW9udGhzOiJqYW51YXJvX2ZlYnJ1YXJvX21hcnRvX2Fwcmlsb19tYWpvX2p1bmlvX2p1bGlvX2HFrWd1c3RvX3NlcHRlbWJyb19va3RvYnJvX25vdmVtYnJvX2RlY2VtYnJvIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJqYW5fZmViX21hcl9hcHJfbWFqX2p1bl9qdWxfYcWtZ19zZXBfb2t0X25vdl9kZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6IkRpbWFuxIlvX0x1bmRvX01hcmRvX01lcmtyZWRvX8S0YcWtZG9fVmVuZHJlZG9fU2FiYXRvIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IkRpbV9MdW5fTWFyZF9NZXJrX8S0YcWtX1Zlbl9TYWIiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkRpX0x1X01hX01lX8S0YV9WZV9TYSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJZWVlZLU1NLUREIixMTDoiRFstYW4gZGVdIE1NTU0sIFlZWVkiLExMTDoiRFstYW4gZGVdIE1NTU0sIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIFtsYV0gRFstYW4gZGVdIE1NTU0sIFlZWVkgSEg6bW0ifSxtZXJpZGllbVBhcnNlOi9bYXBdXC50XC5tL2ksaXNQTTpmdW5jdGlvbih0KXtyZXR1cm4icCI9PT10LmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ+MTE/aT8icC50Lm0uIjoiUC5ULk0uIjppPyJhLnQubS4iOiJBLlQuTS4ifSxjYWxlbmRhcjp7c2FtZURheToiW0hvZGlhxa0gamVdIExUIixuZXh0RGF5OiJbTW9yZ2HFrSBqZV0gTFQiLG5leHRXZWVrOiJkZGRkIFtqZV0gTFQiLGxhc3REYXk6IltIaWVyYcWtIGplXSBMVCIsbGFzdFdlZWs6IltwYXNpbnRhXSBkZGRkIFtqZV0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImplICVzIixwYXN0OiJhbnRhxa0gJXMiLHM6InNla3VuZG9qIixtOiJtaW51dG8iLG1tOiIlZCBtaW51dG9qIixoOiJob3JvIixoaDoiJWQgaG9yb2oiLGQ6InRhZ28iLGRkOiIlZCB0YWdvaiIsTToibW9uYXRvIixNTToiJWQgbW9uYXRvaiIseToiamFybyIseXk6IiVkIGphcm9qIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9YS8sb3JkaW5hbDoiJWRhIix3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPSJlbmUuX2ZlYi5fbWFyLl9hYnIuX21heS5fanVuLl9qdWwuX2Fnby5fc2VwLl9vY3QuX25vdi5fZGljLiIuc3BsaXQoIl8iKSxpPSJlbmVfZmViX21hcl9hYnJfbWF5X2p1bl9qdWxfYWdvX3NlcF9vY3Rfbm92X2RpYyIuc3BsaXQoIl8iKSxuPXQuZGVmaW5lTG9jYWxlKCJlcyIse21vbnRoczoiZW5lcm9fZmVicmVyb19tYXJ6b19hYnJpbF9tYXlvX2p1bmlvX2p1bGlvX2Fnb3N0b19zZXB0aWVtYnJlX29jdHVicmVfbm92aWVtYnJlX2RpY2llbWJyZSIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDpmdW5jdGlvbih0LG4pe3JldHVybi8tTU1NLS8udGVzdChuKT9pW3QubW9udGgoKV06ZVt0Lm1vbnRoKCldfSx3ZWVrZGF5czoiZG9taW5nb19sdW5lc19tYXJ0ZXNfbWnDqXJjb2xlc19qdWV2ZXNfdmllcm5lc19zw6FiYWRvIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6ImRvbS5fbHVuLl9tYXIuX21pw6kuX2p1ZS5fdmllLl9zw6FiLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiZG9fbHVfbWFfbWlfanVfdmlfc8OhIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSDptbSIsTFRTOiJIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBbZGVdIE1NTU0gW2RlXSBZWVlZIixMTEw6IkQgW2RlXSBNTU1NIFtkZV0gWVlZWSBIOm1tIixMTExMOiJkZGRkLCBEIFtkZV0gTU1NTSBbZGVdIFlZWVkgSDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OmZ1bmN0aW9uKCl7cmV0dXJuIltob3kgYSBsYSIrKDEhPT10aGlzLmhvdXJzKCk/InMiOiIiKSsiXSBMVCJ9LG5leHREYXk6ZnVuY3Rpb24oKXtyZXR1cm4iW21hw7FhbmEgYSBsYSIrKDEhPT10aGlzLmhvdXJzKCk/InMiOiIiKSsiXSBMVCJ9LG5leHRXZWVrOmZ1bmN0aW9uKCl7cmV0dXJuImRkZGQgW2EgbGEiKygxIT09dGhpcy5ob3VycygpPyJzIjoiIikrIl0gTFQifSxsYXN0RGF5OmZ1bmN0aW9uKCl7cmV0dXJuIltheWVyIGEgbGEiKygxIT09dGhpcy5ob3VycygpPyJzIjoiIikrIl0gTFQifSxsYXN0V2VlazpmdW5jdGlvbigpe3JldHVybiJbZWxdIGRkZGQgW3Bhc2FkbyBhIGxhIisoMSE9PXRoaXMuaG91cnMoKT8icyI6IiIpKyJdIExUIn0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiZW4gJXMiLHBhc3Q6ImhhY2UgJXMiLHM6InVub3Mgc2VndW5kb3MiLG06InVuIG1pbnV0byIsbW06IiVkIG1pbnV0b3MiLGg6InVuYSBob3JhIixoaDoiJWQgaG9yYXMiLGQ6InVuIGTDrWEiLGRkOiIlZCBkw61hcyIsTToidW4gbWVzIixNTToiJWQgbWVzZXMiLHk6InVuIGHDsW8iLHl5OiIlZCBhw7FvcyJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfcK6LyxvcmRpbmFsOiIlZMK6Iix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gbn0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCxlLGksbil7dmFyIHI9e3M6WyJtw7VuZSBzZWt1bmRpIiwibcO1bmkgc2VrdW5kIiwicGFhciBzZWt1bmRpdCJdLG06WyLDvGhlIG1pbnV0aSIsIsO8a3MgbWludXQiXSxtbTpbdCsiIG1pbnV0aSIsdCsiIG1pbnV0aXQiXSxoOlsiw7xoZSB0dW5uaSIsInR1bmQgYWVnYSIsIsO8a3MgdHVuZCJdLGhoOlt0KyIgdHVubmkiLHQrIiB0dW5kaSJdLGQ6WyLDvGhlIHDDpGV2YSIsIsO8a3MgcMOkZXYiXSxNOlsia3V1IGFqYSIsImt1dSBhZWdhIiwiw7xrcyBrdXUiXSxNTTpbdCsiIGt1dSIsdCsiIGt1dWQiXSx5Olsiw7xoZSBhYXN0YSIsImFhc3RhIiwiw7xrcyBhYXN0YSJdLHl5Olt0KyIgYWFzdGEiLHQrIiBhYXN0YXQiXX07cmV0dXJuIGU/cltpXVsyXT9yW2ldWzJdOnJbaV1bMV06bj9yW2ldWzBdOnJbaV1bMV19dmFyIGk9dC5kZWZpbmVMb2NhbGUoImV0Iix7bW9udGhzOiJqYWFudWFyX3ZlZWJydWFyX23DpHJ0c19hcHJpbGxfbWFpX2p1dW5pX2p1dWxpX2F1Z3VzdF9zZXB0ZW1iZXJfb2t0b29iZXJfbm92ZW1iZXJfZGV0c2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJqYWFuX3ZlZWJyX23DpHJ0c19hcHJfbWFpX2p1dW5pX2p1dWxpX2F1Z19zZXB0X29rdF9ub3ZfZGV0cyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoicMO8aGFww6Rldl9lc21hc3DDpGV2X3RlaXNpcMOkZXZfa29sbWFww6Rldl9uZWxqYXDDpGV2X3JlZWRlX2xhdXDDpGV2Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlBfRV9UX0tfTl9SX0wiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IlBfRV9UX0tfTl9SX0wiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJELiBNTU1NIFlZWVkiLExMTDoiRC4gTU1NTSBZWVlZIEg6bW0iLExMTEw6ImRkZGQsIEQuIE1NTU0gWVlZWSBIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltUw6RuYSxdIExUIixuZXh0RGF5OiJbSG9tbWUsXSBMVCIsbmV4dFdlZWs6IltKw6RyZ21pbmVdIGRkZGQgTFQiLGxhc3REYXk6IltFaWxlLF0gTFQiLGxhc3RXZWVrOiJbRWVsbWluZV0gZGRkZCBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMgcMOkcmFzdCIscGFzdDoiJXMgdGFnYXNpIixzOmUsbTplLG1tOmUsaDplLGhoOmUsZDplLGRkOiIlZCBww6RldmEiLE06ZSxNTTplLHk6ZSx5eTplfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJldSIse21vbnRoczoidXJ0YXJyaWxhX290c2FpbGFfbWFydHhvYV9hcGlyaWxhX21haWF0emFfZWthaW5hX3V6dGFpbGFfYWJ1enR1YV9pcmFpbGFfdXJyaWFfYXphcm9hX2FiZW5kdWEiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6InVydC5fb3RzLl9tYXIuX2FwaS5fbWFpLl9la2EuX3V6dC5fYWJ1Ll9pcmEuX3Vyci5fYXphLl9hYmUuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJpZ2FuZGVhX2FzdGVsZWhlbmFfYXN0ZWFydGVhX2FzdGVhemtlbmFfb3N0ZWd1bmFfb3N0aXJhbGFfbGFydW5iYXRhIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6ImlnLl9hbC5fYXIuX2F6Ll9vZy5fb2wuX2xyLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiaWdfYWxfYXJfYXpfb2dfb2xfbHIiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiWVlZWS1NTS1ERCIsTEw6IllZWVlba29dIE1NTU1bcmVuXSBEW2FdIixMTEw6IllZWVlba29dIE1NTU1bcmVuXSBEW2FdIEhIOm1tIixMTExMOiJkZGRkLCBZWVlZW2tvXSBNTU1NW3Jlbl0gRFthXSBISDptbSIsbDoiWVlZWS1NLUQiLGxsOiJZWVlZW2tvXSBNTU0gRFthXSIsbGxsOiJZWVlZW2tvXSBNTU0gRFthXSBISDptbSIsbGxsbDoiZGRkLCBZWVlZW2tvXSBNTU0gRFthXSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbZ2F1cl0gTFRbZXRhbl0iLG5leHREYXk6IltiaWhhcl0gTFRbZXRhbl0iLG5leHRXZWVrOiJkZGRkIExUW2V0YW5dIixsYXN0RGF5OiJbYXR6b10gTFRbZXRhbl0iLGxhc3RXZWVrOiJbYXVycmVrb10gZGRkZCBMVFtldGFuXSIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMgYmFycnUiLHBhc3Q6ImR1ZWxhICVzIixzOiJzZWd1bmRvIGJhdHp1ayIsbToibWludXR1IGJhdCIsbW06IiVkIG1pbnV0dSIsaDoib3JkdSBiYXQiLGhoOiIlZCBvcmR1IixkOiJlZ3VuIGJhdCIsZGQ6IiVkIGVndW4iLE06ImhpbGFiZXRlIGJhdCIsTU06IiVkIGhpbGFiZXRlIix5OiJ1cnRlIGJhdCIseXk6IiVkIHVydGUifSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXsxOiLbsSIsMjoi27IiLDM6ItuzIiw0OiLbtCIsNToi27UiLDY6Itu2Iiw3OiLbtyIsODoi27giLDk6Itu5IiwwOiLbsCJ9LGk9eyLbsSI6IjEiLCLbsiI6IjIiLCLbsyI6IjMiLCLbtCI6IjQiLCLbtSI6IjUiLCLbtiI6IjYiLCLbtyI6IjciLCLbuCI6IjgiLCLbuSI6IjkiLCLbsCI6IjAifSxuPXQuZGVmaW5lTG9jYWxlKCJmYSIse21vbnRoczoi2pjYp9mG2YjbjNmHX9mB2YjYsduM2Ydf2YXYp9ix2LNf2KLZiNix24zZhF/ZhdmHX9qY2YjYptmGX9qY2YjYptuM2Ydf2KfZiNiqX9iz2b7Yqtin2YXYqNixX9in2qnYqtio2LFf2YbZiNin2YXYqNixX9iv2LPYp9mF2KjYsSIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoi2pjYp9mG2YjbjNmHX9mB2YjYsduM2Ydf2YXYp9ix2LNf2KLZiNix24zZhF/ZhdmHX9qY2YjYptmGX9qY2YjYptuM2Ydf2KfZiNiqX9iz2b7Yqtin2YXYqNixX9in2qnYqtio2LFf2YbZiNin2YXYqNixX9iv2LPYp9mF2KjYsSIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi24zaqeKAjNi02YbYqNmHX9iv2YjYtNmG2KjZh1/Ys9mH4oCM2LTZhtio2Ydf2obZh9in2LHYtNmG2KjZh1/ZvtmG2KzigIzYtNmG2KjZh1/YrNmF2LnZh1/YtNmG2KjZhyIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLbjNqp4oCM2LTZhtio2Ydf2K/ZiNi02YbYqNmHX9iz2YfigIzYtNmG2KjZh1/ahtmH2KfYsdi02YbYqNmHX9m+2YbYrOKAjNi02YbYqNmHX9is2YXYudmHX9i02YbYqNmHIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLbjF/Yr1/Ys1/ahl/Zvl/YrF/YtCIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIEhIOm1tIn0sbWVyaWRpZW1QYXJzZTov2YLYqNmEINin2LIg2LjZh9ixfNio2LnYryDYp9iyINi42YfYsS8saXNQTTpmdW5jdGlvbih0KXtyZXR1cm4v2KjYudivINin2LIg2LjZh9ixLy50ZXN0KHQpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/ItmC2KjZhCDYp9iyINi42YfYsSI6Itio2LnYryDYp9iyINi42YfYsSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb2KfZhdix2YjYsiDYs9in2LnYql0gTFQiLG5leHREYXk6IlvZgdix2K/YpyDYs9in2LnYql0gTFQiLG5leHRXZWVrOiJkZGRkIFvYs9in2LnYql0gTFQiLGxhc3REYXk6IlvYr9uM2LHZiNiyINiz2KfYudiqXSBMVCIsbGFzdFdlZWs6ImRkZGQgW9m+24zYtF0gW9iz2KfYudiqXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi2K/YsSAlcyIscGFzdDoiJXMg2b7bjNi0IixzOiLahtmG2K/bjNmGINir2KfZhtuM2YciLG06ItuM2qkg2K/ZgtuM2YLZhyIsbW06IiVkINiv2YLbjNmC2YciLGg6ItuM2qkg2LPYp9i52KoiLGhoOiIlZCDYs9in2LnYqiIsZDoi24zaqSDYsdmI2LIiLGRkOiIlZCDYsdmI2LIiLE06ItuM2qkg2YXYp9mHIixNTToiJWQg2YXYp9mHIix5OiLbjNqpINiz2KfZhCIseXk6IiVkINiz2KfZhCJ9LHByZXBhcnNlOmZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoL1vbsC3buV0vZyxmdW5jdGlvbih0KXtyZXR1cm4gaVt0XX0pLnJlcGxhY2UoL9iML2csIiwiKX0scG9zdGZvcm1hdDpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9cZC9nLGZ1bmN0aW9uKHQpe3JldHVybiBlW3RdfSkucmVwbGFjZSgvLC9nLCLYjCIpfSxvcmRpbmFsUGFyc2U6L1xkezEsMn3ZhS8sb3JkaW5hbDoiJWTZhSIsd2Vlazp7ZG93OjYsZG95OjEyfX0pO3JldHVybiBufSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZSh0LGUsbixyKXt2YXIgcz0iIjtzd2l0Y2gobil7Y2FzZSJzIjpyZXR1cm4gcj8ibXV1dGFtYW4gc2VrdW5uaW4iOiJtdXV0YW1hIHNla3VudGkiO2Nhc2UibSI6cmV0dXJuIHI/Im1pbnV1dGluIjoibWludXV0dGkiO2Nhc2UibW0iOnM9cj8ibWludXV0aW4iOiJtaW51dXR0aWEiO2JyZWFrO2Nhc2UiaCI6cmV0dXJuIHI/InR1bm5pbiI6InR1bnRpIjtjYXNlImhoIjpzPXI/InR1bm5pbiI6InR1bnRpYSI7YnJlYWs7Y2FzZSJkIjpyZXR1cm4gcj8icMOkaXbDpG4iOiJww6RpdsOkIjtjYXNlImRkIjpzPXI/InDDpGl2w6RuIjoicMOkaXbDpMOkIjticmVhaztjYXNlIk0iOnJldHVybiByPyJrdXVrYXVkZW4iOiJrdXVrYXVzaSI7Y2FzZSJNTSI6cz1yPyJrdXVrYXVkZW4iOiJrdXVrYXV0dGEiO2JyZWFrO2Nhc2UieSI6cmV0dXJuIHI/InZ1b2RlbiI6InZ1b3NpIjtjYXNlInl5IjpzPXI/InZ1b2RlbiI6InZ1b3R0YSJ9cmV0dXJuIHM9aSh0LHIpKyIgIitzfWZ1bmN0aW9uIGkodCxlKXtyZXR1cm4gdDwxMD9lP3JbdF06blt0XTp0fXZhciBuPSJub2xsYSB5a3NpIGtha3NpIGtvbG1lIG5lbGrDpCB2aWlzaSBrdXVzaSBzZWl0c2Vtw6RuIGthaGRla3NhbiB5aGRla3PDpG4iLnNwbGl0KCIgIikscj1bIm5vbGxhIiwieWhkZW4iLCJrYWhkZW4iLCJrb2xtZW4iLCJuZWxqw6RuIiwidmlpZGVuIiwia3V1ZGVuIixuWzddLG5bOF0sbls5XV0scz10LmRlZmluZUxvY2FsZSgiZmkiLHttb250aHM6InRhbW1pa3V1X2hlbG1pa3V1X21hYWxpc2t1dV9odWh0aWt1dV90b3Vrb2t1dV9rZXPDpGt1dV9oZWluw6RrdXVfZWxva3V1X3N5eXNrdXVfbG9rYWt1dV9tYXJyYXNrdXVfam91bHVrdXUiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6InRhbW1pX2hlbG1pX21hYWxpc19odWh0aV90b3Vrb19rZXPDpF9oZWluw6RfZWxvX3N5eXNfbG9rYV9tYXJyYXNfam91bHUiLnNwbGl0KCJfIiksd2Vla2RheXM6InN1bm51bnRhaV9tYWFuYW50YWlfdGlpc3RhaV9rZXNraXZpaWtrb190b3JzdGFpX3BlcmphbnRhaV9sYXVhbnRhaSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJzdV9tYV90aV9rZV90b19wZV9sYSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoic3VfbWFfdGlfa2VfdG9fcGVfbGEiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISC5tbSIsTFRTOiJISC5tbS5zcyIsTDoiREQuTU0uWVlZWSIsTEw6IkRvIE1NTU1bdGFdIFlZWVkiLExMTDoiRG8gTU1NTVt0YV0gWVlZWSwgW2tsb10gSEgubW0iLExMTEw6ImRkZGQsIERvIE1NTU1bdGFdIFlZWVksIFtrbG9dIEhILm1tIixsOiJELk0uWVlZWSIsbGw6IkRvIE1NTSBZWVlZIixsbGw6IkRvIE1NTSBZWVlZLCBba2xvXSBISC5tbSIsbGxsbDoiZGRkLCBEbyBNTU0gWVlZWSwgW2tsb10gSEgubW0ifSxjYWxlbmRhcjp7c2FtZURheToiW3TDpG7DpMOkbl0gW2tsb10gTFQiLG5leHREYXk6IltodW9tZW5uYV0gW2tsb10gTFQiLG5leHRXZWVrOiJkZGRkIFtrbG9dIExUIixsYXN0RGF5OiJbZWlsZW5dIFtrbG9dIExUIixsYXN0V2VlazoiW3ZpaW1lXSBkZGRkW25hXSBba2xvXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMgcMOkw6RzdMOkIixwYXN0OiIlcyBzaXR0ZW4iLHM6ZSxtOmUsbW06ZSxoOmUsaGg6ZSxkOmUsZGQ6ZSxNOmUsTU06ZSx5OmUseXk6ZX0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIHN9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgiZm8iLHttb250aHM6ImphbnVhcl9mZWJydWFyX21hcnNfYXByw61sX21haV9qdW5pX2p1bGlfYXVndXN0X3NlcHRlbWJlcl9va3RvYmVyX25vdmVtYmVyX2Rlc2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJqYW5fZmViX21hcl9hcHJfbWFpX2p1bl9qdWxfYXVnX3NlcF9va3Rfbm92X2RlcyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoic3VubnVkYWd1cl9tw6FuYWRhZ3VyX3TDvXNkYWd1cl9taWt1ZGFndXJfaMOzc2RhZ3VyX2Zyw61nZ2phZGFndXJfbGV5Z2FyZGFndXIiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoic3VuX23DoW5fdMO9c19taWtfaMOzc19mcsOtX2xleSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoic3VfbcOhX3TDvV9taV9ow7NfZnJfbGUiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQuIE1NTU0sIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW8ONIGRhZyBrbC5dIExUIixuZXh0RGF5OiJbw40gbW9yZ2luIGtsLl0gTFQiLG5leHRXZWVrOiJkZGRkIFtrbC5dIExUIixsYXN0RGF5OiJbw40gZ2rDoXIga2wuXSBMVCIsbGFzdFdlZWs6Iltzw63DsHN0dV0gZGRkZCBba2xdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJ1bSAlcyIscGFzdDoiJXMgc8Otw7BhbmkiLHM6ImbDoSBzZWt1bmQiLG06ImVpbiBtaW51dHQiLG1tOiIlZCBtaW51dHRpciIsaDoiZWluIHTDrW1pIixoaDoiJWQgdMOtbWFyIixkOiJlaW4gZGFndXIiLGRkOiIlZCBkYWdhciIsTToiZWluIG3DoW5hw7BpIixNTToiJWQgbcOhbmHDsGlyIix5OiJlaXR0IMOhciIseXk6IiVkIMOhciJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfVwuLyxvcmRpbmFsOiIlZC4iLHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImZyIix7bW9udGhzOiJqYW52aWVyX2bDqXZyaWVyX21hcnNfYXZyaWxfbWFpX2p1aW5fanVpbGxldF9hb8O7dF9zZXB0ZW1icmVfb2N0b2JyZV9ub3ZlbWJyZV9kw6ljZW1icmUiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6ImphbnYuX2bDqXZyLl9tYXJzX2F2ci5fbWFpX2p1aW5fanVpbC5fYW/Du3Rfc2VwdC5fb2N0Ll9ub3YuX2TDqWMuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJkaW1hbmNoZV9sdW5kaV9tYXJkaV9tZXJjcmVkaV9qZXVkaV92ZW5kcmVkaV9zYW1lZGkiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiZGltLl9sdW4uX21hci5fbWVyLl9qZXUuX3Zlbi5fc2FtLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiRGlfTHVfTWFfTWVfSmVfVmVfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltBdWpvdXJkJ2h1aSDDoF0gTFQiLG5leHREYXk6IltEZW1haW4gw6BdIExUIixuZXh0V2VlazoiZGRkZCBbw6BdIExUIixsYXN0RGF5OiJbSGllciDDoF0gTFQiLGxhc3RXZWVrOiJkZGRkIFtkZXJuaWVyIMOgXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiZGFucyAlcyIscGFzdDoiaWwgeSBhICVzIixzOiJxdWVscXVlcyBzZWNvbmRlcyIsbToidW5lIG1pbnV0ZSIsbW06IiVkIG1pbnV0ZXMiLGg6InVuZSBoZXVyZSIsaGg6IiVkIGhldXJlcyIsZDoidW4gam91ciIsZGQ6IiVkIGpvdXJzIixNOiJ1biBtb2lzIixNTToiJWQgbW9pcyIseToidW4gYW4iLHl5OiIlZCBhbnMifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0oZXJ8KS8sb3JkaW5hbDpmdW5jdGlvbih0KXtyZXR1cm4gdCsoMT09PXQ/ImVyIjoiIil9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImZyLWNhIix7bW9udGhzOiJqYW52aWVyX2bDqXZyaWVyX21hcnNfYXZyaWxfbWFpX2p1aW5fanVpbGxldF9hb8O7dF9zZXB0ZW1icmVfb2N0b2JyZV9ub3ZlbWJyZV9kw6ljZW1icmUiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6ImphbnYuX2bDqXZyLl9tYXJzX2F2ci5fbWFpX2p1aW5fanVpbC5fYW/Du3Rfc2VwdC5fb2N0Ll9ub3YuX2TDqWMuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJkaW1hbmNoZV9sdW5kaV9tYXJkaV9tZXJjcmVkaV9qZXVkaV92ZW5kcmVkaV9zYW1lZGkiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiZGltLl9sdW4uX21hci5fbWVyLl9qZXUuX3Zlbi5fc2FtLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiRGlfTHVfTWFfTWVfSmVfVmVfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiWVlZWS1NTS1ERCIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltBdWpvdXJkJ2h1aSDDoF0gTFQiLG5leHREYXk6IltEZW1haW4gw6BdIExUIixuZXh0V2VlazoiZGRkZCBbw6BdIExUIixsYXN0RGF5OiJbSGllciDDoF0gTFQiLGxhc3RXZWVrOiJkZGRkIFtkZXJuaWVyIMOgXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiZGFucyAlcyIscGFzdDoiaWwgeSBhICVzIixzOiJxdWVscXVlcyBzZWNvbmRlcyIsbToidW5lIG1pbnV0ZSIsbW06IiVkIG1pbnV0ZXMiLGg6InVuZSBoZXVyZSIsaGg6IiVkIGhldXJlcyIsZDoidW4gam91ciIsZGQ6IiVkIGpvdXJzIixNOiJ1biBtb2lzIixNTToiJWQgbW9pcyIseToidW4gYW4iLHl5OiIlZCBhbnMifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0oZXJ8ZSkvLG9yZGluYWw6ZnVuY3Rpb24odCl7cmV0dXJuIHQrKDE9PT10PyJlciI6ImUiKX19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJmci1jaCIse21vbnRoczoiamFudmllcl9mw6l2cmllcl9tYXJzX2F2cmlsX21haV9qdWluX2p1aWxsZXRfYW/Du3Rfc2VwdGVtYnJlX29jdG9icmVfbm92ZW1icmVfZMOpY2VtYnJlIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJqYW52Ll9mw6l2ci5fbWFyc19hdnIuX21haV9qdWluX2p1aWwuX2Fvw7t0X3NlcHQuX29jdC5fbm92Ll9kw6ljLiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiZGltYW5jaGVfbHVuZGlfbWFyZGlfbWVyY3JlZGlfamV1ZGlfdmVuZHJlZGlfc2FtZWRpIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6ImRpbS5fbHVuLl9tYXIuX21lci5famV1Ll92ZW4uX3NhbS4iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkRpX0x1X01hX01lX0plX1ZlX1NhIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbQXVqb3VyZCdodWkgw6BdIExUIixuZXh0RGF5OiJbRGVtYWluIMOgXSBMVCIsbmV4dFdlZWs6ImRkZGQgW8OgXSBMVCIsbGFzdERheToiW0hpZXIgw6BdIExUIixsYXN0V2VlazoiZGRkZCBbZGVybmllciDDoF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImRhbnMgJXMiLHBhc3Q6ImlsIHkgYSAlcyIsczoicXVlbHF1ZXMgc2Vjb25kZXMiLG06InVuZSBtaW51dGUiLG1tOiIlZCBtaW51dGVzIixoOiJ1bmUgaGV1cmUiLGhoOiIlZCBoZXVyZXMiLGQ6InVuIGpvdXIiLGRkOiIlZCBqb3VycyIsTToidW4gbW9pcyIsTU06IiVkIG1vaXMiLHk6InVuIGFuIix5eToiJWQgYW5zIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9KGVyfGUpLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3JldHVybiB0KygxPT09dD8iZXIiOiJlIil9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9Imphbi5fZmViLl9tcnQuX2Fwci5fbWFpX2p1bi5fanVsLl9hdWcuX3NlcC5fb2t0Ll9ub3YuX2Rlcy4iLnNwbGl0KCJfIiksaT0iamFuX2ZlYl9tcnRfYXByX21haV9qdW5fanVsX2F1Z19zZXBfb2t0X25vdl9kZXMiLnNwbGl0KCJfIiksbj10LmRlZmluZUxvY2FsZSgiZnkiLHttb250aHM6Imphbm5ld2FyaXNfZmVicmV3YXJpc19tYWFydF9hcHJpbF9tYWFpZV9qdW55X2p1bHlfYXVndXN0dXNfc2VwdGltYmVyX29rdG9iZXJfbm92aW1iZXJfZGVzaW1iZXIiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6ZnVuY3Rpb24odCxuKXtyZXR1cm4vLU1NTS0vLnRlc3Qobik/aVt0Lm1vbnRoKCldOmVbdC5tb250aCgpXX0sd2Vla2RheXM6InNuZWluX21vYW5kZWlfdGlpc2RlaV93b2Fuc2RlaV90b25nZXJzZGVpX2ZyZWVkX3NuZW9uIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6InNpLl9tby5fdGkuX3dvLl90by5fZnIuX3NvLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU2lfTW9fVGlfV29fVG9fRnJfU28iLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQtTU0tWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6Iltoam9lZCBvbV0gTFQiLG5leHREYXk6Ilttb2FybiBvbV0gTFQiLG5leHRXZWVrOiJkZGRkIFtvbV0gTFQiLGxhc3REYXk6IltqdXN0ZXIgb21dIExUIixsYXN0V2VlazoiW8O0ZnLDu25lXSBkZGRkIFtvbV0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6Im9lciAlcyIscGFzdDoiJXMgbHluIixzOiJpbiBwZWFyIHNla29uZGVuIixtOiJpZW4gbWluw7p0IixtbToiJWQgbWludXRlbiIsaDoiaWVuIG9lcmUiLGhoOiIlZCBvZXJlbiIsZDoiaWVuIGRlaSIsZGQ6IiVkIGRhZ2VuIixNOiJpZW4gbW9hbm5lIixNTToiJWQgbW9hbm5lbiIseToiaWVuIGppZXIiLHl5OiIlZCBqaWVycmVuIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9KHN0ZXxkZSkvLG9yZGluYWw6ZnVuY3Rpb24odCl7cmV0dXJuIHQrKDE9PT10fHw4PT09dHx8dD49MjA/InN0ZSI6ImRlIil9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBufSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9WyJBbSBGYW9pbGxlYWNoIiwiQW4gR2VhcnJhbiIsIkFtIE3DoHJ0IiwiQW4gR2libGVhbiIsIkFuIEPDqGl0ZWFuIiwiQW4gdC3DkmdtaGlvcyIsIkFuIHQtSXVjaGFyIiwiQW4gTMO5bmFzdGFsIiwiQW4gdC1TdWx0YWluIiwiQW4gRMOgbWhhaXIiLCJBbiB0LVNhbWhhaW4iLCJBbiBEw7liaGxhY2hkIl0saT1bIkZhb2kiLCJHZWFyIiwiTcOgcnQiLCJHaWJsIiwiQ8OoaXQiLCLDkmdtaCIsIkl1Y2giLCJMw7luIiwiU3VsdCIsIkTDoG1oIiwiU2FtaCIsIkTDuWJoIl0sbj1bIkRpZMOybWhuYWljaCIsIkRpbHVhaW4iLCJEaW3DoGlydCIsIkRpY2lhZGFpbiIsIkRpYXJkYW9pbiIsIkRpaGFvaW5lIiwiRGlzYXRoYWlybmUiXSxyPVsiRGlkIiwiRGlsIiwiRGltIiwiRGljIiwiRGlhIiwiRGloIiwiRGlzIl0scz1bIkTDsiIsIkx1IiwiTcOgIiwiQ2kiLCJBciIsIkhhIiwiU2EiXSxvPXQuZGVmaW5lTG9jYWxlKCJnZCIse21vbnRoczplLG1vbnRoc1Nob3J0OmksbW9udGhzUGFyc2VFeGFjdDohMCx3ZWVrZGF5czpuLHdlZWtkYXlzU2hvcnQ6cix3ZWVrZGF5c01pbjpzLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW0FuLWRpdWdoIGFpZ10gTFQiLG5leHREYXk6IltBLW3DoGlyZWFjaCBhaWddIExUIixuZXh0V2VlazoiZGRkZCBbYWlnXSBMVCIsbGFzdERheToiW0FuLWTDqCBhaWddIExUIixsYXN0V2VlazoiZGRkZCBbc2VvIGNoYWlkaF0gW2FpZ10gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImFubiBhbiAlcyIscGFzdDoiYmhvIGNoaW9ubiAlcyIsczoiYmVhZ2FuIGRpb2dhbiIsbToibWlvbmFpZCIsbW06IiVkIG1pb25haWRlYW4iLGg6InVhaXIiLGhoOiIlZCB1YWlyZWFuIixkOiJsYXRoYSIsZGQ6IiVkIGxhdGhhIixNOiJtw6xvcyIsTU06IiVkIG3DrG9zYW4iLHk6ImJsaWFkaG5hIix5eToiJWQgYmxpYWRobmEifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0oZHxuYXxtaCkvLG9yZGluYWw6ZnVuY3Rpb24odCl7dmFyIGU9MT09PXQ/ImQiOnQlMTA9PT0yPyJuYSI6Im1oIjtyZXR1cm4gdCtlfSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gb30pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJnbCIse21vbnRoczoiWGFuZWlyb19GZWJyZWlyb19NYXJ6b19BYnJpbF9NYWlvX1h1w7FvX1h1bGxvX0Fnb3N0b19TZXRlbWJyb19PdXR1YnJvX05vdmVtYnJvX0RlY2VtYnJvIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJYYW4uX0ZlYi5fTWFyLl9BYnIuX01haS5fWHXDsS5fWHVsLl9BZ28uX1NldC5fT3V0Ll9Ob3YuX0RlYy4iLnNwbGl0KCJfIiksd2Vla2RheXM6IkRvbWluZ29fTHVuc19NYXJ0ZXNfTcOpcmNvcmVzX1hvdmVzX1ZlbnJlc19Tw6FiYWRvIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IkRvbS5fTHVuLl9NYXIuX03DqXIuX1hvdi5fVmVuLl9Tw6FiLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiRG9fTHVfTWFfTcOpX1hvX1ZlX1PDoSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6Ikg6bW0iLExUUzoiSDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEg6bW0iLExMTEw6ImRkZGQgRCBNTU1NIFlZWVkgSDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OmZ1bmN0aW9uKCl7cmV0dXJuIltob3hlICIrKDEhPT10aGlzLmhvdXJzKCk/IsOhcyI6IsOhIikrIl0gTFQifSxuZXh0RGF5OmZ1bmN0aW9uKCl7cmV0dXJuIlttYcOxw6EgIisoMSE9PXRoaXMuaG91cnMoKT8iw6FzIjoiw6EiKSsiXSBMVCJ9LG5leHRXZWVrOmZ1bmN0aW9uKCl7cmV0dXJuImRkZGQgWyIrKDEhPT10aGlzLmhvdXJzKCk/IsOhcyI6ImEiKSsiXSBMVCJ9LGxhc3REYXk6ZnVuY3Rpb24oKXtyZXR1cm4iW29udGUgIisoMSE9PXRoaXMuaG91cnMoKT8iw6EiOiJhIikrIl0gTFQifSxsYXN0V2VlazpmdW5jdGlvbigpe3JldHVybiJbb10gZGRkZCBbcGFzYWRvICIrKDEhPT10aGlzLmhvdXJzKCk/IsOhcyI6ImEiKSsiXSBMVCJ9LHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ZnVuY3Rpb24odCl7cmV0dXJuInVucyBzZWd1bmRvcyI9PT10PyJudW5zIHNlZ3VuZG9zIjoiZW4gIit0fSxwYXN0OiJoYWkgJXMiLHM6InVucyBzZWd1bmRvcyIsbToidW4gbWludXRvIixtbToiJWQgbWludXRvcyIsaDoidW5oYSBob3JhIixoaDoiJWQgaG9yYXMiLGQ6InVuIGTDrWEiLGRkOiIlZCBkw61hcyIsTToidW4gbWVzIixNTToiJWQgbWVzZXMiLHk6InVuIGFubyIseXk6IiVkIGFub3MifSxvcmRpbmFsUGFyc2U6L1xkezEsMn3Cui8sb3JkaW5hbDoiJWTCuiIsd2Vlazp7ZG93OjEsZG95Ojd9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgiaGUiLHttb250aHM6IteZ16DXldeQ16hf16TXkdeo15XXkNeoX9ee16jXpV/XkNek16jXmdecX9ee15DXmV/XmdeV16DXmV/XmdeV15zXmV/XkNeV15LXldeh15hf16HXpNeY157XkdeoX9eQ15XXp9eY15XXkdeoX9eg15XXkdee15HXqF/Xk9em157XkdeoIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLXmdeg15XXs1/XpNeR16jXs1/Xnteo16Vf15DXpNeo17Nf157XkNeZX9eZ15XXoNeZX9eZ15XXnNeZX9eQ15XXktezX9eh16TXmNezX9eQ15XXp9ezX9eg15XXkdezX9eT16bXntezIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLXqNeQ16nXldefX9ep16DXmV/Xqdec15nXqdeZX9eo15HXmdei15lf15fXnteZ16nXmV/XqdeZ16nXmV/XqdeR16oiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi15DXs1/XkdezX9eS17Nf15PXs1/XlNezX9eV17Nf16nXsyIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi15Bf15Ff15Jf15Nf15Rf15Vf16kiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgW9eRXU1NTU0gWVlZWSIsTExMOiJEIFvXkV1NTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQgW9eRXU1NTU0gWVlZWSBISDptbSIsbDoiRC9NL1lZWVkiLGxsOiJEIE1NTSBZWVlZIixsbGw6IkQgTU1NIFlZWVkgSEg6bW0iLGxsbGw6ImRkZCwgRCBNTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb15TXmdeV150g15HWvl1MVCIsbmV4dERheToiW9ee15fXqCDXkda+XUxUIixuZXh0V2VlazoiZGRkZCBb15HXqdei15RdIExUIixsYXN0RGF5OiJb15DXqtee15XXnCDXkda+XUxUIixsYXN0V2VlazoiW9eR15nXldedXSBkZGRkIFvXlNeQ15fXqNeV158g15HXqdei15RdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLXkdei15XXkyAlcyIscGFzdDoi15zXpNeg15kgJXMiLHM6Itee16HXpNeoINep16DXmdeV16oiLG06IteT16fXlCIsbW06IiVkINeT16fXldeqIixoOiLXqdei15QiLGhoOmZ1bmN0aW9uKHQpe3JldHVybiAyPT09dD8i16nXoteq15nXmdedIjp0KyIg16nXoteV16oifSxkOiLXmdeV150iLGRkOmZ1bmN0aW9uKHQpe3JldHVybiAyPT09dD8i15nXldee15nXmdedIjp0KyIg15nXnteZ150ifSxNOiLXl9eV15PXqSIsTU06ZnVuY3Rpb24odCl7cmV0dXJuIDI9PT10PyLXl9eV15PXqdeZ15nXnSI6dCsiINeX15XXk9ep15nXnSJ9LHk6Itep16DXlCIseXk6ZnVuY3Rpb24odCl7cmV0dXJuIDI9PT10PyLXqdeg16rXmdeZ150iOnQlMTA9PT0wJiYxMCE9PXQ/dCsiINep16DXlCI6dCsiINep16DXmdedIn19LG1lcmlkaWVtUGFyc2U6L9eQ15fXlCLXpnzXnNek16DXlCLXpnzXkNeX16jXmSDXlNem15TXqNeZ15nXnXzXnNek16DXmSDXlNem15TXqNeZ15nXnXzXnNek16DXldeqINeR15XXp9eofNeR15HXlden16h815HXoteo15EvaSxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybi9eKNeQ15fXlCLXpnzXkNeX16jXmSDXlNem15TXqNeZ15nXnXzXkdei16jXkSkkLy50ZXN0KHQpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8NT8i15zXpNeg15XXqiDXkdeV16fXqCI6dDwxMD8i15HXkdeV16fXqCI6dDwxMj9pPyfXnNek16DXlCLXpic6Itec16TXoNeZINeU16bXlNeo15nXmdedIjp0PDE4P2k/J9eQ15fXlCLXpic6IteQ15fXqNeZINeU16bXlNeo15nXmdedIjoi15HXoteo15EifX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9ezE6IuClpyIsMjoi4KWoIiwzOiLgpakiLDQ6IuClqiIsNToi4KWrIiw2OiLgpawiLDc6IuClrSIsODoi4KWuIiw5OiLgpa8iLDA6IuClpiJ9LGk9eyLgpaciOiIxIiwi4KWoIjoiMiIsIuClqSI6IjMiLCLgpaoiOiI0Iiwi4KWrIjoiNSIsIuClrCI6IjYiLCLgpa0iOiI3Iiwi4KWuIjoiOCIsIuClryI6IjkiLCLgpaYiOiIwIn0sbj10LmRlZmluZUxvY2FsZSgiaGkiLHttb250aHM6IuCknOCkqOCkteCksOClgF/gpKvgpLzgpLDgpLXgpLDgpYBf4KSu4KS+4KSw4KWN4KSaX+CkheCkquCljeCksOCliOCksl/gpK7gpIhf4KSc4KWC4KSoX+CknOClgeCksuCkvuCkiF/gpIXgpJfgpLjgpY3gpKRf4KS44KS/4KSk4KSu4KWN4KSs4KSwX+CkheCkleCljeCkn+ClguCkrOCksF/gpKjgpLXgpK7gpY3gpKzgpLBf4KSm4KS/4KS44KSu4KWN4KSs4KSwIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLgpJzgpKguX+Ckq+CkvOCksC5f4KSu4KS+4KSw4KWN4KSaX+CkheCkquCljeCksOCliC5f4KSu4KSIX+CknOClguCkqF/gpJzgpYHgpLIuX+CkheCkly5f4KS44KS/4KSkLl/gpIXgpJXgpY3gpJ/gpYIuX+CkqOCktS5f4KSm4KS/4KS4LiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi4KSw4KS14KS/4KS14KS+4KSwX+CkuOCli+CkruCkteCkvuCksF/gpK7gpILgpJfgpLLgpLXgpL7gpLBf4KSs4KWB4KSn4KS14KS+4KSwX+Ckl+ClgeCksOClguCkteCkvuCksF/gpLbgpYHgpJXgpY3gpLDgpLXgpL7gpLBf4KS24KSo4KS/4KS14KS+4KSwIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IuCksOCkteCkv1/gpLjgpYvgpK5f4KSu4KSC4KSX4KSyX+CkrOClgeCkp1/gpJfgpYHgpLDgpYJf4KS24KWB4KSV4KWN4KSwX+CktuCkqOCkvyIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4KSwX+CkuOCli1/gpK7gpIJf4KSs4KWBX+Ckl+ClgV/gpLbgpYFf4KS2Ii5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiQSBoOm1tIOCkrOCknOClhyIsTFRTOiJBIGg6bW06c3Mg4KSs4KSc4KWHIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVksIEEgaDptbSDgpKzgpJzgpYciLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZLCBBIGg6bW0g4KSs4KSc4KWHIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvgpIbgpJxdIExUIixuZXh0RGF5OiJb4KSV4KSyXSBMVCIsbmV4dFdlZWs6ImRkZGQsIExUIixsYXN0RGF5OiJb4KSV4KSyXSBMVCIsbGFzdFdlZWs6IlvgpKrgpL/gpJvgpLLgpYddIGRkZGQsIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlcyDgpK7gpYfgpIIiLHBhc3Q6IiVzIOCkquCkueCksuClhyIsczoi4KSV4KWB4KSbIOCkueClgCDgpJXgpY3gpLfgpKMiLG06IuCkj+CklSDgpK7gpL/gpKjgpJ8iLG1tOiIlZCDgpK7gpL/gpKjgpJ8iLGg6IuCkj+CklSDgpJjgpILgpJ/gpL4iLGhoOiIlZCDgpJjgpILgpJ/gpYciLGQ6IuCkj+CklSDgpKbgpL/gpKgiLGRkOiIlZCDgpKbgpL/gpKgiLE06IuCkj+CklSDgpK7gpLngpYDgpKjgpYciLE1NOiIlZCDgpK7gpLngpYDgpKjgpYciLHk6IuCkj+CklSDgpLXgpLDgpY3gpLciLHl5OiIlZCDgpLXgpLDgpY3gpLcifSxwcmVwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9b4KWn4KWo4KWp4KWq4KWr4KWs4KWt4KWu4KWv4KWmXS9nLGZ1bmN0aW9uKHQpe3JldHVybiBpW3RdfSl9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pfSxtZXJpZGllbVBhcnNlOi/gpLDgpL7gpKR84KS44KWB4KSs4KS5fOCkpuCli+CkquCkueCksHzgpLbgpL7gpK4vLG1lcmlkaWVtSG91cjpmdW5jdGlvbih0LGUpe3JldHVybiAxMj09PXQmJih0PTApLCLgpLDgpL7gpKQiPT09ZT90PDQ/dDp0KzEyOiLgpLjgpYHgpKzgpLkiPT09ZT90OiLgpKbgpYvgpKrgpLngpLAiPT09ZT90Pj0xMD90OnQrMTI6IuCktuCkvuCkriI9PT1lP3QrMTI6dm9pZCAwfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8i4KSw4KS+4KSkIjp0PDEwPyLgpLjgpYHgpKzgpLkiOnQ8MTc/IuCkpuCli+CkquCkueCksCI6dDwyMD8i4KS24KS+4KSuIjoi4KSw4KS+4KSkIn0sd2Vlazp7ZG93OjAsZG95OjZ9fSk7cmV0dXJuIG59KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQsZSxpKXt2YXIgbj10KyIgIjtzd2l0Y2goaSl7Y2FzZSJtIjpyZXR1cm4gZT8iamVkbmEgbWludXRhIjoiamVkbmUgbWludXRlIjtjYXNlIm1tIjpyZXR1cm4gbis9MT09PXQ/Im1pbnV0YSI6Mj09PXR8fDM9PT10fHw0PT09dD8ibWludXRlIjoibWludXRhIjtjYXNlImgiOnJldHVybiBlPyJqZWRhbiBzYXQiOiJqZWRub2cgc2F0YSI7Y2FzZSJoaCI6cmV0dXJuIG4rPTE9PT10PyJzYXQiOjI9PT10fHwzPT09dHx8ND09PXQ/InNhdGEiOiJzYXRpIjtjYXNlImRkIjpyZXR1cm4gbis9MT09PXQ/ImRhbiI6ImRhbmEiO2Nhc2UiTU0iOnJldHVybiBuKz0xPT09dD8ibWplc2VjIjoyPT09dHx8Mz09PXR8fDQ9PT10PyJtamVzZWNhIjoibWplc2VjaSI7Y2FzZSJ5eSI6cmV0dXJuIG4rPTE9PT10PyJnb2RpbmEiOjI9PT10fHwzPT09dHx8ND09PXQ/ImdvZGluZSI6ImdvZGluYSJ9fXZhciBpPXQuZGVmaW5lTG9jYWxlKCJociIse21vbnRoczp7Zm9ybWF0OiJzaWplxI1uamFfdmVsamHEjWVfb8W+dWprYV90cmF2bmphX3N2aWJuamFfbGlwbmphX3NycG5qYV9rb2xvdm96YV9ydWpuYV9saXN0b3BhZGFfc3R1ZGVub2dhX3Byb3NpbmNhIi5zcGxpdCgiXyIpLHN0YW5kYWxvbmU6InNpamXEjWFual92ZWxqYcSNYV9vxb51amFrX3RyYXZhbmpfc3ZpYmFual9saXBhbmpfc3JwYW5qX2tvbG92b3pfcnVqYW5fbGlzdG9wYWRfc3R1ZGVuaV9wcm9zaW5hYyIuc3BsaXQoIl8iKX0sbW9udGhzU2hvcnQ6InNpai5fdmVsai5fb8W+dS5fdHJhLl9zdmkuX2xpcC5fc3JwLl9rb2wuX3J1ai5fbGlzLl9zdHUuX3Byby4iLnNwbGl0KCJfIiksd2Vla2RheXM6Im5lZGplbGphX3BvbmVkamVsamFrX3V0b3Jha19zcmlqZWRhX8SNZXR2cnRha19wZXRha19zdWJvdGEiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoibmVkLl9wb24uX3V0by5fc3JpLl/EjWV0Ll9wZXQuX3N1Yi4iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46Im5lX3BvX3V0X3NyX8SNZV9wZV9zdSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6Ikg6bW0iLExUUzoiSDptbTpzcyIsTDoiREQuIE1NLiBZWVlZIixMTDoiRC4gTU1NTSBZWVlZIixMTEw6IkQuIE1NTU0gWVlZWSBIOm1tIixMTExMOiJkZGRkLCBELiBNTU1NIFlZWVkgSDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbZGFuYXMgdV0gTFQiLG5leHREYXk6IltzdXRyYSB1XSBMVCIsbmV4dFdlZWs6ZnVuY3Rpb24oKXtzd2l0Y2godGhpcy5kYXkoKSl7Y2FzZSAwOnJldHVybiJbdV0gW25lZGplbGp1XSBbdV0gTFQiO2Nhc2UgMzpyZXR1cm4iW3VdIFtzcmlqZWR1XSBbdV0gTFQiO2Nhc2UgNjpyZXR1cm4iW3VdIFtzdWJvdHVdIFt1XSBMVCI7Y2FzZSAxOmNhc2UgMjpjYXNlIDQ6Y2FzZSA1OnJldHVybiJbdV0gZGRkZCBbdV0gTFQifX0sbGFzdERheToiW2p1xI1lciB1XSBMVCIsbGFzdFdlZWs6ZnVuY3Rpb24oKXtzd2l0Y2godGhpcy5kYXkoKSl7Y2FzZSAwOmNhc2UgMzpyZXR1cm4iW3Byb8WhbHVdIGRkZGQgW3VdIExUIjtjYXNlIDY6cmV0dXJuIltwcm/FoWxlXSBbc3Vib3RlXSBbdV0gTFQiO2Nhc2UgMTpjYXNlIDI6Y2FzZSA0OmNhc2UgNTpyZXR1cm4iW3Byb8WhbGldIGRkZGQgW3VdIExUIn19LHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6InphICVzIixwYXN0OiJwcmlqZSAlcyIsczoicGFyIHNla3VuZGkiLG06ZSxtbTplLGg6ZSxoaDplLGQ6ImRhbiIsZGQ6ZSxNOiJtamVzZWMiLE1NOmUseToiZ29kaW51Iix5eTplfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCxlLGksbil7dmFyIHI9dDtzd2l0Y2goaSl7Y2FzZSJzIjpyZXR1cm4gbnx8ZT8ibsOpaMOhbnkgbcOhc29kcGVyYyI6Im7DqWjDoW55IG3DoXNvZHBlcmNlIjtjYXNlIm0iOnJldHVybiJlZ3kiKyhufHxlPyIgcGVyYyI6IiBwZXJjZSIpO2Nhc2UibW0iOnJldHVybiByKyhufHxlPyIgcGVyYyI6IiBwZXJjZSIpO2Nhc2UiaCI6cmV0dXJuImVneSIrKG58fGU/IiDDs3JhIjoiIMOzcsOhamEiKTtjYXNlImhoIjpyZXR1cm4gcisobnx8ZT8iIMOzcmEiOiIgw7Nyw6FqYSIpO2Nhc2UiZCI6cmV0dXJuImVneSIrKG58fGU/IiBuYXAiOiIgbmFwamEiKTtjYXNlImRkIjpyZXR1cm4gcisobnx8ZT8iIG5hcCI6IiBuYXBqYSIpO2Nhc2UiTSI6cmV0dXJuImVneSIrKG58fGU/IiBow7NuYXAiOiIgaMOzbmFwamEiKTtjYXNlIk1NIjpyZXR1cm4gcisobnx8ZT8iIGjDs25hcCI6IiBow7NuYXBqYSIpO2Nhc2UieSI6cmV0dXJuImVneSIrKG58fGU/IiDDqXYiOiIgw6l2ZSIpO2Nhc2UieXkiOnJldHVybiByKyhufHxlPyIgw6l2IjoiIMOpdmUiKX1yZXR1cm4iIn1mdW5jdGlvbiBpKHQpe3JldHVybih0PyIiOiJbbcO6bHRdICIpKyJbIituW3RoaXMuZGF5KCldKyJdIExUWy1rb3JdIn12YXIgbj0idmFzw6FybmFwIGjDqXRmxZFuIGtlZGRlbiBzemVyZMOhbiBjc8O8dMO2cnTDtmvDtm4gcMOpbnRla2VuIHN6b21iYXRvbiIuc3BsaXQoIiAiKSxyPXQuZGVmaW5lTG9jYWxlKCJodSIse21vbnRoczoiamFudcOhcl9mZWJydcOhcl9tw6FyY2l1c1/DoXByaWxpc19tw6FqdXNfasO6bml1c19qw7psaXVzX2F1Z3VzenR1c19zemVwdGVtYmVyX29rdMOzYmVyX25vdmVtYmVyX2RlY2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJqYW5fZmViX23DoXJjX8OhcHJfbcOhal9qw7puX2rDumxfYXVnX3N6ZXB0X29rdF9ub3ZfZGVjIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJ2YXPDoXJuYXBfaMOpdGbFkV9rZWRkX3N6ZXJkYV9jc8O8dMO2cnTDtmtfcMOpbnRla19zem9tYmF0Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6InZhc19ow6l0X2tlZGRfc3plX2Nzw7x0X3DDqW5fc3pvIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJ2X2hfa19zemVfY3NfcF9zem8iLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IllZWVkuTU0uREQuIixMTDoiWVlZWS4gTU1NTSBELiIsTExMOiJZWVlZLiBNTU1NIEQuIEg6bW0iLExMTEw6IllZWVkuIE1NTU0gRC4sIGRkZGQgSDptbSJ9LG1lcmlkaWVtUGFyc2U6L2RlfGR1L2ksaXNQTTpmdW5jdGlvbih0KXtyZXR1cm4idSI9PT10LmNoYXJBdCgxKS50b0xvd2VyQ2FzZSgpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/aT09PSEwPyJkZSI6IkRFIjppPT09ITA/ImR1IjoiRFUifSxjYWxlbmRhcjp7c2FtZURheToiW21hXSBMVFsta29yXSIsbmV4dERheToiW2hvbG5hcF0gTFRbLWtvcl0iLG5leHRXZWVrOmZ1bmN0aW9uKCl7cmV0dXJuIGkuY2FsbCh0aGlzLCEwKX0sbGFzdERheToiW3RlZ25hcF0gTFRbLWtvcl0iLGxhc3RXZWVrOmZ1bmN0aW9uKCl7cmV0dXJuIGkuY2FsbCh0aGlzLCExKX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMgbcO6bHZhIixwYXN0OiIlcyIsczplLG06ZSxtbTplLGg6ZSxoaDplLGQ6ZSxkZDplLE06ZSxNTTplLHk6ZSx5eTplfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gcn0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJoeS1hbSIse21vbnRoczp7Zm9ybWF0OiLVsNW41oLVttW+1aHWgNWrX9aD1aXVv9aA1b7VodaA1atf1bTVodaA1b/Vq1/VodW61oDVq9Ws1atf1bTVodW11avVvdWrX9Ww1bjWgtW21avVvdWrX9Ww1bjWgtWs1avVvdWrX9aF1aPVuNW91b/VuNW91atf1b3VpdW61b/VpdW01aLVpdaA1atf1bDVuNWv1b/VpdW01aLVpdaA1atf1bbVuNW11aXVtNWi1aXWgNWrX9Wk1aXVr9W/1aXVtNWi1aXWgNWrIi5zcGxpdCgiXyIpLHN0YW5kYWxvbmU6ItWw1bjWgtW21b7VodaAX9aD1aXVv9aA1b7VodaAX9W01aHWgNW/X9Wh1brWgNWr1axf1bTVodW11avVvV/VsNW41oLVttWr1b1f1bDVuNaC1azVq9W9X9aF1aPVuNW91b/VuNW9X9W91aXVutW/1aXVtNWi1aXWgF/VsNW41a/Vv9Wl1bTVotWl1oBf1bbVuNW11aXVtNWi1aXWgF/VpNWl1a/Vv9Wl1bTVotWl1oAiLnNwbGl0KCJfIil9LG1vbnRoc1Nob3J0OiLVsNW21b5f1oPVv9aAX9W01oDVv1/VodW61oBf1bTVtdW9X9Ww1bbVvV/VsNWs1b1f1oXVo9W9X9W91brVv1/VsNWv1b9f1bbVtNWiX9Wk1a/VvyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi1a/Vq9aA1aHVr9WrX9Wl1oDVr9W41oLVt9Wh1aLVqdWrX9Wl1oDVpdaE1bfVodWi1anVq1/VudW41oDVpdaE1bfVodWi1anVq1/VsNWr1bbVo9W31aHVotWp1atf1bjWgtaA1aLVodWpX9W31aHVotWh1akiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi1a/WgNWvX9Wl1oDVr1/VpdaA1oRf1bnWgNaEX9Ww1bbVo1/VuNaC1oDVol/Vt9Wi1akiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46ItWv1oDVr1/VpdaA1a9f1aXWgNaEX9W51oDWhF/VsNW21aNf1bjWgtaA1aJf1bfVotWpIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJEIE1NTU0gWVlZWSDVqS4iLExMTDoiRCBNTU1NIFlZWVkg1akuLCBISDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkg1akuLCBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb1aHVtdW91oXWgF0gTFQiLG5leHREYXk6IlvVvtWh1bLVqF0gTFQiLGxhc3REYXk6IlvVpdaA1aXVr10gTFQiLG5leHRXZWVrOmZ1bmN0aW9uKCl7cmV0dXJuImRkZGQgW9aF1oDVqCDVqtWh1bTVqF0gTFQifSxsYXN0V2VlazpmdW5jdGlvbigpe3JldHVybiJb1aHVttaB1aHVrl0gZGRkZCBb1oXWgNWoINWq1aHVtNWoXSBMVCJ9LHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVzINWw1aXVv9W4IixwYXN0OiIlcyDVodW81aHVuyIsczoi1bTVqyDWhNWh1bbVqyDVvtWh1bXWgNWv1bXVodW2IixtOiLWgNW41brVpSIsbW06IiVkINaA1bjVutWlIixoOiLVqtWh1bQiLGhoOiIlZCDVqtWh1bQiLGQ6ItaF1oAiLGRkOiIlZCDWhdaAIixNOiLVodW01avVvSIsTU06IiVkINWh1bTVq9W9Iix5OiLVv9Wh1oDVqyIseXk6IiVkINW/1aHWgNWrIn0sbWVyaWRpZW1QYXJzZTov1aPVq9W31aXWgNW+1aF81aHVvNWh1b7VuNW/1b7VoXzWgdWl1oDVpdWv1b7VoXzVpdaA1aXVr9W41bXVodW2Lyxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybi9eKNaB1aXWgNWl1a/VvtWhfNWl1oDVpdWv1bjVtdWh1bYpJC8udGVzdCh0KX0sbWVyaWRpZW06ZnVuY3Rpb24odCl7cmV0dXJuIHQ8ND8i1aPVq9W31aXWgNW+1aEiOnQ8MTI/ItWh1bzVodW+1bjVv9W+1aEiOnQ8MTc/ItaB1aXWgNWl1a/VvtWhIjoi1aXWgNWl1a/VuNW11aHVtiJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfXxcZHsxLDJ9LSjVq9W2fNaA1aQpLyxvcmRpbmFsOmZ1bmN0aW9uKHQsZSl7c3dpdGNoKGUpe2Nhc2UiREREIjpjYXNlInciOmNhc2UiVyI6Y2FzZSJERERvIjpyZXR1cm4gMT09PXQ/dCsiLdWr1bYiOnQrIi3WgNWkIjtkZWZhdWx0OnJldHVybiB0fX0sd2Vlazp7ZG93OjEsZG95Ojd9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgiaWQiLHttb250aHM6IkphbnVhcmlfRmVicnVhcmlfTWFyZXRfQXByaWxfTWVpX0p1bmlfSnVsaV9BZ3VzdHVzX1NlcHRlbWJlcl9Pa3RvYmVyX05vdmVtYmVyX0Rlc2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJKYW5fRmViX01hcl9BcHJfTWVpX0p1bl9KdWxfQWdzX1NlcF9Pa3RfTm92X0RlcyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiTWluZ2d1X1NlbmluX1NlbGFzYV9SYWJ1X0thbWlzX0p1bWF0X1NhYnR1Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6Ik1pbl9TZW5fU2VsX1JhYl9LYW1fSnVtX1NhYiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiTWdfU25fU2xfUmJfS21fSm1fU2IiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISC5tbSIsTFRTOiJISC5tbS5zcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIFtwdWt1bF0gSEgubW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIFtwdWt1bF0gSEgubW0ifSxtZXJpZGllbVBhcnNlOi9wYWdpfHNpYW5nfHNvcmV8bWFsYW0vLG1lcmlkaWVtSG91cjpmdW5jdGlvbih0LGUpe3JldHVybiAxMj09PXQmJih0PTApLCJwYWdpIj09PWU/dDoic2lhbmciPT09ZT90Pj0xMT90OnQrMTI6InNvcmUiPT09ZXx8Im1hbGFtIj09PWU/dCsxMjp2b2lkIDB9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDwxMT8icGFnaSI6dDwxNT8ic2lhbmciOnQ8MTk/InNvcmUiOiJtYWxhbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbSGFyaSBpbmkgcHVrdWxdIExUIixuZXh0RGF5OiJbQmVzb2sgcHVrdWxdIExUIixuZXh0V2VlazoiZGRkZCBbcHVrdWxdIExUIixsYXN0RGF5OiJbS2VtYXJpbiBwdWt1bF0gTFQiLGxhc3RXZWVrOiJkZGRkIFtsYWx1IHB1a3VsXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiZGFsYW0gJXMiLHBhc3Q6IiVzIHlhbmcgbGFsdSIsczoiYmViZXJhcGEgZGV0aWsiLG06InNlbWVuaXQiLG1tOiIlZCBtZW5pdCIsaDoic2VqYW0iLGhoOiIlZCBqYW0iLGQ6InNlaGFyaSIsZGQ6IiVkIGhhcmkiLE06InNlYnVsYW4iLAoJTU06IiVkIGJ1bGFuIix5OiJzZXRhaHVuIix5eToiJWQgdGFodW4ifSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCl7cmV0dXJuIHQlMTAwPT09MTF8fHQlMTAhPT0xfWZ1bmN0aW9uIGkodCxpLG4scil7dmFyIHM9dCsiICI7c3dpdGNoKG4pe2Nhc2UicyI6cmV0dXJuIGl8fHI/Im5va2tyYXIgc2Vrw7puZHVyIjoibm9ra3J1bSBzZWvDum5kdW0iO2Nhc2UibSI6cmV0dXJuIGk/Im3DrW7DunRhIjoibcOtbsO6dHUiO2Nhc2UibW0iOnJldHVybiBlKHQpP3MrKGl8fHI/Im3DrW7DunR1ciI6Im3DrW7DunR1bSIpOmk/cysibcOtbsO6dGEiOnMrIm3DrW7DunR1IjtjYXNlImhoIjpyZXR1cm4gZSh0KT9zKyhpfHxyPyJrbHVra3VzdHVuZGlyIjoia2x1a2t1c3R1bmR1bSIpOnMrImtsdWtrdXN0dW5kIjtjYXNlImQiOnJldHVybiBpPyJkYWd1ciI6cj8iZGFnIjoiZGVnaSI7Y2FzZSJkZCI6cmV0dXJuIGUodCk/aT9zKyJkYWdhciI6cysocj8iZGFnYSI6ImTDtmd1bSIpOmk/cysiZGFndXIiOnMrKHI/ImRhZyI6ImRlZ2kiKTtjYXNlIk0iOnJldHVybiBpPyJtw6FudcOwdXIiOnI/Im3DoW51w7AiOiJtw6FudcOwaSI7Y2FzZSJNTSI6cmV0dXJuIGUodCk/aT9zKyJtw6FudcOwaXIiOnMrKHI/Im3DoW51w7BpIjoibcOhbnXDsHVtIik6aT9zKyJtw6FudcOwdXIiOnMrKHI/Im3DoW51w7AiOiJtw6FudcOwaSIpO2Nhc2UieSI6cmV0dXJuIGl8fHI/IsOhciI6IsOhcmkiO2Nhc2UieXkiOnJldHVybiBlKHQpP3MrKGl8fHI/IsOhciI6IsOhcnVtIik6cysoaXx8cj8iw6FyIjoiw6FyaSIpfX12YXIgbj10LmRlZmluZUxvY2FsZSgiaXMiLHttb250aHM6ImphbsO6YXJfZmVicsO6YXJfbWFyc19hcHLDrWxfbWHDrV9qw7puw61fasO6bMOtX8OhZ8O6c3Rfc2VwdGVtYmVyX29rdMOzYmVyX27Ds3ZlbWJlcl9kZXNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiamFuX2ZlYl9tYXJfYXByX21hw61fasO6bl9qw7psX8OhZ8O6X3NlcF9va3RfbsOzdl9kZXMiLnNwbGl0KCJfIiksd2Vla2RheXM6InN1bm51ZGFndXJfbcOhbnVkYWd1cl/DvnJpw7BqdWRhZ3VyX21pw7B2aWt1ZGFndXJfZmltbXR1ZGFndXJfZsO2c3R1ZGFndXJfbGF1Z2FyZGFndXIiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoic3VuX23DoW5fw75yaV9tacOwX2ZpbV9mw7ZzX2xhdSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU3VfTcOhX8Oecl9NaV9GaV9Gw7ZfTGEiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJELiBNTU1NIFlZWVkiLExMTDoiRC4gTU1NTSBZWVlZIFtrbC5dIEg6bW0iLExMTEw6ImRkZGQsIEQuIE1NTU0gWVlZWSBba2wuXSBIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvDrSBkYWcga2wuXSBMVCIsbmV4dERheToiW8OhIG1vcmd1biBrbC5dIExUIixuZXh0V2VlazoiZGRkZCBba2wuXSBMVCIsbGFzdERheToiW8OtIGfDpnIga2wuXSBMVCIsbGFzdFdlZWs6Iltzw63DsGFzdGFdIGRkZGQgW2tsLl0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImVmdGlyICVzIixwYXN0OiJmeXJpciAlcyBzw63DsGFuIixzOmksbTppLG1tOmksaDoia2x1a2t1c3R1bmQiLGhoOmksZDppLGRkOmksTTppLE1NOmkseTppLHl5Oml9LG9yZGluYWxQYXJzZTovXGR7MSwyfVwuLyxvcmRpbmFsOiIlZC4iLHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBufSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoIml0Iix7bW9udGhzOiJnZW5uYWlvX2ZlYmJyYWlvX21hcnpvX2FwcmlsZV9tYWdnaW9fZ2l1Z25vX2x1Z2xpb19hZ29zdG9fc2V0dGVtYnJlX290dG9icmVfbm92ZW1icmVfZGljZW1icmUiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Imdlbl9mZWJfbWFyX2Fwcl9tYWdfZ2l1X2x1Z19hZ29fc2V0X290dF9ub3ZfZGljIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJEb21lbmljYV9MdW5lZMOsX01hcnRlZMOsX01lcmNvbGVkw6xfR2lvdmVkw6xfVmVuZXJkw6xfU2FiYXRvIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IkRvbV9MdW5fTWFyX01lcl9HaW9fVmVuX1NhYiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiRG9fTHVfTWFfTWVfR2lfVmVfU2EiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbT2dnaSBhbGxlXSBMVCIsbmV4dERheToiW0RvbWFuaSBhbGxlXSBMVCIsbmV4dFdlZWs6ImRkZGQgW2FsbGVdIExUIixsYXN0RGF5OiJbSWVyaSBhbGxlXSBMVCIsbGFzdFdlZWs6ZnVuY3Rpb24oKXtzd2l0Y2godGhpcy5kYXkoKSl7Y2FzZSAwOnJldHVybiJbbGEgc2NvcnNhXSBkZGRkIFthbGxlXSBMVCI7ZGVmYXVsdDpyZXR1cm4iW2xvIHNjb3Jzb10gZGRkZCBbYWxsZV0gTFQifX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZTpmdW5jdGlvbih0KXtyZXR1cm4oL15bMC05XS4rJC8udGVzdCh0KT8idHJhIjoiaW4iKSsiICIrdH0scGFzdDoiJXMgZmEiLHM6ImFsY3VuaSBzZWNvbmRpIixtOiJ1biBtaW51dG8iLG1tOiIlZCBtaW51dGkiLGg6InVuJ29yYSIsaGg6IiVkIG9yZSIsZDoidW4gZ2lvcm5vIixkZDoiJWQgZ2lvcm5pIixNOiJ1biBtZXNlIixNTToiJWQgbWVzaSIseToidW4gYW5ubyIseXk6IiVkIGFubmkifSxvcmRpbmFsUGFyc2U6L1xkezEsMn3Cui8sb3JkaW5hbDoiJWTCuiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgiamEiLHttb250aHM6IjHmnIhfMuaciF8z5pyIXzTmnIhfNeaciF825pyIXzfmnIhfOOaciF855pyIXzEw5pyIXzEx5pyIXzEy5pyIIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiIx5pyIXzLmnIhfM+aciF805pyIXzXmnIhfNuaciF835pyIXzjmnIhfOeaciF8xMOaciF8xMeaciF8xMuaciCIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi5pel5puc5pelX+aciOabnOaXpV/ngavmm5zml6Vf5rC05puc5pelX+acqOabnOaXpV/ph5Hmm5zml6Vf5Zyf5puc5pelIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IuaXpV/mnIhf54GrX+awtF/mnKhf6YeRX+WcnyIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi5pelX+aciF/ngatf5rC0X+acqF/ph5Ff5ZyfIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiQWjmmYJt5YiGIixMVFM6IkFo5pmCbeWIhnPnp5IiLEw6IllZWVkvTU0vREQiLExMOiJZWVlZ5bm0TeaciETml6UiLExMTDoiWVlZWeW5tE3mnIhE5pelQWjmmYJt5YiGIixMTExMOiJZWVlZ5bm0TeaciETml6VBaOaZgm3liIYgZGRkZCJ9LG1lcmlkaWVtUGFyc2U6L+WNiOWJjXzljYjlvowvaSxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybiLljYjlvowiPT09dH0sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PDEyPyLljYjliY0iOiLljYjlvowifSxjYWxlbmRhcjp7c2FtZURheToiW+S7iuaXpV0gTFQiLG5leHREYXk6IlvmmI7ml6VdIExUIixuZXh0V2VlazoiW+adpemAsV1kZGRkIExUIixsYXN0RGF5OiJb5pio5pelXSBMVCIsbGFzdFdlZWs6IlvliY3pgLFdZGRkZCBMVCIsc2FtZUVsc2U6IkwifSxvcmRpbmFsUGFyc2U6L1xkezEsMn3ml6UvLG9yZGluYWw6ZnVuY3Rpb24odCxlKXtzd2l0Y2goZSl7Y2FzZSJkIjpjYXNlIkQiOmNhc2UiREREIjpyZXR1cm4gdCsi5pelIjtkZWZhdWx0OnJldHVybiB0fX0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVz5b6MIixwYXN0OiIlc+WJjSIsczoi5pWw56eSIixtOiIx5YiGIixtbToiJWTliIYiLGg6IjHmmYLplpMiLGhoOiIlZOaZgumWkyIsZDoiMeaXpSIsZGQ6IiVk5pelIixNOiIx44O25pyIIixNTToiJWTjg7bmnIgiLHk6IjHlubQiLHl5OiIlZOW5tCJ9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgianYiLHttb250aHM6IkphbnVhcmlfRmVicnVhcmlfTWFyZXRfQXByaWxfTWVpX0p1bmlfSnVsaV9BZ3VzdHVzX1NlcHRlbWJlcl9Pa3RvYmVyX05vcGVtYmVyX0Rlc2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJKYW5fRmViX01hcl9BcHJfTWVpX0p1bl9KdWxfQWdzX1NlcF9Pa3RfTm9wX0RlcyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiTWluZ2d1X1NlbmVuX1NlbG9zb19SZWJ1X0tlbWlzX0plbXV3YWhfU2VwdHUiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiTWluX1Nlbl9TZWxfUmViX0tlbV9KZW1fU2VwIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJNZ19Tbl9TbF9SYl9LbV9KbV9TcCIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhILm1tIixMVFM6IkhILm1tLnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgW3B1a3VsXSBISC5tbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgW3B1a3VsXSBISC5tbSJ9LG1lcmlkaWVtUGFyc2U6L2VuamluZ3xzaXlhbmd8c29udGVufG5kYWx1LyxtZXJpZGllbUhvdXI6ZnVuY3Rpb24odCxlKXtyZXR1cm4gMTI9PT10JiYodD0wKSwiZW5qaW5nIj09PWU/dDoic2l5YW5nIj09PWU/dD49MTE/dDp0KzEyOiJzb250ZW4iPT09ZXx8Im5kYWx1Ij09PWU/dCsxMjp2b2lkIDB9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDwxMT8iZW5qaW5nIjp0PDE1PyJzaXlhbmciOnQ8MTk/InNvbnRlbiI6Im5kYWx1In0sY2FsZW5kYXI6e3NhbWVEYXk6IltEaW50ZW4gcHVuaWtvIHB1a3VsXSBMVCIsbmV4dERheToiW01iZW5qYW5nIHB1a3VsXSBMVCIsbmV4dFdlZWs6ImRkZGQgW3B1a3VsXSBMVCIsbGFzdERheToiW0thbGEgd2luZ2kgcHVrdWxdIExUIixsYXN0V2VlazoiZGRkZCBba2VwZW5na2VyIHB1a3VsXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToid29udGVuIGluZyAlcyIscGFzdDoiJXMgaW5na2FuZyBrZXBlbmdrZXIiLHM6InNhd2V0YXdpcyBkZXRpayIsbToic2V0dW5nZ2FsIG1lbml0IixtbToiJWQgbWVuaXQiLGg6InNldHVuZ2dhbCBqYW0iLGhoOiIlZCBqYW0iLGQ6InNlZGludGVuIixkZDoiJWQgZGludGVuIixNOiJzZXd1bGFuIixNTToiJWQgd3VsYW4iLHk6InNldGF1biIseXk6IiVkIHRhdW4ifSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJrYSIse21vbnRoczp7c3RhbmRhbG9uZToi4YOY4YOQ4YOc4YOV4YOQ4YOg4YOYX+GDl+GDlOGDkeGDlOGDoOGDleGDkOGDmuGDmF/hg5vhg5Dhg6Dhg6Lhg5hf4YOQ4YOe4YOg4YOY4YOa4YOYX+GDm+GDkOGDmOGDoeGDmF/hg5jhg5Xhg5zhg5jhg6Hhg5hf4YOY4YOV4YOa4YOY4YOh4YOYX+GDkOGDkuGDleGDmOGDoeGDouGDnV/hg6Hhg5Thg6Xhg6Lhg5Thg5vhg5Hhg5Thg6Dhg5hf4YOd4YOl4YOi4YOd4YOb4YOR4YOU4YOg4YOYX+GDnOGDneGDlOGDm+GDkeGDlOGDoOGDmF/hg5Phg5Thg5nhg5Thg5vhg5Hhg5Thg6Dhg5giLnNwbGl0KCJfIiksZm9ybWF0OiLhg5jhg5Dhg5zhg5Xhg5Dhg6Dhg6Ff4YOX4YOU4YOR4YOU4YOg4YOV4YOQ4YOa4YOhX+GDm+GDkOGDoOGDouGDoV/hg5Dhg57hg6Dhg5jhg5rhg5jhg6Ff4YOb4YOQ4YOY4YOh4YOhX+GDmOGDleGDnOGDmOGDoeGDoV/hg5jhg5Xhg5rhg5jhg6Hhg6Ff4YOQ4YOS4YOV4YOY4YOh4YOi4YOhX+GDoeGDlOGDpeGDouGDlOGDm+GDkeGDlOGDoOGDoV/hg53hg6Xhg6Lhg53hg5vhg5Hhg5Thg6Dhg6Ff4YOc4YOd4YOU4YOb4YOR4YOU4YOg4YOhX+GDk+GDlOGDmeGDlOGDm+GDkeGDlOGDoOGDoSIuc3BsaXQoIl8iKX0sbW9udGhzU2hvcnQ6IuGDmOGDkOGDnF/hg5fhg5Thg5Ff4YOb4YOQ4YOgX+GDkOGDnuGDoF/hg5vhg5Dhg5hf4YOY4YOV4YOcX+GDmOGDleGDml/hg5Dhg5Lhg5Vf4YOh4YOU4YOlX+GDneGDpeGDol/hg5zhg53hg5Rf4YOT4YOU4YOZIi5zcGxpdCgiXyIpLHdlZWtkYXlzOntzdGFuZGFsb25lOiLhg5nhg5Xhg5jhg6Dhg5Bf4YOd4YOg4YOo4YOQ4YOR4YOQ4YOX4YOYX+GDoeGDkOGDm+GDqOGDkOGDkeGDkOGDl+GDmF/hg53hg5fhg67hg6jhg5Dhg5Hhg5Dhg5fhg5hf4YOu4YOj4YOX4YOo4YOQ4YOR4YOQ4YOX4YOYX+GDnuGDkOGDoOGDkOGDoeGDmeGDlOGDleGDmF/hg6jhg5Dhg5Hhg5Dhg5fhg5giLnNwbGl0KCJfIiksZm9ybWF0OiLhg5nhg5Xhg5jhg6Dhg5Dhg6Ff4YOd4YOg4YOo4YOQ4YOR4YOQ4YOX4YOhX+GDoeGDkOGDm+GDqOGDkOGDkeGDkOGDl+GDoV/hg53hg5fhg67hg6jhg5Dhg5Hhg5Dhg5fhg6Ff4YOu4YOj4YOX4YOo4YOQ4YOR4YOQ4YOX4YOhX+GDnuGDkOGDoOGDkOGDoeGDmeGDlOGDleGDoV/hg6jhg5Dhg5Hhg5Dhg5fhg6EiLnNwbGl0KCJfIiksaXNGb3JtYXQ6Lyjhg6zhg5jhg5zhg5B84YOo4YOU4YOb4YOT4YOU4YOSKS99LHdlZWtkYXlzU2hvcnQ6IuGDmeGDleGDmF/hg53hg6Dhg6hf4YOh4YOQ4YObX+GDneGDl+GDrl/hg67hg6Phg5df4YOe4YOQ4YOgX+GDqOGDkOGDkSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4YOZ4YOVX+GDneGDoF/hg6Hhg5Bf4YOd4YOXX+GDruGDo1/hg57hg5Bf4YOo4YOQIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiaDptbSBBIixMVFM6Img6bW06c3MgQSIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIGg6bW0gQSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgaDptbSBBIn0sY2FsZW5kYXI6e3NhbWVEYXk6Ilvhg5Phg6bhg5Thg6FdIExUWy3hg5bhg5RdIixuZXh0RGF5OiJb4YOu4YOV4YOQ4YOaXSBMVFst4YOW4YOUXSIsbGFzdERheToiW+GDkuGDo+GDqOGDmOGDnF0gTFRbLeGDluGDlF0iLG5leHRXZWVrOiJb4YOo4YOU4YOb4YOT4YOU4YOSXSBkZGRkIExUWy3hg5bhg5RdIixsYXN0V2VlazoiW+GDrOGDmOGDnOGDkF0gZGRkZCBMVC3hg5bhg5QiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ZnVuY3Rpb24odCl7cmV0dXJuLyjhg6zhg5Dhg5vhg5h84YOs4YOj4YOX4YOYfOGDoeGDkOGDkOGDl+GDmHzhg6zhg5Thg5rhg5gpLy50ZXN0KHQpP3QucmVwbGFjZSgv4YOYJC8sIuGDqOGDmCIpOnQrIuGDqOGDmCJ9LHBhc3Q6ZnVuY3Rpb24odCl7cmV0dXJuLyjhg6zhg5Dhg5vhg5h84YOs4YOj4YOX4YOYfOGDoeGDkOGDkOGDl+GDmHzhg5Phg6bhg5R84YOX4YOV4YOUKS8udGVzdCh0KT90LnJlcGxhY2UoLyjhg5h84YOUKSQvLCLhg5jhg6Eg4YOs4YOY4YOcIik6L+GDrOGDlOGDmuGDmC8udGVzdCh0KT90LnJlcGxhY2UoL+GDrOGDlOGDmuGDmCQvLCLhg6zhg5rhg5jhg6Eg4YOs4YOY4YOcIik6dm9pZCAwfSxzOiLhg6Dhg5Dhg5vhg5Phg5Thg5zhg5jhg5vhg5Qg4YOs4YOQ4YOb4YOYIixtOiLhg6zhg6Phg5fhg5giLG1tOiIlZCDhg6zhg6Phg5fhg5giLGg6IuGDoeGDkOGDkOGDl+GDmCIsaGg6IiVkIOGDoeGDkOGDkOGDl+GDmCIsZDoi4YOT4YOm4YOUIixkZDoiJWQg4YOT4YOm4YOUIixNOiLhg5fhg5Xhg5QiLE1NOiIlZCDhg5fhg5Xhg5QiLHk6IuGDrOGDlOGDmuGDmCIseXk6IiVkIOGDrOGDlOGDmuGDmCJ9LG9yZGluYWxQYXJzZTovMHwxLeGDmuGDmHzhg5vhg5QtXGR7MSwyfXxcZHsxLDJ9LeGDlC8sb3JkaW5hbDpmdW5jdGlvbih0KXtyZXR1cm4gMD09PXQ/dDoxPT09dD90KyIt4YOa4YOYIjp0PDIwfHx0PD0xMDAmJnQlMjA9PT0wfHx0JTEwMD09PTA/IuGDm+GDlC0iK3Q6dCsiLeGDlCJ9LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9ezA6Ii3RiNGWIiwxOiIt0YjRliIsMjoiLdGI0ZYiLDM6Ii3RiNGWIiw0OiIt0YjRliIsNToiLdGI0ZYiLDY6Ii3RiNGLIiw3OiIt0YjRliIsODoiLdGI0ZYiLDk6Ii3RiNGLIiwxMDoiLdGI0YsiLDIwOiIt0YjRiyIsMzA6Ii3RiNGLIiw0MDoiLdGI0YsiLDUwOiIt0YjRliIsNjA6Ii3RiNGLIiw3MDoiLdGI0ZYiLDgwOiIt0YjRliIsOTA6Ii3RiNGLIiwxMDA6Ii3RiNGWIn0saT10LmRlZmluZUxvY2FsZSgia2siLHttb250aHM6ItKa0LDSo9GC0LDRgF/QkNKb0L/QsNC9X9Cd0LDRg9GA0YvQt1/QodOZ0YPRltGAX9Cc0LDQvNGL0YBf0JzQsNGD0YHRi9C8X9Co0ZbQu9C00LVf0KLQsNC80YvQt1/SmtGL0YDQutKv0LnQtdC6X9Ka0LDQt9Cw0L1f0prQsNGA0LDRiNCwX9CW0LXQu9GC0L7Sm9GB0LDQvSIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoi0prQsNKjX9CQ0pvQv1/QndCw0YNf0KHTmdGDX9Cc0LDQvF/QnNCw0YNf0KjRltC7X9Ci0LDQvF/SmtGL0YBf0prQsNC3X9Ka0LDRgF/QltC10LsiLnNwbGl0KCJfIiksd2Vla2RheXM6ItCW0LXQutGB0LXQvdCx0ZZf0JTSr9C50YHQtdC90LHRll/QodC10LnRgdC10L3QsdGWX9Ch05nRgNGB0LXQvdCx0ZZf0JHQtdC50YHQtdC90LHRll/QltKx0LzQsF/QodC10L3QsdGWIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6ItCW0LXQul/QlNKv0Llf0KHQtdC5X9Ch05nRgF/QkdC10Llf0JbSsdC8X9Ch0LXQvSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi0JbQul/QlNC5X9Ch0Llf0KHRgF/QkdC5X9CW0Lxf0KHQvSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvQkdKv0LPRltC9INGB0LDSk9Cw0YJdIExUIixuZXh0RGF5OiJb0JXRgNGC0LXSoyDRgdCw0pPQsNGCXSBMVCIsbmV4dFdlZWs6ImRkZGQgW9GB0LDSk9Cw0YJdIExUIixsYXN0RGF5OiJb0JrQtdGI0LUg0YHQsNKT0LDRgl0gTFQiLGxhc3RXZWVrOiJb06jRgtC60LXQvSDQsNC/0YLQsNC90YvSo10gZGRkZCBb0YHQsNKT0LDRgl0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVzINGW0YjRltC90LTQtSIscGFzdDoiJXMg0LHSsdGA0YvQvSIsczoi0LHRltGA0L3QtdGI0LUg0YHQtdC60YPQvdC0IixtOiLQsdGW0YAg0LzQuNC90YPRgiIsbW06IiVkINC80LjQvdGD0YIiLGg6ItCx0ZbRgCDRgdCw0pPQsNGCIixoaDoiJWQg0YHQsNKT0LDRgiIsZDoi0LHRltGAINC60q/QvSIsZGQ6IiVkINC60q/QvSIsTToi0LHRltGAINCw0LkiLE1NOiIlZCDQsNC5Iix5OiLQsdGW0YAg0LbRi9C7Iix5eToiJWQg0LbRi9C7In0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LSjRiNGWfNGI0YspLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3ZhciBpPXQlMTAsbj10Pj0xMDA/MTAwOm51bGw7cmV0dXJuIHQrKGVbdF18fGVbaV18fGVbbl0pfSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJrbSIse21vbnRoczoi4Z6Y4Z6A4Z6a4Z62X+GegOGeu+GemOGfkuGel+GfiF/hnpjhnrfhnpPhnrZf4Z6Y4Z+B4Z6f4Z62X+Gep+Gen+Gel+Getl/hnpjhnrfhnpDhnrvhnpPhnrZf4Z6A4Z6A4Z+S4Z6A4Z6K4Z62X+Gen+GeuOGeoOGetl/hnoDhnonhn5LhnonhnrZf4Z6P4Z674Z6b4Z62X+GenOGet+GeheGfkuGehuGet+GegOGetl/hnpLhn5LhnpPhnrwiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IuGemOGegOGemuGetl/hnoDhnrvhnpjhn5Lhnpfhn4hf4Z6Y4Z634Z6T4Z62X+GemOGfgeGen+Getl/hnqfhnp/hnpfhnrZf4Z6Y4Z634Z6Q4Z674Z6T4Z62X+GegOGegOGfkuGegOGeiuGetl/hnp/hnrjhnqDhnrZf4Z6A4Z6J4Z+S4Z6J4Z62X+Gej+Geu+Gem+Getl/hnpzhnrfhnoXhn5LhnobhnrfhnoDhnrZf4Z6S4Z+S4Z6T4Z68Ii5zcGxpdCgiXyIpLHdlZWtkYXlzOiLhnqLhnrbhnpHhnrfhno/hn5Lhnplf4Z6F4Z+Q4Z6T4Z+S4Z6RX+GeouGehOGfkuGeguGetuGeml/hnpbhnrvhnpJf4Z6W4Z+S4Z6a4Z6g4Z6f4Z+S4Z6U4Z6P4Z634Z+NX+Gen+Geu+GegOGfkuGeml/hnp/hn4Xhnprhn40iLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi4Z6i4Z624Z6R4Z634Z6P4Z+S4Z6ZX+GeheGfkOGek+GfkuGekV/hnqLhnoThn5LhnoLhnrbhnppf4Z6W4Z674Z6SX+GeluGfkuGemuGeoOGen+GfkuGelOGej+Get+GfjV/hnp/hnrvhnoDhn5Lhnppf4Z6f4Z+F4Z6a4Z+NIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLhnqLhnrbhnpHhnrfhno/hn5Lhnplf4Z6F4Z+Q4Z6T4Z+S4Z6RX+GeouGehOGfkuGeguGetuGeml/hnpbhnrvhnpJf4Z6W4Z+S4Z6a4Z6g4Z6f4Z+S4Z6U4Z6P4Z634Z+NX+Gen+Geu+GegOGfkuGeml/hnp/hn4Xhnprhn40iLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4Z6Q4Z+S4Z6E4Z+D4Z6T4Z+B4Z+HIOGemOGfieGfhOGehF0gTFQiLG5leHREYXk6Ilvhnp/hn5LhnqLhn4LhnoAg4Z6Y4Z+J4Z+E4Z6EXSBMVCIsbmV4dFdlZWs6ImRkZGQgW+GemOGfieGfhOGehF0gTFQiLGxhc3REYXk6Ilvhnpjhn5Lhnp/hnrfhnpvhnpjhnrfhnokg4Z6Y4Z+J4Z+E4Z6EXSBMVCIsbGFzdFdlZWs6ImRkZGQgW+Gen+GelOGfkuGej+GetuGeoOGfjeGemOGeu+Gek10gW+GemOGfieGfhOGehF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVz4Z6R4Z+A4Z6PIixwYXN0OiIlc+GemOGeu+GekyIsczoi4Z6U4Z+J4Z674Z6T4Z+S4Z6Y4Z624Z6T4Z6c4Z634Z6T4Z624Z6R4Z64IixtOiLhnpjhnr3hnpnhnpPhnrbhnpHhnrgiLG1tOiIlZCDhnpPhnrbhnpHhnrgiLGg6IuGemOGeveGemeGemOGfieGfhOGehCIsaGg6IiVkIOGemOGfieGfhOGehCIsZDoi4Z6Y4Z694Z6Z4Z6Q4Z+S4Z6E4Z+DIixkZDoiJWQg4Z6Q4Z+S4Z6E4Z+DIixNOiLhnpjhnr3hnpnhnoHhn4IiLE1NOiIlZCDhnoHhn4IiLHk6IuGemOGeveGemeGehuGfkuGek+GetuGfhiIseXk6IiVkIOGehuGfkuGek+GetuGfhiJ9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoImtvIix7bW9udGhzOiIx7JuUXzLsm5RfM+yblF807JuUXzXsm5RfNuyblF837JuUXzjsm5RfOeyblF8xMOyblF8xMeyblF8xMuyblCIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiMeyblF8y7JuUXzPsm5RfNOyblF817JuUXzbsm5RfN+yblF847JuUXznsm5RfMTDsm5RfMTHsm5RfMTLsm5QiLnNwbGl0KCJfIiksd2Vla2RheXM6IuydvOyalOydvF/sm5TsmpTsnbxf7ZmU7JqU7J28X+yImOyalOydvF/rqqnsmpTsnbxf6riI7JqU7J28X+2GoOyalOydvCIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLsnbxf7JuUX+2ZlF/siJhf66qpX+q4iF/thqAiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IuydvF/sm5Rf7ZmUX+yImF/rqqlf6riIX+2GoCIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkEgaOyLnCBt67aEIixMVFM6IkEgaOyLnCBt67aEIHPstIgiLEw6IllZWVkuTU0uREQiLExMOiJZWVlZ64WEIE1NTU0gROydvCIsTExMOiJZWVlZ64WEIE1NTU0gROydvCBBIGjsi5wgbeu2hCIsTExMTDoiWVlZWeuFhCBNTU1NIETsnbwgZGRkZCBBIGjsi5wgbeu2hCJ9LGNhbGVuZGFyOntzYW1lRGF5OiLsmKTripggTFQiLG5leHREYXk6IuuCtOydvCBMVCIsbmV4dFdlZWs6ImRkZGQgTFQiLGxhc3REYXk6IuyWtOygnCBMVCIsbGFzdFdlZWs6IuyngOuCnOyjvCBkZGRkIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlcyDtm4QiLHBhc3Q6IiVzIOyghCIsczoi66qH7LSIIixzczoiJWTstIgiLG06IuydvOu2hCIsbW06IiVk67aEIixoOiLtlZzsi5zqsIQiLGhoOiIlZOyLnOqwhCIsZDoi7ZWY66OoIixkZDoiJWTsnbwiLE06Iu2VnOuLrCIsTU06IiVk64usIix5OiLsnbzrhYQiLHl5OiIlZOuFhCJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfeydvC8sb3JkaW5hbDoiJWTsnbwiLG1lcmlkaWVtUGFyc2U6L+yYpOyghHzsmKTtm4QvLGlzUE06ZnVuY3Rpb24odCl7cmV0dXJuIuyYpO2bhCI9PT10fSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/IuyYpOyghCI6IuyYpO2bhCJ9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQsZSxpLG4pe3ZhciByPXttOlsiZW5nIE1pbnV0dCIsImVuZ2VyIE1pbnV0dCJdLGg6WyJlbmcgU3Rvbm4iLCJlbmdlciBTdG9ubiJdLGQ6WyJlZW4gRGFnIiwiZW5nZW0gRGFnIl0sTTpbImVlIE1vdW50IiwiZW5nZW0gTW91bnQiXSx5OlsiZWUgSm9lciIsImVuZ2VtIEpvZXIiXX07cmV0dXJuIGU/cltpXVswXTpyW2ldWzFdfWZ1bmN0aW9uIGkodCl7dmFyIGU9dC5zdWJzdHIoMCx0LmluZGV4T2YoIiAiKSk7cmV0dXJuIHIoZSk/ImEgIit0OiJhbiAiK3R9ZnVuY3Rpb24gbih0KXt2YXIgZT10LnN1YnN0cigwLHQuaW5kZXhPZigiICIpKTtyZXR1cm4gcihlKT8idmlydSAiK3Q6InZpcnVuICIrdH1mdW5jdGlvbiByKHQpe2lmKHQ9cGFyc2VJbnQodCwxMCksaXNOYU4odCkpcmV0dXJuITE7aWYodDwwKXJldHVybiEwO2lmKHQ8MTApcmV0dXJuIDQ8PXQmJnQ8PTc7aWYodDwxMDApe3ZhciBlPXQlMTAsaT10LzEwO3JldHVybiByKDA9PT1lP2k6ZSl9aWYodDwxZTQpe2Zvcig7dD49MTA7KXQvPTEwO3JldHVybiByKHQpfXJldHVybiB0Lz0xZTMscih0KX12YXIgcz10LmRlZmluZUxvY2FsZSgibGIiLHttb250aHM6IkphbnVhcl9GZWJydWFyX03DpGVyel9BYnLDq2xsX01lZV9KdW5pX0p1bGlfQXVndXN0X1NlcHRlbWJlcl9Pa3RvYmVyX05vdmVtYmVyX0RlemVtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJKYW4uX0ZlYnIuX01yei5fQWJyLl9NZWVfSnVuLl9KdWwuX0F1Zy5fU2VwdC5fT2t0Ll9Ob3YuX0Rlei4iLnNwbGl0KCJfIiksd2Vla2RheXM6IlNvbm5kZWdfTcOpaW5kZWdfRMOrbnNjaGRlZ19Nw6t0dHdvY2hfRG9ubmVzY2hkZWdfRnJlaWRlZ19TYW1zY2hkZWciLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiU28uX03DqS5fRMOrLl9Nw6suX0RvLl9Gci5fU2EuIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJTb19Nw6lfRMOrX03Dq19Eb19Gcl9TYSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6Ikg6bW0gW0F1ZXJdIixMVFM6Ikg6bW06c3MgW0F1ZXJdIixMOiJERC5NTS5ZWVlZIixMTDoiRC4gTU1NTSBZWVlZIixMTEw6IkQuIE1NTU0gWVlZWSBIOm1tIFtBdWVyXSIsTExMTDoiZGRkZCwgRC4gTU1NTSBZWVlZIEg6bW0gW0F1ZXJdIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltIYXV0IHVtXSBMVCIsc2FtZUVsc2U6IkwiLG5leHREYXk6IltNdWVyIHVtXSBMVCIsbmV4dFdlZWs6ImRkZGQgW3VtXSBMVCIsbGFzdERheToiW0fDq3NjaHRlciB1bV0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMjpjYXNlIDQ6cmV0dXJuIltMZXNjaHRlbl0gZGRkZCBbdW1dIExUIjtkZWZhdWx0OnJldHVybiJbTGVzY2h0ZV0gZGRkZCBbdW1dIExUIn19fSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZTppLHBhc3Q6bixzOiJlIHB1ZXIgU2Vrb25uZW4iLG06ZSxtbToiJWQgTWludXR0ZW4iLGg6ZSxoaDoiJWQgU3Rvbm5lbiIsZDplLGRkOiIlZCBEZWVnIixNOmUsTU06IiVkIE3DqWludCIseTplLHl5OiIlZCBKb2VyIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIHN9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgibG8iLHttb250aHM6IuC6oeC6seC6h+C6geC6reC6mV/guoHgurjguqHgup7gurJf4Lqh4Lq14LqZ4LqyX+C7gOC6oeC6quC6sl/gup7gurbgupTguqrgurDgup7gurJf4Lqh4Lq04LqW4Lq44LqZ4LqyX+C6geC7jeC6peC6sOC6geC6u+C6lF/guqrgurTguofguqvgurJf4LqB4Lqx4LqZ4LqN4LqyX+C6leC6uOC6peC6sl/gup7gurDguojgurTguoFf4LqX4Lqx4LqZ4Lqn4LqyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLguqHgurHguofguoHguq3guplf4LqB4Lq44Lqh4Lqe4LqyX+C6oeC6teC6meC6sl/gu4DguqHguqrgurJf4Lqe4Lq24LqU4Lqq4Lqw4Lqe4LqyX+C6oeC6tOC6luC6uOC6meC6sl/guoHgu43guqXgurDguoHgurvgupRf4Lqq4Lq04LqH4Lqr4LqyX+C6geC6seC6meC6jeC6sl/gupXgurjguqXgurJf4Lqe4Lqw4LqI4Lq04LqBX+C6l+C6seC6meC6p+C6siIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi4Lqt4Lqy4LqX4Lq04LqUX+C6iOC6seC6mV/guq3gurHguofguoTgurLguplf4Lqe4Lq44LqUX+C6nuC6sOC6q+C6seC6lF/guqrgurjguoFf4LuA4Lqq4Lq74LqyIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IuC6l+C6tOC6lF/guojgurHguplf4Lqt4Lqx4LqH4LqE4Lqy4LqZX+C6nuC6uOC6lF/gup7gurDguqvgurHgupRf4Lqq4Lq44LqBX+C7gOC6quC6u+C6siIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4LqXX+C6iF/guq3guoRf4LqeX+C6nuC6q1/guqrguoFf4LqqIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoi4Lqn4Lqx4LqZZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LG1lcmlkaWVtUGFyc2U6L+C6leC6reC6meC7gOC6iuC6u+C7ieC6snzgupXguq3gupngu4HguqXguocvLGlzUE06ZnVuY3Rpb24odCl7cmV0dXJuIuC6leC6reC6meC7geC6peC6hyI9PT10fSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/IuC6leC6reC6meC7gOC6iuC6u+C7ieC6siI6IuC6leC6reC6meC7geC6peC6hyJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4Lqh4Lq34LuJ4LqZ4Lq14LuJ4LuA4Lqn4Lql4LqyXSBMVCIsbmV4dERheToiW+C6oeC6t+C7ieC6reC6t+C7iOC6meC7gOC6p+C6peC6sl0gTFQiLG5leHRXZWVrOiJb4Lqn4Lqx4LqZXWRkZGRb4Luc4LuJ4Lqy4LuA4Lqn4Lql4LqyXSBMVCIsbGFzdERheToiW+C6oeC6t+C7ieC6p+C6suC6meC6meC6teC7ieC7gOC6p+C6peC6sl0gTFQiLGxhc3RXZWVrOiJb4Lqn4Lqx4LqZXWRkZGRb4LuB4Lql4LuJ4Lqn4LqZ4Lq14LuJ4LuA4Lqn4Lql4LqyXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi4Lqt4Lq14LqBICVzIixwYXN0OiIlc+C6nOC7iOC6suC6meC6oeC6siIsczoi4Lqa4LuN4LuI4LuA4LqX4Lq74LuI4Lqy4LuD4LqU4Lqn4Lq04LqZ4Lqy4LqX4Lq1IixtOiIxIOC6meC6suC6l+C6tSIsbW06IiVkIOC6meC6suC6l+C6tSIsaDoiMSDguorgurvgu4jguqfgu4LguqHguociLGhoOiIlZCDguorgurvgu4jguqfgu4LguqHguociLGQ6IjEg4Lqh4Lq34LuJIixkZDoiJWQg4Lqh4Lq34LuJIixNOiIxIOC7gOC6lOC6t+C6reC6mSIsTU06IiVkIOC7gOC6lOC6t+C6reC6mSIseToiMSDgupvgurUiLHl5OiIlZCDgupvgurUifSxvcmRpbmFsUGFyc2U6LyjgupfgurXgu4gpXGR7MSwyfS8sb3JkaW5hbDpmdW5jdGlvbih0KXtyZXR1cm4i4LqX4Lq14LuIIit0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZSh0LGUsaSxuKXtyZXR1cm4gZT8ia2VsaW9zIHNla3VuZMSXcyI6bj8ia2VsacWzIHNla3VuZMW+acWzIjoia2VsaWFzIHNla3VuZGVzIn1mdW5jdGlvbiBpKHQsZSxpLG4pe3JldHVybiBlP3IoaSlbMF06bj9yKGkpWzFdOnIoaSlbMl19ZnVuY3Rpb24gbih0KXtyZXR1cm4gdCUxMD09PTB8fHQ+MTAmJnQ8MjB9ZnVuY3Rpb24gcih0KXtyZXR1cm4gb1t0XS5zcGxpdCgiXyIpfWZ1bmN0aW9uIHModCxlLHMsbyl7dmFyIGE9dCsiICI7cmV0dXJuIDE9PT10P2EraSh0LGUsc1swXSxvKTplP2ErKG4odCk/cihzKVsxXTpyKHMpWzBdKTpvP2ErcihzKVsxXTphKyhuKHQpP3IocylbMV06cihzKVsyXSl9dmFyIG89e206Im1pbnV0xJdfbWludXTEl3NfbWludXTEmSIsbW06Im1pbnV0xJdzX21pbnXEjWnFs19taW51dGVzIixoOiJ2YWxhbmRhX3ZhbGFuZG9zX3ZhbGFuZMSFIixoaDoidmFsYW5kb3NfdmFsYW5kxbNfdmFsYW5kYXMiLGQ6ImRpZW5hX2RpZW5vc19kaWVuxIUiLGRkOiJkaWVub3NfZGllbsWzX2RpZW5hcyIsTToibcSXbnVvX23El25lc2lvX23El25lc8SvIixNTToibcSXbmVzaWFpX23El25lc2nFs19txJduZXNpdXMiLHk6Im1ldGFpX21ldMWzX21ldHVzIix5eToibWV0YWlfbWV0xbNfbWV0dXMifSxhPXQuZGVmaW5lTG9jYWxlKCJsdCIse21vbnRoczp7Zm9ybWF0OiJzYXVzaW9fdmFzYXJpb19rb3ZvX2JhbGFuZMW+aW9fZ2VndcW+xJdzX2JpcsW+ZWxpb19saWVwb3NfcnVncGrFq8SNaW9fcnVnc8SXam9fc3BhbGlvX2xhcGtyacSNaW9fZ3J1b2TFvmlvIi5zcGxpdCgiXyIpLHN0YW5kYWxvbmU6InNhdXNpc192YXNhcmlzX2tvdmFzX2JhbGFuZGlzX2dlZ3XFvsSXX2JpcsW+ZWxpc19saWVwYV9ydWdwasWrdGlzX3J1Z3PEl2ppc19zcGFsaXNfbGFwa3JpdGlzX2dydW9kaXMiLnNwbGl0KCJfIil9LG1vbnRoc1Nob3J0OiJzYXVfdmFzX2tvdl9iYWxfZ2VnX2Jpcl9saWVfcmdwX3Jnc19zcGFfbGFwX2dyZCIuc3BsaXQoIl8iKSx3ZWVrZGF5czp7Zm9ybWF0OiJzZWttYWRpZW7Er19waXJtYWRpZW7Er19hbnRyYWRpZW7Er190cmXEjWlhZGllbsSvX2tldHZpcnRhZGllbsSvX3Blbmt0YWRpZW7Er1/FoWXFoXRhZGllbsSvIi5zcGxpdCgiXyIpLHN0YW5kYWxvbmU6InNla21hZGllbmlzX3Bpcm1hZGllbmlzX2FudHJhZGllbmlzX3RyZcSNaWFkaWVuaXNfa2V0dmlydGFkaWVuaXNfcGVua3RhZGllbmlzX8WhZcWhdGFkaWVuaXMiLnNwbGl0KCJfIiksaXNGb3JtYXQ6L2RkZGQgSEg6bW0vfSx3ZWVrZGF5c1Nob3J0OiJTZWtfUGlyX0FudF9UcmVfS2V0X1Blbl/FoGXFoSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiU19QX0FfVF9LX1BuX8WgIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IllZWVktTU0tREQiLExMOiJZWVlZIFttLl0gTU1NTSBEIFtkLl0iLExMTDoiWVlZWSBbbS5dIE1NTU0gRCBbZC5dLCBISDptbSBbdmFsLl0iLExMTEw6IllZWVkgW20uXSBNTU1NIEQgW2QuXSwgZGRkZCwgSEg6bW0gW3ZhbC5dIixsOiJZWVlZLU1NLUREIixsbDoiWVlZWSBbbS5dIE1NTU0gRCBbZC5dIixsbGw6IllZWVkgW20uXSBNTU1NIEQgW2QuXSwgSEg6bW0gW3ZhbC5dIixsbGxsOiJZWVlZIFttLl0gTU1NTSBEIFtkLl0sIGRkZCwgSEg6bW0gW3ZhbC5dIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvFoGlhbmRpZW5dIExUIixuZXh0RGF5OiJbUnl0b2pdIExUIixuZXh0V2VlazoiZGRkZCBMVCIsbGFzdERheToiW1Zha2FyXSBMVCIsbGFzdFdlZWs6IltQcmHEl2p1c8SvXSBkZGRkIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJwbyAlcyIscGFzdDoicHJpZcWhICVzIixzOmUsbTppLG1tOnMsaDppLGhoOnMsZDppLGRkOnMsTTppLE1NOnMseTppLHl5OnN9LG9yZGluYWxQYXJzZTovXGR7MSwyfS1vamkvLG9yZGluYWw6ZnVuY3Rpb24odCl7cmV0dXJuIHQrIi1vamkifSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gYX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCxlLGkpe3JldHVybiBpP2UlMTA9PT0xJiYxMSE9PWU/dFsyXTp0WzNdOmUlMTA9PT0xJiYxMSE9PWU/dFswXTp0WzFdfWZ1bmN0aW9uIGkodCxpLG4pe3JldHVybiB0KyIgIitlKHNbbl0sdCxpKX1mdW5jdGlvbiBuKHQsaSxuKXtyZXR1cm4gZShzW25dLHQsaSl9ZnVuY3Rpb24gcih0LGUpe3JldHVybiBlPyJkYcW+YXMgc2VrdW5kZXMiOiJkYcW+xIFtIHNla3VuZMSTbSJ9dmFyIHM9e206Im1pbsWrdGVzX21pbsWrdMSTbV9taW7Fq3RlX21pbsWrdGVzIi5zcGxpdCgiXyIpLG1tOiJtaW7Fq3Rlc19taW7Fq3TEk21fbWluxat0ZV9taW7Fq3RlcyIuc3BsaXQoIl8iKSxoOiJzdHVuZGFzX3N0dW5kxIFtX3N0dW5kYV9zdHVuZGFzIi5zcGxpdCgiXyIpLGhoOiJzdHVuZGFzX3N0dW5kxIFtX3N0dW5kYV9zdHVuZGFzIi5zcGxpdCgiXyIpLGQ6ImRpZW5hc19kaWVuxIFtX2RpZW5hX2RpZW5hcyIuc3BsaXQoIl8iKSxkZDoiZGllbmFzX2RpZW7EgW1fZGllbmFfZGllbmFzIi5zcGxpdCgiXyIpLE06Im3Ek25lxaFhX23Ek25lxaFpZW1fbcSTbmVzaXNfbcSTbmXFoWkiLnNwbGl0KCJfIiksTU06Im3Ek25lxaFhX23Ek25lxaFpZW1fbcSTbmVzaXNfbcSTbmXFoWkiLnNwbGl0KCJfIikseToiZ2FkYV9nYWRpZW1fZ2Fkc19nYWRpIi5zcGxpdCgiXyIpLHl5OiJnYWRhX2dhZGllbV9nYWRzX2dhZGkiLnNwbGl0KCJfIil9LG89dC5kZWZpbmVMb2NhbGUoImx2Iix7bW9udGhzOiJqYW52xIFyaXNfZmVicnXEgXJpc19tYXJ0c19hcHLEq2xpc19tYWlqc19qxatuaWpzX2rFq2xpanNfYXVndXN0c19zZXB0ZW1icmlzX29rdG9icmlzX25vdmVtYnJpc19kZWNlbWJyaXMiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Imphbl9mZWJfbWFyX2Fwcl9tYWlfasWrbl9qxatsX2F1Z19zZXBfb2t0X25vdl9kZWMiLnNwbGl0KCJfIiksd2Vla2RheXM6InN2xJN0ZGllbmFfcGlybWRpZW5hX290cmRpZW5hX3RyZcWhZGllbmFfY2V0dXJ0ZGllbmFfcGlla3RkaWVuYV9zZXN0ZGllbmEiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiU3ZfUF9PX1RfQ19Qa19TIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJTdl9QX09fVF9DX1BrX1MiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQuTU0uWVlZWS4iLExMOiJZWVlZLiBbZ2FkYV0gRC4gTU1NTSIsTExMOiJZWVlZLiBbZ2FkYV0gRC4gTU1NTSwgSEg6bW0iLExMTEw6IllZWVkuIFtnYWRhXSBELiBNTU1NLCBkZGRkLCBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbxaBvZGllbiBwdWxrc3Rlbl0gTFQiLG5leHREYXk6IltSxKt0IHB1bGtzdGVuXSBMVCIsbmV4dFdlZWs6ImRkZGQgW3B1bGtzdGVuXSBMVCIsbGFzdERheToiW1Zha2FyIHB1bGtzdGVuXSBMVCIsbGFzdFdlZWs6IltQYWfEgWp1xaHEgV0gZGRkZCBbcHVsa3N0ZW5dIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJwxJNjICVzIixwYXN0OiJwaXJtcyAlcyIsczpyLG06bixtbTppLGg6bixoaDppLGQ6bixkZDppLE06bixNTTppLHk6bix5eTppfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gb30pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXt3b3Jkczp7bTpbImplZGFuIG1pbnV0IiwiamVkbm9nIG1pbnV0YSJdLG1tOlsibWludXQiLCJtaW51dGEiLCJtaW51dGEiXSxoOlsiamVkYW4gc2F0IiwiamVkbm9nIHNhdGEiXSxoaDpbInNhdCIsInNhdGEiLCJzYXRpIl0sZGQ6WyJkYW4iLCJkYW5hIiwiZGFuYSJdLE1NOlsibWplc2VjIiwibWplc2VjYSIsIm1qZXNlY2kiXSx5eTpbImdvZGluYSIsImdvZGluZSIsImdvZGluYSJdfSxjb3JyZWN0R3JhbW1hdGljYWxDYXNlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIDE9PT10P2VbMF06dD49MiYmdDw9ND9lWzFdOmVbMl19LHRyYW5zbGF0ZTpmdW5jdGlvbih0LGksbil7dmFyIHI9ZS53b3Jkc1tuXTtyZXR1cm4gMT09PW4ubGVuZ3RoP2k/clswXTpyWzFdOnQrIiAiK2UuY29ycmVjdEdyYW1tYXRpY2FsQ2FzZSh0LHIpfX0saT10LmRlZmluZUxvY2FsZSgibWUiLHttb250aHM6WyJqYW51YXIiLCJmZWJydWFyIiwibWFydCIsImFwcmlsIiwibWFqIiwianVuIiwianVsIiwiYXZndXN0Iiwic2VwdGVtYmFyIiwib2t0b2JhciIsIm5vdmVtYmFyIiwiZGVjZW1iYXIiXSxtb250aHNTaG9ydDpbImphbi4iLCJmZWIuIiwibWFyLiIsImFwci4iLCJtYWoiLCJqdW4iLCJqdWwiLCJhdmcuIiwic2VwLiIsIm9rdC4iLCJub3YuIiwiZGVjLiJdLHdlZWtkYXlzOlsibmVkamVsamEiLCJwb25lZGplbGphayIsInV0b3JhayIsInNyaWplZGEiLCLEjWV0dnJ0YWsiLCJwZXRhayIsInN1Ym90YSJdLHdlZWtkYXlzU2hvcnQ6WyJuZWQuIiwicG9uLiIsInV0by4iLCJzcmkuIiwixI1ldC4iLCJwZXQuIiwic3ViLiJdLHdlZWtkYXlzTWluOlsibmUiLCJwbyIsInV0Iiwic3IiLCLEjWUiLCJwZSIsInN1Il0sbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IkRELiBNTS4gWVlZWSIsTEw6IkQuIE1NTU0gWVlZWSIsTExMOiJELiBNTU1NIFlZWVkgSDptbSIsTExMTDoiZGRkZCwgRC4gTU1NTSBZWVlZIEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW2RhbmFzIHVdIExUIixuZXh0RGF5OiJbc2p1dHJhIHVdIExUIixuZXh0V2VlazpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6cmV0dXJuIlt1XSBbbmVkamVsanVdIFt1XSBMVCI7Y2FzZSAzOnJldHVybiJbdV0gW3NyaWplZHVdIFt1XSBMVCI7Y2FzZSA2OnJldHVybiJbdV0gW3N1Ym90dV0gW3VdIExUIjtjYXNlIDE6Y2FzZSAyOmNhc2UgNDpjYXNlIDU6cmV0dXJuIlt1XSBkZGRkIFt1XSBMVCJ9fSxsYXN0RGF5OiJbanXEjWUgdV0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7dmFyIHQ9WyJbcHJvxaFsZV0gW25lZGplbGplXSBbdV0gTFQiLCJbcHJvxaFsb2ddIFtwb25lZGplbGprYV0gW3VdIExUIiwiW3Byb8WhbG9nXSBbdXRvcmthXSBbdV0gTFQiLCJbcHJvxaFsZV0gW3NyaWplZGVdIFt1XSBMVCIsIltwcm/FoWxvZ10gW8SNZXR2cnRrYV0gW3VdIExUIiwiW3Byb8WhbG9nXSBbcGV0a2FdIFt1XSBMVCIsIltwcm/FoWxlXSBbc3Vib3RlXSBbdV0gTFQiXTtyZXR1cm4gdFt0aGlzLmRheSgpXX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiemEgJXMiLHBhc3Q6InByaWplICVzIixzOiJuZWtvbGlrbyBzZWt1bmRpIixtOmUudHJhbnNsYXRlLG1tOmUudHJhbnNsYXRlLGg6ZS50cmFuc2xhdGUsaGg6ZS50cmFuc2xhdGUsZDoiZGFuIixkZDplLnRyYW5zbGF0ZSxNOiJtamVzZWMiLE1NOmUudHJhbnNsYXRlLHk6ImdvZGludSIseXk6ZS50cmFuc2xhdGV9LG9yZGluYWxQYXJzZTovXGR7MSwyfVwuLyxvcmRpbmFsOiIlZC4iLHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBpfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoIm1rIix7bW9udGhzOiLRmNCw0L3Rg9Cw0YDQuF/RhNC10LLRgNGD0LDRgNC4X9C80LDRgNGCX9Cw0L/RgNC40Ltf0LzQsNGYX9GY0YPQvdC4X9GY0YPQu9C4X9Cw0LLQs9GD0YHRgl/RgdC10L/RgtC10LzQstGA0Lhf0L7QutGC0L7QvNCy0YDQuF/QvdC+0LXQvNCy0YDQuF/QtNC10LrQtdC80LLRgNC4Ii5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLRmNCw0L1f0YTQtdCyX9C80LDRgF/QsNC/0YBf0LzQsNGYX9GY0YPQvV/RmNGD0Ltf0LDQstCzX9GB0LXQv1/QvtC60YJf0L3QvtC1X9C00LXQuiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi0L3QtdC00LXQu9CwX9C/0L7QvdC10LTQtdC70L3QuNC6X9Cy0YLQvtGA0L3QuNC6X9GB0YDQtdC00LBf0YfQtdGC0LLRgNGC0L7Qul/Qv9C10YLQvtC6X9GB0LDQsdC+0YLQsCIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLQvdC10LRf0L/QvtC9X9Cy0YLQvl/RgdGA0LVf0YfQtdGCX9C/0LXRgl/RgdCw0LEiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46ItC9ZV/Qv29f0LLRgl/RgdGAX9GH0LVf0L/QtV/RgWEiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IkQuTU0uWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW9CU0LXQvdC10YEg0LLQvl0gTFQiLG5leHREYXk6IlvQo9GC0YDQtSDQstC+XSBMVCIsbmV4dFdlZWs6IlvQktC+XSBkZGRkIFvQstC+XSBMVCIsbGFzdERheToiW9CS0YfQtdGA0LAg0LLQvl0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpjYXNlIDM6Y2FzZSA2OnJldHVybiJb0JjQt9C80LjQvdCw0YLQsNGC0LBdIGRkZGQgW9Cy0L5dIExUIjtjYXNlIDE6Y2FzZSAyOmNhc2UgNDpjYXNlIDU6cmV0dXJuIlvQmNC30LzQuNC90LDRgtC40L7Rgl0gZGRkZCBb0LLQvl0gTFQifX0sc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi0L/QvtGB0LvQtSAlcyIscGFzdDoi0L/RgNC10LQgJXMiLHM6ItC90LXQutC+0LvQutGDINGB0LXQutGD0L3QtNC4IixtOiLQvNC40L3Rg9GC0LAiLG1tOiIlZCDQvNC40L3Rg9GC0LgiLGg6ItGH0LDRgSIsaGg6IiVkINGH0LDRgdCwIixkOiLQtNC10L0iLGRkOiIlZCDQtNC10L3QsCIsTToi0LzQtdGB0LXRhiIsTU06IiVkINC80LXRgdC10YbQuCIseToi0LPQvtC00LjQvdCwIix5eToiJWQg0LPQvtC00LjQvdC4In0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LSjQtdCyfNC10L180YLQuHzQstC4fNGA0Lh80LzQuCkvLG9yZGluYWw6ZnVuY3Rpb24odCl7dmFyIGU9dCUxMCxpPXQlMTAwO3JldHVybiAwPT09dD90KyIt0LXQsiI6MD09PWk/dCsiLdC10L0iOmk+MTAmJmk8MjA/dCsiLdGC0LgiOjE9PT1lP3QrIi3QstC4IjoyPT09ZT90KyIt0YDQuCI6Nz09PWV8fDg9PT1lP3QrIi3QvNC4Ijp0KyIt0YLQuCJ9LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoIm1sIix7bW9udGhzOiLgtJzgtKjgtYHgtLXgtLDgtL9f4LSr4LWG4LSs4LWN4LSw4LWB4LS14LSw4LS/X+C0ruC0vuC1vOC0muC1jeC0muC1jV/gtI/gtKrgtY3gtLDgtL/gtb1f4LSu4LWH4LSv4LWNX+C0nOC1guC1ul/gtJzgtYLgtLLgtYhf4LST4LSX4LS44LWN4LSx4LWN4LSx4LWNX+C0uOC1huC0quC1jeC0seC1jeC0seC0guC0rOC1vF/gtJLgtJXgtY3gtJ/gtYvgtKzgtbxf4LSo4LS14LSC4LSs4LW8X+C0oeC0v+C0uOC0guC0rOC1vCIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoi4LSc4LSo4LWBLl/gtKvgtYbgtKzgtY3gtLDgtYEuX+C0ruC0vuC1vC5f4LSP4LSq4LWN4LSw4LS/Ll/gtK7gtYfgtK/gtY1f4LSc4LWC4LW6X+C0nOC1guC0suC1iC5f4LST4LSXLl/gtLjgtYbgtKrgtY3gtLHgtY3gtLEuX+C0kuC0leC1jeC0n+C1iy5f4LSo4LS14LSCLl/gtKHgtL/gtLjgtIIuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLgtJ7gtL7gtK/gtLHgtL7gtLTgtY3gtJpf4LSk4LS/4LSZ4LWN4LSV4LSz4LS+4LS04LWN4LSaX+C0muC1iuC0teC1jeC0teC0vuC0tOC1jeC0ml/gtKzgtYHgtKfgtKjgtL7gtLTgtY3gtJpf4LS14LWN4LSv4LS+4LS04LS+4LS04LWN4LSaX+C0teC1huC0s+C1jeC0s+C0v+C0r+C0vuC0tOC1jeC0ml/gtLbgtKjgtL/gtK/gtL7gtLTgtY3gtJoiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi4LSe4LS+4LSv4LW8X+C0pOC0v+C0meC1jeC0leC1vl/gtJrgtYrgtLXgtY3gtLVf4LSs4LWB4LSn4LW7X+C0teC1jeC0r+C0vuC0tOC0gl/gtLXgtYbgtLPgtY3gtLPgtL9f4LS24LSo4LS/Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLgtJ7gtL5f4LSk4LS/X+C0muC1il/gtKzgtYFf4LS14LWN4LSv4LS+X+C0teC1hl/gtLYiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJBIGg6bW0gLeC0qOC1gSIsTFRTOiJBIGg6bW06c3MgLeC0qOC1gSIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZLCBBIGg6bW0gLeC0qOC1gSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVksIEEgaDptbSAt4LSo4LWBIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvgtIfgtKjgtY3gtKjgtY1dIExUIixuZXh0RGF5OiJb4LSo4LS+4LSz4LWGXSBMVCIsbmV4dFdlZWs6ImRkZGQsIExUIixsYXN0RGF5OiJb4LSH4LSo4LWN4LSo4LSy4LWGXSBMVCIsbGFzdFdlZWs6IlvgtJXgtLTgtL/gtJ7gtY3gtJ5dIGRkZGQsIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlcyDgtJXgtLTgtL/gtJ7gtY3gtJ7gtY0iLHBhc3Q6IiVzIOC0ruC1geC1u+C0quC1jSIsczoi4LSF4LW94LSqIOC0qOC0v+C0ruC0v+C0t+C0meC1jeC0meC1viIsbToi4LSS4LSw4LWBIOC0ruC0v+C0qOC0v+C0seC1jeC0seC1jSIsbW06IiVkIOC0ruC0v+C0qOC0v+C0seC1jeC0seC1jSIsaDoi4LSS4LSw4LWBIOC0ruC0o+C0v+C0leC1jeC0leC1guC1vCIsaGg6IiVkIOC0ruC0o+C0v+C0leC1jeC0leC1guC1vCIsZDoi4LSS4LSw4LWBIOC0puC0v+C0teC0uOC0giIsZGQ6IiVkIOC0puC0v+C0teC0uOC0giIsTToi4LSS4LSw4LWBIOC0ruC0vuC0uOC0giIsTU06IiVkIOC0ruC0vuC0uOC0giIseToi4LSS4LSw4LWBIOC0teC1vOC0t+C0giIseXk6IiVkIOC0teC1vOC0t+C0giJ9LG1lcmlkaWVtUGFyc2U6L+C0sOC0vuC0pOC1jeC0sOC0v3zgtLDgtL7gtLXgtL/gtLLgtYZ84LSJ4LSa4LWN4LSaIOC0leC0tOC0v+C0nuC1jeC0nuC1jXzgtLXgtYjgtJXgtYHgtKjgtY3gtKjgtYfgtLDgtIJ84LSw4LS+4LSk4LWN4LSw4LS/L2ksbWVyaWRpZW1Ib3VyOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIDEyPT09dCYmKHQ9MCksIuC0sOC0vuC0pOC1jeC0sOC0vyI9PT1lJiZ0Pj00fHwi4LSJ4LSa4LWN4LSaIOC0leC0tOC0v+C0nuC1jeC0nuC1jSI9PT1lfHwi4LS14LWI4LSV4LWB4LSo4LWN4LSo4LWH4LSw4LSCIj09PWU/dCsxMjp0fSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8i4LSw4LS+4LSk4LWN4LSw4LS/Ijp0PDEyPyLgtLDgtL7gtLXgtL/gtLLgtYYiOnQ8MTc/IuC0ieC0muC1jeC0miDgtJXgtLTgtL/gtJ7gtY3gtJ7gtY0iOnQ8MjA/IuC0teC1iOC0leC1geC0qOC1jeC0qOC1h+C0sOC0giI6IuC0sOC0vuC0pOC1jeC0sOC0vyJ9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQsZSxpLG4pe3ZhciByPSIiO2lmKGUpc3dpdGNoKGkpe2Nhc2UicyI6cj0i4KSV4KS+4KS54KWAIOCkuOClh+CkleCkguCkpiI7YnJlYWs7Y2FzZSJtIjpyPSLgpI/gpJUg4KSu4KS/4KSo4KS/4KSfIjticmVhaztjYXNlIm1tIjpyPSIlZCDgpK7gpL/gpKjgpL/gpJ/gpYciO2JyZWFrO2Nhc2UiaCI6cj0i4KSP4KSVIOCkpOCkvuCkuCI7YnJlYWs7Y2FzZSJoaCI6cj0iJWQg4KSk4KS+4KS4IjticmVhaztjYXNlImQiOnI9IuCkj+CklSDgpKbgpL/gpLXgpLgiO2JyZWFrO2Nhc2UiZGQiOnI9IiVkIOCkpuCkv+CkteCkuCI7YnJlYWs7Y2FzZSJNIjpyPSLgpI/gpJUg4KSu4KS54KS/4KSo4KS+IjticmVhaztjYXNlIk1NIjpyPSIlZCDgpK7gpLngpL/gpKjgpYciO2JyZWFrO2Nhc2UieSI6cj0i4KSP4KSVIOCkteCksOCljeCktyI7YnJlYWs7Y2FzZSJ5eSI6cj0iJWQg4KS14KSw4KWN4KS34KWHIn1lbHNlIHN3aXRjaChpKXtjYXNlInMiOnI9IuCkleCkvuCkueClgCDgpLjgpYfgpJXgpILgpKbgpL7gpIIiO2JyZWFrO2Nhc2UibSI6cj0i4KSP4KSV4KS+IOCkruCkv+CkqOCkv+Ckn+CkviI7YnJlYWs7Y2FzZSJtbSI6cj0iJWQg4KSu4KS/4KSo4KS/4KSf4KS+4KSCIjticmVhaztjYXNlImgiOnI9IuCkj+CkleCkviDgpKTgpL7gpLjgpL4iO2JyZWFrO2Nhc2UiaGgiOnI9IiVkIOCkpOCkvuCkuOCkvuCkgiI7YnJlYWs7Y2FzZSJkIjpyPSLgpI/gpJXgpL4g4KSm4KS/4KS14KS44KS+IjticmVhaztjYXNlImRkIjpyPSIlZCDgpKbgpL/gpLXgpLjgpL7gpIIiO2JyZWFrO2Nhc2UiTSI6cj0i4KSP4KSV4KS+IOCkruCkueCkv+CkqOCljeCkr+CkviI7YnJlYWs7Y2FzZSJNTSI6cj0iJWQg4KSu4KS54KS/4KSo4KWN4KSv4KS+4KSCIjticmVhaztjYXNlInkiOnI9IuCkj+CkleCkviDgpLXgpLDgpY3gpLfgpL4iO2JyZWFrO2Nhc2UieXkiOnI9IiVkIOCkteCksOCljeCkt+CkvuCkgiJ9cmV0dXJuIHIucmVwbGFjZSgvJWQvaSx0KX12YXIgaT17MToi4KWnIiwyOiLgpagiLDM6IuClqSIsNDoi4KWqIiw1OiLgpasiLDY6IuClrCIsNzoi4KWtIiw4OiLgpa4iLDk6IuClryIsMDoi4KWmIn0sbj17IuClpyI6IjEiLCLgpagiOiIyIiwi4KWpIjoiMyIsIuClqiI6IjQiLCLgpasiOiI1Iiwi4KWsIjoiNiIsIuClrSI6IjciLCLgpa4iOiI4Iiwi4KWvIjoiOSIsIuClpiI6IjAifSxyPXQuZGVmaW5lTG9jYWxlKCJtciIse21vbnRoczoi4KSc4KS+4KSo4KWH4KS14KS+4KSw4KWAX+Ckq+Clh+CkrOCljeCksOClgeCkteCkvuCksOClgF/gpK7gpL7gpLDgpY3gpJpf4KSP4KSq4KWN4KSw4KS/4KSyX+CkruClh1/gpJzgpYLgpKhf4KSc4KWB4KSy4KWIX+CkkeCkl+CkuOCljeCkn1/gpLjgpKrgpY3gpJ/gpYfgpILgpKzgpLBf4KSR4KSV4KWN4KSf4KWL4KSs4KSwX+CkqOCli+CkteCljeCkueClh+CkguCkrOCksF/gpKHgpL/gpLjgpYfgpILgpKzgpLAiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IuCknOCkvuCkqOClhy5f4KSr4KWH4KSs4KWN4KSw4KWBLl/gpK7gpL7gpLDgpY3gpJouX+Ckj+CkquCljeCksOCkvy5f4KSu4KWHLl/gpJzgpYLgpKguX+CknOClgeCksuCliC5f4KSR4KSXLl/gpLjgpKrgpY3gpJ/gpYfgpIIuX+CkkeCkleCljeCkn+Cliy5f4KSo4KWL4KS14KWN4KS54KWH4KSCLl/gpKHgpL/gpLjgpYfgpIIuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLgpLDgpLXgpL/gpLXgpL7gpLBf4KS44KWL4KSu4KS14KS+4KSwX+CkruCkguCkl+Cks+CkteCkvuCksF/gpKzgpYHgpKfgpLXgpL7gpLBf4KSX4KWB4KSw4KWC4KS14KS+4KSwX+CktuClgeCkleCljeCksOCkteCkvuCksF/gpLbgpKjgpL/gpLXgpL7gpLAiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi4KSw4KS14KS/X+CkuOCli+Ckrl/gpK7gpILgpJfgpLNf4KSs4KWB4KSnX+Ckl+ClgeCksOClgl/gpLbgpYHgpJXgpY3gpLBf4KS24KSo4KS/Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLgpLBf4KS44KWLX+CkruCkgl/gpKzgpYFf4KSX4KWBX+CktuClgV/gpLYiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJBIGg6bW0g4KS14KS+4KSc4KSk4KS+IixMVFM6IkEgaDptbTpzcyDgpLXgpL7gpJzgpKTgpL4iLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSwgQSBoOm1tIOCkteCkvuCknOCkpOCkviIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVksIEEgaDptbSDgpLXgpL7gpJzgpKTgpL4ifSxjYWxlbmRhcjp7c2FtZURheToiW+CkhuCknF0gTFQiLG5leHREYXk6IlvgpIngpKbgpY3gpK/gpL5dIExUIixuZXh0V2VlazoiZGRkZCwgTFQiLGxhc3REYXk6IlvgpJXgpL7gpLJdIExUIixsYXN0V2VlazoiW+CkruCkvuCkl+ClgOCksl0gZGRkZCwgTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVz4KSu4KSn4KWN4KSv4KWHIixwYXN0OiIlc+CkquClguCksOCljeCkteClgCIsczplLG06ZSxtbTplLGg6ZSxoaDplLGQ6ZSxkZDplLE06ZSxNTTplLHk6ZSx5eTplfSxwcmVwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9b4KWn4KWo4KWp4KWq4KWr4KWs4KWt4KWu4KWv4KWmXS9nLGZ1bmN0aW9uKHQpe3JldHVybiBuW3RdfSl9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gaVt0XX0pfSxtZXJpZGllbVBhcnNlOi/gpLDgpL7gpKTgpY3gpLDgpYB84KS44KSV4KS+4KSz4KWAfOCkpuClgeCkquCkvuCksOClgHzgpLjgpL7gpK/gpILgpJXgpL7gpLPgpYAvLG1lcmlkaWVtSG91cjpmdW5jdGlvbih0LGUpe3JldHVybiAxMj09PXQmJih0PTApLCLgpLDgpL7gpKTgpY3gpLDgpYAiPT09ZT90PDQ/dDp0KzEyOiLgpLjgpJXgpL7gpLPgpYAiPT09ZT90OiLgpKbgpYHgpKrgpL7gpLDgpYAiPT09ZT90Pj0xMD90OnQrMTI6IuCkuOCkvuCkr+CkguCkleCkvuCks+ClgCI9PT1lP3QrMTI6dm9pZCAwfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8ND8i4KSw4KS+4KSk4KWN4KSw4KWAIjp0PDEwPyLgpLjgpJXgpL7gpLPgpYAiOnQ8MTc/IuCkpuClgeCkquCkvuCksOClgCI6dDwyMD8i4KS44KS+4KSv4KSC4KSV4KS+4KSz4KWAIjoi4KSw4KS+4KSk4KWN4KSw4KWAIn0sd2Vlazp7ZG93OjAsZG95OjZ9fSk7cmV0dXJuIHJ9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgibXMiLHttb250aHM6IkphbnVhcmlfRmVicnVhcmlfTWFjX0FwcmlsX01laV9KdW5fSnVsYWlfT2dvc19TZXB0ZW1iZXJfT2t0b2Jlcl9Ob3ZlbWJlcl9EaXNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX0ZlYl9NYWNfQXByX01laV9KdW5fSnVsX09nc19TZXBfT2t0X05vdl9EaXMiLnNwbGl0KCJfIiksd2Vla2RheXM6IkFoYWRfSXNuaW5fU2VsYXNhX1JhYnVfS2hhbWlzX0p1bWFhdF9TYWJ0dSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJBaGRfSXNuX1NlbF9SYWJfS2hhX0p1bV9TYWIiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkFoX0lzX1NsX1JiX0ttX0ptX1NiIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEgubW0iLExUUzoiSEgubW0uc3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBbcHVrdWxdIEhILm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBbcHVrdWxdIEhILm1tIn0sbWVyaWRpZW1QYXJzZTovcGFnaXx0ZW5nYWhhcml8cGV0YW5nfG1hbGFtLyxtZXJpZGllbUhvdXI6ZnVuY3Rpb24odCxlKXtyZXR1cm4gMTI9PT10JiYodD0wKSwicGFnaSI9PT1lP3Q6InRlbmdhaGFyaSI9PT1lP3Q+PTExP3Q6dCsxMjoicGV0YW5nIj09PWV8fCJtYWxhbSI9PT1lP3QrMTI6dm9pZCAwfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTE/InBhZ2kiOnQ8MTU/InRlbmdhaGFyaSI6dDwxOT8icGV0YW5nIjoibWFsYW0ifSxjYWxlbmRhcjp7c2FtZURheToiW0hhcmkgaW5pIHB1a3VsXSBMVCIsbmV4dERheToiW0Vzb2sgcHVrdWxdIExUIixuZXh0V2VlazoiZGRkZCBbcHVrdWxdIExUIixsYXN0RGF5OiJbS2VsbWFyaW4gcHVrdWxdIExUIixsYXN0V2VlazoiZGRkZCBbbGVwYXMgcHVrdWxdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJkYWxhbSAlcyIscGFzdDoiJXMgeWFuZyBsZXBhcyIsczoiYmViZXJhcGEgc2FhdCIsbToic2VtaW5pdCIsbW06IiVkIG1pbml0IixoOiJzZWphbSIsaGg6IiVkIGphbSIsZDoic2VoYXJpIixkZDoiJWQgaGFyaSIsTToic2VidWxhbiIsTU06IiVkIGJ1bGFuIix5OiJzZXRhaHVuIix5eToiJWQgdGFodW4ifSx3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJtcy1teSIse21vbnRoczoiSmFudWFyaV9GZWJydWFyaV9NYWNfQXByaWxfTWVpX0p1bl9KdWxhaV9PZ29zX1NlcHRlbWJlcl9Pa3RvYmVyX05vdmVtYmVyX0Rpc2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJKYW5fRmViX01hY19BcHJfTWVpX0p1bl9KdWxfT2dzX1NlcF9Pa3RfTm92X0RpcyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiQWhhZF9Jc25pbl9TZWxhc2FfUmFidV9LaGFtaXNfSnVtYWF0X1NhYnR1Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IkFoZF9Jc25fU2VsX1JhYl9LaGFfSnVtX1NhYiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiQWhfSXNfU2xfUmJfS21fSm1fU2IiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISC5tbSIsTFRTOiJISC5tbS5zcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIFtwdWt1bF0gSEgubW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIFtwdWt1bF0gSEgubW0ifSxtZXJpZGllbVBhcnNlOi9wYWdpfHRlbmdhaGFyaXxwZXRhbmd8bWFsYW0vLG1lcmlkaWVtSG91cjpmdW5jdGlvbih0LGUpe3JldHVybiAxMj09PXQmJih0PTApLCJwYWdpIj09PWU/dDoidGVuZ2FoYXJpIj09PWU/dD49MTE/dDp0KzEyOiJwZXRhbmciPT09ZXx8Im1hbGFtIj09PWU/dCsxMjp2b2lkIDB9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDwxMT8icGFnaSI6dDwxNT8idGVuZ2FoYXJpIjp0PDE5PyJwZXRhbmciOiJtYWxhbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbSGFyaSBpbmkgcHVrdWxdIExUIixuZXh0RGF5OiJbRXNvayBwdWt1bF0gTFQiLG5leHRXZWVrOiJkZGRkIFtwdWt1bF0gTFQiLGxhc3REYXk6IltLZWxtYXJpbiBwdWt1bF0gTFQiLGxhc3RXZWVrOiJkZGRkIFtsZXBhcyBwdWt1bF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImRhbGFtICVzIixwYXN0OiIlcyB5YW5nIGxlcGFzIixzOiJiZWJlcmFwYSBzYWF0IixtOiJzZW1pbml0IixtbToiJWQgbWluaXQiLGg6InNlamFtIixoaDoiJWQgamFtIixkOiJzZWhhcmkiLGRkOiIlZCBoYXJpIixNOiJzZWJ1bGFuIixNTToiJWQgYnVsYW4iLHk6InNldGFodW4iLHl5OiIlZCB0YWh1biJ9LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9ezE6IuGBgSIsMjoi4YGCIiwzOiLhgYMiLDQ6IuGBhCIsNToi4YGFIiw2OiLhgYYiLDc6IuGBhyIsODoi4YGIIiw5OiLhgYkiLDA6IuGBgCJ9LGk9eyLhgYEiOiIxIiwi4YGCIjoiMiIsIuGBgyI6IjMiLCLhgYQiOiI0Iiwi4YGFIjoiNSIsIuGBhiI6IjYiLCLhgYciOiI3Iiwi4YGIIjoiOCIsIuGBiSI6IjkiLCLhgYAiOiIwIn0sbj10LmRlZmluZUxvY2FsZSgibXkiLHttb250aHM6IuGAh+GAlOGAuuGAlOGAneGAq+GAm+GArl/hgJbhgLHhgJbhgLHhgKzhgLrhgJ3hgKvhgJvhgK5f4YCZ4YCQ4YC6X+GAp+GAleGAvOGArl/hgJnhgLFf4YCH4YC94YCU4YC6X+GAh+GAsOGAnOGAreGAr+GAhOGAul/hgJ7hgLzhgILhgK/hgJDhgLpf4YCF4YCA4YC64YCQ4YCE4YC64YCY4YCsX+GAoeGAseGArOGAgOGAuuGAkOGAreGAr+GAmOGArF/hgJThgK3hgK/hgJ3hgIThgLrhgJjhgKxf4YCS4YCu4YCH4YCE4YC64YCY4YCsIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLhgIfhgJThgLpf4YCW4YCxX+GAmeGAkOGAul/hgJXhgLzhgK5f4YCZ4YCxX+GAh+GAveGAlOGAul/hgJzhgK3hgK/hgIThgLpf4YCe4YC8X+GAheGAgOGAul/hgKHhgLHhgKzhgIDhgLpf4YCU4YCt4YCvX+GAkuGAriIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi4YCQ4YCU4YCE4YC64YC54YCC4YCU4YC94YCxX+GAkOGAlOGAhOGAuuGAueGAnOGArF/hgKHhgIThgLrhgLnhgILhgKtf4YCX4YCv4YCS4YC54YCT4YCf4YCw4YC4X+GAgOGAvOGArOGAnuGAleGAkOGAseGAuF/hgJ7hgLHhgKzhgIDhgLzhgKxf4YCF4YCU4YCxIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IuGAlOGAveGAsV/hgJzhgKxf4YCC4YCrX+GAn+GAsOGAuF/hgIDhgLzhgKxf4YCe4YCx4YCsX+GAlOGAsSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4YCU4YC94YCxX+GAnOGArF/hgILhgKtf4YCf4YCw4YC4X+GAgOGAvOGArF/hgJ7hgLHhgKxf4YCU4YCxIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4YCa4YCU4YCxLl0gTFQgW+GAmeGAvuGArF0iLG5leHREYXk6IlvhgJnhgJThgIDhgLrhgJbhgLzhgJThgLpdIExUIFvhgJnhgL7hgKxdIixuZXh0V2VlazoiZGRkZCBMVCBb4YCZ4YC+4YCsXSIsbGFzdERheToiW+GAmeGAlOGAsS7hgIBdIExUIFvhgJnhgL7hgKxdIixsYXN0V2VlazoiW+GAleGAvOGAruGAuOGAgeGAsuGAt+GAnuGAseGArF0gZGRkZCBMVCBb4YCZ4YC+4YCsXSIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi4YCc4YCs4YCZ4YCK4YC64YC3ICVzIOGAmeGAvuGArCIscGFzdDoi4YCc4YC94YCU4YC64YCB4YCy4YC34YCe4YCx4YCsICVzIOGAgCIsczoi4YCF4YCA4YC54YCA4YCU4YC6LuGAoeGAlOGAiuGAuuGAuOGAhOGAmuGAuiIsbToi4YCQ4YCF4YC64YCZ4YCt4YCU4YCF4YC6IixtbToiJWQg4YCZ4YCt4YCU4YCF4YC6IixoOiLhgJDhgIXhgLrhgJThgKzhgJvhgK4iLGhoOiIlZCDhgJThgKzhgJvhgK4iLGQ6IuGAkOGAheGAuuGAm+GAgOGAuiIsZGQ6IiVkIOGAm+GAgOGAuiIsTToi4YCQ4YCF4YC64YCcIixNTToiJWQg4YCcIix5OiLhgJDhgIXhgLrhgJThgL7hgIXhgLoiLHl5OiIlZCDhgJThgL7hgIXhgLoifSxwcmVwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9b4YGB4YGC4YGD4YGE4YGF4YGG4YGH4YGI4YGJ4YGAXS9nLGZ1bmN0aW9uKHQpe3JldHVybiBpW3RdfSl9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pfSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gbn0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJuYiIse21vbnRoczoiamFudWFyX2ZlYnJ1YXJfbWFyc19hcHJpbF9tYWlfanVuaV9qdWxpX2F1Z3VzdF9zZXB0ZW1iZXJfb2t0b2Jlcl9ub3ZlbWJlcl9kZXNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiamFuLl9mZWIuX21hcnNfYXByaWxfbWFpX2p1bmlfanVsaV9hdWcuX3NlcC5fb2t0Ll9ub3YuX2Rlcy4iLnNwbGl0KCJfIiksd2Vla2RheXM6InPDuG5kYWdfbWFuZGFnX3RpcnNkYWdfb25zZGFnX3RvcnNkYWdfZnJlZGFnX2zDuHJkYWciLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoic8O4Ll9tYS5fdGkuX29uLl90by5fZnIuX2zDuC4iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46InPDuF9tYV90aV9vbl90b19mcl9sw7giLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQuTU0uWVlZWSIsTEw6IkQuIE1NTU0gWVlZWSIsTExMOiJELiBNTU1NIFlZWVkgW2tsLl0gSEg6bW0iLExMTEw6ImRkZGQgRC4gTU1NTSBZWVlZIFtrbC5dIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltpIGRhZyBrbC5dIExUIixuZXh0RGF5OiJbaSBtb3JnZW4ga2wuXSBMVCIsbmV4dFdlZWs6ImRkZGQgW2tsLl0gTFQiLGxhc3REYXk6IltpIGfDpXIga2wuXSBMVCIsbGFzdFdlZWs6Iltmb3JyaWdlXSBkZGRkIFtrbC5dIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJvbSAlcyIscGFzdDoiZm9yICVzIHNpZGVuIixzOiJub2VuIHNla3VuZGVyIixtOiJldHQgbWludXR0IixtbToiJWQgbWludXR0ZXIiLGg6ImVuIHRpbWUiLGhoOiIlZCB0aW1lciIsZDoiZW4gZGFnIixkZDoiJWQgZGFnZXIiLE06ImVuIG3DpW5lZCIsTU06IiVkIG3DpW5lZGVyIix5OiJldHQgw6VyIix5eToiJWQgw6VyIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT17MToi4KWnIiwyOiLgpagiLDM6IuClqSIsNDoi4KWqIiw1OiLgpasiLDY6IuClrCIsNzoi4KWtIiw4OiLgpa4iLDk6IuClryIsMDoi4KWmIn0saT17IuClpyI6IjEiLCLgpagiOiIyIiwi4KWpIjoiMyIsIuClqiI6IjQiLCLgpasiOiI1Iiwi4KWsIjoiNiIsIuClrSI6IjciLCLgpa4iOiI4Iiwi4KWvIjoiOSIsIuClpiI6IjAifSxuPXQuZGVmaW5lTG9jYWxlKCJuZSIse21vbnRoczoi4KSc4KSo4KS14KSw4KWAX+Ckq+Clh+CkrOCljeCksOClgeCkteCksOClgF/gpK7gpL7gpLDgpY3gpJpf4KSF4KSq4KWN4KSw4KS/4KSyX+CkruCkiF/gpJzgpYHgpKhf4KSc4KWB4KSy4KS+4KSIX+CkheCkl+Ckt+CljeCkn1/gpLjgpYfgpKrgpY3gpJ/gpYfgpK7gpY3gpKzgpLBf4KSF4KSV4KWN4KSf4KWL4KSs4KSwX+CkqOCli+CkreClh+CkruCljeCkrOCksF/gpKHgpL/gpLjgpYfgpK7gpY3gpKzgpLAiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IuCknOCkqC5f4KSr4KWH4KSs4KWN4KSw4KWBLl/gpK7gpL7gpLDgpY3gpJpf4KSF4KSq4KWN4KSw4KS/Ll/gpK7gpIhf4KSc4KWB4KSoX+CknOClgeCksuCkvuCkiC5f4KSF4KSXLl/gpLjgpYfgpKrgpY3gpJ8uX+CkheCkleCljeCkn+Cliy5f4KSo4KWL4KSt4KWHLl/gpKHgpL/gpLjgpYcuIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLgpIbgpIfgpKTgpKzgpL7gpLBf4KS44KWL4KSu4KSs4KS+4KSwX+CkruCkmeCljeCkl+CksuCkrOCkvuCksF/gpKzgpYHgpKfgpKzgpL7gpLBf4KSs4KS/4KS54KS/4KSs4KS+4KSwX+CktuClgeCkleCljeCksOCkrOCkvuCksF/gpLbgpKjgpL/gpKzgpL7gpLAiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi4KSG4KSH4KSkLl/gpLjgpYvgpK4uX+CkruCkmeCljeCkl+Cksi5f4KSs4KWB4KSnLl/gpKzgpL/gpLngpL8uX+CktuClgeCkleCljeCksC5f4KS24KSo4KS/LiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4KQ=", "base64"));
  res.write(new Buffer("hi5f4KS44KWLLl/gpK7gpIIuX+CkrOClgS5f4KSs4KS/Ll/gpLbgpYEuX+Ckti4iLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJB4KSV4KWLIGg6bW0g4KSs4KSc4KWHIixMVFM6IkHgpJXgpYsgaDptbTpzcyDgpKzgpJzgpYciLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSwgQeCkleCliyBoOm1tIOCkrOCknOClhyIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVksIEHgpJXgpYsgaDptbSDgpKzgpJzgpYcifSxwcmVwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9b4KWn4KWo4KWp4KWq4KWr4KWs4KWt4KWu4KWv4KWmXS9nLGZ1bmN0aW9uKHQpe3JldHVybiBpW3RdfSl9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pfSxtZXJpZGllbVBhcnNlOi/gpLDgpL7gpKTgpL984KSs4KS/4KS54KS+4KSofOCkpuCkv+CkieCkgeCkuOCli3zgpLjgpL7gpIHgpJ0vLG1lcmlkaWVtSG91cjpmdW5jdGlvbih0LGUpe3JldHVybiAxMj09PXQmJih0PTApLCLgpLDgpL7gpKTgpL8iPT09ZT90PDQ/dDp0KzEyOiLgpKzgpL/gpLngpL7gpKgiPT09ZT90OiLgpKbgpL/gpIngpIHgpLjgpYsiPT09ZT90Pj0xMD90OnQrMTI6IuCkuOCkvuCkgeCknSI9PT1lP3QrMTI6dm9pZCAwfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8Mz8i4KSw4KS+4KSk4KS/Ijp0PDEyPyLgpKzgpL/gpLngpL7gpKgiOnQ8MTY/IuCkpuCkv+CkieCkgeCkuOCliyI6dDwyMD8i4KS44KS+4KSB4KSdIjoi4KSw4KS+4KSk4KS/In0sY2FsZW5kYXI6e3NhbWVEYXk6IlvgpIbgpJxdIExUIixuZXh0RGF5OiJb4KSt4KWL4KSy4KS/XSBMVCIsbmV4dFdlZWs6IlvgpIbgpIngpIHgpKbgpYtdIGRkZGRbLF0gTFQiLGxhc3REYXk6IlvgpLngpL/gpJzgpYtdIExUIixsYXN0V2VlazoiW+Ckl+Ckj+CkleCli10gZGRkZFssXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXPgpK7gpL4iLHBhc3Q6IiVzIOCkheCkl+CkvuCkoeCkvyIsczoi4KSV4KWH4KS54KWAIOCkleCljeCkt+CkoyIsbToi4KSP4KSVIOCkruCkv+CkqOClh+CknyIsbW06IiVkIOCkruCkv+CkqOClh+CknyIsaDoi4KSP4KSVIOCkmOCko+CljeCkn+CkviIsaGg6IiVkIOCkmOCko+CljeCkn+CkviIsZDoi4KSP4KSVIOCkpuCkv+CkqCIsZGQ6IiVkIOCkpuCkv+CkqCIsTToi4KSP4KSVIOCkruCkueCkv+CkqOCkviIsTU06IiVkIOCkruCkueCkv+CkqOCkviIseToi4KSP4KSVIOCkrOCksOCljeCktyIseXk6IiVkIOCkrOCksOCljeCktyJ9LHdlZWs6e2RvdzowLGRveTo2fX0pO3JldHVybiBufSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9Imphbi5fZmViLl9tcnQuX2Fwci5fbWVpX2p1bi5fanVsLl9hdWcuX3NlcC5fb2t0Ll9ub3YuX2RlYy4iLnNwbGl0KCJfIiksaT0iamFuX2ZlYl9tcnRfYXByX21laV9qdW5fanVsX2F1Z19zZXBfb2t0X25vdl9kZWMiLnNwbGl0KCJfIiksbj10LmRlZmluZUxvY2FsZSgibmwiLHttb250aHM6ImphbnVhcmlfZmVicnVhcmlfbWFhcnRfYXByaWxfbWVpX2p1bmlfanVsaV9hdWd1c3R1c19zZXB0ZW1iZXJfb2t0b2Jlcl9ub3ZlbWJlcl9kZWNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDpmdW5jdGlvbih0LG4pe3JldHVybi8tTU1NLS8udGVzdChuKT9pW3QubW9udGgoKV06ZVt0Lm1vbnRoKCldfSx3ZWVrZGF5czoiem9uZGFnX21hYW5kYWdfZGluc2RhZ193b2Vuc2RhZ19kb25kZXJkYWdfdnJpamRhZ196YXRlcmRhZyIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJ6by5fbWEuX2RpLl93by5fZG8uX3ZyLl96YS4iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IlpvX01hX0RpX1dvX0RvX1ZyX1phIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkRELU1NLVlZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbdmFuZGFhZyBvbV0gTFQiLG5leHREYXk6Ilttb3JnZW4gb21dIExUIixuZXh0V2VlazoiZGRkZCBbb21dIExUIixsYXN0RGF5OiJbZ2lzdGVyZW4gb21dIExUIixsYXN0V2VlazoiW2FmZ2Vsb3Blbl0gZGRkZCBbb21dIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJvdmVyICVzIixwYXN0OiIlcyBnZWxlZGVuIixzOiJlZW4gcGFhciBzZWNvbmRlbiIsbToiw6nDqW4gbWludXV0IixtbToiJWQgbWludXRlbiIsaDoiw6nDqW4gdXVyIixoaDoiJWQgdXVyIixkOiLDqcOpbiBkYWciLGRkOiIlZCBkYWdlbiIsTToiw6nDqW4gbWFhbmQiLE1NOiIlZCBtYWFuZGVuIix5OiLDqcOpbiBqYWFyIix5eToiJWQgamFhciJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfShzdGV8ZGUpLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3JldHVybiB0KygxPT09dHx8OD09PXR8fHQ+PTIwPyJzdGUiOiJkZSIpfSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gbn0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJubiIse21vbnRoczoiamFudWFyX2ZlYnJ1YXJfbWFyc19hcHJpbF9tYWlfanVuaV9qdWxpX2F1Z3VzdF9zZXB0ZW1iZXJfb2t0b2Jlcl9ub3ZlbWJlcl9kZXNlbWJlciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiamFuX2ZlYl9tYXJfYXByX21haV9qdW5fanVsX2F1Z19zZXBfb2t0X25vdl9kZXMiLnNwbGl0KCJfIiksd2Vla2RheXM6InN1bmRhZ19tw6VuZGFnX3R5c2RhZ19vbnNkYWdfdG9yc2RhZ19mcmVkYWdfbGF1cmRhZyIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJzdW5fbcOlbl90eXNfb25zX3Rvcl9mcmVfbGF1Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJzdV9tw6VfdHlfb25fdG9fZnJfbMO4Ii5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJELiBNTU1NIFlZWVkiLExMTDoiRC4gTU1NTSBZWVlZIFtrbC5dIEg6bW0iLExMTEw6ImRkZGQgRC4gTU1NTSBZWVlZIFtrbC5dIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltJIGRhZyBrbG9ra2FdIExUIixuZXh0RGF5OiJbSSBtb3Jnb24ga2xva2thXSBMVCIsbmV4dFdlZWs6ImRkZGQgW2tsb2trYV0gTFQiLGxhc3REYXk6IltJIGfDpXIga2xva2thXSBMVCIsbGFzdFdlZWs6IltGw7hyZWfDpWFuZGVdIGRkZGQgW2tsb2trYV0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6Im9tICVzIixwYXN0OiJmb3IgJXMgc2lkYW4iLHM6Im5va3JlIHNla3VuZCIsbToiZWl0IG1pbnV0dCIsbW06IiVkIG1pbnV0dCIsaDoiZWluIHRpbWUiLGhoOiIlZCB0aW1hciIsZDoiZWluIGRhZyIsZGQ6IiVkIGRhZ2FyIixNOiJlaW4gbcOlbmFkIixNTToiJWQgbcOlbmFkZXIiLHk6ImVpdCDDpXIiLHl5OiIlZCDDpXIifSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXsxOiLgqaciLDI6IuCpqCIsMzoi4KmpIiw0OiLgqaoiLDU6IuCpqyIsNjoi4KmsIiw3OiLgqa0iLDg6IuCpriIsOToi4KmvIiwwOiLgqaYifSxpPXsi4KmnIjoiMSIsIuCpqCI6IjIiLCLgqakiOiIzIiwi4KmqIjoiNCIsIuCpqyI6IjUiLCLgqawiOiI2Iiwi4KmtIjoiNyIsIuCpriI6IjgiLCLgqa8iOiI5Iiwi4KmmIjoiMCJ9LG49dC5kZWZpbmVMb2NhbGUoInBhLWluIix7bW9udGhzOiLgqJzgqKjgqLXgqLDgqYBf4Kir4Ki84Kiw4Ki14Kiw4KmAX+CoruCovuCosOComl/gqIXgqKrgqY3gqLDgqYjgqLJf4Kiu4KiIX+ConOCpguCoqF/gqJzgqYHgqLLgqL7gqIhf4KiF4KiX4Ki44KikX+CouOCopOCpsOCorOCosF/gqIXgqJXgqKTgqYLgqKzgqLBf4Kio4Ki14Kmw4Kis4KiwX+CopuCouOCpsOCorOCosCIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoi4Kic4Kio4Ki14Kiw4KmAX+Coq+CovOCosOCoteCosOCpgF/gqK7gqL7gqLDgqJpf4KiF4Kiq4KmN4Kiw4KmI4KiyX+CoruCoiF/gqJzgqYLgqKhf4Kic4KmB4Kiy4Ki+4KiIX+CoheCol+CouOCopF/gqLjgqKTgqbDgqKzgqLBf4KiF4KiV4Kik4KmC4Kis4KiwX+CoqOCoteCpsOCorOCosF/gqKbgqLjgqbDgqKzgqLAiLnNwbGl0KCJfIiksCgl3ZWVrZGF5czoi4KiQ4Kik4Ki14Ki+4KiwX+CouOCpi+CoruCoteCovuCosF/gqK7gqbDgqJfgqLLgqLXgqL7gqLBf4Kis4KmB4Kin4Ki14Ki+4KiwX+CoteCpgOCosOCoteCovuCosF/gqLjgqLzgqYHgqbHgqJXgqLDgqLXgqL7gqLBf4Ki44Ki84Kio4KmA4Kia4Kiw4Ki14Ki+4KiwIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IuCokOCopF/gqLjgqYvgqK5f4Kiu4Kmw4KiX4KiyX+CorOCpgeCop1/gqLXgqYDgqLBf4Ki44Ki84KmB4KiV4KiwX+CouOCovOCoqOCpgCIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4KiQ4KikX+CouOCpi+Corl/gqK7gqbDgqJfgqLJf4Kis4KmB4KinX+CoteCpgOCosF/gqLjgqLzgqYHgqJXgqLBf4Ki44Ki84Kio4KmAIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiQSBoOm1tIOCoteConOCphyIsTFRTOiJBIGg6bW06c3Mg4Ki14Kic4KmHIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVksIEEgaDptbSDgqLXgqJzgqYciLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZLCBBIGg6bW0g4Ki14Kic4KmHIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvgqIXgqJxdIExUIixuZXh0RGF5OiJb4KiV4KiyXSBMVCIsbmV4dFdlZWs6ImRkZGQsIExUIixsYXN0RGF5OiJb4KiV4KiyXSBMVCIsbGFzdFdlZWs6IlvgqKrgqL/gqJvgqLLgqYddIGRkZGQsIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlcyDgqLXgqL/gqbHgqJoiLHBhc3Q6IiVzIOCoquCov+Com+CosuCphyIsczoi4KiV4KmB4KidIOCouOColeCov+CpsOConyIsbToi4KiH4KiVIOCoruCov+CpsOConyIsbW06IiVkIOCoruCov+CpsOConyIsaDoi4KiH4Kmx4KiVIOComOCpsOCon+CoviIsaGg6IiVkIOComOCpsOCon+CphyIsZDoi4KiH4Kmx4KiVIOCopuCov+CoqCIsZGQ6IiVkIOCopuCov+CoqCIsTToi4KiH4Kmx4KiVIOCoruCoueCpgOCoqOCoviIsTU06IiVkIOCoruCoueCpgOCoqOCphyIseToi4KiH4Kmx4KiVIOCouOCovuCosiIseXk6IiVkIOCouOCovuCosiJ9LHByZXBhcnNlOmZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoL1vgqafgqajgqangqargqavgqazgqa3gqa7gqa/gqaZdL2csZnVuY3Rpb24odCl7cmV0dXJuIGlbdF19KX0scG9zdGZvcm1hdDpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9cZC9nLGZ1bmN0aW9uKHQpe3JldHVybiBlW3RdfSl9LG1lcmlkaWVtUGFyc2U6L+CosOCovuCopHzgqLjgqLXgqYfgqLB84Kim4KmB4Kiq4Ki54Ki/4KiwfOCouOCovOCovuCori8sbWVyaWRpZW1Ib3VyOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIDEyPT09dCYmKHQ9MCksIuCosOCovuCopCI9PT1lP3Q8ND90OnQrMTI6IuCouOCoteCph+CosCI9PT1lP3Q6IuCopuCpgeCoquCoueCov+CosCI9PT1lP3Q+PTEwP3Q6dCsxMjoi4Ki44Ki84Ki+4KiuIj09PWU/dCsxMjp2b2lkIDB9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDw0PyLgqLDgqL7gqKQiOnQ8MTA/IuCouOCoteCph+CosCI6dDwxNz8i4Kim4KmB4Kiq4Ki54Ki/4KiwIjp0PDIwPyLgqLjgqLzgqL7gqK4iOiLgqLDgqL7gqKQifSx3ZWVrOntkb3c6MCxkb3k6Nn19KTtyZXR1cm4gbn0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCl7cmV0dXJuIHQlMTA8NSYmdCUxMD4xJiZ+fih0LzEwKSUxMCE9PTF9ZnVuY3Rpb24gaSh0LGksbil7dmFyIHI9dCsiICI7c3dpdGNoKG4pe2Nhc2UibSI6cmV0dXJuIGk/Im1pbnV0YSI6Im1pbnV0xJkiO2Nhc2UibW0iOnJldHVybiByKyhlKHQpPyJtaW51dHkiOiJtaW51dCIpO2Nhc2UiaCI6cmV0dXJuIGk/ImdvZHppbmEiOiJnb2R6aW7EmSI7Y2FzZSJoaCI6cmV0dXJuIHIrKGUodCk/ImdvZHppbnkiOiJnb2R6aW4iKTtjYXNlIk1NIjpyZXR1cm4gcisoZSh0KT8ibWllc2nEhWNlIjoibWllc2nEmWN5Iik7Y2FzZSJ5eSI6cmV0dXJuIHIrKGUodCk/ImxhdGEiOiJsYXQiKX19dmFyIG49InN0eWN6ZcWEX2x1dHlfbWFyemVjX2t3aWVjaWXFhF9tYWpfY3plcndpZWNfbGlwaWVjX3NpZXJwaWXFhF93cnplc2llxYRfcGHFumR6aWVybmlrX2xpc3RvcGFkX2dydWR6aWXFhCIuc3BsaXQoIl8iKSxyPSJzdHljem5pYV9sdXRlZ29fbWFyY2Ffa3dpZXRuaWFfbWFqYV9jemVyd2NhX2xpcGNhX3NpZXJwbmlhX3dyemXFm25pYV9wYcW6ZHppZXJuaWthX2xpc3RvcGFkYV9ncnVkbmlhIi5zcGxpdCgiXyIpLHM9dC5kZWZpbmVMb2NhbGUoInBsIix7bW9udGhzOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIiI9PT1lPyIoIityW3QubW9udGgoKV0rInwiK25bdC5tb250aCgpXSsiKSI6L0QgTU1NTS8udGVzdChlKT9yW3QubW9udGgoKV06blt0Lm1vbnRoKCldfSxtb250aHNTaG9ydDoic3R5X2x1dF9tYXJfa3dpX21hal9jemVfbGlwX3NpZV93cnpfcGHFul9saXNfZ3J1Ii5zcGxpdCgiXyIpLHdlZWtkYXlzOiJuaWVkemllbGFfcG9uaWVkemlhxYJla193dG9yZWtfxZtyb2RhX2N6d2FydGVrX3BpxIV0ZWtfc29ib3RhIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6Im5pZV9wb25fd3RfxZtyX2N6d19wdF9zYiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoiTmRfUG5fV3RfxZpyX0N6X1B0X1NvIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW0R6acWbIG9dIExUIixuZXh0RGF5OiJbSnV0cm8gb10gTFQiLG5leHRXZWVrOiJbV10gZGRkZCBbb10gTFQiLGxhc3REYXk6IltXY3pvcmFqIG9dIExUIixsYXN0V2VlazpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6cmV0dXJuIltXIHplc3rFgsSFIG5pZWR6aWVsxJkgb10gTFQiO2Nhc2UgMzpyZXR1cm4iW1cgemVzesWCxIUgxZtyb2TEmSBvXSBMVCI7Y2FzZSA2OnJldHVybiJbVyB6ZXN6xYLEhSBzb2JvdMSZIG9dIExUIjtkZWZhdWx0OnJldHVybiJbVyB6ZXN6xYJ5XSBkZGRkIFtvXSBMVCJ9fSxzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJ6YSAlcyIscGFzdDoiJXMgdGVtdSIsczoia2lsa2Egc2VrdW5kIixtOmksbW06aSxoOmksaGg6aSxkOiIxIGR6aWXFhCIsZGQ6IiVkIGRuaSIsTToibWllc2nEhWMiLE1NOmkseToicm9rIix5eTppfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gc30pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJwdCIse21vbnRoczoiSmFuZWlyb19GZXZlcmVpcm9fTWFyw6dvX0FicmlsX01haW9fSnVuaG9fSnVsaG9fQWdvc3RvX1NldGVtYnJvX091dHVicm9fTm92ZW1icm9fRGV6ZW1icm8iLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6Ikphbl9GZXZfTWFyX0Ficl9NYWlfSnVuX0p1bF9BZ29fU2V0X091dF9Ob3ZfRGV6Ii5zcGxpdCgiXyIpLHdlZWtkYXlzOiJEb21pbmdvX1NlZ3VuZGEtRmVpcmFfVGVyw6dhLUZlaXJhX1F1YXJ0YS1GZWlyYV9RdWludGEtRmVpcmFfU2V4dGEtRmVpcmFfU8OhYmFkbyIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJEb21fU2VnX1Rlcl9RdWFfUXVpX1NleF9Tw6FiIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJEb21fMsKqXzPCql80wqpfNcKqXzbCql9Tw6FiIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIFtkZV0gTU1NTSBbZGVdIFlZWVkiLExMTDoiRCBbZGVdIE1NTU0gW2RlXSBZWVlZIEhIOm1tIixMTExMOiJkZGRkLCBEIFtkZV0gTU1NTSBbZGVdIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW0hvamUgw6BzXSBMVCIsbmV4dERheToiW0FtYW5ow6Mgw6BzXSBMVCIsbmV4dFdlZWs6ImRkZGQgW8Ogc10gTFQiLGxhc3REYXk6IltPbnRlbSDDoHNdIExUIixsYXN0V2VlazpmdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5kYXkoKXx8Nj09PXRoaXMuZGF5KCk/IlvDmmx0aW1vXSBkZGRkIFvDoHNdIExUIjoiW8OabHRpbWFdIGRkZGQgW8Ogc10gTFQifSxzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJlbSAlcyIscGFzdDoiaMOhICVzIixzOiJzZWd1bmRvcyIsbToidW0gbWludXRvIixtbToiJWQgbWludXRvcyIsaDoidW1hIGhvcmEiLGhoOiIlZCBob3JhcyIsZDoidW0gZGlhIixkZDoiJWQgZGlhcyIsTToidW0gbcOqcyIsTU06IiVkIG1lc2VzIix5OiJ1bSBhbm8iLHl5OiIlZCBhbm9zIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9wrovLG9yZGluYWw6IiVkwroiLHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoInB0LWJyIix7bW9udGhzOiJKYW5laXJvX0ZldmVyZWlyb19NYXLDp29fQWJyaWxfTWFpb19KdW5ob19KdWxob19BZ29zdG9fU2V0ZW1icm9fT3V0dWJyb19Ob3ZlbWJyb19EZXplbWJybyIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX0Zldl9NYXJfQWJyX01haV9KdW5fSnVsX0Fnb19TZXRfT3V0X05vdl9EZXoiLnNwbGl0KCJfIiksd2Vla2RheXM6IkRvbWluZ29fU2VndW5kYS1mZWlyYV9UZXLDp2EtZmVpcmFfUXVhcnRhLWZlaXJhX1F1aW50YS1mZWlyYV9TZXh0YS1mZWlyYV9Tw6FiYWRvIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IkRvbV9TZWdfVGVyX1F1YV9RdWlfU2V4X1PDoWIiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkRvbV8ywqpfM8KqXzTCql81wqpfNsKqX1PDoWIiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgW2RlXSBNTU1NIFtkZV0gWVlZWSIsTExMOiJEIFtkZV0gTU1NTSBbZGVdIFlZWVkgW8Ogc10gSEg6bW0iLExMTEw6ImRkZGQsIEQgW2RlXSBNTU1NIFtkZV0gWVlZWSBbw6BzXSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbSG9qZSDDoHNdIExUIixuZXh0RGF5OiJbQW1hbmjDoyDDoHNdIExUIixuZXh0V2VlazoiZGRkZCBbw6BzXSBMVCIsbGFzdERheToiW09udGVtIMOgc10gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmRheSgpfHw2PT09dGhpcy5kYXkoKT8iW8OabHRpbW9dIGRkZGQgW8Ogc10gTFQiOiJbw5psdGltYV0gZGRkZCBbw6BzXSBMVCJ9LHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ImVtICVzIixwYXN0OiIlcyBhdHLDoXMiLHM6InBvdWNvcyBzZWd1bmRvcyIsbToidW0gbWludXRvIixtbToiJWQgbWludXRvcyIsaDoidW1hIGhvcmEiLGhoOiIlZCBob3JhcyIsZDoidW0gZGlhIixkZDoiJWQgZGlhcyIsTToidW0gbcOqcyIsTU06IiVkIG1lc2VzIix5OiJ1bSBhbm8iLHl5OiIlZCBhbm9zIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9wrovLG9yZGluYWw6IiVkwroifSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQsZSxpKXt2YXIgbj17bW06Im1pbnV0ZSIsaGg6Im9yZSIsZGQ6InppbGUiLE1NOiJsdW5pIix5eToiYW5pIn0scj0iICI7cmV0dXJuKHQlMTAwPj0yMHx8dD49MTAwJiZ0JTEwMD09PTApJiYocj0iIGRlICIpLHQrcituW2ldfXZhciBpPXQuZGVmaW5lTG9jYWxlKCJybyIse21vbnRoczoiaWFudWFyaWVfZmVicnVhcmllX21hcnRpZV9hcHJpbGllX21haV9pdW5pZV9pdWxpZV9hdWd1c3Rfc2VwdGVtYnJpZV9vY3RvbWJyaWVfbm9pZW1icmllX2RlY2VtYnJpZSIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiaWFuLl9mZWJyLl9tYXJ0Ll9hcHIuX21haV9pdW4uX2l1bC5fYXVnLl9zZXB0Ll9vY3QuX25vdi5fZGVjLiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiZHVtaW5pY8SDX2x1bmlfbWFyyJtpX21pZXJjdXJpX2pvaV92aW5lcmlfc8OibWLEg3TEgyIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJEdW1fTHVuX01hcl9NaWVfSm9pX1Zpbl9Tw6JtIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJEdV9MdV9NYV9NaV9Kb19WaV9Tw6IiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBIOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSBIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlthemkgbGFdIExUIixuZXh0RGF5OiJbbcOiaW5lIGxhXSBMVCIsbmV4dFdlZWs6ImRkZGQgW2xhXSBMVCIsbGFzdERheToiW2llcmkgbGFdIExUIixsYXN0V2VlazoiW2Zvc3RhXSBkZGRkIFtsYV0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6InBlc3RlICVzIixwYXN0OiIlcyDDrm4gdXJtxIMiLHM6ImPDonRldmEgc2VjdW5kZSIsbToidW4gbWludXQiLG1tOmUsaDoibyBvcsSDIixoaDplLGQ6Im8gemkiLGRkOmUsTToibyBsdW7EgyIsTU06ZSx5OiJ1biBhbiIseXk6ZX0sd2Vlazp7ZG93OjEsZG95Ojd9fSk7cmV0dXJuIGl9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQsZSl7dmFyIGk9dC5zcGxpdCgiXyIpO3JldHVybiBlJTEwPT09MSYmZSUxMDAhPT0xMT9pWzBdOmUlMTA+PTImJmUlMTA8PTQmJihlJTEwMDwxMHx8ZSUxMDA+PTIwKT9pWzFdOmlbMl19ZnVuY3Rpb24gaSh0LGksbil7dmFyIHI9e21tOmk/ItC80LjQvdGD0YLQsF/QvNC40L3Rg9GC0Ytf0LzQuNC90YPRgiI6ItC80LjQvdGD0YLRg1/QvNC40L3Rg9GC0Ytf0LzQuNC90YPRgiIsaGg6ItGH0LDRgV/Rh9Cw0YHQsF/Rh9Cw0YHQvtCyIixkZDoi0LTQtdC90Yxf0LTQvdGPX9C00L3QtdC5IixNTToi0LzQtdGB0Y/Rhl/QvNC10YHRj9GG0LBf0LzQtdGB0Y/RhtC10LIiLHl5OiLQs9C+0LRf0LPQvtC00LBf0LvQtdGCIn07cmV0dXJuIm0iPT09bj9pPyLQvNC40L3Rg9GC0LAiOiLQvNC40L3Rg9GC0YMiOnQrIiAiK2UocltuXSwrdCl9dmFyIG49Wy9e0Y/QvdCyL2ksL17RhNC10LIvaSwvXtC80LDRgC9pLC9e0LDQv9GAL2ksL17QvNCwW9C5fNGPXS9pLC9e0LjRjtC9L2ksL17QuNGO0LsvaSwvXtCw0LLQsy9pLC9e0YHQtdC9L2ksL17QvtC60YIvaSwvXtC90L7Rjy9pLC9e0LTQtdC6L2ldLHI9dC5kZWZpbmVMb2NhbGUoInJ1Iix7bW9udGhzOntmb3JtYXQ6ItGP0L3QstCw0YDRj1/RhNC10LLRgNCw0LvRj1/QvNCw0YDRgtCwX9Cw0L/RgNC10LvRj1/QvNCw0Y9f0LjRjtC90Y9f0LjRjtC70Y9f0LDQstCz0YPRgdGC0LBf0YHQtdC90YLRj9Cx0YDRj1/QvtC60YLRj9Cx0YDRj1/QvdC+0Y/QsdGA0Y9f0LTQtdC60LDQsdGA0Y8iLnNwbGl0KCJfIiksc3RhbmRhbG9uZToi0Y/QvdCy0LDRgNGMX9GE0LXQstGA0LDQu9GMX9C80LDRgNGCX9Cw0L/RgNC10LvRjF/QvNCw0Llf0LjRjtC90Yxf0LjRjtC70Yxf0LDQstCz0YPRgdGCX9GB0LXQvdGC0Y/QsdGA0Yxf0L7QutGC0Y/QsdGA0Yxf0L3QvtGP0LHRgNGMX9C00LXQutCw0LHRgNGMIi5zcGxpdCgiXyIpfSxtb250aHNTaG9ydDp7Zm9ybWF0OiLRj9C90LJf0YTQtdCyX9C80LDRgF/QsNC/0YBf0LzQsNGPX9C40Y7QvdGPX9C40Y7Qu9GPX9Cw0LLQs1/RgdC10L1f0L7QutGCX9C90L7Rj1/QtNC10LoiLnNwbGl0KCJfIiksc3RhbmRhbG9uZToi0Y/QvdCyX9GE0LXQsl/QvNCw0YDRgl/QsNC/0YBf0LzQsNC5X9C40Y7QvdGMX9C40Y7Qu9GMX9Cw0LLQs1/RgdC10L1f0L7QutGCX9C90L7Rj1/QtNC10LoiLnNwbGl0KCJfIil9LHdlZWtkYXlzOntzdGFuZGFsb25lOiLQstC+0YHQutGA0LXRgdC10L3RjNC1X9C/0L7QvdC10LTQtdC70YzQvdC40Lpf0LLRgtC+0YDQvdC40Lpf0YHRgNC10LTQsF/Rh9C10YLQstC10YDQs1/Qv9GP0YLQvdC40YbQsF/RgdGD0LHQsdC+0YLQsCIuc3BsaXQoIl8iKSxmb3JtYXQ6ItCy0L7RgdC60YDQtdGB0LXQvdGM0LVf0L/QvtC90LXQtNC10LvRjNC90LjQul/QstGC0L7RgNC90LjQul/RgdGA0LXQtNGDX9GH0LXRgtCy0LXRgNCzX9C/0Y/RgtC90LjRhtGDX9GB0YPQsdCx0L7RgtGDIi5zcGxpdCgiXyIpLGlzRm9ybWF0Oi9cWyA/W9CS0LJdID8oPzrQv9GA0L7RiNC70YPRjnzRgdC70LXQtNGD0Y7RidGD0Y580Y3RgtGDKT8gP1xdID9kZGRkL30sd2Vla2RheXNTaG9ydDoi0LLRgV/Qv9C9X9Cy0YJf0YHRgF/Rh9GCX9C/0YJf0YHQsSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi0LLRgV/Qv9C9X9Cy0YJf0YHRgF/Rh9GCX9C/0YJf0YHQsSIuc3BsaXQoIl8iKSxtb250aHNQYXJzZTpuLGxvbmdNb250aHNQYXJzZTpuLHNob3J0TW9udGhzUGFyc2U6bixsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRCBNTU1NIFlZWVkg0LMuIixMTEw6IkQgTU1NTSBZWVlZINCzLiwgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZINCzLiwgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW9Ch0LXQs9C+0LTQvdGPINCyXSBMVCIsbmV4dERheToiW9CX0LDQstGC0YDQsCDQsl0gTFQiLGxhc3REYXk6IlvQktGH0LXRgNCwINCyXSBMVCIsbmV4dFdlZWs6ZnVuY3Rpb24odCl7aWYodC53ZWVrKCk9PT10aGlzLndlZWsoKSlyZXR1cm4gMj09PXRoaXMuZGF5KCk/IlvQktC+XSBkZGRkIFvQsl0gTFQiOiJb0JJdIGRkZGQgW9CyXSBMVCI7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpyZXR1cm4iW9CSINGB0LvQtdC00YPRjtGJ0LXQtV0gZGRkZCBb0LJdIExUIjtjYXNlIDE6Y2FzZSAyOmNhc2UgNDpyZXR1cm4iW9CSINGB0LvQtdC00YPRjtGJ0LjQuV0gZGRkZCBb0LJdIExUIjtjYXNlIDM6Y2FzZSA1OmNhc2UgNjpyZXR1cm4iW9CSINGB0LvQtdC00YPRjtGJ0YPRjl0gZGRkZCBb0LJdIExUIn19LGxhc3RXZWVrOmZ1bmN0aW9uKHQpe2lmKHQud2VlaygpPT09dGhpcy53ZWVrKCkpcmV0dXJuIDI9PT10aGlzLmRheSgpPyJb0JLQvl0gZGRkZCBb0LJdIExUIjoiW9CSXSBkZGRkIFvQsl0gTFQiO3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6cmV0dXJuIlvQkiDQv9GA0L7RiNC70L7QtV0gZGRkZCBb0LJdIExUIjtjYXNlIDE6Y2FzZSAyOmNhc2UgNDpyZXR1cm4iW9CSINC/0YDQvtGI0LvRi9C5XSBkZGRkIFvQsl0gTFQiO2Nhc2UgMzpjYXNlIDU6Y2FzZSA2OnJldHVybiJb0JIg0L/RgNC+0YjQu9GD0Y5dIGRkZGQgW9CyXSBMVCJ9fSxzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLRh9C10YDQtdC3ICVzIixwYXN0OiIlcyDQvdCw0LfQsNC0IixzOiLQvdC10YHQutC+0LvRjNC60L4g0YHQtdC60YPQvdC0IixtOmksbW06aSxoOiLRh9Cw0YEiLGhoOmksZDoi0LTQtdC90YwiLGRkOmksTToi0LzQtdGB0Y/RhiIsTU06aSx5OiLQs9C+0LQiLHl5Oml9LG1lcmlkaWVtUGFyc2U6L9C90L7Rh9C4fNGD0YLRgNCwfNC00L3Rj3zQstC10YfQtdGA0LAvaSxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybi9eKNC00L3Rj3zQstC10YfQtdGA0LApJC8udGVzdCh0KX0sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PDQ/ItC90L7Rh9C4Ijp0PDEyPyLRg9GC0YDQsCI6dDwxNz8i0LTQvdGPIjoi0LLQtdGH0LXRgNCwIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LSjQuXzQs9C+fNGPKS8sb3JkaW5hbDpmdW5jdGlvbih0LGUpe3N3aXRjaChlKXtjYXNlIk0iOmNhc2UiZCI6Y2FzZSJEREQiOnJldHVybiB0KyIt0LkiO2Nhc2UiRCI6cmV0dXJuIHQrIi3Qs9C+IjtjYXNlInciOmNhc2UiVyI6cmV0dXJuIHQrIi3RjyI7ZGVmYXVsdDpyZXR1cm4gdH19LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiByfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoInNlIix7bW9udGhzOiJvxJHEkWFqYWdlbcOhbm51X2d1b3Z2YW3DoW5udV9uanVrxI1hbcOhbm51X2N1b8WLb23DoW5udV9taWVzc2Vtw6FubnVfZ2Vhc3NlbcOhbm51X3N1b2lkbmVtw6FubnVfYm9yZ2Vtw6FubnVfxI1ha8SNYW3DoW5udV9nb2xnZ290bcOhbm51X3Nrw6FibWFtw6FubnVfanVvdmxhbcOhbm51Ii5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJvxJHEkWpfZ3Vvdl9uanVrX2N1b19taWVzX2dlYXNfc3VvaV9ib3JnX8SNYWvEjV9nb2xnX3Nrw6FiX2p1b3YiLnNwbGl0KCJfIiksd2Vla2RheXM6InNvdG5hYmVhaXZpX3Z1b3Nzw6FyZ2FfbWHFi8WLZWLDoXJnYV9nYXNrYXZhaGtrdV9kdW9yYXN0YXRfYmVhcmphZGF0X2zDoXZ2YXJkYXQiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoic290bl92dW9zX21hxYtfZ2Fza19kdW9yX2JlYXJfbMOhdiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoic192X21fZ19kX2JfTCIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiTU1NTSBELiBbYi5dIFlZWVkiLExMTDoiTU1NTSBELiBbYi5dIFlZWVkgW3RpLl0gSEg6bW0iLExMTEw6ImRkZGQsIE1NTU0gRC4gW2IuXSBZWVlZIFt0aS5dIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltvdG5lIHRpXSBMVCIsbmV4dERheToiW2lodHRpbiB0aV0gTFQiLG5leHRXZWVrOiJkZGRkIFt0aV0gTFQiLGxhc3REYXk6Iltpa3RlIHRpXSBMVCIsbGFzdFdlZWs6IltvdmRkaXRdIGRkZGQgW3RpXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMgZ2Vhxb5lcyIscGFzdDoibWHFi2l0ICVzIixzOiJtb2FkZGUgc2VrdW5kZGF0IixtOiJva3RhIG1pbnVodGEiLG1tOiIlZCBtaW51aHRhdCIsaDoib2t0YSBkaWltbXUiLGhoOiIlZCBkaWltbXV0IixkOiJva3RhIGJlYWl2aSIsZGQ6IiVkIGJlYWl2dml0IixNOiJva3RhIG3DoW5udSIsTU06IiVkIG3DoW51dCIseToib2t0YSBqYWhraSIseXk6IiVkIGphZ2l0In0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95OjR9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgic2kiLHttb250aHM6IuC2ouC2seC3gOC3j+C2u+C3kl/gtrTgt5ngtrbgtrvgt4Dgt4/gtrvgt5Jf4La44LeP4La74LeK4Lat4LeUX+C2heC2tOC3iuKAjeC2u+C3muC2veC3il/gtrjgt5Dgtrrgt5Jf4Lai4LeW4Lax4LeSX+C2ouC3luC2veC3kl/gtoXgtpzgt53gt4Pgt4rgtq3gt5Rf4LeD4LeQ4La04LeK4Lat4LeQ4La44LeK4La24La74LeKX+C2lOC2muC3iuC2reC3neC2tuC2u+C3il/gtrHgt5zgt4Dgt5Dgtrjgt4rgtrbgtrvgt4pf4Lav4LeZ4LeD4LeQ4La44LeK4La24La74LeKIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLgtqLgtrFf4La04LeZ4La2X+C2uOC3j+C2u+C3il/gtoXgtrTgt4pf4La44LeQ4La64LeSX+C2ouC3luC2seC3kl/gtqLgt5bgtr3gt5Jf4LaF4Lac4LedX+C3g+C3kOC2tOC3il/gtpTgtprgt4pf4Lax4Lec4LeA4LeQX+C2r+C3meC3g+C3kCIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi4LaJ4La74LeS4Lav4LePX+C3g+C2s+C3lOC2r+C3j1/gtoXgtp/gt4Tgtrvgt5Tgt4Dgt4/gtq/gt49f4La24Lav4LeP4Lav4LePX+C2tuC3iuKAjeC2u+C3hOC3g+C3iuC2tOC2reC3kuC2seC3iuC2r+C3j1/gt4Pgt5Lgtprgt5Tgtrvgt4/gtq/gt49f4LeD4LeZ4Lax4LeD4LeU4La74LeP4Lav4LePIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IuC2ieC2u+C3kl/gt4PgtrPgt5Rf4LaF4LafX+C2tuC2r+C3j1/gtrbgt4rigI3gtrvgt4Rf4LeD4LeS4Laa4LeUX+C3g+C3meC2sSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4LaJX+C3g1/gtoVf4La2X+C2tuC3iuKAjeC2u1/gt4Pgt5Jf4LeD4LeZIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiYSBoOm1tIixMVFM6ImEgaDptbTpzcyIsTDoiWVlZWS9NTS9ERCIsTEw6IllZWVkgTU1NTSBEIixMTEw6IllZWVkgTU1NTSBELCBhIGg6bW0iLExMTEw6IllZWVkgTU1NTSBEIFvgt4Dgt5DgtrHgt5JdIGRkZGQsIGEgaDptbTpzcyJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4LaF4LavXSBMVFvgtqddIixuZXh0RGF5OiJb4LeE4LeZ4LanXSBMVFvgtqddIixuZXh0V2VlazoiZGRkZCBMVFvgtqddIixsYXN0RGF5OiJb4LaK4La64LeaXSBMVFvgtqddIixsYXN0V2VlazoiW+C2tOC3g+C3lOC2nOC3kuC2ul0gZGRkZCBMVFvgtqddIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlc+C2muC3kuC2seC3iiIscGFzdDoiJXPgtprgtqcg4La04LeZ4La7IixzOiLgtq3gtq3gt4rgtrTgtrsg4Laa4LeS4LeE4LeS4La04La6IixtOiLgtrjgt5LgtrHgt5Lgtq3gt4rgtq3gt5Tgt4AiLG1tOiLgtrjgt5LgtrHgt5Lgtq3gt4rgtq3gt5QgJWQiLGg6IuC2tOC3kOC2uiIsaGg6IuC2tOC3kOC2uiAlZCIsZDoi4Lav4LeS4Lax4La6IixkZDoi4Lav4LeS4LaxICVkIixNOiLgtrjgt4/gt4PgtroiLE1NOiLgtrjgt4/gt4MgJWQiLHk6IuC3gOC3g+C2uyIseXk6IuC3gOC3g+C2uyAlZCJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfSDgt4Dgt5DgtrHgt5IvLG9yZGluYWw6ZnVuY3Rpb24odCl7cmV0dXJuIHQrIiDgt4Dgt5DgtrHgt5IifSxtZXJpZGllbVBhcnNlOi/gtrTgt5ngtrsg4LeA4La74LeUfOC2tOC3g+C3iiDgt4Dgtrvgt5R84La04LeZLuC3gHzgtrQu4LeALi8saXNQTTpmdW5jdGlvbih0KXtyZXR1cm4i4La0LuC3gC4iPT09dHx8IuC2tOC3g+C3iiDgt4Dgtrvgt5QiPT09dH0sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PjExP2k/IuC2tC7gt4AuIjoi4La04LeD4LeKIOC3gOC2u+C3lCI6aT8i4La04LeZLuC3gC4iOiLgtrTgt5ngtrsg4LeA4La74LeUIn19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCl7cmV0dXJuIHQ+MSYmdDw1fWZ1bmN0aW9uIGkodCxpLG4scil7dmFyIHM9dCsiICI7c3dpdGNoKG4pe2Nhc2UicyI6cmV0dXJuIGl8fHI/InDDoXIgc2Vrw7puZCI6InDDoXIgc2VrdW5kYW1pIjtjYXNlIm0iOnJldHVybiBpPyJtaW7DunRhIjpyPyJtaW7DunR1IjoibWluw7p0b3UiO2Nhc2UibW0iOnJldHVybiBpfHxyP3MrKGUodCk/Im1pbsO6dHkiOiJtaW7DunQiKTpzKyJtaW7DunRhbWkiO2Nhc2UiaCI6cmV0dXJuIGk/ImhvZGluYSI6cj8iaG9kaW51IjoiaG9kaW5vdSI7Y2FzZSJoaCI6cmV0dXJuIGl8fHI/cysoZSh0KT8iaG9kaW55IjoiaG9kw61uIik6cysiaG9kaW5hbWkiO2Nhc2UiZCI6cmV0dXJuIGl8fHI/ImRlxYgiOiJkxYhvbSI7Y2FzZSJkZCI6cmV0dXJuIGl8fHI/cysoZSh0KT8iZG5pIjoiZG7DrSIpOnMrImTFiGFtaSI7Y2FzZSJNIjpyZXR1cm4gaXx8cj8ibWVzaWFjIjoibWVzaWFjb20iO2Nhc2UiTU0iOnJldHVybiBpfHxyP3MrKGUodCk/Im1lc2lhY2UiOiJtZXNpYWNvdiIpOnMrIm1lc2lhY21pIjtjYXNlInkiOnJldHVybiBpfHxyPyJyb2siOiJyb2tvbSI7Y2FzZSJ5eSI6cmV0dXJuIGl8fHI/cysoZSh0KT8icm9reSI6InJva292Iik6cysicm9rbWkifX12YXIgbj0iamFudcOhcl9mZWJydcOhcl9tYXJlY19hcHLDrWxfbcOhal9qw7puX2rDumxfYXVndXN0X3NlcHRlbWJlcl9va3TDs2Jlcl9ub3ZlbWJlcl9kZWNlbWJlciIuc3BsaXQoIl8iKSxyPSJqYW5fZmViX21hcl9hcHJfbcOhal9qw7puX2rDumxfYXVnX3NlcF9va3Rfbm92X2RlYyIuc3BsaXQoIl8iKSxzPXQuZGVmaW5lTG9jYWxlKCJzayIse21vbnRoczpuLG1vbnRoc1Nob3J0OnIsd2Vla2RheXM6Im5lZGXEvmFfcG9uZGVsb2tfdXRvcm9rX3N0cmVkYV/FoXR2cnRva19waWF0b2tfc29ib3RhIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6Im5lX3BvX3V0X3N0X8WhdF9waV9zbyIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoibmVfcG9fdXRfc3RfxaF0X3BpX3NvIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSDptbSIsTFRTOiJIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRC4gTU1NTSBZWVlZIixMTEw6IkQuIE1NTU0gWVlZWSBIOm1tIixMTExMOiJkZGRkIEQuIE1NTU0gWVlZWSBIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltkbmVzIG9dIExUIixuZXh0RGF5OiJbemFqdHJhIG9dIExUIixuZXh0V2VlazpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLmRheSgpKXtjYXNlIDA6cmV0dXJuIlt2IG5lZGXEvnUgb10gTFQiO2Nhc2UgMTpjYXNlIDI6cmV0dXJuIlt2XSBkZGRkIFtvXSBMVCI7Y2FzZSAzOnJldHVybiJbdiBzdHJlZHUgb10gTFQiO2Nhc2UgNDpyZXR1cm4iW3ZvIMWhdHZydG9rIG9dIExUIjtjYXNlIDU6cmV0dXJuIlt2IHBpYXRvayBvXSBMVCI7Y2FzZSA2OnJldHVybiJbdiBzb2JvdHUgb10gTFQifX0sbGFzdERheToiW3bEjWVyYSBvXSBMVCIsbGFzdFdlZWs6ZnVuY3Rpb24oKXtzd2l0Y2godGhpcy5kYXkoKSl7Y2FzZSAwOnJldHVybiJbbWludWzDuiBuZWRlxL51IG9dIExUIjtjYXNlIDE6Y2FzZSAyOnJldHVybiJbbWludWzDvV0gZGRkZCBbb10gTFQiO2Nhc2UgMzpyZXR1cm4iW21pbnVsw7ogc3RyZWR1IG9dIExUIjtjYXNlIDQ6Y2FzZSA1OnJldHVybiJbbWludWzDvV0gZGRkZCBbb10gTFQiO2Nhc2UgNjpyZXR1cm4iW21pbnVsw7ogc29ib3R1IG9dIExUIn19LHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6InphICVzIixwYXN0OiJwcmVkICVzIixzOmksbTppLG1tOmksaDppLGhoOmksZDppLGRkOmksTTppLE1NOmkseTppLHl5Oml9LG9yZGluYWxQYXJzZTovXGR7MSwyfVwuLyxvcmRpbmFsOiIlZC4iLHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBzfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZSh0LGUsaSxuKXt2YXIgcj10KyIgIjtzd2l0Y2goaSl7Y2FzZSJzIjpyZXR1cm4gZXx8bj8ibmVrYWogc2VrdW5kIjoibmVrYWogc2VrdW5kYW1pIjtjYXNlIm0iOnJldHVybiBlPyJlbmEgbWludXRhIjoiZW5vIG1pbnV0byI7Y2FzZSJtbSI6cmV0dXJuIHIrPTE9PT10P2U/Im1pbnV0YSI6Im1pbnV0byI6Mj09PXQ/ZXx8bj8ibWludXRpIjoibWludXRhbWEiOnQ8NT9lfHxuPyJtaW51dGUiOiJtaW51dGFtaSI6ZXx8bj8ibWludXQiOiJtaW51dGFtaSI7Y2FzZSJoIjpyZXR1cm4gZT8iZW5hIHVyYSI6ImVubyB1cm8iO2Nhc2UiaGgiOnJldHVybiByKz0xPT09dD9lPyJ1cmEiOiJ1cm8iOjI9PT10P2V8fG4/InVyaSI6InVyYW1hIjp0PDU/ZXx8bj8idXJlIjoidXJhbWkiOmV8fG4/InVyIjoidXJhbWkiO2Nhc2UiZCI6cmV0dXJuIGV8fG4/ImVuIGRhbiI6ImVuaW0gZG5lbSI7Y2FzZSJkZCI6cmV0dXJuIHIrPTE9PT10P2V8fG4/ImRhbiI6ImRuZW0iOjI9PT10P2V8fG4/ImRuaSI6ImRuZXZvbWEiOmV8fG4/ImRuaSI6ImRuZXZpIjtjYXNlIk0iOnJldHVybiBlfHxuPyJlbiBtZXNlYyI6ImVuaW0gbWVzZWNlbSI7Y2FzZSJNTSI6cmV0dXJuIHIrPTE9PT10P2V8fG4/Im1lc2VjIjoibWVzZWNlbSI6Mj09PXQ/ZXx8bj8ibWVzZWNhIjoibWVzZWNlbWEiOnQ8NT9lfHxuPyJtZXNlY2UiOiJtZXNlY2kiOmV8fG4/Im1lc2VjZXYiOiJtZXNlY2kiO2Nhc2UieSI6cmV0dXJuIGV8fG4/ImVubyBsZXRvIjoiZW5pbSBsZXRvbSI7Y2FzZSJ5eSI6cmV0dXJuIHIrPTE9PT10P2V8fG4/ImxldG8iOiJsZXRvbSI6Mj09PXQ/ZXx8bj8ibGV0aSI6ImxldG9tYSI6dDw1P2V8fG4/ImxldGEiOiJsZXRpIjplfHxuPyJsZXQiOiJsZXRpIn19dmFyIGk9dC5kZWZpbmVMb2NhbGUoInNsIix7bW9udGhzOiJqYW51YXJfZmVicnVhcl9tYXJlY19hcHJpbF9tYWpfanVuaWpfanVsaWpfYXZndXN0X3NlcHRlbWJlcl9va3RvYmVyX25vdmVtYmVyX2RlY2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJqYW4uX2ZlYi5fbWFyLl9hcHIuX21hai5fanVuLl9qdWwuX2F2Zy5fc2VwLl9va3QuX25vdi5fZGVjLiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoibmVkZWxqYV9wb25lZGVsamVrX3RvcmVrX3NyZWRhX8SNZXRydGVrX3BldGVrX3NvYm90YSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJuZWQuX3Bvbi5fdG9yLl9zcmUuX8SNZXQuX3BldC5fc29iLiIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoibmVfcG9fdG9fc3JfxI1lX3BlX3NvIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSDptbSIsTFRTOiJIOm1tOnNzIixMOiJERC4gTU0uIFlZWVkiLExMOiJELiBNTU1NIFlZWVkiLExMTDoiRC4gTU1NTSBZWVlZIEg6bW0iLExMTEw6ImRkZGQsIEQuIE1NTU0gWVlZWSBIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltkYW5lcyBvYl0gTFQiLG5leHREYXk6IltqdXRyaSBvYl0gTFQiLG5leHRXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpyZXR1cm4iW3ZdIFtuZWRlbGpvXSBbb2JdIExUIjtjYXNlIDM6cmV0dXJuIlt2XSBbc3JlZG9dIFtvYl0gTFQiO2Nhc2UgNjpyZXR1cm4iW3ZdIFtzb2JvdG9dIFtvYl0gTFQiO2Nhc2UgMTpjYXNlIDI6Y2FzZSA0OmNhc2UgNTpyZXR1cm4iW3ZdIGRkZGQgW29iXSBMVCJ9fSxsYXN0RGF5OiJbdsSNZXJhaiBvYl0gTFQiLGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpyZXR1cm4iW3ByZWrFoW5qb10gW25lZGVsam9dIFtvYl0gTFQiO2Nhc2UgMzpyZXR1cm4iW3ByZWrFoW5qb10gW3NyZWRvXSBbb2JdIExUIjtjYXNlIDY6cmV0dXJuIltwcmVqxaFuam9dIFtzb2JvdG9dIFtvYl0gTFQiO2Nhc2UgMTpjYXNlIDI6Y2FzZSA0OmNhc2UgNTpyZXR1cm4iW3ByZWrFoW5qaV0gZGRkZCBbb2JdIExUIn19LHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IsSNZXogJXMiLHBhc3Q6InByZWQgJXMiLHM6ZSxtOmUsbW06ZSxoOmUsaGg6ZSxkOmUsZGQ6ZSxNOmUsTU06ZSx5OmUseXk6ZX0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9XC4vLG9yZGluYWw6IiVkLiIsd2Vlazp7ZG93OjEsZG95Ojd9fSk7cmV0dXJuIGl9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgic3EiLHttb250aHM6IkphbmFyX1Noa3VydF9NYXJzX1ByaWxsX01hal9RZXJzaG9yX0tvcnJpa19HdXNodF9TaHRhdG9yX1RldG9yX07Dq250b3JfRGhqZXRvciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX1Noa19NYXJfUHJpX01hal9RZXJfS29yX0d1c19TaHRfVGV0X07Dq25fRGhqIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJFIERpZWxfRSBIw6tuw6tfRSBNYXJ0w6tfRSBNw6tya3Vyw6tfRSBFbmp0ZV9FIFByZW10ZV9FIFNodHVuw6siLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoiRGllX0jDq25fTWFyX03Dq3JfRW5qX1ByZV9TaHQiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkRfSF9NYV9Nw6tfRV9QX1NoIi5zcGxpdCgiXyIpLG1lcmlkaWVtUGFyc2U6L1BEfE1ELyxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybiJNIj09PXQuY2hhckF0KDApfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/IlBEIjoiTUQifSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC9NTS9ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltTb3QgbsOrXSBMVCIsbmV4dERheToiW05lc8OrciBuw6tdIExUIixuZXh0V2VlazoiZGRkZCBbbsOrXSBMVCIsbGFzdERheToiW0RqZSBuw6tdIExUIixsYXN0V2VlazoiZGRkZCBbZSBrYWx1YXIgbsOrXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToibsOrICVzIixwYXN0OiIlcyBtw6sgcGFyw6siLHM6ImRpc2Egc2Vrb25kYSIsbToibmrDqyBtaW51dMOrIixtbToiJWQgbWludXRhIixoOiJuasOrIG9yw6siLGhoOiIlZCBvcsOrIixkOiJuasOrIGRpdMOrIixkZDoiJWQgZGl0w6siLE06Im5qw6sgbXVhaiIsTU06IiVkIG11YWoiLHk6Im5qw6sgdml0Iix5eToiJWQgdml0ZSJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfVwuLyxvcmRpbmFsOiIlZC4iLHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9e3dvcmRzOnttOlsiamVkYW4gbWludXQiLCJqZWRuZSBtaW51dGUiXSxtbTpbIm1pbnV0IiwibWludXRlIiwibWludXRhIl0saDpbImplZGFuIHNhdCIsImplZG5vZyBzYXRhIl0saGg6WyJzYXQiLCJzYXRhIiwic2F0aSJdLGRkOlsiZGFuIiwiZGFuYSIsImRhbmEiXSxNTTpbIm1lc2VjIiwibWVzZWNhIiwibWVzZWNpIl0seXk6WyJnb2RpbmEiLCJnb2RpbmUiLCJnb2RpbmEiXX0sY29ycmVjdEdyYW1tYXRpY2FsQ2FzZTpmdW5jdGlvbih0LGUpe3JldHVybiAxPT09dD9lWzBdOnQ+PTImJnQ8PTQ/ZVsxXTplWzJdfSx0cmFuc2xhdGU6ZnVuY3Rpb24odCxpLG4pe3ZhciByPWUud29yZHNbbl07cmV0dXJuIDE9PT1uLmxlbmd0aD9pP3JbMF06clsxXTp0KyIgIitlLmNvcnJlY3RHcmFtbWF0aWNhbENhc2UodCxyKX19LGk9dC5kZWZpbmVMb2NhbGUoInNyIix7bW9udGhzOlsiamFudWFyIiwiZmVicnVhciIsIm1hcnQiLCJhcHJpbCIsIm1haiIsImp1biIsImp1bCIsImF2Z3VzdCIsInNlcHRlbWJhciIsIm9rdG9iYXIiLCJub3ZlbWJhciIsImRlY2VtYmFyIl0sbW9udGhzU2hvcnQ6WyJqYW4uIiwiZmViLiIsIm1hci4iLCJhcHIuIiwibWFqIiwianVuIiwianVsIiwiYXZnLiIsInNlcC4iLCJva3QuIiwibm92LiIsImRlYy4iXSx3ZWVrZGF5czpbIm5lZGVsamEiLCJwb25lZGVsamFrIiwidXRvcmFrIiwic3JlZGEiLCLEjWV0dnJ0YWsiLCJwZXRhayIsInN1Ym90YSJdLHdlZWtkYXlzU2hvcnQ6WyJuZWQuIiwicG9uLiIsInV0by4iLCJzcmUuIiwixI1ldC4iLCJwZXQuIiwic3ViLiJdLHdlZWtkYXlzTWluOlsibmUiLCJwbyIsInV0Iiwic3IiLCLEjWUiLCJwZSIsInN1Il0sbG9uZ0RhdGVGb3JtYXQ6e0xUOiJIOm1tIixMVFM6Ikg6bW06c3MiLEw6IkRELiBNTS4gWVlZWSIsTEw6IkQuIE1NTU0gWVlZWSIsTExMOiJELiBNTU1NIFlZWVkgSDptbSIsTExMTDoiZGRkZCwgRC4gTU1NTSBZWVlZIEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW2RhbmFzIHVdIExUIixuZXh0RGF5OiJbc3V0cmEgdV0gTFQiLG5leHRXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpyZXR1cm4iW3VdIFtuZWRlbGp1XSBbdV0gTFQiO2Nhc2UgMzpyZXR1cm4iW3VdIFtzcmVkdV0gW3VdIExUIjtjYXNlIDY6cmV0dXJuIlt1XSBbc3Vib3R1XSBbdV0gTFQiO2Nhc2UgMTpjYXNlIDI6Y2FzZSA0OmNhc2UgNTpyZXR1cm4iW3VdIGRkZGQgW3VdIExUIn19LGxhc3REYXk6IltqdcSNZSB1XSBMVCIsbGFzdFdlZWs6ZnVuY3Rpb24oKXt2YXIgdD1bIltwcm/FoWxlXSBbbmVkZWxqZV0gW3VdIExUIiwiW3Byb8WhbG9nXSBbcG9uZWRlbGprYV0gW3VdIExUIiwiW3Byb8WhbG9nXSBbdXRvcmthXSBbdV0gTFQiLCJbcHJvxaFsZV0gW3NyZWRlXSBbdV0gTFQiLCJbcHJvxaFsb2ddIFvEjWV0dnJ0a2FdIFt1XSBMVCIsIltwcm/FoWxvZ10gW3BldGthXSBbdV0gTFQiLCJbcHJvxaFsZV0gW3N1Ym90ZV0gW3VdIExUIl07cmV0dXJuIHRbdGhpcy5kYXkoKV19LHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6InphICVzIixwYXN0OiJwcmUgJXMiLHM6Im5la29saWtvIHNla3VuZGkiLG06ZS50cmFuc2xhdGUsbW06ZS50cmFuc2xhdGUsaDplLnRyYW5zbGF0ZSxoaDplLnRyYW5zbGF0ZSxkOiJkYW4iLGRkOmUudHJhbnNsYXRlLE06Im1lc2VjIixNTTplLnRyYW5zbGF0ZSx5OiJnb2RpbnUiLHl5OmUudHJhbnNsYXRlfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6N319KTtyZXR1cm4gaX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXt3b3Jkczp7bTpbItGY0LXQtNCw0L0g0LzQuNC90YPRgiIsItGY0LXQtNC90LUg0LzQuNC90YPRgtC1Il0sbW06WyLQvNC40L3Rg9GCIiwi0LzQuNC90YPRgtC1Iiwi0LzQuNC90YPRgtCwIl0saDpbItGY0LXQtNCw0L0g0YHQsNGCIiwi0ZjQtdC00L3QvtCzINGB0LDRgtCwIl0saGg6WyLRgdCw0YIiLCLRgdCw0YLQsCIsItGB0LDRgtC4Il0sZGQ6WyLQtNCw0L0iLCLQtNCw0L3QsCIsItC00LDQvdCwIl0sTU06WyLQvNC10YHQtdGGIiwi0LzQtdGB0LXRhtCwIiwi0LzQtdGB0LXRhtC4Il0seXk6WyLQs9C+0LTQuNC90LAiLCLQs9C+0LTQuNC90LUiLCLQs9C+0LTQuNC90LAiXX0sY29ycmVjdEdyYW1tYXRpY2FsQ2FzZTpmdW5jdGlvbih0LGUpe3JldHVybiAxPT09dD9lWzBdOnQ+PTImJnQ8PTQ/ZVsxXTplWzJdfSx0cmFuc2xhdGU6ZnVuY3Rpb24odCxpLG4pe3ZhciByPWUud29yZHNbbl07cmV0dXJuIDE9PT1uLmxlbmd0aD9pP3JbMF06clsxXTp0KyIgIitlLmNvcnJlY3RHcmFtbWF0aWNhbENhc2UodCxyKX19LGk9dC5kZWZpbmVMb2NhbGUoInNyLWN5cmwiLHttb250aHM6WyLRmNCw0L3Rg9Cw0YAiLCLRhNC10LHRgNGD0LDRgCIsItC80LDRgNGCIiwi0LDQv9GA0LjQuyIsItC80LDRmCIsItGY0YPQvSIsItGY0YPQuyIsItCw0LLQs9GD0YHRgiIsItGB0LXQv9GC0LXQvNCx0LDRgCIsItC+0LrRgtC+0LHQsNGAIiwi0L3QvtCy0LXQvNCx0LDRgCIsItC00LXRhtC10LzQsdCw0YAiXSxtb250aHNTaG9ydDpbItGY0LDQvS4iLCLRhNC10LEuIiwi0LzQsNGALiIsItCw0L/RgC4iLCLQvNCw0ZgiLCLRmNGD0L0iLCLRmNGD0LsiLCLQsNCy0LMuIiwi0YHQtdC/LiIsItC+0LrRgi4iLCLQvdC+0LIuIiwi0LTQtdGGLiJdLHdlZWtkYXlzOlsi0L3QtdC00LXRmdCwIiwi0L/QvtC90LXQtNC10ZnQsNC6Iiwi0YPRgtC+0YDQsNC6Iiwi0YHRgNC10LTQsCIsItGH0LXRgtCy0YDRgtCw0LoiLCLQv9C10YLQsNC6Iiwi0YHRg9Cx0L7RgtCwIl0sd2Vla2RheXNTaG9ydDpbItC90LXQtC4iLCLQv9C+0L0uIiwi0YPRgtC+LiIsItGB0YDQtS4iLCLRh9C10YIuIiwi0L/QtdGCLiIsItGB0YPQsS4iXSx3ZWVrZGF5c01pbjpbItC90LUiLCLQv9C+Iiwi0YPRgiIsItGB0YAiLCLRh9C1Iiwi0L/QtSIsItGB0YMiXSxsb25nRGF0ZUZvcm1hdDp7TFQ6Ikg6bW0iLExUUzoiSDptbTpzcyIsTDoiREQuIE1NLiBZWVlZIixMTDoiRC4gTU1NTSBZWVlZIixMTEw6IkQuIE1NTU0gWVlZWSBIOm1tIixMTExMOiJkZGRkLCBELiBNTU1NIFlZWVkgSDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb0LTQsNC90LDRgSDRg10gTFQiLG5leHREYXk6IlvRgdGD0YLRgNCwINGDXSBMVCIsbmV4dFdlZWs6ZnVuY3Rpb24oKXtzd2l0Y2godGhpcy5kYXkoKSl7Y2FzZSAwOnJldHVybiJb0YNdIFvQvdC10LTQtdGZ0YNdIFvRg10gTFQiO2Nhc2UgMzpyZXR1cm4iW9GDXSBb0YHRgNC10LTRg10gW9GDXSBMVCI7Y2FzZSA2OnJldHVybiJb0YNdIFvRgdGD0LHQvtGC0YNdIFvRg10gTFQiO2Nhc2UgMTpjYXNlIDI6Y2FzZSA0OmNhc2UgNTpyZXR1cm4iW9GDXSBkZGRkIFvRg10gTFQifX0sbGFzdERheToiW9GY0YPRh9C1INGDXSBMVCIsbGFzdFdlZWs6ZnVuY3Rpb24oKXt2YXIgdD1bIlvQv9GA0L7RiNC70LVdIFvQvdC10LTQtdGZ0LVdIFvRg10gTFQiLCJb0L/RgNC+0YjQu9C+0LNdIFvQv9C+0L3QtdC00LXRmdC60LBdIFvRg10gTFQiLCJb0L/RgNC+0YjQu9C+0LNdIFvRg9GC0L7RgNC60LBdIFvRg10gTFQiLCJb0L/RgNC+0YjQu9C1XSBb0YHRgNC10LTQtV0gW9GDXSBMVCIsIlvQv9GA0L7RiNC70L7Qs10gW9GH0LXRgtCy0YDRgtC60LBdIFvRg10gTFQiLCJb0L/RgNC+0YjQu9C+0LNdIFvQv9C10YLQutCwXSBb0YNdIExUIiwiW9C/0YDQvtGI0LvQtV0gW9GB0YPQsdC+0YLQtV0gW9GDXSBMVCJdO3JldHVybiB0W3RoaXMuZGF5KCldfSxzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLQt9CwICVzIixwYXN0OiLQv9GA0LUgJXMiLHM6ItC90LXQutC+0LvQuNC60L4g0YHQtdC60YPQvdC00LgiLG06ZS50cmFuc2xhdGUsbW06ZS50cmFuc2xhdGUsaDplLnRyYW5zbGF0ZSxoaDplLnRyYW5zbGF0ZSxkOiLQtNCw0L0iLGRkOmUudHJhbnNsYXRlLE06ItC80LXRgdC10YYiLE1NOmUudHJhbnNsYXRlLHk6ItCz0L7QtNC40L3RgyIseXk6ZS50cmFuc2xhdGV9LG9yZGluYWxQYXJzZTovXGR7MSwyfVwuLyxvcmRpbmFsOiIlZC4iLHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBpfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoInN2Iix7bW9udGhzOiJqYW51YXJpX2ZlYnJ1YXJpX21hcnNfYXByaWxfbWFqX2p1bmlfanVsaV9hdWd1c3RpX3NlcHRlbWJlcl9va3RvYmVyX25vdmVtYmVyX2RlY2VtYmVyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJqYW5fZmViX21hcl9hcHJfbWFqX2p1bl9qdWxfYXVnX3NlcF9va3Rfbm92X2RlYyIuc3BsaXQoIl8iKSx3ZWVrZGF5czoic8O2bmRhZ19tw6VuZGFnX3Rpc2RhZ19vbnNkYWdfdG9yc2RhZ19mcmVkYWdfbMO2cmRhZyIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJzw7ZuX23DpW5fdGlzX29uc190b3JfZnJlX2zDtnIiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46InPDtl9tw6VfdGlfb25fdG9fZnJfbMO2Ii5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IllZWVktTU0tREQiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCBEIE1NTU0gWVlZWSBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJbSWRhZ10gTFQiLG5leHREYXk6IltJbW9yZ29uXSBMVCIsbGFzdERheToiW0lnw6VyXSBMVCIsbmV4dFdlZWs6IltQw6VdIGRkZGQgTFQiLGxhc3RXZWVrOiJbSV0gZGRkZFtzXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToib20gJXMiLHBhc3Q6ImbDtnIgJXMgc2VkYW4iLHM6Im7DpWdyYSBzZWt1bmRlciIsbToiZW4gbWludXQiLG1tOiIlZCBtaW51dGVyIixoOiJlbiB0aW1tZSIsaGg6IiVkIHRpbW1hciIsZDoiZW4gZGFnIixkZDoiJWQgZGFnYXIiLE06ImVuIG3DpW5hZCIsTU06IiVkIG3DpW5hZGVyIix5OiJldHQgw6VyIix5eToiJWQgw6VyIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9KGV8YSkvLG9yZGluYWw6ZnVuY3Rpb24odCl7dmFyIGU9dCUxMCxpPTE9PT1+fih0JTEwMC8xMCk/ImUiOjE9PT1lPyJhIjoyPT09ZT8iYSI6ImUiO3JldHVybiB0K2l9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoInN3Iix7bW9udGhzOiJKYW51YXJpX0ZlYnJ1YXJpX01hY2hpX0FwcmlsaV9NZWlfSnVuaV9KdWxhaV9BZ29zdGlfU2VwdGVtYmFfT2t0b2JhX05vdmVtYmFfRGVzZW1iYSIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX0ZlYl9NYWNfQXByX01laV9KdW5fSnVsX0Fnb19TZXBfT2t0X05vdl9EZXMiLnNwbGl0KCJfIiksd2Vla2RheXM6Ikp1bWFwaWxpX0p1bWF0YXR1X0p1bWFubmVfSnVtYXRhbm9fQWxoYW1pc2lfSWp1bWFhX0p1bWFtb3NpIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IkpwbF9KdGF0X0pubmVfSnRhbl9BbGhfSWptX0ptb3MiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkoyX0ozX0o0X0o1X0FsX0lqX0oxIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW2xlbyBzYWFdIExUIixuZXh0RGF5OiJba2VzaG8gc2FhXSBMVCIsbmV4dFdlZWs6Ilt3aWtpIGlqYXlvXSBkZGRkIFtzYWF0XSBMVCIsbGFzdERheToiW2phbmFdIExUIixsYXN0V2VlazoiW3dpa2kgaWxpeW9waXRhXSBkZGRkIFtzYWF0XSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXMgYmFhZGF5ZSIscGFzdDoidG9rZWEgJXMiLHM6ImhpdmkgcHVuZGUiLG06ImRha2lrYSBtb2phIixtbToiZGFraWthICVkIixoOiJzYWEgbGltb2phIixoaDoibWFzYWEgJWQiLGQ6InNpa3UgbW9qYSIsZGQ6Im1hc2lrdSAlZCIsTToibXdlemkgbW1vamEiLE1NOiJtaWV6aSAlZCIseToibXdha2EgbW1vamEiLHl5OiJtaWFrYSAlZCJ9LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9ezE6IuCvpyIsMjoi4K+oIiwzOiLgr6kiLDQ6IuCvqiIsNToi4K+rIiw2OiLgr6wiLDc6IuCvrSIsODoi4K+uIiw5OiLgr68iLDA6IuCvpiJ9LGk9eyLgr6ciOiIxIiwi4K+oIjoiMiIsIuCvqSI6IjMiLCLgr6oiOiI0Iiwi4K+rIjoiNSIsIuCvrCI6IjYiLCLgr60iOiI3Iiwi4K+uIjoiOCIsIuCvryI6IjkiLCLgr6YiOiIwIn0sbj10LmRlZmluZUxvY2FsZSgidGEiLHttb250aHM6IuCunOCuqeCuteCusOCuv1/grqrgrr/grqrgr43grrDgrrXgrrDgrr9f4K6u4K6+4K6w4K+N4K6a4K+NX+Cuj+CuquCvjeCusOCusuCvjV/grq7gr4df4K6c4K+C4K6p4K+NX+CunOCvguCusuCviF/grobgrpXgrrjgr43grp/gr41f4K6a4K+G4K6q4K+N4K6f4K+G4K6u4K+N4K6q4K6w4K+NX+CuheCuleCvjeCun+Cvh+CuvuCuquCusOCvjV/grqjgrrXgrq7gr43grqrgrrDgr41f4K6f4K6/4K6a4K6u4K+N4K6q4K6w4K+NIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiLgrpzgrqngrrXgrrDgrr9f4K6q4K6/4K6q4K+N4K6w4K614K6w4K6/X+CuruCuvuCusOCvjeCumuCvjV/gro/grqrgr43grrDgrrLgr41f4K6u4K+HX+CunOCvguCuqeCvjV/grpzgr4LgrrLgr4hf4K6G4K6V4K644K+N4K6f4K+NX+CumuCvhuCuquCvjeCun+CvhuCuruCvjeCuquCusOCvjV/groXgrpXgr43grp/gr4fgrr7grqrgrrDgr41f4K6o4K614K6u4K+N4K6q4K6w4K+NX+Cun+Cuv+CumuCuruCvjeCuquCusOCvjSIuc3BsaXQoIl8iKSx3ZWVrZGF5czoi4K6e4K6+4K6v4K6/4K6x4K+N4K6x4K+B4K6V4K+N4K6V4K6/4K604K6u4K+IX+CupOCuv+CumeCvjeCuleCun+CvjeCuleCuv+CutOCuruCviF/grprgr4bgrrXgr43grrXgrr7grq/gr43grpXgrr/grrTgrq7gr4hf4K6q4K+B4K6k4K6p4K+N4K6V4K6/4K604K6u4K+IX+CuteCuv+Cur+CuvuCutOCuleCvjeCuleCuv+CutOCuruCviF/grrXgr4bgrrPgr43grrPgrr/grpXgr43grpXgrr/grrTgrq7gr4hf4K6a4K6p4K6/4K6V4K+N4K6V4K6/4K604K6u4K+IIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IuCunuCuvuCur+Cuv+CuseCvgV/grqTgrr/grpngr43grpXgrrPgr41f4K6a4K+G4K614K+N4K614K6+4K6v4K+NX+CuquCvgeCupOCuqeCvjV/grrXgrr/grq/grr7grrTgrqngr41f4K614K+G4K6z4K+N4K6z4K6/X+CumuCuqeCuvyIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi4K6e4K6+X+CupOCuv1/grprgr4Zf4K6q4K+BX+CuteCuv1/grrXgr4Zf4K6aIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSwgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZLCBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb4K6H4K6p4K+N4K6x4K+BXSBMVCIsbmV4dERheToiW+CuqOCuvuCus+CviF0gTFQiLG5leHRXZWVrOiJkZGRkLCBMVCIsbGFzdERheToiW+CuqOCvh+CuseCvjeCuseCvgV0gTFQiLGxhc3RXZWVrOiJb4K6V4K6f4K6o4K+N4K6kIOCuteCuvuCusOCuruCvjV0gZGRkZCwgTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6IiVzIOCuh+CusuCvjSIscGFzdDoiJXMg4K6u4K+B4K6p4K+NIixzOiLgrpLgrrDgr4Eg4K6a4K6/4K6yIOCuteCuv+CuqOCuvuCun+Cuv+CuleCus+CvjSIsbToi4K6S4K6w4K+BIOCuqOCuv+CuruCuv+Cun+CuruCvjSIsbW06IiVkIOCuqOCuv+CuruCuv+Cun+CumeCvjeCuleCus+CvjSIsaDoi4K6S4K6w4K+BIOCuruCuo+CuvyDgrqjgr4fgrrDgrq7gr40iLGhoOiIlZCDgrq7grqPgrr8g4K6o4K+H4K6w4K6u4K+NIixkOiLgrpLgrrDgr4Eg4K6o4K6+4K6z4K+NIixkZDoiJWQg4K6o4K6+4K6f4K+N4K6V4K6z4K+NIixNOiLgrpLgrrDgr4Eg4K6u4K6+4K6k4K6u4K+NIixNTToiJWQg4K6u4K6+4K6k4K6Z4K+N4K6V4K6z4K+NIix5OiLgrpLgrrDgr4Eg4K614K6w4K+B4K6f4K6u4K+NIix5eToiJWQg4K6G4K6j4K+N4K6f4K+B4K6V4K6z4K+NIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ94K614K6k4K+BLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3JldHVybiB0KyLgrrXgrqTgr4EifSxwcmVwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9b4K+n4K+o4K+p4K+q4K+r4K+s4K+t4K+u4K+v4K+mXS9nLGZ1bmN0aW9uKHQpe3JldHVybiBpW3RdfSl9LHBvc3Rmb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXGQvZyxmdW5jdGlvbih0KXtyZXR1cm4gZVt0XX0pfSxtZXJpZGllbVBhcnNlOi/grq/grr7grq7grq7gr4184K614K+I4K6V4K6x4K+IfOCuleCuvuCusuCviHzgrqjgrqPgr43grqrgrpXgrrLgr4184K6O4K6x4K+N4K6q4K6+4K6f4K+BfOCuruCuvuCusuCviC8sbWVyaWRpZW06ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PDI/IiDgrq/grr7grq7grq7gr40iOnQ8Nj8iIOCuteCviOCuleCuseCviCI6dDwxMD8iIOCuleCuvuCusuCviCI6dDwxND8iIOCuqOCuo+CvjeCuquCuleCusuCvjSI6dDwxOD8iIOCujuCuseCvjeCuquCuvuCun+CvgSI6dDwyMj8iIOCuruCuvuCusuCviCI6IiDgrq/grr7grq7grq7gr40ifSxtZXJpZGllbUhvdXI6ZnVuY3Rpb24odCxlKXtyZXR1cm4gMTI9PT10JiYodD0wKSwi4K6v4K6+4K6u4K6u4K+NIj09PWU/dDwyP3Q6dCsxMjoi4K614K+I4K6V4K6x4K+IIj09PWV8fCLgrpXgrr7grrLgr4giPT09ZT90OiLgrqjgrqPgr43grqrgrpXgrrLgr40iPT09ZSYmdD49MTA/dDp0KzEyfSx3ZWVrOntkb3c6MCxkb3k6Nn19KTtyZXR1cm4gbn0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJ0ZSIse21vbnRoczoi4LCc4LCo4LC14LCw4LC/X+Cwq+Cwv+CwrOCxjeCwsOCwteCwsOCwv1/gsK7gsL7gsLDgsY3gsJrgsL9f4LCP4LCq4LGN4LCw4LC/4LCy4LGNX+CwruCxh1/gsJzgsYLgsKjgsY1f4LCc4LGC4LCy4LGG4LGWX+CwhuCwl+CwuOCxjeCwn+CxgV/gsLjgsYbgsKrgsY3gsJ/gsYbgsILgsKzgsLDgsY1f4LCF4LCV4LGN4LCf4LGL4LCs4LCw4LGNX+CwqOCwteCwguCwrOCwsOCxjV/gsKHgsL/gsLjgsYbgsILgsKzgsLDgsY0iLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IuCwnOCwqC5f4LCr4LC/4LCs4LGN4LCwLl/gsK7gsL7gsLDgsY3gsJrgsL9f4LCP4LCq4LGN4LCw4LC/Ll/gsK7gsYdf4LCc4LGC4LCo4LGNX+CwnOCxguCwsuCxhuCxll/gsIbgsJcuX+CwuOCxhuCwquCxjS5f4LCF4LCV4LGN4LCf4LGLLl/gsKjgsLUuX+CwoeCwv+CwuOCxhi4iLnNwbGl0KCJfIiksd2Vla2RheXM6IuCwhuCwpuCwv+CwteCwvuCwsOCwgl/gsLjgsYvgsK7gsLXgsL7gsLDgsIJf4LCu4LCC4LCX4LCz4LC14LC+4LCw4LCCX+CwrOCxgeCwp+CwteCwvuCwsOCwgl/gsJfgsYHgsLDgsYHgsLXgsL7gsLDgsIJf4LC24LGB4LCV4LGN4LCw4LC14LC+4LCw4LCCX+CwtuCwqOCwv+CwteCwvuCwsOCwgiIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLgsIbgsKbgsL9f4LC44LGL4LCuX+CwruCwguCwl+Cws1/gsKzgsYHgsKdf4LCX4LGB4LCw4LGBX+CwtuCxgeCwleCxjeCwsF/gsLbgsKjgsL8iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IuCwhl/gsLjgsYtf4LCu4LCCX+CwrOCxgV/gsJfgsYFf4LC24LGBX+CwtiIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkEgaDptbSIsTFRTOiJBIGg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSwgQSBoOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gWVlZWSwgQSBoOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvgsKjgsYfgsKHgsYFdIExUIixuZXh0RGF5OiJb4LCw4LGH4LCq4LGBXSBMVCIsbmV4dFdlZWs6ImRkZGQsIExUIixsYXN0RGF5OiJb4LCo4LC/4LCo4LGN4LCoXSBMVCIsbGFzdFdlZWs6IlvgsJfgsKRdIGRkZGQsIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlcyDgsLLgsYsiLHBhc3Q6IiVzIOCwleCxjeCwsOCwv+CwpOCwgiIsczoi4LCV4LGK4LCo4LGN4LCo4LC/IOCwleCxjeCwt+Cwo+CwvuCwsuCxgSIsbToi4LCS4LCVIOCwqOCwv+CwruCwv+Cwt+CwgiIsbW06IiVkIOCwqOCwv+CwruCwv+Cwt+CwvuCwsuCxgSIsaDoi4LCS4LCVIOCwl+CwguCwnyIsaGg6IiVkIOCwl+CwguCwn+CwsuCxgSIsZDoi4LCS4LCVIOCwsOCxi+CwnOCxgSIsZGQ6IiVkIOCwsOCxi+CwnOCxgeCwsuCxgSIsTToi4LCS4LCVIOCwqOCxhuCwsiIsTU06IiVkIOCwqOCxhuCwsuCwsuCxgSIseToi4LCS4LCVIOCwuOCwguCwteCwpOCxjeCwuOCwsOCwgiIseXk6IiVkIOCwuOCwguCwteCwpOCxjeCwuOCwsOCwvuCwsuCxgSJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfeCwtS8sb3JkaW5hbDoiJWTgsLUiLG1lcmlkaWVtUGFyc2U6L+CwsOCwvuCwpOCxjeCwsOCwv3zgsIngsKbgsK/gsIJ84LCu4LCn4LGN4LCv4LC+4LC54LGN4LCo4LCCfOCwuOCwvuCwr+CwguCwpOCxjeCwsOCwgi8sbWVyaWRpZW1Ib3VyOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIDEyPT09dCYmKHQ9MCksIuCwsOCwvuCwpOCxjeCwsOCwvyI9PT1lP3Q8ND90OnQrMTI6IuCwieCwpuCwr+CwgiI9PT1lP3Q6IuCwruCwp+CxjeCwr+CwvuCwueCxjeCwqOCwgiI9PT1lP3Q+PTEwP3Q6dCsxMjoi4LC44LC+4LCv4LCC4LCk4LGN4LCw4LCCIj09PWU/dCsxMjp2b2lkIDB9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDw0PyLgsLDgsL7gsKTgsY3gsLDgsL8iOnQ8MTA/IuCwieCwpuCwr+CwgiI6dDwxNz8i4LCu4LCn4LGN4LCv4LC+4LC54LGN4LCo4LCCIjp0PDIwPyLgsLjgsL7gsK/gsILgsKTgsY3gsLDgsIIiOiLgsLDgsL7gsKTgsY3gsLDgsL8ifSx3ZWVrOntkb3c6MCxkb3k6Nn19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXQuZGVmaW5lTG9jYWxlKCJ0aCIse21vbnRoczoi4Lih4LiB4Lij4Liy4LiE4LihX+C4geC4uOC4oeC4oOC4suC4nuC4seC4meC4mOC5jF/guKHguLXguJnguLLguITguKFf4LmA4Lih4Lip4Liy4Lii4LiZX+C4nuC4pOC4qeC4oOC4suC4hOC4oV/guKHguLTguJbguLjguJnguLLguKLguJlf4LiB4Lij4LiB4LiO4Liy4LiE4LihX+C4quC4tOC4h+C4q+C4suC4hOC4oV/guIHguLHguJnguKLguLLguKLguJlf4LiV4Li44Lil4Liy4LiE4LihX+C4nuC4pOC4qOC4iOC4tOC4geC4suC4ouC4mV/guJjguLHguJnguKfguLLguITguKEiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IuC4oeC4geC4o+C4sl/guIHguLjguKHguKDguLJf4Lih4Li14LiZ4LiyX+C5gOC4oeC4qeC4sl/guJ7guKTguKnguKDguLJf4Lih4Li04LiW4Li44LiZ4LiyX+C4geC4o+C4geC4juC4sl/guKrguLTguIfguKvguLJf4LiB4Lix4LiZ4Lii4LiyX+C4leC4uOC4peC4sl/guJ7guKTguKjguIjguLTguIHguLJf4LiY4Lix4LiZ4Lin4LiyIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLguK3guLLguJfguLTguJXguKLguYxf4LiI4Lix4LiZ4LiX4Lij4LmMX+C4reC4seC4h+C4hOC4suC4o1/guJ7guLjguJhf4Lie4Lik4Lir4Lix4Liq4Lia4LiU4Li1X+C4qOC4uOC4geC4o+C5jF/guYDguKrguLLguKPguYwiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi4Lit4Liy4LiX4Li04LiV4Lii4LmMX+C4iOC4seC4meC4l+C4o+C5jF/guK3guLHguIfguITguLLguKNf4Lie4Li44LiYX+C4nuC4pOC4q+C4seC4ql/guKjguLjguIHguKPguYxf4LmA4Liq4Liy4Lij4LmMIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLguK3guLIuX+C4iC5f4LitLl/guJ4uX+C4nuC4pC5f4LioLl/guKouIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSCDguJnguLLguKzguLTguIHguLIgbSDguJnguLLguJfguLUiLExUUzoiSCDguJnguLLguKzguLTguIHguLIgbSDguJnguLLguJfguLUgcyDguKfguLTguJnguLLguJfguLUiLEw6IllZWVkvTU0vREQiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSDguYDguKfguKXguLIgSCDguJnguLLguKzguLTguIHguLIgbSDguJnguLLguJfguLUiLExMTEw6IuC4p+C4seC4mWRkZGTguJfguLXguYggRCBNTU1NIFlZWVkg4LmA4Lin4Lil4LiyIEgg4LiZ4Liy4Lis4Li04LiB4LiyIG0g4LiZ4Liy4LiX4Li1In0sbWVyaWRpZW1QYXJzZTov4LiB4LmI4Lit4LiZ4LmA4LiX4Li14LmI4Lii4LiHfOC4q+C4peC4seC4h+C5gOC4l+C4teC5iOC4ouC4hy8saXNQTTpmdW5jdGlvbih0KXtyZXR1cm4i4Lir4Lil4Lix4LiH4LmA4LiX4Li14LmI4Lii4LiHIj09PXR9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDwxMj8i4LiB4LmI4Lit4LiZ4LmA4LiX4Li14LmI4Lii4LiHIjoi4Lir4Lil4Lix4LiH4LmA4LiX4Li14LmI4Lii4LiHIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvguKfguLHguJnguJnguLXguYkg4LmA4Lin4Lil4LiyXSBMVCIsbmV4dERheToiW+C4nuC4o+C4uOC5iOC4h+C4meC4teC5iSDguYDguKfguKXguLJdIExUIixuZXh0V2VlazoiZGRkZFvguKvguJnguYnguLIg4LmA4Lin4Lil4LiyXSBMVCIsbGFzdERheToiW+C5gOC4oeC4t+C5iOC4reC4p+C4suC4meC4meC4teC5iSDguYDguKfguKXguLJdIExUIixsYXN0V2VlazoiW+C4p+C4seC4mV1kZGRkW+C4l+C4teC5iOC5geC4peC5ieC4pyDguYDguKfguKXguLJdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLguK3guLXguIEgJXMiLHBhc3Q6IiVz4LiX4Li14LmI4LmB4Lil4LmJ4LinIixzOiLguYTguKHguYjguIHguLXguYjguKfguLTguJnguLLguJfguLUiLG06IjEg4LiZ4Liy4LiX4Li1IixtbToiJWQg4LiZ4Liy4LiX4Li1IixoOiIxIOC4iuC4seC5iOC4p+C5guC4oeC4hyIsaGg6IiVkIOC4iuC4seC5iOC4p+C5guC4oeC4hyIsZDoiMSDguKfguLHguJkiLGRkOiIlZCDguKfguLHguJkiLE06IjEg4LmA4LiU4Li34Lit4LiZIixNTToiJWQg4LmA4LiU4Li34Lit4LiZIix5OiIxIOC4m+C4tSIseXk6IiVkIOC4m+C4tSJ9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgidGwtcGgiLHttb250aHM6IkVuZXJvX1BlYnJlcm9fTWFyc29fQWJyaWxfTWF5b19IdW55b19IdWx5b19BZ29zdG9fU2V0eWVtYnJlX09rdHVicmVfTm9ieWVtYnJlX0Rpc3llbWJyZSIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiRW5lX1BlYl9NYXJfQWJyX01heV9IdW5fSHVsX0Fnb19TZXRfT2t0X05vYl9EaXMiLnNwbGl0KCJfIiksd2Vla2RheXM6Ikxpbmdnb19MdW5lc19NYXJ0ZXNfTWl5ZXJrdWxlc19IdXdlYmVzX0JpeWVybmVzX1NhYmFkbyIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJMaW5fTHVuX01hcl9NaXlfSHV3X0JpeV9TYWIiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IkxpX0x1X01hX01pX0h1X0JpX1NhYiIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJNTS9EL1lZWVkiLExMOiJNTU1NIEQsIFlZWVkiLExMTDoiTU1NTSBELCBZWVlZIEhIOm1tIixMTExMOiJkZGRkLCBNTU1NIERELCBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltOZ2F5b24gc2FdIExUIixuZXh0RGF5OiJbQnVrYXMgc2FdIExUIixuZXh0V2VlazoiZGRkZCBbc2FdIExUIixsYXN0RGF5OiJbS2FoYXBvbiBzYV0gTFQiLGxhc3RXZWVrOiJkZGRkIFtodWxpbmcgbGluZ2dvXSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToic2EgbG9vYiBuZyAlcyIscGFzdDoiJXMgYW5nIG5ha2FsaXBhcyIsczoiaWxhbmcgc2VndW5kbyIsbToiaXNhbmcgbWludXRvIixtbToiJWQgbWludXRvIixoOiJpc2FuZyBvcmFzIixoaDoiJWQgb3JhcyIsZDoiaXNhbmcgYXJhdyIsZGQ6IiVkIGFyYXciLE06ImlzYW5nIGJ1d2FuIixNTToiJWQgYnV3YW4iLHk6ImlzYW5nIHRhb24iLHl5OiIlZCB0YW9uIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LyxvcmRpbmFsOmZ1bmN0aW9uKHQpe3JldHVybiB0fSx3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUodCl7dmFyIGU9dDtyZXR1cm4gZT10LmluZGV4T2YoImphaiIpIT09LTE/ZS5zbGljZSgwLC0zKSsibGVTIjp0LmluZGV4T2YoImphciIpIT09LTE/ZS5zbGljZSgwLC0zKSsid2FRIjp0LmluZGV4T2YoIkRJUyIpIT09LTE/ZS5zbGljZSgwLC0zKSsibmVtIjplKyIgcElxIn1mdW5jdGlvbiBpKHQpe3ZhciBlPXQ7cmV0dXJuIGU9dC5pbmRleE9mKCJqYWoiKSE9PS0xP2Uuc2xpY2UoMCwtMykrIkh14oCZIjp0LmluZGV4T2YoImphciIpIT09LTE/ZS5zbGljZSgwLC0zKSsid2VuIjp0LmluZGV4T2YoIkRJUyIpIT09LTE/ZS5zbGljZSgwLC0zKSsiYmVuIjplKyIgcmV0In1mdW5jdGlvbiBuKHQsZSxpLG4pe3ZhciBzPXIodCk7c3dpdGNoKGkpe2Nhc2UibW0iOnJldHVybiBzKyIgdHVwIjtjYXNlImhoIjpyZXR1cm4gcysiIHJlcCI7Y2FzZSJkZCI6cmV0dXJuIHMrIiBqYWoiO2Nhc2UiTU0iOnJldHVybiBzKyIgamFyIjtjYXNlInl5IjpyZXR1cm4gcysiIERJUyJ9fWZ1bmN0aW9uIHIodCl7dmFyIGU9TWF0aC5mbG9vcih0JTFlMy8xMDApLGk9TWF0aC5mbG9vcih0JTEwMC8xMCksbj10JTEwLHI9IiI7cmV0dXJuIGU+MCYmKHIrPXNbZV0rInZhdGxoIiksaT4wJiYocis9KCIiIT09cj8iICI6IiIpK3NbaV0rIm1hSCIpLG4+MCYmKHIrPSgiIiE9PXI/IiAiOiIiKStzW25dKSwiIj09PXI/InBhZ2giOnJ9dmFyIHM9InBhZ2hfd2HigJlfY2hh4oCZX3dlal9sb1NfdmFnaF9qYXZfU29jaF9jaG9yZ2hfSHV0Ii5zcGxpdCgiXyIpLG89dC5kZWZpbmVMb2NhbGUoInRsaCIse21vbnRoczoidGVyYeKAmSBqYXIgd2HigJlfdGVyYeKAmSBqYXIgY2hh4oCZX3RlcmHigJkgamFyIHdlal90ZXJh4oCZIGphciBsb1NfdGVyYeKAmSBqYXIgdmFnaF90ZXJh4oCZIGphciBqYXZfdGVyYeKAmSBqYXIgU29jaF90ZXJh4oCZIGphciBjaG9yZ2hfdGVyYeKAmSBqYXIgSHV0X3RlcmHigJkgamFyIHdh4oCZbWFIX3RlcmHigJkgamFyIHdh4oCZbWFIIHdh4oCZX3RlcmHigJkgamFyIHdh4oCZbWFIIGNoYeKAmSIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiamFyIHdh4oCZX2phciBjaGHigJlfamFyIHdlal9qYXIgbG9TX2phciB2YWdoX2phciBqYXZfamFyIFNvY2hfamFyIGNob3JnaF9qYXIgSHV0X2phciB3YeKAmW1hSF9qYXIgd2HigJltYUggd2HigJlfamFyIHdh4oCZbWFIIGNoYeKAmSIuc3BsaXQoIl8iKSx3ZWVrZGF5czoibG9qbUl0amFqX0RhU2phal9wb3ZqYWpfZ2hJdGxoamFqX2xvZ2hqYWpfYnVxamFqX2doSW5qYWoiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoibG9qbUl0amFqX0RhU2phal9wb3ZqYWpfZ2hJdGxoamFqX2xvZ2hqYWpfYnVxamFqX2doSW5qYWoiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46Imxvam1JdGphal9EYVNqYWpfcG92amFqX2doSXRsaGphal9sb2doamFqX2J1cWphal9naEluamFqIi5zcGxpdCgiXyIpLGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkRELk1NLllZWVkiLExMOiJEIE1NTU0gWVlZWSIsTExMOiJEIE1NTU0gWVlZWSBISDptbSIsTExMTDoiZGRkZCwgRCBNTU1NIFlZWVkgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheToiW0RhSGphal0gTFQiLG5leHREYXk6Ilt3YeKAmWxlU10gTFQiLG5leHRXZWVrOiJMTEwiLGxhc3REYXk6Ilt3YeKAmUh14oCZXSBMVCIsbGFzdFdlZWs6IkxMTCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZTplLHBhc3Q6aSxzOiJwdVMgbHVwIixtOiJ3YeKAmSB0dXAiLG1tOm4saDoid2HigJkgcmVwIixoaDpuLGQ6Indh4oCZIGphaiIsZGQ6bixNOiJ3YeKAmSBqYXIiLE1NOm4seToid2HigJkgRElTIix5eTpufSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sb3JkaW5hbDoiJWQuIix3ZWVrOntkb3c6MSxkb3k6NH19KTtyZXR1cm4gb30pfSxmdW5jdGlvbih0LGUsaSl7IWZ1bmN0aW9uKHQsZSl7ZShpKDM2KSl9KHRoaXMsZnVuY3Rpb24odCl7InVzZSBzdHJpY3QiO3ZhciBlPXsxOiInaW5jaSIsNToiJ2luY2kiLDg6IidpbmNpIiw3MDoiJ2luY2kiLDgwOiInaW5jaSIsMjoiJ25jaSIsNzoiJ25jaSIsMjA6IiduY2kiLDUwOiInbmNpIiwzOiInw7xuY8O8Iiw0OiInw7xuY8O8IiwxMDA6IifDvG5jw7wiLDY6IiduY8SxIiw5OiIndW5jdSIsMTA6Iid1bmN1IiwzMDoiJ3VuY3UiLDYwOiInxLFuY8SxIiw5MDoiJ8SxbmPEsSJ9LGk9dC5kZWZpbmVMb2NhbGUoInRyIix7bW9udGhzOiJPY2FrX8WedWJhdF9NYXJ0X05pc2FuX01hecSxc19IYXppcmFuX1RlbW11el9BxJ91c3Rvc19FeWzDvGxfRWtpbV9LYXPEsW1fQXJhbMSxayIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiT2NhX8WedWJfTWFyX05pc19NYXlfSGF6X1RlbV9BxJ91X0V5bF9Fa2lfS2FzX0FyYSIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiUGF6YXJfUGF6YXJ0ZXNpX1NhbMSxX8OHYXLFn2FtYmFfUGVyxZ9lbWJlX0N1bWFfQ3VtYXJ0ZXNpIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IlBhel9QdHNfU2FsX8OHYXJfUGVyX0N1bV9DdHMiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IlB6X1B0X1NhX8OHYV9QZV9DdV9DdCIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRCBNTU1NIFlZWVkiLExMTDoiRCBNTU1NIFlZWVkgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltidWfDvG4gc2FhdF0gTFQiLG5leHREYXk6Ilt5YXLEsW4gc2FhdF0gTFQiLG5leHRXZWVrOiJbaGFmdGF5YV0gZGRkZCBbc2FhdF0gTFQiLGxhc3REYXk6Iltkw7xuXSBMVCIsbGFzdFdlZWs6IltnZcOnZW4gaGFmdGFdIGRkZGQgW3NhYXRdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlcyBzb25yYSIscGFzdDoiJXMgw7ZuY2UiLHM6ImJpcmthw6cgc2FuaXllIixtOiJiaXIgZGFraWthIixtbToiJWQgZGFraWthIixoOiJiaXIgc2FhdCIsaGg6IiVkIHNhYXQiLGQ6ImJpciBnw7xuIixkZDoiJWQgZ8O8biIsTToiYmlyIGF5IixNTToiJWQgYXkiLHk6ImJpciB5xLFsIix5eToiJWQgecSxbCJ9LG9yZGluYWxQYXJzZTovXGR7MSwyfScoaW5jaXxuY2l8w7xuY8O8fG5jxLF8dW5jdXzEsW5jxLEpLyxvcmRpbmFsOmZ1bmN0aW9uKHQpe2lmKDA9PT10KXJldHVybiB0KyInxLFuY8SxIjt2YXIgaT10JTEwLG49dCUxMDAtaSxyPXQ+PTEwMD8xMDA6bnVsbDtyZXR1cm4gdCsoZVtpXXx8ZVtuXXx8ZVtyXSl9LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBpfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZSh0LGUsaSxuKXt2YXIgcj17czpbInZpZW5zYXMgc2VjdW5kcyIsIidpZW5zYXMgc2VjdW5kcyJdLG06WyInbiBtw611dCIsIidpZW5zIG3DrXV0Il0sbW06W3QrIiBtw611dHMiLCIiK3QrIiBtw611dHMiXSxoOlsiJ24gw75vcmEiLCInaWVuc2Egw75vcmEiXSxoaDpbdCsiIMO+b3JhcyIsIiIrdCsiIMO+b3JhcyJdLGQ6WyInbiB6aXVhIiwiJ2llbnNhIHppdWEiXSxkZDpbdCsiIHppdWFzIiwiIit0KyIgeml1YXMiXSxNOlsiJ24gbWVzIiwiJ2llbnMgbWVzIl0sTU06W3QrIiBtZXNlbiIsIiIrdCsiIG1lc2VuIl0seTpbIiduIGFyIiwiJ2llbnMgYXIiXSx5eTpbdCsiIGFycyIsIiIrdCsiIGFycyJdfTtyZXR1cm4gbj9yW2ldWzBdOmU/cltpXVswXTpyW2ldWzFdfXZhciBpPXQuZGVmaW5lTG9jYWxlKCJ0emwiLHttb250aHM6IkphbnVhcl9GZXZyYWdsaF9NYXLDp19BdnLDr3VfTWFpX0fDvG5fSnVsaWFfR3VzY2h0X1NldGVtdmFyX0xpc3RvcMOkdHNfTm9lbXZhcl9aZWNlbXZhciIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiSmFuX0Zldl9NYXJfQXZyX01haV9Hw7xuX0p1bF9HdXNfU2V0X0xpc19Ob2VfWmVjIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJTw7psYWRpX0zDum5lw6dpX01haXR6aV9Nw6FyY3VyaV9YaMO6YWRpX1Zpw6luZXLDp2lfU8OhdHVyaSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiJTw7psX0zDum5fTWFpX03DoXJfWGjDul9WacOpX1PDoXQiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IlPDul9Mw7pfTWFfTcOhX1hoX1ZpX1PDoSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhILm1tIixMVFM6IkhILm1tLnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRC4gTU1NTSBbZGFsbGFzXSBZWVlZIixMTEw6IkQuIE1NTU0gW2RhbGxhc10gWVlZWSBISC5tbSIsTExMTDoiZGRkZCwgW2xpXSBELiBNTU1NIFtkYWxsYXNdIFlZWVkgSEgubW0ifSxtZXJpZGllbVBhcnNlOi9kXCdvfGRcJ2EvaSxpc1BNOmZ1bmN0aW9uKHQpe3JldHVybiJkJ28iPT09dC50b0xvd2VyQ2FzZSgpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ+MTE/aT8iZCdvIjoiRCdPIjppPyJkJ2EiOiJEJ0EifSxjYWxlbmRhcjp7c2FtZURheToiW294aGkgw6BdIExUIixuZXh0RGF5OiJbZGVtw6Agw6BdIExUIixuZXh0V2VlazoiZGRkZCBbw6BdIExUIixsYXN0RGF5OiJbaWVpcmkgw6BdIExUIixsYXN0V2VlazoiW3PDvHIgZWxdIGRkZGQgW2xhc3RldSDDoF0gTFQiLHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6Im9zcHJlaSAlcyIscGFzdDoiamElcyIsczplLG06ZSxtbTplLGg6ZSxoaDplLGQ6ZSxkZDplLE06ZSxNTTplLHk6ZSx5eTplfSxvcmRpbmFsUGFyc2U6L1xkezEsMn1cLi8sCglvcmRpbmFsOiIlZC4iLHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBpfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoInR6bSIse21vbnRoczoi4rWJ4rWP4rWP4rSw4rWi4rWUX+K0seK1leK0sOK1ouK1lV/itY7itLDitZXitZpf4rWJ4rSx4rWU4rWJ4rWUX+K1juK0sOK1ouK1ouK1k1/itaLitZPitY/itaLitZNf4rWi4rWT4rWN4rWi4rWT4rWjX+K1luK1k+K1m+K1nF/itZvitZPitZzitLDitY/itLHitYnitZRf4rS94rWf4rWT4rSx4rWVX+K1j+K1k+K1oeK0sOK1j+K0seK1ieK1lF/itLfitZPitYritY/itLHitYnitZQiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6IuK1ieK1j+K1j+K0sOK1ouK1lF/itLHitZXitLDitaLitZVf4rWO4rSw4rWV4rWaX+K1ieK0seK1lOK1ieK1lF/itY7itLDitaLitaLitZNf4rWi4rWT4rWP4rWi4rWTX+K1ouK1k+K1jeK1ouK1k+K1o1/itZbitZPitZvitZxf4rWb4rWT4rWc4rSw4rWP4rSx4rWJ4rWUX+K0veK1n+K1k+K0seK1lV/itY/itZPitaHitLDitY/itLHitYnitZRf4rS34rWT4rWK4rWP4rSx4rWJ4rWUIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiLitLDitZnitLDitY7itLDitZlf4rSw4rWi4rWP4rSw4rWZX+K0sOK1meK1ieK1j+K0sOK1mV/itLDitL3itZTitLDitZlf4rSw4rS94rWh4rSw4rWZX+K0sOK1meK1ieK1juK1oeK0sOK1mV/itLDitZnitYnitLnitaLitLDitZkiLnNwbGl0KCJfIiksd2Vla2RheXNTaG9ydDoi4rSw4rWZ4rSw4rWO4rSw4rWZX+K0sOK1ouK1j+K0sOK1mV/itLDitZnitYnitY/itLDitZlf4rSw4rS94rWU4rSw4rWZX+K0sOK0veK1oeK0sOK1mV/itLDitZnitYnitY7itaHitLDitZlf4rSw4rWZ4rWJ4rS54rWi4rSw4rWZIi5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiLitLDitZnitLDitY7itLDitZlf4rSw4rWi4rWP4rSw4rWZX+K0sOK1meK1ieK1j+K0sOK1mV/itLDitL3itZTitLDitZlf4rSw4rS94rWh4rSw4rWZX+K0sOK1meK1ieK1juK1oeK0sOK1mV/itLDitZnitYnitLnitaLitLDitZkiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IlvitLDitZnitLfitYUg4rS0XSBMVCIsbmV4dERheToiW+K0sOK1meK0veK0sCDitLRdIExUIixuZXh0V2VlazoiZGRkZCBb4rS0XSBMVCIsbGFzdERheToiW+K0sOK1muK0sOK1j+K1nCDitLRdIExUIixsYXN0V2VlazoiZGRkZCBb4rS0XSBMVCIsc2FtZUVsc2U6IkwifSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToi4rS34rSw4rS34rWFIOK1mSDitaLitLDitY8gJXMiLHBhc3Q6IuK1ouK0sOK1jyAlcyIsczoi4rWJ4rWO4rWJ4rS9IixtOiLitY7itYnitY/itZPitLoiLG1tOiIlZCDitY7itYnitY/itZPitLoiLGg6IuK1meK0sOK1hOK0sCIsaGg6IiVkIOK1nOK0sOK1meK1meK0sOK1hOK1ieK1jyIsZDoi4rSw4rWZ4rWZIixkZDoiJWQgb+K1meK1meK0sOK1jyIsTToi4rSw4rWib+K1k+K1lCIsTU06IiVkIOK1ieK1ouK1ouK1ieK1lOK1jyIseToi4rSw4rWZ4rSz4rSw4rWZIix5eToiJWQg4rWJ4rWZ4rSz4rSw4rWZ4rWPIn0sd2Vlazp7ZG93OjYsZG95OjEyfX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoInR6bS1sYXRuIix7bW9udGhzOiJpbm5heXJfYnLLpGF5csukX21hcsukc8ukX2licmlyX21heXl3X3l3bnl3X3l3bHl3el/Jo3fFoXRfxaF3dGFuYmlyX2t0y6R3YnLLpF9ud3dhbmJpcl9kd2puYmlyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJpbm5heXJfYnLLpGF5csukX21hcsukc8ukX2licmlyX21heXl3X3l3bnl3X3l3bHl3el/Jo3fFoXRfxaF3dGFuYmlyX2t0y6R3YnLLpF9ud3dhbmJpcl9kd2puYmlyIi5zcGxpdCgiXyIpLHdlZWtkYXlzOiJhc2FtYXNfYXluYXNfYXNpbmFzX2FrcmFzX2Frd2FzX2FzaW13YXNfYXNp4biNeWFzIi5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6ImFzYW1hc19heW5hc19hc2luYXNfYWtyYXNfYWt3YXNfYXNpbXdhc19hc2nhuI15YXMiLnNwbGl0KCJfIiksd2Vla2RheXNNaW46ImFzYW1hc19heW5hc19hc2luYXNfYWtyYXNfYWt3YXNfYXNpbXdhc19hc2nhuI15YXMiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJkZGRkIEQgTU1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6Ilthc2RraCBnXSBMVCIsbmV4dERheToiW2Fza2EgZ10gTFQiLG5leHRXZWVrOiJkZGRkIFtnXSBMVCIsbGFzdERheToiW2Fzc2FudCBnXSBMVCIsbGFzdFdlZWs6ImRkZGQgW2ddIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJkYWRraCBzIHlhbiAlcyIscGFzdDoieWFuICVzIixzOiJpbWlrIixtOiJtaW514biNIixtbToiJWQgbWludeG4jSIsaDoic2HJm2EiLGhoOiIlZCB0YXNzYcmbaW4iLGQ6ImFzcyIsZGQ6IiVkIG9zc2FuIixNOiJheW93ciIsTU06IiVkIGl5eWlybiIseToiYXNnYXMiLHl5OiIlZCBpc2dhc24ifSx3ZWVrOntkb3c6Nixkb3k6MTJ9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBlKHQsZSl7dmFyIGk9dC5zcGxpdCgiXyIpO3JldHVybiBlJTEwPT09MSYmZSUxMDAhPT0xMT9pWzBdOmUlMTA+PTImJmUlMTA8PTQmJihlJTEwMDwxMHx8ZSUxMDA+PTIwKT9pWzFdOmlbMl19ZnVuY3Rpb24gaSh0LGksbil7dmFyIHI9e21tOmk/ItGF0LLQuNC70LjQvdCwX9GF0LLQuNC70LjQvdC4X9GF0LLQuNC70LjQvSI6ItGF0LLQuNC70LjQvdGDX9GF0LLQuNC70LjQvdC4X9GF0LLQuNC70LjQvSIsaGg6aT8i0LPQvtC00LjQvdCwX9Cz0L7QtNC40L3QuF/Qs9C+0LTQuNC9Ijoi0LPQvtC00LjQvdGDX9Cz0L7QtNC40L3QuF/Qs9C+0LTQuNC9IixkZDoi0LTQtdC90Yxf0LTQvdGWX9C00L3RltCyIixNTToi0LzRltGB0Y/RhtGMX9C80ZbRgdGP0YbRll/QvNGW0YHRj9GG0ZbQsiIseXk6ItGA0ZbQul/RgNC+0LrQuF/RgNC+0LrRltCyIn07cmV0dXJuIm0iPT09bj9pPyLRhdCy0LjQu9C40L3QsCI6ItGF0LLQuNC70LjQvdGDIjoiaCI9PT1uP2k/ItCz0L7QtNC40L3QsCI6ItCz0L7QtNC40L3RgyI6dCsiICIrZShyW25dLCt0KX1mdW5jdGlvbiBuKHQsZSl7dmFyIGk9e25vbWluYXRpdmU6ItC90LXQtNGW0LvRj1/Qv9C+0L3QtdC00ZbQu9C+0Lpf0LLRltCy0YLQvtGA0L7Qul/RgdC10YDQtdC00LBf0YfQtdGC0LLQtdGAX9C/4oCZ0Y/RgtC90LjRhtGPX9GB0YPQsdC+0YLQsCIuc3BsaXQoIl8iKSxhY2N1c2F0aXZlOiLQvdC10LTRltC70Y5f0L/QvtC90LXQtNGW0LvQvtC6X9Cy0ZbQstGC0L7RgNC+0Lpf0YHQtdGA0LXQtNGDX9GH0LXRgtCy0LXRgF/Qv+KAmdGP0YLQvdC40YbRjl/RgdGD0LHQvtGC0YMiLnNwbGl0KCJfIiksZ2VuaXRpdmU6ItC90LXQtNGW0LvRll/Qv9C+0L3QtdC00ZbQu9C60LBf0LLRltCy0YLQvtGA0LrQsF/RgdC10YDQtdC00Lhf0YfQtdGC0LLQtdGA0LPQsF/Qv+KAmdGP0YLQvdC40YbRll/RgdGD0LHQvtGC0LgiLnNwbGl0KCJfIil9LG49LyhcW1vQktCy0KPRg11cXSkgP2RkZGQvLnRlc3QoZSk/ImFjY3VzYXRpdmUiOi9cWz8oPzrQvNC40L3Rg9C70L7Rl3zQvdCw0YHRgtGD0L/QvdC+0ZcpPyA/XF0gP2RkZGQvLnRlc3QoZSk/Imdlbml0aXZlIjoibm9taW5hdGl2ZSI7cmV0dXJuIGlbbl1bdC5kYXkoKV19ZnVuY3Rpb24gcih0KXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdCsi0L4iKygxMT09PXRoaXMuaG91cnMoKT8i0LEiOiIiKSsiXSBMVCJ9fXZhciBzPXQuZGVmaW5lTG9jYWxlKCJ1ayIse21vbnRoczp7Zm9ybWF0OiLRgdGW0YfQvdGPX9C70Y7RgtC+0LPQvl/QsdC10YDQtdC30L3Rj1/QutCy0ZbRgtC90Y9f0YLRgNCw0LLQvdGPX9GH0LXRgNCy0L3Rj1/Qu9C40L/QvdGPX9GB0LXRgNC/0L3Rj1/QstC10YDQtdGB0L3Rj1/QttC+0LLRgtC90Y9f0LvQuNGB0YLQvtC/0LDQtNCwX9Cz0YDRg9C00L3RjyIuc3BsaXQoIl8iKSxzdGFuZGFsb25lOiLRgdGW0YfQtdC90Yxf0LvRjtGC0LjQuV/QsdC10YDQtdC30LXQvdGMX9C60LLRltGC0LXQvdGMX9GC0YDQsNCy0LXQvdGMX9GH0LXRgNCy0LXQvdGMX9C70LjQv9C10L3RjF/RgdC10YDQv9C10L3RjF/QstC10YDQtdGB0LXQvdGMX9C20L7QstGC0LXQvdGMX9C70LjRgdGC0L7Qv9Cw0LRf0LPRgNGD0LTQtdC90YwiLnNwbGl0KCJfIil9LG1vbnRoc1Nob3J0OiLRgdGW0Ydf0LvRjtGCX9Cx0LXRgF/QutCy0ZbRgl/RgtGA0LDQsl/Rh9C10YDQsl/Qu9C40L9f0YHQtdGA0L9f0LLQtdGAX9C20L7QstGCX9C70LjRgdGCX9Cz0YDRg9C0Ii5zcGxpdCgiXyIpLHdlZWtkYXlzOm4sd2Vla2RheXNTaG9ydDoi0L3QtF/Qv9C9X9Cy0YJf0YHRgF/Rh9GCX9C/0YJf0YHQsSIuc3BsaXQoIl8iKSx3ZWVrZGF5c01pbjoi0L3QtF/Qv9C9X9Cy0YJf0YHRgF/Rh9GCX9C/0YJf0YHQsSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkhIOm1tIixMVFM6IkhIOm1tOnNzIixMOiJERC5NTS5ZWVlZIixMTDoiRCBNTU1NIFlZWVkg0YAuIixMTEw6IkQgTU1NTSBZWVlZINGALiwgSEg6bW0iLExMTEw6ImRkZGQsIEQgTU1NTSBZWVlZINGALiwgSEg6bW0ifSxjYWxlbmRhcjp7c2FtZURheTpyKCJb0KHRjNC+0LPQvtC00L3RliAiKSxuZXh0RGF5OnIoIlvQl9Cw0LLRgtGA0LAgIiksbGFzdERheTpyKCJb0JLRh9C+0YDQsCAiKSxuZXh0V2VlazpyKCJb0KNdIGRkZGQgWyIpLGxhc3RXZWVrOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZGF5KCkpe2Nhc2UgMDpjYXNlIDM6Y2FzZSA1OmNhc2UgNjpyZXR1cm4gcigiW9Cc0LjQvdGD0LvQvtGXXSBkZGRkIFsiKS5jYWxsKHRoaXMpO2Nhc2UgMTpjYXNlIDI6Y2FzZSA0OnJldHVybiByKCJb0JzQuNC90YPQu9C+0LPQvl0gZGRkZCBbIikuY2FsbCh0aGlzKX19LHNhbWVFbHNlOiJMIn0scmVsYXRpdmVUaW1lOntmdXR1cmU6ItC30LAgJXMiLHBhc3Q6IiVzINGC0L7QvNGDIixzOiLQtNC10LrRltC70YzQutCwINGB0LXQutGD0L3QtCIsbTppLG1tOmksaDoi0LPQvtC00LjQvdGDIixoaDppLGQ6ItC00LXQvdGMIixkZDppLE06ItC80ZbRgdGP0YbRjCIsTU06aSx5OiLRgNGW0LoiLHl5Oml9LG1lcmlkaWVtUGFyc2U6L9C90L7Rh9GWfNGA0LDQvdC60YN80LTQvdGPfNCy0LXRh9C+0YDQsC8saXNQTTpmdW5jdGlvbih0KXtyZXR1cm4vXijQtNC90Y980LLQtdGH0L7RgNCwKSQvLnRlc3QodCl9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdDw0PyLQvdC+0YfRliI6dDwxMj8i0YDQsNC90LrRgyI6dDwxNz8i0LTQvdGPIjoi0LLQtdGH0L7RgNCwIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9LSjQuXzQs9C+KS8sb3JkaW5hbDpmdW5jdGlvbih0LGUpe3N3aXRjaChlKXtjYXNlIk0iOmNhc2UiZCI6Y2FzZSJEREQiOmNhc2UidyI6Y2FzZSJXIjpyZXR1cm4gdCsiLdC5IjtjYXNlIkQiOnJldHVybiB0KyIt0LPQviI7ZGVmYXVsdDpyZXR1cm4gdH19LHdlZWs6e2RvdzoxLGRveTo3fX0pO3JldHVybiBzfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoInV6Iix7bW9udGhzOiLRj9C90LLQsNGAX9GE0LXQstGA0LDQu1/QvNCw0YDRgl/QsNC/0YDQtdC7X9C80LDQuV/QuNGO0L1f0LjRjtC7X9Cw0LLQs9GD0YHRgl/RgdC10L3RgtGP0LHRgF/QvtC60YLRj9Cx0YBf0L3QvtGP0LHRgF/QtNC10LrQsNCx0YAiLnNwbGl0KCJfIiksbW9udGhzU2hvcnQ6ItGP0L3Qsl/RhNC10LJf0LzQsNGAX9Cw0L/RgF/QvNCw0Llf0LjRjtC9X9C40Y7Qu1/QsNCy0LNf0YHQtdC9X9C+0LrRgl/QvdC+0Y9f0LTQtdC6Ii5zcGxpdCgiXyIpLHdlZWtkYXlzOiLQr9C60YjQsNC90LHQsF/QlNGD0YjQsNC90LHQsF/QodC10YjQsNC90LHQsF/Qp9C+0YDRiNCw0L3QsdCwX9Cf0LDQudGI0LDQvdCx0LBf0JbRg9C80LBf0KjQsNC90LHQsCIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLQr9C60Yhf0JTRg9GIX9Ch0LXRiF/Qp9C+0YBf0J/QsNC5X9CW0YPQvF/QqNCw0L0iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46ItCv0Lpf0JTRg1/QodC1X9Cn0L5f0J/QsF/QltGDX9Co0LAiLnNwbGl0KCJfIiksbG9uZ0RhdGVGb3JtYXQ6e0xUOiJISDptbSIsTFRTOiJISDptbTpzcyIsTDoiREQvTU0vWVlZWSIsTEw6IkQgTU1NTSBZWVlZIixMTEw6IkQgTU1NTSBZWVlZIEhIOm1tIixMTExMOiJEIE1NTU0gWVlZWSwgZGRkZCBISDptbSJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb0JHRg9Cz0YPQvSDRgdC+0LDRgl0gTFQgW9C00LBdIixuZXh0RGF5OiJb0K3RgNGC0LDQs9CwXSBMVCBb0LTQsF0iLG5leHRXZWVrOiJkZGRkIFvQutGD0L3QuCDRgdC+0LDRgl0gTFQgW9C00LBdIixsYXN0RGF5OiJb0JrQtdGH0LAg0YHQvtCw0YJdIExUIFvQtNCwXSIsbGFzdFdlZWs6IlvQo9GC0LPQsNC9XSBkZGRkIFvQutGD0L3QuCDRgdC+0LDRgl0gTFQgW9C00LBdIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiLQr9C60LjQvSAlcyDQuNGH0LjQtNCwIixwYXN0OiLQkdC40YAg0L3QtdGH0LAgJXMg0L7Qu9C00LjQvSIsczoi0YTRg9GA0YHQsNGCIixtOiLQsdC40YAg0LTQsNC60LjQutCwIixtbToiJWQg0LTQsNC60LjQutCwIixoOiLQsdC40YAg0YHQvtCw0YIiLGhoOiIlZCDRgdC+0LDRgiIsZDoi0LHQuNGAINC60YPQvSIsZGQ6IiVkINC60YPQvSIsTToi0LHQuNGAINC+0LkiLE1NOiIlZCDQvtC5Iix5OiLQsdC40YAg0LnQuNC7Iix5eToiJWQg0LnQuNC7In0sd2Vlazp7ZG93OjEsZG95Ojd9fSk7cmV0dXJuIGV9KX0sZnVuY3Rpb24odCxlLGkpeyFmdW5jdGlvbih0LGUpe2UoaSgzNikpfSh0aGlzLGZ1bmN0aW9uKHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgZT10LmRlZmluZUxvY2FsZSgidmkiLHttb250aHM6InRow6FuZyAxX3Row6FuZyAyX3Row6FuZyAzX3Row6FuZyA0X3Row6FuZyA1X3Row6FuZyA2X3Row6FuZyA3X3Row6FuZyA4X3Row6FuZyA5X3Row6FuZyAxMF90aMOhbmcgMTFfdGjDoW5nIDEyIi5zcGxpdCgiXyIpLG1vbnRoc1Nob3J0OiJUaDAxX1RoMDJfVGgwM19UaDA0X1RoMDVfVGgwNl9UaDA3X1RoMDhfVGgwOV9UaDEwX1RoMTFfVGgxMiIuc3BsaXQoIl8iKSx3ZWVrZGF5czoiY2jhu6cgbmjhuq10X3Ro4bupIGhhaV90aOG7qSBiYV90aOG7qSB0xrBfdGjhu6kgbsSDbV90aOG7qSBzw6F1X3Ro4bupIGLhuqN5Ii5zcGxpdCgiXyIpLHdlZWtkYXlzU2hvcnQ6IkNOX1QyX1QzX1Q0X1Q1X1Q2X1Q3Ii5zcGxpdCgiXyIpLHdlZWtkYXlzTWluOiJDTl9UMl9UM19UNF9UNV9UNl9UNyIuc3BsaXQoIl8iKSxtZXJpZGllbVBhcnNlOi9zYXxjaC9pLGlzUE06ZnVuY3Rpb24odCl7cmV0dXJuL15jaCQvaS50ZXN0KHQpfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8MTI/aT8ic2EiOiJTQSI6aT8iY2giOiJDSCJ9LGxvbmdEYXRlRm9ybWF0OntMVDoiSEg6bW0iLExUUzoiSEg6bW06c3MiLEw6IkREL01NL1lZWVkiLExMOiJEIE1NTU0gW27Eg21dIFlZWVkiLExMTDoiRCBNTU1NIFtuxINtXSBZWVlZIEhIOm1tIixMTExMOiJkZGRkLCBEIE1NTU0gW27Eg21dIFlZWVkgSEg6bW0iLGw6IkREL00vWVlZWSIsbGw6IkQgTU1NIFlZWVkiLGxsbDoiRCBNTU0gWVlZWSBISDptbSIsbGxsbDoiZGRkLCBEIE1NTSBZWVlZIEhIOm1tIn0sY2FsZW5kYXI6e3NhbWVEYXk6IltIw7RtIG5heSBsw7pjXSBMVCIsbmV4dERheToiW05nw6B5IG1haSBsw7pjXSBMVCIsbmV4dFdlZWs6ImRkZGQgW3R14bqnbiB04bubaSBsw7pjXSBMVCIsbGFzdERheToiW0jDtG0gcXVhIGzDumNdIExUIixsYXN0V2VlazoiZGRkZCBbdHXhuqduIHLhu5NpIGzDumNdIExUIixzYW1lRWxzZToiTCJ9LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlcyB04bubaSIscGFzdDoiJXMgdHLGsOG7m2MiLHM6InbDoGkgZ2nDonkiLG06Im3hu5l0IHBow7p0IixtbToiJWQgcGjDunQiLGg6Im3hu5l0IGdp4budIixoaDoiJWQgZ2nhu50iLGQ6Im3hu5l0IG5nw6B5IixkZDoiJWQgbmfDoHkiLE06Im3hu5l0IHRow6FuZyIsTU06IiVkIHRow6FuZyIseToibeG7mXQgbsSDbSIseXk6IiVkIG7Eg20ifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0vLG9yZGluYWw6ZnVuY3Rpb24odCl7cmV0dXJuIHR9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoInpoLWNuIix7bW9udGhzOiLkuIDmnIhf5LqM5pyIX+S4ieaciF/lm5vmnIhf5LqU5pyIX+WFreaciF/kuIPmnIhf5YWr5pyIX+S5neaciF/ljYHmnIhf5Y2B5LiA5pyIX+WNgeS6jOaciCIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiMeaciF8y5pyIXzPmnIhfNOaciF815pyIXzbmnIhfN+aciF845pyIXznmnIhfMTDmnIhfMTHmnIhfMTLmnIgiLnNwbGl0KCJfIiksd2Vla2RheXM6IuaYn+acn+aXpV/mmJ/mnJ/kuIBf5pif5pyf5LqMX+aYn+acn+S4iV/mmJ/mnJ/lm5tf5pif5pyf5LqUX+aYn+acn+WFrSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLlkajml6Vf5ZGo5LiAX+WRqOS6jF/lkajkuIlf5ZGo5ZubX+WRqOS6lF/lkajlha0iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IuaXpV/kuIBf5LqMX+S4iV/lm5tf5LqUX+WFrSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkFo54K5bW3liIYiLExUUzoiQWjngrlt5YiGc+enkiIsTDoiWVlZWS1NTS1ERCIsTEw6IllZWVnlubRNTU1E5pelIixMTEw6IllZWVnlubRNTU1E5pelQWjngrltbeWIhiIsTExMTDoiWVlZWeW5tE1NTUTml6VkZGRkQWjngrltbeWIhiIsbDoiWVlZWS1NTS1ERCIsbGw6IllZWVnlubRNTU1E5pelIixsbGw6IllZWVnlubRNTU1E5pelQWjngrltbeWIhiIsbGxsbDoiWVlZWeW5tE1NTUTml6VkZGRkQWjngrltbeWIhiJ9LG1lcmlkaWVtUGFyc2U6L+WHjOaZqHzml6nkuIp85LiK5Y2IfOS4reWNiHzkuIvljYh85pma5LiKLyxtZXJpZGllbUhvdXI6ZnVuY3Rpb24odCxlKXtyZXR1cm4gMTI9PT10JiYodD0wKSwi5YeM5pmoIj09PWV8fCLml6nkuIoiPT09ZXx8IuS4iuWNiCI9PT1lP3Q6IuS4i+WNiCI9PT1lfHwi5pma5LiKIj09PWU/dCsxMjp0Pj0xMT90OnQrMTJ9LG1lcmlkaWVtOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj0xMDAqdCtlO3JldHVybiBuPDYwMD8i5YeM5pmoIjpuPDkwMD8i5pep5LiKIjpuPDExMzA/IuS4iuWNiCI6bjwxMjMwPyLkuK3ljYgiOm48MTgwMD8i5LiL5Y2IIjoi5pma5LiKIn0sY2FsZW5kYXI6e3NhbWVEYXk6ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMubWludXRlcygpPyJb5LuK5aSpXUFoW+eCueaVtF0iOiJb5LuK5aSpXUxUIn0sbmV4dERheTpmdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5taW51dGVzKCk/IlvmmI7lpKldQWhb54K55pW0XSI6IlvmmI7lpKldTFQifSxsYXN0RGF5OmZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLm1pbnV0ZXMoKT8iW+aYqOWkqV1BaFvngrnmlbRdIjoiW+aYqOWkqV1MVCJ9LG5leHRXZWVrOmZ1bmN0aW9uKCl7dmFyIGUsaTtyZXR1cm4gZT10KCkuc3RhcnRPZigid2VlayIpLGk9dGhpcy51bml4KCktZS51bml4KCk+PTYwNDgwMD8iW+S4i10iOiJb5pysXSIsMD09PXRoaXMubWludXRlcygpP2krImRkZEFo54K55pW0IjppKyJkZGRBaOeCuW1tIn0sbGFzdFdlZWs6ZnVuY3Rpb24oKXt2YXIgZSxpO3JldHVybiBlPXQoKS5zdGFydE9mKCJ3ZWVrIiksaT10aGlzLnVuaXgoKTxlLnVuaXgoKT8iW+S4il0iOiJb5pysXSIsMD09PXRoaXMubWludXRlcygpP2krImRkZEFo54K55pW0IjppKyJkZGRBaOeCuW1tIn0sc2FtZUVsc2U6IkxMIn0sb3JkaW5hbFBhcnNlOi9cZHsxLDJ9KOaXpXzmnIh85ZGoKS8sb3JkaW5hbDpmdW5jdGlvbih0LGUpe3N3aXRjaChlKXtjYXNlImQiOmNhc2UiRCI6Y2FzZSJEREQiOnJldHVybiB0KyLml6UiO2Nhc2UiTSI6cmV0dXJuIHQrIuaciCI7Y2FzZSJ3IjpjYXNlIlciOnJldHVybiB0KyLlkagiO2RlZmF1bHQ6cmV0dXJuIHR9fSxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiJXPlhoUiLHBhc3Q6IiVz5YmNIixzOiLlh6Dnp5IiLG06IjEg5YiG6ZKfIixtbToiJWQg5YiG6ZKfIixoOiIxIOWwj+aXtiIsaGg6IiVkIOWwj+aXtiIsZDoiMSDlpKkiLGRkOiIlZCDlpKkiLE06IjEg5Liq5pyIIixNTToiJWQg5Liq5pyIIix5OiIxIOW5tCIseXk6IiVkIOW5tCJ9LHdlZWs6e2RvdzoxLGRveTo0fX0pO3JldHVybiBlfSl9LGZ1bmN0aW9uKHQsZSxpKXshZnVuY3Rpb24odCxlKXtlKGkoMzYpKX0odGhpcyxmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7dmFyIGU9dC5kZWZpbmVMb2NhbGUoInpoLXR3Iix7bW9udGhzOiLkuIDmnIhf5LqM5pyIX+S4ieaciF/lm5vmnIhf5LqU5pyIX+WFreaciF/kuIPmnIhf5YWr5pyIX+S5neaciF/ljYHmnIhf5Y2B5LiA5pyIX+WNgeS6jOaciCIuc3BsaXQoIl8iKSxtb250aHNTaG9ydDoiMeaciF8y5pyIXzPmnIhfNOaciF815pyIXzbmnIhfN+aciF845pyIXznmnIhfMTDmnIhfMTHmnIhfMTLmnIgiLnNwbGl0KCJfIiksd2Vla2RheXM6IuaYn+acn+aXpV/mmJ/mnJ/kuIBf5pif5pyf5LqMX+aYn+acn+S4iV/mmJ/mnJ/lm5tf5pif5pyf5LqUX+aYn+acn+WFrSIuc3BsaXQoIl8iKSx3ZWVrZGF5c1Nob3J0OiLpgLHml6Vf6YCx5LiAX+mAseS6jF/pgLHkuIlf6YCx5ZubX+mAseS6lF/pgLHlha0iLnNwbGl0KCJfIiksd2Vla2RheXNNaW46IuaXpV/kuIBf5LqMX+S4iV/lm5tf5LqUX+WFrSIuc3BsaXQoIl8iKSxsb25nRGF0ZUZvcm1hdDp7TFQ6IkFo6buebW3liIYiLExUUzoiQWjpu55t5YiGc+enkiIsTDoiWVlZWeW5tE1NTUTml6UiLExMOiJZWVlZ5bm0TU1NROaXpSIsTExMOiJZWVlZ5bm0TU1NROaXpUFo6buebW3liIYiLExMTEw6IllZWVnlubRNTU1E5pelZGRkZEFo6buebW3liIYiLGw6IllZWVnlubRNTU1E5pelIixsbDoiWVlZWeW5tE1NTUTml6UiLGxsbDoiWVlZWeW5tE1NTUTml6VBaOm7nm1t5YiGIixsbGxsOiJZWVlZ5bm0TU1NROaXpWRkZGRBaOm7nm1t5YiGIn0sbWVyaWRpZW1QYXJzZTov5pep5LiKfOS4iuWNiHzkuK3ljYh85LiL5Y2IfOaZmuS4ii8sbWVyaWRpZW1Ib3VyOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIDEyPT09dCYmKHQ9MCksIuaXqeS4iiI9PT1lfHwi5LiK5Y2IIj09PWU/dDoi5Lit5Y2IIj09PWU/dD49MTE/dDp0KzEyOiLkuIvljYgiPT09ZXx8IuaZmuS4iiI9PT1lP3QrMTI6dm9pZCAwfSxtZXJpZGllbTpmdW5jdGlvbih0LGUsaSl7dmFyIG49MTAwKnQrZTtyZXR1cm4gbjw5MDA/IuaXqeS4iiI6bjwxMTMwPyLkuIrljYgiOm48MTIzMD8i5Lit5Y2IIjpuPDE4MDA/IuS4i+WNiCI6IuaZmuS4iiJ9LGNhbGVuZGFyOntzYW1lRGF5OiJb5LuK5aSpXUxUIixuZXh0RGF5OiJb5piO5aSpXUxUIixuZXh0V2VlazoiW+S4i11kZGRkTFQiLGxhc3REYXk6IlvmmKjlpKldTFQiLGxhc3RXZWVrOiJb5LiKXWRkZGRMVCIsc2FtZUVsc2U6IkwifSxvcmRpbmFsUGFyc2U6L1xkezEsMn0o5pelfOaciHzpgLEpLyxvcmRpbmFsOmZ1bmN0aW9uKHQsZSl7c3dpdGNoKGUpe2Nhc2UiZCI6Y2FzZSJEIjpjYXNlIkRERCI6cmV0dXJuIHQrIuaXpSI7Y2FzZSJNIjpyZXR1cm4gdCsi5pyIIjtjYXNlInciOmNhc2UiVyI6cmV0dXJuIHQrIumAsSI7ZGVmYXVsdDpyZXR1cm4gdH19LHJlbGF0aXZlVGltZTp7ZnV0dXJlOiIlc+WFpyIscGFzdDoiJXPliY0iLHM6IuW5vuenkiIsbToi5LiA5YiG6ZCYIixtbToiJWTliIbpkJgiLGg6IuS4gOWwj+aZgiIsaGg6IiVk5bCP5pmCIixkOiLkuIDlpKkiLGRkOiIlZOWkqSIsTToi5LiA5YCL5pyIIixNTToiJWTlgIvmnIgiLHk6IuS4gOW5tCIseXk6IiVk5bm0In19KTtyZXR1cm4gZX0pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTM3KV0scj1mdW5jdGlvbih0LGUpe3JldHVybiBlLmV4dGVuZCh7c2VjdXJlSlNPTjohMSxfYnVpbHRJbkxvY2FsUHJvcHM6e19fZWRpdF9fOiJib29sZWFuIixfX3BlbmRpbmdfXzoiYm9vbGVhbiJ9LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dGhpcy5sb2NhbD10LmRlZmF1bHRzKHt9LHQucmVzdWx0KHRoaXMsImxvY2FsIiksdGhpcy5fYnVpbHRJbkxvY2FsUHJvcHMpLHQucmVzdWx0KHRoaXMsInNlY3VyZUpTT04iKSYmKHRoaXMuc3luYz10LndyYXAodGhpcy5zeW5jLGZ1bmN0aW9uKGUsaSxuLHIpe3JldHVybiBlLmNhbGwodGhpcyxpLG4sdC5leHRlbmQoe2RhdGFUeXBlOiJzZWN1cmVKU09OIn0scikpfSkpLGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyLHM7IWZ1bmN0aW9uKG8sYSl7cj1baSgyKSxpKDM1KV0sbj1hLHM9ImZ1bmN0aW9uIj09dHlwZW9mIG4/bi5hcHBseShlLHIpOm4sISh2b2lkIDAhPT1zJiYodC5leHBvcnRzPXMpKX0odGhpcyxmdW5jdGlvbih0LGUpe2Z1bmN0aW9uIGkoZSxuLHIscyl7dmFyIG89dC5jb250YWlucyhuLHIpO3JldHVybiBzfHwocz17fSksb3x8IXQuaXNPYmplY3QoZSl8fHQuaXNBcnJheShlKXx8dC5pc0Z1bmN0aW9uKGUpP3ZvaWQgMCE9PXImJihzW3JdPWUpOnQuZWFjaChlLGZ1bmN0aW9uKHQsZSl7aSh0LG4scj9yKyIuIitlOmUscyl9KSxzfWZ1bmN0aW9uIG4oZSl7cmV0dXJuIHQuZWFjaChlLGZ1bmN0aW9uKHQsZSxpKXtpZihlLmluZGV4T2YoIi4iKSE9LTEpe2Zvcih2YXIgbixyPWkscz1lLnNwbGl0KCIuIik7dm9pZCAwIT09KG49cy5zaGlmdCgpKTspcltuXXx8KHJbbl09cy5sZW5ndGg/e306dCkscj1yW25dO2RlbGV0ZSBpW2VdfX0pLGV9ZnVuY3Rpb24gcih0LGUpe3ZhciBpPXt9O3JldHVybiBpW3QubmFtZV09ZSxpfWZ1bmN0aW9uIHMoZSxpKXt2YXIgbjtyZXR1cm4gbj10LmlzU3RyaW5nKGUpP3t0eXBlOmV9OnQuaXNBcnJheShlKT97dHlwZTplWzBdLHJlcXVpcmVkOmVbMV0sdmFsdWU6ZVsyXX06dC5jbG9uZShlKSx0LmRlZmF1bHRzKG4se3JlcXVpcmVkOiExLG5hbWU6aX0pLG59ZnVuY3Rpb24gbyh0KXtyZXR1cm4gdC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xiW2Etel0vZyxmdW5jdGlvbih0KXtyZXR1cm4gdC50b1VwcGVyQ2FzZSgpfSl9ZnVuY3Rpb24gYShlLGkpe3JldHVybiB0LmlzQm9vbGVhbihlKT9lOnQuaXNSZWdFeHAoZSk/ZS50ZXN0KGkpOiEhdC5pc0Z1bmN0aW9uKGUpJiZlLmNhbGwodGhpcyxpKX1mdW5jdGlvbiBsKHQsZSxpKXtpZighZS50ZXN0KHQpKXJldHVybiBpfWZ1bmN0aW9uIGModCxlKXt2YXIgaT1mW3QuZm9ybWF0XTtpZih0LmZvcm1hdCYmIWkpdGhyb3cgbmV3IFR5cGVFcnJvcih0LmZvcm1hdCsiIGlzIG5vdCBhIHN1cHBvcnRlZCBzdHJpbmcgZm9ybWF0Iik7cmV0dXJuIGkmJmkoZSl9ZnVuY3Rpb24gdShlLGkpe3ZhciBuPXQucGFydGlhbChyLGUpLHM9YyhlLGkpO3JldHVybiBzP24ocyk6aSYmZS5taW5MZW5ndGgmJmkubGVuZ3RoPGUubWluTGVuZ3RoP24ocC5FUlJPUl9TVFJJTkdfU1RSSU5HX01JTl9MRU5HVEgsaS5sZW5ndGgpOmkmJmUubWF4TGVuZ3RoJiZpLmxlbmd0aD5lLm1heExlbmd0aD9uKHAuRVJST1JfU1RSSU5HX1NUUklOR19NQVhfTEVOR1RILGkubGVuZ3RoKTp2b2lkIDB9ZnVuY3Rpb24gZChlLGkpe3ZhciBuLHMsYT10LnBhcnRpYWwocixlKSxsPSF0LmlzVW5kZWZpbmVkKGkpJiYhdC5pc051bGwoaSk7aWYoZS5yZXF1aXJlZCYmKCFsfHx0LmlzTnVsbChpKXx8IiI9PT1pKSlyZXR1cm4gYShwLkVSUk9SX0JMQU5LKTtpZihuPXRbImlzIitvKGUudHlwZSldLGwmJiJhbnkiIT1lLnR5cGUmJighdC5pc0Z1bmN0aW9uKG4pfHwhbihpKSkpcmV0dXJuIGEocC5FUlJPUl9XUk9OR19UWVBFKTtpZihpJiYic3RyaW5nIj09ZS50eXBlKXt2YXIgYz11KGUsaSk7aWYoYylyZXR1cm4gY31pZihsJiZlLnZhbHVlcyYmIXQuY29udGFpbnMoZS52YWx1ZXMsaSkpcmV0dXJuIGEocC5FUlJPUl9OT1RfQUxMT1dFRCk7aWYodC5pc0Z1bmN0aW9uKGUudmFsaWRhdGUpKXt2YXIgZD1lLnZhbGlkYXRlKGkpO2lmKHQuaXNTdHJpbmcoZCkmJmQpcmV0dXJuIGEoZCk7aWYoZD09PSExKXJldHVybiBhKHAuRVJST1JfSU5WQUxJRCl9cmV0dXJuIGwmJiJhcnJheSI9PWUudHlwZSYmKHM9aChlLGkpKT9hKHMpOnZvaWQgMH1mdW5jdGlvbiBoKGUsaSl7aWYoZS5taW5JdGVtcyYmaS5sZW5ndGg8ZS5taW5JdGVtcylyZXR1cm4ibW9kZWwudmFsaWRhdGlvbi5maWVsZC5hcnJheS5taW5JdGVtcyI7aWYoZS5tYXhJdGVtcyYmaS5sZW5ndGg+ZS5tYXhJdGVtcylyZXR1cm4ibW9kZWwudmFsaWRhdGlvbi5maWVsZC5hcnJheS5tYXhJdGVtcyI7aWYoZS51bmlxdWVJdGVtcyYmaS5sZW5ndGg+dC51bmlxKGkpLmxlbmd0aClyZXR1cm4gcC5FUlJPUl9JQVJSQVlfVU5JUVVFO2lmKGUuaXRlbXMpZm9yKHZhciBuPXMoZS5pdGVtcywicGxhY2Vob2xkZXIiKSxyPTA7cjxpLmxlbmd0aDtyKyspe3ZhciBvPWlbcl0sYT1kKG4sbyk7aWYoYSlyZXR1cm4gYS5wbGFjZWhvbGRlcn19dmFyIHAsZj17ZW1haWw6ZnVuY3Rpb24odCl7dmFyIGU9L14oKFtePD4oKVxbXF1cXC4sOzpcc0AiXSsoXC5bXjw+KClcW1xdXFwuLDs6XHNAIl0rKSopfCgiLisiKSlAKChcW1swLTldezEsM31cLlswLTldezEsM31cLlswLTldezEsM31cLlswLTldezEsM31dKXwoKFthLXpBLVpcLTAtOV0rXC4pK1thLXpBLVpdezIsfSkpJC87cmV0dXJuIGwodCxlLHAuRVJST1JfSU5WQUxJRF9GT1JNQVRfRU1BSUwpfSx1cmk6ZnVuY3Rpb24odCl7dmFyIGU9L14oPzooPzpodHRwcz98ZnRwKTpcL1wvKSg/OlxTKyg/OjpcUyopP0ApPyg/Oig/ISg/OjEwfDEyNykoPzpcLlxkezEsM30pezN9KSg/ISg/OjE2OVwuMjU0fDE5MlwuMTY4KSg/OlwuXGR7MSwzfSl7Mn0pKD8hMTcyXC4oPzoxWzYtOV18MlxkfDNbMC0xXSkoPzpcLlxkezEsM30pezJ9KSg/OlsxLTldXGQ/fDFcZFxkfDJbMDFdXGR8MjJbMC0zXSkoPzpcLig/OjE/XGR7MSwyfXwyWzAtNF1cZHwyNVswLTVdKSl7Mn0oPzpcLig/OlsxLTldXGQ/fDFcZFxkfDJbMC00XVxkfDI1WzAtNF0pKXwoPzooPzpbYS16XHUwMGExLVx1ZmZmZjAtOV0tKikqW2Etelx1MDBhMS1cdWZmZmYwLTldKykoPzpcLig/OlthLXpcdTAwYTEtXHVmZmZmMC05XS0qKSpbYS16XHUwMGExLVx1ZmZmZjAtOV0rKSooPzpcLig/OlthLXpcdTAwYTEtXHVmZmZmXXsyLH0pKVwuPykoPzo6XGR7Miw1fSk/KD86W1wvPyNdXFMqKT8kL2k7cmV0dXJuIGwodCxlLHAuRVJST1JfSU5WQUxJRF9GT1JNQVRfVVJJKX0saXB2NDpmdW5jdGlvbih0KXt2YXIgZT0vXig/Oig/OjI1WzAtNV18MlswLTRdWzAtOV18WzAxXT9bMC05XVswLTldPylcLil7M30oPzoyNVswLTVdfDJbMC00XVswLTldfFswMV0/WzAtOV1bMC05XT8pJC87cmV0dXJuIGwodCxlLHAuRVJST1JfSU5WQUxJRF9GT1JNQVRfSVBWNCl9LGhvc3RuYW1lOmZ1bmN0aW9uKHQpe3ZhciBlPS9eKChbYS16QS1aMC05XXxbYS16QS1aMC05XVthLXpBLVowLTlcLV0qW2EtekEtWjAtOV0pXC4pKihbQS1aYS16MC05XXxbQS1aYS16MC05XVtBLVphLXowLTlcLV0qW0EtWmEtejAtOV0pJC87cmV0dXJuIGwodCxlLHAuRVJST1JfSU5WQUxJRF9GT1JNQVRfSE9TVE5BTUUpfX07cmV0dXJuIHA9ZS5Nb2RlbC5leHRlbmQoe3Byb3BzOnt9LGRlcml2ZWQ6e30sbG9jYWw6e30sZXh0cmFQcm9wZXJ0aWVzOiExLGZsYXQ6ITAsZGVmYXVsdHM6e30sY29uc3RydWN0b3I6ZnVuY3Rpb24obil7dGhpcy5vcHRpb25zPW58fHt9O3ZhciByPXRoaXMuX19zY2hlbWFfXz17fSxvPVtdO3IuY29tcHV0ZWRQcm9wZXJ0aWVzPXt9LHIuZXh0cmFQcm9wZXJ0aWVzPXRoaXMuZXh0cmFQcm9wZXJ0aWVzLHIucHJvcHM9dC5jbG9uZSh0LnJlc3VsdCh0aGlzLCJwcm9wcyIpfHx7fSksci5kZXJpdmVkPXQuY2xvbmUodC5yZXN1bHQodGhpcywiZGVyaXZlZCIpfHx7fSksci5sb2NhbD10LmNsb25lKHQucmVzdWx0KHRoaXMsImxvY2FsIil8fHt9KTt2YXIgYT17fTtpZih0LmVhY2godC5leHRlbmQoe30sci5wcm9wcyxyLmxvY2FsKSxmdW5jdGlvbihlLGkpe3ZhciBuPXMoZSxpKTt0LmlzVW5kZWZpbmVkKG4udmFsdWUpfHwoYVtpXT1uLnZhbHVlKSwib2JqZWN0Ij09PW4udHlwZSYmby5wdXNoKGkpfSx0aGlzKSx0LnNpemUoYSkpe3ZhciBsPXQucmVzdWx0KHRoaXMsImRlZmF1bHRzIik7dGhpcy5kZWZhdWx0cz1mdW5jdGlvbigpe3JldHVybiB0LmRlZmF1bHRzKHt9LGEsbCl9fXRoaXMudmFsaWRhdGU9dC53cmFwKHRoaXMudmFsaWRhdGUsZnVuY3Rpb24oZSl7dmFyIGk9dC5yZXN0KGFyZ3VtZW50cyksbj10LmV4dGVuZCh0aGlzLl92YWxpZGF0ZVNjaGVtYS5hcHBseSh0aGlzLGkpLGUuYXBwbHkodGhpcyxpKSk7cmV0dXJuIHQuc2l6ZShuKSYmbnx8dm9pZCAwfSksdGhpcy5wYXJzZT10LndyYXAodGhpcy5wYXJzZSxmdW5jdGlvbihlKXt2YXIgbj1lLmFwcGx5KHRoaXMsdC5yZXN0KGFyZ3VtZW50cykpO3JldHVybiB0aGlzLmZsYXQmJihuPWkobixvKSksbn0pLGUuTW9kZWwuYXBwbHkodGhpcyxhcmd1bWVudHMpLHQuZWFjaChyLmRlcml2ZWQsZnVuY3Rpb24odCxlKXtyLmNvbXB1dGVkUHJvcGVydGllc1tlXT10aGlzLl9fZ2V0RGVyaXZlZFZhbHVlKGUpO3ZhciBpPXQuZGVwc3x8W107aS5sZW5ndGgmJnRoaXMub24oImNhY2hlOmNsZWFyIGNoYW5nZToiK2kuam9pbigiIGNoYW5nZToiKSxmdW5jdGlvbigpe3ZhciB0PXRoaXMuX19nZXREZXJpdmVkVmFsdWUoZSk7dCE9PXIuY29tcHV0ZWRQcm9wZXJ0aWVzW2VdJiYoci5jb21wdXRlZFByb3BlcnRpZXNbZV09dCx0aGlzLnRyaWdnZXIoImNoYW5nZToiK2UsdGhpcyx0KSl9LHRoaXMpfSx0aGlzKSx0aGlzLm9uKCJzeW5jIixmdW5jdGlvbigpe3RoaXMuX19zeW5jZWREYXRhPXRoaXMudG9KU09OKCl9LHRoaXMpfSx2YWxpZGF0ZTpmdW5jdGlvbigpe30sYWxsb3dzOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMuX19zY2hlbWFfXyxuPXQuZXh0ZW5kKHt9LGkucHJvcHMsaS5sb2NhbCk7cmV0dXJuISF0LmhhcyhuLGUpfHwhIWEuY2FsbCh0aGlzLGkuZXh0cmFQcm9wZXJ0aWVzLGUpfSxnZXRQcm9wZXJ0eVNjaGVtYTpmdW5jdGlvbihlKXt2YXIgaT10aGlzLl9fc2NoZW1hX187cmV0dXJuIHQucmVkdWNlKFtpLnByb3BzLGkubG9jYWxdLGZ1bmN0aW9uKHQsaSl7cmV0dXJuIHR8fHMoaVtlXSxlKX0sbnVsbCl9LHNldDpmdW5jdGlvbihpLG4pe3ZhciByOyJvYmplY3QiPT10eXBlb2YgaT9yPWk6KHI9e30pW2ldPW4sdC5lYWNoKHIsZnVuY3Rpb24oZSxpKXtpZih0Lmhhcyh0aGlzLl9fc2NoZW1hX18uZGVyaXZlZCxpKSl0aHJvdyJvdmVycmlkaW5nIGRlcml2ZWQgcHJvcGVydGllcyBpcyBub3Qgc3VwcG9ydGVkOiAiK2l9LHRoaXMpO3ZhciBzPVtdO2lmKHQuZWFjaChyLGZ1bmN0aW9uKHQsZSl7dGhpcy5hbGxvd3MoZSl8fHMucHVzaChlKX0sdGhpcykscy5sZW5ndGgpdGhyb3ciZmllbGQgbm90IGFsbG93ZWQ6ICIrcy5qb2luKCIsICIpO3JldHVybiBlLk1vZGVsLnByb3RvdHlwZS5zZXQuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxnZXQ6ZnVuY3Rpb24oaSl7dmFyIG49dGhpcy5fX3NjaGVtYV9fO3JldHVybiB0LmhhcyhuLmRlcml2ZWQsaSk/bi5kZXJpdmVkW2ldLmNhY2hlIT09ITE/bi5jb21wdXRlZFByb3BlcnRpZXNbaV06dGhpcy5fX2dldERlcml2ZWRWYWx1ZShpKTplLk1vZGVsLnByb3RvdHlwZS5nZXQuYXBwbHkodGhpcyxhcmd1bWVudHMpfSx0b0pTT046ZnVuY3Rpb24oaSl7aXx8KGk9e30pO3ZhciByPXQuY2xvbmUoZS5Nb2RlbC5wcm90b3R5cGUudG9KU09OLmFwcGx5KHRoaXMsYXJndW1lbnRzKSkscz10aGlzLl9fc2NoZW1hX187cmV0dXJuIGkudmVyYm9zZT90LmVhY2gocy5kZXJpdmVkLGZ1bmN0aW9uKHQsZSl7cltlXT10aGlzLmdldChlKX0sdGhpcyk6cj10Lm9taXQocix0LmtleXMocy5sb2NhbCkpLHRoaXMuZmxhdCYmKHI9bihyKSkscn0scmVzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5jbGVhcihlKSx0aGlzLnNldCh0LnJlc3VsdCh0aGlzLCJkZWZhdWx0cyIpLGUpfSxpc1N5bmNlZDpmdW5jdGlvbigpe3JldHVybiB0LmlzRXF1YWwodGhpcy5fX3N5bmNlZERhdGEsdGhpcy50b0pTT04oKSl9LHZhbGlkYXRlRmllbGQ6ZnVuY3Rpb24odCl7dmFyIGU9dCYmdGhpcy5nZXRQcm9wZXJ0eVNjaGVtYSh0KTtyZXR1cm4gZSYmZChlLHRoaXMuZ2V0KHQpKX0sX3ZhbGlkYXRlU2NoZW1hOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fX3NjaGVtYV9fO3JldHVybiB0LnJlZHVjZSh0LmV4dGVuZCh7fSxlLnByb3BzLGUubG9jYWwpLGZ1bmN0aW9uKGUsaSxuKXtyZXR1cm4gdC5leHRlbmQoZSx0aGlzLnZhbGlkYXRlRmllbGQobil8fHt9KX0se30sdGhpcyl9LF9fZ2V0RGVyaXZlZFZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMuX19zY2hlbWFfXy5kZXJpdmVkW2VdO2lmKHQuaXNTdHJpbmcoaSkpe3ZhciBuPWk7aT17ZGVwczpbbl0sZm46ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXQobil9fX12YXIgcj1pLmRlcHN8fFtdO3JldHVybiBpLmZuLmFwcGx5KHRoaXMsdC5tYXAocix0aGlzLmdldCx0aGlzKSl9fSx7RVJST1JfQkxBTks6Im1vZGVsLnZhbGlkYXRpb24uZmllbGQuYmxhbmsiLEVSUk9SX1dST05HX1RZUEU6Im1vZGVsLnZhbGlkYXRpb24uZmllbGQud3JvbmcudHlwZSIsRVJST1JfTk9UX0FMTE9XRUQ6Im1vZGVsLnZhbGlkYXRpb24uZmllbGQudmFsdWUubm90LmFsbG93ZWQiLEVSUk9SX0lOVkFMSUQ6Im1vZGVsLnZhbGlkYXRpb24uZmllbGQuaW52YWxpZCIsRVJST1JfSUFSUkFZX1VOSVFVRToibW9kZWwudmFsaWRhdGlvbi5maWVsZC5hcnJheS51bmlxdWUiLEVSUk9SX0lOVkFMSURfRk9STUFUX0VNQUlMOiJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLmludmFsaWQuZm9ybWF0LmVtYWlsIixFUlJPUl9JTlZBTElEX0ZPUk1BVF9VUkk6Im1vZGVsLnZhbGlkYXRpb24uZmllbGQuaW52YWxpZC5mb3JtYXQudXJpIixFUlJPUl9JTlZBTElEX0ZPUk1BVF9JUFY0OiJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLmludmFsaWQuZm9ybWF0LmlwdjQiLEVSUk9SX0lOVkFMSURfRk9STUFUX0hPU1ROQU1FOiJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLmludmFsaWQuZm9ybWF0Lmhvc3RuYW1lIixFUlJPUl9TVFJJTkdfU1RSSU5HX01JTl9MRU5HVEg6Im1vZGVsLnZhbGlkYXRpb24uZmllbGQuc3RyaW5nLm1pbkxlbmd0aCIsRVJST1JfU1RSSU5HX1NUUklOR19NQVhfTEVOR1RIOiJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLnN0cmluZy5tYXhMZW5ndGgifSl9KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDEzNildLHI9ZnVuY3Rpb24odCxlKXt2YXIgaT1mdW5jdGlvbihlKXt2YXIgaT10Lm9taXQoZS5sb2NhbCx0LmtleXMoZS5fYnVpbHRJbkxvY2FsUHJvcHMpKTtyZXR1cm4gdC5zaXplKGUucHJvcHMpK3Quc2l6ZShpKT4wfSxuPWUuZXh0ZW5kKHtmbGF0OiExLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5vbigic3luYyIsdGhpcy5fc2V0U3luY2VkKX0sYWxsb3dzOmZ1bmN0aW9uKCl7cmV0dXJuIWkodGhpcyl8fGUucHJvdG90eXBlLmFsbG93cy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHNldDpmdW5jdGlvbihpLG4pe3ZhciByO3JldHVybiJvYmplY3QiPT10eXBlb2YgaT9yPWk6KHI9e30pW2ldPW4sdChyKS5lYWNoKGZ1bmN0aW9uKGUsaSl7ZSYmdC5pc0FycmF5KGUuX19hdHRyaWJ1dGVzKSYmdGhpcy5vbigiY2hhbmdlOiIrZS5fX2F0dHJpYnV0ZXMuam9pbigiIGNoYW5nZToiKSxmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0KGkpO3QhPT10aGlzLl9fc2NoZW1hX18uY29tcHV0ZWRQcm9wZXJ0aWVzW2ldJiYodGhpcy5fX3NjaGVtYV9fLmNvbXB1dGVkUHJvcGVydGllc1tpXT10LHRoaXMudHJpZ2dlcigiY2hhbmdlOiIraSx0KSl9LHRoaXMpfSx0aGlzKSxlLnByb3RvdHlwZS5zZXQuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxnZXQ6ZnVuY3Rpb24oKXt2YXIgaT1lLnByb3RvdHlwZS5nZXQuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiB0LmlzRnVuY3Rpb24oaSk/aS5hcHBseSh0aGlzLHQubWFwKGkuX19hdHRyaWJ1dGVzfHxbXSx0aGlzLmdldCx0aGlzKSk6aX0sdG9KU09OOmZ1bmN0aW9uKGkpe2l8fChpPXt9KTt2YXIgbj1lLnByb3RvdHlwZS50b0pTT04uYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiB0KG4pLmVhY2goZnVuY3Rpb24odCxlKXsiZnVuY3Rpb24iPT10eXBlb2YgdCYmKGkudmVyYm9zZT9uW2VdPXRoaXMuZ2V0KGUpOmRlbGV0ZSBuW2VdKX0sdGhpcyksaS52ZXJib3NlfHx0KG4pLmVhY2goZnVuY3Rpb24odCxlKXsvXl9fXHcrX18kLy50ZXN0KGUpJiZkZWxldGUgbltlXX0pLG59LHNhbml0aXplQXR0cmlidXRlczpmdW5jdGlvbihlKXt2YXIgaT17fTtyZXR1cm4gdC5lYWNoKGUsZnVuY3Rpb24oZSxuKXt0LmlzRnVuY3Rpb24oZSl8fChpW25dPWUpfSksaX0scmVzZXQ6ZnVuY3Rpb24odCl7dGhpcy5jbGVhcih0KSx0aGlzLnNldCh0aGlzLnNhbml0aXplQXR0cmlidXRlcyh0aGlzLmRlZmF1bHRzKSx0KX0sY2xlYXI6ZnVuY3Rpb24oZSl7dmFyIGk9e307cmV0dXJuIHQuZWFjaCh0aGlzLnNhbml0aXplQXR0cmlidXRlcyh0aGlzLmF0dHJpYnV0ZXMpLGZ1bmN0aW9uKHQsZSl7aVtlXT12b2lkIDB9KSx0aGlzLnNldChpLHQuZXh0ZW5kKHt9LGUse3Vuc2V0OiEwfSkpfSxfc2V0U3luY2VkOmZ1bmN0aW9uKGUpe3RoaXMuX3N5bmNlZERhdGE9ZSYmdC5pc0Z1bmN0aW9uKGUudG9KU09OKT9lLnRvSlNPTigpOnt9fSxfZ2V0U3luY2VkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3N5bmNlZERhdGF9LGlzU3luY2VkOmZ1bmN0aW9uKCl7cmV0dXJuIHQuaXNFcXVhbCh0aGlzLl9nZXRTeW5jZWQoKSx0aGlzLnRvSlNPTigpKX19LHtDb21wdXRlZFByb3BlcnR5OmZ1bmN0aW9uKCl7dmFyIGU9dC50b0FycmF5KGFyZ3VtZW50cyksaT1lLnBvcCgpO3JldHVybiBpLl9fYXR0cmlidXRlcz1lLnBvcCgpLGl9fSk7cmV0dXJuIG59LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuO249ZnVuY3Rpb24oKXt9LmNhbGwoZSxpLGUsdCksISh2b2lkIDAhPT1uJiYodC5leHBvcnRzPW4pKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDEpXSxyPWZ1bmN0aW9uKHQpe3JldHVybntUYWJsZUZhY3Rvcnk6dH19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHIsczshZnVuY3Rpb24obyxhKXtyPVtpKDIpLGkoMTQyKV0sbj1hLHM9ImZ1bmN0aW9uIj09dHlwZW9mIG4/bi5hcHBseShlLHIpOm4sISh2b2lkIDAhPT1zJiYodC5leHBvcnRzPXMpKX0odGhpcyxmdW5jdGlvbih0LGUpe2Z1bmN0aW9uIGkoZSl7cmV0dXJuIHQubWFwKGUsZnVuY3Rpb24oZSl7cmV0dXJuIHQuaXNTdHJpbmcoZSkmJihlPXtuYW1lOmV9KSwhZS5uYW1lJiZlLmZpZWxkJiYoZT10LmV4dGVuZCh7bmFtZTplLmZpZWxkfSxlKSksZX0pfWZ1bmN0aW9uIG4oZSl7dmFyIGk9e307cmV0dXJuIHQuZWFjaChlfHx7fSxmdW5jdGlvbihlLG4pe2lbbl09ZnVuY3Rpb24oaSl7aS5wcmV2ZW50RGVmYXVsdCgpLGkuc3RvcFByb3BhZ2F0aW9uKCksdC5pc0Z1bmN0aW9uKGUpJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19LHRoaXMpLGl9cmV0dXJue2NyZWF0ZUhlYWRlcjpmdW5jdGlvbihuKXtyZXR1cm4gZS5leHRlbmQoe3RhZ05hbWU6InRoZWFkIix0ZW1wbGF0ZToiPHRyPjwvdHI+Iixpbml0aWFsaXplOmZ1bmN0aW9uKCl7dC5lYWNoKGkobiksZnVuY3Rpb24odCl7dGhpcy5hZGQoZS5leHRlbmQoe2VsOic8dGggcm9sZT0iY29sdW1uaGVhZGVyIj48L3RoPicsY2hpbGRyZW46dC5oZWFkZXJWaWV3JiZbdC5oZWFkZXJWaWV3XSx0ZW1wbGF0ZTp0LmhlYWRlclZpZXc/bnVsbDp0LmxhYmVsfHwiJm5ic3A7In0pLCJ0ciIpfSx0aGlzKX19KX0sY3JlYXRlUm93OmZ1bmN0aW9uKG4pe3ZhciByPXRoaXM7cmV0dXJuIGUuZXh0ZW5kKHt0YWdOYW1lOiJ0Ym9keSIsdGVtcGxhdGU6Jzx0ciByb2xlPSJyb3ciPjwvdHI+JyxjaGlsZHJlbjp0Lm1hcChpKG4pLGZ1bmN0aW9uKHQpe3JldHVybltyLmNyZWF0ZUNlbGwodCksInRyIl19KX0pfSxjcmVhdGVDZWxsOmZ1bmN0aW9uKGkpe3ZhciByPXQuZXh0ZW5kKHQucGljayhpLCJjbGFzc05hbWUiLCJhdHRyaWJ1dGVzIiwiaW5pdGlhbGl6ZSIpLHt0YWdOYW1lOiJ0ZCIsZXZlbnRzOm4oaS5ldmVudHMpLGNoaWxkcmVuOmkudmlldyYmW2kudmlld10sdGVtcGxhdGU6aS52aWV3P251bGw6aS50ZW1wbGF0ZXx8Int7IitpLm5hbWUrIn19In0pO3JldHVybiBlLmV4dGVuZChyKX0sX19ub3JtYWxpemVGaWVsZHM6aSxfX2NsZWFuRXZlbnRzOm59fSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyLHM7IWZ1bmN0aW9uKG8sYSl7cj1baSgyKSxpKDM1KV0sbj1hLHM9ImZ1bmN0aW9uIj09dHlwZW9mIG4/bi5hcHBseShlLHIpOm4sISh2b2lkIDAhPT1zJiYodC5leHBvcnRzPXMpKX0odGhpcyxmdW5jdGlvbih0LGUpe2Z1bmN0aW9uIGkodCxlKXtmb3IodmFyIGk9MDtpPHRbb10ubGVuZ3RoO2krKylpZihlLmNpZD09PXRbb11baV0uY2lkKXJldHVybiBpfWZ1bmN0aW9uIG4oKXt9ZnVuY3Rpb24gcih0KXt0W2FdPSEwO3ZhciBlPXQucmVuZGVyVGVtcGxhdGUodC50ZW1wbGF0ZSk7ZT90LiRlbC5odG1sKGUpOnQubGVuZ3RoJiZ0LiRlbC5lbXB0eSgpLHQuZWFjaChmdW5jdGlvbih0KXt0W3VdKCl9KX1mdW5jdGlvbiBzKGUpe3ZhciBpPS9eKD8hKD86ZGVsZWdhdGV8dW5kZWxlZ2F0ZXxfKSkoW2EtekEtWjAtOV0rKSg/OkV2ZW50cykkLzt0LmVhY2godC5hbGxLZXlzKGUpLGZ1bmN0aW9uKG4pe3ZhciByPW4ubWF0Y2goaSk7aWYocil7dmFyIHM9dC5yZXN1bHQoZSxuKSxvPWUub3B0aW9uc1tyWzFdXXx8ZVtyWzFdXTtvJiZ0LmlzT2JqZWN0KHMpJiZ0LmlzRnVuY3Rpb24oby50cmlnZ2VyKSYmdC5lYWNoKHMsZnVuY3Rpb24oaSxuKXt2YXIgcj10LmlzRnVuY3Rpb24oaSk/W2ldOnQucmVkdWNlKGkuc3BsaXQoL1xzKy8pLGZ1bmN0aW9uKGksbil7cmV0dXJuIHQuaXNGdW5jdGlvbihlW25dKSYmaS5wdXNoKGVbbl0pLGl9LFtdKTt0LmVhY2gocixmdW5jdGlvbih0KXtlLmxpc3RlblRvKG8sbix0KX0pfSl9fSl9dmFyIG89Il9fY2hpbGRyZW5fXyIsYT0iX19yZW5kZXJlZF9fIixsPSJfX3BhcmVudF9fIixjPSJfX2NoaWxkcmVuX2RlZmluaXRpb25zX18iLHU9Il9fYWRkX3RvX2NvbnRhaW5lcl9fIixkPWUuVmlldy5leHRlbmQoe2NvbnN0cnVjdG9yOmZ1bmN0aW9uKGkpe3RoaXMub3B0aW9ucz1pfHx7fSx0LmV4dGVuZCh0aGlzLHQucGljayh0aGlzLm9wdGlvbnMsInN0YXRlIiwic2V0dGluZ3MiKSksdGhpc1tvXQ==", "base64"));
  res.write(new Buffer("PVtdLHRoaXNbYV09ITEsdGhpc1tsXT1udWxsLHRoaXNbY109dGhpcy5jaGlsZHJlbjt2YXIgcj10aGlzLmluaXRpYWxpemU7aWYodGhpcy5pbml0aWFsaXplPW4sZS5WaWV3LmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0LmVhY2godC5yZXN1bHQodGhpcyxjKSxmdW5jdGlvbihlKXt0aGlzLmFkZC5hcHBseSh0aGlzLHQuaXNBcnJheShlKT9lOltlXSl9LHRoaXMpLGRlbGV0ZSB0aGlzW2NdLHRoaXMuYXV0b1JlbmRlciYmdGhpcy5tb2RlbCl7dmFyIHU9dC5pc0FycmF5KHRoaXMuYXV0b1JlbmRlcik/dC5tYXAodGhpcy5hdXRvUmVuZGVyLGZ1bmN0aW9uKHQpe3JldHVybiJjaGFuZ2U6Iit0fSkuam9pbigiICIpOiJjaGFuZ2UiO3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCx1LGZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIoKX0pfXRoaXMuaW5pdGlhbGl6ZT1yLHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cykscyh0aGlzKX0sdW5yZWdpc3RlcjpmdW5jdGlvbihlKXt0aGlzLnN0b3BMaXN0ZW5pbmcoZSk7dmFyIG49aSh0aGlzLGUpO3QuaXNOdW1iZXIobikmJnRoaXNbb10uc3BsaWNlKG4sMSl9LGF1dG9SZW5kZXI6ITEsdGVtcGxhdGU6bnVsbCxjaGlsZHJlbjpbXSxhZGQ6ZnVuY3Rpb24obixyLHMsYSxjKXt2YXIgaD17fSxwPXQudG9BcnJheShhcmd1bWVudHMpO2lmKHQuaXNPYmplY3Qocik/KGg9cixyPWguc2VsZWN0b3Iscz1oLmJ1YmJsZSxhPWgucHJlcGVuZCxjPWgub3B0aW9ucyk6dC5pc09iamVjdChzKSYmKGg9cyxzPWguYnViYmxlLGE9aC5wcmVwZW5kLGM9aC5vcHRpb25zKSx0LmlzU3RyaW5nKG4pJiYobj1mdW5jdGlvbih0KXtyZXR1cm4gZC5leHRlbmQoe2NvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dHJ5e3ZhciBpPWUuJCh0KTtpZigxIT1pLmxlbmd0aCl0aHJvdyJpbnZhbGlkIEVsZW1lbnQiO3RoaXMudGVtcGxhdGU9aS5odG1sKCksdGhpcy5lbD1pLmVtcHR5KClbMF19Y2F0Y2gobil7dGhpcy50ZW1wbGF0ZT10fWQuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0pfShuKSksbi5wcm90b3R5cGUmJm4ucHJvdG90eXBlIGluc3RhbmNlb2YgZCl7dmFyIGY9dC5vbWl0KHQuZXh0ZW5kKHt9LHRoaXMub3B0aW9ucyxjKSwiZWwiKTtyZXR1cm4gcFswXT1uZXcgbihmKSx0aGlzLmFkZC5hcHBseSh0aGlzLHApfWlmKHQuaXNOdW1iZXIoaSh0aGlzLG4pKSl0aHJvdyBuZXcgRXJyb3IoIkR1cGxpY2F0ZSBjaGlsZCIpO3JldHVybiBuW2xdPXRoaXMsblt1XT1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXtpZih0JiYxIT1uW2xdLiQodCkubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBzZWxlY3RvcjogIit0KTt2YXIgZT10P3RoaXNbbF0uJCh0KTp0aGlzW2xdLiRlbDt0aGlzLnJlbmRlcigpLHRoaXMuZGVsZWdhdGVFdmVudHMoKSxhP2UucHJlcGVuZCh0aGlzLmVsKTplLmFwcGVuZCh0aGlzLmVsKX19LmNhbGwobixyKSxzJiZ0aGlzLmxpc3RlblRvKG4sImFsbCIsZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpfSksdGhpcy5yZW5kZXJlZCgpJiZuW3VdKCksdGhpc1tvXS5wdXNoKG4pLHRoaXN9LHJlbW92ZUNoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbih0KXt0LnJlbW92ZSgpfSksdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVtb3ZlQ2hpbGRyZW4oKSx0aGlzW2xdJiZ0aGlzW2xdLnVucmVnaXN0ZXIodGhpcyksZS5WaWV3LnByb3RvdHlwZS5yZW1vdmUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxjb21waWxlVGVtcGxhdGU6ZnVuY3Rpb24oZSl7cmV0dXJuIHQudGVtcGxhdGUoZSl9LHJlbmRlclRlbXBsYXRlOmZ1bmN0aW9uKGUpe2lmKHQuaXNTdHJpbmcoZSkmJihlPXRoaXMuY29tcGlsZVRlbXBsYXRlKGUpKSx0LmlzRnVuY3Rpb24oZSkpcmV0dXJuIGUodGhpcy5nZXRUZW1wbGF0ZURhdGEoKSl9LGdldFRlbXBsYXRlRGF0YTpmdW5jdGlvbigpe3ZhciBlPXRoaXMubW9kZWwmJnRoaXMubW9kZWwudG9KU09OKHt2ZXJib3NlOiEwfSl8fHt9LGk9dC5vbWl0KHRoaXMub3B0aW9ucyxbInN0YXRlIiwic2V0dGluZ3MiLCJtb2RlbCIsImNvbGxlY3Rpb24iXSk7cmV0dXJuIHQuZGVmYXVsdHMoe30sZSxpKX0scmVuZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJlUmVuZGVyKCkscih0aGlzKSx0aGlzLnBvc3RSZW5kZXIoKSx0aGlzfSxwcmVSZW5kZXI6bixwb3N0UmVuZGVyOm4scmVuZGVyZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc1thXX0sZ2V0Q2hpbGRyZW46ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b0FycmF5KCl9LGF0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdldENoaWxkcmVuKClbdF19LGludm9rZTpmdW5jdGlvbihlKXt2YXIgaT10LnRvQXJyYXkoYXJndW1lbnRzKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKG4pe24uc2l6ZSgpJiZuLmludm9rZS5hcHBseShuLGkpLHQuaXNGdW5jdGlvbihuW2VdKSYmbltlXS5hcHBseShuLGkuc2xpY2UoMSkpfSksdGhpc319KSxoPVsiZWFjaCIsIm1hcCIsInJlZHVjZSIsInJlZHVjZVJpZ2h0IiwiZmluZCIsImZpbHRlciIsInJlamVjdCIsImV2ZXJ5Iiwic29tZSIsImNvbnRhaW5zIiwidG9BcnJheSIsInNpemUiLCJmaXJzdCIsImluaXRpYWwiLCJyZXN0IiwibGFzdCIsIndpdGhvdXQiLCJpbmRleE9mIiwic2h1ZmZsZSIsImxhc3RJbmRleE9mIiwiaXNFbXB0eSIsImNoYWluIiwid2hlcmUiLCJmaW5kV2hlcmUiXTtyZXR1cm4gdC5lYWNoKGgsZnVuY3Rpb24oZSl7ZC5wcm90b3R5cGVbZV09ZnVuY3Rpb24oKXt2YXIgaT10LnRvQXJyYXkoYXJndW1lbnRzKTtyZXR1cm4gaS51bnNoaWZ0KHQudG9BcnJheSh0aGlzW29dKSksdFtlXS5hcHBseSh0LGkpfX0sdGhpcyksZH0pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDE0NSksaSgxNTApLGkoMTUyKSxpKDE1MyksaSgxNTYpLGkoMTU3KSxpKDE2NSksaSgxNjcpLGkoMTY4KSxpKDE2OSksaSgxNzApLGkoMTcyKSxpKDE3MyksaSgxNDQpLGkoMTc0KSxpKDE3NSksaSgxNzYpLGkoMTQ5KSxpKDE0OCksaSgxNzcpLGkoMTgzKSxpKDE0NyksaSgxODcpLGkoMTg4KSxpKDE4OSksaSgxOTApXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSxsLGMsdSxkLGgscCxmLG0sXyxnLHYseSxiLHcsTSxrLFQsUyl7cmV0dXJue0Jhc2VDb250cm9sbGVyOnQsQmFzZVJvdXRlcjplLEJhdGNoQWpheFV0aWw6aSxCdXR0b25GYWN0b3J5Om4sQ2xhc3M6cixDbGlwYm9hcmQ6cyxDb29raWU6byxEYXRhTGlzdENvbnRyb2xsZXI6YSxFcnJvclBhcnNlcjpsLEV2ZW50czpjLGZvcm1hdFhtbDp1LEZ4OmQsS2V5czpoLExvZ2dlcjpwLE1ldHJpY3M6ZixOdW1iZXJVdGlsOm0sU2NoZW1hVXRpbDpfLFNldHRpbmdzTW9kZWw6ZyxTdGF0ZU1hY2hpbmU6dixTdHJpbmdVdGlsOnksVGFiYmVkUm91dGVyOmIsVGVtcGxhdGVVdGlsOncsVGltZTpNLFRpbWVVdGlsOmssVGltZXpvbmVVdGlsOlQsVXRpbDpTfX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG47bj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXt3aW5kb3cuY29uc29sZSYmd2luZG93LmNvbnNvbGVbdF0uYXBwbHkod2luZG93LmNvbnNvbGUsZSl9cmV0dXJue3RyYWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHQoInRyYWNlIixhcmd1bWVudHMpfSxkaXI6ZnVuY3Rpb24oKXtyZXR1cm4gdCgiZGlyIixhcmd1bWVudHMpfSx0aW1lOmZ1bmN0aW9uKCl7cmV0dXJuIHQoInRpbWUiLGFyZ3VtZW50cyl9LHRpbWVFbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdCgidGltZUVuZCIsYXJndW1lbnRzKX0sZ3JvdXA6ZnVuY3Rpb24oKXtyZXR1cm4gdCgiZ3JvdXAiLGFyZ3VtZW50cyl9LGdyb3VwRW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHQoImdyb3VwRW5kIixhcmd1bWVudHMpfSxhc3NlcnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdCgiYXNzZXJ0Iixhcmd1bWVudHMpfSxsb2c6ZnVuY3Rpb24oKXtyZXR1cm4gdCgibG9nIixhcmd1bWVudHMpfSxpbmZvOmZ1bmN0aW9uKCl7cmV0dXJuIHQoImluZm8iLGFyZ3VtZW50cyl9LHdhcm46ZnVuY3Rpb24oKXtyZXR1cm4gdCgid2FybiIsYXJndW1lbnRzKX0sZXJyb3I6ZnVuY3Rpb24oKXtyZXR1cm4gdCgiZXJyb3IiLGFyZ3VtZW50cyl9fX0uY2FsbChlLGksZSx0KSwhKHZvaWQgMCE9PW4mJih0LmV4cG9ydHM9bikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDUpLGkoMiksaSgxNDYpLGkoMTQ4KSxpKDE0OSksaSgxNTApXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzKXtmdW5jdGlvbiBvKHQpe3ZhciBpPXt9O3JldHVybiBlLmVhY2godCxmdW5jdGlvbih0LG4pe2UuaXNOdWxsKHQpfHwoaVtuXT10KX0pLGl9cmV0dXJuIGkuZXh0ZW5kKHtjb25zdHJ1Y3RvcjpmdW5jdGlvbih0KXt0fHwodD17fSk7dmFyIGE9ZS5kZWZhdWx0cyhvKHQuc3RhdGUpLHRoaXMuc3RhdGV8fHt9KTt0aGlzLnN0YXRlPW5ldyBuKGEpLGRlbGV0ZSB0LnN0YXRlLHQuc2V0dGluZ3M/dGhpcy5zZXR0aW5ncz10LnNldHRpbmdzOih0aGlzLnNldHRpbmdzPXQuc2V0dGluZ3M9bmV3IHIoZS5vbWl0KHR8fHt9LCJlbCIpKSx0aGlzLmxpc3Rlbigibm90aWZpY2F0aW9uIixzLnByb3RvdHlwZS5fbm90aWZ5KSx0aGlzLmxpc3RlbigiY29uZmlybWF0aW9uIixzLnByb3RvdHlwZS5fY29uZmlybSkpLGkuY2FsbCh0aGlzLHQpLHRoaXMubGlzdGVuVG8odGhpcy5zdGF0ZSwiX19pbnZva2VfXyIsZnVuY3Rpb24oKXt2YXIgdD1lLnRvQXJyYXkoYXJndW1lbnRzKSxpPXQuc2hpZnQoKTtlLmlzRnVuY3Rpb24odGhpc1tpXSkmJnRoaXNbaV0uYXBwbHkodGhpcyx0KX0pLHRoaXMuVmlldyYmdGhpcy5hZGQobmV3IHRoaXMuVmlldyh0aGlzLnRvSlNPTigpKSl9LHN0YXRlOnt9LFZpZXc6bnVsbCxyZW5kZXI6ZnVuY3Rpb24oKXt2YXIgZT1hcmd1bWVudHMsbj10aGlzO3JldHVybiB0KGZ1bmN0aW9uKCl7aS5wcm90b3R5cGUucmVuZGVyLmFwcGx5KG4sZSl9KSx0aGlzfSx0b0pTT046ZnVuY3Rpb24odCl7cmV0dXJuIGUuZXh0ZW5kKGUucGljayh0aGlzLCJzdGF0ZSIsInNldHRpbmdzIiwiY29sbGVjdGlvbiIsIm1vZGVsIiksdHx8e30pfSxyZW1vdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZW1vdmVDaGlsZHJlbigpLHRoaXMuc3RvcExpc3RlbmluZygpLHRoaXMuJGVsLmVtcHR5KCksdGhpc319KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMzUpLGkoMTQ3KSxpKDE0MildLHI9ZnVuY3Rpb24odCxlLGksbil7dmFyIHI9dC5jbG9uZShlLkV2ZW50cykscz17Y29uc3RydWN0b3I6ZnVuY3Rpb24oKXtuLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLm1vZHVsZSYmdGhpcy4kZWwuYXR0cigiZGF0YS12aWV3Iix0aGlzLm1vZHVsZS5pZCl9LGVtcHR5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVtb3ZlQ2hpbGRyZW4oKX0sY29tcGlsZVRlbXBsYXRlOmkudHBsLGJyb2FkY2FzdDpmdW5jdGlvbigpe3JldHVybiByLnRyaWdnZXIuYXBwbHkocixhcmd1bWVudHMpLHRoaXN9LGxpc3RlbjpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmxpc3RlblRvKHIsdCxlKSx0aGlzfSxub3RpZnk6ZnVuY3Rpb24oZSxpLG4pe3JldHVybiB0aGlzLmJyb2FkY2FzdCgibm90aWZpY2F0aW9uIix0LmRlZmF1bHRzKHttZXNzYWdlOmksbGV2ZWw6ZX0sbikpLHRoaXN9LGNvbmZpcm06ZnVuY3Rpb24oZSxpLG4scil7dmFyIHM7cmV0dXJuIHM9Im9iamVjdCI9PXR5cGVvZiBlP2U6Mj09YXJndW1lbnRzLmxlbmd0aCYmdC5pc0Z1bmN0aW9uKGkpP3t0aXRsZToiT2t0YSIsc3VidGl0bGU6ZSxvazppfTp7dGl0bGU6ZSxzdWJ0aXRsZTppLG9rOm4sY2FuY2VsRm46cn0sdC5pc0Z1bmN0aW9uKHMub2spJiYocy5vaz10LmJpbmQocy5vayx0aGlzKSksdC5pc0Z1bmN0aW9uKHMuY2FuY2VsRm4pJiYocy5jYW5jZWxGbj10LmJpbmQocy5jYW5jZWxGbix0aGlzKSksdGhpcy5icm9hZGNhc3QoImNvbmZpcm1hdGlvbiIscyksdGhpc30sYWxlcnQ6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuaXNTdHJpbmcoZSkmJihlPXtzdWJ0aXRsZTplfSksdGhpcy5jb25maXJtKHQuZXh0ZW5kKHt9LGUse25vQ2FuY2VsQnV0dG9uOiEwfSkpLHRoaXN9fTtyZXR1cm4gbi5leHRlbmQocyx7ZGVjb3JhdGU6ZnVuY3Rpb24oZSl7dmFyIGk9ZS5leHRlbmQoe30pO3JldHVybiB0LmRlZmF1bHRzKGkucHJvdG90eXBlLHMpLGl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDQpXSxyPWZ1bmN0aW9uKHQsZSl7cmV0dXJue3RwbDp0Lm1lbW9pemUoZnVuY3Rpb24odCl7cmV0dXJuIGUuY29tcGlsZSh0KX0pfX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTM2KV0scj1mdW5jdGlvbih0LGUpe3JldHVybiBlLmV4dGVuZCh7ZXh0cmFQcm9wZXJ0aWVzOiEwLGludm9rZTpmdW5jdGlvbigpe3ZhciBlPXQudG9BcnJheShhcmd1bWVudHMpO2UudW5zaGlmdCgiX19pbnZva2VfXyIpLHRoaXMudHJpZ2dlci5hcHBseSh0aGlzLGUpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxMzYpXSxyPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuZXh0ZW5kKHtsb2NhbDpmdW5jdGlvbigpe3ZhciB0PXdpbmRvdy5va3RhJiZ3aW5kb3cub2t0YS5zZXR0aW5nc3x8e307cmV0dXJue29yZ0lkOlsic3RyaW5nIiwhMSx0Lm9yZ0lkXSxvcmdOYW1lOlsic3RyaW5nIiwhMSx0Lm9yZ05hbWVdLGlzUHJldmlldzpbImJvb2xlYW4iLCExLHQuaXNQcmV2aWV3XSxzZXJ2ZXJTdGF0dXM6WyJzdHJpbmciLCExLHQuc2VydmVyU3RhdHVzXSxwZXJtaXNzaW9uczpbImFycmF5IiwhMCx0LnBlcm1pc3Npb25zfHxbXV19fSxleHRyYVByb3BlcnRpZXM6ITAsY29uc3RydWN0b3I6ZnVuY3Rpb24oKXt0aGlzLmZlYXR1cmVzPXdpbmRvdy5fZmVhdHVyZXN8fFtdLGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxoYXNGZWF0dXJlOmZ1bmN0aW9uKGUpe3JldHVybiB0LmNvbnRhaW5zKHRoaXMuZmVhdHVyZXMsZSl9LGhhc0FueUZlYXR1cmU6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuc29tZShlLHRoaXMuaGFzRmVhdHVyZSx0aGlzKX0saGFzUGVybWlzc2lvbjpmdW5jdGlvbihlKXtyZXR1cm4gdC5jb250YWlucyh0aGlzLmdldCgicGVybWlzc2lvbnMiKSxlKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDUpLGkoMiksaSgzNSksaSgxNDkpLGkoMTUxKSxpKDEzOSldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMpe3JldHVybiBpLlJvdXRlci5leHRlbmQoe2xpc3RlbjpyLnByb3RvdHlwZS5saXN0ZW4sY29uc3RydWN0b3I6ZnVuY3Rpb24odCl7dHx8KHQ9e30pLHRoaXMuZWw9dC5lbCx0aGlzLnNldHRpbmdzPW5ldyBuKGUub21pdCh0LCJlbCIpKSxpLlJvdXRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5saXN0ZW4oIm5vdGlmaWNhdGlvbiIsdGhpcy5fbm90aWZ5KSx0aGlzLmxpc3RlbigiY29uZmlybWF0aW9uIix0aGlzLl9jb25maXJtKX0sX2NvbmZpcm06ZnVuY3Rpb24odCl7dHx8KHQ9e30pO3ZhciBpPXMuZXh0ZW5kKGUucGljayh0LCJ0aXRsZSIsInN1YnRpdGxlIiwic2F2ZSIsIm9rIiwiY2FuY2VsIiwiY2FuY2VsRm4iLCJub0NhbmNlbEJ1dHRvbiIsImNvbnRlbnQiLCJkYW5nZXIiKSksbj1uZXcgaSh7bW9kZWw6dGhpcy5zZXR0aW5nc30pO3JldHVybiBuLnJlbmRlcigpLG59LF9ub3RpZnk6ZnVuY3Rpb24oZSl7dmFyIGk9bmV3IHIoZSk7cmV0dXJuIHQoIiNjb250ZW50IikucHJlcGVuZChpLnJlbmRlcigpLmVsKSxpfSxyZW5kZXI6ZnVuY3Rpb24odCxpKXt0aGlzLmNvbnRyb2xsZXImJih0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5jb250cm9sbGVyKSx0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5jb250cm9sbGVyLnN0YXRlKSx0aGlzLmNvbnRyb2xsZXIucmVtb3ZlKCkpLGk9ZS5leHRlbmQoZS5waWNrKHRoaXMsInNldHRpbmdzIiwiZWwiKSxpfHx7fSksdGhpcy5jb250cm9sbGVyPW5ldyB0KGkpLHRoaXMuY29udHJvbGxlci5yZW5kZXIoKX0sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgZT1hcmd1bWVudHM7dChmdW5jdGlvbigpe2kuaGlzdG9yeS5zdGFydC5hcHBseShpLmhpc3RvcnksZSl9KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDUpLGkoMiksaSgxNDYpXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj17bGV2ZWw6InN1Y2Nlc3MiLG1lc3NhZ2U6IkdyZWF0IFN1Y2Nlc3MhIixoaWRlOiEwLGZhZGU6NDAwLGRlbGF5OjNlMyx3aWR0aDowLGRpc21pc3NhYmxlOiExfTtyZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToiaW5mb2JveCBpbmZvYm94LWNvbmZpcm0gaW5mb2JveC1jb25maXJtLWZpeGVkIixldmVudHM6eyJjbGljayAuaW5mb2JveC1kaXNtaXNzLWxpbmsiOiJmYWRlT3V0In0sdGVtcGxhdGU6J1x0ICAgICAge3sjaWYgZGlzbWlzc2FibGV9fVx0ICAgICAgPGEgY2xhc3M9ImluZm9ib3gtZGlzbWlzcy1saW5rIiB0aXRsZT0iRGlzbWlzcyIgaHJlZj0iIyI+XHQgICAgICAgIDxzcGFuIGNsYXNzPSJkaXNtaXNzLWljb24iPjwvc3Bhbj5cdCAgICAgIDwvYT5cdCAgICAgIHt7L2lmfX1cdCAgICAgIDxzcGFuIGNsYXNzPSJpY29uIHt7bGV2ZWx9fS0xNiI+PC9zcGFuPlx0ICAgICAge3sjaWYgdGl0bGV9fTxoMz57e3RpdGxlfX08L2gzPnt7L2lmfX1cdCAgICAgIDxwPnt7bWVzc2FnZX19PC9wPlx0ICAgICcsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMub3B0aW9ucz1lLmRlZmF1bHRzKHt9LHRoaXMub3B0aW9ucyxuKSx0aGlzLiRlbC5hZGRDbGFzcygiaW5mb2JveC0iK3RoaXMub3B0aW9ucy5sZXZlbCksdGhpcy5vcHRpb25zLndpZHRoJiZ0aGlzLiRlbC53aWR0aCh0aGlzLm9wdGlvbnMud2lkdGgpLmNzcyh7Im1hcmdpbi1sZWZ0IjoiMHB4IixsZWZ0Ok1hdGgucm91bmQoKHQod2luZG93KS53aWR0aCgpLXRoaXMub3B0aW9ucy53aWR0aCkvMil9KX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJuIGUuZXh0ZW5kKGUucGljayh0aGlzLm9wdGlvbnMsImxldmVsIiwibWVzc2FnZSIsInRpdGxlIikse2Rpc21pc3NhYmxlOnRoaXMub3B0aW9ucy5oaWRlPT09ITF8fHRoaXMub3B0aW9ucy5kaXNtaXNzYWJsZT09PSEwfSl9LHBvc3RSZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuaGlkZSYmZS5kZWxheShlLmJpbmQodGhpcy5mYWRlT3V0LHRoaXMpLHRoaXMub3B0aW9ucy5kZWxheSl9LGZhZGVPdXQ6ZnVuY3Rpb24oKXt0aGlzLiRlbC5mYWRlT3V0KHRoaXMub3B0aW9ucy5mYWRlLGUuYmluZCh0aGlzLnJlbW92ZSx0aGlzKSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg1KSxpKDIpXSxyPWZ1bmN0aW9uKHQsZSl7dmFyIGk9e3F1ZXJ5QnVpbGRGbjplLm5vb3AsYmF0Y2hTaXplOjIwfTtyZXR1cm57Z2V0QnlJZHM6ZnVuY3Rpb24obil7dmFyIHI9ZS5kZWZhdWx0cyh7fSxuLGkpLHM9ci5pZHM7aWYoIWUuaXNTdHJpbmcoci51cmwpKXRocm93IG5ldyBFcnJvcigiRXhwZWN0aW5nIGFuIHN0cmluZyBVUkwgYnV0IGdldDogIityLnVybCk7aWYoIWUuaXNBcnJheShzKXx8ZS5pc0VtcHR5KHMpKXRocm93IG5ldyBFcnJvcigiRXhwZWN0aW5nIGFuIGxpc3Qgb2YgSURzIGJ1dCBnZXQ6ICIrcyk7aWYoIWUuaXNOdW1iZXIoci5iYXRjaFNpemUpfHwwPT09ci5iYXRjaFNpemV8fHMubGVuZ3RoPD1yLmJhdGNoU2l6ZSlyZXR1cm4gdC5nZXQoci51cmwsci5xdWVyeUJ1aWxkRm4ocykpO3ZhciBvPWUuY2hhaW4ocykuZ3JvdXBCeShmdW5jdGlvbih0LGUpe3JldHVybiBNYXRoLmZsb29yKGUvci5iYXRjaFNpemUpfSkudmFsdWVzKCkubWFwKGZ1bmN0aW9uKGUpe3JldHVybiB0LmdldChyLnVybCxyLnF1ZXJ5QnVpbGRGbihlKSl9LHRoaXMpLnZhbHVlKCk7cmV0dXJuIHQud2hlbi5hcHBseSh0LG8pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gZS5jaGFpbihhcmd1bWVudHMpLm1hcChlLmZpcnN0KS5mbGF0dGVuKCkudmFsdWUoKX0pfX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE1NCldLHI9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKGUpe3ZhciBpPXQuZXh0ZW5kKGUuY2xpY2s/e2NsaWNrOmUuY2xpY2t9Ont9LGUuZXZlbnRzfHx7fSksbj17fTtyZXR1cm4gdC5lYWNoKGksZnVuY3Rpb24odCxpKXtuW2ldPWZ1bmN0aW9uKGkpe2UuaHJlZnx8KGkucHJldmVudERlZmF1bHQoKSxpLnN0b3BQcm9wYWdhdGlvbigpKSx0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KSxufXJldHVybntjcmVhdGU6ZnVuY3Rpb24obil7cmV0dXJuIG49dC5jbG9uZShuKSxlLmV4dGVuZCh0LmV4dGVuZChuLHtldmVudHM6aShuKX0pKX19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDYpLGkoMTU1KV0scj1mdW5jdGlvbih0LGUsaSl7dmFyIG49e2NsaWNrOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpfX07cmV0dXJuIGUuZXh0ZW5kKHt0YWdOYW1lOiJhIix0ZW1wbGF0ZTone3sjaWYgaWNvbn19PHNwYW4gY2xhc3M9Imljb24ge3tpY29ufX0iPjwvc3Bhbj57ey9pZn19e3sjaWYgdGl0bGV9fXt7dGl0bGV9fXt7L2lmfX0nLHZpc2libGU6ITAsZW5hYmxlZDohMCxlbmFibGVXaGVuOnt9LHNob3dXaGVuOnt9LAoJY29uc3RydWN0b3I6ZnVuY3Rpb24odCl7dGhpcy5vcHRpb25zPXR8fHt9O3ZhciBpPXRoaXMuZ2V0VGVtcGxhdGVEYXRhKCk7dGhpcy5kaXNhYmxlZD0hMSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLiRlbC5hZGRDbGFzcygibGluay1idXR0b24iKSxpLmljb24mJih0aGlzLiRlbC5hZGRDbGFzcygibGluay1idXR0b24taWNvbiIpLGkudGl0bGV8fHRoaXMuJGVsLmFkZENsYXNzKCJpY29uLW9ubHkiKSl9LGdldFRlbXBsYXRlRGF0YTpmdW5jdGlvbigpe3JldHVybntocmVmOnRoaXMuX19nZXRBdHRyaWJ1dGUoImhyZWYiKSx0aXRsZTp0aGlzLl9fZ2V0QXR0cmlidXRlKCJ0aXRsZSIpLGljb246dGhpcy5fX2dldEF0dHJpYnV0ZSgiaWNvbiIpfX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe2kuYXBwbHlEb1doZW4odGhpcyx0LnJlc3VsdEN0eCh0aGlzLCJlbmFibGVXaGVuIix0aGlzKSx0aGlzLnRvZ2dsZSksaS5hcHBseURvV2hlbih0aGlzLHQucmVzdWx0Q3R4KHRoaXMsInNob3dXaGVuIix0aGlzKSx0aGlzLnRvZ2dsZVZpc2libGUpfSxyZW5kZXI6ZnVuY3Rpb24oKXtlLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHQucmVzdWx0KHRoaXMsImVuYWJsZWQiKXx8dGhpcy50b2dnbGUoITEpLHQucmVzdWx0KHRoaXMsInZpc2libGUiKXx8dGhpcy50b2dnbGVWaXNpYmxlKCExKTt2YXIgaT10aGlzLmdldFRlbXBsYXRlRGF0YSgpO3JldHVybiB0aGlzLiRlbC5hdHRyKCJocmVmIixpLmhyZWZ8fCIjIiksdGhpc30sX19nZXRBdHRyaWJ1dGU6ZnVuY3Rpb24oZSxpKXt2YXIgbj10LnJlc3VsdEN0eCh0aGlzLm9wdGlvbnMsZSx0aGlzKTtyZXR1cm4gdC5pc1VuZGVmaW5lZChuKSYmKG49dC5yZXN1bHQodGhpcyxlKSksdC5pc1VuZGVmaW5lZChuKT9pOm59LGVuYWJsZTpmdW5jdGlvbigpe3RoaXMudG9nZ2xlKCEwKX0sZGlzYWJsZTpmdW5jdGlvbigpe3RoaXMudG9nZ2xlKCExKX0sc2hvdzpmdW5jdGlvbigpe3RoaXMudG9nZ2xlVmlzaWJsZSghMCl9LGhpZGU6ZnVuY3Rpb24oKXt0aGlzLnRvZ2dsZVZpc2libGUoITEpfSx0b2dnbGU6ZnVuY3Rpb24oZSl7dmFyIGk9ISFlJiZ0LnJlc3VsdCh0aGlzLCJlbmFibGVkIik7dGhpcy5kaXNhYmxlZD0haSx0aGlzLiRlbC50b2dnbGVDbGFzcygibGluay1idXR0b24tZGlzYWJsZWQgYnRuLWRpc2FibGVkIGRpc2FibGVkIix0aGlzLmRpc2FibGVkKSx0LmRlZmVyKHQuYmluZChmdW5jdGlvbigpe3RoaXMuZGVsZWdhdGVFdmVudHModGhpcy5kaXNhYmxlZD9uOm51bGwpfSx0aGlzKSl9LHRvZ2dsZVZpc2libGU6ZnVuY3Rpb24oZSl7dmFyIGk9IWV8fCF0LnJlc3VsdCh0aGlzLCJ2aXNpYmxlIik7dGhpcy4kZWwudG9nZ2xlQ2xhc3MoImhpZGUiLGkpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMildLHI9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlKXtyZXR1cm4iY2hhbmdlOiIrdC5rZXlzKGUpLmpvaW4oIiBjaGFuZ2U6Iil9ZnVuY3Rpb24gaShlLGkpe3ZhciBuPXRoaXMubW9kZWwuZ2V0KGkpO3JldHVybiB0LmlzRnVuY3Rpb24oZSk/ZS5jYWxsKHRoaXMsbik6ZT09bn1mdW5jdGlvbiBuKGksbixyKXt2YXIgcz10LmJpbmQocixpLGksbik7aS5yZW5kZXI9dC53cmFwKGkucmVuZGVyLGZ1bmN0aW9uKHQpe3ZhciBlPXQuY2FsbChpKTtyZXR1cm4gcyh7YW5pbWF0ZTohMX0pLGV9KSxpLmxpc3RlblRvKGkubW9kZWwsZShuKSxmdW5jdGlvbigpe3Moe2FuaW1hdGU6ITB9KX0pfXJldHVybnthcHBseURvV2hlbjpmdW5jdGlvbihlLHIscyl7ZS5tb2RlbCYmdC5pc09iamVjdChyKSYmdC5zaXplKHIpJiZ0LmlzRnVuY3Rpb24ocykmJm4oZSxyLGZ1bmN0aW9uKGUsbixyKXt2YXIgbz10LmV2ZXJ5KHQubWFwKG4saSxlKSk7cy5jYWxsKGUsbyxyKX0pfX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDM1KV0scj1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIGkoZSl7dGhpcy5vcHRpb25zPXQuY2xvbmUoZXx8e30pLHRoaXMuY2lkPXQudW5pcXVlSWQoImNsYXNzIiksdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gdC5leHRlbmQoaS5wcm90b3R5cGUsZS5FdmVudHMse2luaXRpYWxpemU6ZnVuY3Rpb24oKXt9fSksaS5leHRlbmQ9ZS5Nb2RlbC5leHRlbmQsaX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDUpLGkoMiksaSgxNTYpLGkoMTU4KSxpKDE0MildLHI9ZnVuY3Rpb24odCxlLGksbixyKXt2YXIgcz1uLG89WyJzdWNjZXNzIiwiZXJyb3IiLCJ0YXJnZXQiLCJ0ZXh0Il0sYT1pLmV4dGVuZCh7aW5pdGlhbGl6ZTpmdW5jdGlvbihpLG4pe249ZS5waWNrKG58fHt9LG8pO3ZhciBhLGwsYztlLmlzU3RyaW5nKGkpJiYoYT1pKSxlLmlzRWxlbWVudChpKSYmKGE9aSksaSBpbnN0YW5jZW9mIHQmJihhPWkuc2VsZWN0b3IpLGkgaW5zdGFuY2VvZiByJiYoYT1pLmVsKSxlLmlzRnVuY3Rpb24obi50YXJnZXQpJiYobD1uLnRhcmdldCksZS5pc0VsZW1lbnQobi50YXJnZXQpJiYobD1lLmNvbnN0YW50KG4udGFyZ2V0KSksZS5pc1N0cmluZyhuLnRleHQpP2M9ZS5jb25zdGFudChuLnRleHQpOmUuaXNGdW5jdGlvbihuLnRleHQpJiYoYz1uLnRleHQpLHRoaXMuX19pbnN0YW5jZT1uZXcgcyhhLHt0YXJnZXQ6bCx0ZXh0OmN9KSx0aGlzLmRvbmU9ZS5wYXJ0aWFsKHRoaXMuX19zZXRDYWxsYmFjaywic3VjY2VzcyIpLHRoaXMuZXJyb3I9ZS5wYXJ0aWFsKHRoaXMuX19zZXRDYWxsYmFjaywiZXJyb3IiKSx0aGlzLmRvbmUobi5zdWNjZXNzKSx0aGlzLmVycm9yKG4uZXJyb3IpfSxfX3NldENhbGxiYWNrOmZ1bmN0aW9uKHQsaSl7aWYoZS5pc0Z1bmN0aW9uKGkpKXJldHVybiB0aGlzLl9faW5zdGFuY2Uub24odCxpKSx0aGlzLl9faW5zdGFuY2V9fSk7cmV0dXJue2F0dGFjaDpmdW5jdGlvbih0LGUpe3JldHVybiBuZXcgYSh0LGUpfX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHIsczshZnVuY3Rpb24obyxhKXtyPVt0LGkoMTU5KSxpKDMwKSxpKDE2MSldLG49YSxzPSJmdW5jdGlvbiI9PXR5cGVvZiBuP24uYXBwbHkoZSxyKTpuLCEodm9pZCAwIT09cyYmKHQuZXhwb3J0cz1zKSl9KHRoaXMsZnVuY3Rpb24odCxlLGksbil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHIodCl7cmV0dXJuIHQmJnQuX19lc01vZHVsZT90OnsiZGVmYXVsdCI6dH19ZnVuY3Rpb24gcyh0LGUpe2lmKCEodCBpbnN0YW5jZW9mIGUpKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpfWZ1bmN0aW9uIG8odCxlKXtpZighdCl0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpO3JldHVybiFlfHwib2JqZWN0IiE9dHlwZW9mIGUmJiJmdW5jdGlvbiIhPXR5cGVvZiBlP3Q6ZX1mdW5jdGlvbiBhKHQsZSl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGUmJm51bGwhPT1lKXRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIit0eXBlb2YgZSk7dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShlJiZlLnByb3RvdHlwZSx7Y29uc3RydWN0b3I6e3ZhbHVlOnQsZW51bWVyYWJsZTohMSx3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITB9fSksZSYmKE9iamVjdC5zZXRQcm90b3R5cGVPZj9PYmplY3Quc2V0UHJvdG90eXBlT2YodCxlKTp0Ll9fcHJvdG9fXz1lKX1mdW5jdGlvbiBsKHQsZSl7dmFyIGk9ImRhdGEtY2xpcGJvYXJkLSIrdDtpZihlLmhhc0F0dHJpYnV0ZShpKSlyZXR1cm4gZS5nZXRBdHRyaWJ1dGUoaSl9dmFyIGM9cihlKSx1PXIoaSksZD1yKG4pLGg9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7Zm9yKHZhciBpPTA7aTxlLmxlbmd0aDtpKyspe3ZhciBuPWVbaV07bi5lbnVtZXJhYmxlPW4uZW51bWVyYWJsZXx8ITEsbi5jb25maWd1cmFibGU9ITAsInZhbHVlImluIG4mJihuLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxuLmtleSxuKX19cmV0dXJuIGZ1bmN0aW9uKGUsaSxuKXtyZXR1cm4gaSYmdChlLnByb3RvdHlwZSxpKSxuJiZ0KGUsbiksZX19KCkscD1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQsaSl7cyh0aGlzLGUpO3ZhciBuPW8odGhpcywoZS5fX3Byb3RvX198fE9iamVjdC5nZXRQcm90b3R5cGVPZihlKSkuY2FsbCh0aGlzKSk7cmV0dXJuIG4ucmVzb2x2ZU9wdGlvbnMoaSksbi5saXN0ZW5DbGljayh0KSxufXJldHVybiBhKGUsdCksaChlLFt7a2V5OiJyZXNvbHZlT3B0aW9ucyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06e307dGhpcy5hY3Rpb249ImZ1bmN0aW9uIj09dHlwZW9mIHQuYWN0aW9uP3QuYWN0aW9uOnRoaXMuZGVmYXVsdEFjdGlvbix0aGlzLnRhcmdldD0iZnVuY3Rpb24iPT10eXBlb2YgdC50YXJnZXQ/dC50YXJnZXQ6dGhpcy5kZWZhdWx0VGFyZ2V0LHRoaXMudGV4dD0iZnVuY3Rpb24iPT10eXBlb2YgdC50ZXh0P3QudGV4dDp0aGlzLmRlZmF1bHRUZXh0fX0se2tleToibGlzdGVuQ2xpY2siLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXM7dGhpcy5saXN0ZW5lcj0oMCxkWyJkZWZhdWx0Il0pKHQsImNsaWNrIixmdW5jdGlvbih0KXtyZXR1cm4gZS5vbkNsaWNrKHQpfSl9fSx7a2V5OiJvbkNsaWNrIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgZT10LmRlbGVnYXRlVGFyZ2V0fHx0LmN1cnJlbnRUYXJnZXQ7dGhpcy5jbGlwYm9hcmRBY3Rpb24mJih0aGlzLmNsaXBib2FyZEFjdGlvbj1udWxsKSx0aGlzLmNsaXBib2FyZEFjdGlvbj1uZXcgY1siZGVmYXVsdCJdKHthY3Rpb246dGhpcy5hY3Rpb24oZSksdGFyZ2V0OnRoaXMudGFyZ2V0KGUpLHRleHQ6dGhpcy50ZXh0KGUpLHRyaWdnZXI6ZSxlbWl0dGVyOnRoaXN9KX19LHtrZXk6ImRlZmF1bHRBY3Rpb24iLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBsKCJhY3Rpb24iLHQpfX0se2tleToiZGVmYXVsdFRhcmdldCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9bCgidGFyZ2V0Iix0KTtpZihlKXJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGUpfX0se2tleToiZGVmYXVsdFRleHQiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBsKCJ0ZXh0Iix0KX19LHtrZXk6ImRlc3Ryb3kiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5saXN0ZW5lci5kZXN0cm95KCksdGhpcy5jbGlwYm9hcmRBY3Rpb24mJih0aGlzLmNsaXBib2FyZEFjdGlvbi5kZXN0cm95KCksdGhpcy5jbGlwYm9hcmRBY3Rpb249bnVsbCl9fV0sW3trZXk6ImlzU3VwcG9ydGVkIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTpbImNvcHkiLCJjdXQiXSxlPSJzdHJpbmciPT10eXBlb2YgdD9bdF06dCxpPSEhZG9jdW1lbnQucXVlcnlDb21tYW5kU3VwcG9ydGVkO3JldHVybiBlLmZvckVhY2goZnVuY3Rpb24odCl7aT1pJiYhIWRvY3VtZW50LnF1ZXJ5Q29tbWFuZFN1cHBvcnRlZCh0KX0pLGl9fV0pLGV9KHVbImRlZmF1bHQiXSk7dC5leHBvcnRzPXB9KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHIsczshZnVuY3Rpb24obyxhKXtyPVt0LGkoMTYwKV0sbj1hLHM9ImZ1bmN0aW9uIj09dHlwZW9mIG4/bi5hcHBseShlLHIpOm4sISh2b2lkIDAhPT1zJiYodC5leHBvcnRzPXMpKX0odGhpcyxmdW5jdGlvbih0LGUpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBpKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ImRlZmF1bHQiOnR9fWZ1bmN0aW9uIG4odCxlKXtpZighKHQgaW5zdGFuY2VvZiBlKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKX12YXIgcj1pKGUpLHM9ImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmInN5bWJvbCI9PXR5cGVvZiBTeW1ib2wuaXRlcmF0b3I/ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0fTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmdC5jb25zdHJ1Y3Rvcj09PVN5bWJvbCYmdCE9PVN5bWJvbC5wcm90b3R5cGU/InN5bWJvbCI6dHlwZW9mIHR9LG89ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7Zm9yKHZhciBpPTA7aTxlLmxlbmd0aDtpKyspe3ZhciBuPWVbaV07bi5lbnVtZXJhYmxlPW4uZW51bWVyYWJsZXx8ITEsbi5jb25maWd1cmFibGU9ITAsInZhbHVlImluIG4mJihuLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxuLmtleSxuKX19cmV0dXJuIGZ1bmN0aW9uKGUsaSxuKXtyZXR1cm4gaSYmdChlLnByb3RvdHlwZSxpKSxuJiZ0KGUsbiksZX19KCksYT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSl7bih0aGlzLHQpLHRoaXMucmVzb2x2ZU9wdGlvbnMoZSksdGhpcy5pbml0U2VsZWN0aW9uKCl9cmV0dXJuIG8odCxbe2tleToicmVzb2x2ZU9wdGlvbnMiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aD4wJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOnt9O3RoaXMuYWN0aW9uPXQuYWN0aW9uLHRoaXMuZW1pdHRlcj10LmVtaXR0ZXIsdGhpcy50YXJnZXQ9dC50YXJnZXQsdGhpcy50ZXh0PXQudGV4dCx0aGlzLnRyaWdnZXI9dC50cmlnZ2VyLHRoaXMuc2VsZWN0ZWRUZXh0PSIifX0se2tleToiaW5pdFNlbGVjdGlvbiIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLnRleHQ/dGhpcy5zZWxlY3RGYWtlKCk6dGhpcy50YXJnZXQmJnRoaXMuc2VsZWN0VGFyZ2V0KCl9fSx7a2V5OiJzZWxlY3RGYWtlIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMsZT0icnRsIj09ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgiZGlyIik7dGhpcy5yZW1vdmVGYWtlKCksdGhpcy5mYWtlSGFuZGxlckNhbGxiYWNrPWZ1bmN0aW9uKCl7cmV0dXJuIHQucmVtb3ZlRmFrZSgpfSx0aGlzLmZha2VIYW5kbGVyPWRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLHRoaXMuZmFrZUhhbmRsZXJDYWxsYmFjayl8fCEwLHRoaXMuZmFrZUVsZW09ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGV4dGFyZWEiKSx0aGlzLmZha2VFbGVtLnN0eWxlLmZvbnRTaXplPSIxMnB0Iix0aGlzLmZha2VFbGVtLnN0eWxlLmJvcmRlcj0iMCIsdGhpcy5mYWtlRWxlbS5zdHlsZS5wYWRkaW5nPSIwIix0aGlzLmZha2VFbGVtLnN0eWxlLm1hcmdpbj0iMCIsdGhpcy5mYWtlRWxlbS5zdHlsZS5wb3NpdGlvbj0iYWJzb2x1dGUiLHRoaXMuZmFrZUVsZW0uc3R5bGVbZT8icmlnaHQiOiJsZWZ0Il09Ii05OTk5cHgiO3ZhciBpPXdpbmRvdy5wYWdlWU9mZnNldHx8ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDt0aGlzLmZha2VFbGVtLnN0eWxlLnRvcD1pKyJweCIsdGhpcy5mYWtlRWxlbS5zZXRBdHRyaWJ1dGUoInJlYWRvbmx5IiwiIiksdGhpcy5mYWtlRWxlbS52YWx1ZT10aGlzLnRleHQsZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmZha2VFbGVtKSx0aGlzLnNlbGVjdGVkVGV4dD0oMCxyWyJkZWZhdWx0Il0pKHRoaXMuZmFrZUVsZW0pLHRoaXMuY29weVRleHQoKX19LHtrZXk6InJlbW92ZUZha2UiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5mYWtlSGFuZGxlciYmKGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xpY2siLHRoaXMuZmFrZUhhbmRsZXJDYWxsYmFjayksdGhpcy5mYWtlSGFuZGxlcj1udWxsLHRoaXMuZmFrZUhhbmRsZXJDYWxsYmFjaz1udWxsKSx0aGlzLmZha2VFbGVtJiYoZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzLmZha2VFbGVtKSx0aGlzLmZha2VFbGVtPW51bGwpfX0se2tleToic2VsZWN0VGFyZ2V0Iix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuc2VsZWN0ZWRUZXh0PSgwLHJbImRlZmF1bHQiXSkodGhpcy50YXJnZXQpLHRoaXMuY29weVRleHQoKX19LHtrZXk6ImNvcHlUZXh0Iix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PXZvaWQgMDt0cnl7dD1kb2N1bWVudC5leGVjQ29tbWFuZCh0aGlzLmFjdGlvbil9Y2F0Y2goZSl7dD0hMX10aGlzLmhhbmRsZVJlc3VsdCh0KX19LHtrZXk6ImhhbmRsZVJlc3VsdCIsdmFsdWU6ZnVuY3Rpb24odCl7dGhpcy5lbWl0dGVyLmVtaXQodD8ic3VjY2VzcyI6ImVycm9yIix7YWN0aW9uOnRoaXMuYWN0aW9uLHRleHQ6dGhpcy5zZWxlY3RlZFRleHQsdHJpZ2dlcjp0aGlzLnRyaWdnZXIsY2xlYXJTZWxlY3Rpb246dGhpcy5jbGVhclNlbGVjdGlvbi5iaW5kKHRoaXMpfSl9fSx7a2V5OiJjbGVhclNlbGVjdGlvbiIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLnRhcmdldCYmdGhpcy50YXJnZXQuYmx1cigpLHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5yZW1vdmVBbGxSYW5nZXMoKX19LHtrZXk6ImRlc3Ryb3kiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5yZW1vdmVGYWtlKCl9fSx7a2V5OiJhY3Rpb24iLHNldDpmdW5jdGlvbigpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXToiY29weSI7aWYodGhpcy5fYWN0aW9uPXQsImNvcHkiIT09dGhpcy5fYWN0aW9uJiYiY3V0IiE9PXRoaXMuX2FjdGlvbil0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgImFjdGlvbiIgdmFsdWUsIHVzZSBlaXRoZXIgImNvcHkiIG9yICJjdXQiJyl9LGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9hY3Rpb259fSx7a2V5OiJ0YXJnZXQiLHNldDpmdW5jdGlvbih0KXtpZih2b2lkIDAhPT10KXtpZighdHx8Im9iamVjdCIhPT0oInVuZGVmaW5lZCI9PXR5cGVvZiB0PyJ1bmRlZmluZWQiOnModCkpfHwxIT09dC5ub2RlVHlwZSl0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgInRhcmdldCIgdmFsdWUsIHVzZSBhIHZhbGlkIEVsZW1lbnQnKTtpZigiY29weSI9PT10aGlzLmFjdGlvbiYmdC5oYXNBdHRyaWJ1dGUoImRpc2FibGVkIikpdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkICJ0YXJnZXQiIGF0dHJpYnV0ZS4gUGxlYXNlIHVzZSAicmVhZG9ubHkiIGluc3RlYWQgb2YgImRpc2FibGVkIiBhdHRyaWJ1dGUnKTtpZigiY3V0Ij09PXRoaXMuYWN0aW9uJiYodC5oYXNBdHRyaWJ1dGUoInJlYWRvbmx5Iil8fHQuaGFzQXR0cmlidXRlKCJkaXNhYmxlZCIpKSl0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgInRhcmdldCIgYXR0cmlidXRlLiBZb3UgY2FuXCd0IGN1dCB0ZXh0IGZyb20gZWxlbWVudHMgd2l0aCAicmVhZG9ubHkiIG9yICJkaXNhYmxlZCIgYXR0cmlidXRlcycpO3RoaXMuX3RhcmdldD10fX0sZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RhcmdldH19XSksdH0oKTt0LmV4cG9ydHM9YX0pfSxmdW5jdGlvbih0LGUpe2Z1bmN0aW9uIGkodCl7dmFyIGU7aWYoIlNFTEVDVCI9PT10Lm5vZGVOYW1lKXQuZm9jdXMoKSxlPXQudmFsdWU7ZWxzZSBpZigiSU5QVVQiPT09dC5ub2RlTmFtZXx8IlRFWFRBUkVBIj09PXQubm9kZU5hbWUpe3ZhciBpPXQuaGFzQXR0cmlidXRlKCJyZWFkb25seSIpO2l8fHQuc2V0QXR0cmlidXRlKCJyZWFkb25seSIsIiIpLHQuc2VsZWN0KCksdC5zZXRTZWxlY3Rpb25SYW5nZSgwLHQudmFsdWUubGVuZ3RoKSxpfHx0LnJlbW92ZUF0dHJpYnV0ZSgicmVhZG9ubHkiKSxlPXQudmFsdWV9ZWxzZXt0Lmhhc0F0dHJpYnV0ZSgiY29udGVudGVkaXRhYmxlIikmJnQuZm9jdXMoKTt2YXIgbj13aW5kb3cuZ2V0U2VsZWN0aW9uKCkscj1kb2N1bWVudC5jcmVhdGVSYW5nZSgpO3Iuc2VsZWN0Tm9kZUNvbnRlbnRzKHQpLG4ucmVtb3ZlQWxsUmFuZ2VzKCksbi5hZGRSYW5nZShyKSxlPW4udG9TdHJpbmcoKX1yZXR1cm4gZX10LmV4cG9ydHM9aX0sZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCxlLGkpe2lmKCF0JiYhZSYmIWkpdGhyb3cgbmV3IEVycm9yKCJNaXNzaW5nIHJlcXVpcmVkIGFyZ3VtZW50cyIpO2lmKCFhLnN0cmluZyhlKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJTZWNvbmQgYXJndW1lbnQgbXVzdCBiZSBhIFN0cmluZyIpO2lmKCFhLmZuKGkpKXRocm93IG5ldyBUeXBlRXJyb3IoIlRoaXJkIGFyZ3VtZW50IG11c3QgYmUgYSBGdW5jdGlvbiIpO2lmKGEubm9kZSh0KSlyZXR1cm4gcih0LGUsaSk7aWYoYS5ub2RlTGlzdCh0KSlyZXR1cm4gcyh0LGUsaSk7aWYoYS5zdHJpbmcodCkpcmV0dXJuIG8odCxlLGkpO3Rocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBTdHJpbmcsIEhUTUxFbGVtZW50LCBIVE1MQ29sbGVjdGlvbiwgb3IgTm9kZUxpc3QiKX1mdW5jdGlvbiByKHQsZSxpKXtyZXR1cm4gdC5hZGRFdmVudExpc3RlbmVyKGUsaSkse2Rlc3Ryb3k6ZnVuY3Rpb24oKXt0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxpKX19fWZ1bmN0aW9uIHModCxlLGkpe3JldHVybiBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHQsZnVuY3Rpb24odCl7dC5hZGRFdmVudExpc3RlbmVyKGUsaSl9KSx7ZGVzdHJveTpmdW5jdGlvbigpe0FycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwodCxmdW5jdGlvbih0KXt0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxpKX0pfX19ZnVuY3Rpb24gbyh0LGUsaSl7cmV0dXJuIGwoZG9jdW1lbnQuYm9keSx0LGUsaSl9dmFyIGE9aSgxNjIpLGw9aSgxNjMpO3QuZXhwb3J0cz1ufSxmdW5jdGlvbih0LGUpe2Uubm9kZT1mdW5jdGlvbih0KXtyZXR1cm4gdm9pZCAwIT09dCYmdCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50JiYxPT09dC5ub2RlVHlwZX0sZS5ub2RlTGlzdD1mdW5jdGlvbih0KXt2YXIgaT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCk7cmV0dXJuIHZvaWQgMCE9PXQmJigiW29iamVjdCBOb2RlTGlzdF0iPT09aXx8IltvYmplY3QgSFRNTENvbGxlY3Rpb25dIj09PWkpJiYibGVuZ3RoImluIHQmJigwPT09dC5sZW5ndGh8fGUubm9kZSh0WzBdKSl9LGUuc3RyaW5nPWZ1bmN0aW9uKHQpe3JldHVybiJzdHJpbmciPT10eXBlb2YgdHx8dCBpbnN0YW5jZW9mIFN0cmluZ30sZS5mbj1mdW5jdGlvbih0KXt2YXIgZT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCk7cmV0dXJuIltvYmplY3QgRnVuY3Rpb25dIj09PWV9fSxmdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gbih0LGUsaSxuLHMpe3ZhciBvPXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiB0LmFkZEV2ZW50TGlzdGVuZXIoaSxvLHMpLHtkZXN0cm95OmZ1bmN0aW9uKCl7dC5yZW1vdmVFdmVudExpc3RlbmVyKGksbyxzKX19fWZ1bmN0aW9uIHIodCxlLGksbil7cmV0dXJuIGZ1bmN0aW9uKGkpe2kuZGVsZWdhdGVUYXJnZXQ9cyhpLnRhcmdldCxlKSxpLmRlbGVnYXRlVGFyZ2V0JiZuLmNhbGwodCxpKX19dmFyIHM9aSgxNjQpO3QuZXhwb3J0cz1ufSxmdW5jdGlvbih0LGUpe2Z1bmN0aW9uIGkodCxlKXtmb3IoO3QmJnQubm9kZVR5cGUhPT1uOyl7aWYoImZ1bmN0aW9uIj09dHlwZW9mIHQubWF0Y2hlcyYmdC5tYXRjaGVzKGUpKXJldHVybiB0O3Q9dC5wYXJlbnROb2RlfX12YXIgbj05O2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgRWxlbWVudCYmIUVsZW1lbnQucHJvdG90eXBlLm1hdGNoZXMpe3ZhciByPUVsZW1lbnQucHJvdG90eXBlO3IubWF0Y2hlcz1yLm1hdGNoZXNTZWxlY3Rvcnx8ci5tb3pNYXRjaGVzU2VsZWN0b3J8fHIubXNNYXRjaGVzU2VsZWN0b3J8fHIub01hdGNoZXNTZWxlY3Rvcnx8ci53ZWJraXRNYXRjaGVzU2VsZWN0b3J9dC5leHBvcnRzPWl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNjYpXSxyPWZ1bmN0aW9uKHQsZSl7dmFyIGk9L15odHRwcy8udGVzdCh3aW5kb3cubG9jYXRpb24uaHJlZik7cmV0dXJue3NldENvb2tpZTpmdW5jdGlvbihuLHIscyl7ZS5zZXQobixyLHQuZGVmYXVsdHMoc3x8e30se3NlY3VyZTppLHBhdGg6Ii8ifSkpfSxnZXRDb29raWU6ZnVuY3Rpb24oKXtyZXR1cm4gZS5nZXQuYXBwbHkoZSxhcmd1bWVudHMpfSxyZW1vdmVDb29raWU6ZnVuY3Rpb24oKXtyZXR1cm4gZS5yZW1vdmUuYXBwbHkoZSxhcmd1bWVudHMpfX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7LyohCgkJICogSmF2YVNjcmlwdCBDb29raWUgdjIuMS4wCgkJICogaHR0cHM6Ly9naXRodWIuY29tL2pzLWNvb2tpZS9qcy1jb29raWUKCQkgKgoJCSAqIENvcHlyaWdodCAyMDA2LCAyMDE1IEtsYXVzIEhhcnRsICYgRmFnbmVyIEJyYWNrCgkJICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlCgkJICovCgkhZnVuY3Rpb24ocyl7bj1zLHI9ImZ1bmN0aW9uIj09dHlwZW9mIG4/bi5jYWxsKGUsaSxlLHQpOm4sISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0oZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7Zm9yKHZhciB0PTAsZT17fTt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXt2YXIgaT1hcmd1bWVudHNbdF07Zm9yKHZhciBuIGluIGkpZVtuXT1pW25dfXJldHVybiBlfWZ1bmN0aW9uIGUoaSl7ZnVuY3Rpb24gbihlLHIscyl7dmFyIG87aWYoYXJndW1lbnRzLmxlbmd0aD4xKXtpZihzPXQoe3BhdGg6Ii8ifSxuLmRlZmF1bHRzLHMpLCJudW1iZXIiPT10eXBlb2Ygcy5leHBpcmVzKXt2YXIgYT1uZXcgRGF0ZTthLnNldE1pbGxpc2Vjb25kcyhhLmdldE1pbGxpc2Vjb25kcygpKzg2NGU1KnMuZXhwaXJlcykscy5leHBpcmVzPWF9dHJ5e289SlNPTi5zdHJpbmdpZnkociksL15bXHtcW10vLnRlc3QobykmJihyPW8pfWNhdGNoKGwpe31yZXR1cm4gcj1pLndyaXRlP2kud3JpdGUocixlKTplbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKHIpKS5yZXBsYWNlKC8lKDIzfDI0fDI2fDJCfDNBfDNDfDNFfDNEfDJGfDNGfDQwfDVCfDVEfDVFfDYwfDdCfDdEfDdDKS9nLGRlY29kZVVSSUNvbXBvbmVudCksZT1lbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGUpKSxlPWUucmVwbGFjZSgvJSgyM3wyNHwyNnwyQnw1RXw2MHw3QykvZyxkZWNvZGVVUklDb21wb25lbnQpLGU9ZS5yZXBsYWNlKC9bXChcKV0vZyxlc2NhcGUpLGRvY3VtZW50LmNvb2tpZT1bZSwiPSIscixzLmV4cGlyZXMmJiI7IGV4cGlyZXM9IitzLmV4cGlyZXMudG9VVENTdHJpbmcoKSxzLnBhdGgmJiI7IHBhdGg9IitzLnBhdGgscy5kb21haW4mJiI7IGRvbWFpbj0iK3MuZG9tYWluLHMuc2VjdXJlPyI7IHNlY3VyZSI6IiJdLmpvaW4oIiIpfWV8fChvPXt9KTtmb3IodmFyIGM9ZG9jdW1lbnQuY29va2llP2RvY3VtZW50LmNvb2tpZS5zcGxpdCgiOyAiKTpbXSx1PS8oJVswLTlBLVpdezJ9KSsvZyxkPTA7ZDxjLmxlbmd0aDtkKyspe3ZhciBoPWNbZF0uc3BsaXQoIj0iKSxwPWhbMF0ucmVwbGFjZSh1LGRlY29kZVVSSUNvbXBvbmVudCksZj1oLnNsaWNlKDEpLmpvaW4oIj0iKTsnIic9PT1mLmNoYXJBdCgwKSYmKGY9Zi5zbGljZSgxLC0xKSk7dHJ5e2lmKGY9aS5yZWFkP2kucmVhZChmLHApOmkoZixwKXx8Zi5yZXBsYWNlKHUsZGVjb2RlVVJJQ29tcG9uZW50KSx0aGlzLmpzb24pdHJ5e2Y9SlNPTi5wYXJzZShmKX1jYXRjaChsKXt9aWYoZT09PXApe289ZjticmVha31lfHwob1twXT1mKX1jYXRjaChsKXt9fXJldHVybiBvfXJldHVybiBuLmdldD1uLnNldD1uLG4uZ2V0SlNPTj1mdW5jdGlvbigpe3JldHVybiBuLmFwcGx5KHtqc29uOiEwfSxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cykpfSxuLmRlZmF1bHRzPXt9LG4ucmVtb3ZlPWZ1bmN0aW9uKGUsaSl7bihlLCIiLHQoaSx7ZXhwaXJlczotMX0pKX0sbi53aXRoQ29udmVydGVyPWUsbn1yZXR1cm4gZShmdW5jdGlvbigpe30pfSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDUpXSxyPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuZXh0ZW5kKHtmZXRjaEV2ZW50czoiY2hhbmdlIixjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe3RoaXMuZmV0Y2g9dC5kZWJvdW5jZSh0aGlzLmZldGNoLDUwKSx0aGlzLkNvbGxlY3Rpb24mJih0aGlzLmNvbGxlY3Rpb249bmV3IHRoaXMuQ29sbGVjdGlvbiksZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5saXN0ZW5Ubyh0aGlzLnN0YXRlLHQucmVzdWx0KHRoaXMsImZldGNoRXZlbnRzIiksZnVuY3Rpb24oKXt0aGlzLmZldGNoKHtyZXNldDohMH0pfSksdGhpcy5jb2xsZWN0aW9uJiZ0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwiZXJyb3IiLGZ1bmN0aW9uKHQpe3Q9PT10aGlzLmNvbGxlY3Rpb24mJnRoaXMuY29sbGVjdGlvbi5yZXNldCgpfSksdGhpcy5mZXRjaCh7cmVzZXQ6ITB9KX0sZmV0Y2g6ZnVuY3Rpb24oZSl7dGhpcy5jb2xsZWN0aW9uJiYodGhpcy50cmlnZ2VyKCJmZXRjaCIsdGhpcy5zdGF0ZSksdGhpcy5jb2xsZWN0aW9uLmZldGNoKHQuZXh0ZW5kKHQucGljayhlfHx7fSxbInJlc2V0IiwicmVtb3ZlIiwic3VjY2VzcyIsImVycm9yIiwiZGF0YSJdKSx7ZGF0YTp0aGlzLmdldEZldGNoRGF0YSgpfSkpKX0sZ2V0RmV0Y2hEYXRhOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdGUudG9KU09OKCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKV0scj1mdW5jdGlvbih0KXtyZXR1cm57Y3JlYXRlOmZ1bmN0aW9uKGUpe3JldHVybiBlJiZlLmVycm9yT2JqJiYodC5pc0VtcHR5KGUuZXJyb3JPYmouZXJyb3JDYXVzZXMpP2UuZXJyb3JzPVt7ZXJyb3JTdW1tYXJ5OmUuZXJyb3JPYmouZXJyb3JTdW1tYXJ5fV06ZS5lcnJvcnM9ZS5lcnJvck9iai5lcnJvckNhdXNlcykse2dldEZpZWxkTmFtZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5pbmRleE9mKCI6Iik+LTE/dC5zcGxpdCgiOiIpWzBdOm51bGx9LGdldE1lc3NhZ2VzOmZ1bmN0aW9uKCl7dmFyIGk9W107cmV0dXJuIHQuZWFjaChlLmVycm9ycyxmdW5jdGlvbih0KXt2YXIgbj10aGlzLmdldEZpZWxkTmFtZSh0LmVycm9yU3VtbWFyeSk7aWYobiYmZS5pbnB1dE1hcFtuXSl7dmFyIHI9bmV3IFJlZ0V4cCgiXiIrbik7aS5wdXNoKHtlcnJvclN1bW1hcnk6dC5lcnJvclN1bW1hcnkucmVwbGFjZShyLGUuaW5wdXRNYXBbbl0pfSl9ZWxzZSBpLnB1c2godCl9LHRoaXMpLGl9LGdldElucHV0czpmdW5jdGlvbigpe3ZhciBpPVtdO3JldHVybiB0LmVhY2goZS5lcnJvcnMsZnVuY3Rpb24odCl7dmFyIG49dGhpcy5nZXRGaWVsZE5hbWUodC5lcnJvclN1bW1hcnkpO2UuaW5wdXRNYXAuaGFzT3duUHJvcGVydHkobikmJmkucHVzaChuKX0sdGhpcyksaX0sZ2V0UmVmb3JtYXR0ZWRNZXNzYWdlczpmdW5jdGlvbigpe3ZhciBpPXt9O3JldHVybiB0LmVhY2goZS5lcnJvcnMsZnVuY3Rpb24oZSl7aWYodC5pc1VuZGVmaW5lZChlLmVycm9yU3VtbWFyeSkpaS5lcnJvclN1bW1hcnk9ZTtlbHNle3ZhciBuPWUuZXJyb3JTdW1tYXJ5LmluZGV4T2YoIjoiKT4tMT9lLmVycm9yU3VtbWFyeS5zcGxpdCgiOiAiKTpudWxsO24/aVtuWzBdXT1uWzFdOmkuZXJyb3JTdW1tYXJ5PWUuZXJyb3JTdW1tYXJ5fX0sdGhpcyksaX19fX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpeyEodC5leHBvcnRzPXtGRVRDSF9NT1JFOiJGRVRDSF9NT1JFIixTSE9XX01PUkU6IlNIT1dfTU9SRSIsREVMRVRFOiJERUxFVEUiLEFDVElWQVRFOiJBQ1RJVkFURSIsREVBQ1RJVkFURToiREVBQ1RJVkFURSIsQ0hFQ0tfQUxMOiJDSEVDS19BTEwiLFVQTE9BRF9ET05FOiJVUExPQURfRE9ORSIsVVBMT0FEX0VNUFRZX0NPTlRFTlQ6IlVQTE9BRF9FTVBUWV9DT05URU5UIixET1dOTE9BRF9ET05FOiJET1dOTE9BRF9ET05FIixDTE9TRToiQ0xPU0UiLERPTkU6IkRPTkUiLFNVQk1JVDoiU1VCTUlUIn0pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDE3MSldLHI9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7cmV0dXJuIHQ9dmtiZWF1dGlmeS54bWwodCksZSYmKHQ9dC5yZXBsYWNlKC8mL2csIiZhbXA7IikucmVwbGFjZSgvPC9nLCImbHQ7IikucmVwbGFjZSgvPi9nLCImZ3Q7IikucmVwbGFjZSgvIi9nLCImcXVvdDsiKSksdH1yZXR1cm4gdH0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUpey8qKgoJCSogdmtCZWF1dGlmeSAtIGphdmFzY3JpcHQgcGx1Z2luIHRvIHByZXR0eS1wcmludCBvciBtaW5pZnkgdGV4dCBpbiBYTUwsIEpTT04sIENTUyBhbmQgU1FMIGZvcm1hdHMuCgkJKiAgCgkJKiBWZXJzaW9uIC0gMC45OS4wMC5iZXRhIAoJCSogQ29weXJpZ2h0IChjKSAyMDEyIFZhZGltIEtpcnl1a2hpbgoJCSogdmtpcnl1a2hpbiBAIGdtYWlsLmNvbQoJCSogaHR0cDovL3d3dy5lc2xpbnN0cnVjdG9yLm5ldC92a2JlYXV0aWZ5LwoJCSogCgkJKiBEdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgYW5kIEdQTCBsaWNlbnNlczoKCQkqICAgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHAKCQkqICAgaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2dwbC5odG1sCgkJKgoJCSogICBQcmV0dHkgcHJpbnQKCQkqCgkJKiAgICAgICAgdmtiZWF1dGlmeS54bWwodGV4dCBbLGluZGVudF9wYXR0ZXJuXSk7CgkJKiAgICAgICAgdmtiZWF1dGlmeS5qc29uKHRleHQgWyxpbmRlbnRfcGF0dGVybl0pOwoJCSogICAgICAgIHZrYmVhdXRpZnkuY3NzKHRleHQgWyxpbmRlbnRfcGF0dGVybl0pOwoJCSogICAgICAgIHZrYmVhdXRpZnkuc3FsKHRleHQgWyxpbmRlbnRfcGF0dGVybl0pOwoJCSoKCQkqICAgICAgICBAdGV4dCAtIFN0cmluZzsgdGV4dCB0byBiZWF0dWZ5OwoJCSogICAgICAgIEBpbmRlbnRfcGF0dGVybiAtIEludGVnZXIgfCBTdHJpbmc7CgkJKiAgICAgICAgICAgICAgICBJbnRlZ2VyOiAgbnVtYmVyIG9mIHdoaXRlIHNwYWNlczsKCQkqICAgICAgICAgICAgICAgIFN0cmluZzogICBjaGFyYWN0ZXIgc3RyaW5nIHRvIHZpc3VhbGl6ZSBpbmRlbnRhdGlvbiAoIGNhbiBhbHNvIGJlIGEgc2V0IG9mIHdoaXRlIHNwYWNlcyApCgkJKiAgIE1pbmlmeQoJCSoKCQkqICAgICAgICB2a2JlYXV0aWZ5LnhtbG1pbih0ZXh0IFsscHJlc2VydmVfY29tbWVudHNdKTsKCQkqICAgICAgICB2a2JlYXV0aWZ5Lmpzb25taW4odGV4dCk7CgkJKiAgICAgICAgdmtiZWF1dGlmeS5jc3NtaW4odGV4dCBbLHByZXNlcnZlX2NvbW1lbnRzXSk7CgkJKiAgICAgICAgdmtiZWF1dGlmeS5zcWxtaW4odGV4dCk7CgkJKgoJCSogICAgICAgIEB0ZXh0IC0gU3RyaW5nOyB0ZXh0IHRvIG1pbmlmeTsKCQkqICAgICAgICBAcHJlc2VydmVfY29tbWVudHMgLSBCb29sOyBbb3B0aW9uYWxdOwoJCSogICAgICAgICAgICAgICAgU2V0IHRoaXMgZmxhZyB0byB0cnVlIHRvIHByZXZlbnQgcmVtb3ZpbmcgY29tbWVudHMgZnJvbSBAdGV4dCAoIG1pbnhtbCBhbmQgbWluY3NzIGZ1bmN0aW9ucyBvbmx5LiApCgkJKgoJCSogICBFeGFtcGxlczoKCQkqICAgICAgICB2a2JlYXV0aWZ5LnhtbCh0ZXh0KTsgLy8gcHJldHR5IHByaW50IFhNTAoJCSogICAgICAgIHZrYmVhdXRpZnkuanNvbih0ZXh0LCA0ICk7IC8vIHByZXR0eSBwcmludCBKU09OCgkJKiAgICAgICAgdmtiZWF1dGlmeS5jc3ModGV4dCwgJy4gLiAuIC4nKTsgLy8gcHJldHR5IHByaW50IENTUwoJCSogICAgICAgIHZrYmVhdXRpZnkuc3FsKHRleHQsICctLS0tJyk7IC8vIHByZXR0eSBwcmludCBTUUwKCQkqCgkJKiAgICAgICAgdmtiZWF1dGlmeS54bWxtaW4odGV4dCwgdHJ1ZSk7Ly8gbWluaWZ5IFhNTCwgcHJlc2VydmUgY29tbWVudHMKCQkqICAgICAgICB2a2JlYXV0aWZ5Lmpzb25taW4odGV4dCk7Ly8gbWluaWZ5IEpTT04KCQkqICAgICAgICB2a2JlYXV0aWZ5LmNzc21pbih0ZXh0KTsvLyBtaW5pZnkgQ1NTLCByZW1vdmUgY29tbWVudHMgKCBkZWZhdWx0ICkKCQkqICAgICAgICB2a2JlYXV0aWZ5LnNxbG1pbih0ZXh0KTsvLyBtaW5pZnkgU1FMCgkJKgoJCSovCgkhZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3ZhciBlPSIgICAgIjtpZihpc05hTihwYXJzZUludCh0KSkpZT10O2Vsc2Ugc3dpdGNoKHQpe2Nhc2UgMTplPSIgIjticmVhaztjYXNlIDI6ZT0iICAiO2JyZWFrO2Nhc2UgMzplPSIgICAiO2JyZWFrO2Nhc2UgNDplPSIgICAgIjticmVhaztjYXNlIDU6ZT0iICAgICAiO2JyZWFrO2Nhc2UgNjplPSIgICAgICAiO2JyZWFrO2Nhc2UgNzplPSIgICAgICAgIjticmVhaztjYXNlIDg6ZT0iICAgICAgICAiO2JyZWFrO2Nhc2UgOTplPSIgICAgICAgICAiO2JyZWFrO2Nhc2UgMTA6ZT0iICAgICAgICAgICI7YnJlYWs7Y2FzZSAxMTplPSIgICAgICAgICAgICI7YnJlYWs7Y2FzZSAxMjplPSIgICAgICAgICAgICAifXZhciBpPVsiXG4iXTtmb3IoaXg9MDtpeDwxMDA7aXgrKylpLnB1c2goaVtpeF0rZSk7cmV0dXJuIGl9ZnVuY3Rpb24gZSgpe3RoaXMuc3RlcD0iICAgICIsdGhpcy5zaGlmdD10KHRoaXMuc3RlcCl9ZnVuY3Rpb24gaSh0LGUpe3JldHVybiBlLSh0LnJlcGxhY2UoL1woL2csIiIpLmxlbmd0aC10LnJlcGxhY2UoL1wpL2csIiIpLmxlbmd0aCl9ZnVuY3Rpb24gbih0LGUpe3JldHVybiB0LnJlcGxhY2UoL1xzezEsfS9nLCIgIikucmVwbGFjZSgvIEFORCAvZ2ksIn46On4iK2UrZSsiQU5EICIpLnJlcGxhY2UoLyBCRVRXRUVOIC9naSwifjo6fiIrZSsiQkVUV0VFTiAiKS5yZXBsYWNlKC8gQ0FTRSAvZ2ksIn46On4iK2UrIkNBU0UgIikucmVwbGFjZSgvIEVMU0UgL2dpLCJ+Ojp+IitlKyJFTFNFICIpLnJlcGxhY2UoLyBFTkQgL2dpLCJ+Ojp+IitlKyJFTkQgIikucmVwbGFjZSgvIEZST00gL2dpLCJ+Ojp+RlJPTSAiKS5yZXBsYWNlKC8gR1JPVVBcc3sxLH1CWS9naSwifjo6fkdST1VQIEJZICIpLnJlcGxhY2UoLyBIQVZJTkcgL2dpLCJ+Ojp+SEFWSU5HICIpLnJlcGxhY2UoLyBJTiAvZ2ksIiBJTiAiKS5yZXBsYWNlKC8gSk9JTiAvZ2ksIn46On5KT0lOICIpLnJlcGxhY2UoLyBDUk9TU346On57MSx9Sk9JTiAvZ2ksIn46On5DUk9TUyBKT0lOICIpLnJlcGxhY2UoLyBJTk5FUn46On57MSx9Sk9JTiAvZ2ksIn46On5JTk5FUiBKT0lOICIpLnJlcGxhY2UoLyBMRUZUfjo6fnsxLH1KT0lOIC9naSwifjo6fkxFRlQgSk9JTiAiKS5yZXBsYWNlKC8gUklHSFR+Ojp+ezEsfUpPSU4gL2dpLCJ+Ojp+UklHSFQgSk9JTiAiKS5yZXBsYWNlKC8gT04gL2dpLCJ+Ojp+IitlKyJPTiAiKS5yZXBsYWNlKC8gT1IgL2dpLCJ+Ojp+IitlK2UrIk9SICIpLnJlcGxhY2UoLyBPUkRFUlxzezEsfUJZL2dpLCJ+Ojp+T1JERVIgQlkgIikucmVwbGFjZSgvIE9WRVIgL2dpLCJ+Ojp+IitlKyJPVkVSICIpLnJlcGxhY2UoL1woXHN7MCx9U0VMRUNUIC9naSwifjo6fihTRUxFQ1QgIikucmVwbGFjZSgvXClcc3swLH1TRUxFQ1QgL2dpLCIpfjo6flNFTEVDVCAiKS5yZXBsYWNlKC8gVEhFTiAvZ2ksIiBUSEVOfjo6fiIrZSkucmVwbGFjZSgvIFVOSU9OIC9naSwifjo6flVOSU9Ofjo6fiIpLnJlcGxhY2UoLyBVU0lORyAvZ2ksIn46On5VU0lORyAiKS5yZXBsYWNlKC8gV0hFTiAvZ2ksIn46On4iK2UrIldIRU4gIikucmVwbGFjZSgvIFdIRVJFIC9naSwifjo6fldIRVJFICIpLnJlcGxhY2UoLyBXSVRIIC9naSwifjo6fldJVEggIikucmVwbGFjZSgvIEFMTCAvZ2ksIiBBTEwgIikucmVwbGFjZSgvIEFTIC9naSwiIEFTICIpLnJlcGxhY2UoLyBBU0MgL2dpLCIgQVNDICIpLnJlcGxhY2UoLyBERVNDIC9naSwiIERFU0MgIikucmVwbGFjZSgvIERJU1RJTkNUIC9naSwiIERJU1RJTkNUICIpLnJlcGxhY2UoLyBFWElTVFMgL2dpLCIgRVhJU1RTICIpLnJlcGxhY2UoLyBOT1QgL2dpLCIgTk9UICIpLnJlcGxhY2UoLyBOVUxMIC9naSwiIE5VTEwgIikucmVwbGFjZSgvIExJS0UgL2dpLCIgTElLRSAiKS5yZXBsYWNlKC9cc3swLH1TRUxFQ1QgL2dpLCJTRUxFQ1QgIikucmVwbGFjZSgvXHN7MCx9VVBEQVRFIC9naSwiVVBEQVRFICIpLnJlcGxhY2UoLyBTRVQgL2dpLCIgU0VUICIpLnJlcGxhY2UoL346On57MSx9L2csIn46On4iKS5zcGxpdCgifjo6fiIpfWUucHJvdG90eXBlLnhtbD1mdW5jdGlvbihlLGkpe3ZhciBuPWUucmVwbGFjZSgvPlxzezAsfTwvZywiPjwiKS5yZXBsYWNlKC88L2csIn46On48IikucmVwbGFjZSgvXHMqeG1sbnNcOi9nLCJ+Ojp+eG1sbnM6IikucmVwbGFjZSgvXHMqeG1sbnNcPS9nLCJ+Ojp+eG1sbnM9Iikuc3BsaXQoIn46On4iKSxyPW4ubGVuZ3RoLHM9ITEsbz0wLGE9IiIsbD0wLGM9aT90KGkpOnRoaXMuc2hpZnQ7Zm9yKGw9MDtsPHI7bCsrKW5bbF0uc2VhcmNoKC88IS8pPi0xPyhhKz1jW29dK25bbF0scz0hMCwobltsXS5zZWFyY2goLy0tPi8pPi0xfHxuW2xdLnNlYXJjaCgvXF0+Lyk+LTF8fG5bbF0uc2VhcmNoKC8hRE9DVFlQRS8pPi0xKSYmKHM9ITEpKTpuW2xdLnNlYXJjaCgvLS0+Lyk+LTF8fG5bbF0uc2VhcmNoKC9cXT4vKT4tMT8oYSs9bltsXSxzPSExKTovXjxcdy8uZXhlYyhuW2wtMV0pJiYvXjxcL1x3Ly5leGVjKG5bbF0pJiYvXjxbXHc6XC1cLlwsXSsvLmV4ZWMobltsLTFdKT09L148XC9bXHc6XC1cLlwsXSsvLmV4ZWMobltsXSlbMF0ucmVwbGFjZSgiLyIsIiIpPyhhKz1uW2xdLHN8fG8tLSk6bltsXS5zZWFyY2goLzxcdy8pPi0xJiZuW2xdLnNlYXJjaCgvPFwvLyk9PS0xJiZuW2xdLnNlYXJjaCgvXC8+Lyk9PS0xP2E9YSs9cz9uW2xdOmNbbysrXStuW2xdOm5bbF0uc2VhcmNoKC88XHcvKT4tMSYmbltsXS5zZWFyY2goLzxcLy8pPi0xP2E9YSs9cz9uW2xdOmNbb10rbltsXTpuW2xdLnNlYXJjaCgvPFwvLyk+LTE/YT1hKz1zP25bbF06Y1stLW9dK25bbF06bltsXS5zZWFyY2goL1wvPi8pPi0xP2E9YSs9cz9uW2xdOmNbb10rbltsXTphKz1uW2xdLnNlYXJjaCgvPFw/Lyk+LTE/Y1tvXStuW2xdOm5bbF0uc2VhcmNoKC94bWxuc1w6Lyk+LTF8fG5bbF0uc2VhcmNoKC94bWxuc1w9Lyk+LTE/Y1tvXStuW2xdOm5bbF07cmV0dXJuIlxuIj09YVswXT9hLnNsaWNlKDEpOmF9LGUucHJvdG90eXBlLmpzb249ZnVuY3Rpb24odCxlKXt2YXIgZT1lP2U6dGhpcy5zdGVwO3JldHVybiJ1bmRlZmluZWQiPT10eXBlb2YgSlNPTj90OiJzdHJpbmciPT10eXBlb2YgdD9KU09OLnN0cmluZ2lmeShKU09OLnBhcnNlKHQpLG51bGwsZSk6Im9iamVjdCI9PXR5cGVvZiB0P0pTT04uc3RyaW5naWZ5KHQsbnVsbCxlKTp0fSxlLnByb3RvdHlwZS5jc3M9ZnVuY3Rpb24oZSxpKXt2YXIgbj1lLnJlcGxhY2UoL1xzezEsfS9nLCIgIikucmVwbGFjZSgvXHsvZywie346On4iKS5yZXBsYWNlKC9cfS9nLCJ+Ojp+fX46On4iKS5yZXBsYWNlKC9cOy9nLCI7fjo6fiIpLnJlcGxhY2UoL1wvXCovZywifjo6fi8qIikucmVwbGFjZSgvXCpcLy9nLCIqL346On4iKS5yZXBsYWNlKC9+Ojp+XHN7MCx9fjo6fi9nLCJ+Ojp+Iikuc3BsaXQoIn46On4iKSxyPW4ubGVuZ3RoLHM9MCxvPSIiLGE9MCxsPWk/dChpKTp0aGlzLnNoaWZ0O2ZvcihhPTA7YTxyO2ErKylvKz0vXHsvLmV4ZWMoblthXSk/bFtzKytdK25bYV06L1x9Ly5leGVjKG5bYV0pP2xbLS1zXStuW2FdOi9cKlxcLy5leGVjKG5bYV0pP2xbc10rblthXTpsW3NdK25bYV07cmV0dXJuIG8ucmVwbGFjZSgvXlxuezEsfS8sIiIpfSxlLnByb3RvdHlwZS5zcWw9ZnVuY3Rpb24oZSxyKXt2YXIgcz1lLnJlcGxhY2UoL1xzezEsfS9nLCIgIikucmVwbGFjZSgvXCcvZ2ksIn46On4nIikuc3BsaXQoIn46On4iKSxvPXMubGVuZ3RoLGE9W10sbD0wLGM9dGhpcy5zdGVwLHU9MCxkPSIiLGg9MCxwPXI/dChyKTp0aGlzLnNoaWZ0O2ZvcihoPTA7aDxvO2grKylhPWglMj9hLmNvbmNhdChzW2hdKTphLmNvbmNhdChuKHNbaF0sYykpO2ZvcihvPWEubGVuZ3RoLGg9MDtoPG87aCsrKXt1PWkoYVtoXSx1KSwvXHN7MCx9XHN7MCx9U0VMRUNUXHN7MCx9Ly5leGVjKGFbaF0pJiYoYVtoXT1hW2hdLnJlcGxhY2UoL1wsL2csIixcbiIrYytjKSksL1xzezAsfVxzezAsfVNFVFxzezAsfS8uZXhlYyhhW2hdKSYmKGFbaF09YVtoXS5yZXBsYWNlKC9cLC9nLCIsXG4iK2MrYykpLC9cc3swLH1cKFxzezAsfVNFTEVDVFxzezAsfS8uZXhlYyhhW2hdKT8obCsrLGQrPXBbbF0rYVtoXSk6L1wnLy5leGVjKGFbaF0pPyh1PDEmJmwmJmwtLSxkKz1hW2hdKTooZCs9cFtsXSthW2hdLHU8MSYmbCYmbC0tKX1yZXR1cm4gZD1kLnJlcGxhY2UoL15cbnsxLH0vLCIiKS5yZXBsYWNlKC9cbnsxLH0vZywiXG4iKX0sZS5wcm90b3R5cGUueG1sbWluPWZ1bmN0aW9uKHQsZSl7dmFyIGk9ZT90OnQucmVwbGFjZSgvXDwhWyBcclxuXHRdKigtLShbXlwtXXxbXHJcbl18LVteXC1dKSotLVsgXHJcblx0XSopXD4vZywiIikucmVwbGFjZSgvWyBcclxuXHRdezEsfXhtbG5zL2csIiB4bWxucyIpO3JldHVybiBpLnJlcGxhY2UoLz5cc3swLH08L2csIj48Iil9LGUucHJvdG90eXBlLmpzb25taW49ZnVuY3Rpb24odCl7cmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiBKU09OP3Q6SlNPTi5zdHJpbmdpZnkoSlNPTi5wYXJzZSh0KSxudWxsLDApfSxlLnByb3RvdHlwZS5jc3NtaW49ZnVuY3Rpb24odCxlKXt2YXIgaT1lP3Q6dC5yZXBsYWNlKC9cL1wqKFteKl18W1xyXG5dfChcKisoW14qXC9dfFtcclxuXSkpKSpcKitcLy9nLCIiKTtyZXR1cm4gaS5yZXBsYWNlKC9cc3sxLH0vZywiICIpLnJlcGxhY2UoL1x7XHN7MSx9L2csInsiKS5yZXBsYWNlKC9cfVxzezEsfS9nLCJ9IikucmVwbGFjZSgvXDtcc3sxLH0vZywiOyIpLnJlcGxhY2UoL1wvXCpcc3sxLH0vZywiLyoiKS5yZXBsYWNlKC9cKlwvXHN7MSx9L2csIiovIil9LGUucHJvdG90eXBlLnNxbG1pbj1mdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9cc3sxLH0vZywiICIpLnJlcGxhY2UoL1xzezEsfVwoLywiKCIpLnJlcGxhY2UoL1xzezEsfVwpLywiKSIpfSx3aW5kb3cudmtiZWF1dGlmeT1uZXcgZX0oKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKV0scj1mdW5jdGlvbih0KXt2YXIgZT17Tk9ORToibm9uZSIsU0xJREU6InNsaWRlIixGQURFOiJmYWRlIn07cmV0dXJue0RFRkFVTFRfRFVSQVRJT046NDAwLEVGRkVDVFM6ZSxhbmltYXRlOmZ1bmN0aW9uKGksbil7c3dpdGNoKG58fChuPXt9KSx0LmlzU3RyaW5nKG4pJiYobj17ZWZmZWN0Om59KSxuLmVmZmVjdCl7Y2FzZSBlLlNMSURFOmNhc2UgZS5GQURFOmkuaGlkZSgpLGkudG9nZ2xlKG4pO2JyZWFrO2Nhc2UgZS5OT05FOn19fX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7ISh0LmV4cG9ydHM9e1VQOjM4LERPV046NDAsREVMOjQ2LFRBQjo5LFJFVFVSTjoxMyxFTlRFUjoxMyxFU0M6MjcsQ09NTUE6MTg4LFBBR0VVUDozMyxQQUdFRE9XTjozNCxTUEFDRTozMixCQUNLU1BBQ0U6OCxfX2lzS2V5OmZ1bmN0aW9uKHQsZSl7cmV0dXJuKHQud2hpY2h8fHQua2V5Q29kZSk9PXRoaXNbZV19LGlzRW50ZXI6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX19pc0tleSh0LCJFTlRFUiIpfSxpc0VzYzpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fX2lzS2V5KHQsIkVTQyIpfSxpc1NwYWNlQmFyOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9faXNLZXkodCwiU1BBQ0UiKX19KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg1KSxpKDIpLGkoMTM5KSxpKDE1NiksaSgxNDQpLGkoMTQ3KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyl7ZnVuY3Rpb24gbyh0KXt2YXIgaT1bIiVjbWl4cGFuZWw6Iit0LGNdLmNvbmNhdChlLnJlc3QoYXJndW1lbnRzKSk7ci5sb2cuYXBwbHkocixpKX12YXIgYT0iZWQwNGJhN2I0M2FiYmRmYmM1NzhjNTQwMmY4NmEwM2UiLGw9IjczNjIzZDAzNWNkYWJmMTFlOWNmZDc1ODBjNmQ1YTk3IixjPSJiYWNrZ3JvdW5kLWNvbG9yOiNmMTA7IGNvbG9yOiNmZmY7IHBhZGRpbmc6MnB4IjtyZXR1cm4gbi5leHRlbmQoe2NvbXBvbmVudDp2b2lkIDAsbmFtZTp2b2lkIDAsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXtpZih0fHwodD17fSksIXRoaXMuY29tcG9uZW50KXRocm93IG5ldyBFcnJvcigiTXVzdCBkZWZpbmUgbWV0cmljcyBjb21wb25lbnQiKTtpZighdGhpcy5uYW1lKXRocm93IG5ldyBFcnJvcigiTXVzdCBkZWZpbmUgbWV0cmljcyBuYW1lIik7dmFyIGU9dGhpcy5pc1Byb2R1Y3Rpb24oKSxuPWU/bDphLHI9dGhpcy5nZXRTdXBlclByb3BlcnRpZXMoKSxzPXRoaXMuZ2V0RGlzdGluY3RJZCgpLGM9IXdpbmRvdy5va3RhfHx3aW5kb3cub2t0YS5taXhwYW5lbCE9PSExO2kuaW5pdChuLHt9LHRoaXMubmFtZSksdGhpcy5fX2luc3RhbmNlPWlbdGhpcy5uYW1lXSx0aGlzLl9faW5zdGFuY2UucmVnaXN0ZXIociksdGhpcy5fX2luc3RhbmNlLmlkZW50aWZ5KHMpLHRoaXMuX19zZW5kTWl4cGFuZWxFdmVudHM9YyYmKGV8fHQuc2VuZEV2ZW50c0luRGV2KSx0aGlzLl9fc2VuZE1peHBhbmVsRXZlbnRzfHxvKCJpbml0Iix7ZGlzdGluY3RJZDpzLGlzUHJvZDplLHN1cGVyUHJvcGVydGllczpyfSl9LGlzUHJvZHVjdGlvbjpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0RGVwbG95RW52aXJvbm1lbnQoKTtyZXR1cm4iUFJFVklFVyI9PT10fHwiUFJPRCI9PT10fSxnZXREaXN0aW5jdElkOmZ1bmN0aW9uKCl7cmV0dXJuIHQoIiNhbmFseXRpY3MtdWlkIikudGV4dCgpfSxnZXREZXBsb3lFbnZpcm9ubWVudDpmdW5jdGlvbigpe3JldHVybiB0KCIjYW5hbHl0aWNzLWVudiIpLnRleHQoKXx8IkRFViJ9LGdldFN1cGVyUHJvcGVydGllczpmdW5jdGlvbigpe3JldHVybntlbnY6dGhpcy5nZXREZXBsb3lFbnZpcm9ubWVudCgpfX0sZ2V0RGVmYXVsdFByb3BlcnRpZXM6ZnVuY3Rpb24oKXtyZXR1cm57bWV0cmljc0NvbXBvbmVudDp0aGlzLmNvbXBvbmVudCxtZXRyaWNzTmFtZTp0aGlzLm5hbWV9fSxnZXRGdWxsRXZlbnROYW1lOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0RGVmYXVsdFByb3BlcnRpZXMoKTtyZXR1cm4gcy50cGwoInt7bWV0cmljc0NvbXBvbmVudH19Ont7bWV0cmljc05hbWV9fTp7e2V2ZW50TmFtZX19Iikoe21ldHJpY3NDb21wb25lbnQ6ZS5tZXRyaWNzQ29tcG9uZW50LG1ldHJpY3NOYW1lOmUubWV0cmljc05hbWUsZXZlbnROYW1lOnR9KX0sdHJhY2s6ZnVuY3Rpb24oaSxuKXt2YXIgcz1lLmV4dGVuZCh0aGlzLmdldERlZmF1bHRQcm9wZXJ0aWVzKCksbiksYT10LkRlZmVycmVkKCksbD10aGlzLmdldEZ1bGxFdmVudE5hbWUoaSk7cmV0dXJuIHRoaXMuX19zZW5kTWl4cGFuZWxFdmVudHM/dGhpcy5fX2luc3RhbmNlLnRyYWNrKGwscyxmdW5jdGlvbigpe2EucmVzb2x2ZSgpfSk6KGwubGVuZ3RoPjMwJiZyLndhcm4oIlByZWZpeGVkIGV2ZW50IG5hbWUgaXMgdG9vIGxvbmcgKD4zMCk6IitsKSxvKCJ0cmFjayIsbCxzKSxlLmRlZmVyKGEucmVzb2x2ZSkpLGEucHJvbWlzZSgpfSx0aW1lRXZlbnQ6ZnVuY3Rpb24odCl7dGhpcy5fX3NlbmRNaXhwYW5lbEV2ZW50cz90aGlzLl9faW5zdGFuY2UudGltZV9ldmVudCh0aGlzLmdldEZ1bGxFdmVudE5hbWUodCkpOm8oInRpbWVfZXZlbnQiLHRoaXMuZ2V0RnVsbEV2ZW50TmFtZSh0KSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKV0scj1mdW5jdGlvbih0KXt2YXIgZT1uZXcgUmVnRXhwKCIoXFxkKSg/PShcXGR7M30pKyg/IVxcZCkpIiwiZyIpO3JldHVybntudW1iZXJUb1N0cmluZzpmdW5jdGlvbihpLG4pe3ZhciByPW58fCIsIjtyZXR1cm4gdC5pc051bWJlcihpKT9TdHJpbmcoaSkucmVwbGFjZShlLCIkMSIrcik6IjAifX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE3NyldLHI9ZnVuY3Rpb24odCxlKXt2YXIgaT1lLmxvY2FsaXplLG49e1NUUklORzoic3RyaW5nIixOVU1CRVI6Im51bWJlciIsSU5URUdFUjoiaW50ZWdlciIsQk9PTEVBTjoiYm9vbGVhbiIsT0JKRUNUOiJvYmplY3QiLEZPUk1BVERJU1BMQVlUWVBFOnsiZGF0ZS10aW1lIjoiZGF0ZSIsdXJpOiJ1cmkiLGVtYWlsOiJlbWFpbCIsImNvdW50cnktY29kZSI6ImNvdW50cnktY29kZSIsImxhbmd1YWdlLWNvZGUiOiJsYW5ndWFnZS1jb2RlIixsb2NhbGU6ImxvY2FsZSIsdGltZXpvbmU6InRpbWV6b25lIiwicmVmLWlkIjoicmVmZXJlbmNlIn0sQVJSQVlESVNQTEFZVFlQRTp7YXJyYXlvZm9iamVjdDoiYXJyYXlvZm9iamVjdCIsYXJyYXlvZnN0cmluZzoiYXJyYXlvZnN0cmluZyIsYXJyYXlvZm51bWJlcjoiYXJyYXlvZm51bWJlciIsYXJyYXlvZmludGVnZXI6ImFycmF5b2ZpbnRlZ2VyIn0sRElTUExBWVRZUEVTOntkYXRlOnt0eXBlOiJzdHJpbmciLGZvcm1hdDoiZGF0ZS10aW1lIn0sdXJpOnt0eXBlOiJzdHJpbmciLGZvcm1hdDoidXJpIn0sZW1haWw6e3R5cGU6InN0cmluZyIsZm9ybWF0OiJlbWFpbCJ9LCJjb3VudHJ5LWNvZGUiOnt0eXBlOiJzdHJpbmciLGZvcm1hdDoiY291bnRyeS1jb2RlIn0sImxhbmd1YWdlLWNvZGUiOnt0eXBlOiJzdHJpbmciLGZvcm1hdDoibGFuZ3VhZ2UtY29kZSJ9LGxvY2FsZTp7dHlwZToic3RyaW5nIixmb3JtYXQ6ImxvY2FsZSJ9LHRpbWV6b25lOnt0eXBlOiJzdHJpbmciLGZvcm1hdDoidGltZXpvbmUifSxzdHJpbmc6e3R5cGU6InN0cmluZyJ9LG51bWJlcjp7dHlwZToibnVtYmVyIn0sImJvb2xlYW4iOnt0eXBlOiJib29sZWFuIn0saW50ZWdlcjp7dHlwZToiaW50ZWdlciJ9LHJlZmVyZW5jZTp7dHlwZToic3RyaW5nIixmb3JtYXQ6InJlZi1pZCJ9LGFycmF5b2ZvYmplY3Q6e3R5cGU6ImFycmF5IixpdGVtczp7dHlwZToib2JqZWN0In19LGFycmF5b2ZzdHJpbmc6e3R5cGU6ImFycmF5IixpdGVtczp7dHlwZToic3RyaW5nIn19LGFycmF5b2ZudW1iZXI6e3R5cGU6ImFycmF5IixpdGVtczp7dHlwZToibnVtYmVyIn19LGFycmF5b2ZpbnRlZ2VyOnt0eXBlOiJhcnJheSIsaXRlbXM6e3R5cGU6ImludGVnZXIifX0saW1hZ2U6e3R5cGU6ImltYWdlIn0scGFzc3dvcmQ6e3R5cGU6InN0cmluZyJ9fSxTVVBQT1JUU01JTk1BWDpbInN0cmluZyIsIm51bWJlciIsImludGVnZXIiLCJwYXNzd29yZCJdLERBVEFUWVBFOntzdHJpbmc6InN0cmluZyIsbnVtYmVyOiJudW1iZXIiLCJib29sZWFuIjoiYm9vbGVhbiIsaW50ZWdlcjoiaW50ZWdlciIsZGF0ZToiZGF0ZXRpbWUiLG9iamVjdDoib2JqZWN0IixhcnJheW9mb2JqZWN0OiJvYmplY3QgYXJyYXkiLGFycmF5b2ZzdHJpbmc6InN0cmluZyBhcnJheSIsYXJyYXlvZm51bWJlcjoibnVtYmVyIGFycmF5IixhcnJheW9maW50ZWdlcjoiaW50ZWdlciBhcnJheSIsImNvdW50cnktY29kZSI6ImNvdW50cnkgY29kZSIsImxhbmd1YWdlLWNvZGUiOiJsYW5ndWFnZSBjb2RlIixyZWZlcmVuY2U6InJlZmVyZW5jZSIsdGltZXpvbmU6InRpbWV6b25lIixpbWFnZToiaW1hZ2UifSxNVVRBQklMSVRZOntSRUFET05MWToiUkVBRF9PTkxZIixXUklURU9OTFk6IldSSVRFX09OTFkiLFJFQURXUklURToiUkVBRF9XUklURSIsSU1NVVRBQkxFOiJJTU1VVEFCTEUifSxTQ09QRTp7Tk9ORToiTk9ORSIsU0VMRjoiU0VMRiIsU1lTVEVNOiJTWVNURU0ifSxESVNQTEFZU0NPUEU6e1NFTEY6IlVzZXIgcGVyc29uYWwiLFNZU1RFTToiU3lzdGVtIixOQToiTm9uZSJ9LFVOSU9OOntESVNBQkxFOiJESVNBQkxFIixFTkFCTEU6IkVOQUJMRSJ9LFVOSU9OX09QVElPTlM6e0RJU0FCTEU6aSgidW5pdmVyc2FsLWRpcmVjdG9yeS5wcm9maWxlcy5hdHRyaWJ1dGUuZm9ybS51bmlvbi5lbmFibGUuZGlzcGxheSIpLEVOQUJMRTppKCJ1bml2ZXJzYWwtZGlyZWN0b3J5LnByb2ZpbGVzLmF0dHJpYnV0ZS5mb3JtLnVuaW9uLmRpc2FibGUuZGlzcGxheSIpfSxQRVJNSVNTSU9OOntISURFOiJISURFIixSRUFEX09OTFk6IlJFQURfT05MWSIsV1JJVEVfT05MWToiV1JJVEVfT05MWSIsUkVBRF9XUklURToiUkVBRF9XUklURSJ9LEVORFVTRVJfQVRUUklCVVRFX1BFUk1JU1NJT05fT1BUSU9OUzp7SElERTppKCJ1bml2ZXJzYWwtZGlyZWN0b3J5LnByb2ZpbGVzLmF0dHJpYnV0ZS5lbmR1c2VyLnBlcm1pc3Npb24uaGlkZSIpLFJFQURfT05MWTppKCJ1bml2ZXJzYWwtZGlyZWN0b3J5LnByb2ZpbGVzLmF0dHJpYnV0ZS5lbmR1c2VyLnBlcm1pc3Npb24ucmVhZG9ubHkiKSxSRUFEX1dSSVRFOmkoInVuaXZlcnNhbC1kaXJlY3RvcnkucHJvZmlsZXMuYXR0cmlidXRlLmVuZHVzZXIucGVybWlzc2lvbi5yZWFkd3JpdGUiKX0sQVRUUklCVVRFX0xFVkVMX01BU1RFUklOR19PUFRJT05TOntJTkhFUklUOmkoInVuaXZlcnNhbC1kaXJlY3RvcnkucHJvZmlsZXMuYXR0cmlidXRlLm1hc3Rlci5pbmhlcml0IiksT0tUQV9NQVNURVJFRDppKCJ1bml2ZXJzYWwtZGlyZWN0b3J5LnByb2ZpbGVzLmF0dHJpYnV0ZS5tYXN0ZXIub2t0YW1hc3RlcmVkIiksT1ZFUlJJREU6aSgidW5pdmVyc2FsLWRpcmVjdG9yeS5wcm9maWxlcy5hdHRyaWJ1dGUubWFzdGVyLm92ZXJyaWRlIil9LFVTRVJOQU1FVFlQRTp7Tk9ORToibm9uLXVzZXJuYW1lIixPS1RBX1RPX0FQUDoib2t0YS10by1hcHAtdXNlcm5hbWUiLE9LVEFfVE9fQUQ6Im9rdGEtdG8tYWQtdXNlcm5hbWUiLEFQUF9UT19PS1RBOiJhcHAtdG8tb2t0YS11c2VybmFtZSIsSURQX1RPX09LVEE6ImlkcC10by1va3RhLXVzZXJuYW1lIn0sZ2V0RGlzcGxheVR5cGU6ZnVuY3Rpb24odCxlLGksbil7dmFyIHI7cmV0dXJuIHQmJihyPWU/dGhpcy5GT1JNQVRESVNQTEFZVFlQRVtlXTppP3RoaXMuQVJSQVlESVNQTEFZVFlQRVt0KyJvZiIraV06dCkscnx8KHI9InVuZGVmaW5lZCI9PXR5cGVvZiBuPyIiOm4pLHJ9LGdldFNvdXJjZVVzZXJuYW1lVHlwZTpmdW5jdGlvbih0LGUsaSl7dmFyIG49dGhpcy5VU0VSTkFNRVRZUEUuTk9ORTtyZXR1cm4ib2t0YVRvQXBwIj09PXQ/InVzZXJOYW1lIj09PWU/bj10aGlzLlVTRVJOQU1FVFlQRS5PS1RBX1RPX0FQUDoiY24iPT09ZSYmKG49dGhpcy5VU0VSTkFNRVRZUEUuT0tUQV9UT19BRCk6ImFwcFRvT2t0YSI9PT10JiYibG9naW4iPT09ZSYmKG49InNhbWxfaWRwIj09PWk/dGhpcy5VU0VSTkFNRVRZUEUuSURQX1RPX09LVEE6dGhpcy5VU0VSTkFNRVRZUEUuQVBQX1RPX09LVEEpLG59LGlzQXJyYXlEYXRhVHlwZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5jb250YWlucyh0LnZhbHVlcyh0aGlzLkFSUkFZRElTUExBWVRZUEUpLGUpfSxpc09iamVjdERhdGFUeXBlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLkRBVEFUWVBFLm9iamVjdD09PXR9fTtyZXR1cm4gbn0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoNSksaSgxNzgpLGkoNyldLHI9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXsiJmFtcDsiOiImIiwiJmx0OyI6IjwiLCImZ3Q7IjoiPiIsIiZxdW90OyI6JyInLCImIzM5OyI6IiciLCImIzAzOTsiOiInIiwiJiN4MkY7IjoiLyJ9LHI9L14oKFtePD4oKVtcXVxcLiw7OlxzQFwiXSsoXC5bXjw+KClbXF1cXC4sOzpcc0BcIl0rKSopfChcIi4rXCIpKUAoPyEtKSgoXFs/WzAtOV17MSwzfVwuWzAtOV17MSwzfVwuWzAtOV17MSwzfVwuWzAtOV17MSwzfVxdPyl8KChbYS16QS1aXC0wLTldK1wuKStbYS16QS1aXXsyLH0pKSQvLHM9e3NwcmludGY6ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dGhyb3cgbmV3IEVycm9yKCJNaXNtYXRjaCBudW1iZXIgb2YgdmFyaWFibGVzOiAiK2FyZ3VtZW50c1swXSsiLCAiK0pTT04uc3RyaW5naWZ5KGUpKX1mb3IodmFyIGU9QXJyYXkucHJvdG90eXBlLnNsaWNlLmFwcGx5KGFyZ3VtZW50cyksaT1lLnNoaWZ0KCksbj1pLHI9MCxzPWUubGVuZ3RoO3I8cztyKyspe3ZhciBvPWVbcl07aT1pLnJlcGxhY2UoInsiK3IrIn0iLG8pLHZvaWQgMCE9PW8mJm51bGwhPT1vJiZpIT09bnx8dCgpLG49aX1yZXR1cm4vXHtbXGQrXVx9Ly50ZXN0KGkpJiZ0KCksaX0scGFyc2VRdWVyeTpmdW5jdGlvbih0KXtmb3IodmFyIGU9e30saT1kZWNvZGVVUklDb21wb25lbnQodC5yZXBsYWNlKC9cKy9nLCIgIikpLnNwbGl0KCImIiksbj0wO248aS5sZW5ndGg7bisrKXt2YXIgcj1pW25dLHM9ci5zcGxpdCgiPSIpO2Vbcy5zaGlmdCgpXT1zLmpvaW4oIj0iKX1yZXR1cm4gZX0sZW5jb2RlSlNPYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeSh0KSl9LGRlY29kZUpTT2JqZWN0OmZ1bmN0aW9uKHQpe3RyeXtyZXR1cm4gSlNPTi5wYXJzZShkZWNvZGVVUklDb21wb25lbnQodCkpfWNhdGNoKGUpe3JldHVybiBudWxsfX0sdW5lc2NhcGVIdG1sOmZ1bmN0aW9uKHQpe3JldHVybiBTdHJpbmcodCkucmVwbGFjZSgvJltcd1wjXGRdezIsfTsvZyxmdW5jdGlvbih0KXtyZXR1cm4gblt0XXx8dH0pfSxsb2NhbGl6ZTpmdW5jdGlvbihlLG4scil7dmFyIG89bj9pW25dOmlbdC5rZXlzKGkpWzBdXTtpZighbylyZXR1cm4iTDEwTl9FUlJPUlsiK24rIl0iO3ZhciBhPW9bZV07dHJ5e3I9ciYmci5zbGljZT9yLnNsaWNlKDApOltdLHIudW5zaGlmdChhKSxhPXMuc3ByaW50Zi5hcHBseShudWxsLHIpfWNhdGNoKGwpe2E9bnVsbH1yZXR1cm4gYXx8IkwxME5fRVJST1JbIitlKyJdIn0scGFyc2VGbG9hdDpmdW5jdGlvbih0KXt2YXIgZT0rdDtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIHQmJmU9PT1wYXJzZUZsb2F0KHQpP2U6dH0scmFuZG9tU3RyaW5nOmZ1bmN0aW9uKGUpe3ZhciBpPSIwMTIzNDU2Nzg5QUJDREVGR0hJSktMTU5PUFFSU1RVVldYVFphYmNkZWZnaGlrbG1ub3BxcnN0dXZ3eHl6IjtpZih2b2lkIDA9PT1lKWU9dC5yYW5kb20oaS5sZW5ndGgpO2Vsc2UgaWYoMD09PWUpcmV0dXJuIiI7Zm9yKHZhciBuPVtdO2UtLTspbi5wdXNoKGlbdC5yYW5kb20oaS5sZW5ndGgtMSldKTtyZXR1cm4gbi5qb2luKCIiKX0sZW5kc1dpdGg6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdCs9IiIsZSs9IiIsdC5sZW5ndGg+PWUubGVuZ3RoJiZ0LnN1YnN0cmluZyh0Lmxlbmd0aC1lLmxlbmd0aCk9PT1lfSxpc0VtYWlsOmZ1bmN0aW9uKGkpe3ZhciBuPWUudHJpbShpKTtyZXR1cm4hdC5pc0VtcHR5KG4pJiZyLnRlc3Qobil9fTtyZXR1cm4gc30uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMjEpLGkoNSksaSgxNzkpLGkoMTgwKSxpKDE4MSksaSgxKSxpKDE4MildLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhKXtmdW5jdGlvbiBsKGUpe3JldHVybiBlP3QubWFwT2JqZWN0KGUsZnVuY3Rpb24oZSl7dmFyIGk9e2xvZ2luOnt9LGNvdW50cnk6e319O2lmKCF0LmlzT2JqZWN0KGUpKXRocm93IG5ldyBFcnJvcignSW52YWxpZCBmb3JtYXQgZm9yICJpMThuIicpO3JldHVybiB0LmVhY2goZSxmdW5jdGlvbih0LGUpe3ZhciBuPWUuc3BsaXQoL15jb3VudHJ5XC4vKTtuLmxlbmd0aD4xP2kuY291bnRyeVtuWzFdXT10OmkubG9naW5bblswXV09dH0pLGl9KTp7fX1mdW5jdGlvbiBjKCl7dmFyIHQ9SlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShwKSk7cmV0dXJuIHQmJnQudmVyc2lvbj09PW8udmVyc2lvbnx8KHQ9e3ZlcnNpb246by52ZXJzaW9ufSksdH1mdW5jdGlvbiB1KHQsZSxpKXt2YXIgbj1jKCk7blt0XT17bG9naW46ZSxjb3VudHJ5Oml9LGxvY2FsU3RvcmFnZS5zZXRJdGVtKHAsSlNPTi5zdHJpbmdpZnkobikpfWZ1bmN0aW9uIGQodCxlLG4pe3ZhciByLHM7cmV0dXJuIHI9ZS5yZXBsYWNlKCItIiwiXyIpLHM9bi5yZXdyaXRlKGYoe2J1bmRsZTp0LGxhbmd1YWdlQ29kZTpyfSkpLGkuYWpheCh7dXJsOm4uYmFzZVVybCtzLGRhdGFUeXBlOiJqc29ucCIsY2FjaGU6ITAsdGltZW91dDo1ZTMsanNvbnBDYWxsYmFjazoianNvbnBfIit0fSl9ZnVuY3Rpb24gaChpLG4pe2lmKCJlbiI9PT1pfHwhdC5jb250YWlucyhvLnN1cHBvcnRlZExhbmd1YWdlcyxpKSlyZXR1cm4gZSh7fSk7dmFyIHI9IWEubG9jYWxTdG9yYWdlSXNOb3RTdXBwb3J0ZWQoKTtpZihyKXt2YXIgbD1jKCk7aWYobFtpXSlyZXR1cm4gZShsW2ldKX1yZXR1cm4gZS5hbGwoW2QoImxvZ2luIixpLG4pLGQoImNvdW50cnkiLGksbildKS5zcHJlYWQoZnVuY3Rpb24odCxlKXtyZXR1cm4gciYmdShpLHQsZSkse2xvZ2luOnQsY291bnRyeTplfX0pLmZhaWwoZnVuY3Rpb24oKXtyZXR1cm4gcy53YXJuKCJVbmFibGUgdG8gbG9hZCBsYW5ndWFnZTogIitpKSx7fX0pfXZhciBwPSJvc3cubGFuZ3VhZ2VzIixmPXQudGVtcGxhdGUoIi9sYWJlbHMvanNvbnAve3tidW5kbGV9fV97e2xhbmd1YWdlQ29kZX19Lmpzb25wIik7cmV0dXJue2xvZ2luOm4sY291bnRyeTpyLGN1cnJlbnRMYW5ndWFnZTpudWxsLGlzTG9hZGVkOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmN1cnJlbnRMYW5ndWFnZT09PXR9LGxvYWRMYW5ndWFnZTpmdW5jdGlvbihlLGkscyl7dmFyIG89bChpKSxhPWUudG9Mb3dlckNhc2UoKTtyZXR1cm4gaChlLHMpLnRoZW4odC5iaW5kKGZ1bmN0aW9uKGkpe3RoaXMubG9naW49dC5leHRlbmQoe30sbixpLmxvZ2luKSx0aGlzLmNvdW50cnk9dC5leHRlbmQoe30scixpLmNvdW50cnkpLG9bYV0mJih0LmV4dGVuZCh0aGlzLmxvZ2luLG9bYV0ubG9naW4pLHQuZXh0ZW5kKHRoaXMuY291bnRyeSxvW2FdLmNvdW50cnkpKSx0aGlzLmN1cnJlbnRMYW5ndWFnZT1lfSx0aGlzKSl9fX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUpe3QuZXhwb3J0cz17c2lnbm91dDoiU2lnbiBPdXQiLHJlbWVtYmVyOiJSZW1lbWJlciBtZSIscmVtZW1iZXJEZXZpY2U6IlRydXN0IHRoaXMgZGV2aWNlIiwicmVtZW1iZXJEZXZpY2UudGltZWJhc2VkIjoiRG8gbm90IGNoYWxsZW5nZSBtZSBvbiB0aGlzIGRldmljZSBmb3IgdGhlIG5leHQgezB9IiwicmVtZW1iZXJEZXZpY2UuZGV2aWNlYmFzZWQiOiJEbyBub3QgY2hhbGxlbmdlIG1lIG9uIHRoaXMgZGV2aWNlIGFnYWluIixhdXRvUHVzaDoiU2VuZCBwdXNoIGF1dG9tYXRpY2FsbHkiLHVubG9ja2FjY291bnQ6IlVubG9jayBhY2NvdW50PyIsbmVlZGhlbHA6Ik5lZWQgaGVscCBzaWduaW5nIGluPyIsZ29iYWNrOiJCYWNrIHRvIFNpZ24gSW4iLGZvcmdvdHBhc3N3b3JkOiJGb3Jnb3QgcGFzc3dvcmQ/IixoZWxwOiJIZWxwIixyZXRyeToiUmV0cnkiLCJtaW51dGVzLm9uZU1pbnV0ZSI6Im1pbnV0ZSIsbWludXRlczoiezB9IG1pbnV0ZXMiLGhvdXJzOiJ7MH0gaG91cnMiLGRheXM6InswfSBkYXlzIiwiZXJyb3IuY29uZmlnIjoiVGhlcmUgd2FzIGEgY29uZmlndXJhdGlvbiBlcnJvciIsImVycm9yLnJlcXVpcmVkLmF1dGhQYXJhbXMiOidNaXNzaW5nIHBhcmFtZXRlcnMgZm9yIHRoZSBjb25maWd1cmVkIGF1dGhlbnRpY2F0aW9uIHNjaGVtZSAtICJPQVVUSDIiJywiZXJyb3IucmVxdWlyZWQuYmFzZVVybCI6JyJiYXNlVXJsIiBpcyBhIHJlcXVpcmVkIHdpZGdldCBwYXJhbWV0ZXInLCJlcnJvci5yZXF1aXJlZC5zdWNjZXNzIjoiQSBzdWNjZXNzIGhhbmRsZXIgaXMgcmVxdWlyZWQiLCJlcnJvci5yZXF1aXJlZC5lbCI6JyJlbCIgaXMgYSByZXF1aXJlZCB3aWRnZXQgcGFyYW1ldGVyJywiZXJyb3IudW5zdXBwb3J0ZWQuYnJvd3NlciI6IlVuc3VwcG9ydGVkIGJyb3dzZXIiLCJlcnJvci51bnN1cHBvcnRlZC5jb3JzIjoiVW5zdXBwb3J0ZWQgYnJvd3NlciAtIG1pc3NpbmcgQ09SUyBzdXBwb3J0IiwiZXJyb3IudW5zdXBwb3J0ZWQubG9jYWxTdG9yYWdlIjoiVW5zdXBwb3J0ZWQgYnJvd3NlciAtIG1pc3NpbmcgbG9jYWxTdG9yYWdlIHN1cHBvcnQiLCJlcnJvci5lbmFibGVkLmNvcnMiOiJUaGVyZSB3YXMgYW4gZXJyb3Igc2VuZGluZyB0aGUgcmVxdWVzdCAtIGhhdmUgeW91IGVuYWJsZWQgQ09SUz8iLCJlcnJvci5leHBpcmVkLnNlc3Npb24iOiJZb3VyIHNlc3Npb24gaGFzIGV4cGlyZWQuIFBsZWFzZSB0cnkgdG8gbG9nIGluIGFnYWluLiIsImVycm9yLmF1dGgubG9ja2VkT3V0IjoiWW91ciBhY2NvdW50IGlzIGxvY2tlZC4gUGxlYXNlIGNvbnRhY3QgeW91ciBhZG1pbmlzdHJhdG9yLiIsImVycm9yLm9hdXRoLmlkVG9rZW4iOiJUaGVyZSB3YXMgYSBwcm9ibGVtIGdlbmVyYXRpbmcgdGhlIGlkX3Rva2VuIGZvciB0aGUgdXNlci4gUGxlYXNlIHRyeSBhZ2Fpbi4iLCJlcnJvci5uZXR3b3JrLmNvbm5lY3Rpb24iOiJVbmFibGUgdG8gY29ubmVjdCB0byB0aGUgc2VydmVyLiBQbGVhc2UgY2hlY2sgeW91ciBuZXR3b3JrIGNvbm5lY3Rpb24uIiwiZXJyb3IudXNlcm5hbWUucmVxdWlyZWQiOiJQbGVhc2UgZW50ZXIgYSB1c2VybmFtZSIsImVycm9yLnBhc3N3b3JkLnJlcXVpcmVkIjoiUGxlYXNlIGVudGVyIGEgcGFzc3dvcmQiLCJlcnJvcnMuRTAwMDAwMDQiOiJTaWduIGluIGZhaWxlZCEiLCJlcnJvcnMuRTAwMDAwNjkiOiJZb3VyIGFjY291bnQgd2FzIGxvY2tlZCBkdWUgdG8gZXhjZXNzaXZlIE1GQSBhdHRlbXB0cy4iLCJlcnJvcnMuRTAwMDAwNDciOiJZb3UgZXhjZWVkZWQgdGhlIG1heGltdW0gbnVtYmVyIG9mIHJlcXVlc3RzLiBUcnkgYWdhaW4gaW4gYSB3aGlsZS4iLCJlcnJvcnMuRTAwMDAwMDEiOiJBcGkgdmFsaWRhdGlvbiBmYWlsZWQ6IHswfSIsImVycm9ycy5FMDAwMDAwMiI6IlRoZSByZXF1ZXN0IHdhcyBub3QgdmFsaWQ6IHswfSIsImVycm9ycy5FMDAwMDAwMyI6IlRoZSByZXF1ZXN0IGJvZHkgd2FzIG5vdCB3ZWxsLWZvcm1lZC4iLCJlcnJvcnMuRTAwMDAwMDUiOiJJbnZhbGlkIHNlc3Npb24iLCJlcnJvcnMuRTAwMDAwMDYiOiJZb3UgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBwZXJmb3JtIHRoZSByZXF1ZXN0ZWQgYWN0aW9uIiwiZXJyb3JzLkUwMDAwMDA3IjoiTm90IGZvdW5kOiB7MH0iLCJlcnJvcnMuRTAwMDAwMDgiOiJUaGUgcmVxdWVzdGVkIHBhdGggd2FzIG5vdCBmb3VuZCIsImVycm9ycy5FMDAwMDAwOSI6IkludGVybmFsIFNlcnZlciBFcnJvciIsImVycm9ycy5FMDAwMDAxMCI6IlNlcnZpY2UgaXMgaW4gcmVhZCBvbmx5IG1vZGUiLCJlcnJvcnMuRTAwMDAwMTEiOiJJbnZhbGlkIHRva2VuIHByb3ZpZGVkIiwiZXJyb3JzLkUwMDAwMDEyIjoiVW5zdXBwb3J0ZWQgbWVkaWEgdHlwZSIsImVycm9ycy5FMDAwMDAxMyI6IkludmFsaWQgY2xpZW50IGFwcCBpZCIsImVycm9ycy5FMDAwMDAxNSI6IllvdSBkbyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGFjY2VzcyB0aGUgZmVhdHVyZSB5b3UgYXJlIHJlcXVlc3RpbmciLCJlcnJvcnMuRTAwMDAwMTYiOiJBY3RpdmF0aW9uIGZhaWxlZCBiZWNhdXNlIHRoZSB1c2VyIGlzIGFscmVhZHkgYWN0aXZlIiwiZXJyb3JzLkUwMDAwMDE3IjoiUGFzc3dvcmQgcmVzZXQgZmFpbGVkIiwiZXJyb3JzLkUwMDAwMDE4IjoiQmFkIHJlcXVlc3QuICBBY2NlcHQgYW5kL29yIENvbnRlbnQtVHlwZSBoZWFkZXJzIGFyZSBsaWtlbHkgbm90IHNldC4iLCJlcnJvcnMuRTAwMDAwMTkiOiJCYWQgcmVxdWVzdC4gIEFjY2VwdCBhbmQvb3IgQ29udGVudC1UeXBlIGhlYWRlcnMgbGlrZWx5IGRvIG5vdCBtYXRjaCBzdXBwb3J0ZWQgdmFsdWVzLiIsImVycm9ycy5FMDAwMDAyMCI6IkJhZCByZXF1ZXN0LiIsImVycm9ycy5FMDAwMDAyMSI6IkJhZCByZXF1ZXN0LiAgQWNjZXB0IGFuZC9vciBDb250ZW50LVR5cGUgaGVhZGVycyBsaWtlbHkgZG8gbm90IG1hdGNoIHN1cHBvcnRlZCB2YWx1ZXMuIiwiZXJyb3JzLkUwMDAwMDIyIjoiVGhlIGVuZHBvaW50IGRvZXMgbm90IHN1cHBvcnQgdGhlIHByb3ZpZGVkIEhUVFAgbWV0aG9kIiwiZXJyb3JzLkUwMDAwMDIzIjoiT3BlcmF0aW9uIGZhaWxlZCBiZWNhdXNlIHVzZXIgcHJvZmlsZSBpcyBtYXN0ZXJlZCB1bmRlciBhbm90aGVyIHN5c3RlbSIsImVycm9ycy5FMDAwMDAyNCI6IkJhZCByZXF1ZXN0LiAgVGhpcyBvcGVyYXRpb24gb24gYXBwIG1ldGFkYXRhIGlzIG5vdCB5ZXQgc3VwcG9ydGVkLiIsImVycm9ycy5FMDAwMDAyNSI6IkFwcCB2ZXJzaW9uIGFzc2lnbm1lbnQgZmFpbGVkLiIsImVycm9ycy5FMDAwMDAyNiI6IlRoaXMgZW5kcG9pbnQgaGFzIGJlZW4gZGVwcmVjYXRlZC4iLCJlcnJvcnMuRTAwMDAwMjciOiJHcm91cCBwdXNoIGJhZCByZXF1ZXN0IDogezB9IiwiZXJyb3JzLkUwMDAwMDI4IjoiVGhlIHJlcXVlc3QgaXMgbWlzc2luZyBhIHJlcXVpcmVkIHBhcmFtZXRlci4iLCJlcnJvcnMuRTAwMDAwMjkiOiJJbnZhbGlkIHBhZ2luZyByZXF1ZXN0LiIsImVycm9ycy5FMDAwMDAzMCI6IkJhZCByZXF1ZXN0LiBJbnZhbGlkIGRhdGUuIERhdGVzIG11c3QgYmUgb2YgdGhlIGZvcm0geXl5eS1NTS1kZCcnVCcnSEg6bW06c3MuU1NTWlosIGUuZy4gMjAxMy0wMS0wMVQxMjowMDowMC4wMDAtMDc6MDAuIiwiZXJyb3JzLkUwMDAwMDMxIjoiSW52YWxpZCBzZWFyY2ggY3JpdGVyaWEuIiwiZXJyb3JzLkUwMDAwMDMyIjoiVW5sb2NrIGlzIG5vdCBhbGxvd2VkIGZvciB0aGlzIHVzZXIuIiwiZXJyb3JzLkUwMDAwMDMzIjoiQmFkIHJlcXVlc3QuIENhbid0IHNwZWNpZnkgYSBzZWFyY2ggcXVlcnkgYW5kIGZpbHRlciBpbiB0aGUgc2FtZSByZXF1ZXN0LiIsImVycm9ycy5FMDAwMDAzNCI6IkZvcmdvdCBwYXNzd29yZCBub3QgYWxsb3dlZCBvbiBzcGVjaWZpZWQgdXNlci4iLCJlcnJvcnMuRTAwMDAwMzUiOiJDaGFuZ2UgcGFzc3dvcmQgbm90IGFsbG93ZWQgb24gc3BlY2lmaWVkIHVzZXIuIiwiZXJyb3JzLkUwMDAwMDM2IjoiQ2hhbmdlIHJlY292ZXJ5IHF1ZXN0aW9uIG5vdCBhbGxvd2VkIG9uIHNwZWNpZmllZCB1c2VyLiIsImVycm9ycy5FMDAwMDAzNyI6IlR5cGUgbWlzbWF0Y2ggZXhjZXB0aW9uLiIsImVycm9ycy5FMDAwMDAzOCI6IlRoaXMgb3BlcmF0aW9uIGlzIG5vdCBhbGxvd2VkIGluIHRoZSB1c2VyJydzIGN1cnJlbnQgc3RhdHVzLiIsImVycm9ycy5FMDAwMDAzOSI6Ik9wZXJhdGlvbiBvbiBhcHBsaWNhdGlvbiBzZXR0aW5ncyBmYWlsZWQuIiwiZXJyb3JzLkUwMDAwMDQwIjoiQXBwbGljYXRpb24gbGFiZWwgbXVzdCBub3QgYmUgdGhlIHNhbWUgYXMgYW4gZXhpc3RpbmcgYXBwbGljYXRpb24gbGFiZWwuIiwiZXJyb3JzLkUwMDAwMDQxIjoiQ3JlZGVudGlhbHMgc2hvdWxkIG5vdCBiZSBzZXQgb24gdGhpcyByZXNvdXJjZSBiYXNlZCBvbiB0aGUgc2NoZW1lLiIsImVycm9ycy5FMDAwMDA0MiI6IlNldHRpbmcgdGhlIGVycm9yIHBhZ2UgcmVkaXJlY3QgVVJMIGZhaWxlZC4iLCJlcnJvcnMuRTAwMDAwNDMiOiJTZWxmIHNlcnZpY2UgYXBwbGljYXRpb24gYXNzaWdubWVudCBpcyBub3QgZW5hYmxlZC4iLCJlcnJvcnMuRTAwMDAwNDQiOiJTZWxmIHNlcnZpY2UgYXBwbGljYXRpb24gYXNzaWdubWVudCBpcyBub3Qgc3VwcG9ydGVkLiIsImVycm9ycy5FMDAwMDA0NSI6IkZpZWxkIG1hcHBpbmcgYmFkIHJlcXVlc3QuIiwiZXJyb3JzLkUwMDAwMDQ2IjoiRGVhY3RpdmF0ZSBhcHBsaWNhdGlvbiBmb3IgdXNlciBmb3JiaWRkZW4uIiwiZXJyb3JzLkUwMDAwMDQ4IjoiRW50aXR5IG5vdCBmb3VuZCBleGNlcHRpb24uIiwiZXJyb3JzLkUwMDAwMDQ5IjoiSW52YWxpZCBTQ0lNIGRhdGEgZnJvbSBTQ0lNIGltcGxlbWVudGF0aW9uLiIsImVycm9ycy5FMDAwMDA1MCI6IkludmFsaWQgU0NJTSBkYXRhIGZyb20gY2xpZW50LiIsImVycm9ycy5FMDAwMDA1MSI6Ik5vIHJlc3BvbnNlIGZyb20gU0NJTSBpbXBsZW1lbnRhdGlvbi4iLCJlcnJvcnMuRTAwMDAwNTIiOiJFbmRwb2ludCBub3QgaW1wbGVtZW50ZWQuIiwiZXJyb3JzLkUwMDAwMDUzIjoiSW52YWxpZCBTQ0lNIGZpbHRlci4iLCJlcnJvcnMuRTAwMDAwNTQiOiJJbnZhbGlkIHBhZ2luYXRpb24gcHJvcGVydGllcy4iLCJlcnJvcnMuRTAwMDAwNTUiOiJEdXBsaWNhdGUgZ3JvdXAuIiwiZXJyb3JzLkUwMDAwMDU2IjoiRGVsZXRlIGFwcGxpY2F0aW9uIGZvcmJpZGRlbi4iLCJlcnJvcnMuRTAwMDAwNTciOiJBY2Nlc3MgdG8gdGhpcyBhcHBsaWNhdGlvbiBpcyBkZW5pZWQgZHVlIHRvIGEgcG9saWN5LiIsImVycm9ycy5FMDAwMDA1OCI6IkFjY2VzcyB0byB0aGlzIGFwcGxpY2F0aW9uIHJlcXVpcmVzIE1GQTogezB9IiwiZXJyb3JzLkUwMDAwMDU5IjoiVGhlIGNvbm5lY3RvciBjb25maWd1cmF0aW9uIGNvdWxkIG5vdCBiZSB0ZXN0ZWQuIE1ha2Ugc3VyZSB0aGF0IHRoZSBVUkwsIEF1dGhlbnRpY2F0aW9uIFBhcmFtZXRlcnMgYXJlIGNvcnJlY3QgYW5kIHRoYXQgdGhlcmUgaXMgYW4gaW1wbGVtZW50YXRpb24gYXZhaWxhYmxlIGF0IHRoZSBVUkwgcHJvdmlkZWQuIiwiZXJyb3JzLkUwMDAwMDYwIjoiVW5zdXBwb3J0ZWQgb3BlcmF0aW9uLiIsImVycm9ycy5FMDAwMDA2MSI6IlRhYiBlcnJvcjogezB9IiwiZXJyb3JzLkUwMDAwMDYyIjoiVGhlIHNwZWNpZmllZCB1c2VyIGlzIGFscmVhZHkgYXNzaWduZWQgdG8gdGhlIGFwcGxpY2F0aW9uLiIsImVycm9ycy5FMDAwMDA2MyI6IkludmFsaWQgY29tYmluYXRpb24gb2YgcGFyYW1ldGVycyBzcGVjaWZpZWQuIiwiZXJyb3JzLkUwMDAwMDY0IjoiUGFzc3dvcmQgaXMgZXhwaXJlZCBhbmQgbXVzdCBiZSBjaGFuZ2VkLiIsImVycm9ycy5FMDAwMDA2NSI6IkludGVybmFsIGVycm9yIHByb2Nlc3NpbmcgYXBwIG1ldGFkYXRhLiIsImVycm9ycy5FMDAwMDA2NiI6IkFQTlMgaXMgbm90IGNvbmZpZ3VyZWQsIGNvbnRhY3QgeW91ciBhZG1pbiIsImVycm9ycy5FMDAwMDA2NyI6IkZhY3RvcnMgU2VydmljZSBFcnJvci4iLCJlcnJvcnMuRTAwMDAwNzAiOiJXYWl0aW5nIGZvciBBQ0siLCJlcnJvcnMuRTAwMDAwNzEiOiJVbnN1cHBvcnRlZCBPUyBWZXJzaW9uOiB7MH0iLCJlcnJvcnMuRTAwMDAwNzIiOiJNSU0gcG9saWN5IHNldHRpbmdzIGhhdmUgZGlzYWxsb3dlZCBlbnJvbGxtZW50IGZvciB0aGlzIHVzZXIiLCJlcnJvcnMuRTAwMDAwNzMiOiJVc2VyIHJlamVjdGVkIGF1dGhlbnRpY2F0aW9uIiwiZXJyb3JzLkUwMDAwMDc0IjoiRmFjdG9yIFNlcnZpY2UgRXJyb3IiLCJlcnJvcnMuRTAwMDAwNzUiOiJDYW5ub3QgbW9kaWZ5IHRoZSB7MH0gYXR0cmlidXRlIGJlY2F1c2UgaXQgaGFzIGEgZmllbGQgbWFwcGluZyBhbmQgcHJvZmlsZSBwdXNoIGlzIGVuYWJsZWQuIiwiZXJyb3JzLkUwMDAwMDc2IjoiQ2Fubm90IG1vZGlmeSB0aGUgYXBwIHVzZXIgYmVjYXVzZSBpdCBpcyBtYXN0ZXJlZCBieSBhbiBleHRlcm5hbCBhcHAuIiwiZXJyb3JzLkUwMDAwMDc3IjoiQ2Fubm90IG1vZGlmeSB0aGUgezB9IGF0dHJpYnV0ZSBiZWNhdXNlIGl0IGlzIHJlYWQtb25seS4iLCJlcnJvcnMuRTAwMDAwNzgiOiJDYW5ub3QgbW9kaWZ5IHRoZSB7MH0gYXR0cmlidXRlIGJlY2F1c2UgaXQgaXMgaW1tdXRhYmxlLiIsImVycm9ycy5FMDAwMDA3OSI6IlRoaXMgb3BlcmF0aW9uIGlzIG5vdCBhbGxvd2VkIGluIHRoZSBjdXJyZW50IGF1dGhlbnRpY2F0aW9uIHN0YXRlLiIsImVycm9ycy5FMDAwMDA4MSI6IkNhbm5vdCBtb2RpZnkgdGhlIHswfSBhdHRyaWJ1dGUgYmVjYXVzZSBpdCBpcyBhIHJlc2VydmVkIGF0dHJpYnV0ZSBmb3IgdGhpcyBhcHBsaWNhdGlvbi4iLCJlcnJvcnMuRTAwMDAwODIiOiJFYWNoIGNvZGUgY2FuIG9ubHkgYmUgdXNlZCBvbmNlLiBQbGVhc2Ugd2FpdCBmb3IgYSBuZXcgY29kZSBhbmQgdHJ5IGFnYWluLiIsImVycm9ycy5FMDAwMDA4MyI6IlBhc3NDb2RlIGlzIHZhbGlkIGJ1dCBleGNlZWRlZCB0aW1lIHdpbmRvdy4iLCJlcnJvcnMuRTAwMDAwODQiOiJBcHAgZXZhbHVhdGlvbiBlcnJvci4iLCJlcnJvcnMuRTAwMDAwODUiOiJZb3UgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBhY2Nlc3MgeW91ciBhY2NvdW50IGF0IHRoaXMgdGltZS4iLCJlcnJvcnMuRTAwMDAwODYiOiJUaGlzIHBvbGljeSBjYW5ub3QgYmUgYWN0aXZhdGVkIGF0IHRoaXMgdGltZS4iLCJlcnJvcnMuRTAwMDAwODciOiJUaGUgcmVjb3ZlcnkgcXVlc3Rpb24gYW5zd2VyIGRpZCBub3QgbWF0Y2ggb3VyIHJlY29yZHMuIiwiZXJyb3JzLkUwMDAwMDkwIjoiVGhlIHJvbGUgc3BlY2lmaWVkIGlzIGFscmVhZHkgYXNzaWduZWQgdG8gdGhlIHVzZXIuIiwiZXJyb3JzLkUwMDAwMDkxIjoiVGhlIHByb3ZpZGVkIHJvbGUgdHlwZSB3YXMgbm90IHRoZSBzYW1lIGFzIHJlcXVpcmVkIHJvbGUgdHlwZS4iLCJlcnJvcnMuRTAwMDAwOTIiOiJBY2Nlc3MgdG8gdGhpcyBhcHBsaWNhdGlvbiByZXF1aXJlcyByZS1hdXRoZW50aWNhdGlvbjogezB9IiwiZXJyb3JzLkUwMDAwMDkzIjoiVGFyZ2V0IGNvdW50IGxpbWl0IGV4Y2VlZGVkIiwiZXJyb3JzLkUwMDAwMDk0IjoiVGhlIHByb3ZpZGVkIGZpbHRlciBpcyB1bnN1cHBvcnRlZC4iLCJlcnJvcnMuRTAwMDAwOTUiOiJSZWNvdmVyeSBub3QgYWxsb3dlZCBmb3IgdW5rbm93biB1c2VyLiIsImVycm9ycy5FMDAwMDA5NiI6IlRoaXMgY2VydGlmaWNhdGUgaGFzIGFscmVhZHkgYmVlbiB1cGxvYWRlZCB3aXRoIGtpZD17MH0uIiwiZXJyb3JzLkUwMDAwMDk3IjoiVGhlcmUgaXMgbm8gdmVyaWZpZWQgcGhvbmUgbnVtYmVyIG9uIGZpbGUuIiwiZXJyb3JzLkUwMDAwMDk4IjoiVGhpcyBwaG9uZSBudW1iZXIgaXMgaW52YWxpZC4iLCJlcnJvcnMuRTAwMDAwOTkiOiJPbmx5IG51bWJlcnMgbG9jYXRlZCBpbiBVUyBhbmQgQ2FuYWRhIGFyZSBhbGxvd2VkLiAgQ29udGFjdCB5b3VyIGFkbWluaXN0cmF0b3IgaWYgdGhpcyBpcyBhIHByb2JsZW0uIiwiZXJyb3JzLkUwMDAwMTAwIjoiVW5hYmxlIHRvIHBlcmZvcm0gc2VhcmNoIHF1ZXJ5LiIsImVycm9ycy5FMDAwMDEwMSI6IlVwbG9hZCBmYWlsZWQgYmVjYXVzZSBvZiBhIHByb2JsZW0gd2l0aCB5b3VyIGlwYSBmaWxlLCB7MH0iLCJlcnJvcnMuRTAwMDAxMDIiOiJZdWJpS2V5IGNhbm5vdCBiZSBkZWxldGVkIHdoaWxlIGFzc2lnbmVkIHRvIGFuIHVzZXIuIFBsZWFzZSBkZWFjdGl2YXRlIFl1YmlLZXkgdXNpbmcgcmVzZXQgTUZBIGFuZCB0cnkgYWdhaW4iLCJlcnJvcnMuRTAwMDAxMDMiOiJBY3Rpb24gb24gZGV2aWNlIGFscmVhZHkgaW4gcXVldWUgb3IgaW4gcHJvZ3Jlc3MiLCJlcnJvcnMuRTAwMDAxMDQiOiJEZXZpY2UgaXMgYWxyZWFkeSBsb2NrZWQgYW5kIGNhbm5vdCBiZSBsb2NrZWQgYWdhaW4iLCJlcnJvcnMuRTAwMDAxMDUiOiJZb3UgaGF2ZSBhY2Nlc3NlZCBhbiBhY2NvdW50IHJlY292ZXJ5IGxpbmsgdGhhdCBoYXMgZXhwaXJlZCBvciBiZWVuIHByZXZpb3VzbHkgdXNlZC4iLCJlcnJvcnMuRTAwMDAxMDYiOiJXYWl0IGZvciB0b2tlbiB0byBjaGFuZ2UsIHRoZW4gZW50ZXIgdGhlIG5ldyB0b2tlbmNvZGUuIiwiZXJyb3JzLkUwMDAwMTA3IjoiVGhlIGVudGl0eSBpcyBub3QgaW4gdGhlIGV4cGVjdGVkIHN0YXRlIGZvciB0aGUgcmVxdWVzdGVkIHRyYW5zaXRpb24uIiwiZXJyb3JzLkUwMDAwMTA5IjoiQW4gU01TIG1lc3NhZ2Ugd2FzIHJlY2VudGx5IHNlbnQuIFBsZWFzZSB3YWl0IDMwIHNlY29uZHMgYmVmb3JlIHRyeWluZyBhZ2Fpbi4iLCJlcnJvcnMuRTAwMDAxMTAiOiJZb3UgaGF2ZSBhY2Nlc3NlZCBhIGxpbmsgdGhhdCBoYXMgZXhwaXJlZCBvciBoYXMgYmVlbiBwcmV2aW91c2x5IHVzZWQuIiwiZXJyb3JzLkUwMDAwMTExIjoiQ2Fubm90IG1vZGlmeSB0aGUgezB9IG9iamVjdCBiZWNhdXNlIGl0IGlzIHJlYWQtb25seS4iLCJlcnJvcnMuRTAwMDAxMTIiOiJDYW5ub3QgdXBkYXRlIHRoaXMgdXNlciBiZWNhdXNlIHRoZXkgYXJlIHN0aWxsIGJlaW5nIGFjdGl2YXRlZC4gUGxlYXNlIHRyeSBhZ2FpbiBpbiBhIGZldyBtaW51dGVzLiIsImVycm9ycy5FMDAwMDExMyI6InswfS4iLCJlcnJvcnMuRTAwMDAxMTQiOiJBIHVzZXIgd2l0aCB0aGlzIGxvZ2luIGFscmVhZHkgZXhpc3RzIGluIHRoZSBjdXJyZW50IG9yZ2FuaXphdGlvbi4iLCJlcnJvcnMuRTAwMDAxMTUiOiJVcGxvYWQgZmFpbGVkLCB7MH0iLCJlcnJvcnMuRTAwMDAxMTYiOiJ7MH0iLCJvZm9ybS5uZXh0IjoiTmV4dCIsIm9mb3JtLnZlcmlmeSI6IlZlcmlmeSIsIm9mb3JtLnNlbmQiOiJTZW5kIiwib2Zvcm0uYmFjayI6IkJhY2siLCJvZm9ybS5zYXZlIjoiU2F2ZSIsIm9mb3JtLmNhbmNlbCI6IkNhbmNlbCIsIm9mb3JtLmVkaXQiOiJFZGl0Iiwib2Zvcm0ucHJldmlvdXMiOiJQcmV2aW91cyIsIm9mb3JtLmVycm9yYmFubmVyLnRpdGxlIjoiV2UgZm91bmQgc29tZSBlcnJvcnMuIFBsZWFzZSByZXZpZXcgdGhlIGZvcm0gYW5kIG1ha2UgY29ycmVjdGlvbnMuIiwib2Zvcm0uZXJyb3Jtc2cudGl0bGUiOiJQbGVhc2UgcmV2aWV3IHRoZSBmb3JtIHRvIGNvcnJlY3QgdGhlIGZvbGxvd2luZyBlcnJvcnM6Iiwib2Zvcm0uZXJyb3IudW5leHBlY3RlZCI6IlRoZXJlIHdhcyBhbiB1bmV4cGVjdGVkIGludGVybmFsIGVycm9yLiBQbGVhc2UgdHJ5IGFnYWluLiIsIm1vZGVsLnZhbGlkYXRpb24uZmllbGQuYmxhbmsiOiJUaGUgZmllbGQgY2Fubm90IGJlIGxlZnQgYmxhbmsiLCJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLmFzY2lpIjoiVGhlIGZpZWxkIGNhbm5vdCBjb250YWluIE5vbi1BU0NJSSBjaGFyYWN0ZXJzIiwibW9kZWwudmFsaWRhdGlvbi5maWVsZC53cm9uZy50eXBlIjoiVGhlIGZpZWxkIGlzIG9mIHRoZSB3cm9uZyB0eXBlIiwibW9kZWwudmFsaWRhdGlvbi5maWVsZC5pbnZhbGlkIjoiVGhlIGZpZWxkIGhhcyBhbiBpbnZhbGlkIHZhbHVlIiwibW9kZWwudmFsaWRhdGlvbi5maWVsZC52YWx1ZS5ub3QuYWxsb3dlZCI6IlRoZSBmaWVsZCB2YWx1ZSBpcyBub3QgYWxsb3dlZCIsIm1vZGVsLnZhbGlkYXRpb24uZmllbGQuYXJyYXkubWluSXRlbXMiOiJUaGUgYXJyYXkgZG9lcyBub3QgaGF2ZSBlbm91Z2ggaXRlbXMiLCJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLmFycmF5Lm1heEl0ZW1zIjoiVGhlIGFycmF5IGNvbnRhaW5zIHRvbyBtYW55IGl0ZW1zIiwibW9kZWwudmFsaWRhdGlvbi5maWVsZC5hcnJheS51bmlxdWUiOiJUaGUgYXJyYXkgY2FuIG9ubHkgaGF2ZSB1bmlxdWUgdmFsdWVzIiwibW9kZWwudmFsaWRhdGlvbi5maWVsZC50b28ubG9uZyI6IlRoZSBmaWVsZCBjYW5ub3QgZXhjZWVkIHswfSBjaGFyYWN0ZXJzIiwibW9kZWwudmFsaWRhdGlvbi5maWVsZC50b28uc21hbGwiOiJUaGUgZmllbGQgY2Fubm90IGJlIGxlc3MgdGhhbiB7MH0gY2hhcmFjdGVycyIsIm1vZGVsLnZhbGlkYXRpb24uZmllbGQuc3RyaW5nLm1pbkxlbmd0aCI6IlRoaXMgZmllbGQgY2Fubm90IGJlIGxlc3MgdGhhbiB0aGUgbWluaW11bSByZXF1aXJlZCBjaGFyYWN0ZXJzIiwibW9kZWwudmFsaWRhdGlvbi5maWVsZC5zdHJpbmcubWF4TGVuZ3RoIjoiVGhpcyBmaWVsZCBjYW5ub3QgZXhjZWVkIHRoZSBtYXhpbXVtIGFsbG93ZWQgY2hhcmFjdGVycyIsIm1vZGVsLnZhbGlkYXRpb24uZmllbGQuaW52YWxpZC5mb3JtYXQuZW1haWwiOiJUaGlzIHZhbHVlIGlzIG5vdCBhIHZhbGlkIGVtYWlsIGFkZHJlc3MiLCJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLmludmFsaWQuZm9ybWF0LnVyaSI6IlRoaXMgdmFsdWUgaXMgbm90IGEgdmFsaWQgVVJJIiwibW9kZWwudmFsaWRhdGlvbi5maWVsZC5pbnZhbGlkLmZvcm1hdC5pcHY0IjoiVGhpcyB2YWx1ZSBpcyBub3QgYSB2YWxpZCBJUHY0IGFkZHJlc3MiLCJtb2RlbC52YWxpZGF0aW9uLmZpZWxkLmludmFsaWQuZm9ybWF0Lmhvc3RuYW1lIjoiVGhpcyB2YWx1ZSBpcyBub3QgYSB2YWxpZCBob3N0bmFtZSIsIm1vZGVsLnZhbGlkYXRpb24uZmllbGQudXNlcm5hbWUiOiJQbGVhc2UgY2hlY2sgeW91ciB1c2VybmFtZSIsImZhY3Rvci50b3RwU29mdC5va3RhVmVyaWZ5IjoiT2t0YSBWZXJpZnkiLCJmYWN0b3IudG90cFNvZnQuZ29vZ2xlQXV0aGVudGljYXRvciI6Ikdvb2dsZSBBdXRoZW50aWNhdG9yIiwiZmFjdG9yLnRvdHBTb2Z0LmRlc2NyaXB0aW9uIjoiRW50ZXIgc2luZ2xlLXVzZSBjb2RlIGZyb20gdGhlIG1vYmlsZSBhcHAuIiwiZmFjdG9yLnRvdHBIYXJkLnJzYVNlY3VySWQiOiJSU0EgU2VjdXJJRCIsImZhY3Rvci50b3RwSGFyZC5zeW1hbnRlY1ZpcCI6IlN5bWFudGVjIFZJUCIsImZhY3Rvci50b3RwSGFyZC5kZXNjcmlwdGlvbiI6IkVudGVyIGEgc2luZ2xlLXVzZSBjb2RlIGZyb20gYSBoYXJkd2FyZSB0b2tlbi4iLCJmYWN0b3IudG90cEhhcmQueXViaWtleSI6Ill1YmlrZXkiLCJmYWN0b3IudG90cEhhcmQueXViaWtleS5kZXNjcmlwdGlvbiI6Ikluc2VydCB5b3VyIFl1YmlrZXkgYW5kIHRhcCBpdCB0byBnZXQgYSB2ZXJpZmljYXRpb24gY29kZS4iLCJmYWN0b3IudG90cEhhcmQueXViaWtleS5wbGFjZWhvbGRlciI6IkNsaWNrIGhlcmUsIHRoZW4gdGFwIHlvdXIgWXViaWtleSIsImZhY3Rvci5va3RhVmVyaWZ5UHVzaCI6Ik9rdGEgVmVyaWZ5IiwiZmFjdG9yLnB1c2guZGVzY3JpcHRpb24iOiJVc2UgYSBwdXNoIG5vdGlmaWNhdGlvbiBzZW50IHRvIHRoZSBtb2JpbGUgYXBwLiIsImZhY3Rvci5kdW8iOiJEdW8gU2VjdXJpdHkiLCJmYWN0b3IuZHVvLmRlc2NyaXB0aW9uIjoiVXNlIFB1c2ggTm90aWZpY2F0aW9uLCBTTVMsIG9yIFZvaWNlIGNhbGwgdG8gYXV0aGVudGljYXRlLiIsImZhY3Rvci5zbXMiOiJTTVMgQXV0aGVudGljYXRpb24iLCJmYWN0b3Iuc21zLmRlc2NyaXB0aW9uIjoiRW50ZXIgYSBzaW5nbGUtdXNlIGNvZGUgc2VudCB0byB5b3VyIG1vYmlsZSBwaG9uZS4iLCJmYWN0b3IuY2FsbCI6IlZvaWNlIENhbGwgQXV0aGVudGljYXRpb24iLCJmYWN0b3IuY2FsbC5kZXNjcmlwdGlvbiI6IlVzZSBhIHBob25lIHRvIGF1dGhlbnRpY2F0ZSBieSBmb2xsb3dpbmcgdm9pY2UgaW5zdHJ1Y3Rpb25zLiIsImZhY3Rvci5zZWN1cml0eVF1ZXN0aW9uIjoiU2VjdXJpdHkgUXVlc3Rpb24iLCJmYWN0b3Iuc2VjdXJpdHlRdWVzdGlvbi5kZXNjcmlwdGlvbiI6IlVzZSB0aGUgYW5zd2VyIHRvIGEgc2VjdXJpdHkgcXVlc3Rpb24gdG8gYXV0aGVudGljYXRlLiIsImZhY3Rvci53aW5kb3dzSGVsbG8iOiJXaW5kb3dzIEhlbGxvIiwiZmFjdG9yLndpbmRvd3NIZWxsby5zaWduaW4uZGVzY3JpcHRpb24iOiJTaWduIGluIHRvIE9rdGEgdXNpbmcgV2luZG93cyBIZWxsby4iLCJmYWN0b3IudTJmIjoiU2VjdXJpdHkgS2V5IChVMkYpIiwiZmFjdG9yLnUyZi5kZXNjcmlwdGlvbiI6IlVzZSBhIFVuaXZlcnNhbCAybmQgRmFjdG9yIChVMkYpIHNlY3VyaXR5IGtleSB0byBzaWduIG9uIHRvIE9rdGEuIiwiZmFjdG9yLmVtYWlsIjoiRW1haWwgQXV0aGVudGljYXRpb24iLCJtZmEuY2hhbGxlbmdlLnZlcmlmeSI6IlZlcmlmeSIsIm1mYS5jaGFsbGVuZ2UuYW5zd2VyLnBsYWNlaG9sZGVyIjoiQW5zd2VyIiwibWZhLmNoYWxsZW5nZS5hbnN3ZXIudG9vbHRpcCI6IkFuc3dlciIsIm1mYS5jaGFsbGVuZ2UuYW5zd2VyLnNob3dBbnN3ZXIiOiJTaG93IiwibWZhLmNoYWxsZW5nZS5hbnN3ZXIuaGlkZUFuc3dlciI6IkhpZGUiLCJtZmEuY2hhbGxlbmdlLmVudGVyQ29kZS5wbGFjZWhvbGRlciI6IkVudGVyIENvZGUiLCJtZmEuY2hhbGxlbmdlLmVudGVyQ29kZS50b29sdGlwIjoiRW50ZXIgQ29kZSIsIm1mYS5iYWNrVG9GYWN0b3JzIjoiQmFjayB0byBmYWN0b3IgbGlzdCIsIm1mYS5waG9uZU51bWJlci5wbGFjZWhvbGRlciI6IlBob25lIG51bWJlciIsIm1mYS5waG9uZU51bWJlci5leHQucGxhY2Vob2xkZXIiOiJFeHRlbnNpb24iLCJtZmEuc2VuZENvZGUiOiJTZW5kIGNvZGUiLCJtZmEuc2VudCI6IlNlbnQiLCJtZmEucmVzZW5kQ29kZSI6IlJlLXNlbmQgY29kZSIsIm1mYS5jYWxsIjoiQ2FsbCIsIm1mYS5jYWxsaW5nIjoiQ2FsbGluZyIsIm1mYS5yZWRpYWwiOiJSZWRpYWwiLCJtZmEuc2VuZEVtYWlsIjoiU2VuZCBlbWFpbCIsIm1mYS5yZXNlbmRFbWFpbCI6IlJlLXNlbmQgZW1haWwiLCJtZmEuc2NhbkJhcmNvZGUiOiJTY2FuIGJhcmNvZGUiLCJtZmEubm9BY2Nlc3NUb0VtYWlsIjoiQ2FuJ3QgYWNjZXNzIGVtYWlsIiwicGFzc3dvcmQucmVzZXQiOiJSZXNldCBQYXNzd29yZCIsInBhc3N3b3JkLm9sZFBhc3N3b3JkLnBsYWNlaG9sZGVyIjoiT2xkIHBhc3N3b3JkIiwicGFzc3dvcmQub2xkUGFzc3dvcmQudG9vbHRpcCI6Ik9sZCBwYXNzd29yZCIsInBhc3N3b3JkLm5ld1Bhc3N3b3JkLnBsYWNlaG9sZGVyIjoiTmV3IHBhc3N3b3JkIiwicGFzc3dvcmQubmV3UGFzc3dvcmQudG9vbHRpcCI6Ik5ldyBwYXNzd29yZCIsInBhc3N3b3JkLmNvbmZpcm1QYXNzd29yZC5wbGFjZWhvbGRlciI6IlJlcGVhdCBwYXNzd29yZCIsInBhc3N3b3JkLmNvbmZpcm1QYXNzd29yZC50b29sdGlwIjoiUmVwZWF0IHBhc3N3b3JkIiwicGFzc3dvcmQuZXJyb3IubWF0Y2giOiJOZXcgcGFzc3dvcmRzIG11c3QgbWF0Y2giLCJyZWNvdmVyeS5zbXMuaGludCI6IlNNUyBjYW4gb25seSBiZSB1c2VkIGlmIGEgbW9iaWxlIHBob25lIG51bWJlciBoYXMgYmVlbiBjb25maWd1cmVkLiIsInJlY292ZXJ5Lm1vYmlsZS5oaW50IjoiezB9IGNhbiBvbmx5IGJlIHVzZWQgaWYgYSBtb2JpbGUgcGhvbmUgbnVtYmVyIGhhcyBiZWVuIGNvbmZpZ3VyZWQuIiwicmVjb3Zlcnkuc21zIjoiU01TIiwicmVjb3ZlcnkuY2FsbCI6IlZvaWNlIENhbGwiLCJyZWNvdmVyeS5zbXNPckNhbGwiOiJTTVMgb3IgVm9pY2UgQ2FsbCIsImVucm9sbC5jaG9pY2VzLnRpdGxlIjoiU2V0IHVwIG11bHRpZmFjdG9yIGF1dGhlbnRpY2F0aW9uIiwiZW5yb2xsLmNob2ljZXMuZGVzY3JpcHRpb24iOiJZb3VyIGNvbXBhbnkgcmVxdWlyZXMgbXVsdGlmYWN0b3IgYXV0aGVudGljYXRpb24gdG8gYWRkIGFuIGFkZGl0aW9uYWwgbGF5ZXIgb2Ygc2VjdXJpdHkgd2hlbiBzaWduaW5nIGludG8geW91ciBPa3RhIGFjY291bnQiLCJlbnJvbGwuY2hvaWNlcy5vcHRpb25hbCI6IllvdSBjYW4gY29uZmlndXJlIGFueSBhZGRpdGlvbmFsIG9wdGlvbmFsIGZhY3RvciBvciBjbGljayBmaW5pc2giLCJlbnJvbGwuY2hvaWNlcy5saXN0LnNldHVwIjoiU2V0dXAgcmVxdWlyZWQiLCJlbnJvbGwuY2hvaWNlcy5saXN0LmVucm9sbGVkIjoiRW5yb2xsZWQgZmFjdG9ycyIsImVucm9sbC5jaG9pY2VzLmxpc3Qub3B0aW9uYWwiOiJBZGRpdGlvbmFsIG9wdGlvbmFsIGZhY3RvcnMiLCJlbnJvbGwuY2hvaWNlcy5zdGVwIjoiezB9IG9mIHsxfSIsImVucm9sbC5jaG9pY2VzLnNldHVwIjoiU2V0dXAiLCJlbnJvbGwuY2hvaWNlcy5zdWJtaXQuZmluaXNoIjoiRmluaXNoIiwiZW5yb2xsLmNob2ljZXMuc3VibWl0LmNvbmZpZ3VyZSI6IkNvbmZpZ3VyZSBmYWN0b3IiLCJlbnJvbGwuY2hvaWNlcy5zdWJtaXQubmV4dCI6IkNvbmZpZ3VyZSBuZXh0IGZhY3RvciIsImVucm9sbC5zZWN1cml0eVF1ZXN0aW9uLnNldHVwIjoiU2V0dXAgc2VjcmV0IHF1ZXN0aW9uIGF1dGhlbnRpY2F0aW9uIiwic2VjdXJpdHkuZGlzbGlrZWRfZm9vZCI6IldoYXQgaXMgdGhlIGZvb2QgeW91IGxlYXN0IGxpa2VkIGFzIGEgY2hpbGQ/Iiwic2VjdXJpdHkubmFtZV9vZl9maXJzdF9wbHVzaF90b3kiOiJXaGF0IGlzIHRoZSBuYW1lIG9mIHlvdXIgZmlyc3Qgc3R1ZmZlZCBhbmltYWw/Iiwic2VjdXJpdHkuZmlyc3RfYXdhcmQiOiJXaGF0IGRpZCB5b3UgZWFybiB5b3VyIGZpcnN0IG1lZGFsIG9yIGF3YXJkIGZvcj8iLCJzZWN1cml0eS5mYXZvcml0ZV9zZWN1cml0eV9xdWVzdGlvbiI6IldoYXQgaXMgeW91ciBmYXZvcml0ZSBzZWN1cml0eSBxdWVzdGlvbj8iLCJzZWN1cml0eS5mYXZvcml0ZV90b3kiOiJXaGF0IGlzIHRoZSB0b3kvc3R1ZmZlZCBhbmltYWwgeW91IGxpa2VkIHRoZSBtb3N0IGFzIGEga2lkPyIsInNlY3VyaXR5LmZpcnN0X2NvbXB1dGVyX2dhbWUiOiJXaGF0IHdhcyB0aGUgZmlyc3QgY29tcHV0ZXIgZ2FtZSB5b3UgcGxheWVkPyIsInNlY3VyaXR5LmZhdm9yaXRlX21vdmllX3F1b3RlIjoiV2hhdCBpcyB5b3VyIGZhdm9yaXRlIG1vdmllIHF1b3RlPyIsInNlY3VyaXR5LmZpcnN0X3Nwb3J0c190ZWFtX21hc2NvdCI6IldoYXQgd2FzIHRoZSBtYXNjb3Qgb2YgdGhlIGZpcnN0IHNwb3J0cyB0ZWFtIHlvdSBwbGF5ZWQgb24/Iiwic2VjdXJpdHkuZmlyc3RfbXVzaWNfcHVyY2hhc2UiOiJXaGF0IG11c2ljIGFsYnVtIG9yIHNvbmcgZGlkIHlvdSBmaXJzdCBwdXJjaGFzZT8iLCJzZWN1cml0eS5mYXZvcml0ZV9hcnRfcGllY2UiOiJXaGF0IGlzIHlvdXIgZmF2b3JpdGUgcGllY2Ugb2YgYXJ0PyIsInNlY3VyaXR5LmdyYW5kbW90aGVyX2Zhdm9yaXRlX2Rlc2VydCI6IldoYXQgd2FzIHlvdXIgZ3JhbmRtb3RoZXIncyBmYXZvcml0ZSBkZXNzZXJ0PyIsInNlY3VyaXR5LmZpcnN0X3RoaW5nX2Nvb2tlZCI6IldoYXQgd2FzIHRoZSBmaXJzdCB0aGluZyB5b3UgbGVhcm5lZCB0byBjb29rPyIsInNlY3VyaXR5LmNoaWxkaG9vZF9kcmVhbV9qb2IiOiJXaGF0IHdhcyB5b3VyIGRyZWFtIGpvYiBhcyBhIGNoaWxkPyIsInNlY3VyaXR5LmZpcnN0X2tpc3NfbG9jYXRpb24iOiJXaGVyZSBkaWQgeW91IGhhdmUgeW91ciBmaXJzdCBraXNzPyIsInNlY3VyaXR5LnBsYWNlX3doZXJlX3NpZ25pZmljYW50X290aGVyX3dhc19tZXQiOiJXaGVyZSBkaWQgeW91IG1lZXQgeW91ciBzcG91c2Uvc2lnbmlmaWNhbnQgb3RoZXI/Iiwic2VjdXJpdHkuZmF2b3JpdGVfdmFjYXRpb25fbG9jYXRpb24iOiJXaGVyZSBkaWQgeW91IGdvIGZvciB5b3VyIGZhdm9yaXRlIHZhY2F0aW9uPyIsInNlY3VyaXR5Lm5ld195ZWFyc190d29fdGhvdXNhbmQiOiJXaGVyZSB3ZXJlIHlvdSBvbiBOZXcgWWVhcidzIEV2ZSBpbiB0aGUgeWVhciAyMDAwPyIsInNlY3VyaXR5LmZhdm9yaXRlX3NwZWFrZXJfYWN0b3IiOiJXaG8gaXMgeW91ciBmYXZvcml0ZSBzcGVha2VyL29yYXRvcj8iLCJzZWN1cml0eS5mYXZvcml0ZV9ib29rX21vdmllX2NoYXJhY3RlciI6IldobyBpcyB5b3VyIGZhdm9yaXRlIGJvb2svbW92aWUgY2hhcmFjdGVyPyIsInNlY3VyaXR5LmZhdm9yaXRlX3Nwb3J0c19wbGF5ZXIiOiJXaG8gaXMgeW91ciBmYXZvcml0ZSBzcG9ydHMgcGxheWVyPyIsImVucm9sbC5zbXMuc2V0dXAiOiJSZWNlaXZlIGEgY29kZSB2aWEgU01TIHRvIGF1dGhlbnRpY2F0ZSIsImVucm9sbC5zbXMudHJ5X2FnYWluIjoiVGhlIG51bWJlciB5b3UgZW50ZXJlZCBzZWVtcyBpbnZhbGlkLiBJZiB0aGUgbnVtYmVyIGlzIGNvcnJlY3QsIHBsZWFzZSB0cnkgYWdhaW4uIiwiZW5yb2xsLmNhbGwuc2V0dXAiOiJGb2xsb3cgcGhvbmUgY2FsbCBpbnN0cnVjdGlvbnMgdG8gYXV0aGVudGljYXRlIiwiZW5yb2xsLm9ucHJlbS51c2VybmFtZS5wbGFjZWhvbGRlciI6IkVudGVyIHswfSB1c2VybmFtZSIsImVucm9sbC5vbnByZW0udXNlcm5hbWUudG9vbHRpcCI6IkVudGVyIHswfSB1c2VybmFtZSIsImVucm9sbC5vbnByZW0ucGFzc2NvZGUucGxhY2Vob2xkZXIiOiJFbnRlciB7MH0gcGFzc2NvZGUiLCJlbnJvbGwub25wcmVtLnBhc3Njb2RlLnRvb2x0aXAiOiJFbnRlciB7MH0gcGFzc2NvZGUiLCJlbnJvbGwuc3ltYW50ZWNWaXAuc3VidGl0bGUiOiJFbnRlciBDcmVkZW50aWFsIElEIGFuZCB0d28gY29uc2VjdXRpdmUgZ2VuZXJhdGVkIGNvZGVzIiwiZW5yb2xsLnN5bWFudGVjVmlwLmNyZWRlbnRpYWxJZC5wbGFjZWhvbGRlciI6IkVudGVyIGNyZWRlbnRpYWwgSUQiLCJlbnJvbGwuc3ltYW50ZWNWaXAuY3JlZGVudGlhbElkLnRvb2x0aXAiOiJFbnRlciBjcmVkZW50aWFsIElEIiwiZW5yb2xsLnN5bWFudGVjVmlwLnBhc3Njb2RlMS5wbGFjZWhvbGRlciI6IlNlY3VyaXR5IGNvZGUgMSIsImVucm9sbC5zeW1hbnRlY1ZpcC5wYXNzY29kZTEudG9vbHRpcCI6IlNlY3VyaXR5IGNvZGUgMSIsImVucm9sbC5zeW1hbnRlY1ZpcC5wYXNzY29kZTIucGxhY2Vob2xkZXIiOiJTZWN1cml0eSBjb2RlIDIiLCJlbnJvbGwuc3ltYW50ZWNWaXAucGFzc2NvZGUyLnRvb2x0aXAiOiJTZWN1cml0eSBjb2RlIDIiLCJlbnJvbGwueXViaWtleS50aXRsZSI6IlNldHVwIFl1YmlrZXkiLCJlbnJvbGwueXViaWtleS5zdWJ0aXRsZSI6Ikluc2VydCB5b3VyIFl1YmlrZXkgaW50byBhIFVTQiBwb3J0IGFuZCB0YXAgaXQgdG8gZ2VuZXJhdGUgYSB2ZXJpZmljYXRpb24gY29kZSIsImVucm9sbC50b3RwLnRpdGxlIjoiU2V0dXAgezB9IiwiZW5yb2xsLnRvdHAuc2VsZWN0RGV2aWNlIjoiU2VsZWN0IHlvdXIgZGV2aWNlIHR5cGUiLCJlbnJvbGwudG90cC5kb3dubG9hZEFwcCI6J0Rvd25sb2FkIDxhIGhyZWY9InswfSIgY2xhc3M9ImlubGluZS1saW5rIj57MX0gZnJvbSB0aGUgezJ9PC9hPiBvbnRvIHlvdXIgbW9iaWxlIGRldmljZS4nLCJlbnJvbGwudG90cC5pbnN0YWxsQXBwIjoiSW5zdGFsbCB7MH0iLCJlbnJvbGwuZHVvLnRpdGxlIjoiU2V0dXAgRHVvIFNlY3VyaXR5IiwiZW5yb2xsLndpbmRvd3NIZWxsby50aXRsZSI6IkVucm9sbCBXaW5kb3dzIEhlbGxvIiwKCSJlbnJvbGwud2luZG93c0hlbGxvLnN1YnRpdGxlIjoiQ2xpY2sgYmVsb3cgdG8gZW5yb2xsIFdpbmRvd3MgSGVsbG8gYXMgYSBzZWNvbmQgZm9ybSBvZiBhdXRoZW50aWNhdGlvbiIsImVucm9sbC53aW5kb3dzSGVsbG8uc3VidGl0bGUubG9hZGluZyI6IlBsZWFzZSB3YWl0IHdoaWxlIFdpbmRvd3MgSGVsbG8gaXMgbG9hZGluZy4uLiIsImVucm9sbC53aW5kb3dzSGVsbG8uc2F2ZSI6IkVucm9sbCBXaW5kb3dzIEhlbGxvIiwiZW5yb2xsLndpbmRvd3NIZWxsby5lcnJvci5ub3RXaW5kb3dzIjoiV2luZG93cyBIZWxsbyBjYW4gb25seSBiZSB1c2VkIG9uIFdpbmRvd3MgRWRnZSB3aXRoIFdpbmRvd3MgMTAuIENvbnRhY3QgeW91ciBhZG1pbiBmb3IgYXNzaXN0YW5jZS4iLCJlbnJvbGwud2luZG93c0hlbGxvLmVycm9yLm5vdENvbmZpZ3VyZWRIdG1sIjoiV2luZG93cyBIZWxsbyBpcyBub3QgY29uZmlndXJlZC4gU2VsZWN0IHRoZSA8Yj5TdGFydDwvYj4gYnV0dG9uLCB0aGVuIHNlbGVjdCA8Yj5TZXR0aW5nczwvYj4gJmd0OyA8Yj5BY2NvdW50czwvYj4gJmd0OyA8Yj5TaWduLWluPC9iPiB0byBjb25maWd1cmUgV2luZG93cyBIZWxsby4iLCJ2ZXJpZnkud2luZG93c0hlbGxvLnN1YnRpdGxlIjoiVmVyaWZ5IHlvdXIgaWRlbnRpdHkgd2l0aCBXaW5kb3dzIEhlbGxvIiwidmVyaWZ5LndpbmRvd3NIZWxsby5zdWJ0aXRsZS5sb2FkaW5nIjoiUGxlYXNlIHdhaXQgd2hpbGUgV2luZG93cyBIZWxsbyBpcyBsb2FkaW5nLi4uIiwidmVyaWZ5LndpbmRvd3NIZWxsby5zdWJ0aXRsZS5zaWduaW5nSW4iOiJTaWduaW5nIGludG8gT2t0YS4uLiIsInZlcmlmeS53aW5kb3dzSGVsbG8uc2F2ZSI6IlZlcmlmeSB3aXRoIFdpbmRvd3MgSGVsbG8iLCJ2ZXJpZnkud2luZG93c0hlbGxvLmVycm9yLm5vdEZvdW5kIjoiWW91ciBXaW5kb3dzIEhlbGxvIGVucm9sbG1lbnQgZG9lcyBub3QgbWF0Y2ggb3VyIHJlY29yZHMuIENvbnRhY3QgeW91ciBhZG1pbmlzdHJhdG9yIGZvciBhc3Npc3RhbmNlLiIsInZlcmlmeS53aW5kb3dzSGVsbG8uZXJyb3Iubm90Rm91bmQuc2VsZWN0QW5vdGhlciI6IllvdXIgV2luZG93cyBIZWxsbyBlbnJvbGxtZW50IGRvZXMgbm90IG1hdGNoIG91ciByZWNvcmRzLiBTZWxlY3QgYW5vdGhlciBmYWN0b3Igb3IgY29udGFjdCB5b3VyIGFkbWluaXN0cmF0b3IgZm9yIGFzc2lzdGFuY2UuIiwiZW5yb2xsLnUyZi50aXRsZSI6IlNldHVwIFNlY3VyaXR5IEtleSAoVTJGKSIsImVucm9sbC51MmYuc2F2ZSI6IlJlZ2lzdGVyIFNlY3VyaXR5IEtleSIsImVucm9sbC51MmYuZ2VuZXJhbDEiOiJJZiB1c2luZyBGaXJlZm94IGRvd25sb2FkIGFuZCBpbnN0YWxsIHRoZSBVMkYgYnJvd3NlciBleHRlbnNpb24uIiwiZW5yb2xsLnUyZi5nZW5lcmFsMiI6Ik1ha2Ugc3VyZSB5b3UgaGF2ZSBhIFNlY3VyaXR5IEtleS4gSWYgYWxyZWFkeSBpbnNlcnRlZCwgcmVtb3ZlIGl0IG5vdy48YnI+SWYgeW91IGhhdmUgYSBCbHVldG9vdGggU2VjdXJpdHkgS2V5LCB0dXJuIG9uIHlvdXIgY29tcHV0ZXIncyBCbHVldG9vdGguIiwiZW5yb2xsLnUyZi5nZW5lcmFsMyI6IkNsaWNrIHRoZSBidXR0b24gYmVsb3cgdG8gcmVnaXN0ZXIiLCJlbnJvbGwudTJmLmluc3RydWN0aW9ucyI6Ikluc2VydCB5b3VyIFNlY3VyaXR5IEtleSBpbnRvIGEgVVNCIHBvcnQgb24gdGhpcyBjb21wdXRlci4gSWYgaXQgaGFzIGEgYnV0dG9uIG9yIGdvbGQgZGlzaywgdGFwIGl0LiIsImVucm9sbC51MmYuaW5zdHJ1Y3Rpb25zQmx1ZXRvb3RoIjoiSWYgeW91IGFyZSB1c2luZyBhIEJsdWV0b290aCBTZWN1cml0eSBLZXksIHByZXNzIHRoZSBidXR0b24uIiwidTJmLmVycm9yLm5vdFN1cHBvcnRlZEJyb3dzZXIiOiJUaGUgU2VjdXJpdHkgS2V5IGlzIG9ubHkgc3VwcG9ydGVkIGZvciBDaHJvbWUgb3IgRmlyZWZveCBicm93c2Vycy4gU2VsZWN0IGFub3RoZXIgZmFjdG9yIG9yIGNvbnRhY3QgeW91ciBhZG1pbiBmb3IgYXNzaXN0YW5jZS4iLCJ1MmYuZXJyb3Iubm90U3VwcG9ydGVkQnJvd3Nlci5vbmVGYWN0b3IiOiJUaGUgU2VjdXJpdHkgS2V5IGlzIG9ubHkgc3VwcG9ydGVkIGZvciBDaHJvbWUgb3IgRmlyZWZveCBicm93c2Vycy4gQ29udGFjdCB5b3VyIGFkbWluIGZvciBhc3Npc3RhbmNlLiIsInUyZi5lcnJvci5ub0ZpcmVmb3hFeHRlbnNpb24iOic8YSB0YXJnZXQ9Il9ibGFuayIgaHJlZj0iaHR0cHM6Ly9hZGRvbnMubW96aWxsYS5vcmcvZW4tVVMvZmlyZWZveC9hZGRvbi91MmYtc3VwcG9ydC1hZGQtb24vIj5Eb3dubG9hZDwvYT4gYW5kIGluc3RhbGwgdGhlIEZpcmVmb3ggVTJGIGJyb3dzZXIgZXh0ZW5zaW9uIGJlZm9yZSBwcm9jZWVkaW5nLiBZb3UgbWF5IGJlIHJlcXVpcmVkIHRvIHJlc3RhcnQgeW91ciBicm93c2VyIGFmdGVyIGluc3RhbGxhdGlvbi4nLCJ1MmYuZXJyb3Iub3RoZXIiOiJBbiB1bmtub3duIGVycm9yIGhhcyBvY2N1cmVkLiBUcnkgYWdhaW4gb3Igc2VsZWN0IGFub3RoZXIgZmFjdG9yLiIsInUyZi5lcnJvci5vdGhlci5vbmVGYWN0b3IiOiJBbiB1bmtub3duIGVycm9yIGhhcyBvY2N1cmVkLiBUcnkgYWdhaW4gb3IgY29udGFjdCB5b3VyIGFkbWluIGZvciBhc3Npc3RhbmNlLiIsInUyZi5lcnJvci5iYWRSZXF1ZXN0IjoiVGhlcmUgd2FzIGFuIGVycm9yIHdpdGggdGhlIFUyRiByZXF1ZXN0LiBUcnkgYWdhaW4gb3Igc2VsZWN0IGFub3RoZXIgZmFjdG9yLiIsInUyZi5lcnJvci5iYWRSZXF1ZXN0Lm9uZUZhY3RvciI6IlRoZXJlIHdhcyBhbiBlcnJvciB3aXRoIHRoZSBVMkYgcmVxdWVzdC4gVHJ5IGFnYWluIG9yIGNvbnRhY3QgeW91ciBhZG1pbiBmb3IgYXNzaXN0YW5jZS4iLCJ1MmYuZXJyb3IudW5zdXBwb3J0ZWQiOiJUaGUgc2VjdXJpdHkga2V5IGlzIHVuc3VwcG9ydGVkLiBTZWxlY3QgYW5vdGhlciBmYWN0b3IuIiwidTJmLmVycm9yLnVuc3VwcG9ydGVkLm9uZUZhY3RvciI6IlRoZSBzZWN1cml0eSBrZXkgaXMgdW5zdXBwb3J0ZWQuIENvbnRhY3QgeW91ciBhZG1pbiBmb3IgYXNzaXN0YW5jZS4iLCJ1MmYuZXJyb3IudGltZW91dCI6IllvdSBoYXZlIHRpbWVkIG91dCBvZiB0aGUgYXV0aGVudGljYXRpb24gcGVyaW9kLiBQbGVhc2UgdHJ5IGFnYWluLiIsInZlcmlmeS51MmYuaW5zdHJ1Y3Rpb25zIjoiSW5zZXJ0IHlvdXIgU2VjdXJpdHkgS2V5LiBJZiBpdCBoYXMgYSBidXR0b24gb3IgZ29sZCBkaXNrLCB0YXDCoGl0LiIsInZlcmlmeS51MmYuaW5zdHJ1Y3Rpb25zQmx1ZXRvb3RoIjoiSWYgeW91IGFyZSB1c2luZyBhIEJsdWV0b290aCBTZWN1cml0eSBLZXksIHR1cm4gb24geW91ciBjb21wdXRlcidzIEJsdWV0b290aCBhbmQgcHJlc3MgdGhlIGJ1dHRvbi4iLCJ2ZXJpZnkudTJmLnJldHJ5IjoiUmV0cnkiLCJlbnJvbGwudG90cC5lbnRlckNvZGUiOiJFbnRlciBjb2RlIGRpc3BsYXllZCBmcm9tIHRoZSBhcHBsaWNhdGlvbiIsImVucm9sbC50b3RwLnNldHVwQXBwIjoiTGF1bmNoIHswfSBhcHBsaWNhdGlvbiBvbiB5b3VyIG1vYmlsZSBkZXZpY2UgYW5kIHNlbGVjdCBBZGQgYW4gYWNjb3VudC4iLCJlbnJvbGwudG90cC5zZXR1cEdvb2dsZUF1dGhBcHAiOidMYXVuY2ggezB9LCB0YXAgdGhlICIrIiBpY29uLCB0aGVuIHNlbGVjdCAiU2NhbiBiYXJjb2RlIi4nLCJlbnJvbGwudG90cC5jYW5ub3RTY2FuIjoiQ2FuJ3Qgc2Nhbj8iLCJlbnJvbGwudG90cC5yZWZyZXNoQmFyY29kZSI6IlJlZnJlc2ggY29kZSIsImVucm9sbC50b3RwLmNhbm5vdFNjYW5CYXJjb2RlIjoiQ2FuJ3Qgc2NhbiBiYXJjb2RlPyIsImVucm9sbC50b3RwLm1hbnVhbFNldHVwSW5zdHJ1Y3Rpb25zIjoiVG8gc2V0IHVwIG1hbnVhbGx5IGVudGVyIHlvdXIgT2t0YSBBY2NvdW50IHVzZXJuYW1lIGFuZCB0aGVuIGlucHV0IHRoZSBmb2xsb3dpbmcgaW4gdGhlIFNlY3JldCBLZXkgRmllbGQiLCJlbnJvbGwudG90cC5zaGFyZWRTZWNyZXRJbnN0cnVjdGlvbnMiOiJFbnRlciB5b3VyIE9rdGEgQWNjb3VudCB1c2VybmFtZSBhbmQgZW50ZXIgdGhlIGZvbGxvd2luZyBpbiB0aGUgU2VjcmV0IEtleSBGaWVsZCIsImVucm9sbC50b3RwLnNlbmRTbXMiOiJTZW5kIGFjdGl2YXRpb24gbGluayB2aWEgU01TIiwiZW5yb2xsLnRvdHAuc2VuZEVtYWlsIjoiU2VuZCBhY3RpdmF0aW9uIGxpbmsgdmlhIGVtYWlsIiwiZW5yb2xsLnRvdHAuc2V0dXBNYW51YWxseSI6IlNldHVwIG1hbnVhbGx5IHdpdGhvdXQgcHVzaCBub3RpZmljYXRpb24iLCJlbnJvbGwudG90cC5lbnJvbGxWaWFFbWFpbC50aXRsZSI6IkFjdGl2YXRpb24gZW1haWwgc2VudCEiLCJlbnJvbGwudG90cC5lbnJvbGxWaWFFbWFpbC5tc2ciOiJPcGVuIHRoZSBlbWFpbCBmcm9tIHlvdXIgbW9iaWxlIGRldmljZS4iLCJlbnJvbGwudG90cC5lbnJvbGxWaWFTbXMudGl0bGUiOiJTTVMgc2VudCEiLCJlbnJvbGwudG90cC5lbnJvbGxWaWFTbXMubXNnIjoiVmlldyB0aGUgU01TIG9uIHlvdXIgbW9iaWxlIGRldmljZS4iLCJyZWNvdmVyeUNoYWxsZW5nZS5zbXMudGl0bGUiOiJFbnRlciB2ZXJpZmljYXRpb24gY29kZSBzZW50IHZpYSBTTVMiLCJyZWNvdmVyeUNoYWxsZW5nZS5jYWxsLnRpdGxlIjoiRW50ZXIgdmVyaWZpY2F0aW9uIGNvZGUgcmVjZWl2ZWQgdmlhIFZvaWNlIENhbGwiLCJtZmEuZg==", "base64"));
  res.write(new Buffer("YWN0b3JzLmRyb3Bkb3duLnRpdGxlIjoiU2VsZWN0IGFuIGF1dGhlbnRpY2F0aW9uIGZhY3RvciIsIm1mYS5kdW9TZWN1cml0eS5wdXNoIjoiUHVzaCDigJQgezB9IiwibWZhLmR1b1NlY3VyaXR5LnNtcyI6IlNNUyDigJQgezB9IiwibWZhLmR1b1NlY3VyaXR5LmNhbGwiOiJDYWxsIOKAlCB7MH0iLCJtZmEuY2hhbGxlbmdlLnRpdGxlIjoiRW50ZXIgeW91ciB7MH0gcGFzc2NvZGUiLCJtZmEuY2hhbGxlbmdlLm9yRW50ZXJDb2RlIjoiT3IgZW50ZXIgY29kZSIsIm9rdGF2ZXJpZnkuc2VuZCI6IlNlbmQgUHVzaCIsIm9rdGF2ZXJpZnkucmVzZW5kIjoiUmUtc2VuZCBQdXNoIiwib2t0YXZlcmlmeS5zZW50IjoiUHVzaCBzZW50ISIsIm9rdGF2ZXJpZnkucmVqZWN0ZWQiOiJZb3UgaGF2ZSBjaG9zZW4gdG8gcmVqZWN0IHRoaXMgbG9naW4uIiwib2t0YXZlcmlmeS50aW1lb3V0IjoiWW91ciBwdXNoIG5vdGlmaWNhdGlvbiBoYXMgZXhwaXJlZC4iLCJva3RhdmVyaWZ5Lndhcm5pbmciOiJIYXZlbid0IHJlY2VpdmVkIGEgcHVzaCBub3RpZmljYXRpb24geWV0PyBUcnkgb3BlbmluZyB0aGUgT2t0YSBWZXJpZnkgQXBwIG9uIHlvdXIgcGhvbmUuIiwicHJpbWFyeWF1dGgudGl0bGUiOiJTaWduIEluIiwicHJpbWFyeWF1dGgudXNlcm5hbWUucGxhY2Vob2xkZXIiOiJVc2VybmFtZSIsInByaW1hcnlhdXRoLnVzZXJuYW1lLnRvb2x0aXAiOiJVc2VybmFtZSIsInByaW1hcnlhdXRoLnBhc3N3b3JkLnBsYWNlaG9sZGVyIjoiUGFzc3dvcmQiLCJwcmltYXJ5YXV0aC5wYXNzd29yZC50b29sdGlwIjoiUGFzc3dvcmQiLCJwcmltYXJ5YXV0aC5zdWJtaXQiOiJTaWduIEluIiwicHJpbWFyeWF1dGgubmV3VXNlci50b29sdGlwIjoiVGhpcyBpcyB0aGUgZmlyc3QgdGltZSB5b3UgYXJlIGNvbm5lY3RpbmcgdG8gezB9IGZyb20gdGhpcyBicm93c2VyIiwicHJpbWFyeWF1dGgubmV3VXNlci50b29sdGlwLmNsb3NlIjoiQ2xvc2UiLCJwYXNzd29yZC5mb3Jnb3QuZW1haWwub3IudXNlcm5hbWUucGxhY2Vob2xkZXIiOiJFbWFpbCBvciBVc2VybmFtZSIsInBhc3N3b3JkLmZvcmdvdC5lbWFpbC5vci51c2VybmFtZS50b29sdGlwIjoiRW1haWwgb3IgVXNlcm5hbWUiLCJwYXNzd29yZC5mb3Jnb3Quc2VuZFRleHQiOiJSZXNldCB2aWEgU01TIiwicGFzc3dvcmQuZm9yZ290LnNlbmRFbWFpbCI6IlJlc2V0IHZpYSBFbWFpbCIsInBhc3N3b3JkLmZvcmdvdC5jYWxsIjoiUmVzZXQgdmlhIFZvaWNlIENhbGwiLCJwYXNzd29yZC5mb3Jnb3QuZW1haWxTZW50LnRpdGxlIjoiRW1haWwgc2VudCEiLCJwYXNzd29yZC5mb3Jnb3QuZW1haWxTZW50LmRlc2MiOiJFbWFpbCBoYXMgYmVlbiBzZW50IHRvIHswfSB3aXRoIGluc3RydWN0aW9ucyBvbiByZXNldHRpbmcgeW91ciBwYXNzd29yZC4iLCJwYXNzd29yZC5mb3Jnb3QucXVlc3Rpb24udGl0bGUiOiJBbnN3ZXIgRm9yZ290dGVuIFBhc3N3b3JkIENoYWxsZW5nZSIsInBhc3N3b3JkLmZvcmdvdC5xdWVzdGlvbi5zdWJtaXQiOiJSZXNldCBQYXNzd29yZCIsInBhc3N3b3JkLmZvcmdvdC5zbXMubm90UmVjZWl2ZWQiOiJEaWRuJ3QgcmVjZWl2ZSBhbiBTTVM/IFJlc2V0IHZpYSBlbWFpbCIsInBhc3N3b3JkLmZvcmdvdC5jb2RlLm5vdFJlY2VpdmVkIjoiRGlkbid0IHJlY2VpdmUgYSBjb2RlPyBSZXNldCB2aWEgZW1haWwiLCJwYXNzd29yZC5yZXNldC50aXRsZSI6IlJlc2V0IHlvdXIgT2t0YSBwYXNzd29yZCIsInBhc3N3b3JkLmNvbXBsZXhpdHkuZGVzY3JpcHRpb24iOiJZb3VyIHBhc3N3b3JkIG11c3QgaGF2ZSB7MH0uIiwicGFzc3dvcmQuY29tcGxleGl0eS5oaXN0b3J5IjoiWW91ciBwYXNzd29yZCBjYW5ub3QgYmUgYW55IG9mIHlvdXIgbGFzdCB7MH0gcGFzc3dvcmRzLiIsInBhc3N3b3JkLmNvbXBsZXhpdHkubWluQWdlTWludXRlcyI6IkF0IGxlYXN0IHswfSBtaW51dGUocykgbXVzdCBoYXZlIGVsYXBzZWQgc2luY2UgeW91IGxhc3QgY2hhbmdlZCB5b3VyIHBhc3N3b3JkLiIsInBhc3N3b3JkLmNvbXBsZXhpdHkubWluQWdlSG91cnMiOiJBdCBsZWFzdCB7MH0gaG91cihzKSBtdXN0IGhhdmUgZWxhcHNlZCBzaW5jZSB5b3UgbGFzdCBjaGFuZ2VkIHlvdXIgcGFzc3dvcmQuIiwicGFzc3dvcmQuY29tcGxleGl0eS5taW5BZ2VEYXlzIjoiQXQgbGVhc3QgezB9IGRheShzKSBtdXN0IGhhdmUgZWxhcHNlZCBzaW5jZSB5b3UgbGFzdCBjaGFuZ2VkIHlvdXIgcGFzc3dvcmQuIiwicGFzc3dvcmQuY29tcGxleGl0eS5sZW5ndGgiOiJhdCBsZWFzdCB7MH0gY2hhcmFjdGVycyIsInBhc3N3b3JkLmNvbXBsZXhpdHkubGlzdC5lbGVtZW50IjoiLCB7MH0iLCJwYXNzd29yZC5jb21wbGV4aXR5Lmxvd2VyY2FzZSI6ImEgbG93ZXJjYXNlIGxldHRlciIsInBhc3N3b3JkLmNvbXBsZXhpdHkudXBwZXJjYXNlIjoiYW4gdXBwZXJjYXNlIGxldHRlciIsInBhc3N3b3JkLmNvbXBsZXhpdHkubnVtYmVyIjoiYSBudW1iZXIiLCJwYXNzd29yZC5jb21wbGV4aXR5LnN5bWJvbCI6ImEgc3ltYm9sIiwicGFzc3dvcmQuY29tcGxleGl0eS5ub191c2VybmFtZSI6Im5vIHBhcnRzIG9mIHlvdXIgdXNlcm5hbWUiLCJwYXNzd29yZC5leHBpcmVkLnN1Ym1pdCI6IkNoYW5nZSBQYXNzd29yZCIsInBhc3N3b3JkLmV4cGlyZWQudGl0bGUiOiJZb3VyIE9rdGEgcGFzc3dvcmQgaGFzIGV4cGlyZWQiLCJwYXNzd29yZC5leHBpcmluZy5sYXRlciI6IlJlbWluZCBtZSBsYXRlciIsInBhc3N3b3JkLmV4cGlyaW5nLnRpdGxlIjoiWW91ciBwYXNzd29yZCB3aWxsIGV4cGlyZSBpbiB7MH0gZGF5cyIsInBhc3N3b3JkLmV4cGlyaW5nLnRvZGF5IjoiWW91ciBwYXNzd29yZCB3aWxsIGV4cGlyZSBsYXRlciB0b2RheSIsInBhc3N3b3JkLmV4cGlyaW5nLnN1YnRpdGxlIjoiV2hlbiBwYXNzd29yZCBleHBpcmVzIHlvdSBtYXkgYmUgbG9ja2VkIG91dCBvZiBPa3RhIE1vYmlsZSwgbW9iaWxlIGVtYWlsLCBhbmQgb3RoZXIgc2VydmljZXMuIiwicGFzc3dvcmQuZXhwaXJlZC5jdXN0b20uc3VibWl0IjoiR28gdG8gezB9IiwicGFzc3dvcmQuZXhwaXJlZC5jdXN0b20uc3VidGl0bGUiOiJUaGlzIHBhc3N3b3JkIGlzIHNldCBvbiBhbm90aGVyIHdlYnNpdGUuIENsaWNrIHRoZSBidXR0b24gYmVsb3cgdG8gZ28gdGhlcmUgYW5kIHNldCBhIG5ldyBwYXNzd29yZC4iLCJhY2NvdW50LnVubG9jay50aXRsZSI6IlVubG9jayBhY2NvdW50IiwiYWNjb3VudC51bmxvY2suZW1haWwub3IudXNlcm5hbWUucGxhY2Vob2xkZXIiOiJFbWFpbCBvciB1c2VybmFtZSIsImFjY291bnQudW5sb2NrLmVtYWlsLm9yLnVzZXJuYW1lLnRvb2x0aXAiOiJFbWFpbCBvciB1c2VybmFtZSIsImFjY291bnQudW5sb2NrLnNlbmRUZXh0IjoiU2VuZCBTTVMiLCJhY2NvdW50LnVubG9jay5zZW5kRW1haWwiOiJTZW5kIEVtYWlsIiwiYWNjb3VudC51bmxvY2suZW1haWxTZW50LnRpdGxlIjoiRW1haWwgc2VudCEiLCJhY2NvdW50LnVubG9jay5lbWFpbFNlbnQuZGVzYyI6IkVtYWlsIGhhcyBiZWVuIHNlbnQgdG8gezB9IHdpdGggaW5zdHJ1Y3Rpb25zIG9uIHVubG9ja2luZyB5b3VyIGFjY291bnQuIiwiYWNjb3VudC51bmxvY2sucXVlc3Rpb24udGl0bGUiOiJBbnN3ZXIgVW5sb2NrIEFjY291bnQgQ2hhbGxlbmdlIiwiYWNjb3VudC51bmxvY2sucXVlc3Rpb24uc3VibWl0IjoiVW5sb2NrIEFjY291bnQiLCJhY2NvdW50LnVubG9jay51bmxvY2tlZC50aXRsZSI6IkFjY291bnQgc3VjY2Vzc2Z1bGx5IHVubG9ja2VkISIsImFjY291bnQudW5sb2NrLnVubG9ja2VkLmRlc2MiOiJZb3UgY2FuIGxvZyBpbiB1c2luZyB5b3VyIGV4aXN0aW5nIHVzZXJuYW1lIGFuZCBwYXNzd29yZC4iLCJhY2NvdW50LnVubG9jay5zbXMubm90UmVjZWl2ZWQiOiJEaWRuJ3QgcmVjZWl2ZSBhbiBTTVM/IFVubG9jayB2aWEgZW1haWwiLCJjb250YWN0LnN1cHBvcnQiOiJJZiB5b3UgZGlkbid0IHByb3ZpZGUgYSBzZWNvbmRhcnkgZW1haWwgYWRkcmVzcyBvciBkb24ndCBoYXZlIGFjY2VzcyB0byBlbWFpbCwgcGxlYXNlIGNvbnRhY3QgeW91ciBhZG1pbmlzdHJhdG9yIGF0IHswfSIsInNvY2lhbGF1dGguZGl2aWRlci50ZXh0IjoiT1IiLCJzb2NpYWxhdXRoLmZhY2Vib29rLmxhYmVsIjoiU2lnbiBpbiB3aXRoIEZhY2Vib29rIiwic29jaWFsYXV0aC5nb29nbGUubGFiZWwiOiJTaWduIGluIHdpdGggR29vZ2xlIiwic29jaWFsYXV0aC5saW5rZWRpbi5sYWJlbCI6IlNpZ24gaW4gd2l0aCBMaW5rZWRJbiIsInNvY2lhbGF1dGgubWljcm9zb2Z0LmxhYmVsIjoiU2lnbiBpbiB3aXRoIE1pY3Jvc29mdCIsInNvY2lhbGF1dGgucG9wdXAudGl0bGUiOiJFeHRlcm5hbCBJZGVudGl0eSBQcm92aWRlciBVc2VyIEF1dGhlbnRpY2F0aW9uIiwiYXV0aGJ1dHRvbi5kaXZpZGVyLnRleHQiOiJvciIsInJlZ2lzdHJhdGlvbi5zaWdudXAubGFiZWwiOiJEb24ndCBoYXZlIGFuIGFjY291bnQ/IiwicmVnaXN0cmF0aW9uLnNpZ251cC50ZXh0IjoiU2lnbiB1cCIsInJlZ2lzdHJhdGlvbi5jb21wbGV0ZS50aXRsZSI6IlZlcmlmaWNhdGlvbiBlbWFpbCBzZW50IiwicmVnaXN0cmF0aW9uLmNvbXBsZXRlLmRlc2MiOiJXZSBqdXN0IHNlbnQgYSB2ZXJpZmljYXRpb24gZW1haWwgdG8gezB9LiBQbGVhc2UgY2hlY2sgeW91ciBlbWFpbCBhbmQgdmVyaWZ5IHlvdXIgYWNjb3VudCB0byBjb250aW51ZS4iLCJyZWdpc3RyYXRpb24uZm9ybS50aXRsZSI6IkNyZWF0ZSBBY2NvdW50IiwicmVnaXN0cmF0aW9uLmZvcm0uc3VibWl0IjoiUmVnaXN0ZXIiLCJyZWdpc3RyYXRpb24ucGFzc3dvcmRDb21wbGV4aXR5Lm1pbkxlbmd0aCI6IkF0IGxlYXN0IHswfSBjaGFyYWN0ZXIocykiLCJyZWdpc3RyYXRpb24ucGFzc3dvcmRDb21wbGV4aXR5Lm1pbkxvd2VyQ2FzZSI6IkF0IGxlYXN0IHswfSBsb3dlcmNhc2UgbGV0dGVyKHMpIiwicmVnaXN0cmF0aW9uLnBhc3N3b3JkQ29tcGxleGl0eS5taW5VcHBlckNhc2UiOiJBdCBsZWFzdCB7MH0gdXBwZXJjYXNlIGxldHRlcihzKSIsInJlZ2lzdHJhdGlvbi5wYXNzd29yZENvbXBsZXhpdHkubWluTnVtYmVyIjoiQXQgbGVhc3QgezB9IG51bWJlcihzKSIsInJlZ2lzdHJhdGlvbi5wYXNzd29yZENvbXBsZXhpdHkubWluU3ltYm9sIjoiQXQgbGVhc3QgezB9IHN5bWJvbChzKSIsInJlZ2lzdHJhdGlvbi5wYXNzd29yZENvbXBsZXhpdHkuZXhjbHVkZVVzZXJuYW1lIjoiRG9lcyBub3QgY29udGFpbiBwYXJ0IG9mIHVzZXJuYW1lIiwicGl2LmNhcmQiOiJQSVYgQ2FyZCIsInBpdi5jYXJkLmluc2VydCI6IlBsZWFzZSBpbnNlcnQgeW91ciBQSVYgY2FyZCBhbmQgc2VsZWN0IHRoZSB1c2VyIGNlcnRpZmljYXRlLiIsInBpdi5jYXJkLmVycm9yIjoiQ2VydGlmaWNhdGUgYXV0aGVudGljYXRpb24gZmFpbGVkLiBDb250YWN0IHlvdXIgYWRtaW4uIiwicGl2LmNhcmQuZXJyb3IuZW1wdHkiOiJObyBjZXJ0aWZpY2F0ZSBzZWxlY3RlZC4gQ2hvb3NlIGEgY2VydGlmaWNhdGUgYW5kIHRyeSBhZ2Fpbi4iLCJwaXYuY2FyZC5lcnJvci5pbnZhbGlkIjoiQ2VydGlmaWNhdGUgdmFsaWRhdGlvbiBmYWlsZWQuIENob29zZSBhbm90aGVyIGNlcnRpZmljYXRlIGFuZCB0cnkgYWdhaW4uIiwidW5zdXBwb3J0ZWQub25lRHJpdmUudGl0bGUiOiJZb3VyIE9uZURyaXZlIHZlcnNpb24gaXMgbm90IHN1cHBvcnRlZCIsInVuc3VwcG9ydGVkLm9uZURyaXZlLmRlc2MiOiJVcGdyYWRlIG5vdyBieSBpbnN0YWxsaW5nIHRoZSBPbmVEcml2ZSBmb3IgQnVzaW5lc3MgTmV4dCBHZW5lcmF0aW9uIFN5bmMgQ2xpZW50IHRvIGxvZ2luIHRvIE9rdGEiLCJ1bnN1cHBvcnRlZC5vbmVEcml2ZS5hY3Rpb24iOiJMZWFybiBob3cgdG8gdXBncmFkZSIsInVuc3VwcG9ydGVkLmNvb2tpZXMudGl0bGUiOiJDb29raWVzIGFyZSByZXF1aXJlZCIsInVuc3VwcG9ydGVkLmNvb2tpZXMuZGVzYyI6IkNvb2tpZXMgYXJlIGRpc2FibGVkIG9uIHlvdXIgYnJvd3Nlci4gUGxlYXNlIGVuYWJsZSBDb29raWVzIGFuZCByZWZyZXNoIHRoaXMgcGFnZS4iLCJ1bnN1cHBvcnRlZC5jb29raWVzLmFjdGlvbiI6IlJlZnJlc2ggIiwiZGV2aWNlVHJ1c3Quc3NvLnRleHQiOiJTaWduIGluIHRvIGFjY2VzcyBjb21wYW55IHJlc291cmNlcyIsImRldmljZVRydXN0LnNzby5oaW50IjoiRWFzaWx5IGdldCBjb21wYW55IHJlc291cmNlcyB1c2luZyBPa3RhIE1vYmlsZSB0byBzaWduIGluIHRvIGFwcHMgZnJvbSB5b3VyIHNlY3VyZSBkZXZpY2UuIiwiZGV2aWNlVHJ1c3Quc3NvLmJ1dHRvbiI6IlNpZ24gaW4gdXNpbmcgT2t0YSBNb2JpbGUiLCJkZXZpY2VUcnVzdC5zc28uZXhwaXJlLnRpdGxlIjoiT29wcyBsZXQncyBnZXQgeW91IGJhY2sgb24gdHJhY2siLCJkZXZpY2VUcnVzdC5zc28uZXhwaXJlLnN1YnRpdGxlIjoiVW5mb3J0dW5hdGVseSB0aGUgc3RlcHMgcmVxdWlyZWQgdG8gc2lnbiBpbiB0b29rIGxvbmdlciB0aGFuIGV4cGVjdGVkIGFuZCB5b3VyIGF0dGVtcHQgdGltZWQgb3V0LiIsImRldmljZVRydXN0LnNzby5leHBpcmUuYnV0dG9uIjoiU2lnbiBpbiB1c2luZyBPa3RhIE1vYmlsZSIsImRldmljZVRydXN0LnVuaXZlcnNhbExpbmsuZmFsbGJhY2suZ2V0T2t0YU1vYmlsZS50aXRsZSI6IkdldCBPa3RhIE1vYmlsZSIsImRldmljZVRydXN0LnVuaXZlcnNhbExpbmsuZmFsbGJhY2suZ2V0T2t0YU1vYmlsZS5zdWJ0aXRsZSI6IkdvIHRvIHRoZSB7MH1BcHBTdG9yZXsxfSwgezB9c2VhcmNoezF9IGZvciB7MH1Pa3RhIE1vYmlsZXsxfSBhbmQgdGFwIG9uIHswfUdFVHsxfSBPa3RhIE1vYmlsZS4gT25jZSBpbnN0YWxsZWQsIHNpZ24gaW4gdG8gT2t0YSBNb2JpbGUgYW5kIGZvbGxvdyB0aGUgaW5zdHJ1Y3Rpb25zIHRvIHNlY3VyZSB5b3VyIGRldmljZS4iLCJyZWdpc3RyYXRpb24uZW1haWxTZW50LnRpdGxlIjoiVmVyaWZpY2F0aW9uIGVtYWlsIHNlbnQiLCJyZWdpc3RyYXRpb24uZW1haWxTZW50LmRlc2MiOiJXZSBqdXN0IHNlbnQgYSB2ZXJpZmljYXRpb24gZW1haWwgdG8gezB9LiBQbGVhc2UgY2hlY2sgeW91ciBlbWFpbCBhbmQgdmVyaWZ5IHlvdXIgYWNjb3VudCB0byBjb250aW51ZS4ifX0sZnVuY3Rpb24odCxlKXt0LmV4cG9ydHM9e0FGOiJBZmdoYW5pc3RhbiIsQVg6IsOFbGFuZCBJc2xhbmRzIixBTDoiQWxiYW5pYSIsRFo6IkFsZ2VyaWEiLEFTOiJBbWVyaWNhbiBTYW1vYSIsQUQ6IkFuZG9ycmEiLEFPOiJBbmdvbGEiLEFJOiJBbmd1aWxsYSIsQVE6IkFudGFyY3RpY2EiLEFHOiJBbnRpZ3VhIGFuZCBCYXJidWRhIixBUjoiQXJnZW50aW5hIixBTToiQXJtZW5pYSIsQVc6IkFydWJhIixBVToiQXVzdHJhbGlhIixBVDoiQXVzdHJpYSIsQVo6IkF6ZXJiYWlqYW4iLEJTOiJCYWhhbWFzIixCSDoiQmFocmFpbiIsQkQ6IkJhbmdsYWRlc2giLEJCOiJCYXJiYWRvcyIsQlk6IkJlbGFydXMiLEJFOiJCZWxnaXVtIixCWjoiQmVsaXplIixCSjoiQmVuaW4iLEJNOiJCZXJtdWRhIixCVDoiQmh1dGFuIixCTzoiQm9saXZpYSwgUGx1cmluYXRpb25hbCBTdGF0ZSBvZiIsQkE6IkJvc25pYSBhbmQgSGVyemVnb3ZpbmEiLEJXOiJCb3Rzd2FuYSIsQlY6IkJvdXZldCBJc2xhbmQiLEJSOiJCcmF6aWwiLElPOiJCcml0aXNoIEluZGlhbiBPY2VhbiBUZXJyaXRvcnkiLFZHOiJWaXJnaW4gSXNsYW5kcywgQnJpdGlzaCIsQk46IkJydW5laSBEYXJ1c3NhbGFtIixCRzoiQnVsZ2FyaWEiLEJGOiJCdXJraW5hIEZhc28iLEJJOiJCdXJ1bmRpIixLSDoiQ2FtYm9kaWEiLENNOiJDYW1lcm9vbiIsQ0E6IkNhbmFkYSIsQ1Y6IkNhcGUgVmVyZGUiLEtZOiJDYXltYW4gSXNsYW5kcyIsQ0Y6IkNlbnRyYWwgQWZyaWNhbiBSZXB1YmxpYyIsVEQ6IkNoYWQiLENMOiJDaGlsZSIsQ046IkNoaW5hIixDWDoiQ2hyaXN0bWFzIElzbGFuZCIsQ086IkNvbG9tYmlhIixLTToiQ29tb3JvcyIsQ0c6IkNvbmdvIixDSzoiQ29vayBJc2xhbmRzIixDUjoiQ29zdGEgUmljYSIsQ0k6IkPDtHRlIGQnSXZvaXJlIixIUjoiQ3JvYXRpYSIsQ1U6IkN1YmEiLENZOiJDeXBydXMiLENaOiJDemVjaCBSZXB1YmxpYyIsQ0Q6IkNvbmdvLCB0aGUgRGVtb2NyYXRpYyBSZXB1YmxpYyBvZiB0aGUiLERLOiJEZW5tYXJrIixESjoiRGppYm91dGkiLERNOiJEb21pbmljYSIsRE86IkRvbWluaWNhbiBSZXB1YmxpYyIsVEw6IlRpbW9yLUxlc3RlIixFQzoiRWN1YWRvciIsRUc6IkVneXB0IixTVjoiRWwgU2FsdmFkb3IiLEdROiJFcXVhdG9yaWFsIEd1aW5lYSIsRVI6IkVyaXRyZWEiLEVFOiJFc3RvbmlhIixFVDoiRXRoaW9waWEiLEZLOiJGYWxrbGFuZCBJc2xhbmRzIChNYWx2aW5hcykiLEZPOiJGYXJvZSBJc2xhbmRzIixGSjoiRmlqaSIsRkk6IkZpbmxhbmQiLEZSOiJGcmFuY2UiLEdGOiJGcmVuY2ggR3VpYW5hIixQRjoiRnJlbmNoIFBvbHluZXNpYSIsVEY6IkZyZW5jaCBTb3V0aGVybiBUZXJyaXRvcmllcyIsR0E6IkdhYm9uIixHTToiR2FtYmlhIixHRToiR2VvcmdpYSIsREU6Ikdlcm1hbnkiLEdIOiJHaGFuYSIsR0k6IkdpYnJhbHRhciIsR1I6IkdyZWVjZSIsR0w6IkdyZWVubGFuZCIsR0Q6IkdyZW5hZGEiLEdQOiJHdWFkZWxvdXBlIixHVToiR3VhbSIsR1Q6Ikd1YXRlbWFsYSIsR0c6Ikd1ZXJuc2V5IixHTjoiR3VpbmVhIixHVzoiR3VpbmVhLUJpc3NhdSIsR1k6Ikd1eWFuYSIsSFQ6IkhhaXRpIixITToiSGVhcmQgSXNsYW5kIGFuZCBNY0RvbmFsZCBJc2xhbmRzIixITjoiSG9uZHVyYXMiLEhLOiJIb25nIEtvbmciLEhVOiJIdW5nYXJ5IixJUzoiSWNlbGFuZCIsSU46IkluZGlhIixJRDoiSW5kb25lc2lhIixJUjoiSXJhbiwgSXNsYW1pYyBSZXB1YmxpYyBvZiIsSVE6IklyYXEiLElFOiJJcmVsYW5kIixJTDoiSXNyYWVsIixJVDoiSXRhbHkiLEpNOiJKYW1haWNhIixKUDoiSmFwYW4iLEpFOiJKZXJzZXkiLEpPOiJKb3JkYW4iLEtaOiJLYXpha2hzdGFuIixLRToiS2VueWEiLEtJOiJLaXJpYmF0aSIsS1I6IktvcmVhLCBSZXB1YmxpYyBvZiIsS1c6Ikt1d2FpdCIsS0c6Ikt5cmd5enN0YW4iLExBOiJMYW8gUGVvcGxlJ3MgRGVtb2NyYXRpYyBSZXB1YmxpYyIsTFY6IkxhdHZpYSIsTEI6IkxlYmFub24iLExTOiJMZXNvdGhvIixMUjoiTGliZXJpYSIsTFk6IkxpYnlhIixMSToiTGllY2h0ZW5zdGVpbiIsTFQ6IkxpdGh1YW5pYSIsTFU6Ikx1eGVtYm91cmciLE1POiJNYWNhbyIsTUs6Ik1hY2Vkb25pYSwgdGhlIGZvcm1lciBZdWdvc2xhdiBSZXB1YmxpYyBvZiIsTUc6Ik1hZGFnYXNjYXIiLE1XOiJNYWxhd2kiLE1ZOiJNYWxheXNpYSIsTVY6Ik1hbGRpdmVzIixNTDoiTWFsaSIsTVQ6Ik1hbHRhIixNSDoiTWFyc2hhbGwgSXNsYW5kcyIsTVE6Ik1hcnRpbmlxdWUiLE1SOiJNYXVyaXRhbmlhIixNVToiTWF1cml0aXVzIixZVDoiTWF5b3R0ZSIsTVg6Ik1leGljbyIsRk06Ik1pY3JvbmVzaWEsIEZlZGVyYXRlZCBTdGF0ZXMgb2YiLE1EOiJNb2xkb3ZhLCBSZXB1YmxpYyBvZiIsTUM6Ik1vbmFjbyIsTU46Ik1vbmdvbGlhIixNRToiTW9udGVuZWdybyIsTVM6Ik1vbnRzZXJyYXQiLE1BOiJNb3JvY2NvIixNWjoiTW96YW1iaXF1ZSIsTU06Ik15YW5tYXIiLE5BOiJOYW1pYmlhIixOUjoiTmF1cnUiLE5QOiJOZXBhbCIsTkw6Ik5ldGhlcmxhbmRzIixBTjoiTmV0aGVybGFuZHMgQW50aWxsZXMiLE5DOiJOZXcgQ2FsZWRvbmlhIixOWjoiTmV3IFplYWxhbmQiLE5JOiJOaWNhcmFndWEiLE5FOiJOaWdlciIsTkc6Ik5pZ2VyaWEiLE5VOiJOaXVlIixORjoiTm9yZm9sayBJc2xhbmQiLEtQOiJLb3JlYSwgRGVtb2NyYXRpYyBQZW9wbGUncyBSZXB1YmxpYyBvZiIsTVA6Ik5vcnRoZXJuIE1hcmlhbmEgSXNsYW5kcyIsTk86Ik5vcndheSIsT006Ik9tYW4iLFBLOiJQYWtpc3RhbiIsUFc6IlBhbGF1IixQUzoiUGFsZXN0aW5lLCBTdGF0ZSBvZiIsUEE6IlBhbmFtYSIsUEc6IlBhcHVhIE5ldyBHdWluZWEiLFBZOiJQYXJhZ3VheSIsUEU6IlBlcnUiLFBIOiJQaGlsaXBwaW5lcyIsUE46IlBpdGNhaXJuIixQTDoiUG9sYW5kIixQVDoiUG9ydHVnYWwiLFBSOiJQdWVydG8gUmljbyIsUUE6IlFhdGFyIixSRToiUsOpdW5pb24iLFJPOiJSb21hbmlhIixSVToiUnVzc2lhbiBGZWRlcmF0aW9uIixSVzoiUndhbmRhIixTSDoiU2FpbnQgSGVsZW5hLCBBc2NlbnNpb24gYW5kIFRyaXN0YW4gZGEgQ3VuaGEiLEtOOiJTYWludCBLaXR0cyBhbmQgTmV2aXMiLExDOiJTYWludCBMdWNpYSIsUE06IlNhaW50IFBpZXJyZSBhbmQgTWlxdWVsb24iLFZDOiJTYWludCBWaW5jZW50IGFuZCB0aGUgR3JlbmFkaW5lcyIsV1M6IlNhbW9hIixTTToiU2FuIE1hcmlubyIsU1Q6IlPDo28gVG9tw6kgYW5kIFByw61uY2lwZSIsU0E6IlNhdWRpIEFyYWJpYSIsU046IlNlbmVnYWwiLFJTOiJTZXJiaWEiLFNDOiJTZXljaGVsbGVzIixTTDoiU2llcnJhIExlb25lIixTRzoiU2luZ2Fwb3JlIixTSzoiU2xvdmFraWEiLFNJOiJTbG92ZW5pYSIsU0I6IlNvbG9tb24gSXNsYW5kcyIsU086IlNvbWFsaWEiLFpBOiJTb3V0aCBBZnJpY2EiLEdTOiJTb3V0aCBHZW9yZ2lhIGFuZCB0aGUgU291dGggU2FuZHdpY2ggSXNsYW5kcyIsU1M6IlNvdXRoIFN1ZGFuIixFUzoiU3BhaW4iLExLOiJTcmkgTGFua2EiLFNEOiJTdWRhbiIsU1I6IlN1cmluYW1lIixTSjoiU3ZhbGJhcmQgYW5kIEphbiBNYXllbiIsU1o6IlN3YXppbGFuZCIsU0U6IlN3ZWRlbiIsQ0g6IlN3aXR6ZXJsYW5kIixTWToiU3lyaWFuIEFyYWIgUmVwdWJsaWMiLFRXOiJUYWl3YW4iLFRKOiJUYWppa2lzdGFuIixUWjoiVGFuemFuaWEsIFVuaXRlZCBSZXB1YmxpYyBvZiIsVEg6IlRoYWlsYW5kIixURzoiVG9nbyIsVEs6IlRva2VsYXUiLFRPOiJUb25nYSIsVFQ6IlRyaW5pZGFkIGFuZCBUb2JhZ28iLFROOiJUdW5pc2lhIixUUjoiVHVya2V5IixUTToiVHVya21lbmlzdGFuIixUQzoiVHVya3MgYW5kIENhaWNvcyBJc2xhbmRzIixUVjoiVHV2YWx1IixWSToiVmlyZ2luIElzbGFuZHMsIFUuUy4iLFVHOiJVZ2FuZGEiLFVBOiJVa3JhaW5lIixBRToiVW5pdGVkIEFyYWIgRW1pcmF0ZXMiLEdCOiJVbml0ZWQgS2luZ2RvbSIsVVM6IlVuaXRlZCBTdGF0ZXMiLFVNOiJVbml0ZWQgU3RhdGVzIE1pbm9yIE91dGx5aW5nIElzbGFuZHMiLFVZOiJVcnVndWF5IixVWjoiVXpiZWtpc3RhbiIsVlU6IlZhbnVhdHUiLFZBOiJIb2x5IFNlZSAoVmF0aWNhbiBDaXR5IFN0YXRlKSIsVkU6IlZlbmV6dWVsYSwgQm9saXZhcmlhbiBSZXB1YmxpYyBvZiIsVk46IlZpZXQgTmFtIixXRjoiV2FsbGlzIGFuZCBGdXR1bmEiLEVIOiJXZXN0ZXJuIFNhaGFyYSIsWUU6IlllbWVuIixaTToiWmFtYmlhIixaVzoiWmltYmFid2UifX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0NCldLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdC5leHRlbmQoZSx7ZGVwcmVjYXRlOmZ1bmN0aW9uKHQpe2Uud2FybigiW29rdGEtc2lnbmluLXdpZGdldF0gREVQUkVDQVRFRDoiLHQpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMildLHI9ZnVuY3Rpb24odCl7dmFyIGU9e30saT0id2l0aENyZWRlbnRpYWxzImluIG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3Qsbj0idW5kZWZpbmVkIiE9dHlwZW9mIFhEb21haW5SZXF1ZXN0O3JldHVybiBlLmNvcnNJc05vdFN1cHBvcnRlZD1mdW5jdGlvbigpe3JldHVybiEoaXx8bil9LGUuY29yc0lzTm90RW5hYmxlZD1mdW5jdGlvbih0KXtyZXR1cm4gMD09PXQuc3RhdHVzfSxlLmxvY2FsU3RvcmFnZUlzTm90U3VwcG9ydGVkPWZ1bmN0aW9uKCl7dmFyIHQ9InRlc3QiO3RyeXtyZXR1cm4gbG9jYWxTdG9yYWdlLnNldEl0ZW0odCx0KSxsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSh0KSwhMX1jYXRjaChlKXtyZXR1cm4hMH19LGUuc3VwcG9ydHNQdXNoU3RhdGU9ZnVuY3Rpb24odCl7cmV0dXJuIHQ9dHx8d2luZG93LCEoIXQuaGlzdG9yeXx8IXQuaGlzdG9yeS5wdXNoU3RhdGUpfSxlLmlzSUU9ZnVuY3Rpb24oKXtyZXR1cm4vKG1zaWV8dHJpZGVudCkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpfSxlLmlzRmlyZWZveD1mdW5jdGlvbigpe3JldHVybiBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkuaW5kZXhPZigiZmlyZWZveCIpPi0xfSxlLmdldFVzZXJMYW5ndWFnZXM9ZnVuY3Rpb24oKXt2YXIgZSxpO3JldHVybiBuYXZpZ2F0b3IubGFuZ3VhZ2VzP25hdmlnYXRvci5sYW5ndWFnZXM6KGU9W10saT1bImxhbmd1YWdlIiwidXNlckxhbmd1YWdlIiwiYnJvd3Nlckxhbmd1YWdlIiwic3lzdGVtTGFuZ3VhZ2UiXSx0LmVhY2goaSxmdW5jdGlvbih0KXtuYXZpZ2F0b3JbdF0mJmUucHVzaChuYXZpZ2F0b3JbdF0pfSksZSl9LGV9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg1KSxpKDIpLGkoMTg0KSxpKDE1MCldLHI9ZnVuY3Rpb24odCxlLGksbil7cmV0dXJuIG4uZXh0ZW5kKHtjb25zdHJ1Y3RvcjpmdW5jdGlvbihlKXt0aGlzLl9faGFzRGVmYXVsdFJvdXRlPSExO3ZhciByPXRoaXMuX190YWJzV2lkZ2V0PW5ldyBpO3IucmVuZGVyKCk7dmFyIHM9dChlLmVsKTtlLmVsPXIuY29udGVudCgpLHQoZnVuY3Rpb24oKXtzLmFwcGVuZChyLmVsKX0pLG4uY2FsbCh0aGlzLGUpfSx0YWI6ZnVuY3Rpb24odCxpLG4scil7dmFyIHM9ZS5pc0FycmF5KHQpP3Q6W3RdO3JldHVybiB0aGlzLl9fYWRkVGFiKHtyb3V0ZXM6cyxtZXRob2Q6aSxsYWJlbDpuLHN1YnRhYnM6cn0pLHRoaXN9LF9fYWRkVGFiOmZ1bmN0aW9uKHQpe3RoaXMuX19oYXNEZWZhdWx0Um91dGV8fCh0aGlzLnJvdXRlKCIiLHQubWV0aG9kKSx0aGlzLl9faGFzRGVmYXVsdFJvdXRlPSEwKSx0LnN1YnRhYnMmJnQuc3VidGFicy5sZW5ndGgmJnRoaXMuX19hZGRTdWJUYWJzKGUuZXh0ZW5kKGUucGljayh0LCJyb3V0ZXMiLCJzdWJ0YWJzIikpKSxlLmVhY2godC5yb3V0ZXMsZnVuY3Rpb24oZSl7dGhpcy5yb3V0ZShlLHQubWV0aG9kKX0sdGhpcyk7dmFyIGk9ZS5maXJzdCh0LnJvdXRlcyk7dGhpcy5fX3RhYnNXaWRnZXQuYWRkVGFiKGUuZXh0ZW5kKGUucGljayh0LCJsYWJlbCIsIm1ldGhvZCIsInN1YnRhYnMiKSx7cm91dGU6aSxyb3V0ZXI6dGhpc30pKX0sX19hZGRTdWJUYWJzOmZ1bmN0aW9uKHQpe2UuZWFjaCh0LnN1YnRhYnMsZnVuY3Rpb24oaSl7dmFyIG49dC5yb3V0ZXMrIi8iK2kucm91dGVzO3RoaXMucm91dGUobixpLm1ldGhvZCksdGhpcy5fX3RhYnNXaWRnZXQuYWRkU3ViVGFiKGUuZXh0ZW5kKGUucGljayhpLCJsYWJlbCIsIm1ldGhvZCIpLHtyb3V0ZTpuLHJvdXRlcjp0aGlzfSkpfSx0aGlzKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDE0NiksaSgxODUpLGkoMTg2KV0scj1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQuZXh0ZW5kKHtjbGFzc05hbWU6ImNsZWFyZml4IHVpLXRhYnMgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwiLHRlbXBsYXRlOic8dWwgcm9sZT0idGFibGlzdCIgY2xhc3M9InVpLXRhYnMtbmF2IHVpLWhlbHBlci1yZXNldCB1aS1oZWxwZXItY2xlYXJmaXggdWktd2lkZ2V0LWhlYWRlciB1aS1jb3JuZXItYWxsIHVpLXRhYnMtbWFyZ2luIj48L3VsPjxkaXYgcm9sZT0ic3VidGFicyIgY2xhc3M9InVpLXN1YnRhYnMgdWktaGVscGVyLXJlc2V0IHVpLXRhYnMtbWFyZ2luIj48L2Rpdj48ZGl2IHJvbGU9InRhYnBhbmVsIiBjbGFzcz0idWktdGFicy1wYW5lbCB1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYm90dG9tIj48L2Rpdj4nLGNvbnRlbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kKCJkaXYudWktdGFicy1wYW5lbCIpfSxhZGRUYWI6ZnVuY3Rpb24odCl7dGhpcy5hZGQoZSwidWwiLHtvcHRpb25zOnR9KX0sYWRkU3ViVGFiOmZ1bmN0aW9uKHQpe3RoaXMuYWRkKGksImRpdi51aS1zdWJ0YWJzIix7b3B0aW9uczp0fSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0NildLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5leHRlbmQoe3RhZ05hbWU6ImxpIixjbGFzc05hbWU6InVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLXRvcCIsYXR0cmlidXRlczp7cm9sZToidGFiIn0sdGVtcGxhdGU6JzxhIGNsYXNzPSJ1aS10YWJzLWFuY2hvciIgcm9sZT0icHJlc2VudGF0aW9uIiBocmVmPSJ7e3JvdXRlfX0iPnt7bGFiZWx9fTwvYT4nLGV2ZW50czp7ImNsaWNrIGEiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpLHRoaXMucm91dGVyLm5hdmlnYXRlKHRoaXMucm91dGUse3RyaWdnZXI6ITB9KX19LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0LmV4dGVuZCh0aGlzLHQucGljayh0aGlzLm9wdGlvbnMsInJvdXRlIiwicm91dGVyIiwibWV0aG9kIikpLHRoaXMubGlzdGVuVG8odGhpcy5yb3V0ZXIsInJvdXRlIix0aGlzLnRvZ2dsZSl9LHRvZ2dsZTpmdW5jdGlvbihlKXtpZih0aGlzLiRlbC50b2dnbGVDbGFzcygidWktc3RhdGUtYWN0aXZlIHVpLXRhYnMtc2VsZWN0ZWQiLGU9PXRoaXMubWV0aG9kKSx0aGlzLm9wdGlvbnMuc3VidGFicyYmdGhpcy5vcHRpb25zLnN1YnRhYnMubGVuZ3RoKWlmKGUhPXRoaXMubWV0aG9kKXQuZWFjaCh0aGlzLm9wdGlvbnMuc3VidGFicyxmdW5jdGlvbih0KXt0Lm1ldGhvZD09ZSYmdGhpcy4kZWwuYWRkQ2xhc3MoInVpLXN0YXRlLWFjdGl2ZSB1aS10YWJzLXNlbGVjdGVkIil9LHRoaXMpO2Vsc2V7dGhpcy4kZWwucGFyZW50KCkucGFyZW50KCkuZmluZCgiLnVpLXN1YnRhYnMgbGk6Zmlyc3QtY2hpbGQiKS5hZGRDbGFzcygidWktc3RhdGUtYWN0aXZlIHVpLXRhYnMtc2VsZWN0ZWQiKTt2YXIgaT10aGlzLm9wdGlvbnMucm91dGUrIi8iK3RoaXMub3B0aW9ucy5zdWJ0YWJzWzBdLnJvdXRlczt0aGlzLnJvdXRlci5uYXZpZ2F0ZShpLHt0cmlnZ2VyOiEwfSl9ZWxzZSB0aGlzLiRlbC5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCIudWktc3VidGFicyIpLnRvZ2dsZShlIT10aGlzLm1ldGhvZCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0NildLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5leHRlbmQoe3RhZ05hbWU6ImxpIixjbGFzc05hbWU6InN1YnRhYiB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci10b3AiLGF0dHJpYnV0ZXM6e3JvbGU6InN1YnRhYiJ9LHRlbXBsYXRlOic8YSBjbGFzcz0ic3ViLXRhYi1saW5rIHVpLXRhYnMtYW5jaG9yIiByb2xlPSJwcmVzZW50YXRpb24iIGhyZWY9Int7cm91dGV9fSI+e3tsYWJlbH19PC9hPicsZXZlbnRzOnsiY2xpY2sgYSI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCksdGhpcy5yb3V0ZXIubmF2aWdhdGUodGhpcy5yb3V0ZSx7dHJpZ2dlcjohMH0pfX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3QuZXh0ZW5kKHRoaXMsdC5waWNrKHRoaXMub3B0aW9ucywicm91dGUiLCJyb3V0ZXIiLCJtZXRob2QiKSksdGhpcy5saXN0ZW5Ubyh0aGlzLnJvdXRlciwicm91dGUiLHRoaXMudG9nZ2xlKX0sdG9nZ2xlOmZ1bmN0aW9uKHQpe3RoaXMuJGVsLnRvZ2dsZUNsYXNzKCJ1aS1zdGF0ZS1hY3RpdmUgdWktdGFicy1zZWxlY3RlZCIsdD09dGhpcy5tZXRob2QpLHRoaXMuJGVsLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoIi51aS10YWJzLXBhbmVsIikuYWRkQ2xhc3MoInN1YnRhYi1jb250ZW50IiksdGhpcy4kZWwucGFyZW50KCkucGFyZW50KCkuZmluZCgiLnVpLXN1YnRhYnMiKS5hZGRDbGFzcygic3VidGFicy1wYW5lbCIpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXshKHQuZXhwb3J0cz17REVCT1VOQ0VfREVMQVk6MjAwLExPQURJTkdfRkFERTo0MDAsVU5MT0FESU5HX0ZBREU6NDAwLFJPV19FWFBBTkRFUl9UUkFOU0lUSU9OOjE1MCxISURFX0FERF9NQVBQSU5HX0ZPUk06MzAwfSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzYpXSxyPWZ1bmN0aW9uKHQpe3ZhciBlPXtNSUxMSVNFQ09ORDoibWlsbGlzZWNvbmRzIixTRUNPTkQ6InNlY29uZHMiLE1JTlVURToibWludXRlcyIsSE9VUjoiaG91cnMiLERBWToiZGF5cyJ9O3JldHVybntNSU5VVEVTX0hPVVJTX0RBWVM6e01JTlVURToiTWludXRlcyIsSE9VUjoiSG91cnMiLERBWToiRGF5cyJ9LE1JTExJU0VDT05EU19TRUNPTkRTX01JTlVURVM6e01JTExJU0VDT05EOiJNaWxsaXNlY29uZHMiLFNFQ09ORDoiU2Vjb25kcyIsTUlOVVRFOiJNaW51dGVzIn0sY29udmVydFRvUERUOmZ1bmN0aW9uKGUsaSxuKXtyZXR1cm4gaXx8KGk9Ik1NTSBERCwgWVlZWSBoOm1tOnNzIEEiKSxufHwobj0iIiksZT90KGUpLnV0YygpLnpvbmUoIi0wNzowMCIpLmZvcm1hdChpKTpufSxnZXRUaW1lSW5IaWdoZXN0UmVsZXZhbnRVbml0OmZ1bmN0aW9uKGksbil7dmFyIHIscz10LmR1cmF0aW9uKGksZVtuXXx8bik7cmV0dXJuIHI9MCE9PXMubWlsbGlzZWNvbmRzKCk/Im1pbGxpc2Vjb25kcyI6MCE9PXMuc2Vjb25kcygpPyJzZWNvbmRzIjowIT09cy5taW51dGVzKCk/Im1pbnV0ZXMiOjAhPT1zLmhvdXJzKCk/ImhvdXJzIjoiZGF5cyIse3RpbWU6cy5hcyhyKSx1bml0OnRoaXMuY29udmVydE1vbWVudFVuaXRzKHIpfX0sY29udmVydE1vbWVudFVuaXRzOmZ1bmN0aW9uKHQpe3N3aXRjaCh0KXtjYXNlIm1pbGxpc2Vjb25kcyI6cmV0dXJuIk1JTExJU0VDT05EIjtjYXNlInNlY29uZHMiOnJldHVybiJTRUNPTkQiO2Nhc2UibWludXRlcyI6cmV0dXJuIk1JTlVURSI7Y2FzZSJob3VycyI6cmV0dXJuIkhPVVIiO2Nhc2UiZGF5cyI6cmV0dXJuIkRBWSI7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoIlRpbWUgdW5pdCBub3QgcmVjb2duaXplZDogIit0KX19LGNvbnZlcnRUaW1lVW5pdDpmdW5jdGlvbihpLG4scil7cmV0dXJuIGk9cGFyc2VJbnQoaSwxMCksbj1lW25dfHxuLHI9ZVtyXXx8cix0LmR1cmF0aW9uKGksbikuYXMocil9LGNvbnZlcnRUaW1lRm9ybWF0OmZ1bmN0aW9uKGUsaSxuKXtyZXR1cm4gbnx8KG49Ik1NTU0gRG8sIFlZWVkiKSx0KGUsaSkuZm9ybWF0KG4pfX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMildLHI9ZnVuY3Rpb24odCl7cmV0dXJue3JlZGlyZWN0OmZ1bmN0aW9uKHQpe3dpbmRvdy5sb2NhdGlvbj10fSxyZWxvYWRQYWdlOmZ1bmN0aW9uKCl7d2luZG93LmxvY2F0aW9uLnJlbG9hZCgpfSxjb25zdGFudEVycm9yOmZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbigpe3Rocm93IG5ldyBFcnJvcih0KX19LGdldFVybFF1ZXJ5U3RyaW5nOmZ1bmN0aW9uKGUpe3QuaXNPYmplY3QoZSl8fChlPXt9KTt2YXIgaT10LndpdGhvdXQodC5tYXAoZSxmdW5jdGlvbih0LGUpe2lmKHZvaWQgMCE9PXQmJm51bGwhPT10KXJldHVybiBlKyI9IitlbmNvZGVVUklDb21wb25lbnQodCl9KSx2b2lkIDApLmpvaW4oIiYiKTtyZXR1cm4gdC5pc0VtcHR5KGkpPyIiOiI/IitpfX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDYpLGkoMTkyKSxpKDE5NCksaSgxOTUpLGkoMjQ3KSxpKDI2NyksaSgyODMpLGkoMjg0KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvLGEpe3JldHVybntCYXNlVmlldzp0LExpc3RWaWV3OmUsVGFibGVWaWV3OmksY29tcG9uZW50czpuLGRhdGFsaXN0OnIsZm9ybXM6cyx0YWJzOm8sdXBsb2FkZXI6YX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDYpLGkoMTkzKV0scj1mdW5jdGlvbih0LGUpe3JldHVybiB0LmRlY29yYXRlKGUpfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyLHM7IWZ1bmN0aW9uKG8sYSl7cj1baSgyKSxpKDE0MildLG49YSxzPSJmdW5jdGlvbiI9PXR5cGVvZiBuP24uYXBwbHkoZSxyKTpuLCEodm9pZCAwIT09cyYmKHQuZXhwb3J0cz1zKSl9KHRoaXMsZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5leHRlbmQoe2NvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7aWYoZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksIXRoaXMuY29sbGVjdGlvbil0aHJvdyBuZXcgRXJyb3IoIk1pc3NpbmcgY29sbGVjdGlvbiIpO3RoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCJyZXNldCBzb3J0Iix0aGlzLnJlc2V0KSx0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwiYWRkIix0aGlzLmFkZEl0ZW0pLHRoaXMuY29sbGVjdGlvbi5lYWNoKHRoaXMuYWRkSXRlbSx0aGlzKX0saXRlbTpudWxsLGl0ZW1TZWxlY3RvcjpudWxsLHJlc2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVtb3ZlQ2hpbGRyZW4oKSx0aGlzLmNvbGxlY3Rpb24uZWFjaCh0aGlzLmFkZEl0ZW0sdGhpcyksdGhpc30sYWRkSXRlbTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmFkZCh0aGlzLml0ZW0sdGhpcy5pdGVtU2VsZWN0b3Ise29wdGlvbnM6e21vZGVsOnR9fSkubGFzdCgpO3JldHVybiBlLmxpc3RlblRvKHQsImRlc3Ryb3kgcmVtb3ZlIixlLnJlbW92ZSksdGhpc319KX0pfSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNTQpLGkoMTk2KSxpKDE5NyksaSgyMzcpLGkoMjM5KSxpKDI0MiksaSgyNDMpLGkoMjQ0KSxpKDI0NSldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhLGwpe3JldHVybntCYXNlQnV0dG9uTGluazp0LEJhc2VEcm9wRG93bjplLEJhc2VGb3JtRGlhbG9nOmksQmFzZU1vZGFsRGlhbG9nOm4sQmFzZVNwaW5uZXI6cixDYWxsb3V0OnMsQ29uZmlybWF0aW9uRGlhbG9nOm8sRHJvcERvd246YSxNdWx0aVZpZXdNb2RhbERpYWxvZzpsfX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoNSksaSgxNDcpLGkoMTQ2KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj1pLnRwbCgnXHQgICAgPGEgY2xhc3M9Imljb24tMTYge3tjbGFzc05hbWV9fSIgZGF0YS1zZT0ie3tzZWxlbml1bUlkfX0iPlx0ICAgICAge3sjaWYgaWNvbn19XHQgICAgICA8c3BhbiBjbGFzcz0iaWNvbiB7e2ljb259fSI+PC9zcGFuPlx0ICAgICAge3svaWZ9fVx0ICAgICAge3sjaWYgdGl0bGV9fVx0ICAgICAge3t0aXRsZX19XHQgICAgICB7ey9pZn19XHQgICAgICB7eyNpZiBzdWJ0aXRsZX19XHQgICAgICAgIDxwIGNsYXNzPSJvcHRpb24tc3VidGl0bGUiPnt7c3VidGl0bGV9fTwvcD5cdCAgICAgIHt7L2lmfX1cdCAgIDwvYT5cdCAgICcpLHM9bi5leHRlbmQoe3RhZ05hbWU6ImxpIixldmVudHM6e2NsaWNrOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLmFjdGlvbiYmdGhpcy5hY3Rpb24uY2FsbCh0aGlzKX19LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7bi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy4kZWwuYWRkQ2xhc3MoIm9rdGEtZHJvcGRvd24tb3B0aW9uIG9wdGlvbiIpfSxyZW5kZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kZWwuaHRtbChyKHtpY29uOnQucmVzdWx0KHRoaXMsImljb24iKSxjbGFzc05hbWU6dC5yZXN1bHQodGhpcywiY2xhc3NOYW1lIil8fCIiLHRpdGxlOnQucmVzdWx0KHRoaXMsInRpdGxlIiksc3VidGl0bGU6dC5yZXN1bHQodGhpcywic3VidGl0bGUiKSxzZWxlbml1bUlkOnQucmVzdWx0KHRoaXMsInNlbGVuaXVtSWQiKX0pKSx0aGlzfX0pO3JldHVybiBuLmV4dGVuZCh7ZXZlbnRzOnsiY2xpY2sgYS5vcHRpb24tc2VsZWN0ZWQiOmZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKSx0LnJlc3VsdCh0aGlzLCJkaXNhYmxlZCIpJiZlLnN0b3BQcm9wYWdhdGlvbigpfSwiY2xpY2sgLmRyb3Bkb3duLWRpc2FibGVkIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKX19LGl0ZW1zOltdLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5jbGFzc05hbWU7dGhpcy5jbGFzc05hbWU9bnVsbCxuLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmNsYXNzTmFtZT1lLHRoaXMuJGVsLmFkZENsYXNzKCJkcm9wZG93biBtb3JlLWFjdGlvbnMgZmxvYXQtbCIpLHQuZWFjaCh0LnJlc3VsdCh0aGlzLCJpdGVtcyIpLGZ1bmN0aW9uKHQpe3RoaXMuYWRkT3B0aW9uKHQsdGhpcy5vcHRpb25zKX0sdGhpcyl9LHRlbXBsYXRlOidcdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rLWJ1dHRvbiB7e2NsYXNzTmFtZX19IGxpbmstYnV0dG9uLWljb24gb3B0aW9uLXNlbGVjdGVkIGNlbnRlciI+XHQgICAgICAgIHt7I2lmIGljb259fVx0ICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbiB7e2ljb259fSI+PC9zcGFuPlx0ICAgICAgICB7ey9pZn19XHQgICAgICAgIDxzcGFuIGNsYXNzPSJvcHRpb24tc2VsZWN0ZWQtdGV4dCI+e3t0aXRsZX19PC9zcGFuPlx0ICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbi1kbSI+PC9zcGFuPlx0ICAgICAgPC9hPlx0ICAgICAgPGRpdiBjbGFzcz0ib3B0aW9ucyBjbGVhcmZpeCIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij5cdCAgICAgIDx1bCBjbGFzcz0ib2t0YS1kcm9wZG93bi1saXN0IG9wdGlvbnMtd3JhcCBjbGVhcmZpeCI+PC91bD5cdCAgICAgIDwvZGl2Plx0ICAgICcsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7dmFyIGk9W3QucmVzdWx0KHRoaXMsImNsYXNzTmFtZSIpfHwiIix0LnJlc3VsdCh0aGlzLCJkaXNhYmxlZCIpPyJkcm9wZG93bi1kaXNhYmxlZCI6IiJdO3JldHVybntpY29uOnQucmVzdWx0KHRoaXMsImljb24iKSxjbGFzc05hbWU6ZS50cmltKGkuam9pbigiICIpKSx0aXRsZTp0LnJlc3VsdCh0aGlzLCJ0aXRsZSIpfX0sYWRkT3B0aW9uOmZ1bmN0aW9uKHQsZSl7dGhpcy5hZGQocy5leHRlbmQodCksInVsLm9wdGlvbnMtd3JhcCIse29wdGlvbnM6ZXx8e319KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDUpLGkoMiksaSgxNDYpLGkoMTM5KSxpKDE5OCldLHI9ZnVuY3Rpb24odCxlLGksbixyKXt2YXIgcz1bInNhdmUiLCJub0NhbmNlbEJ1dHRvbiIsImlucHV0cyIsInN1YnRpdGxlIiwiYXV0b1NhdmUiLCJmb2N1cyIsImNhbmNlbCIsImRhbmdlciIsImhhc1NhdmluZ1N0YXRlIiwiY3VzdG9tU2F2aW5nU3RhdGUiLCJwYXJzZUVycm9yTWVzc2FnZSJdLG89e2xheW91dDoiby1mb3JtLXdyYXAiLHNjcm9sbE9uRXJyb3I6ITF9LGE9e21pbldpZHRoOjYwMCxtYXhXaWR0aDo5NTAsZm9jdXM6ITEsY2xvc2U6ITEsYXV0b1Jlc2l6ZTohMSxhdXRvUG9zaXRpb246ITB9O3JldHVybiBpLmV4dGVuZCh7Y29uc3RydWN0b3I6ZnVuY3Rpb24obCl7dmFyIGM9ci5leHRlbmQoZS5leHRlbmQoe30sbyxlLnBpY2sodGhpcyxzKSkpO3RoaXMuZm9ybT1uZXcgYyhlLm9taXQobCwidGl0bGUiLCJzdWJ0aXRsZSIpKSx0aGlzLmxpc3RlblRvKHRoaXMuZm9ybSwicmVzaXplIixlLmRlYm91bmNlKGUuYmluZCh0aGlzLnJlc2l6ZU1vZGFsLHRoaXMpLDEwMCkpO3ZhciB1PWUuYmluZCh0aGlzLnJlbW92ZSx0aGlzKTt0aGlzLmxpc3RlblRvKHRoaXMuZm9ybSwiYWxsIixmdW5jdGlvbigpe3RoaXMudHJpZ2dlci5hcHBseSh0aGlzLGFyZ3VtZW50cyksImNhbmNlbCI9PT1hcmd1bWVudHNbMF0mJnUoKX0pLHQod2luZG93KS5yZXNpemUoZS5kZWJvdW5jZShlLmJpbmQodGhpcy5yZXNpemVNb2RhbCx0aGlzKSwxMDApKTt2YXIgZD1uLmV4dGVuZCh7dGl0bGU6dGhpcy50aXRsZSxjbGFzc05hbWU6dGhpcy5jbGFzc05hbWUscGFyYW1zOmUuZXh0ZW5kKHt9LGEsdGhpcy5wYXJhbXMpfSk7dGhpcy5kaWFsb2c9bmV3IGQobCksdGhpcy5kaWFsb2cuYWRkKHRoaXMuZm9ybSksdGhpcy5lbD10aGlzLmRpYWxvZy5lbCxpLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmZvcm0uZ2V0QXR0cmlidXRlKCJhdXRvU2F2ZSIpJiZ0aGlzLmxpc3RlblRvKHRoaXMsInNhdmVkIix0aGlzLnJlbW92ZSl9LGZvcm06dm9pZCAwLGRpYWxvZzp2b2lkIDAsYWRkSW5wdXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mb3JtLmFkZElucHV0LmFwcGx5KHRoaXMuZm9ybSxhcmd1bWVudHMpfSxhZGRCdXR0b246ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mb3JtLmFkZEJ1dHRvbi5hcHBseSh0aGlzLmZvcm0sYXJndW1lbnRzKX0sYWRkRGl2aWRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmZvcm0uYWRkRGl2aWRlci5hcHBseSh0aGlzLmZvcm0sYXJndW1lbnRzKX0sYWRkU2VjdGlvblRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZm9ybS5hZGRTZWN0aW9uVGl0bGUuYXBwbHkodGhpcy5mb3JtLGFyZ3VtZW50cyl9LGFkZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmZvcm0uYWRkLmFwcGx5KHRoaXMuZm9ybSxhcmd1bWVudHMpfSxyZW5kZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmVSZW5kZXIoKSx0aGlzLmRpYWxvZy5yZW5kZXIuYXBwbHkodGhpcy5kaWFsb2csYXJndW1lbnRzKSxlLmRlZmVyKGUuYmluZCh0aGlzLnJlc2l6ZU1vZGFsLHRoaXMpKSx0aGlzLnBvc3RSZW5kZXIoKSx0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaWFsb2cucmVtb3ZlLmFwcGx5KHRoaXMuZGlhbG9nLGFyZ3VtZW50cyksaS5wcm90b3R5cGUucmVtb3ZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0scmVzaXplTW9kYWw6ZnVuY3Rpb24oKXt2YXIgaT10KCIuc2ltcGxlbW9kYWwtY29udGFpbmVyLW5ldyIpLG49dGhpcy5mb3JtLHI9aS5oZWlnaHQoKSxzPWUuaXNOdW1iZXIodGhpcy5kaWFsb2cucGFyYW1zLm1pbkhlaWdodCk/dGhpcy5kaWFsb2cucGFyYW1zLm1pbkhlaWdodDowLG89dCh3aW5kb3cpLmhlaWdodCgpO3M8PXImJihyPj1vP24uY29udGVudEhlaWdodChvLXRoaXMuZGlhbG9nLiQoImgyIikub3V0ZXJIZWlnaHQoKS1uLiQoIi5vLWZvcm0tYnV0dG9uLWJhciIpLm91dGVySGVpZ2h0KCktKGkub3V0ZXJIZWlnaHQoITApLW4uJGVsLm91dGVySGVpZ2h0KCEwKSkpOm4uY29udGVudEhlaWdodChuLmNvbnRlbnRIZWlnaHQoKSsoby1yKS0oaS5vdXRlckhlaWdodCgpLXIpKSx0aGlzLmRpYWxvZy5yZXNpemUuYXBwbHkodGhpcy5kaWFsb2csYXJndW1lbnRzKSl9LGNsZWFyRXJyb3JzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZm9ybS5jbGVhckVycm9ycy5hcHBseSh0aGlzLmZvcm0sYXJndW1lbnRzKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoNSksaSgxNDcpLGkoMTc3KSxpKDE0NiksaSgyMDApLGkoMjMwKSxpKDE5OSksaSgyMzIpLGkoMjM0KSxpKDIyNSksaSgyMzMpLGkoMjM1KSxpKDIzNildLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhLGwsYyx1LGQsaCxwKXtmdW5jdGlvbiBmKHQpe2lmKCFfJiZ0aGlzLiRlbC5oYXNDbGFzcygiby1mb3JtLXNhdmluZyIpKXt2YXIgaT1lKHQuY3VycmVudFRhcmdldCk7aS5jc3MoImRpc3BsYXkiLCJub25lIik7dmFyIG49ZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludCh0LmNsaWVudFgsdC5jbGllbnRZKTtyZXR1cm4gaS5jc3MoImRpc3BsYXkiLCJibG9jayIpLHQudGFyZ2V0PW4sZShuKS50cmlnZ2VyKHQpLCExfX12YXIgbT0nXHQgICAge3sjaWYgaGFzUmVhZE1vZGV9fVx0ICAgICAgPGgyIGNsYXNzPSJvLWZvcm0tdGl0bGUtYmFyIiBkYXRhLXNlPSJvLWZvcm0tdGl0bGUtYmFyIj5cdCAgICAgICAge3t0aXRsZX19XHQgICAgICA8L2gyPlx0ICAgIHt7L2lmfX1cdCAgICA8ZGl2IGRhdGEtc2U9Im8tZm9ybS1jb250ZW50IiBjbGFzcz0iby1mb3JtLWNvbnRlbnQge3tsYXlvdXR9fSBjbGVhcmZpeCI+XHQgICAgICB7eyN1bmxlc3MgaGFzUmVhZE1vZGV9fVx0ICAgICAgICB7eyNpZiB0aXRsZX19XHQgICAgICAgICAgPGgyIGRhdGEtc2U9Im8tZm9ybS1oZWFkIiBjbGFzcz0ib2t0YS1mb3JtLXRpdGxlIG8tZm9ybS1oZWFkIj57e3RpdGxlfX08L2gyPlx0ICAgICAgICB7ey9pZn19XHQgICAgICB7ey91bmxlc3N9fVx0ICAgICAge3sjaWYgc3VidGl0bGV9fVx0ICAgICAgICA8cCBjbGFzcz0ib2t0YS1mb3JtLXN1YnRpdGxlIG8tZm9ybS1leHBsYWluIiBkYXRhLXNlPSJvLWZvcm0tZXhwbGFpbiI+e3tzdWJ0aXRsZX19PC9wPlx0ICAgICAge3svaWZ9fVx0ICAgICAgPGRpdiBjbGFzcz0iby1mb3JtLWVycm9yLWNvbnRhaW5lciIgZGF0YS1zZT0iby1mb3JtLWVycm9yLWNvbnRhaW5lciI+PC9kaXY+XHQgICAgICA8ZGl2IGNsYXNzPSJvLWZvcm0tZmllbGRzZXQtY29udGFpbmVyIiBkYXRhLXNlPSJvLWZvcm0tZmllbGRzZXQtY29udGFpbmVyIj48L2Rpdj5cdCAgICA8L2Rpdj5cdCAgJyxfPSJhdXRvIj09PWUoIjxkaXY+IikuY3NzKHsicG9pbnRlci1ldmVudHMiOiJhdXRvIn0pWzBdLnN0eWxlLnBvaW50ZXJFdmVudHMsZz17c3VibWl0OmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLl9fc2F2ZSgpfX07dC5lYWNoKFsiY2xpY2siLCJkYmxjbGljayIsIm1vdXNlZG93biIsIm1vdXNldXAiXSxmdW5jdGlvbih0KXtnW3QrIiAuby1mb3JtLWlucHV0Il09Zn0pO3ZhciB2PWZ1bmN0aW9uKGUpe2V8fChlPXt9KTt2YXIgaT1lJiZlLmNvbGxlY3Rpb258fHt9O3JldHVybnttZXRob2Q6IlBPU1QiLGFjdGlvbjp0LnJlc3VsdChlLCJ1cmxSb290Iil8fHQucmVzdWx0KGksInVybCIpfHx3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUsImRhdGEtc2UiOiJvLWZvcm0ifX0seT1mdW5jdGlvbihlLGkpe2V8fChlPSIiKTt2YXIgbj1bXTtyZXR1cm4gdC5pc1N0cmluZyhlKSYmKG49ZS5zcGxpdCgiICIpKSxuPXQudW5pb24obixpKSxuLmpvaW4oIiAiKX07cmV0dXJuIHIuZXh0ZW5kKHtjb25zdHJ1Y3RvcjpmdW5jdGlvbihlKXtlfHwoZT17fSksdGhpcy5vcHRpb25zPWUsdGhpcy5pZD10LnVuaXF1ZUlkKCJmb3JtIiksdGhpcy50YWdOYW1lPSJmb3JtIix0LmRlZmF1bHRzKHRoaXMuZXZlbnRzLGcpLHQuZGVmYXVsdHModGhpcy5hdHRyaWJ1dGVzLHYoZS5tb2RlbCkpLHRoaXMuX19idXR0b25zPVtdLHRoaXMuX19lcnJvckZpZWxkcz17fSx0aGlzLl9fc2F2ZU1vZGVsU3RhdGUoZS5tb2RlbCksdGhpcy5zdGVwJiYodGhpcy5zYXZlfHwodGhpcy5zYXZlPXRoaXMudG90YWxTdGVwcyYmdGhpcy5zdGVwIT09dGhpcy50b3RhbFN0ZXBzPyJOZXh0IjoiRmluaXNoIiksdGhpcy5jbGFzc05hbWUrPSIgd2l6YXJkIiksdGhpcy5jbGFzc05hbWUrPSIgby1mb3JtIix0aGlzLl9fdG9vbGJhcj10aGlzLl9fY3JlYXRlVG9vbGJhcihlKSxyLmNhbGwodGhpcyxlKSx0LmVhY2godC5yZXN1bHQodGhpcywiaW5wdXRzIil8fFtdLGZ1bmN0aW9uKHQpe3RoaXMuX19hZGRMYXlvdXRJdGVtKHQpfSx0aGlzKSx0aGlzLmFkZCh0aGlzLl9fdG9vbGJhciwiIiksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJjaGFuZ2U6X19lZGl0X18iLHRoaXMuX19hcHBseU1vZGUpLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiaW52YWxpZCBlcnJvciIsdC50aHJvdHRsZShmdW5jdGlvbih0LGUsaSl7dGhpcy5fX3Nob3dFcnJvcnModCxlLGkhPT0hMSl9LDEwMCx7dHJhaWxpbmc6ITF9KSksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJmb3JtOnJlc2l6ZSIsZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXIoInJlc2l6ZSIpfSksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJmb3JtOmNhbmNlbCIsdC50aHJvdHRsZSh0aGlzLl9fY2FuY2VsLDEwMCx7dHJhaWxpbmc6ITF9KSksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJmb3JtOnByZXZpb3VzIix0LnRocm90dGxlKHRoaXMuX19wcmV2aW91cywxMDAse3RyYWlsaW5nOiExfSkpLHRoaXMuX19zYXZlPXQudGhyb3R0bGUodGhpcy5fX3NhdmUsMjAwLHt0cmFpbGluZzohMX0pLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZm9ybTpzYXZlIixmdW5jdGlvbigpe3RoaXMuJGVsLnN1Ym1pdCgpfSksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJzeW5jIixmdW5jdGlvbigpe3RoaXMubW9kZWwuZ2V0KCJfX2VkaXRfXyIpJiZ0aGlzLm1vZGVsLnNldCgiX19lZGl0X18iLCExLHtzaWxlbnQ6ITB9KSx0aGlzLl9fc2F2ZU1vZGVsU3RhdGUodGhpcy5tb2RlbCksdGhpcy5yZW5kZXIoKX0pO3ZhciBpPXRoaXMuZ2V0QXR0cmlidXRlKCJoYXNTYXZpbmdTdGF0ZSIpO2lmKHRoaXMuZ2V0QXR0cmlidXRlKCJhdXRvU2F2ZSIpJiYodGhpcy5saXN0ZW5Ubyh0aGlzLCJzYXZlIixmdW5jdGlvbihlKXt2YXIgaT1lLnNhdmUoKTtpJiZpLmRvbmUmJmkuZG9uZSh0LmJpbmQoZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXIoInNhdmVkIixlKX0sdGhpcykpfSksdC5pc1VuZGVmaW5lZChpKSYmKGk9ITApKSxpKXt2YXIgbj10aGlzLmdldEF0dHJpYnV0ZSgiY3VzdG9tU2F2aW5nU3RhdGUiLHt9KTt0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwseShuLnN0YXJ0fHwiIixbInJlcXVlc3QiXSksdGhpcy5fX3NldFNhdmluZ1N0YXRlKSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwseShuLnN0b3B8fCIiLFsiZXJyb3IiLCJzeW5jIl0pLHRoaXMuX19jbGVhclNhdmluZ1N0YXRlKX19LF9fY3JlYXRlVG9vbGJhcjpmdW5jdGlvbihlKXt2YXIgaT10aGlzLmdldEF0dHJpYnV0ZSgiZGFuZ2VyIikscj1pPT09ITA/ImJ1dHRvbi1lcnJvciI6ImJ1dHRvbi1wcmltYXJ5IixzPW5ldyBwKHQuZXh0ZW5kKHtzYXZlOnRoaXMuc2F2ZXx8bi5sb2NhbGl6ZSgib2Zvcm0uc2F2ZSIpLHNhdmVJZDp0aGlzLnNhdmVJZCxzYXZlQ2xhc3NOYW1lOnIsY2FuY2VsOnRoaXMuY2FuY2VsfHxuLmxvY2FsaXplKCJvZm9ybS5jYW5jZWwiKSxub0NhbmNlbEJ1dHRvbjp0aGlzLm5vQ2FuY2VsQnV0dG9ufHwhMSxoYXNQcmV2U3RlcDp0aGlzLnN0ZXAmJnRoaXMuc3RlcD4xfSxlfHx0aGlzLm9wdGlvbnMpKTtyZXR1cm4gdC5lYWNoKHRoaXMuX19idXR0b25zLGZ1bmN0aW9uKHQpe3MuYWRkQnV0dG9uLmFwcGx5KHMsdCl9KSxzfSxjbGFzc05hbWU6IiIsYXR0cmlidXRlczp7fSxldmVudHM6e30saW5wdXRzOltdLHRlbXBsYXRlOm51bGwscmVhZDohMSxyZWFkT25seTohMSxub0J1dHRvbkJhcjohMSxub0NhbmNlbEJ1dHRvbjohMSxzYXZlOm51bGwsY2FuY2VsOm51bGwsZGFuZ2VyOiExLGxheW91dDoiIixzdGVwOnZvaWQgMCx0b3RhbFN0ZXBzOnZvaWQgMCx0aXRsZTpudWxsLHN1YnRpdGxlOm51bGwsYXV0b1NhdmU6ITEsc2Nyb2xsT25FcnJvcjohMCxzaG93RXJyb3JzOiEwLHJlc2l6ZVNlbGVjdG9yOiIuby1mb3JtLWNvbnRlbnQiLGdldEF0dHJpYnV0ZTpmdW5jdGlvbihlLGkpe3ZhciBuPXQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucyxlLHRoaXMpO3JldHVybiB0LmlzVW5kZWZpbmVkKG4pJiYobj10LnJlc3VsdCh0aGlzLGUpKSx0LmlzVW5kZWZpbmVkKG4pP2k6bn0saGFzUmVhZE1vZGU6ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuZ2V0QXR0cmlidXRlKCJyZWFkIik7Cgl9LGlzUmVhZE9ubHk6ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuZ2V0QXR0cmlidXRlKCJyZWFkT25seSIpfSxoYXNCdXR0b25CYXI6ZnVuY3Rpb24oKXtyZXR1cm4hKHRoaXMuZ2V0QXR0cmlidXRlKCJub0J1dHRvbkJhciIpfHx0aGlzLmlzUmVhZE9ubHkoKSl9LHJlbmRlcjpmdW5jdGlvbigpe2lmKHRoaXMuX19yZWFkTW9kZUJhciYmdGhpcy5fX3JlYWRNb2RlQmFyLnJlbW92ZSgpLHRoaXMuaGFzUmVhZE1vZGUoKSYmIXRoaXMuaXNSZWFkT25seSgpKXt2YXIgdD1oLmV4dGVuZCh7Zm9ybVRpdGxlOnRoaXMuZ2V0QXR0cmlidXRlKCJ0aXRsZSIsIiIpfSk7dGhpcy5fX3JlYWRNb2RlQmFyPXRoaXMuYWRkKHQsIi5vLWZvcm0tdGl0bGUtYmFyIikubGFzdCgpfXZhciBlPWkudHBsKG0pKHtsYXlvdXQ6dGhpcy5nZXRBdHRyaWJ1dGUoImxheW91dCIsIiIpLHRpdGxlOnRoaXMuZ2V0QXR0cmlidXRlKCJ0aXRsZSIsIiIsITApLHN1YnRpdGxlOnRoaXMuZ2V0QXR0cmlidXRlKCJzdWJ0aXRsZSIsIiIsITApLGhhc1JlYWRNb2RlOnRoaXMuaGFzUmVhZE1vZGUoKX0pO3JldHVybiB0aGlzLiRlbC5odG1sKGUpLGRlbGV0ZSB0aGlzLnRlbXBsYXRlLHIucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5fX2FwcGx5TW9kZSgpLHRoaXN9LF9fc2V0U2F2aW5nU3RhdGU6ZnVuY3Rpb24oKXt0aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06c2V0LXNhdmluZy1zdGF0ZSIpLHRoaXMuJGVsLmFkZENsYXNzKCJvLWZvcm0tc2F2aW5nIil9LF9fY2xlYXJTYXZpbmdTdGF0ZTpmdW5jdGlvbigpe3RoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpjbGVhci1zYXZpbmctc3RhdGUiKSx0aGlzLiRlbC5yZW1vdmVDbGFzcygiby1mb3JtLXNhdmluZyIpfSxfX3RvZ2dsZVRvb2xiYXI6ZnVuY3Rpb24oKXt0aGlzLl9fdG9vbGJhciYmdGhpcy5fX3Rvb2xiYXIucmVtb3ZlKCksdGhpcy5oYXNCdXR0b25CYXIoKSYmdGhpcy5fZWRpdE1vZGUoKSYmKHRoaXMuX190b29sYmFyPXRoaXMuX19jcmVhdGVUb29sYmFyKCksdGhpcy5hZGQodGhpcy5fX3Rvb2xiYXIsIiIpKSx0aGlzLnRyaWdnZXIoInJlc2l6ZSIpfSxfX2NhbmNlbDpmdW5jdGlvbigpe3ZhciBlPXRoaXMubW9kZWwuZ2V0KCJfX2VkaXRfXyIpO3RoaXMubW9kZWwuY2xlYXIoe3NpbGVudDohMH0pO3ZhciBpO2k9dGhpcy5tb2RlbC5zYW5pdGl6ZUF0dHJpYnV0ZXM/dGhpcy5tb2RlbC5zYW5pdGl6ZUF0dHJpYnV0ZXModGhpcy5fX29yaWdpbmFsTW9kZWwpOnQuY2xvbmUodGhpcy5fX29yaWdpbmFsTW9kZWwpLHRoaXMubW9kZWwuc2V0KGkse3NpbGVudDohMH0pLHRoaXMudHJpZ2dlcigiY2FuY2VsIix0aGlzLm1vZGVsKSx0aGlzLm1vZGVsLnRyaWdnZXIoImNhY2hlOmNsZWFyIiksZSYmKHRoaXMubW9kZWwuc2V0KCJfX2VkaXRfXyIsITEse3NpbGVudDohMH0pLHRoaXMubW9kZWwudHJpZ2dlcigiY2hhbmdlOl9fZWRpdF9fIix0aGlzLm1vZGVsLCExKSksdGhpcy5jbGVhckVycm9ycygpfSxpc1ZhbGlkOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXtyZXR1cm4gdC5yZWR1Y2UoZSxmdW5jdGlvbihlLGkpe3JldHVybiB0LmV4dGVuZChlLG4ubW9kZWwudmFsaWRhdGVGaWVsZChpKSl9LHt9KX12YXIgaSxuPXRoaXM7cmV0dXJuIHQuaXNVbmRlZmluZWQodGhpcy52YWxpZGF0ZSk/dGhpcy5tb2RlbC5pc1ZhbGlkKCk6KHQuaXNGdW5jdGlvbih0aGlzLnZhbGlkYXRlKT9pPXRoaXMudmFsaWRhdGUoKTp0LmlzQXJyYXkodGhpcy52YWxpZGF0ZSk/aT1lKHRoaXMudmFsaWRhdGUpOiJsb2NhbCI9PT10aGlzLnZhbGlkYXRlJiYoaT1lKHRoaXMuZ2V0SW5wdXRzKCkubWFwKGZ1bmN0aW9uKHQpe3JldHVybiB0Lm9wdGlvbnMubmFtZX0pKSksISF0LmlzRW1wdHkoaSl8fCh0aGlzLm1vZGVsLnRyaWdnZXIoImludmFsaWQiLHRoaXMubW9kZWwsaSksITEpKX0sX19zYXZlOmZ1bmN0aW9uKCl7dGhpcy5jbGVhckVycm9ycygpLHRoaXMuaXNWYWxpZCgpJiZ0aGlzLnRyaWdnZXIoInNhdmUiLHRoaXMubW9kZWwpfSxfX3ByZXZpb3VzOmZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyKCJwcmV2aW91cyIsdGhpcy5tb2RlbCl9LF9fYXBwbHlNb2RlOmZ1bmN0aW9uKCl7dGhpcy5jbGVhckVycm9ycygpLHRoaXMuX190b2dnbGVUb29sYmFyKCksdGhpcy5fZWRpdE1vZGUoKT8odGhpcy4kZWwuYWRkQ2xhc3MoIm8tZm9ybS1lZGl0LW1vZGUiKSx0aGlzLiRlbC5yZW1vdmVDbGFzcygiby1mb3JtLXJlYWQtbW9kZSIpLHRoaXMuJCgiLm8tZm9ybS1jb250ZW50IikucmVtb3ZlQ2xhc3MoInJvdW5kZWQtYnRtLTQiKSx0aGlzLmZvY3VzKCkpOih0aGlzLiRlbC5yZW1vdmVDbGFzcygiby1mb3JtLWVkaXQtbW9kZSIpLHRoaXMuJGVsLmFkZENsYXNzKCJvLWZvcm0tcmVhZC1tb2RlIiksdGhpcy4kKCIuby1mb3JtLWNvbnRlbnQiKS5hZGRDbGFzcygicm91bmRlZC1idG0tNCIpKX0sX2VkaXRNb2RlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJfX2VkaXRfXyIpfHwhdGhpcy5oYXNSZWFkTW9kZSgpfSxwYXJzZUVycm9yTWVzc2FnZTp0LmlkZW50aXR5LF9fc2hvd0Vycm9yczpmdW5jdGlvbihpLHIscyl7aWYodGhpcy50cmlnZ2VyKCJlcnJvciIsaSksdGhpcy5nZXRBdHRyaWJ1dGUoInNob3dFcnJvcnMiKSl7dmFyIG8sYT11LnBhcnNlRmllbGRFcnJvcnMocik7aWYodC5zaXplKGEpKXQuZWFjaChhLGZ1bmN0aW9uKGUsaSl7dGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOmZpZWxkLWVycm9yIix0aGlzLl9fZXJyb3JGaWVsZHNbaV18fGksdC5tYXAoZSxmdW5jdGlvbih0KXtyZXR1cm4vXm1vZGVsXC52YWxpZGF0aW9uLy50ZXN0KHQpP24ubG9jYWxpemUodCk6dH0pKX0sdGhpcyk7ZWxzZXt2YXIgbD11LmdldFJlc3BvbnNlSlNPTihyKTtsPXRoaXMucGFyc2VFcnJvck1lc3NhZ2UobCksbz1sJiZsLmVycm9yU3VtbWFyeX1pZihzJiYodGhpcy4kKCIuby1mb3JtLWVycm9yLWNvbnRhaW5lciIpLmFkZENsYXNzKCJvLWZvcm0taGFzLWVycm9ycyIpLHRoaXMuYWRkKGMsIi5vLWZvcm0tZXJyb3ItY29udGFpbmVyIix7b3B0aW9uczp7ZXJyb3JTdW1tYXJ5Om99fSkpLHRoaXMuZ2V0QXR0cmlidXRlKCJzY3JvbGxPbkVycm9yIikpe3ZhciBkPWUoIiMiK3RoaXMuaWQrIiAuby1mb3JtLWVycm9yLWNvbnRhaW5lciIpO2QubGVuZ3RoJiZlKCJodG1sLCBib2R5IikuYW5pbWF0ZSh7c2Nyb2xsVG9wOmQub2Zmc2V0KCkudG9wfSw0MDApfXRoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpyZXNpemUiKX19LGNsZWFyRXJyb3JzOmZ1bmN0aW9uKCl7dGhpcy4kKCIuby1mb3JtLWVycm9yLWNvbnRhaW5lciIpLnJlbW92ZUNsYXNzKCJvLWZvcm0taGFzLWVycm9ycyIpLHRoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpjbGVhci1lcnJvcnMiKSx0aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06cmVzaXplIil9LHRvZ2dsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1vZGVsLnNldCgiX19lZGl0X18iLCF0aGlzLmhhc1JlYWRNb2RlKCl8fCF0aGlzLm1vZGVsLmdldCgiX19lZGl0X18iKSksdGhpc30sX19hZGRMYXlvdXRJdGVtOmZ1bmN0aW9uKHQpe3Muc3VwcG9ydHModCk/dGhpcy5hZGRJbnB1dCh0KTp0aGlzLl9fYWRkTm9uSW5wdXRMYXlvdXRJdGVtKHQpfSxfX2FkZE5vbklucHV0TGF5b3V0SXRlbTpmdW5jdGlvbihlKXt2YXIgaT10Lm9taXQoZSwidHlwZSIpO3N3aXRjaChlLnR5cGUpe2Nhc2Uic2VjdGlvblRpdGxlIjp0aGlzLmFkZFNlY3Rpb25UaXRsZShlLnRpdGxlLHQub21pdChpLCJ0aXRsZSIpKTticmVhaztjYXNlImRpdmlkZXIiOnRoaXMuYWRkRGl2aWRlcihpKTticmVhaztkZWZhdWx0OnRocm93IG5ldyBFcnJvcigidW5rbm93biBpbnB1dDogIitlLnR5cGUpfX0sYWRkQnV0dG9uOmZ1bmN0aW9uKHQsZSl7dGhpcy5fX3Rvb2xiYXImJnRoaXMuX190b29sYmFyLmFkZEJ1dHRvbih0LGUpLHRoaXMuX19idXR0b25zLnB1c2goW3QsZV0pfSxhZGREaXZpZGVyOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmFkZCgnPGRpdiBjbGFzcz0ib2t0YS1mb3JtLWRpdmlkZXIgZm9ybS1kaXZpZGVyIj48L2Rpdj4nKSxkLmFwcGx5U2hvd1doZW4odGhpcy5sYXN0KCksdCYmdC5zaG93V2hlbiksdGhpc30sYWRkU2VjdGlvblRpdGxlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuYWRkKGkudHBsKCc8aDIgY2xhc3M9Im8tZm9ybS1oZWFkIj57e3RpdGxlfX08L2gyPicpKHt0aXRsZTp0fSkpLGQuYXBwbHlTaG93V2hlbih0aGlzLmxhc3QoKSxlJiZlLnNob3dXaGVuKSx0aGlzfSxhZGRJbnB1dDpmdW5jdGlvbihlKXtlPXQuY2xvbmUoZSksZC52YWxpZGF0ZUlucHV0KGUsdGhpcy5tb2RlbCk7dmFyIGk9ZC5nZW5lcmF0ZUlucHV0T3B0aW9ucyhlLHRoaXMsdGhpcy5fX2NyZWF0ZUlucHV0KS5yZXZlcnNlKCk7dC5pc0VtcHR5KHRoaXMuZ2V0SW5wdXRzKCkudG9BcnJheSgpKSYmdC5leHRlbmQoaVswXSx7dmFsaWRhdGVPbmx5SWZEaXJ0eTohMH0pO3ZhciBuPXQubWFwKGksdGhpcy5fX2NyZWF0ZUlucHV0LHRoaXMpO3QuZWFjaChpLGZ1bmN0aW9uKHQpe3QuZXJyb3JGaWVsZCYmKHRoaXMuX19lcnJvckZpZWxkc1t0LmVycm9yRmllbGRdPXQubmFtZSl9LHRoaXMpO3ZhciByPXtpbnB1dElkOnQubGFzdChuKS5vcHRpb25zLmlucHV0SWQsaW5wdXQ6bixtdWx0aTppLmxlbmd0aD4xP2kubGVuZ3RoOnZvaWQgMH07dC5leHRlbmQocix0Lm9taXQodGhpcy5vcHRpb25zLCJpbnB1dCIpLHQub21pdChlLCJpbnB1dCIpKTt2YXIgcz10aGlzLl9fY3JlYXRlV3JhcHBlcihyKTtyLmxhYmVsIT09ITEmJnMuYWRkKHRoaXMuX19jcmVhdGVMYWJlbChyKSkscy5hZGQodGhpcy5fY3JlYXRlQ29udGFpbmVyKHIpKSxzLnR5cGU9ci50eXBlfHxyLmlucHV0LnR5cGV8fCJjdXN0b20iO3ZhciBvPVtzXS5jb25jYXQodC5kcm9wKGFyZ3VtZW50cywxKSk7cmV0dXJuIHRoaXMuYWRkLmFwcGx5KHRoaXMsbyl9LF9fY3JlYXRlSW5wdXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIGU9dC5waWNrKGUsZC5JTlBVVF9PUFRJT05TKSxzLmNyZWF0ZShlKX0sX19jcmVhdGVXcmFwcGVyOmZ1bmN0aW9uKGUpe3JldHVybiBlPXQucGljayhlLGQuV1JBUFBFUl9PUFRJT05TKSxuZXcgbChlKX0sX19jcmVhdGVMYWJlbDpmdW5jdGlvbihlKXtyZXR1cm4gZT10LnBpY2soZSxkLkxBQkVMX09QVElPTlMpLG5ldyBvKGUpfSxfY3JlYXRlQ29udGFpbmVyOmZ1bmN0aW9uKGUpe3JldHVybiBlPXQucGljayhlLGQuQ09OVEFJTkVSX09QVElPTlMpLG5ldyBhKGUpfSxfX3NhdmVNb2RlbFN0YXRlOmZ1bmN0aW9uKHQpe3RoaXMuX19vcmlnaW5hbE1vZGVsPXQuY2xvbmUoKS5hdHRyaWJ1dGVzfSxhZGQ6ZnVuY3Rpb24oKXt2YXIgZT10LnRvQXJyYXkoYXJndW1lbnRzKTtyZXR1cm4idW5kZWZpbmVkIj09dHlwZW9mIGVbMV0mJihlWzFdPSI+IGRpdi5vLWZvcm0tY29udGVudCA+IC5vLWZvcm0tZmllbGRzZXQtY29udGFpbmVyIiksci5wcm90b3R5cGUuYWRkLmFwcGx5KHRoaXMsZSl9LGZvY3VzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRJbnB1dHMoKS5maXJzdCgpO3JldHVybiB0JiZ0LmZvY3VzJiZ0LmZvY3VzKCksdGhpc30sZGlzYWJsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmludm9rZSgiZGlzYWJsZSIpLHRoaXN9LGVuYWJsZTpmdW5jdGlvbigpe3RoaXMuaW52b2tlKCJlbmFibGUiKX0sY29udGVudEhlaWdodDpmdW5jdGlvbihlKXt2YXIgaT10aGlzLiQoIi5vLWZvcm0tY29udGVudCIpO3JldHVybiB0LmlzTnVtYmVyKGUpP3ZvaWQgaS5jc3MoIm1heC1oZWlnaHQiLGUpOmkuaGVpZ2h0KCl9LGdldElucHV0czpmdW5jdGlvbigpe3JldHVybiB0KHRoaXMuZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiB0IGluc3RhbmNlb2YgbH0pKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ3KSxpKDE0NCksaSgxNDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe2Z1bmN0aW9uIHIodCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBufHx0LnByb3RvdHlwZSBpbnN0YW5jZW9mIG59cmV0dXJuIG4uZXh0ZW5kKHthdHRyaWJ1dGVzOmZ1bmN0aW9uKCl7cmV0dXJueyJkYXRhLXNlIjoiby1mb3JtLWlucHV0LWNvbnRhaW5lciJ9fSxjbGFzc05hbWU6ZnVuY3Rpb24oKXt2YXIgZT0iby1mb3JtLWlucHV0IjtpZih0aGlzLm9wdGlvbnMud2lkZSYmKGUrPSIgby1mb3JtLXdpZGUiKSx0LmNvbnRhaW5zKFsxLDIsMyw0XSx0aGlzLm9wdGlvbnMubXVsdGkpJiYoZSs9IiBvLWZvcm0tbXVsdGktaW5wdXQtIit0aGlzLm9wdGlvbnMubXVsdGksdC5pc0FycmF5KHRoaXMub3B0aW9ucy5pbnB1dCkpKXt2YXIgaT10LmZpbmQodGhpcy5vcHRpb25zLmlucHV0LGZ1bmN0aW9uKGUpe3JldHVybiB0LmNvbnRhaW5zKFsidGV4dCtzZWxlY3QiLCJzZWxlY3QrdGV4dCJdLGUub3B0aW9ucy50eXBlKX0pO2kmJihlKz0iIG8tZm9ybS1tdWx0aS1pbnB1dC1ncm91cC0iK3RoaXMub3B0aW9ucy5tdWx0aSl9cmV0dXJuIGV9LF9nZXROYW1lczpmdW5jdGlvbigpe3ZhciBlPXQuaXNBcnJheSh0aGlzLm9wdGlvbnMubmFtZSk/dGhpcy5vcHRpb25zLm5hbWU6W3RoaXMub3B0aW9ucy5uYW1lXTtyZXR1cm4iZ3JvdXAiPT10aGlzLm9wdGlvbnMudHlwZT9lLnB1c2guYXBwbHkoZSx0LnBsdWNrKHRoaXMub3B0aW9ucy5pbnB1dFswXS5vcHRpb25zLnBhcmFtcy5pbnB1dHMsIm5hbWUiKSk6dC5pc0FycmF5KHRoaXMub3B0aW9ucy5uYW1lKT90aGlzLm9wdGlvbnMuaW5wdXQmJnRoaXMub3B0aW9ucy5pbnB1dC5vcHRpb25zJiZ0aGlzLm9wdGlvbnMuaW5wdXQub3B0aW9ucy5uYW1lJiZlLnB1c2godGhpcy5vcHRpb25zLmlucHV0Lm9wdGlvbnMubmFtZSk6dGhpcy5vcHRpb25zLmlucHV0JiYodC5pc0FycmF5KHRoaXMub3B0aW9ucy5pbnB1dCk/dC5lYWNoKHRoaXMub3B0aW9ucy5pbnB1dCxmdW5jdGlvbih0KXtlLnB1c2godC5vcHRpb25zLm5hbWUpfSk6ZS5wdXNoKHRoaXMub3B0aW9ucy5pbnB1dC5vcHRpb25zLm5hbWUpKSx0LnVuaXEodC5jb21wYWN0KGUpKX0sY29uc3RydWN0b3I6ZnVuY3Rpb24oKXtuLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLm9wdGlvbnMuaW5wdXQmJih0LmlzQXJyYXkodGhpcy5vcHRpb25zLmlucHV0KT90LmVhY2godGhpcy5vcHRpb25zLmlucHV0LGZ1bmN0aW9uKHQpe3RoaXMuYWRkKHQse3ByZXBlbmQ6ITB9KX0sdGhpcyk6dGhpcy5hZGQodGhpcy5vcHRpb25zLmlucHV0LHtwcmVwZW5kOiEwfSkpLHRoaXMuX19zZXRFeHBsYWluKHRoaXMub3B0aW9ucyk7dmFyIGU9dGhpcy5fZ2V0TmFtZXMoKTt0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImZvcm06ZmllbGQtZXJyb3IiLGZ1bmN0aW9uKGksbil7dC5jb250YWlucyhlLGkpJiZ0aGlzLl9fc2V0RXJyb3Iobil9KSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImZvcm06Y2xlYXItZXJyb3JzIGNoYW5nZToiK2Uuam9pbigiIGNoYW5nZToiKSx0aGlzLl9fY2xlYXJFcnJvciksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJmb3JtOmNsZWFyLWVycm9yOiIrZS5qb2luKCIgZm9ybTpjbGVhci1lcnJvcjoiKSx0aGlzLl9fY2xlYXJFcnJvciksdC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLCJhdXRvUmVuZGVyIix0aGlzKSYmdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJjaGFuZ2U6Iit0aGlzLm9wdGlvbnMubmFtZSx0aGlzLnJlbmRlciksdGhpcy5fX2Vycm9yU3RhdGU9ITF9LF9fc2V0RXhwbGFpbjpmdW5jdGlvbihlKXt2YXIgbjtyZXR1cm4gZS5jdXN0b21FeHBsYWluPyhpLndhcm4oIkRlcHJlY2F0ZWQgLSB1c2UgZXhwbGFpbiBpbnN0ZWFkIG9mIGN1c3RvbUV4cGxhaW4iKSx2b2lkIHRoaXMuYWRkKHRoaXMub3B0aW9ucy5jdXN0b21FeHBsYWluKSk6KG49ZS5leHBsYWluLHQuaXNGdW5jdGlvbihuKSYmIXIobikmJihuPXQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucywiZXhwbGFpbiIsdGhpcykpLHZvaWQobiYmKHIobik/KHRoaXMudGVtcGxhdGU9JzxwIGNsYXNzPSJvLWZvcm0tZXhwbGFpbiI+PC9wPicsdGhpcy5hZGQobiwiLm8tZm9ybS1leHBsYWluIikpOnRoaXMudGVtcGxhdGU9JzxwIGNsYXNzPSJvLWZvcm0tZXhwbGFpbiI+e3tleHBsYWlufX08L3A+JykpKX0sX19zZXRFcnJvcjpmdW5jdGlvbih0KXt0aGlzLl9fZXJyb3JTdGF0ZT0hMCx0aGlzLiRlbC5hZGRDbGFzcygiby1mb3JtLWhhcy1lcnJvcnMiKTt2YXIgaT1bJzxwIGNsYXNzPSJva3RhLWZvcm0taW5wdXQtZXJyb3Igby1mb3JtLWlucHV0LWVycm9yIG8tZm9ybS1leHBsYWluIiByb2xlPSJhbGVydCI+JywnPHNwYW4gY2xhc3M9Imljb24gaWNvbi0xNiBlcnJvci0xNi1zbWFsbCI+PC9zcGFuPicsInt7dGV4dH19IiwiPC9wPiJdLmpvaW4oIiIpLG49ZS50cGwoaSkoe3RleHQ6dC5qb2luKCIsICIpfSkscj10aGlzLiQoIi5vLWZvcm0tZXhwbGFpbiIpLm5vdCgiLm8tZm9ybS1pbnB1dC1lcnJvciIpLmZpcnN0KCk7ci5sZW5ndGg/ci5iZWZvcmUobik6dGhpcy4kZWwuYXBwZW5kKG4pfSxfX2NsZWFyRXJyb3I6ZnVuY3Rpb24oKXt0aGlzLl9fZXJyb3JTdGF0ZSYmKHRoaXMuJCgiLm8tZm9ybS1pbnB1dC1lcnJvciIpLnJlbW92ZSgpLHRoaXMuJGVsLnJlbW92ZUNsYXNzKCJvLWZvcm0taGFzLWVycm9ycyIpLHRoaXMuX19lcnJvclN0YXRlPSExLHQuZGVmZXIodC5iaW5kKGZ1bmN0aW9uKCl7dGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOnJlc2l6ZSIpfSx0aGlzKSkpfSxmb2N1czpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24odCl7aWYodC5mb2N1cylyZXR1cm4gdC5mb2N1cygpfSksdGhpc319KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMjAzKSxpKDIwMiksaSgyMDUpLGkoMjA2KSxpKDIwOCksaSgyMTApLGkoMjExKSxpKDIxMiksaSgyMTMpLGkoMjE0KSxpKDIxNSksaSgyMDEpLGkoMjE2KSxpKDIxNyksaSgyMTgpLGkoMjE5KSxpKDIyMCksaSgyMjEpLGkoMjIyKSxpKDIyMyksaSgyMjgpLGkoMjI5KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvLGEsbCxjLHUsZCxoLHAsZixtLF8sZyx2LHksYix3LE0pe2Z1bmN0aW9uIGsoaSxuKXtyZXR1cm4gaS5wcm90b3R5cGUgaW5zdGFuY2VvZiBlP25ldyBpKHQub21pdChuLCJpbnB1dCIpKTppfWZ1bmN0aW9uIFQoZSl7aWYoZT10LmNsb25lKGUpLGUuaW5wdXQpcmV0dXJuIGsoZS5pbnB1dCxlKTt2YXIgaTtpZighTFtlLnR5cGVdKXRocm93IG5ldyBFcnJvcigidW5rbm93biBpbnB1dDogIitlLnR5cGUpO3JldHVybiBpPSJzZWxlY3QiPT1lLnR5cGUmJnQuc2l6ZShlLm9wdGlvbnMpPjFlMz9NOkxbZS50eXBlXSxrKGksZSl9ZnVuY3Rpb24gUyh0KXtyZXR1cm4hIXQuaW5wdXR8fHQudHlwZSBpbiBMfXZhciBMPXsiZmlsZS9pbWFnZSI6YiwiZmlsZS9jZXJ0Ijp3LHNlbGVjdDpyLHRleHRhcmVhOm4scmFkaW86cyxjaGVja2JveDpvLHRleHQ6aSxwYXNzd29yZDppLG51bWJlcjp1LHRleHRzZWxlY3Q6YSwidGV4dCtzZWxlY3QiOmwsInNlbGVjdCt0ZXh0IjpsLGRhdGU6Yyxncm91cHBpY2tlcjpkLHVzZXJwaWNrZXI6aCxhcHBwaWNrZXI6cCxhcHBpbnN0YW5jZXBpY2tlcjpmLCJzdS1vcmdzcGlja2VyIjptLHpvbmVwaWNrZXI6XyxsaXN0OmcsZ3JvdXA6dixjaGVja2JveHNldDp5fTtyZXR1cm57Y3JlYXRlOlQsc3VwcG9ydHM6U319LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTQ3KSxpKDIwMyksaSgxNzMpLGkoMjA0KV0scj1mdW5jdGlvbih0LGUsaSl7dmFyIG49Im9rdGEtZm9ybS1pbnB1dC1maWVsZCBpbnB1dC1maXgiO3JldHVybiBlLmV4dGVuZCh7dGVtcGxhdGU6dC50cGwoJzxpbnB1dCB0eXBlPSJ7e3R5cGV9fSIgcGxhY2Vob2xkZXI9Int7cGxhY2Vob2xkZXJ9fSJcdCAgICAgIG5hbWU9Int7bmFtZX19IiBpZD0ie3tpbnB1dElkfX0iIHZhbHVlPSJ7e3ZhbHVlfX0iLz4nKSxldmVudHM6eyJpbnB1dCBpbnB1dCI6InVwZGF0ZSIsImNoYW5nZSBpbnB1dCI6InVwZGF0ZSIsImtleWRvd24gaW5wdXQiOiJ1cGRhdGUiLCJrZXl1cCBpbnB1dCI6ZnVuY3Rpb24odCl7aS5pc0VudGVyKHQpP3RoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpzYXZlIik6aS5pc0VzYyh0KSYmdGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOmNhbmNlbCIpfX0sY29uc3RydWN0b3I6ZnVuY3Rpb24oKXtlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLiRlbC5hZGRDbGFzcygiby1mb3JtLWNvbnRyb2wiKX0sZWRpdE1vZGU6ZnVuY3Rpb24oKXt0aGlzLiRlbC5hZGRDbGFzcyhuKSxlLnByb3RvdHlwZS5lZGl0TW9kZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy4kKCJpbnB1dCIpLnBsYWNlaG9sZGVyKCl9LHJlYWRNb2RlOmZ1bmN0aW9uKCl7ZS5wcm90b3R5cGUucmVhZE1vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpLCJwYXNzd29yZCI9PXRoaXMub3B0aW9ucy50eXBlJiZ0aGlzLiRlbC50ZXh0KCIqKioqKioqKiIpLHRoaXMuJGVsLnJlbW92ZUNsYXNzKG4pfSx2YWw6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kKCdpbnB1dFt0eXBlPSInK3RoaXMub3B0aW9ucy50eXBlKyciXScpLnZhbCgpfSxmb2N1czpmdW5jdGlvbigpe3JldHVybiB0aGlzLiQoImlucHV0IikuZm9jdXMoKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ2KV0scj1mdW5jdGlvbih0LGUpe3JldHVybiBlLmV4dGVuZCh7dGFnTmFtZToic3BhbiIsYXR0cmlidXRlczpmdW5jdGlvbigpe3JldHVybnsiZGF0YS1zZSI6Im8tZm9ybS1pbnB1dC0iK3RoaXMuZ2V0TmFtZVN0cmluZygpfX0sZGVmYXVsdFBsYWNlaG9sZGVyOiIiLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKGkpe2k9dC5kZWZhdWx0cyhpfHx7fSx7aW5wdXRJZDppLmlkfHx0LnVuaXF1ZUlkKCJpbnB1dCIpLHBsYWNlaG9sZGVyOnRoaXMuZGVmYXVsdFBsYWNlaG9sZGVyLGlubGluZVZhbGlkYXRpb246ITAsdmFsaWRhdGVPbmx5SWZEaXJ0eTohMX0pLGRlbGV0ZSBpLmlkO3ZhciBuPXRoaXM7dC5lYWNoKHtlbmFibGU6InJlbW92ZUNsYXNzIixkaXNhYmxlOiJhZGRDbGFzcyJ9LGZ1bmN0aW9uKGUsaSl7bltpXT10LndyYXAobltpXSxmdW5jdGlvbih0KXt0LmFwcGx5KG4sYXJndW1lbnRzKSxuLiRlbFtlXSgiby1mb3JtLWRpc2FibGVkIil9KX0pLGUuY2FsbCh0aGlzLGkpLHQucmVzdWx0KGksInJlYWRPbmx5IikhPT0hMCYmdC5yZXN1bHQoaSwicmVhZCIpPT09ITAmJnRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiY2hhbmdlOl9fZWRpdF9fIix0aGlzLnJlbmRlciksdC5pc0Z1bmN0aW9uKHRoaXMuZm9jdXMpJiYodGhpcy5mb2N1cz10LmRlYm91bmNlKHQuYmluZCh0aGlzLmZvY3VzLHRoaXMpLDUwKSksdC5yZXN1bHQoaSwidmFsaWRhdGVPbmx5SWZEaXJ0eSIpfHx0aGlzLmFkZElubGluZVZhbGlkYXRpb24oKSx0aGlzLmFkZE1vZGVsTGlzdGVuZXJzKCksdGhpcy4kZWwuYWRkQ2xhc3MoIm8tZm9ybS1pbnB1dC1uYW1lLSIrdGhpcy5nZXROYW1lU3RyaW5nKCkpfSxhZGRJbmxpbmVWYWxpZGF0aW9uOmZ1bmN0aW9uKCl7dC5yZXN1bHQodGhpcy5vcHRpb25zLCJpbmxpbmVWYWxpZGF0aW9uIikmJnRoaXMuJGVsLm9uKCJmb2N1c291dCIsIjppbnB1dCIsdC5iaW5kKHRoaXMudmFsaWRhdGUsdGhpcykpfSx0b01vZGVsVmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnZhbCgpO3JldHVybiB0LmlzRnVuY3Rpb24odGhpcy50bykmJihlPXRoaXMudG8uY2FsbCh0aGlzLGUpKSx0LmlzRnVuY3Rpb24odGhpcy5vcHRpb25zLnRvKSYmKGU9dGhpcy5vcHRpb25zLnRvLmNhbGwodGhpcyxlKSksZX0sX2lzRWRpdGVkOiExLHVwZGF0ZTpmdW5jdGlvbigpeyF0aGlzLl9pc0VkaXRlZCYmdC5yZXN1bHQodGhpcy5vcHRpb25zLCJ2YWxpZGF0ZU9ubHlJZkRpcnR5IikmJih0aGlzLl9pc0VkaXRlZD0hMCx0aGlzLmFkZElubGluZVZhbGlkYXRpb24oKSksdGhpcy5tb2RlbC5zZXQodGhpcy5vcHRpb25zLm5hbWUsdGhpcy50b01vZGVsVmFsdWUoKSl9LGlzRWRpdE1vZGU6ZnVuY3Rpb24oKXt2YXIgZT0hdC5yZXN1bHQodGhpcy5vcHRpb25zLCJyZWFkT25seSIpJiYodC5yZXN1bHQodGhpcy5vcHRpb25zLCJyZWFkIikhPT0hMHx8dGhpcy5tb2RlbC5nZXQoIl9fZWRpdF9fIik9PT0hMCk7cmV0dXJuIGV9LHJlbmRlcjpmdW5jdGlvbigpe3RoaXMucHJlUmVuZGVyKCk7dmFyIGU9dGhpcy5vcHRpb25zLnBhcmFtcztyZXR1cm4gdGhpcy5vcHRpb25zLnBhcmFtcz10LnJlc3VsdEN0eCh0aGlzLm9wdGlvbnMsInBhcmFtcyIsdGhpcyksdGhpcy5pc0VkaXRNb2RlKCk/KHRoaXMuZWRpdE1vZGUoKSx0LnJlc3VsdEN0eCh0aGlzLm9wdGlvbnMsImRpc2FibGVkIix0aGlzKT90aGlzLmRpc2FibGUoKTp0aGlzLmVuYWJsZSgpKTp0aGlzLnJlYWRNb2RlKCksdGhpcy5vcHRpb25zLnBhcmFtcz1lLHRoaXMucG9zdFJlbmRlcigpLHRoaXN9LHZhbGlkYXRlOmZ1bmN0aW9uKCl7aWYoIXRoaXMubW9kZWwuZ2V0KCJfX3BlbmRpbmdfXyIpJiZ0aGlzLmlzRWRpdE1vZGUoKSYmdC5pc0Z1bmN0aW9uKHRoaXMubW9kZWwudmFsaWRhdGVGaWVsZCkpe3ZhciBlPXRoaXMubW9kZWwudmFsaWRhdGVGaWVsZCh0aGlzLm9wdGlvbnMubmFtZSk7ZSYmdC5kZWxheShmdW5jdGlvbigpe3RoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpjbGVhci1lcnJvcjoiK3RoaXMub3B0aW9ucy5uYW1lKSx0aGlzLm1vZGVsLnRyaWdnZXIoImludmFsaWQiLHRoaXMubW9kZWwsZSwhMSl9LmJpbmQodGhpcyksMTAwKX19LGFkZE1vZGVsTGlzdGVuZXJzOmZ1bmN0aW9uKCl7dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJmb3JtOmZpZWxkLWVycm9yIixmdW5jdGlvbih0KXt0aGlzLm9wdGlvbnMubmFtZT09PXQmJnRoaXMuX19tYXJrRXJyb3IoKX0pLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZm9ybTpjbGVhci1lcnJvcnMgY2hhbmdlOiIrdGhpcy5vcHRpb25zLm5hbWUsdGhpcy5fX2NsZWFyRXJyb3IpLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZm9ybTpjbGVhci1lcnJvcjoiK3RoaXMub3B0aW9ucy5uYW1lLHRoaXMuX19jbGVhckVycm9yKX0sdmFsOmZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKCJ2YWwoKSBpcyBhbiBhYnN0cmFjdCBtZXRob2QiKX0sZm9jdXM6ZnVuY3Rpb24oKXt0aHJvdyBuZXcgRXJyb3IoImZvY3VzKCkgaXMgYW4gYWJzdHJhY3QgbWV0aG9kIil9LGRlZmF1bHRWYWx1ZTpmdW5jdGlvbigpe3JldHVybiIifSxlZGl0TW9kZTpmdW5jdGlvbigpe3ZhciBlPXQuZXh0ZW5kKHt9LHRoaXMub3B0aW9ucyx7dmFsdWU6dGhpcy5nZXRNb2RlbFZhbHVlKCl9KTtyZXR1cm4gdGhpcy4kZWwuaHRtbCh0aGlzLnRlbXBsYXRlKGUpKSx0aGlzLm9wdGlvbnMubXVsdGkmJnRoaXMuJGVsLnJlbW92ZUNsYXNzKCJtYXJnaW4tciIpLHRoaXN9LHJlYWRNb2RlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJGVsLnRleHQodGhpcy5nZXRSZWFkTW9kZVN0cmluZygpKSx0aGlzLiRlbC5yZW1vdmVDbGFzcygiZXJyb3ItZmllbGQiKSx0aGlzLm9wdGlvbnMubXVsdGkmJnRoaXMuJGVsLmFkZENsYXNzKCJtYXJnaW4tciIpLHRoaXN9LGdldFJlYWRNb2RlU3RyaW5nOmZ1bmN0aW9uKCl7dmFyIGU9dC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLCJyZWFkTW9kZVN0cmluZyIsdGhpcyk7cmV0dXJuIGU/ZTp0aGlzLnRvU3RyaW5nVmFsdWUoKX0sZ2V0TW9kZWxWYWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMubW9kZWwuZ2V0KHRoaXMub3B0aW9ucy5uYW1lKTtyZXR1cm4gdC5pc0Z1bmN0aW9uKHRoaXMuZnJvbSkmJihlPXRoaXMuZnJvbS5jYWxsKHRoaXMsZSkpLHQuaXNGdW5jdGlvbih0aGlzLm9wdGlvbnMuZnJvbSkmJihlPXRoaXMub3B0aW9ucy5mcm9tLmNhbGwodGhpcyxlKSksZX0sdG9TdHJpbmdWYWx1ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0TW9kZWxWYWx1ZSgpO3JldHVybiB0aGlzLm9wdGlvbnMub3B0aW9ucyYmKHQ9dGhpcy5vcHRpb25zLm9wdGlvbnNbdF0pLHR8fHRoaXMuZGVmYXVsdFZhbHVlKCl9LHJlc2l6ZTpmdW5jdGlvbigpe3RoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpyZXNpemUiKX0sZGlzYWJsZTpmdW5jdGlvbigpe3RoaXMuJCgiOmlucHV0IikucHJvcCgiZGlzYWJsZWQiLCEwKX0sZW5hYmxlOmZ1bmN0aW9uKCl7dGhpcy4kKCI6aW5wdXQiKS5wcm9wKCJkaXNhYmxlZCIsITEpfSxjaGFuZ2VUeXBlOmZ1bmN0aW9uKHQpe3RoaXMuJCgiOmlucHV0IikucHJvcCgidHlwZSIsdCksdGhpcy5vcHRpb25zLnR5cGU9dH0sZ2V0TmFtZVN0cmluZzpmdW5jdGlvbigpe3JldHVybiB0LmlzQXJyYXkodGhpcy5vcHRpb25zLm5hbWUpP3RoaXMub3B0aW9ucy5uYW1lLmpvaW4oIi0iKTp0aGlzLm9wdGlvbnMubmFtZX0sZ2V0UGFyYW1zOmZ1bmN0aW9uKGUpe3ZhciBpPWV8fHRoaXMub3B0aW9uc3x8e307cmV0dXJuIHQuY2xvbmUodC5yZXN1bHRDdHgoaSwicGFyYW1zIix0aGlzKXx8e30pfSxnZXRQYXJhbTpmdW5jdGlvbihlLGkpe3ZhciBuPXQucmVzdWx0Q3R4KHRoaXMuZ2V0UGFyYW1zKCksZSx0aGlzKTtyZXR1cm4gdC5pc1VuZGVmaW5lZChuKT9pOm59LGdldFBhcmFtT3JBdHRyaWJ1dGU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZ2V0UGFyYW0oZSl8fHQucmVzdWx0KHRoaXMsZSl9LF9fbWFya0Vycm9yOmZ1bmN0aW9uKCl7dGhpcy4kZWwuYWRkQ2xhc3MoIm8tZm9ybS1oYXMtZXJyb3JzIil9LF9fY2xlYXJFcnJvcjpmdW5jdGlvbigpe3RoaXMuJGVsLnJlbW92ZUNsYXNzKCJvLWZvcm0taGFzLWVycm9ycyIpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXsoZnVuY3Rpb24oKXt2YXIgdD1pKDYpOyFmdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gbih0KXt2YXIgZT17fSxuPS9ealF1ZXJ5XGQrJC87cmV0dXJuIGkuZWFjaCh0LmF0dHJpYnV0ZXMsZnVuY3Rpb24odCxpKXtpLnNwZWNpZmllZCYmIW4udGVzdChpLm5hbWUpJiYoZVtpLm5hbWVdPWkudmFsdWUpfSksZX1mdW5jdGlvbiByKHQsZSl7dmFyIG49dGhpcyxyPWkobik7aWYobi52YWx1ZT09ci5hdHRyKCJwbGFjZWhvbGRlciIpJiZyLmhhc0NsYXNzKCJwbGFjZWhvbGRlciIpKWlmKHIuZGF0YSgicGxhY2Vob2xkZXItcGFzc3dvcmQiKSl7aWYocj1yLmhpZGUoKS5uZXh0KCkuc2hvdygpLmF0dHIoImlkIixyLnJlbW92ZUF0dHIoImlkIikuZGF0YSgicGxhY2Vob2xkZXItaWQiKSksdD09PSEwKXJldHVybiByWzBdLnZhbHVlPWU7ci5mb2N1cygpfWVsc2Ugbi52YWx1ZT0iIixyLnJlbW92ZUNsYXNzKCJwbGFjZWhvbGRlciIpLG49PW8oKSYmbi5zZWxlY3QoKX1mdW5jdGlvbiBzKCl7dmFyIHQsZT10aGlzLHM9aShlKSxvPXRoaXMuaWQ7aWYoIiI9PWUudmFsdWUpe2lmKCJwYXNzd29yZCI9PWUudHlwZSl7aWYoIXMuZGF0YSgicGxhY2Vob2xkZXItdGV4dGlucHV0Iikpe3RyeXt0PXMuY2xvbmUoKS5hdHRyKHt0eXBlOiJ0ZXh0In0pfWNhdGNoKGEpe3Q9aSgiPGlucHV0PiIpLmF0dHIoaS5leHRlbmQobih0aGlzKSx7dHlwZToidGV4dCJ9KSl9dC5yZW1vdmVBdHRyKCJuYW1lIikuZGF0YSh7InBsYWNlaG9sZGVyLXBhc3N3b3JkIjpzLCJwbGFjZWhvbGRlci1pZCI6b30pLmJpbmQoImZvY3VzLnBsYWNlaG9sZGVyIixyKSxzLmRhdGEoeyJwbGFjZWhvbGRlci10ZXh0aW5wdXQiOnQsInBsYWNlaG9sZGVyLWlkIjpvfSkuYmVmb3JlKHQpfXM9cy5yZW1vdmVBdHRyKCJpZCIpLmhpZGUoKS5wcmV2KCkuYXR0cigiaWQiLG8pLnNob3coKX1zLmFkZENsYXNzKCJwbGFjZWhvbGRlciIpLHNbMF0udmFsdWU9cy5hdHRyKCJwbGFjZWhvbGRlciIpfWVsc2Ugcy5yZW1vdmVDbGFzcygicGxhY2Vob2xkZXIiKX1mdW5jdGlvbiBvKCl7dHJ5e3JldHVybiBlLmFjdGl2ZUVsZW1lbnR9Y2F0Y2godCl7fX12YXIgYSxsLGM9InBsYWNlaG9sZGVyImluIGUuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSx1PSJwbGFjZWhvbGRlciJpbiBlLmNyZWF0ZUVsZW1lbnQoInRleHRhcmVhIiksZD1pLmZuLGg9aS52YWxIb29rcyxwPWkucHJvcEhvb2tzO2MmJnU/KGw9ZC5wbGFjZWhvbGRlcj1mdW5jdGlvbigpe3JldHVybiB0aGlzfSxsLmlucHV0PWwudGV4dGFyZWE9ITApOihsPWQucGxhY2Vob2xkZXI9ZnVuY3Rpb24oKXt2YXIgdD10aGlzO3JldHVybiB0LmZpbHRlcigoYz8idGV4dGFyZWEiOiI6aW5wdXQiKSsiW3BsYWNlaG9sZGVyXSIpLm5vdCgiLnBsYWNlaG9sZGVyIikuYmluZCh7ImZvY3VzLnBsYWNlaG9sZGVyIjpyLCJibHVyLnBsYWNlaG9sZGVyIjpzfSkuZGF0YSgicGxhY2Vob2xkZXItZW5hYmxlZCIsITApLnRyaWdnZXIoImJsdXIucGxhY2Vob2xkZXIiKSx0fSxsLmlucHV0PWMsbC50ZXh0YXJlYT11LGE9e2dldDpmdW5jdGlvbih0KXt2YXIgZT1pKHQpLG49ZS5kYXRhKCJwbGFjZWhvbGRlci1wYXNzd29yZCIpO3JldHVybiBuP25bMF0udmFsdWU6ZS5kYXRhKCJwbGFjZWhvbGRlci1lbmFibGVkIikmJmUuaGFzQ2xhc3MoInBsYWNlaG9sZGVyIik/IiI6dC52YWx1ZX0sc2V0OmZ1bmN0aW9uKHQsZSl7dmFyIG49aSh0KSxhPW4uZGF0YSgicGxhY2Vob2xkZXItcGFzc3dvcmQiKTtyZXR1cm4gYT9hWzBdLnZhbHVlPWU6bi5kYXRhKCJwbGFjZWhvbGRlci1lbmFibGVkIik/KCIiPT1lPyh0LnZhbHVlPWUsdCE9bygpJiZzLmNhbGwodCkpOm4uaGFzQ2xhc3MoInBsYWNlaG9sZGVyIik/ci5jYWxsKHQsITAsZSl8fCh0LnZhbHVlPWUpOnQudmFsdWU9ZSxuKTp0LnZhbHVlPWV9fSxjfHwoaC5pbnB1dD1hLHAudmFsdWU9YSksdXx8KGgudGV4dGFyZWE9YSxwLnZhbHVlPWEpLGkoZnVuY3Rpb24oKXtpKGUpLmRlbGVnYXRlKCJmb3JtIiwic3VibWl0LnBsYWNlaG9sZGVyIixmdW5jdGlvbigpe3ZhciB0PWkoIi5wbGFjZWhvbGRlciIsdGhpcykuZWFjaChyKTtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dC5lYWNoKHMpfSwxMCl9KX0pLGkodCkuYmluZCgiYmVmb3JldW5sb2FkLnBsYWNlaG9sZGVyIixmdW5jdGlvbigpe2koIi5wbGFjZWhvbGRlciIpLmVhY2goZnVuY3Rpb24oKXt0aGlzLnZhbHVlPSIifSl9KSl9KHRoaXMsZG9jdW1lbnQsdCl9KS5jYWxsKHdpbmRvdyl9LGZ1bmN0aW9uKHQsZSl7fSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDUpLGkoMiksaSgxNzMpLGkoMTQ3KSxpKDIwMyksaSgyMDcpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7ZnVuY3Rpb24gcyh0KXtyZXR1cm4gdGhpcy5wYXJhbXMuYXV0b1dpZHRoP3QuY2FsbCh0aGlzKTplLmRlZmVyKGUuYmluZCh0LHRoaXMpKX1mdW5jdGlvbiBvKGUpe2UuJHNlbGVjdC5oaWRlKCk7dmFyIGk9dChlLiRzZWxlY3RbMF0pLmhpZGUoKTt0KCJib2R5IikuYXBwZW5kKGkpO3ZhciBuPWUucGFyYW1zLndpZHRoPTEuMippLndpZHRoKCkrInB4IjtyZXR1cm4gZS4kZWwuYXBwZW5kKGkuc2hvdygpKSxufWZ1bmN0aW9uIGEoZSxpLG4pe3ZhciByPW4ub2Zmc2V0KCk7ZS5jc3Moe2xlZnQ6ci5sZWZ0LHRvcDpyLnRvcH0pO3ZhciBzPXQod2luZG93KSxvPWkub3V0ZXJIZWlnaHQoKSxhPW8raS5vZmZzZXQoKS50b3Atcy5zY3JvbGxUb3AoKSxsPXMuaGVpZ2h0KCktZCxjPU1hdGgubWluKG8rbC1hLGgpO2kuY3NzKCJtYXgtaGVpZ2h0IixjKX1mdW5jdGlvbiBsKGkpe3ZhciBuPWkubmV4dCgiLmNoem4tY29udGFpbmVyIikscj1uLmNsb25lKCkscz1uLmZpbmQoIi5jaHpuLXJlc3VsdHMiKTtyLmNzcygidmlzaWJpbGl0eSIsImhpZGRlbiIpLHIucmVtb3ZlQXR0cigiaWQiKSxyLmZpbmQoImxpIikucmVtb3ZlQXR0cigiaWQiKTt2YXIgbz17bGVmdDpuLmNzcygibGVmdCIpLHRvcDpuLmNzcygidG9wIikscG9zaXRpb246bi5jc3MoInBvc2l0aW9uIiksImZsb2F0IjpuLmNzcygiZmxvYXQiKSwiei1pbmRleCI6bi5jc3MoInotaW5kZXgiKX07cy5oaWRlKCk7dmFyIGw9ZS5kZWJvdW5jZShmdW5jdGlvbigpe2EobixzLHIpfSwxMCk7aS5vbigibGlzenQ6c2hvd2luZ19kcm9wZG93biIsZnVuY3Rpb24oKXtuLndpZHRoKG4ud2lkdGgoKSksaS5hZnRlcihyKSxuLmNzcyh7cG9zaXRpb246ImFic29sdXRlIiwiZmxvYXQiOiJub25lIiwiei1pbmRleCI6cCx0b3A6LTk5OTk5OX0pLHQoImJvZHkiKS5hcHBlbmQobikscy5zaG93KCksYShuLHMsciksaS5wYXJlbnRzKCkuc2Nyb2xsKGwpLHQod2luZG93KS5vbigicmVzaXplIHNjcm9sbCIsbCl9KSxpLm9uKCJsaXN6dDpoaWRpbmdfZHJvcGRvd24gcmVtb3ZlIixmdW5jdGlvbigpe2kucGFyZW50cygpLm9mZigic2Nyb2xsIixsKSx0KHdpbmRvdykub2ZmKCJyZXNpemUgc2Nyb2xsIixsKSxuLmNzcyhvKSxzLmhpZGUoKSxzLmNzcygibWF4LWhlaWdodCIsaCksci5yZW1vdmUoKSxpLmFmdGVyKG4pfSl9dmFyIGM9bi50cGwoJzxzZWxlY3QgaWQ9Int7aW5wdXRJZH19IiBuYW1lPSJ7e25hbWV9fSI+PC9zZWxlY3Q+JyksdT1uLnRwbCgnPG9wdGlvbiB2YWx1ZT0ie3trZXl9fSI+e3t2YWx1ZX19PC9vcHRpb24+JyksZD0yMCxoPTI0MCxwPTVlNDtyZXR1cm4gci5leHRlbmQoe2NsYXNzTmFtZToiby1mb3JtLXNlbGVjdCIsZXZlbnRzOnsiY2hhbmdlIHNlbGVjdCI6InVwZGF0ZSIsImtleXVwIC5jaHpuLXNlYXJjaCA+IDp0ZXh0IjpmdW5jdGlvbih0KXtpLmlzRXNjKHQpJiYodGhpcy4kKCIuY2h6bi1zZWFyY2ggPiA6dGV4dCIpLnZhbCgiIiksdC5zdG9wUHJvcGFnYXRpb24oKSl9fSxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe3IuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMucGFyYW1zPXRoaXMub3B0aW9ucy5wYXJhbXN8fHt9fSxlZGl0TW9kZTpmdW5jdGlvbigpe3RoaXMuJGVsLmh0bWwoYyh0aGlzLm9wdGlvbnMpKSx0aGlzLiRzZWxlY3Q9dGhpcy4kKCJzZWxlY3QiKTt2YXIgdD10aGlzLmdldE9wdGlvbnMoKTtlLmVhY2godCxmdW5jdGlvbih0LGUpe3RoaXMuJHNlbGVjdC5hcHBlbmQodSh7a2V5OmUsdmFsdWU6dH0pKX0sdGhpcyk7dmFyIGk9dGhpcy5nZXRNb2RlbFZhbHVlKCk7cmV0dXJuIGk/dGhpcy4kc2VsZWN0LnZhbChpKTp0aGlzLiQoIm9wdGlvbjpmaXJzdC1jaGlsZCIpLnByb3AoInNlbGVjdGVkIiwhMCksdGhpcy4kZWwuYWRkQ2xhc3MoIm8tZm9ybS1jb250cm9sIiksdGhpcy5wYXJhbXMuY2hvc2VuIT09ITEmJnRoaXMuX19hcHBseUNob3NlbigpLHRoaXN9LF9fYXBwbHlDaG9zZW46ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMud2lkZT8iMTAwJSI6dGhpcy5wYXJhbXMud2lkdGh8fCI2MiUiO3RoaXMucGFyYW1zLmF1dG9XaWR0aCYmKHQ9byh0aGlzKSkscy5jYWxsKHRoaXMsZnVuY3Rpb24oKXt2YXIgaT10aGlzLmdldFBhcmFtKCJzZWFyY2hUaHJlc2hvbGQiLDEwKTtlLnJlc3VsdCh0aGlzLm9wdGlvbnMsImF1dG9SZW5kZXIiKXx8dGhpcy51cGRhdGUoKSx0aGlzLiRzZWxlY3QuY2hvc2VuKHt3aWR0aDp0LGRpc2FibGVfc2VhcmNoX3RocmVzaG9sZDppLHBsYWNlaG9sZGVyX3RleHQ6dGhpcy5vcHRpb25zLnBsYWNlaG9sZGVyfSksbCh0aGlzLiRzZWxlY3QpLHRoaXMucGFyYW1zLmF1dG9XaWR0aCYmdGhpcy4kZWwud2lkdGgoMCksdGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOnJlc2l6ZSIpfSl9LHZhbDpmdW5jdGlvbigpe3JldHVybiB0aGlzLiRzZWxlY3QmJnRoaXMuJHNlbGVjdC52YWwoKX0sZm9jdXM6ZnVuY3Rpb24oKXtpZih0aGlzLiRzZWxlY3QpcmV0dXJuIHRoaXMuJHNlbGVjdC5mb2N1cygpfSx0b1N0cmluZ1ZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRNb2RlbFZhbHVlKCksaT10LG49dGhpcy5nZXRPcHRpb25zKCk7cmV0dXJuIGUuaXNFbXB0eShuKXx8KGk9blt0XSksZS5pc1VuZGVmaW5lZChpKSYmKGk9dGhpcy5kZWZhdWx0VmFsdWUoKSksaXx8IiJ9LGdldE9wdGlvbnM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMub3B0aW9ucztyZXR1cm4gZS5pc0Z1bmN0aW9uKHQpJiYodD10LmNhbGwodGhpcykpLGUuaXNPYmplY3QodCk/dDp7fX0scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJHNlbGVjdCYmdGhpcy4kc2VsZWN0LnRyaWdnZXIoInJlbW92ZSIpLHIucHJvdG90eXBlLnJlbW92ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg2KV0scj1mdW5jdGlvbih0KXsoZnVuY3Rpb24oKXt2YXIgdDt0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMub3B0aW9uc19pbmRleD0wLHRoaXMucGFyc2VkPVtdfXJldHVybiB0LnByb3RvdHlwZS5hZGRfbm9kZT1mdW5jdGlvbih0KXtyZXR1cm4iT1BUR1JPVVAiPT09dC5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpP3RoaXMuYWRkX2dyb3VwKHQpOnRoaXMuYWRkX29wdGlvbih0KX0sdC5wcm90b3R5cGUuYWRkX2dyb3VwPWZ1bmN0aW9uKHQpe3ZhciBlLGksbixyLHMsbztmb3IoZT10aGlzLnBhcnNlZC5sZW5ndGgsdGhpcy5wYXJzZWQucHVzaCh7YXJyYXlfaW5kZXg6ZSxncm91cDohMCxsYWJlbDp0LmxhYmVsLGNoaWxkcmVuOjAsZGlzYWJsZWQ6dC5kaXNhYmxlZH0pLHM9dC5jaGlsZE5vZGVzLG89W10sbj0wLHI9cy5sZW5ndGg7bjxyO24rKylpPXNbbl0sby5wdXNoKHRoaXMuYWRkX29wdGlvbihpLGUsdC5kaXNhYmxlZCkpO3JldHVybiBvfSx0LnByb3RvdHlwZS5hZGRfb3B0aW9uPWZ1bmN0aW9uKHQsZSxpKXtpZigiT1BUSU9OIj09PXQubm9kZU5hbWUudG9VcHBlckNhc2UoKSlyZXR1cm4iIiE9PXQudGV4dD8obnVsbCE9ZSYmKHRoaXMucGFyc2VkW2VdLmNoaWxkcmVuKz0xKSx0aGlzLnBhcnNlZC5wdXNoKHthcnJheV9pbmRleDp0aGlzLnBhcnNlZC5sZW5ndGgsb3B0aW9uc19pbmRleDp0aGlzLm9wdGlvbnNfaW5kZXgsdmFsdWU6dC52YWx1ZSx0ZXh0OnQudGV4dCxodG1sOnQuaW5uZXJIVE1MLHNlbGVjdGVkOnQuc2VsZWN0ZWQsZGlzYWJsZWQ6aT09PSEwP2k6dC5kaXNhYmxlZCxncm91cF9hcnJheV9pbmRleDplLGNsYXNzZXM6dC5jbGFzc05hbWUsc3R5bGU6dC5zdHlsZS5jc3NUZXh0fSkpOnRoaXMucGFyc2VkLnB1c2goe2FycmF5X2luZGV4OnRoaXMucGFyc2VkLmxlbmd0aCxvcHRpb25zX2luZGV4OnRoaXMub3B0aW9uc19pbmRleCxlbXB0eTohMH0pLHRoaXMub3B0aW9uc19pbmRleCs9MX0sdH0oKSx0LnNlbGVjdF90b19hcnJheT1mdW5jdGlvbihlKXt2YXIgaSxuLHIscyxvO2ZvcihuPW5ldyB0LG89ZS5jaGlsZE5vZGVzLHI9MCxzPW8ubGVuZ3RoO3I8cztyKyspaT1vW3JdLG4uYWRkX25vZGUoaSk7cmV0dXJuIG4ucGFyc2VkfSx0aGlzLlNlbGVjdFBhcnNlcj10fSkuY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0LGU7ZT10aGlzLHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUsaSl7dGhpcy5mb3JtX2ZpZWxkPWUsdGhpcy5vcHRpb25zPW51bGwhPWk/aTp7fSx0LmJyb3dzZXJfaXNfc3VwcG9ydGVkKCkmJih0aGlzLmlzX211bHRpcGxlPXRoaXMuZm9ybV9maWVsZC5tdWx0aXBsZSx0aGlzLnNldF9kZWZhdWx0X3RleHQoKSx0aGlzLnNldF9kZWZhdWx0X3ZhbHVlcygpLHRoaXMuc2V0dXAoKSx0aGlzLnNldF91cF9odG1sKCksdGhpcy5yZWdpc3Rlcl9vYnNlcnZlcnMoKSx0aGlzLmZpbmlzaF9zZXR1cCgpKX1yZXR1cm4gdC5wcm90b3R5cGUuc2V0X2RlZmF1bHRfdmFsdWVzPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcztyZXR1cm4gdGhpcy5jbGlja190ZXN0X2FjdGlvbj1mdW5jdGlvbihlKXtyZXR1cm4gdC50ZXN0X2FjdGl2ZV9jbGljayhlKX0sdGhpcy5hY3RpdmF0ZV9hY3Rpb249ZnVuY3Rpb24oZSl7cmV0dXJuIHQuYWN0aXZhdGVfZmllbGQoZSl9LHRoaXMuYWN0aXZlX2ZpZWxkPSExLHRoaXMubW91c2Vfb25fY29udGFpbmVyPSExLHRoaXMucmVzdWx0c19zaG93aW5nPSExLHRoaXMucmVzdWx0X2hpZ2hsaWdodGVkPW51bGwsdGhpcy5yZXN1bHRfc2luZ2xlX3NlbGVjdGVkPW51bGwsdGhpcy5hbGxvd19zaW5nbGVfZGVzZWxlY3Q9bnVsbCE9dGhpcy5vcHRpb25zLmFsbG93X3NpbmdsZV9kZXNlbGVjdCYmbnVsbCE9dGhpcy5mb3JtX2ZpZWxkLm9wdGlvbnNbMF0mJiIiPT09dGhpcy5mb3JtX2ZpZWxkLm9wdGlvbnNbMF0udGV4dCYmdGhpcy5vcHRpb25zLmFsbG93X3NpbmdsZV9kZXNlbGVjdCx0aGlzLmRpc2FibGVfc2VhcmNoX3RocmVzaG9sZD10aGlzLm9wdGlvbnMuZGlzYWJsZV9zZWFyY2hfdGhyZXNob2xkfHwwLHRoaXMuZGlzYWJsZV9zZWFyY2g9dGhpcy5vcHRpb25zLmRpc2FibGVfc2VhcmNofHwhMSx0aGlzLmVuYWJsZV9zcGxpdF93b3JkX3NlYXJjaD1udWxsPT10aGlzLm9wdGlvbnMuZW5hYmxlX3NwbGl0X3dvcmRfc2VhcmNofHx0aGlzLm9wdGlvbnMuZW5hYmxlX3NwbGl0X3dvcmRfc2VhcmNoLHRoaXMuc2VhcmNoX2NvbnRhaW5zPXRoaXMub3B0aW9ucy5zZWFyY2hfY29udGFpbnN8fCExLHRoaXMuc2luZ2xlX2JhY2tzdHJva2VfZGVsZXRlPXRoaXMub3B0aW9ucy5zaW5nbGVfYmFja3N0cm9rZV9kZWxldGV8fCExLHRoaXMubWF4X3NlbGVjdGVkX29wdGlvbnM9dGhpcy5vcHRpb25zLm1heF9zZWxlY3RlZF9vcHRpb25zfHwxLzAsdGhpcy5pbmhlcml0X3NlbGVjdF9jbGFzc2VzPXRoaXMub3B0aW9ucy5pbmhlcml0X3NlbGVjdF9jbGFzc2VzfHwhMX0sdC5wcm90b3R5cGUuc2V0X2RlZmF1bHRfdGV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZvcm1fZmllbGQuZ2V0QXR0cmlidXRlKCJkYXRhLXBsYWNlaG9sZGVyIik/dGhpcy5kZWZhdWx0X3RleHQ9dGhpcy5mb3JtX2ZpZWxkLmdldEF0dHJpYnV0ZSgiZGF0YS1wbGFjZWhvbGRlciIpOnRoaXMuaXNfbXVsdGlwbGU/dGhpcy5kZWZhdWx0X3RleHQ9dGhpcy5vcHRpb25zLnBsYWNlaG9sZGVyX3RleHRfbXVsdGlwbGV8fHRoaXMub3B0aW9ucy5wbGFjZWhvbGRlcl90ZXh0fHx0LmRlZmF1bHRfbXVsdGlwbGVfdGV4dDp0aGlzLmRlZmF1bHRfdGV4dD10aGlzLm9wdGlvbnMucGxhY2Vob2xkZXJfdGV4dF9zaW5nbGV8fHRoaXMub3B0aW9ucy5wbGFjZWhvbGRlcl90ZXh0fHx0LmRlZmF1bHRfc2luZ2xlX3RleHQsdGhpcy5yZXN1bHRzX25vbmVfZm91bmQ9dGhpcy5mb3JtX2ZpZWxkLmdldEF0dHJpYnV0ZSgiZGF0YS1ub19yZXN1bHRzX3RleHQiKXx8dGhpcy5vcHRpb25zLm5vX3Jlc3VsdHNfdGV4dHx8dC5kZWZhdWx0X25vX3Jlc3VsdF90ZXh0fSx0LnByb3RvdHlwZS5tb3VzZV9lbnRlcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1vdXNlX29uX2NvbnRhaW5lcj0hMH0sdC5wcm90b3R5cGUubW91c2VfbGVhdmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb3VzZV9vbl9jb250YWluZXI9ITF9LHQucHJvdG90eXBlLmlucHV0X2ZvY3VzPWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXM7aWYodGhpcy5pc19tdWx0aXBsZSl7aWYoIXRoaXMuYWN0aXZlX2ZpZWxkKXJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmV0dXJuIGUuY29udGFpbmVyX21vdXNlZG93bigpfSw1MCl9ZWxzZSBpZighdGhpcy5hY3RpdmVfZmllbGQpcmV0dXJuIHRoaXMuYWN0aXZhdGVfZmllbGQoKX0sdC5wcm90b3R5cGUuaW5wdXRfYmx1cj1mdW5jdGlvbih0KXt2YXIgZT10aGlzO2lmKCF0aGlzLm1vdXNlX29uX2NvbnRhaW5lcilyZXR1cm4gdGhpcy5hY3RpdmVfZmllbGQ9ITEsc2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiBlLmJsdXJfdGVzdCgpfSwxMDApfSx0LnByb3RvdHlwZS5yZXN1bHRfYWRkX29wdGlvbj1mdW5jdGlvbih0KXt2YXIgZSxpO3JldHVybiB0LmRvbV9pZD10aGlzLmNvbnRhaW5lcl9pZCsiX29fIit0LmFycmF5X2luZGV4LGU9W10sdC5kaXNhYmxlZHx8dC5zZWxlY3RlZCYmdGhpcy5pc19tdWx0aXBsZXx8ZS5wdXNoKCJhY3RpdmUtcmVzdWx0IiksIXQuZGlzYWJsZWR8fHQuc2VsZWN0ZWQmJnRoaXMuaXNfbXVsdGlwbGV8fGUucHVzaCgiZGlzYWJsZWQtcmVzdWx0IiksdC5zZWxlY3RlZCYmZS5wdXNoKCJyZXN1bHQtc2VsZWN0ZWQiKSxudWxsIT10Lmdyb3VwX2FycmF5X2luZGV4JiZlLnB1c2goImdyb3VwLW9wdGlvbiIpLCIiIT09dC5jbGFzc2VzJiZlLnB1c2godC5jbGFzc2VzKSxpPSIiIT09dC5zdHlsZS5jc3NUZXh0Pycgc3R5bGU9IicrdC5zdHlsZSsnIic6IiIsJzxsaSBpZD0iJyt0LmRvbV9pZCsnIiBjbGFzcz0iJytlLmpvaW4oIiAiKSsnIicraSsiPiIrdC5odG1sKyI8L2xpPiJ9LHQucHJvdG90eXBlLnJlc3VsdHNfdXBkYXRlX2ZpZWxkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2V0X2RlZmF1bHRfdGV4dCgpLHRoaXMuaXNfbXVsdGlwbGV8fHRoaXMucmVzdWx0c19yZXNldF9jbGVhbnVwKCksdGhpcy5yZXN1bHRfY2xlYXJfaGlnaGxpZ2h0KCksdGhpcy5yZXN1bHRfc2luZ2xlX3NlbGVjdGVkPW51bGwsdGhpcy5yZXN1bHRzX2J1aWxkKCl9LHQucHJvdG90eXBlLnJlc3VsdHNfdG9nZ2xlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVzdWx0c19zaG93aW5nP3RoaXMucmVzdWx0c19oaWRlKCk6dGhpcy5yZXN1bHRzX3Nob3coKX0sdC5wcm90b3R5cGUucmVzdWx0c19zZWFyY2g9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMucmVzdWx0c19zaG93aW5nP3RoaXMud2lubm93X3Jlc3VsdHMoKTp0aGlzLnJlc3VsdHNfc2hvdygpfSx0LnByb3RvdHlwZS5jaG9pY2VzX2NvdW50PWZ1bmN0aW9uKCl7dmFyIHQsZSxpLG47aWYobnVsbCE9dGhpcy5zZWxlY3RlZF9vcHRpb25fY291bnQpcmV0dXJuIHRoaXMuc2VsZWN0ZWRfb3B0aW9uX2NvdW50O2Zvcih0aGlzLnNlbGVjdGVkX29wdGlvbl9jb3VudD0wLG49dGhpcy5mb3JtX2ZpZWxkLm9wdGlvbnMsZT0wLGk9bi5sZW5ndGg7ZTxpO2UrKyl0PW5bZV0sdC5zZWxlY3RlZCYmKHRoaXMuc2VsZWN0ZWRfb3B0aW9uX2NvdW50Kz0xKTtyZXR1cm4gdGhpcy5zZWxlY3RlZF9vcHRpb25fY291bnR9LHQucHJvdG90eXBlLmNob2ljZXNfY2xpY2s9ZnVuY3Rpb24odCl7aWYodC5wcmV2ZW50RGVmYXVsdCgpLCF0aGlzLnJlc3VsdHNfc2hvd2luZyYmIXRoaXMuaXNfZGlzYWJsZWQpcmV0dXJuIHRoaXMucmVzdWx0c19zaG93KCl9LHQucHJvdG90eXBlLmtleXVwX2NoZWNrZXI9ZnVuY3Rpb24odCl7dmFyIGUsaTtzd2l0Y2goZT1udWxsIT0oaT10LndoaWNoKT9pOnQua2V5Q29kZSx0aGlzLnNlYXJjaF9maWVsZF9zY2FsZSgpLGUpe2Nhc2UgODppZih0aGlzLmlzX211bHRpcGxlJiZ0aGlzLmJhY2tzdHJva2VfbGVuZ3RoPDEmJnRoaXMuY2hvaWNlc19jb3VudCgpPjApcmV0dXJuIHRoaXMua2V5ZG93bl9iYWNrc3Ryb2tlKCk7aWYoIXRoaXMucGVuZGluZ19iYWNrc3Ryb2tlKXJldHVybiB0aGlzLnJlc3VsdF9jbGVhcl9oaWdobGlnaHQoKSx0aGlzLnJlc3VsdHNfc2VhcmNoKCk7YnJlYWs7Y2FzZSAxMzppZih0LnByZXZlbnREZWZhdWx0KCksdGhpcy5yZXN1bHRzX3Nob3dpbmcpcmV0dXJuIHRoaXMucmVzdWx0X3NlbGVjdCh0KTticmVhaztjYXNlIDI3OnJldHVybiB0aGlzLnJlc3VsdHNfc2hvd2luZyYmdGhpcy5yZXN1bHRzX2hpZGUoKSwhMDtjYXNlIDk6Y2FzZSAzODpjYXNlIDQwOmNhc2UgMTY6Y2FzZSA5MTpjYXNlIDE3OmJyZWFrO2RlZmF1bHQ6cmV0dXJuIHRoaXMucmVzdWx0c19zZWFyY2goKX19LHQucHJvdG90eXBlLmdlbmVyYXRlX2ZpZWxkX2lkPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIHQ9dGhpcy5nZW5lcmF0ZV9yYW5kb21faWQoKSx0aGlzLmZvcm1fZmllbGQuaWQ9dCx0fSx0LnByb3RvdHlwZS5nZW5lcmF0ZV9yYW5kb21fY2hhcj1mdW5jdGlvbigpe3ZhciB0LGUsaTtyZXR1cm4gdD0iMDEyMzQ1Njc4OUFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaIixpPU1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSp0Lmxlbmd0aCksZT10LnN1YnN0cmluZyhpLGkrMSl9LHQucHJvdG90eXBlLmNvbnRhaW5lcl93aWR0aD1mdW5jdGlvbigpe3JldHVybiBudWxsIT10aGlzLm9wdGlvbnMud2lkdGg/dGhpcy5vcHRpb25zLndpZHRoOiIiK3RoaXMuZm9ybV9maWVsZC5vZmZzZXRXaWR0aCsicHgifSx0LmJyb3dzZXJfaXNfc3VwcG9ydGVkPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIk1pY3Jvc29mdCBJbnRlcm5ldCBFeHBsb3JlciIhPT13aW5kb3cubmF2aWdhdG9yLmFwcE5hbWV8fG51bGwhPT0odD1kb2N1bWVudC5kb2N1bWVudE1vZGUpJiZ0Pj04fSx0LmRlZmF1bHRfbXVsdGlwbGVfdGV4dD0iU2VsZWN0IFNvbWUgT3B0aW9ucyIsdC5kZWZhdWx0X3NpbmdsZV90ZXh0PSJTZWxlY3QgYW4gT3B0aW9uIix0LmRlZmF1bHRfbm9fcmVzdWx0X3RleHQ9Ik5vIHJlc3VsdHMgbWF0Y2giLHR9KCksZS5BYnN0cmFjdENob3Nlbj10fS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIGUsaSxuLHIscz17fS5oYXNPd25Qcm9wZXJ0eSxvPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSgpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIG4gaW4gZSlzLmNhbGwoZSxuKSYmKHRbbl09ZVtuXSk7cmV0dXJuIGkucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBpLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9O249dGhpczt2YXIgYT1uLkFic3RyYWN0Q2hvc2VuO2U9dCxlLmZuLmV4dGVuZCh7Y2hvc2VuOmZ1bmN0aW9uKHQpe3JldHVybiBhLmJyb3dzZXJfaXNfc3VwcG9ydGVkKCk/dGhpcy5lYWNoKGZ1bmN0aW9uKG4pe3ZhciByO2lmKHI9ZSh0aGlzKSwhci5oYXNDbGFzcygiY2h6bi1kb25lIikpcmV0dXJuIHIuZGF0YSgiY2hvc2VuIixuZXcgaSh0aGlzLHQpKX0pOnRoaXN9fSksaT1mdW5jdGlvbih0KXtmdW5jdGlvbiBpKCl7cmV0dXJuIHI9aS5fX3N1cGVyX18uY29uc3RydWN0b3IuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBvKGksdCksaS5wcm90b3R5cGUuc2V0dXA9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mb3JtX2ZpZWxkX2pxPWUodGhpcy5mb3JtX2ZpZWxkKSx0aGlzLmN1cnJlbnRfc2VsZWN0ZWRJbmRleD10aGlzLmZvcm1fZmllbGQuc2VsZWN0ZWRJbmRleCx0aGlzLmlzX3J0bD10aGlzLmZvcm1fZmllbGRfanEuaGFzQ2xhc3MoImNoem4tcnRsIil9LGkucHJvdG90eXBlLmZpbmlzaF9zZXR1cD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZvcm1fZmllbGRfanEuYWRkQ2xhc3MoImNoem4tZG9uZSIpfSxpLnByb3RvdHlwZS5zZXRfdXBfaHRtbD1mdW5jdGlvbigpe3ZhciB0LGk7cmV0dXJuIHRoaXMuY29udGFpbmVyX2lkPXRoaXMuZm9ybV9maWVsZC5pZC5sZW5ndGg/dGhpcy5mb3JtX2ZpZWxkLmlkLnJlcGxhY2UoL1teXHddL2csIl8iKTp0aGlzLmdlbmVyYXRlX2ZpZWxkX2lkKCksdGhpcy5jb250YWluZXJfaWQrPSJfY2h6biIsdD1bImNoem4tY29udGFpbmVyIl0sdC5wdXNoKCJjaHpuLWNvbnRhaW5lci0iKyh0aGlzLmlzX211bHRpcGxlPyJtdWx0aSI6InNpbmdsZSIpKSx0aGlzLmluaGVyaXRfc2VsZWN0X2NsYXNzZXMmJnRoaXMuZm9ybV9maWVsZC5jbGFzc05hbWUmJnQucHVzaCh0aGlzLmZvcm1fZmllbGQuY2xhc3NOYW1lKSx0aGlzLmlzX3J0bCYmdC5wdXNoKCJjaHpuLXJ0bCIpLGk9e2lkOnRoaXMuY29udGFpbmVyX2lkLCJjbGFzcyI6dC5qb2luKCIgIiksc3R5bGU6IndpZHRoOiAiK3RoaXMuY29udGFpbmVyX3dpZHRoKCkrIjsiLHRpdGxlOnRoaXMuZm9ybV9maWVsZC50aXRsZX0sdGhpcy5jb250YWluZXI9ZSgiPGRpdiAvPiIsaSksdGhpcy5pc19tdWx0aXBsZT90aGlzLmNvbnRhaW5lci5odG1sKCc8dWwgY2xhc3M9ImNoem4tY2hvaWNlcyI+PGxpIGNsYXNzPSJzZWFyY2gtZmllbGQiPjxpbnB1dCB0eXBlPSJ0ZXh0IiB2YWx1ZT0iJyt0aGlzLmRlZmF1bHRfdGV4dCsnIiBjbGFzcz0iZGVmYXVsdCIgYXV0b2NvbXBsZXRlPSJvZmYiIHN0eWxlPSJ3aWR0aDoyNXB4OyIgLz48L2xpPjwvdWw+PGRpdiBjbGFzcz0iY2h6bi1kcm9wIj48dWwgY2xhc3M9ImNoem4tcmVzdWx0cyI+PC91bD48L2Rpdj4nKTp0aGlzLmNvbnRhaW5lci5odG1sKCc8YSBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCkiIGNsYXNzPSJjaHpuLXNpbmdsZSBjaHpuLWRlZmF1bHQiIHRhYmluZGV4PSItMSI+PHNwYW4+Jyt0aGlzLmRlZmF1bHRfdGV4dCsnPC9zcGFuPjxkaXY+PGI+PC9iPjwvZGl2PjwvYT48ZGl2IGNsYXNzPSJjaHpuLWRyb3AiPjxkaXYgY2xhc3M9ImNoem4tc2VhcmNoIj48aW5wdXQgdHlwZT0idGV4dCIgYXV0b2NvbXBsZXRlPSJvZmYiIC8+PC9kaXY+PHVsIGNsYXNzPSJjaHpuLXJlc3VsdHMiPjwvdWw+PC9kaXY+JyksdGhpcy5mb3JtX2ZpZWxkX2pxLmhpZGUoKS5hZnRlcih0aGlzLmNvbnRhaW5lciksdGhpcy5kcm9wZG93bj10aGlzLmNvbnRhaW5lci5maW5kKCJkaXYuY2h6bi1kcm9wIikuZmlyc3QoKSx0aGlzLnNlYXJjaF9maWVsZD10aGlzLmNvbnRhaW5lci5maW5kKCJpbnB1dCIpLmZpcnN0KCksdGhpcy5zZWFyY2hfcmVzdWx0cz10aGlzLmNvbnRhaW5lci5maW5kKCJ1bC5jaHpuLXJlc3VsdHMiKS5maXJzdCgpLHRoaXMuc2VhcmNoX2ZpZWxkX3NjYWxlKCksdGhpcy5zZWFyY2hfbm9fcmVzdWx0cz10aGlzLmNvbnRhaW5lci5maW5kKCJsaS5uby1yZXN1bHRzIikuZmlyc3QoKSx0aGlzLmlzX211bHRpcGxlPyh0aGlzLnNlYXJjaF9jaG9pY2VzPXRoaXMuY29udGFpbmVyLmZpbmQoInVsLmNoem4tY2hvaWNlcyIpLmZpcnN0KCksdGhpcy5zZWFyY2hfY29udGFpbmVyPXRoaXMuY29udGFpbmVyLmZpbmQoImxpLnNlYXJjaC1maWVsZCIpLmZpcnN0KCkpOih0aGlzLnNlYXJjaF9jb250YWluZXI9dGhpcy5jb250YWluZXIuZmluZCgiZGl2LmNoem4tc2VhcmNoIikuZmlyc3QoKSx0aGlzLnNlbGVjdGVkX2l0ZW09dGhpcy5jb250YWluZXIuZmluZCgiLmNoem4tc2luZ2xlIikuZmlyc3QoKSksdGhpcy5yZXN1bHRzX2J1aWxkKCksdGhpcy5zZXRfdGFiX2luZGV4KCksdGhpcy5zZXRfbGFiZWxfYmVoYXZpb3IoKSx0aGlzLmZvcm1fZmllbGRfanEudHJpZ2dlcigibGlzenQ6cmVhZHkiLHtjaG9zZW46dGhpc30pfSxpLnByb3RvdHlwZS5yZWdpc3Rlcl9vYnNlcnZlcnM9ZnVuY3Rpb24oKXt2YXIgdD10aGlzO3JldHVybiB0aGlzLmNvbnRhaW5lci5tb3VzZWRvd24oZnVuY3Rpb24oZSl7dC5jb250YWluZXJfbW91c2Vkb3duKGUpfSksdGhpcy5jb250YWluZXIubW91c2V1cChmdW5jdGlvbihlKXt0LmNvbnRhaW5lcl9tb3VzZXVwKGUpfSksdGhpcy5jb250YWluZXIubW91c2VlbnRlcihmdW5jdGlvbihlKXt0Lm1vdXNlX2VudGVyKGUpfSksdGhpcy5jb250YWluZXIubW91c2VsZWF2ZShmdW5jdGlvbihlKXt0Lm1vdXNlX2xlYXZlKGUpfSksdGhpcy5zZWFyY2hfcmVzdWx0cy5tb3VzZXVwKGZ1bmN0aW9uKGUpe3Quc2VhcmNoX3Jlc3VsdHNfbW91c2V1cChlKX0pLHRoaXMuc2VhcmNoX3Jlc3VsdHMubW91c2VvdmVyKGZ1bmN0aW9uKGUpe3Quc2VhcmNoX3Jlc3VsdHNfbW91c2VvdmVyKGUpfSksdGhpcy5zZWFyY2hfcmVzdWx0cy5tb3VzZW91dChmdW5jdGlvbihlKXt0LnNlYXJjaF9yZXN1bHRzX21vdXNlb3V0KGUpfSksdGhpcy5zZWFyY2hfcmVzdWx0cy5iaW5kKCJtb3VzZXdoZWVsIERPTU1vdXNlU2Nyb2xsIixmdW5jdGlvbihlKXt0LnNlYXJjaF9yZXN1bHRzX21vdXNld2hlZWwoZSl9KSx0aGlzLmZvcm1fZmllbGRfanEuYmluZCgibGlzenQ6dXBkYXRlZCIsZnVuY3Rpb24oZSl7dC5yZXN1bHRzX3VwZGF0ZV9maWVsZChlKX0pLHRoaXMuZm9ybV9maWVsZF9qcS5iaW5kKCJsaXN6dDphY3RpdmF0ZSIsZnVuY3Rpb24oZSl7dC5hY3RpdmF0ZV9maWVsZChlKX0pLHRoaXMuZm9ybV9maWVsZF9qcS5iaW5kKCJsaXN6dDpvcGVuIixmdW5jdGlvbihlKXt0LmNvbnRhaW5lcl9tb3VzZWRvd24oZSl9KSx0aGlzLnNlYXJjaF9maWVsZC5ibHVyKGZ1bmN0aW9uKGUpe3QuaW5wdXRfYmx1cihlKX0pLHRoaXMuc2VhcmNoX2ZpZWxkLmtleXVwKGZ1bmN0aW9uKGUpe3Qua2V5dXBfY2hlY2tlcihlKX0pLHRoaXMuc2VhcmNoX2ZpZWxkLmtleWRvd24oZnVuY3Rpb24oZSl7dC5rZXlkb3duX2NoZWNrZXIoZSl9KSx0aGlzLnNlYXJjaF9maWVsZC5mb2N1cyhmdW5jdGlvbihlKXt0LmlucHV0X2ZvY3VzKGUpfSksdGhpcy5pc19tdWx0aXBsZT90aGlzLnNlYXJjaF9jaG9pY2VzLmNsaWNrKGZ1bmN0aW9uKGUpe3QuY2hvaWNlc19jbGljayhlKX0pOnRoaXMuY29udGFpbmVyLmNsaWNrKGZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKX0pfSxpLnByb3RvdHlwZS5zZWFyY2hfZmllbGRfZGlzYWJsZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc19kaXNhYmxlZD10aGlzLmZvcm1fZmllbGRfanFbMF0uZGlzYWJsZWQsdGhpcy5pc19kaXNhYmxlZD8odGhpcy5jb250YWluZXIuYWRkQ2xhc3MoImNoem4tZGlzYWJsZWQiKSx0aGlzLnNlYXJjaF9maWVsZFswXS5kaXNhYmxlZD0hMCx0aGlzLmlzX211bHRpcGxlfHx0aGlzLnNlbGVjdGVkX2l0ZW0udW5iaW5kKCJmb2N1cyIsdGhpcy5hY3RpdmF0ZV9hY3Rpb24pLHRoaXMuY2xvc2VfZmllbGQoKSk6KHRoaXMuY29udGFpbmVyLnJlbW92ZUNsYXNzKCJjaHpuLWRpc2FibGVkIiksdGhpcy5zZWFyY2hfZmllbGRbMF0uZGlzYWJsZWQ9ITEsdGhpcy5pc19tdWx0aXBsZT92b2lkIDA6dGhpcy5zZWxlY3RlZF9pdGVtLmJpbmQoImZvY3VzIix0aGlzLmFjdGl2YXRlX2FjdGlvbikpfSxpLnByb3RvdHlwZS5jb250YWluZXJfbW91c2Vkb3duPWZ1bmN0aW9uKHQpe2lmKCF0aGlzLmlzX2Rpc2FibGVkJiYodCYmIm1vdXNlZG93biI9PT10LnR5cGUmJiF0aGlzLnJlc3VsdHNfc2hvd2luZyYmdC5wcmV2ZW50RGVmYXVsdCgpLG51bGw9PXR8fCFlKHQudGFyZ2V0KS5oYXNDbGFzcygic2VhcmNoLWNob2ljZS1jbG9zZSIpKSlyZXR1cm4gdGhpcy5hY3RpdmVfZmllbGQ/dGhpcy5pc19tdWx0aXBsZXx8IXR8fGUodC50YXJnZXQpWzBdIT09dGhpcy5zZWxlY3RlZF9pdGVtWzBdJiYhZSh0LnRhcmdldCkucGFyZW50cygiYS5jaHpuLXNpbmdsZSIpLmxlbmd0aHx8KHQucHJldmVudERlZmF1bHQoKSx0aGlzLnJlc3VsdHNfdG9nZ2xlKCkpOih0aGlzLmlzX211bHRpcGxlJiZ0aGlzLnNlYXJjaF9maWVsZC52YWwoIiIpLGUoZG9jdW1lbnQpLmNsaWNrKHRoaXMuY2xpY2tfdGVzdF9hY3Rpb24pLHRoaXMucmVzdWx0c19zaG93KCkpLHRoaXMuYWN0aXZhdGVfZmllbGQoKX0saS5wcm90b3R5cGUuY29udGFpbmVyX21vdXNldXA9ZnVuY3Rpb24odCl7aWYoIkFCQlIiPT09dC50YXJnZXQubm9kZU5hbWUmJiF0aGlzLmlzX2Rpc2FibGVkKXJldHVybiB0aGlzLnJlc3VsdHNfcmVzZXQodCl9LGkucHJvdG90eXBlLnNlYXJjaF9yZXN1bHRzX21vdXNld2hlZWw9ZnVuY3Rpb24odCl7dmFyIGUsaSxuO2lmKGU9LShudWxsIT0oaT10Lm9yaWdpbmFsRXZlbnQpP2kud2hlZWxEZWx0YTp2b2lkIDApfHwobnVsbCE9KG49dC5vcmlnaW5pYWxFdmVudCk/bi5kZXRhaWw6dm9pZCAwKSxudWxsIT1lKXJldHVybiB0LnByZXZlbnREZWZhdWx0KCksIkRPTU1vdXNlU2Nyb2xsIj09PXQudHlwZSYmKGU9NDAqZSksdGhpcy5zZWFyY2hfcmVzdWx0cy5zY3JvbGxUb3AoZSt0aGlzLnNlYXJjaF9yZXN1bHRzLnNjcm9sbFRvcCgpKX0saS5wcm90b3R5cGUuYmx1cl90ZXN0PWZ1bmN0aW9uKHQpe2lmKCF0aGlzLmFjdGl2ZV9maWVsZCYmdGhpcy5jb250YWluZXIuaGFzQ2xhc3MoImNoem4tY29udGFpbmVyLWFjdGl2ZSIpKXJldHVybiB0aGlzLmNsb3NlX2ZpZWxkKCl9LGkucHJvdG90eXBlLmNsb3NlX2ZpZWxkPWZ1bmN0aW9uKCl7cmV0dXJuIGUoZG9jdW1lbnQpLnVuYmluZCgiY2xpY2siLHRoaXMuY2xpY2tfdGVzdF9hY3Rpb24pLHRoaXMuYWN0aXZlX2ZpZWxkPSExLHRoaXMucmVzdWx0c19oaWRlKCksdGhpcy5jb250YWluZXIucmVtb3ZlQ2xhc3MoImNoem4tY29udGFpbmVyLWFjdGl2ZSIpLHRoaXMuY2xlYXJfYmFja3N0cm9rZSgpLHRoaXMuc2hvd19zZWFyY2hfZmllbGRfZGVmYXVsdCgpLHRoaXMuc2VhcmNoX2ZpZWxkX3NjYWxlKCl9LGkucHJvdG90eXBlLmFjdGl2YXRlX2ZpZWxkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29udGFpbmVyLmFkZENsYXNzKCJjaHpuLWNvbnRhaW5lci1hY3RpdmUiKSx0aGlzLmFjdGl2ZV9maWVsZD0hMCx0aGlzLnNlYXJjaF9maWVsZC52YWwodGhpcy5zZWFyY2hfZmllbGQudmFsKCkpLHRoaXMuc2VhcmNoX2ZpZWxkLmZvY3VzKCl9LGkucHJvdG90eXBlLnRlc3RfYWN0aXZlX2NsaWNrPWZ1bmN0aW9uKHQpewoJcmV0dXJuIGUodC50YXJnZXQpLnBhcmVudHMoIiMiK3RoaXMuY29udGFpbmVyX2lkKS5sZW5ndGg/dGhpcy5hY3RpdmVfZmllbGQ9ITA6dGhpcy5jbG9zZV9maWVsZCgpfSxpLnByb3RvdHlwZS5yZXN1bHRzX2J1aWxkPWZ1bmN0aW9uKCl7dmFyIHQsZSxpLHIscztmb3IodGhpcy5wYXJzaW5nPSEwLHRoaXMuc2VsZWN0ZWRfb3B0aW9uX2NvdW50PW51bGwsdGhpcy5yZXN1bHRzX2RhdGE9bi5TZWxlY3RQYXJzZXIuc2VsZWN0X3RvX2FycmF5KHRoaXMuZm9ybV9maWVsZCksdGhpcy5pc19tdWx0aXBsZT90aGlzLnNlYXJjaF9jaG9pY2VzLmZpbmQoImxpLnNlYXJjaC1jaG9pY2UiKS5yZW1vdmUoKTp0aGlzLmlzX211bHRpcGxlfHwodGhpcy5zZWxlY3RlZF9pdGVtLmFkZENsYXNzKCJjaHpuLWRlZmF1bHQiKS5maW5kKCJzcGFuIikudGV4dCh0aGlzLmRlZmF1bHRfdGV4dCksdGhpcy5kaXNhYmxlX3NlYXJjaHx8dGhpcy5mb3JtX2ZpZWxkLm9wdGlvbnMubGVuZ3RoPD10aGlzLmRpc2FibGVfc2VhcmNoX3RocmVzaG9sZD8odGhpcy5zZWFyY2hfZmllbGRbMF0ucmVhZE9ubHk9ITAsdGhpcy5jb250YWluZXIuYWRkQ2xhc3MoImNoem4tY29udGFpbmVyLXNpbmdsZS1ub3NlYXJjaCIpKToodGhpcy5zZWFyY2hfZmllbGRbMF0ucmVhZE9ubHk9ITEsdGhpcy5jb250YWluZXIucmVtb3ZlQ2xhc3MoImNoem4tY29udGFpbmVyLXNpbmdsZS1ub3NlYXJjaCIpKSksdD0iIixzPXRoaXMucmVzdWx0c19kYXRhLGk9MCxyPXMubGVuZ3RoO2k8cjtpKyspZT1zW2ldLGUuZ3JvdXA/dCs9dGhpcy5yZXN1bHRfYWRkX2dyb3VwKGUpOmUuZW1wdHl8fCh0Kz10aGlzLnJlc3VsdF9hZGRfb3B0aW9uKGUpLGUuc2VsZWN0ZWQmJnRoaXMuaXNfbXVsdGlwbGU/dGhpcy5jaG9pY2VfYnVpbGQoZSk6ZS5zZWxlY3RlZCYmIXRoaXMuaXNfbXVsdGlwbGUmJih0aGlzLnNlbGVjdGVkX2l0ZW0ucmVtb3ZlQ2xhc3MoImNoem4tZGVmYXVsdCIpLmZpbmQoInNwYW4iKS50ZXh0KGUudGV4dCksdGhpcy5hbGxvd19zaW5nbGVfZGVzZWxlY3QmJnRoaXMuc2luZ2xlX2Rlc2VsZWN0X2NvbnRyb2xfYnVpbGQoKSkpO3JldHVybiB0aGlzLnNlYXJjaF9maWVsZF9kaXNhYmxlZCgpLHRoaXMuc2hvd19zZWFyY2hfZmllbGRfZGVmYXVsdCgpLHRoaXMuc2VhcmNoX2ZpZWxkX3NjYWxlKCksdGhpcy5zZWFyY2hfcmVzdWx0cy5odG1sKHQpLHRoaXMucGFyc2luZz0hMX0saS5wcm90b3R5cGUucmVzdWx0X2FkZF9ncm91cD1mdW5jdGlvbih0KXtyZXR1cm4gdC5kb21faWQ9dGhpcy5jb250YWluZXJfaWQrIl9nXyIrdC5hcnJheV9pbmRleCwnPGxpIGlkPSInK3QuZG9tX2lkKyciIGNsYXNzPSJncm91cC1yZXN1bHQiPicrZSgiPGRpdiAvPiIpLnRleHQodC5sYWJlbCkuaHRtbCgpKyI8L2xpPiJ9LGkucHJvdG90eXBlLnJlc3VsdF9kb19oaWdobGlnaHQ9ZnVuY3Rpb24odCl7dmFyIGUsaSxuLHIscztpZih0Lmxlbmd0aCl7aWYodGhpcy5yZXN1bHRfY2xlYXJfaGlnaGxpZ2h0KCksdGhpcy5yZXN1bHRfaGlnaGxpZ2h0PXQsdGhpcy5yZXN1bHRfaGlnaGxpZ2h0LmFkZENsYXNzKCJoaWdobGlnaHRlZCIpLG49cGFyc2VJbnQodGhpcy5zZWFyY2hfcmVzdWx0cy5jc3MoIm1heEhlaWdodCIpLDEwKSxzPXRoaXMuc2VhcmNoX3Jlc3VsdHMuc2Nyb2xsVG9wKCkscj1uK3MsaT10aGlzLnJlc3VsdF9oaWdobGlnaHQucG9zaXRpb24oKS50b3ArdGhpcy5zZWFyY2hfcmVzdWx0cy5zY3JvbGxUb3AoKSxlPWkrdGhpcy5yZXN1bHRfaGlnaGxpZ2h0Lm91dGVySGVpZ2h0KCksZT49cilyZXR1cm4gdGhpcy5zZWFyY2hfcmVzdWx0cy5zY3JvbGxUb3AoZS1uPjA/ZS1uOjApO2lmKGk8cylyZXR1cm4gdGhpcy5zZWFyY2hfcmVzdWx0cy5zY3JvbGxUb3AoaSl9fSxpLnByb3RvdHlwZS5yZXN1bHRfY2xlYXJfaGlnaGxpZ2h0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVzdWx0X2hpZ2hsaWdodCYmdGhpcy5yZXN1bHRfaGlnaGxpZ2h0LnJlbW92ZUNsYXNzKCJoaWdobGlnaHRlZCIpLHRoaXMucmVzdWx0X2hpZ2hsaWdodD1udWxsfSxpLnByb3RvdHlwZS5yZXN1bHRzX3Nob3c9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc19tdWx0aXBsZSYmdGhpcy5tYXhfc2VsZWN0ZWRfb3B0aW9uczw9dGhpcy5jaG9pY2VzX2NvdW50KCk/KHRoaXMuZm9ybV9maWVsZF9qcS50cmlnZ2VyKCJsaXN6dDptYXhzZWxlY3RlZCIse2Nob3Nlbjp0aGlzfSksITEpOih0aGlzLmNvbnRhaW5lci5hZGRDbGFzcygiY2h6bi13aXRoLWRyb3AiKSx0aGlzLmZvcm1fZmllbGRfanEudHJpZ2dlcigibGlzenQ6c2hvd2luZ19kcm9wZG93biIse2Nob3Nlbjp0aGlzfSksdGhpcy5yZXN1bHRzX3Nob3dpbmc9ITAsdGhpcy5zZWFyY2hfZmllbGQuZm9jdXMoKSx0aGlzLnNlYXJjaF9maWVsZC52YWwodGhpcy5zZWFyY2hfZmllbGQudmFsKCkpLHRoaXMud2lubm93X3Jlc3VsdHMoKSl9LGkucHJvdG90eXBlLnJlc3VsdHNfaGlkZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlc3VsdHNfc2hvd2luZyYmKHRoaXMucmVzdWx0X2NsZWFyX2hpZ2hsaWdodCgpLHRoaXMuY29udGFpbmVyLnJlbW92ZUNsYXNzKCJjaHpuLXdpdGgtZHJvcCIpLHRoaXMuZm9ybV9maWVsZF9qcS50cmlnZ2VyKCJsaXN6dDpoaWRpbmdfZHJvcGRvd24iLHtjaG9zZW46dGhpc30pKSx0aGlzLnJlc3VsdHNfc2hvd2luZz0hMX0saS5wcm90b3R5cGUuc2V0X3RhYl9pbmRleD1mdW5jdGlvbih0KXt2YXIgZTtpZih0aGlzLmZvcm1fZmllbGRfanEuYXR0cigidGFiaW5kZXgiKSlyZXR1cm4gZT10aGlzLmZvcm1fZmllbGRfanEuYXR0cigidGFiaW5kZXgiKSx0aGlzLmZvcm1fZmllbGRfanEuYXR0cigidGFiaW5kZXgiLC0xKSx0aGlzLnNlYXJjaF9maWVsZC5hdHRyKCJ0YWJpbmRleCIsZSl9LGkucHJvdG90eXBlLnNldF9sYWJlbF9iZWhhdmlvcj1mdW5jdGlvbigpe3ZhciB0PXRoaXM7aWYodGhpcy5mb3JtX2ZpZWxkX2xhYmVsPXRoaXMuZm9ybV9maWVsZF9qcS5wYXJlbnRzKCJsYWJlbCIpLCF0aGlzLmZvcm1fZmllbGRfbGFiZWwubGVuZ3RoJiZ0aGlzLmZvcm1fZmllbGQuaWQubGVuZ3RoJiYodGhpcy5mb3JtX2ZpZWxkX2xhYmVsPWUoImxhYmVsW2Zvcj0nIit0aGlzLmZvcm1fZmllbGQuaWQrIiddIikpLHRoaXMuZm9ybV9maWVsZF9sYWJlbC5sZW5ndGg+MClyZXR1cm4gdGhpcy5mb3JtX2ZpZWxkX2xhYmVsLmNsaWNrKGZ1bmN0aW9uKGUpe3JldHVybiB0LmlzX211bHRpcGxlP3QuY29udGFpbmVyX21vdXNlZG93bihlKTp0LmFjdGl2YXRlX2ZpZWxkKCl9KX0saS5wcm90b3R5cGUuc2hvd19zZWFyY2hfZmllbGRfZGVmYXVsdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzX211bHRpcGxlJiZ0aGlzLmNob2ljZXNfY291bnQoKTwxJiYhdGhpcy5hY3RpdmVfZmllbGQ/KHRoaXMuc2VhcmNoX2ZpZWxkLnZhbCh0aGlzLmRlZmF1bHRfdGV4dCksdGhpcy5zZWFyY2hfZmllbGQuYWRkQ2xhc3MoImRlZmF1bHQiKSk6KHRoaXMuc2VhcmNoX2ZpZWxkLnZhbCgiIiksdGhpcy5zZWFyY2hfZmllbGQucmVtb3ZlQ2xhc3MoImRlZmF1bHQiKSl9LGkucHJvdG90eXBlLnNlYXJjaF9yZXN1bHRzX21vdXNldXA9ZnVuY3Rpb24odCl7dmFyIGk7aWYoaT1lKHQudGFyZ2V0KS5oYXNDbGFzcygiYWN0aXZlLXJlc3VsdCIpP2UodC50YXJnZXQpOmUodC50YXJnZXQpLnBhcmVudHMoIi5hY3RpdmUtcmVzdWx0IikuZmlyc3QoKSxpLmxlbmd0aClyZXR1cm4gdGhpcy5yZXN1bHRfaGlnaGxpZ2h0PWksdGhpcy5yZXN1bHRfc2VsZWN0KHQpLHRoaXMuc2VhcmNoX2ZpZWxkLmZvY3VzKCl9LGkucHJvdG90eXBlLnNlYXJjaF9yZXN1bHRzX21vdXNlb3Zlcj1mdW5jdGlvbih0KXt2YXIgaTtpZihpPWUodC50YXJnZXQpLmhhc0NsYXNzKCJhY3RpdmUtcmVzdWx0Iik/ZSh0LnRhcmdldCk6ZSh0LnRhcmdldCkucGFyZW50cygiLmFjdGl2ZS1yZXN1bHQiKS5maXJzdCgpKXJldHVybiB0aGlzLnJlc3VsdF9kb19oaWdobGlnaHQoaSl9LGkucHJvdG90eXBlLnNlYXJjaF9yZXN1bHRzX21vdXNlb3V0PWZ1bmN0aW9uKHQpe2lmKGUodC50YXJnZXQpLmhhc0NsYXNzKCJhY3RpdmUtcmVzdWx0IikpcmV0dXJuIHRoaXMucmVzdWx0X2NsZWFyX2hpZ2hsaWdodCgpfSxpLnByb3RvdHlwZS5jaG9pY2VfYnVpbGQ9ZnVuY3Rpb24odCl7dmFyIGksbixyPXRoaXM7cmV0dXJuIGk9ZSgiPGxpIC8+Iix7ImNsYXNzIjoic2VhcmNoLWNob2ljZSJ9KS5odG1sKCI8c3Bhbj4iK3QuaHRtbCsiPC9zcGFuPiIpLHQuZGlzYWJsZWQ/aS5hZGRDbGFzcygic2VhcmNoLWNob2ljZS1kaXNhYmxlZCIpOihuPWUoIjxhIC8+Iix7aHJlZjoiIyIsImNsYXNzIjoic2VhcmNoLWNob2ljZS1jbG9zZSIscmVsOnQuYXJyYXlfaW5kZXh9KSxuLmNsaWNrKGZ1bmN0aW9uKHQpe3JldHVybiByLmNob2ljZV9kZXN0cm95X2xpbmtfY2xpY2sodCl9KSxpLmFwcGVuZChuKSksdGhpcy5zZWFyY2hfY29udGFpbmVyLmJlZm9yZShpKX0saS5wcm90b3R5cGUuY2hvaWNlX2Rlc3Ryb3lfbGlua19jbGljaz1mdW5jdGlvbih0KXtpZih0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKSwhdGhpcy5pc19kaXNhYmxlZClyZXR1cm4gdGhpcy5jaG9pY2VfZGVzdHJveShlKHQudGFyZ2V0KSl9LGkucHJvdG90eXBlLmNob2ljZV9kZXN0cm95PWZ1bmN0aW9uKHQpe2lmKHRoaXMucmVzdWx0X2Rlc2VsZWN0KHQuYXR0cigicmVsIikpKXJldHVybiB0aGlzLnNob3dfc2VhcmNoX2ZpZWxkX2RlZmF1bHQoKSx0aGlzLmlzX211bHRpcGxlJiZ0aGlzLmNob2ljZXNfY291bnQoKT4wJiZ0aGlzLnNlYXJjaF9maWVsZC52YWwoKS5sZW5ndGg8MSYmdGhpcy5yZXN1bHRzX2hpZGUoKSx0LnBhcmVudHMoImxpIikuZmlyc3QoKS5yZW1vdmUoKSx0aGlzLnNlYXJjaF9maWVsZF9zY2FsZSgpfSxpLnByb3RvdHlwZS5yZXN1bHRzX3Jlc2V0PWZ1bmN0aW9uKCl7aWYodGhpcy5mb3JtX2ZpZWxkLm9wdGlvbnNbMF0uc2VsZWN0ZWQ9ITAsdGhpcy5zZWxlY3RlZF9vcHRpb25fY291bnQ9bnVsbCx0aGlzLnNlbGVjdGVkX2l0ZW0uZmluZCgic3BhbiIpLnRleHQodGhpcy5kZWZhdWx0X3RleHQpLHRoaXMuaXNfbXVsdGlwbGV8fHRoaXMuc2VsZWN0ZWRfaXRlbS5hZGRDbGFzcygiY2h6bi1kZWZhdWx0IiksdGhpcy5zaG93X3NlYXJjaF9maWVsZF9kZWZhdWx0KCksdGhpcy5yZXN1bHRzX3Jlc2V0X2NsZWFudXAoKSx0aGlzLmZvcm1fZmllbGRfanEudHJpZ2dlcigiY2hhbmdlIiksdGhpcy5hY3RpdmVfZmllbGQpcmV0dXJuIHRoaXMucmVzdWx0c19oaWRlKCl9LGkucHJvdG90eXBlLnJlc3VsdHNfcmVzZXRfY2xlYW51cD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmN1cnJlbnRfc2VsZWN0ZWRJbmRleD10aGlzLmZvcm1fZmllbGQuc2VsZWN0ZWRJbmRleCx0aGlzLnNlbGVjdGVkX2l0ZW0uZmluZCgiYWJiciIpLnJlbW92ZSgpfSxpLnByb3RvdHlwZS5yZXN1bHRfc2VsZWN0PWZ1bmN0aW9uKHQpe3ZhciBlLGksbixyO2lmKHRoaXMucmVzdWx0X2hpZ2hsaWdodClyZXR1cm4gZT10aGlzLnJlc3VsdF9oaWdobGlnaHQsaT1lLmF0dHIoImlkIiksdGhpcy5yZXN1bHRfY2xlYXJfaGlnaGxpZ2h0KCksdGhpcy5pc19tdWx0aXBsZSYmdGhpcy5tYXhfc2VsZWN0ZWRfb3B0aW9uczw9dGhpcy5jaG9pY2VzX2NvdW50KCk/KHRoaXMuZm9ybV9maWVsZF9qcS50cmlnZ2VyKCJsaXN6dDptYXhzZWxlY3RlZCIse2Nob3Nlbjp0aGlzfSksITEpOih0aGlzLmlzX211bHRpcGxlP2UucmVtb3ZlQ2xhc3MoImFjdGl2ZS1yZXN1bHQiKToodGhpcy5zZWFyY2hfcmVzdWx0cy5maW5kKCIucmVzdWx0LXNlbGVjdGVkIikucmVtb3ZlQ2xhc3MoInJlc3VsdC1zZWxlY3RlZCIpLHRoaXMucmVzdWx0X3NpbmdsZV9zZWxlY3RlZD1lLHRoaXMuc2VsZWN0ZWRfaXRlbS5yZW1vdmVDbGFzcygiY2h6bi1kZWZhdWx0IikpLGUuYWRkQ2xhc3MoInJlc3VsdC1zZWxlY3RlZCIpLHI9aS5zdWJzdHIoaS5sYXN0SW5kZXhPZigiXyIpKzEpLG49dGhpcy5yZXN1bHRzX2RhdGFbcl0sbi5zZWxlY3RlZD0hMCx0aGlzLmZvcm1fZmllbGQub3B0aW9uc1tuLm9wdGlvbnNfaW5kZXhdLnNlbGVjdGVkPSEwLHRoaXMuc2VsZWN0ZWRfb3B0aW9uX2NvdW50PW51bGwsdGhpcy5pc19tdWx0aXBsZQ==", "base64"));
  res.write(new Buffer("P3RoaXMuY2hvaWNlX2J1aWxkKG4pOih0aGlzLnNlbGVjdGVkX2l0ZW0uZmluZCgic3BhbiIpLmZpcnN0KCkudGV4dChuLnRleHQpLHRoaXMuYWxsb3dfc2luZ2xlX2Rlc2VsZWN0JiZ0aGlzLnNpbmdsZV9kZXNlbGVjdF9jb250cm9sX2J1aWxkKCkpLCh0Lm1ldGFLZXl8fHQuY3RybEtleSkmJnRoaXMuaXNfbXVsdGlwbGV8fHRoaXMucmVzdWx0c19oaWRlKCksdGhpcy5zZWFyY2hfZmllbGQudmFsKCIiKSwodGhpcy5pc19tdWx0aXBsZXx8dGhpcy5mb3JtX2ZpZWxkLnNlbGVjdGVkSW5kZXghPT10aGlzLmN1cnJlbnRfc2VsZWN0ZWRJbmRleCkmJnRoaXMuZm9ybV9maWVsZF9qcS50cmlnZ2VyKCJjaGFuZ2UiLHtzZWxlY3RlZDp0aGlzLmZvcm1fZmllbGQub3B0aW9uc1tuLm9wdGlvbnNfaW5kZXhdLnZhbHVlfSksdGhpcy5jdXJyZW50X3NlbGVjdGVkSW5kZXg9dGhpcy5mb3JtX2ZpZWxkLnNlbGVjdGVkSW5kZXgsdGhpcy5zZWFyY2hfZmllbGRfc2NhbGUoKSl9LGkucHJvdG90eXBlLnJlc3VsdF9hY3RpdmF0ZT1mdW5jdGlvbih0LGUpe3JldHVybiBlLmRpc2FibGVkP3QuYWRkQ2xhc3MoImRpc2FibGVkLXJlc3VsdCIpOnRoaXMuaXNfbXVsdGlwbGUmJmUuc2VsZWN0ZWQ/dC5hZGRDbGFzcygicmVzdWx0LXNlbGVjdGVkIik6dC5hZGRDbGFzcygiYWN0aXZlLXJlc3VsdCIpfSxpLnByb3RvdHlwZS5yZXN1bHRfZGVhY3RpdmF0ZT1mdW5jdGlvbih0KXtyZXR1cm4gdC5yZW1vdmVDbGFzcygiYWN0aXZlLXJlc3VsdCByZXN1bHQtc2VsZWN0ZWQgZGlzYWJsZWQtcmVzdWx0Iil9LGkucHJvdG90eXBlLnJlc3VsdF9kZXNlbGVjdD1mdW5jdGlvbih0KXt2YXIgaSxuO3JldHVybiBuPXRoaXMucmVzdWx0c19kYXRhW3RdLCF0aGlzLmZvcm1fZmllbGQub3B0aW9uc1tuLm9wdGlvbnNfaW5kZXhdLmRpc2FibGVkJiYobi5zZWxlY3RlZD0hMSx0aGlzLmZvcm1fZmllbGQub3B0aW9uc1tuLm9wdGlvbnNfaW5kZXhdLnNlbGVjdGVkPSExLHRoaXMuc2VsZWN0ZWRfb3B0aW9uX2NvdW50PW51bGwsaT1lKCIjIit0aGlzLmNvbnRhaW5lcl9pZCsiX29fIit0KSxpLnJlbW92ZUNsYXNzKCJyZXN1bHQtc2VsZWN0ZWQiKS5hZGRDbGFzcygiYWN0aXZlLXJlc3VsdCIpLnNob3coKSx0aGlzLnJlc3VsdF9jbGVhcl9oaWdobGlnaHQoKSx0aGlzLndpbm5vd19yZXN1bHRzKCksdGhpcy5mb3JtX2ZpZWxkX2pxLnRyaWdnZXIoImNoYW5nZSIse2Rlc2VsZWN0ZWQ6dGhpcy5mb3JtX2ZpZWxkLm9wdGlvbnNbbi5vcHRpb25zX2luZGV4XS52YWx1ZX0pLHRoaXMuc2VhcmNoX2ZpZWxkX3NjYWxlKCksITApfSxpLnByb3RvdHlwZS5zaW5nbGVfZGVzZWxlY3RfY29udHJvbF9idWlsZD1mdW5jdGlvbigpe2lmKHRoaXMuYWxsb3dfc2luZ2xlX2Rlc2VsZWN0KXJldHVybiB0aGlzLnNlbGVjdGVkX2l0ZW0uZmluZCgiYWJiciIpLmxlbmd0aHx8dGhpcy5zZWxlY3RlZF9pdGVtLmZpbmQoInNwYW4iKS5maXJzdCgpLmFmdGVyKCc8YWJiciBjbGFzcz0ic2VhcmNoLWNob2ljZS1jbG9zZSI+PC9hYmJyPicpLHRoaXMuc2VsZWN0ZWRfaXRlbS5hZGRDbGFzcygiY2h6bi1zaW5nbGUtd2l0aC1kZXNlbGVjdCIpfSxpLnByb3RvdHlwZS53aW5ub3dfcmVzdWx0cz1mdW5jdGlvbigpe3ZhciB0LGksbixyLHMsbyxhLGwsYyx1LGQsaCxwLGYsbSxfLGcsdjtmb3IodGhpcy5ub19yZXN1bHRzX2NsZWFyKCksYz0wLHU9dGhpcy5zZWFyY2hfZmllbGQudmFsKCk9PT10aGlzLmRlZmF1bHRfdGV4dD8iIjplKCI8ZGl2Lz4iKS50ZXh0KGUudHJpbSh0aGlzLnNlYXJjaF9maWVsZC52YWwoKSkpLmh0bWwoKSxvPXRoaXMuc2VhcmNoX2NvbnRhaW5zPyIiOiJeIixzPW5ldyBSZWdFeHAobyt1LnJlcGxhY2UoL1stW1xde30oKSorPy4sXFxeJHwjXHNdL2csIlxcJCYiKSwiaSIpLHA9bmV3IFJlZ0V4cCh1LnJlcGxhY2UoL1stW1xde30oKSorPy4sXFxeJHwjXHNdL2csIlxcJCYiKSwiaSIpLHY9dGhpcy5yZXN1bHRzX2RhdGEsZj0wLF89di5sZW5ndGg7ZjxfO2YrKylpZihpPXZbZl0sIWkuZW1wdHkpaWYoaS5ncm91cCllKCIjIitpLmRvbV9pZCkuY3NzKCJkaXNwbGF5Iiwibm9uZSIpO2Vsc2V7aWYodD0hMSxsPWkuZG9tX2lkLGE9ZSgiIyIrbCkscy50ZXN0KGkuaHRtbCkpdD0hMCxjKz0xO2Vsc2UgaWYodGhpcy5lbmFibGVfc3BsaXRfd29yZF9zZWFyY2gmJihpLmh0bWwuaW5kZXhPZigiICIpPj0wfHwwPT09aS5odG1sLmluZGV4T2YoIlsiKSkmJihyPWkuaHRtbC5yZXBsYWNlKC9cW3xcXS9nLCIiKS5zcGxpdCgiICIpLHIubGVuZ3RoKSlmb3IobT0wLGc9ci5sZW5ndGg7bTxnO20rKyluPXJbbV0scy50ZXN0KG4pJiYodD0hMCxjKz0xKTt0Pyh1Lmxlbmd0aD8oZD1pLmh0bWwuc2VhcmNoKHApLGg9aS5odG1sLnN1YnN0cigwLGQrdS5sZW5ndGgpKyI8L2VtPiIraS5odG1sLnN1YnN0cihkK3UubGVuZ3RoKSxoPWguc3Vic3RyKDAsZCkrIjxlbT4iK2guc3Vic3RyKGQpKTpoPWkuaHRtbCxhLmh0bWwoaCksdGhpcy5yZXN1bHRfYWN0aXZhdGUoYSxpKSxudWxsIT1pLmdyb3VwX2FycmF5X2luZGV4JiZlKCIjIit0aGlzLnJlc3VsdHNfZGF0YVtpLmdyb3VwX2FycmF5X2luZGV4XS5kb21faWQpLmNzcygiZGlzcGxheSIsImxpc3QtaXRlbSIpKToodGhpcy5yZXN1bHRfaGlnaGxpZ2h0JiZsPT09dGhpcy5yZXN1bHRfaGlnaGxpZ2h0LmF0dHIoImlkIikmJnRoaXMucmVzdWx0X2NsZWFyX2hpZ2hsaWdodCgpLHRoaXMucmVzdWx0X2RlYWN0aXZhdGUoYSkpfXJldHVybiBjPDEmJnUubGVuZ3RoP3RoaXMubm9fcmVzdWx0cyh1KTp0aGlzLndpbm5vd19yZXN1bHRzX3NldF9oaWdobGlnaHQoKX0saS5wcm90b3R5cGUud2lubm93X3Jlc3VsdHNfc2V0X2hpZ2hsaWdodD1mdW5jdGlvbigpe3ZhciB0LGU7aWYoIXRoaXMucmVzdWx0X2hpZ2hsaWdodCYmKGU9dGhpcy5pc19tdWx0aXBsZT9bXTp0aGlzLnNlYXJjaF9yZXN1bHRzLmZpbmQoIi5yZXN1bHQtc2VsZWN0ZWQuYWN0aXZlLXJlc3VsdCIpLHQ9ZS5sZW5ndGg/ZS5maXJzdCgpOnRoaXMuc2VhcmNoX3Jlc3VsdHMuZmluZCgiLmFjdGl2ZS1yZXN1bHQiKS5maXJzdCgpLG51bGwhPXQpKXJldHVybiB0aGlzLnJlc3VsdF9kb19oaWdobGlnaHQodCl9LGkucHJvdG90eXBlLm5vX3Jlc3VsdHM9ZnVuY3Rpb24odCl7dmFyIGk7cmV0dXJuIGk9ZSgnPGxpIGNsYXNzPSJuby1yZXN1bHRzIj4nK3RoaXMucmVzdWx0c19ub25lX2ZvdW5kKycgIjxzcGFuPjwvc3Bhbj4iPC9saT4nKSxpLmZpbmQoInNwYW4iKS5maXJzdCgpLmh0bWwodCksdGhpcy5zZWFyY2hfcmVzdWx0cy5hcHBlbmQoaSl9LGkucHJvdG90eXBlLm5vX3Jlc3VsdHNfY2xlYXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWFyY2hfcmVzdWx0cy5maW5kKCIubm8tcmVzdWx0cyIpLnJlbW92ZSgpfSxpLnByb3RvdHlwZS5rZXlkb3duX2Fycm93PWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIHRoaXMucmVzdWx0c19zaG93aW5nJiZ0aGlzLnJlc3VsdF9oaWdobGlnaHQ/KHQ9dGhpcy5yZXN1bHRfaGlnaGxpZ2h0Lm5leHRBbGwoImxpLmFjdGl2ZS1yZXN1bHQiKS5maXJzdCgpKT90aGlzLnJlc3VsdF9kb19oaWdobGlnaHQodCk6dm9pZCAwOnRoaXMucmVzdWx0c19zaG93KCl9LGkucHJvdG90eXBlLmtleXVwX2Fycm93PWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIHRoaXMucmVzdWx0c19zaG93aW5nfHx0aGlzLmlzX211bHRpcGxlP3RoaXMucmVzdWx0X2hpZ2hsaWdodD8odD10aGlzLnJlc3VsdF9oaWdobGlnaHQucHJldkFsbCgibGkuYWN0aXZlLXJlc3VsdCIpLHQubGVuZ3RoP3RoaXMucmVzdWx0X2RvX2hpZ2hsaWdodCh0LmZpcnN0KCkpOih0aGlzLmNob2ljZXNfY291bnQoKT4wJiZ0aGlzLnJlc3VsdHNfaGlkZSgpLHRoaXMucmVzdWx0X2NsZWFyX2hpZ2hsaWdodCgpKSk6dm9pZCAwOnRoaXMucmVzdWx0c19zaG93KCl9LGkucHJvdG90eXBlLmtleWRvd25fYmFja3N0cm9rZT1mdW5jdGlvbigpe3ZhciB0O3JldHVybiB0aGlzLnBlbmRpbmdfYmFja3N0cm9rZT8odGhpcy5jaG9pY2VfZGVzdHJveSh0aGlzLnBlbmRpbmdfYmFja3N0cm9rZS5maW5kKCJhIikuZmlyc3QoKSksdGhpcy5jbGVhcl9iYWNrc3Ryb2tlKCkpOih0PXRoaXMuc2VhcmNoX2NvbnRhaW5lci5zaWJsaW5ncygibGkuc2VhcmNoLWNob2ljZSIpLmxhc3QoKSx0Lmxlbmd0aCYmIXQuaGFzQ2xhc3MoInNlYXJjaC1jaG9pY2UtZGlzYWJsZWQiKT8odGhpcy5wZW5kaW5nX2JhY2tzdHJva2U9dCx0aGlzLnNpbmdsZV9iYWNrc3Ryb2tlX2RlbGV0ZT90aGlzLmtleWRvd25fYmFja3N0cm9rZSgpOnRoaXMucGVuZGluZ19iYWNrc3Ryb2tlLmFkZENsYXNzKCJzZWFyY2gtY2hvaWNlLWZvY3VzIikpOnZvaWQgMCl9LGkucHJvdG90eXBlLmNsZWFyX2JhY2tzdHJva2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wZW5kaW5nX2JhY2tzdHJva2UmJnRoaXMucGVuZGluZ19iYWNrc3Ryb2tlLnJlbW92ZUNsYXNzKCJzZWFyY2gtY2hvaWNlLWZvY3VzIiksdGhpcy5wZW5kaW5nX2JhY2tzdHJva2U9bnVsbH0saS5wcm90b3R5cGUua2V5ZG93bl9jaGVja2VyPWZ1bmN0aW9uKHQpe3ZhciBlLGk7c3dpdGNoKGU9bnVsbCE9KGk9dC53aGljaCk/aTp0LmtleUNvZGUsdGhpcy5zZWFyY2hfZmllbGRfc2NhbGUoKSw4IT09ZSYmdGhpcy5wZW5kaW5nX2JhY2tzdHJva2UmJnRoaXMuY2xlYXJfYmFja3N0cm9rZSgpLGUpe2Nhc2UgODp0aGlzLmJhY2tzdHJva2VfbGVuZ3RoPXRoaXMuc2VhcmNoX2ZpZWxkLnZhbCgpLmxlbmd0aDticmVhaztjYXNlIDk6dGhpcy5yZXN1bHRzX3Nob3dpbmcmJiF0aGlzLmlzX211bHRpcGxlJiZ0aGlzLnJlc3VsdF9zZWxlY3QodCksdGhpcy5tb3VzZV9vbl9jb250YWluZXI9ITE7YnJlYWs7Y2FzZSAxMzp0LnByZXZlbnREZWZhdWx0KCk7YnJlYWs7Y2FzZSAzODp0LnByZXZlbnREZWZhdWx0KCksdGhpcy5rZXl1cF9hcnJvdygpO2JyZWFrO2Nhc2UgNDA6dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMua2V5ZG93bl9hcnJvdygpfX0saS5wcm90b3R5cGUuc2VhcmNoX2ZpZWxkX3NjYWxlPWZ1bmN0aW9uKCl7dmFyIHQsaSxuLHIscyxvLGEsbDtpZih0aGlzLmlzX211bHRpcGxlKXtmb3IoaT0wLG89MCxyPSJwb3NpdGlvbjphYnNvbHV0ZTsgbGVmdDogLTEwMDBweDsgdG9wOiAtMTAwMHB4OyBkaXNwbGF5Om5vbmU7IixzPVsiZm9udC1zaXplIiwiZm9udC1zdHlsZSIsImZvbnQtd2VpZ2h0IiwiZm9udC1mYW1pbHkiLCJsaW5lLWhlaWdodCIsInRleHQtdHJhbnNmb3JtIiwibGV0dGVyLXNwYWNpbmciXSxhPTAsbD1zLmxlbmd0aDthPGw7YSsrKW49c1thXSxyKz1uKyI6Iit0aGlzLnNlYXJjaF9maWVsZC5jc3MobikrIjsiO3JldHVybiB0PWUoIjxkaXYgLz4iLHtzdHlsZTpyfSksdC50ZXh0KHRoaXMuc2VhcmNoX2ZpZWxkLnZhbCgpKSxlKCJib2R5IikuYXBwZW5kKHQpLG89dC53aWR0aCgpKzI1LHQucmVtb3ZlKCksdGhpcy5mX3dpZHRofHwodGhpcy5mX3dpZHRoPXRoaXMuY29udGFpbmVyLm91dGVyV2lkdGgoKSksbz50aGlzLmZfd2lkdGgtMTAmJihvPXRoaXMuZl93aWR0aC0xMCksdGhpcy5zZWFyY2hfZmllbGQuY3NzKHt3aWR0aDpvKyJweCJ9KX19LGkucHJvdG90eXBlLmdlbmVyYXRlX3JhbmRvbV9pZD1mdW5jdGlvbigpe3ZhciB0O2Zvcih0PSJzZWwiK3RoaXMuZ2VuZXJhdGVfcmFuZG9tX2NoYXIoKSt0aGlzLmdlbmVyYXRlX3JhbmRvbV9jaGFyKCkrdGhpcy5nZW5lcmF0ZV9yYW5kb21fY2hhcigpO2UoIiMiK3QpLmxlbmd0aD4wOyl0Kz10aGlzLmdlbmVyYXRlX3JhbmRvbV9jaGFyKCk7cmV0dXJuIHR9LGl9KGEpLG4uQ2hvc2VuPWl9LmNhbGwodGhpcyl9LmFwcGx5KGUsbiksLy8gQ2hvc2VuLCBhIFNlbGVjdCBCb3ggRW5oYW5jZXIgZm9yIGpRdWVyeSBhbmQgUHJvdG90eXBlCgkvLyBieSBQYXRyaWNrIEZpbGxlciBmb3IgSGFydmVzdCwgaHR0cDovL2dldGhhcnZlc3QuY29tCgkvLyBWZXJzaW9uIDAuMTEuMQoJLy8gRnVsbCBzb3VyY2UgYXQgaHR0cHM6Ly9naXRodWIuY29tL2hhcnZlc3RocS9jaG9zZW4KCS8vIENvcHlyaWdodCAoYykgMjAxMSBIYXJ2ZXN0IGh0dHA6Ly9nZXRoYXJ2ZXN0LmNvbQoJLy8gTUlUIExpY2Vuc2UsIGh0dHBzOi8vZ2l0aHViLmNvbS9oYXJ2ZXN0aHEvY2hvc2VuL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQKCSEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSg1KSxpKDE3MyksaSgxNDcpLGkoMjAzKSxpKDIwOSldLHI9ZnVuY3Rpb24odCxlLGksbixyKXt2YXIgcz1uLnRwbCgnXHQgICAgICA8aW5wdXQgdHlwZT0icmFkaW8iIG5hbWU9Int7bmFtZX19IiBkYXRhLXNlLW5hbWU9Int7cmVhbE5hbWV9fSIgdmFsdWU9Int7dmFsdWV9fSIgaWQ9Int7aWR9fSI+XHQgICAgICA8bGFiZWwgZm9yPSJ7e2lkfX0iIGRhdGEtc2UtZm9yLW5hbWU9Int7cmVhbE5hbWV9fSI+XHQgICAgICAgIHt7bGFiZWx9fVx0ICAgICAgICB7eyNpZiBleHBsYWlufX1cdCAgICAgICAgPHAgY2xhc3M9Im8tZm9ybS1leHBsYWluIj57e2V4cGxhaW59fTwvcD5cdCAgICAgICAge3svaWZ9fVx0ICAgICAgPC9sYWJlbD5cdCAgJyk7cmV0dXJuIHIuZXh0ZW5kKHtldmVudHM6eyJjaGFuZ2UgOnJhZGlvIjoidXBkYXRlIixrZXl1cDpmdW5jdGlvbih0KXtpLmlzU3BhY2VCYXIodCk/ZSh0LnRhcmdldCkuY2xpY2soKTppLmlzRW50ZXIodCkmJnRoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpzYXZlIil9fSxlZGl0TW9kZTpmdW5jdGlvbigpe3RoaXMuJGVsLmVtcHR5KCksdC5lYWNoKHRoaXMub3B0aW9ucy5vcHRpb25zLGZ1bmN0aW9uKGUsaSl7dmFyIG49e2lkOnQudW5pcXVlSWQoIm9wdGlvbiIpLG5hbWU6dGhpcy5vcHRpb25zLmlucHV0SWQscmVhbE5hbWU6dGhpcy5vcHRpb25zLm5hbWUsdmFsdWU6aX07dC5pc09iamVjdChlKXx8KGU9e2xhYmVsOmV9KSx0LmV4dGVuZChuLGUpLHRoaXMuJGVsLmFwcGVuZChzKG4pKX0sdGhpcyk7dmFyIGU9dGhpcy5nZXRNb2RlbFZhbHVlKCk7cmV0dXJuIGUmJnRoaXMuJCgiOnJhZGlvW3ZhbHVlPSIrZSsiXSIpLnByb3AoImNoZWNrZWQiLCEwKSx0aGlzLiQoImlucHV0IikuY3VzdG9tSW5wdXQoKSx0aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06cmVzaXplIiksdGhpcy5nZXRQYXJhbSgiaW5saW5lIik9PT0hMCYmdGhpcy4kKCJkaXYuY3VzdG9tLXJhZGlvIikuYWRkQ2xhc3MoImlubGluZSIpLHRoaXN9LHJlYWRNb2RlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRpdE1vZGUoKSx0aGlzLiQoIjpyYWRpbyIpLnByb3AoImRpc2FibGVkIiwhMCksdGhpc30sdmFsOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCgiOnJhZGlvOmNoZWNrZWQiKS52YWwoKX0sZm9jdXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kKCJsYWJlbDplcSgwKSIpLmZvY3VzKCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg2KV0scj1mdW5jdGlvbih0KXt2YXIgZT10O3QuZm4uY3VzdG9tSW5wdXQ9ZnVuY3Rpb24oKXtyZXR1cm4gZSh0aGlzKS5lYWNoKGZ1bmN0aW9uKCl7aWYoZSh0aGlzKS5pcygiW3R5cGU9Y2hlY2tib3hdLFt0eXBlPXJhZGlvXSIpKXt2YXIgdD1lKHRoaXMpLGk9dC5zaWJsaW5ncygnbGFiZWxbZm9yPSInK3QuYXR0cigiaWQiKSsnIl06Zmlyc3QnKTtpLmxlbmd0aHx8KGk9dC5jbG9zZXN0KCdsYWJlbFtmb3I9IicrdC5hdHRyKCJpZCIpKyciXTpmaXJzdCcpKSx0LmFkZChpKS53cmFwQWxsKCc8ZGl2IGNsYXNzPSJjdXN0b20tJyt0LmF0dHIoInR5cGUiKSsnIj48L2Rpdj4nKSxpLmhvdmVyKGZ1bmN0aW9uKCl7ZSh0aGlzKS5hZGRDbGFzcygiaG92ZXIiKX0sZnVuY3Rpb24oKXtlKHRoaXMpLnJlbW92ZUNsYXNzKCJob3ZlciIpfSksdC5iaW5kKCJ1cGRhdGVTdGF0ZSIsZnVuY3Rpb24oKXt0LmlzKCI6Y2hlY2tlZCIpP2kuYWRkQ2xhc3MoImNoZWNrZWQiKTppLnJlbW92ZUNsYXNzKCJjaGVja2VkIGNoZWNrZWRIb3ZlciBjaGVja2VkRm9jdXMiKX0pLnRyaWdnZXIoInVwZGF0ZVN0YXRlIikuY2xpY2soZnVuY3Rpb24oKXtlKCdpbnB1dFtuYW1lPSInK2UodGhpcykuYXR0cigibmFtZSIpKyciXScpLnRyaWdnZXIoInVwZGF0ZVN0YXRlIil9KS5mb2N1cyhmdW5jdGlvbigpe2kuYWRkQ2xhc3MoImZvY3VzIiksdC5pcygiOmNoZWNrZWQiKSYmZSh0aGlzKS5hZGRDbGFzcygiY2hlY2tlZEZvY3VzIil9KS5ibHVyKGZ1bmN0aW9uKCl7aS5yZW1vdmVDbGFzcygiZm9jdXMgY2hlY2tlZEZvY3VzIil9KX19KX19LmFwcGx5KGUsbiksLyoqCgkJICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCQkgKiBqUXVlcnkgY3VzdG9tSW5wdXQgcGx1Z2luCgkJICogQXV0aG9yOiBNYWdnaWUgQ29zdGVsbG8gV2FjaHMgbWFnZ2llQGZpbGFtZW50Z3JvdXAuY29tLCBTY290dCBKZWhsLCBzY290dEBmaWxhbWVudGdyb3VwLmNvbQoJCSAqIENvcHlyaWdodCAoYykgMjAwOSBGaWxhbWVudCBHcm91cAoJCSAqIGxpY2Vuc2VkIHVuZGVyIE1JVCAoZmlsYW1lbnRncm91cC5jb20vZXhhbXBsZXMvbWl0LWxpY2Vuc2UudHh0KQoJCSAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgkJKi8KCSEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNzMpLGkoMTQ3KSxpKDIwMyksaSgyMDkpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPWkudHBsKCdcdCAgICA8aW5wdXQgdHlwZT0iY2hlY2tib3giIG5hbWU9Int7bmFtZX19IiBpZD0ie3tpbnB1dElkfX0iLz5cdCAgICA8bGFiZWwgZm9yPSJ7e2lucHV0SWR9fSIgZGF0YS1zZS1mb3ItbmFtZT0ie3tuYW1lfX0iPnt7cGxhY2Vob2xkZXJ9fTwvbGFiZWw+XHQgICcpO3JldHVybiBuLmV4dGVuZCh7dGVtcGxhdGU6cixldmVudHM6eyJjaGFuZ2UgOmNoZWNrYm94IjoidXBkYXRlIixrZXl1cDpmdW5jdGlvbih0KXtlLmlzU3BhY2VCYXIodCk/dGhpcy4kKCI6Y2hlY2tib3giKS5jbGljaygpOmUuaXNFbnRlcih0KSYmdGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOnNhdmUiKX19LGVkaXRNb2RlOmZ1bmN0aW9uKCl7dmFyIGU9dC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLCJwbGFjZWhvbGRlciIsdGhpcyk7IiI9PT1lP2U9dC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLCJsYWJlbCIsdGhpcyk6ZT09PSExJiYoZT0iIiksdGhpcy4kZWwuaHRtbCh0aGlzLnRlbXBsYXRlKHQuZXh0ZW5kKHQub21pdCh0aGlzLm9wdGlvbnMsInBsYWNlaG9sZGVyIikse3BsYWNlaG9sZGVyOmV9KSkpO3ZhciBpPXRoaXMuJCgiOmNoZWNrYm94Iik7cmV0dXJuIGkucHJvcCgiY2hlY2tlZCIsdGhpcy5nZXRNb2RlbFZhbHVlKCl8fCExKSx0aGlzLiQoImlucHV0IikuY3VzdG9tSW5wdXQoKSx0aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06cmVzaXplIiksdGhpc30scmVhZE1vZGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGl0TW9kZSgpLHRoaXMuJCgiOmNoZWNrYm94IikucHJvcCgiZGlzYWJsZWQiLCEwKSx0aGlzfSx2YWw6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kKCI6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIil9LGZvY3VzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCgiOmNoZWNrYm94IikuZm9jdXMoKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSl7fSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSl7fSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSl7fSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDIwMyksaSgxNDYpLGkoMTUzKV0scj1mdW5jdGlvbih0LGUsaSxuKXtmdW5jdGlvbiByKGUpe3JldHVybiB0LmZpbHRlcihlfHxbXSxmdW5jdGlvbihlKXtyZXR1cm4hdC5jb250YWlucyhbImxhYmVsIiwiYnV0dG9uIiwic2VsZWN0Il0sZS50eXBlKX0pLmxlbmd0aH1mdW5jdGlvbiBzKGUpe3JldHVybiBuLmNyZWF0ZSh0LmRlZmF1bHRzKHtnZXRSZWFkTW9kZVN0cmluZzp0LmNvbnN0YW50KCIgIiksZm9jdXM6dC5ub29wfSx0LnBpY2soZSwiY2xpY2siLCJ0aXRsZSIsImhyZWYiKSkpfXZhciBvPWUuZXh0ZW5kKHt0YWdOYW1lOiJzcGFuIixpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy4kZWwudGV4dCh0aGlzLmdldE1vZGVsVmFsdWUoKSl9LGVkaXRNb2RlOmZ1bmN0aW9uKCl7dGhpcy50b2dnbGUoITApfSxyZWFkTW9kZTpmdW5jdGlvbigpe3RoaXMudG9nZ2xlKCExKX0sZ2V0TW9kZWxWYWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMubGFiZWx9LHRvZ2dsZTpmdW5jdGlvbih0KXt0aGlzLiRlbC50b2dnbGVDbGFzcygiby1mb3JtLWxhYmVsLWlubGluZSIsdCksdGhpcy4kZWwudG9nZ2xlQ2xhc3MoIm8tZm9ybS1jb250cm9sIiwhdCl9LGZvY3VzOnQubm9vcH0pLGE9aS5leHRlbmQoe2dldFBhcmFtczplLnByb3RvdHlwZS5nZXRQYXJhbXMsZ2V0UGFyYW06ZS5wcm90b3R5cGUuZ2V0UGFyYW0sY2xhc3NOYW1lOmZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIHQ9InRleHQiPT10aGlzLmdldFBhcmFtKCJkaXNwbGF5Iik/Im8tZm9ybS1pbnB1dC1ncm91cC1zdWJ0bGUiOiJvLWZvcm0taW5wdXQtZ3JvdXAiLHIodGhpcy5nZXRQYXJhbSgiaW5wdXRzIikpPjEmJih0Kz0iIG8tZm9ybS1pbnB1dC1ncm91cC0yIiksdH0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3QuZWFjaCh0aGlzLmdldFBhcmFtKCJpbnB1dHMiKSxmdW5jdGlvbihlKXtzd2l0Y2goZS50eXBlKXtjYXNlImxhYmVsIjp0aGlzLmFkZChvLHtvcHRpb25zOmV9KTticmVhaztjYXNlImJ1dHRvbiI6dGhpcy5hZGQocyhlKSk7YnJlYWs7ZGVmYXVsdDplPXQuZGVmYXVsdHMoe21vZGVsOnRoaXMubW9kZWwscGFyYW1zOnQuZXh0ZW5kKHthdXRvV2lkdGg6ITB9LGUucGFyYW1zfHx7fSl9LGUpLHRoaXMuYWRkKHRoaXMuZ2V0UGFyYW1zKCkuY3JlYXRlKGUpKX19LHRoaXMpfSxmb2N1czpmdW5jdGlvbigpe3RoaXMuZmlyc3QoKS5mb2N1cygpfX0pO3JldHVybiBlLmV4dGVuZCh7Y29uc3RydWN0b3I6ZnVuY3Rpb24odCl7dGhpcy5pbnB1dEdyb3VwVmlldz1uZXcgYSh0KSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZWRpdE1vZGU6ZnVuY3Rpb24oKXt0aGlzLmlucHV0R3JvdXBWaWV3LnJlbW92ZSgpLHRoaXMuaW5wdXRHcm91cFZpZXc9bmV3IGEodGhpcy5vcHRpb25zKSx0aGlzLiRlbC5odG1sKHRoaXMuaW5wdXRHcm91cFZpZXcucmVuZGVyKCkuZWwpfSx0b1N0cmluZ1ZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5pbnB1dEdyb3VwVmlldy5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIHQuZ2V0UmVhZE1vZGVTdHJpbmcoKX0pO3JldHVybiBlLmxlbmd0aCYmdC5ldmVyeShlKT9lLmpvaW4oIiAiKToiICJ9LGZvY3VzOmZ1bmN0aW9uKCl7dGhpcy5pbnB1dEdyb3VwVmlldy5mb2N1cygpfX0se0xhYmVsSW5wdXQ6byxJbnB1dEdyb3VwVmlldzphfSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgyMjQpXSxyPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6ImltYWdlLWZpbGUtdXBsb2FkIixwYXJzZTpmdW5jdGlvbihlKXt2YXIgaT10LmNsb25lKGV8fHt9KTtyZXR1cm4gaS5zaXplJiYoaS5maWxlU2l6ZUtCPU1hdGgucm91bmQoaS5zaXplLzFlMykpLGl9LHByZXZpZXdUZW1wbGF0ZTonXHQgICAgICA8ZGl2IGNsYXNzPSJpbWFnZS1maWxlLXRodW1ibmFpbCBmbG9hdC1sIj5cdCAgICAgICAgPGltZyBzcmM9Int7aW1hZ2VVcmx9fSIgPlx0ICAgICAgPC9kaXY+XHQgICAgICA8ZGl2IGNsYXNzPSJpbWFnZS1maWxlLWluZm8gZmxvYXQtbCI+XHQgICAgICAgIDx1bD5cdCAgICAgICAgICB7eyNpZiBuYW1lfX08bGk+e3tuYW1lfX08L2xpPnt7L2lmfX1cdCAgICAgICAgICB7eyNpZiBmaWxlU2l6ZUtCfX08bGk+e3tmaWxlU2l6ZUtCfX0oS0IpPC9saT57ey9pZn19XHQgICAgICAgIDwvdWw+XHQgICAgICA8L2Rpdj4nLGZpbGVUeXBlczpbIi5wbmciLCIuZ2lmIiwiLmpwZWciLCIuanBnIl19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDUpLGkoMiksaSgyMDMpLGkoMTM2KSxpKDMzKSxpKDIyNSksaSgxNzcpLGkoMTQ3KSxpKDIyNiksaSgyMjcpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSxsLGMpe2Z1bmN0aW9uIHUodCl7aWYoIWUuaXNTdHJpbmcodCkpcmV0dXJuIGUuY2xvbmUodCk7dHJ5e3JldHVybiBKU09OLnBhcnNlKHQpfWNhdGNoKGkpe3JldHVybn19cmV0dXJuIGkuZXh0ZW5kKHtpZEF0dHJpYnV0ZToiaWQiLHByZXZpZXdUZW1wbGF0ZTpudWxsLGZpbGVUeXBlczpudWxsLHBhcnNlOmUuaWRlbnRpdHksZmlsZUZpZWxkTmFtZToiZmlsZSIsZmlsZVVwbG9hZElucHV0RXZlbnRzOntjbGVhcjoiY2xlYXJFcnJvciIsc3VjY2VzczoiYWRkRmlsZURhdGEiLGVycm9yOiJzaG93RXJyb3IifSxjb25zdHJ1Y3RvcjpmdW5jdGlvbih0KXt2YXIgcz1lLmV4dGVuZCh7ZmlsZVR5cGVzOmUucmVzdWx0KHRoaXMsImZpbGVUeXBlcyIpLGZpbGVGaWVsZE5hbWU6ZS5yZXN1bHQodC5wYXJhbXMsImZpbGVGaWVsZE5hbWUiKXx8ZS5yZXN1bHQodGhpcywiZmlsZUZpZWxkTmFtZSIpLGVuZHBvaW50OmUucmVzdWx0KHRoaXMsImVuZHBvaW50Iil9LHQsdGhpcy5nZXRQYXJhbXModCkpO3RoaXMuZmlsZVVwbG9hZElucHV0PW5ldyBsKHMpLGkuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBvPXIuZXh0ZW5kKHttb2RlbDpuLmV4dGVuZCh7ZXh0cmFQcm9wZXJ0aWVzOiEwLGlkQXR0cmlidXRlOnRoaXMuZ2V0UGFyYW1PckF0dHJpYnV0ZSgiaWRBdHRyaWJ1dGUiKX0pfSk7dGhpcy5jb2xsZWN0aW9uPW5ldyBvLHRoaXMucHJldmlld0xpc3RWaWV3PW5ldyBjKHtjb2xsZWN0aW9uOnRoaXMuY29sbGVjdGlvbixwYXJhbXM6dC5wYXJhbXMscGFyc2U6dGhpcy5wYXJzZSxwcmV2aWV3VGVtcGxhdGU6dGhpcy5wcmV2aWV3VGVtcGxhdGV9KSx0aGlzLmZpbGVVcGxvYWRJbnB1dC5zZXRDb2xsZWN0aW9uKHRoaXMuY29sbGVjdGlvbiksdGhpcy5saXN0ZW5Ubyh0aGlzLmNvbGxlY3Rpb24sInVwZGF0ZSIsdGhpcy51cGRhdGUpLHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCJ1cGRhdGUiLHRoaXMucmVzaXplKSx0aGlzLiRlbC5hcHBlbmQodGhpcy5maWxlVXBsb2FkSW5wdXQucmVuZGVyKCkuZWwpLHRoaXMuJGVsLmFwcGVuZCh0aGlzLnByZXZpZXdMaXN0Vmlldy5yZW5kZXIoKS5lbCksdGhpcy4kZWwuYWRkQ2xhc3MoIm8tZm9ybS1jb250cm9sIGZpbGUtdXBsb2FkIGNsZWFyZml4Iil9LHByZXZpZXdGcm9tTW9kZWw6ZnVuY3Rpb24oKXt0aGlzLmNvbGxlY3Rpb24ucmVzZXQoKTt2YXIgaT10aGlzLmdldE1vZGVsVmFsdWUoKSxuPXRoaXMuZ2V0UGFyYW0oInByZXZpZXdEYXRhIikscj10aGlzLmdldFBhcmFtKCJwcmV2aWV3RW5kcG9pbnQiKSxzPXRoaXMuY29sbGVjdGlvbjtpZihpKWlmKG4pcy5zZXQobik7ZWxzZSBpZihyKXt2YXIgbz1lLmlzU3RyaW5nKHIpP2EudHBsKHIpOnIsbD1lLm1hcChlLmlzQXJyYXkoaSk/aTpbaV0sZnVuY3Rpb24oZSl7cmV0dXJuIHQuZ2V0KG8oe2lkOmV9KSl9KTt0LndoZW4uYXBwbHkodCxsKS50aGVuKGZ1bmN0aW9uKCl7dmFyIHQ9MT09bC5sZW5ndGg/YXJndW1lbnRzWzBdOmUucGx1Y2soYXJndW1lbnRzLDApO3Muc2V0KHQpfSl9fSxjbGVhckVycm9yOmZ1bmN0aW9uKCl7dGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOmNsZWFyLWVycm9yOiIrdGhpcy5vcHRpb25zLm5hbWUpfSxhZGRGaWxlRGF0YTpmdW5jdGlvbih0KXt2YXIgZT11KHQpO2UmJnRoaXMuY29sbGVjdGlvbi5hZGQoZSl9LHNob3dFcnJvcjpmdW5jdGlvbih0KXtpZih0aGlzLmNsZWFyRXJyb3IoKSwhdHx8MCE9PXQuc3RhdHVzfHwiYWJvcnQiIT10LnN0YXR1c1RleHQpe3ZhciBpO2lmKGUuaXNTdHJpbmcodCkpaT10O2Vsc2V7dmFyIG49cy5nZXRSZXNwb25zZUpTT04odCk7aT1uJiZuLmVycm9yU3VtbWFyeXx8by5sb2NhbGl6ZSgib2Zvcm0uZmlsZS51cGxvYWQuZXJyb3IiKX12YXIgcj17fTtyW3RoaXMub3B0aW9ucy5uYW1lXT1pLHRoaXMubW9kZWwudHJpZ2dlcigiaW52YWxpZCIsdGhpcy5tb2RlbCxyLCExKX19LGVkaXRNb2RlOmZ1bmN0aW9uKCl7dGhpcy5wcmV2aWV3RnJvbU1vZGVsKCksdGhpcy5maWxlVXBsb2FkSW5wdXQudG9nZ2xlKCEwKX0scmVhZE1vZGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGl0TW9kZSgpfSx2YWw6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNvbGxlY3Rpb24ucGx1Y2sodGhpcy5nZXRQYXJhbU9yQXR0cmlidXRlKCJpZEF0dHJpYnV0ZSIpKTtyZXR1cm4gdGhpcy5nZXRQYXJhbSgibXVsdGkiKT90OnRbMF19LGZvY3VzOmZ1bmN0aW9uKCl7dGhpcy5maWxlVXBsb2FkSW5wdXQuZm9jdXMoKX0sdmFsaWRhdGU6ZS5ub29wfSx7cGFyc2VKU09OOnV9KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpXSxyPWZ1bmN0aW9uKHQpe3JldHVybntnZXRSZXNwb25zZUpTT046ZnVuY3Rpb24odCl7dHJ5e3JldHVybiB0LnJlc3BvbnNlSlNPTnx8SlNPTi5wYXJzZSh0LnJlc3BvbnNlVGV4dCl9Y2F0Y2goZSl7cmV0dXJufX0scGFyc2VFcnJvclN1bW1hcnk6ZnVuY3Rpb24odCl7dmFyIGU9dC5tYXRjaCgvXihbXlw6XSspXDogKC4rKSQvKTtpZihlKXJldHVybltlWzFdLGVbMl1dfSxwYXJzZUZpZWxkRXJyb3JzOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMuZ2V0UmVzcG9uc2VKU09OKGUpLG49e307cmV0dXJuIGk/dC5lYWNoKGkuZXJyb3JDYXVzZXN8fFtdLGZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMucGFyc2VFcnJvclN1bW1hcnkodCYmdC5lcnJvclN1bW1hcnl8fCIiKTtpZihlKXt2YXIgaT1lWzBdLHI9ZVsxXTtuW2ldfHwobltpXT1bXSksbltpXS5wdXNoKHIpfX0sdGhpcyk6dC5pc09iamVjdChlKSYmdC5zaXplKGUpJiZ0LmVhY2goZSxmdW5jdGlvbih0LGUpe25bZV09W3RdfSksdC5zaXplKG4pP246dm9pZCAwfX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg1KSxpKDIpLGkoMTQ2KSxpKDE0NCksaSgxNzcpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7ZnVuY3Rpb24gcyh0KXtyZXR1cm4odHx8W10pLmpvaW4oIiwiKX1yZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToiZmlsZS11cGxvYWQtd3JhcCIsdGVtcGxhdGU6J1x0ICAgICAgPHNwYW4gY2xhc3M9ImZpbGUtdXBsb2FkLXByb2dyZXNzLWluZGljYXRvci13cmFwIGlucHV0LWZpeCBvLWZvcm0tY29udHJvbCBoaWRlIj5cdCAgICAgICAgPHNwYW4gY2xhc3M9ImZpbGUtdXBsb2FkLXByb2dyZXNzLWluZGljYXRvciI+PC9zcGFuPlx0ICAgICAgICA8ZGl2IGNsYXNzPSJmaWxlLXVwbG9hZC1jYW5jZWwgZmlsZS11cGxvYWQtdXBsb2FkaW5nIj48L2Rpdj5cdCAgICAgIDwvc3Bhbj5cdCAgICAgIDxkaXYgY2xhc3M9ImZhY2FkZSI+XHQgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iZmlsZS1uYW1lLXRleHQtZmllbGQiIHBsYWNlaG9sZGVyPSJ7e3BsYWNlaG9sZGVyfX0iIFx0ICAgICAgICAgICAgICAgdGl0bGU9Int7YnJvd3NlRmlsZXNUaXRsZX19IiByZWFkb25seT5cdCAgICAgICAgPGEgdGl0bGU9Int7YnJvd3NlRmlsZXNUaXRsZX19IiBjbGFzcz0iYnJvd3NlLWZpbGUtYnV0dG9uIGxpbmstYnV0dG9uIiBocmVmPSIjIj57e2Jyb3dzZUZpbGVzVGl0bGV9fTwvYT5cdCAgICAgIDwvZGl2Plx0ICAgICAgPGRpdiBjbGFzcz0iby1mb3JtLWV4cGxhaW4gaGlkZSI+PC9kaXY+XHQgICAgICA8aW5wdXQgdHlwZT0iZmlsZSIgY2xhc3M9Im0tZmlsZSBoaWRlInt7I2lmIGFjY2VwdH19IGFjY2VwdD0ie3thY2NlcHR9fSJ7ey9pZn19XHQgICAgICAgICAgICAge3sjaWYgbXVsdGlwbGV9fSBtdWx0aXBsZT0ibXVsdGlwbGUie3svaWZ9fT5cdCAgICAnLGV2ZW50czp7ImNsaWNrIC5maWxlLXVwbG9hZC1jYW5jZWwiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpLHRoaXMuYWJvcnRSZXF1ZXN0KCksdGhpcy5yZW5kZXIoKX0sImNsaWNrIC5mYWNhZGUiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpLHRoaXMuYnJvd3NlRmlsZXMoKX0sImNoYW5nZSAubS1maWxlIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKSx0aGlzLm1ha2VSZXF1ZXN0KHQudGFyZ2V0LmZpbGVzKX19LGluaXRpYWxpemU6ZnVuY3Rpb24oKXtlLmJpbmRBbGwodGhpcywib25Qcm9ncmVzcyIsIm9uUHJvZ3Jlc3NDb21wbGV0ZSIpLHRoaXMub25TdWNjZXNzPWUuZGVib3VuY2UodGhpcy5vblN1Y2Nlc3MsMWUzKSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImNoYW5nZTpfX2VkaXRfXyIsdGhpcy5yZW5kZXIpfSxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXtyZXR1cm57YnJvd3NlRmlsZXNUaXRsZTpyLmxvY2FsaXplKCJvZm9ybS5icm93c2UuZmlsZXMiKSxhY2NlcHQ6cyh0aGlzLm9wdGlvbnMuZmlsZVR5cGVzKSxtdWx0aXBsZTp0aGlzLm9wdGlvbnMubXVsdGkscGxhY2Vob2xkZXI6dGhpcy5vcHRpb25zLnBsYWNlaG9sZGVyfX0scG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMuZGVsZWdhdGVFdmVudHMoKX0sYnJvd3NlRmlsZXM6ZnVuY3Rpb24oKXt0aGlzLiQoIi5tLWZpbGUiKS52YWwoIiIpLmNsaWNrKCksZS5kZWxheShmdW5jdGlvbigpe3RoaXMudHJpZ2dlcigiY2xlYXIiKX0uYmluZCh0aGlzKSwyZTMpfSxzZXRDb2xsZWN0aW9uOmZ1bmN0aW9uKHQpe3RoaXMuY29sbGVjdGlvbj10aGlzLm9wdGlvbnMuY29sbGVjdGlvbj10LHRoaXMubGlzdGVuVG8odCwidXBkYXRlIixmdW5jdGlvbigpe3RoaXMudG9nZ2xlKDA9PT10Lmxlbmd0aCl9KX0sc2V0RmlsZU5hbWU6ZnVuY3Rpb24odCl7dGhpcy4kKCIuZmlsZS1uYW1lLXRleHQtZmllbGQiKS52YWwodHx8IiIpLHRoaXMuJCgiLmZpbGUtdXBsb2FkLXByb2dyZXNzLWluZGljYXRvciIpLmh0bWwodHx8IiIpfSxzdGFydFVwbG9hZGluZzpmdW5jdGlvbih0KXt0aGlzLiQoIi5maWxlLXVwbG9hZC1wcm9ncmVzcy1pbmRpY2F0b3Itd3JhcCIpLnJlbW92ZUNsYXNzKCJoaWRlIiksdGhpcy4kKCIuZmlsZS11cGxvYWQtcHJvZ3Jlc3MtaW5kaWNhdG9yIikuY3NzKCJ3aWR0aCIsIjBweCIpLHRoaXMuJCgiLmZhY2FkZSIpLmhpZGUoKSx0aGlzLiQoIi5maWxlLXVwbG9hZC1jYW5jZWwiKS5zaG93KCksdGhpcy5zZXRGaWxlTmFtZSh0KX0sbWFrZVJlcXVlc3Q6ZnVuY3Rpb24odCl7aWYoMD09PXQubGVuZ3RoKXJldHVybiB2b2lkIG4ud2FybigiTm8gZmlsZXMgaGF2ZSBiZWVuIHNlbGVjdGVkLiIpO3ZhciBpPWUucGx1Y2sodCwibmFtZSIpLmpvaW4oIiwgIikscz10aGlzLmdldE1heEl0ZW1zKCk7cmV0dXJuIHQubGVuZ3RoK3RoaXMuY29sbGVjdGlvbi5sZW5ndGg+cz92b2lkIHRoaXMudHJpZ2dlcigiZXJyb3IiLHIubG9jYWxpemUoIm9mb3JtLmZpbGUudXBsb2FkLnRvby5tYW55LmZpbGVzIiwibWVzc2FnZXMiLFtzXSkpOih0aGlzLnRyaWdnZXIoImNsZWFyIiksdGhpcy5zdGFydFVwbG9hZGluZyhpKSx2b2lkIHRoaXMuc2VuZFVwbG9hZFJlcXVlc3QodCkuZG9uZShlLmJpbmQodGhpcy5vblN1Y2Nlc3MsdGhpcykpLmZhaWwoZS5iaW5kKHRoaXMub25GYWlsdXJlLHRoaXMpKSl9LHNlbmRVcGxvYWRSZXF1ZXN0OmZ1bmN0aW9uKGkpe3ZhciBuPXRoaXMscj1uZXcgRm9ybURhdGEscz10aGlzLm9wdGlvbnMuZmlsZUZpZWxkTmFtZTtlLmVhY2goaSxmdW5jdGlvbih0KXtyLmFwcGVuZChzLHQpfSksci5hcHBlbmQoIl94c3JmVG9rZW4iLHQoIiNfeHNyZlRva2VuIikudGV4dCgpKTt2YXIgbz17dXJsOnRoaXMub3B0aW9ucy5lbmRwb2ludCxtZXRob2Q6IlBPU1QiLGRhdGE6cix4aHI6ZnVuY3Rpb24oKXt2YXIgZT10LmFqYXhTZXR0aW5ncy54aHIoKTtyZXR1cm4gZS51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcigicHJvZ3Jlc3MiLG4ub25Qcm9ncmVzcywhMSksZS51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsbi5vblByb2dyZXNzQ29tcGxldGUsITEpLGV9LHByb2Nlc3NEYXRhOiExLGNvbnRlbnRUeXBlOiExfTtyZXR1cm4gdGhpcy5feGhyPXQuYWpheChvKSx0aGlzLl94aHJ9LGFib3J0UmVxdWVzdDpmdW5jdGlvbigpe24ud2FybigiVXBsb2FkIGFib3J0ZWQuLi4iKSx0aGlzLl94aHImJnRoaXMuX3hoci5hYm9ydCgpfSxvblByb2dyZXNzOmZ1bmN0aW9uKHQpe2lmKHQubGVuZ3RoQ29tcHV0YWJsZSl7dmFyIGU9TWF0aC5yb3VuZCgxMDAqdC5sb2FkZWQvdC50b3RhbCk7cmV0dXJuIG4uaW5mbygiVXBsb2FkIGluIHByb2dyZXNzLi4uIixlKyIlIiksdGhpcy4kKCIuZmlsZS11cGxvYWQtcHJvZ3Jlc3MtaW5kaWNhdG9yIikuY3NzKCJ3aWR0aCIsZSsiJSIpLGV9fSxvblByb2dyZXNzQ29tcGxldGU6ZnVuY3Rpb24oKXtuLmluZm8oIlVwbG9hZCBjb21wbGV0ZSwgcHJvY2Vzc2luZy4uLiIpLHRoaXMuJCgiLmZpbGUtdXBsb2FkLWNhbmNlbCIpLmZhZGVPdXQoKX0sb25TdWNjZXNzOmZ1bmN0aW9uKHQpe24uaW5mbygiVXBsb2FkIHByb2Nlc3NpbmcgY29tcGxldGUuLi4iKSx0aGlzLiQoIi5maWxlLXVwbG9hZC1wcm9ncmVzcy1pbmRpY2F0b3Itd3JhcCIpLmFkZENsYXNzKCJoaWRlIiksdGhpcy50b2dnbGUoITEpLHRoaXMudHJpZ2dlcigic3VjY2VzcyIsdCl9LG9uRmFpbHVyZTpmdW5jdGlvbih0KXtuLndhcm4oIlVwbG9hZCBmYWlsZWQuLi4iKSx0aGlzLnNldEZpbGVOYW1lKCksdGhpcy4kKCIuZmlsZS11cGxvYWQtcHJvZ3Jlc3MtaW5kaWNhdG9yLXdyYXAiKS5hZGRDbGFzcygiaGlkZSIpLHRoaXMuJCgiLmZhY2FkZSIpLnNob3coKSx0aGlzLnRvZ2dsZSghMCksdGhpcy50cmlnZ2VyKCJlcnJvciIsdCl9LHRvZ2dsZTpmdW5jdGlvbih0KXt0aGlzLiRlbC5hZGRDbGFzcygiaGlkZSIpO3ZhciBlPXQ7cmV0dXJuIHRoaXMub3B0aW9ucy5tdWx0aT9lPXRoaXMuY29sbGVjdGlvbi5sZW5ndGg8dGhpcy5nZXRNYXhJdGVtcygpOnRoaXMuY29sbGVjdGlvbi5sZW5ndGg+MCYmKGU9ITEpLGUmJnRoaXMucmVuZGVyKCkuJGVsLnJlbW92ZUNsYXNzKCJoaWRlIiksZX0sZm9jdXM6ZnVuY3Rpb24oKXt0aGlzLiQoIi5mYWNhZGUiKS5mb2N1cygpfSxnZXRNYXhJdGVtczpmdW5jdGlvbigpe3ZhciB0PXRoaXMubW9kZWwuZ2V0UHJvcGVydHlTY2hlbWEodGhpcy5vcHRpb25zLm5hbWUpfHx7fTtyZXR1cm4gdC5tYXhJdGVtc3x8MS8wfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDYpLGkoMTkyKV0scj1mdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gbihpKXtmdW5jdGlvbiBuKGUpe3ZhciBuPShpLnBhcmFtcyYmaS5wYXJhbXMucGFyc2V8fHQuaWRlbnRpdHkpLmNhbGwobnVsbCxlKTtyZXR1cm4oaS5wYXJzZXx8dC5pZGVudGl0eSkuY2FsbChudWxsLG4pfXJldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOiJmaWxlLXVwbG9hZC1wcmV2aWV3IixldmVudHM6eyJjbGljayAuZmlsZS11cGxvYWQtY2FuY2VsIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKSx0aGlzLmNvbGxlY3Rpb24ucmVtb3ZlKHRoaXMubW9kZWwpfX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7dmFyIGU9bih0aGlzLm1vZGVsLnRvSlNPTigpKSxpPVt0Lm9taXQoZSwiY2hhaW4iKV0uY29uY2F0KChlLmNoYWlufHxbXSkubWFwKG4pKTtyZXR1cm4gdC5leHRlbmQoe30sZSx7Y2VydE5hbWVzOnQucGx1Y2soaSwiY2VydE5hbWUiKS5qb2luKCIgPiAiKSxtdWx0aUl0ZW1zOmkubGVuZ3RoPjEsaXRlbXM6aS5tYXAoZnVuY3Rpb24oZSl7cmV0dXJuIHQuZXh0ZW5kKHt9LGUse211bHRpSXRlbXM6aS5sZW5ndGg+MX0pfSl9KX0sdGVtcGxhdGU6aS5wcmV2aWV3VGVtcGxhdGUscG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMuJGVsLnByZXBlbmQoJzxkaXYgY2xhc3M9ImZpbGUtdXBsb2FkLWNhbmNlbCI+PC9kaXY+JyksdGhpcy5kZWxlZ2F0ZUV2ZW50cygpfX0pfXJldHVybiBpLmV4dGVuZCh7Y2xhc3NOYW1lOiJmaWxlLXVwbG9hZC1wcmV2aWV3LXdyYXAiLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKHQpe3RoaXMuaXRlbT1uKHQpLGkuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNSksaSgyKSxpKDM2KSxpKDE3NyksaSgyMjQpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7cmV0dXJuIHIuZXh0ZW5kKHtjbGFzc05hbWU6ImNlcnQtZmlsZS11cGxvYWQiLGV2ZW50czp7ImNsaWNrIC5jZXJ0LWV4cGFuZC1kZXRhaWxzIjpmdW5jdGlvbihlKXtlJiZlLnByZXZlbnREZWZhdWx0KCk7dmFyIGk9dGhpcyxyPXQoZS50YXJnZXQpLnNpYmxpbmdzKCIuY2VydC1kZXRhaWxzIikscz03NSpyLmxlbmd0aCxvPWZ1bmN0aW9uKCl7aS5tb2RlbC50cmlnZ2VyKCJmb3JtOnJlc2l6ZSIpfTtyLmlzKCI6aGlkZGVuIil8fHIuaGFzQ2xhc3MoImhpZGUiKT8oci5yZW1vdmVDbGFzcygiaGlkZSIpLmhpZGUoKS5zbGlkZURvd24ocyxvKSx0KGUudGFyZ2V0KS50ZXh0KG4ubG9jYWxpemUoIm9mb3JtLmNlcnRpZmljYXRlLmhpZGUuY2hhaW4iKSkpOihyLnNsaWRlVXAocyxvKSx0KGUudGFyZ2V0KS50ZXh0KG4ubG9jYWxpemUoIm9mb3JtLmNlcnRpZmljYXRlLnZpZXcuY2hhaW4iKSkpfX0scGFyc2U6ZnVuY3Rpb24odCl7dmFyIG49ZS5jbG9uZSh0fHx7fSk7aWYobi5ub3RBZnRlcil7dmFyIHI9aS51dGMobi5ub3RBZnRlcikuZGlmZihpLnV0YygpLCJkYXlzIik7cj4wJiZlLmV4dGVuZChuLHtleHBpcmVzSW5EYXlzOnJ9KSxyPDE0JiYobi5leHBpcmVDbGFzcz0iY2VydC1leHBpcmVkIil9cmV0dXJuIG59LHByZXZpZXdUZW1wbGF0ZTonXHQgICAgICA8ZGl2IGNsYXNzPSJjZXJ0LXRodW1ibmFpbCI+PHNwYW4gY2xhc3M9Imljb24gaWNvbi0zMiBpY29uLW9ubHkgZmlsZS1jZXJ0LTMyIj48L3NwYW4+PC9kaXY+XHQgICAgICA8dWwgY2xhc3M9ImNlcnQtZGV0YWlscy1oZWFkZXIiPlx0ICAgICAgICB7eyNpZiBjZXJ0TmFtZXN9fTxsaSBjbGFzcz0iY2VydC1uYW1lcyI+e3tjZXJ0TmFtZXN9fTwvbGk+e3svaWZ9fVx0ICAgICAgICB7eyNpZiB1cGxvYWRlZEJ5fX17eyNpZiB1cGxvYWRlZE9ufX1cdCAgICAgICAgPGxpIGNsYXNzPSJjZXJ0LXVwbG9hZC1pbmZvIj5cdCAgICAgICAgICB7e2kxOG4gY29kZT0ib2Zvcm0uY2VydGlmaWNhdGUudXBsb2FkZWQiIGJ1bmRsZT0ibWVzc2FnZXMiIGFyZ3VtZW50cz0idXBsb2FkZWRCeTt1cGxvYWRlZE9uIn19IFx0ICAgICAgICA8L2xpPlx0ICAgICAgICB7ey9pZn19e3svaWZ9fVx0ICAgICAgPC91bD5cdCAgICAgIHt7I2VhY2ggaXRlbXN9fVx0ICAgICAgICA8dWwgY2xhc3M9ImNlcnQtZGV0YWlsc3t7I2lmIG11bHRpSXRlbXN9fSBoaWRle3svaWZ9fSI+XHQgICAgICAgICAge3sjaWYgbXVsdGlJdGVtc319e3sjaWYgY2VydE5hbWV9fVx0ICAgICAgICAgICAgPGxpIGNsYXNzPSJjZXJ0LW5hbWUiPnt7Y2VydE5hbWV9fTwvbGk+XHQgICAgICAgICAge3svaWZ9fXt7L2lmfX1cdCAgICAgICAgICB7eyNpZiBpc3N1ZXJ9fTxsaSBjbGFzcz0iY2VydC1pc3N1ZXIiPnt7aXNzdWVyfX08L2xpPnt7L2lmfX1cdCAgICAgICAgICB7eyNpZiBub3RCZWZvcmV9fXt7I2lmIG5vdEFmdGVyfX1cdCAgICAgICAgICAgIDxsaSBjbGFzcz0iY2VydC12YWxpZC1kYXRlIj5cdCAgICAgICAgICAgICAge3tpMThuIGNvZGU9Im9mb3JtLmNlcnRpZmljYXRlLnZhbGlkIiBidW5kbGU9Im1lc3NhZ2VzIiBhcmd1bWVudHM9Im5vdEJlZm9yZTtub3RBZnRlciJ9fVx0ICAgICAgICAgICAgPC9saT5cdCAgICAgICAgICB7ey9pZn19e3svaWZ9fVx0ICAgICAgICAgIDxsaSBjbGFzcz0iY2VydC1leHBpcmF0aW9uIHt7ZXhwaXJlQ2xhc3N9fSI+XHQgICAgICAgICAgICB7eyNpZiBleHBpcmVzSW5EYXlzfX1cdCAgICAgICAgICAgIHt7aTE4biBjb2RlPSJvZm9ybS5jZXJ0aWZpY2F0ZS5leHBpcmVzIiBidW5kbGU9Im1lc3NhZ2VzIiBhcmd1bWVudHM9ImV4cGlyZXNJbkRheXMifX1cdCAgICAgICAgICAgIHt7ZWxzZX19XHQgICAgICAgICAgICB7e2kxOG4gY29kZT0ib2Zvcm0uY2VydGlmaWNhdGUuZXhwaXJlZCIgYnVuZGxlPSJtZXNzYWdlcyJ9fVx0ICAgICAgICAgICAge3svaWZ9fVx0ICAgICAgICAgIDwvbGk+XHQgICAgICAgIDwvdWw+XHQgICAgICB7ey9lYWNofX1cdCAgICAgIHt7I2lmIG11bHRpSXRlbXN9fVx0ICAgICAgICA8YSBocmVmPSIjIiBjbGFzcz0iY2VydC1leHBhbmQtZGV0YWlscyI+e3tpMThuIGNvZGU9Im9mb3JtLmNlcnRpZmljYXRlLnZpZXcuY2hhaW4ifX08L2E+XHQgICAgICB7ey9pZn19XHQgICAgICAnLGZpbGVUeXBlczpbIi5jcnQiLCIucGVtIl19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ3KSxpKDIwMyksaSgxMzkpXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1lLnRwbCgnXHQgICAgPHAgY2xhc3M9ImRyb3Bkb3duLWZvb3RlciI+e3tpMThuIGNvZGU9Im9mb3JtLnNlbGVjdC5kcm9wZG93bi5mb290ZXIiIGFyZ3VtZW50cz0ibnVtIn19PC9wPlx0ICAnKSxyPWUudHBsKCdcdCAgICA8cCBjbGFzcz0iZHJvcGRvd24tZm9vdGVyIj57e2kxOG4gY29kZT0ib2Zvcm0uYmFzZXNlbGVjdC5ub3Jlc3VsdHMifX08L3A+XHQgICcpKCk7cmV0dXJuIGkuZXh0ZW5kKHt0ZW1wbGF0ZTplLnRwbCgnPHNlbGVjdCBpZD0ie3tpbnB1dElkfX0iIG5hbWU9Int7bmFtZX19Ij48L3NlbGVjdD4nKSxjbGFzc05hbWU6Im8tZm9ybS1zZWFyY2hhYmxlLXNlbGVjdCIsbWF4T3B0aW9uczo1MCxldmVudHM6eyJjaGFuZ2Ugc2VsZWN0IjoidXBkYXRlIn0sY29uc3RydWN0b3I6ZnVuY3Rpb24oKXtpLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLnNlbGVjdE9wdGlvbnM9dGhpcy5fX2dldE9wdGlvbnModGhpcy5vcHRpb25zLm9wdGlvbnMpfSxlZGl0TW9kZTpmdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtsLiQoIi5kcm9wZG93bi1mb290ZXIiKS5yZW1vdmUoKSx0LmRlZmVyKGZ1bmN0aW9uKCl7dmFyIHQ9bC4kKCIuc2VsZWN0aXplLWRyb3Bkb3duLWNvbnRlbnQgPiAub3B0aW9uIikubGVuZ3RoO3Q9PT1vP2wuJCgiLnNlbGVjdGl6ZS1kcm9wZG93bi1jb250ZW50IikuYXBwZW5kKG4oe251bTpvfSkpOjA9PT10JiYobC4kKCIuc2VsZWN0aXplLWRyb3Bkb3duLWNvbnRlbnQiKS5hcHBlbmQociksbC4kKCIuc2VsZWN0aXplLWRyb3Bkb3duLnNpbmdsZSIpLnNob3coKSl9KX1pLnByb3RvdHlwZS5lZGl0TW9kZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIHM9dGhpcy5nZXRNb2RlbFZhbHVlKCksbz10aGlzLmdldFBhcmFtT3JBdHRyaWJ1dGUoIm1heE9wdGlvbnMiKSxhPXRoaXMuc2VsZWN0T3B0aW9ucyxsPXRoaXM7cmV0dXJuIHRoaXMuJHNlbGVjdD10aGlzLiQoInNlbGVjdCIpLHRoaXMuJHNlbGVjdC5zZWxlY3RpemUoe29wdGlvbnM6YSxpdGVtczpzP1tzXTpbXSxwbGFjZWhvbGRlcjp0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXIscHJlbG9hZDohMCxjcmVhdGU6ITEsbWF4T3B0aW9uczpvLG1heEl0ZW1zOjEsbGFiZWxGaWVsZDoidmFsdWUiLHZhbHVlRmllbGQ6ImtleSIsc2VhcmNoRmllbGQ6WyJ2YWx1ZSJdLG9uVHlwZTplLG9uRHJvcGRvd25PcGVuOmV9KSx0aGlzfSx2YWw6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kc2VsZWN0JiZ0aGlzLiRzZWxlY3QudmFsKCl9LGZvY3VzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJHNlbGVjdCYmdGhpcy4kc2VsZWN0LmZvY3VzKCl9LF9fZ2V0T3B0aW9uczpmdW5jdGlvbihlKXtyZXR1cm4gdC5pc0Z1bmN0aW9uKGUpJiYoZT1lLmNhbGwodGhpcykpLHQubWFwKHQuaXNPYmplY3QoZSk/ZTp7fSxmdW5jdGlvbih0LGUpe3JldHVybntrZXk6ZSx2YWx1ZTp0fX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDcpLGkoMTQ2KSxpKDIzMSldLHI9ZnVuY3Rpb24odCxlLGkpe3JldHVybiBpLmV4dGVuZCh7Y2xhc3NOYW1lOiJva3RhLWZvcm0tbGFiZWwgby1mb3JtLWxhYmVsIixhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6Im8tZm9ybS1sYWJlbCJ9LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKG4pe3QuZGVmYXVsdHMobix7aW5wdXRJZDpuLmlkfSksZGVsZXRlIG4uaWQsaS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIHI7cj10aGlzLl9pc0xhYmVsVmlldyhuLmxhYmVsKT8nPGxhYmVsIGZvcj0ie3tpbnB1dElkfX0iPjwvbGFiZWw+Jzp0LmNvbnRhaW5zKFsicmFkaW8iLCJjaGVja2JveCJdLG4udHlwZSl8fCFuLmxhYmVsPyJ7e2xhYmVsfX0iOic8bGFiZWwgZm9yPSJ7e2lucHV0SWR9fSI+e3tsYWJlbH19Jm5ic3A7PC9sYWJlbD4nLG4uc3VibGFiZWwmJihyKz0nPHNwYW4gY2xhc3M9Im8tZm9ybS1leHBsYWluIj57e3N1YmxhYmVsfX08L3NwYW4+Jyksbi50b29sdGlwJiYodC5pc1N0cmluZyhuLnRvb2x0aXApJiYobi50b29sdGlwPXt0ZXh0Om4udG9vbHRpcH0pLHIrPSc8c3BhbiBjbGFzcz0iby1mb3JtLXRvb2x0aXAgaWNvbi0xNiBpY29uLW9ubHkgZm9ybS1oZWxwLTE2IiB0aXRsZT0ie3t0b29sdGlwLnRleHR9fSI+PC9zcGFuPicpLHRoaXMudGVtcGxhdGU9ZS50cGwocil9LGdldFRlbXBsYXRlRGF0YTpmdW5jdGlvbigpe3ZhciBlPXtsYWJlbDoiIn07cmV0dXJuIHQuZWFjaChbImlucHV0SWQiLCJsYWJlbCIsInN1YmxhYmVsIiwidG9vbHRpcCJdLGZ1bmN0aW9uKGkpe2VbaV09dC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLGksdGhpcyl9LHRoaXMpLGV9LF9pc0xhYmVsVmlldzpmdW5jdGlvbihlKXtyZXR1cm4hdC5pc1VuZGVmaW5lZChlKSYmZSBpbnN0YW5jZW9mIGl9LHBvc3RSZW5kZXI6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldFRlbXBsYXRlRGF0YSgpO3RoaXMuX2lzTGFiZWxWaWV3KGUubGFiZWwpJiYodGhpcy5yZW1vdmVDaGlsZHJlbigpLHRoaXMuYWRkKGUubGFiZWwsImxhYmVsIikpLGUudG9vbHRpcCYmdGhpcy4kKCIuby1mb3JtLXRvb2x0aXAiKS5xdGlwKHQuZXh0ZW5kKHtzdHlsZTp7Y2xhc3NlczoicXRpcC1jdXN0b20gcXRpcC1zaGFkb3cifSxwb3NpdGlvbjp7bXk6ImJvdHRvbSBsZWZ0IixhdDoidG9wIGNlbnRlciJ9LGhpZGU6e2ZpeGVkOiEwfSxzaG93OntkZWxheTowfX0sZS50b29sdGlwLm9wdGlvbnMpKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scixzOy8qCgkJICogcVRpcDIgLSBQcmV0dHkgcG93ZXJmdWwgdG9vbHRpcHMgLSB2My4wLjMtNS1nCgkJICogaHR0cDovL3F0aXAyLmNvbQoJCSAqCgkJICogQ29weXJpZ2h0IChjKSAyMDE3IAoJCSAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZXMKCQkgKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlCgkJICoKCQkgKiBEYXRlOiBXZWQgTWF5IDI0IDIwMTcgMDE6MjIgVVRDKzAwMDAKCQkgKiBQbHVnaW5zOiB0aXBzIG1vZGFsIHZpZXdwb3J0IHN2ZyBpbWFnZW1hcCBpZTYKCQkgKiBTdHlsZXM6IGNvcmUgYmFzaWMgY3NzMwoJCSAqLwoJIWZ1bmN0aW9uKG8sYSxsKXshZnVuY3Rpb24obyl7InVzZSBzdHJpY3QiO3I9W2koNildLG49byxzPSJmdW5jdGlvbiI9PXR5cGVvZiBuP24uYXBwbHkoZSxyKTpuLCEocyE9PWwmJih0LmV4cG9ydHM9cykpfShmdW5jdGlvbih0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gZShlLGksbixyKXt0aGlzLmlkPW4sdGhpcy50YXJnZXQ9ZSx0aGlzLnRvb2x0aXA9Qyx0aGlzLmVsZW1lbnRzPXt0YXJnZXQ6ZX0sdGhpcy5faWQ9eisiLSIrbix0aGlzLnRpbWVycz17aW1nOnt9fSx0aGlzLm9wdGlvbnM9aSx0aGlzLnBsdWdpbnM9e30sdGhpcy5jYWNoZT17ZXZlbnQ6e30sdGFyZ2V0OnQoKSxkaXNhYmxlZDpZLGF0dHI6cixvblRvb2x0aXA6WSxsYXN0Q2xhc3M6IiJ9LHRoaXMucmVuZGVyZWQ9dGhpcy5kZXN0cm95ZWQ9dGhpcy5kaXNhYmxlZD10aGlzLndhaXRpbmc9dGhpcy5oaWRkZW5EdXJpbmdXYWl0PXRoaXMucG9zaXRpb25pbmc9dGhpcy50cmlnZ2VyaW5nPVl9ZnVuY3Rpb24gaShlKXtyZXR1cm4gZT09PUN8fCJvYmplY3QiIT09dC50eXBlKGUpfWZ1bmN0aW9uIG4oZSl7cmV0dXJuISh0LmlzRnVuY3Rpb24oZSl8fGUmJmUuYXR0cnx8ZS5sZW5ndGh8fCJvYmplY3QiPT09dC50eXBlKGUpJiYoZS5qcXVlcnl8fGUudGhlbikpfWZ1bmN0aW9uIHIoZSl7dmFyIHIscyxvLGE7cmV0dXJuIGkoZSk/WTooaShlLm1ldGFkYXRhKSYmKGUubWV0YWRhdGE9e3R5cGU6ZS5tZXRhZGF0YX0pLCJjb250ZW50ImluIGUmJihyPWUuY29udGVudCxpKHIpfHxyLmpxdWVyeXx8ci5kb25lPyhzPW4ocik/WTpyLHI9ZS5jb250ZW50PXt0ZXh0OnN9KTpzPXIudGV4dCwiYWpheCJpbiByJiYobz1yLmFqYXgsYT1vJiZvLm9uY2UhPT1ZLGRlbGV0ZSByLmFqYXgsci50ZXh0PWZ1bmN0aW9uKGUsaSl7dmFyIG49c3x8dCh0aGlzKS5hdHRyKGkub3B0aW9ucy5jb250ZW50LmF0dHIpfHwiTG9hZGluZy4uLiIscj10LmFqYXgodC5leHRlbmQoe30sbyx7Y29udGV4dDppfSkpLnRoZW4oby5zdWNjZXNzLEMsby5lcnJvcikudGhlbihmdW5jdGlvbih0KXtyZXR1cm4gdCYmYSYmaS5zZXQoImNvbnRlbnQudGV4dCIsdCksdH0sZnVuY3Rpb24odCxlLG4pe2kuZGVzdHJveWVkfHwwPT09dC5zdGF0dXN8fGkuc2V0KCJjb250ZW50LnRleHQiLGUrIjogIituKX0pO3JldHVybiBhP246KGkuc2V0KCJjb250ZW50LnRleHQiLG4pLHIpfSksInRpdGxlImluIHImJih0LmlzUGxhaW5PYmplY3Qoci50aXRsZSkmJihyLmJ1dHRvbj1yLnRpdGxlLmJ1dHRvbixyLnRpdGxlPXIudGl0bGUudGV4dCksbihyLnRpdGxlfHxZKSYmKHIudGl0bGU9WSkpKSwicG9zaXRpb24iaW4gZSYmaShlLnBvc2l0aW9uKSYmKGUucG9zaXRpb249e215OmUucG9zaXRpb24sYXQ6ZS5wb3NpdGlvbn0pLCJzaG93ImluIGUmJmkoZS5zaG93KSYmKGUuc2hvdz1lLnNob3cuanF1ZXJ5P3t0YXJnZXQ6ZS5zaG93fTplLnNob3c9PT1EP3tyZWFkeTpEfTp7ZXZlbnQ6ZS5zaG93fSksImhpZGUiaW4gZSYmaShlLmhpZGUpJiYoZS5oaWRlPWUuaGlkZS5qcXVlcnk/e3RhcmdldDplLmhpZGV9OntldmVudDplLmhpZGV9KSwic3R5bGUiaW4gZSYmaShlLnN0eWxlKSYmKGUuc3R5bGU9e2NsYXNzZXM6ZS5zdHlsZX0pLHQuZWFjaChCLGZ1bmN0aW9uKCl7dGhpcy5zYW5pdGl6ZSYmdGhpcy5zYW5pdGl6ZShlKX0pLGUpfWZ1bmN0aW9uIHModCxlKXtmb3IodmFyIGksbj0wLHI9dCxzPWUuc3BsaXQoIi4iKTtyPXJbc1tuKytdXTspbjxzLmxlbmd0aCYmKGk9cik7cmV0dXJuW2l8fHQscy5wb3AoKV19ZnVuY3Rpb24gYyh0LGUpe3ZhciBpLG4scjtmb3IoaSBpbiB0aGlzLmNoZWNrcylpZih0aGlzLmNoZWNrcy5oYXNPd25Qcm9wZXJ0eShpKSlmb3IobiBpbiB0aGlzLmNoZWNrc1tpXSl0aGlzLmNoZWNrc1tpXS5oYXNPd25Qcm9wZXJ0eShuKSYmKHI9bmV3IFJlZ0V4cChuLCJpIikuZXhlYyh0KSkmJihlLnB1c2gociksKCJidWlsdGluIj09PWl8fHRoaXMucGx1Z2luc1tpXSkmJnRoaXMuY2hlY2tzW2ldW25dLmFwcGx5KHRoaXMucGx1Z2luc1tpXXx8dGhpcyxlKSl9ZnVuY3Rpb24gdSh0KXtyZXR1cm4gcS5jb25jYXQoIiIpLmpvaW4odD8iLSIrdCsiICI6IiAiKX1mdW5jdGlvbiBkKGUsaSl7cmV0dXJuIGk+MD9zZXRUaW1lb3V0KHQucHJveHkoZSx0aGlzKSxpKTp2b2lkIGUuY2FsbCh0aGlzKX1mdW5jdGlvbiBoKHQpe3RoaXMudG9vbHRpcC5oYXNDbGFzcyh0dCl8fChjbGVhclRpbWVvdXQodGhpcy50aW1lcnMuc2hvdyksY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmhpZGUpLHRoaXMudGltZXJzLnNob3c9ZC5jYWxsKHRoaXMsZnVuY3Rpb24oKXt0aGlzLnRvZ2dsZShELHQpfSx0aGlzLm9wdGlvbnMuc2hvdy5kZWxheSkpfWZ1bmN0aW9uIHAoZSl7aWYoIXRoaXMudG9vbHRpcC5oYXNDbGFzcyh0dCkmJiF0aGlzLmRlc3Ryb3llZCl7dmFyIGk9dChlLnJlbGF0ZWRUYXJnZXQpLG49aS5jbG9zZXN0KEcpWzBdPT09dGhpcy50b29sdGlwWzBdLHI9aVswXT09PXRoaXMub3B0aW9ucy5zaG93LnRhcmdldFswXTtpZihjbGVhclRpbWVvdXQodGhpcy50aW1lcnMuc2hvdyksY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmhpZGUpLHRoaXMhPT1pWzBdJiYibW91c2UiPT09dGhpcy5vcHRpb25zLnBvc2l0aW9uLnRhcmdldCYmbnx8dGhpcy5vcHRpb25zLmhpZGUuZml4ZWQmJi9tb3VzZShvdXR8bGVhdmV8bW92ZSkvLnRlc3QoZS50eXBlKSYmKG58fHIpKXRyeXtlLnByZXZlbnREZWZhdWx0KCksZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKX1jYXRjaChzKXt9ZWxzZSB0aGlzLnRpbWVycy5oaWRlPWQuY2FsbCh0aGlzLGZ1bmN0aW9uKCl7dGhpcy50b2dnbGUoWSxlKX0sdGhpcy5vcHRpb25zLmhpZGUuZGVsYXksdGhpcyl9fWZ1bmN0aW9uIGYodCl7IXRoaXMudG9vbHRpcC5oYXNDbGFzcyh0dCkmJnRoaXMub3B0aW9ucy5oaWRlLmluYWN0aXZlJiYoY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmluYWN0aXZlKSx0aGlzLnRpbWVycy5pbmFjdGl2ZT1kLmNhbGwodGhpcyxmdW5jdGlvbigpe3RoaXMuaGlkZSh0KX0sdGhpcy5vcHRpb25zLmhpZGUuaW5hY3RpdmUpKX1mdW5jdGlvbiBtKHQpe3RoaXMucmVuZGVyZWQmJnRoaXMudG9vbHRpcFswXS5vZmZzZXRXaWR0aD4wJiZ0aGlzLnJlcG9zaXRpb24odCl9ZnVuY3Rpb24gXyhlLGksbil7dChhLmJvZHkpLmRlbGVnYXRlKGUsKGkuc3BsaXQ/aTppLmpvaW4oIi4iK3orIiAiKSkrIi4iK3osZnVuY3Rpb24oKXt2YXIgZT1ULmFwaVt0LmF0dHIodGhpcywkKV07ZSYmIWUuZGlzYWJsZWQmJm4uYXBwbHkoZSxhcmd1bWVudHMpfSl9ZnVuY3Rpb24gZyhpLG4scyl7dmFyIG8sbCxjLHUsZCxoPXQoYS5ib2R5KSxwPWlbMF09PT1hP2g6aSxmPWkubWV0YWRhdGE/aS5tZXRhZGF0YShzLm1ldGFkYXRhKTpDLG09Imh0bWw1Ij09PXMubWV0YWRhdGEudHlwZSYmZj9mW3MubWV0YWRhdGEubmFtZV06QyxfPWkuZGF0YShzLm1ldGFkYXRhLm5hbWV8fCJxdGlwb3B0cyIpO3RyeXtfPSJzdHJpbmciPT10eXBlb2YgXz90LnBhcnNlSlNPTihfKTpffWNhdGNoKGcpe31pZih1PXQuZXh0ZW5kKEQse30sVC5kZWZhdWx0cyxzLCJvYmplY3QiPT10eXBlb2YgXz9yKF8pOkMscihtfHxmKSksbD11LnBvc2l0aW9uLHUuaWQ9biwiYm9vbGVhbiI9PXR5cGVvZiB1LmNvbnRlbnQudGV4dCl7aWYoYz1pLmF0dHIodS5jb250ZW50LmF0dHIpLHUuY29udGVudC5hdHRyPT09WXx8IWMpcmV0dXJuIFk7dS5jb250ZW50LnRleHQ9Y31pZihsLmNvbnRhaW5lci5sZW5ndGh8fChsLmNvbnRhaW5lcj1oKSxsLnRhcmdldD09PVkmJihsLnRhcmdldD1wKSx1LnNob3cudGFyZ2V0PT09WSYmKHUuc2hvdy50YXJnZXQ9cCksdS5zaG93LnNvbG89PT1EJiYodS5zaG93LnNvbG89bC5jb250YWluZXIuY2xvc2VzdCgiYm9keSIpKSx1LmhpZGUudGFyZ2V0PT09WSYmKHUuaGlkZS50YXJnZXQ9cCksdS5wb3NpdGlvbi52aWV3cG9ydD09PUQmJih1LnBvc2l0aW9uLnZpZXdwb3J0PWwuY29udGFpbmVyKSxsLmNvbnRhaW5lcj1sLmNvbnRhaW5lci5lcSgwKSxsLmF0PW5ldyBMKGwuYXQsRCksbC5teT1uZXcgTChsLm15KSxpLmRhdGEoeikpaWYodS5vdmVyd3JpdGUpaS5xdGlwKCJkZXN0cm95IiwhMCk7ZWxzZSBpZih1Lm92ZXJ3cml0ZT09PVkpcmV0dXJuIFk7cmV0dXJuIGkuYXR0cihWLG4pLHUuc3VwcHJlc3MmJihkPWkuYXR0cigidGl0bGUiKSkmJmkucmVtb3ZlQXR0cigidGl0bGUiKS5hdHRyKGl0LGQpLmF0dHIoInRpdGxlIiwiIiksbz1uZXcgZShpLHUsbiwoISFjKSksaS5kYXRhKHosbyksb31mdW5jdGlvbiB2KHQpe3JldHVybiB0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK3Quc2xpY2UoMSl9ZnVuY3Rpb24geSh0LGUpe3ZhciBpLG4scj1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK2Uuc2xpY2UoMSkscz0oZSsiICIrd3Quam9pbihyKyIgIikrcikuc3BsaXQoIiAiKSxvPTA7aWYoYnRbZV0pcmV0dXJuIHQuY3NzKGJ0W2VdKTtmb3IoO2k9c1tvKytdOylpZigobj10LmNzcyhpKSkhPT1sKXJldHVybiBidFtlXT1pLG59ZnVuY3Rpb24gYih0LGUpe3JldHVybiBNYXRoLmNlaWwocGFyc2VGbG9hdCh5KHQsZSkpKX1mdW5jdGlvbiB3KHQsZSl7dGhpcy5fbnM9InRpcCIsdGhpcy5vcHRpb25zPWUsdGhpcy5vZmZzZXQ9ZS5vZmZzZXQsdGhpcy5zaXplPVtlLndpZHRoLGUuaGVpZ2h0XSx0aGlzLnF0aXA9dCx0aGlzLmluaXQodCl9ZnVuY3Rpb24gTSh0LGUpe3RoaXMub3B0aW9ucz1lLHRoaXMuX25zPSItbW9kYWwiLHRoaXMucXRpcD10LHRoaXMuaW5pdCh0KX1mdW5jdGlvbiBrKHQpe3RoaXMuX25zPSJpZTYiLHRoaXMucXRpcD10LHRoaXMuaW5pdCh0KX12YXIgVCxTLEwseCxFLEQ9ITAsWT0hMSxDPW51bGwsQT0ieCIsTz0ieSIsTj0id2lkdGgiLEk9ImhlaWdodCIsUD0idG9wIixSPSJsZWZ0IixIPSJib3R0b20iLGo9InJpZ2h0IixGPSJjZW50ZXIiLFU9ImZsaXBpbnZlcnQiLFc9InNoaWZ0IixCPXt9LHo9InF0aXAiLFY9ImRhdGEtaGFzcXRpcCIsJD0iZGF0YS1xdGlwLWlkIixxPVsidWktd2lkZ2V0IiwidWktdG9vbHRpcCJdLEc9Ii4iK3osSj0iY2xpY2sgZGJsY2xpY2sgbW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlbGVhdmUgbW91c2VlbnRlciIuc3BsaXQoIiAiKSxLPXorIi1maXhlZCIsUT16KyItZGVmYXVsdCIsWD16KyItZm9jdXMiLFo9eisiLWhvdmVyIix0dD16KyItZGlzYWJsZWQiLGV0PSJfcmVwbGFjZWRCeXFUaXAiLGl0PSJvbGR0aXRsZSIsbnQ9e2llOmZ1bmN0aW9uKCl7dmFyIHQsZTtmb3IodD00LGU9YS5jcmVhdGVFbGVtZW50KCJkaXYiKTsoZS5pbm5lckhUTUw9IjwhLS1baWYgZ3QgSUUgIit0KyJdPjxpPjwvaT48IVtlbmRpZl0tLT4iKSYmZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaSIpWzBdO3QrPTEpO3JldHVybiB0PjQ/dDpOYU59KCksaU9TOnBhcnNlRmxvYXQoKCIiKygvQ1BVLipPUyAoWzAtOV9dezEsNX0pfChDUFUgbGlrZSkuKkFwcGxlV2ViS2l0LipNb2JpbGUvaS5leGVjKG5hdmlnYXRvci51c2VyQWdlbnQpfHxbMCwiIl0pWzFdKS5yZXBsYWNlKCJ1bmRlZmluZWQiLCIzXzIiKS5yZXBsYWNlKCJfIiwiLiIpLnJlcGxhY2UoIl8iLCIiKSl8fFl9O1M9ZS5wcm90b3R5cGUsUy5fd2hlbj1mdW5jdGlvbihlKXtyZXR1cm4gdC53aGVuLmFwcGx5KHQsZSl9LFMucmVuZGVyPWZ1bmN0aW9uKGUpe2lmKHRoaXMucmVuZGVyZWR8fHRoaXMuZGVzdHJveWVkKXJldHVybiB0aGlzO3ZhciBpPXRoaXMsbj10aGlzLm9wdGlvbnMscj10aGlzLmNhY2hlLHM9dGhpcy5lbGVtZW50cyxvPW4uY29udGVudC50ZXh0LGE9bi5jb250ZW50LnRpdGxlLGw9bi5jb250ZW50LmJ1dHRvbixjPW4ucG9zaXRpb24sdT1bXTtyZXR1cm4gdC5hdHRyKHRoaXMudGFyZ2V0WzBdLCJhcmlhLWRlc2NyaWJlZGJ5Iix0aGlzLl9pZCksci5wb3NDbGFzcz10aGlzLl9jcmVhdGVQb3NDbGFzcygodGhpcy5wb3NpdGlvbj17bXk6Yy5teSxhdDpjLmF0fSkubXkpLHRoaXMudG9vbHRpcD1zLnRvb2x0aXA9dCgiPGRpdi8+Iix7aWQ6dGhpcy5faWQsImNsYXNzIjpbeixRLG4uc3R5bGUuY2xhc3NlcyxyLnBvc0NsYXNzXS5qb2luKCIgIiksd2lkdGg6bi5zdHlsZS53aWR0aHx8IiIsaGVpZ2h0Om4uc3R5bGUuaGVpZ2h0fHwiIix0cmFja2luZzoibW91c2UiPT09Yy50YXJnZXQmJmMuYWRqdXN0Lm1vdXNlLHJvbGU6ImFsZXJ0IiwiYXJpYS1saXZlIjoicG9saXRlIiwiYXJpYS1hdG9taWMiOlksImFyaWEtZGVzY3JpYmVkYnkiOnRoaXMuX2lkKyItY29udGVudCIsImFyaWEtaGlkZGVuIjpEfSkudG9nZ2xlQ2xhc3ModHQsdGhpcy5kaXNhYmxlZCkuYXR0cigkLHRoaXMuaWQpLmRhdGEoeix0aGlzKS5hcHBlbmRUbyhjLmNvbnRhaW5lcikuYXBwZW5kKHMuY29udGVudD10KCI8ZGl2IC8+Iix7ImNsYXNzIjp6KyItY29udGVudCIsaWQ6dGhpcy5faWQrIi1jb250ZW50IiwiYXJpYS1hdG9taWMiOkR9KSksdGhpcy5yZW5kZXJlZD0tMSx0aGlzLnBvc2l0aW9uaW5nPUQsYSYmKHRoaXMuX2NyZWF0ZVRpdGxlKCksdC5pc0Z1bmN0aW9uKGEpfHx1LnB1c2godGhpcy5fdXBkYXRlVGl0bGUoYSxZKSkpLGwmJnRoaXMuX2NyZWF0ZUJ1dHRvbigpLHQuaXNGdW5jdGlvbihvKXx8dS5wdXNoKHRoaXMuX3VwZGF0ZUNvbnRlbnQobyxZKSksdGhpcy5yZW5kZXJlZD1ELHRoaXMuX3NldFdpZGdldCgpLHQuZWFjaChCLGZ1bmN0aW9uKHQpe3ZhciBlOyJyZW5kZXIiPT09dGhpcy5pbml0aWFsaXplJiYoZT10aGlzKGkpKSYmKGkucGx1Z2luc1t0XT1lKX0pLHRoaXMuX3VuYXNzaWduRXZlbnRzKCksdGhpcy5fYXNzaWduRXZlbnRzKCksdGhpcy5fd2hlbih1KS50aGVuKGZ1bmN0aW9uKCl7aS5fdHJpZ2dlcigicmVuZGVyIiksaS5wb3NpdGlvbmluZz1ZLGkuaGlkZGVuRHVyaW5nV2FpdHx8IW4uc2hvdy5yZWFkeSYmIWV8fGkudG9nZ2xlKEQsci5ldmVudCxZKSxpLmhpZGRlbkR1cmluZ1dhaXQ9WX0pLFQuYXBpW3RoaXMuaWRdPXRoaXMsdGhpc30sUy5kZXN0cm95PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIGkoKXtpZighdGhpcy5kZXN0cm95ZWQpe3RoaXMuZGVzdHJveWVkPUQ7dmFyIGUsaT10aGlzLnRhcmdldCxuPWkuYXR0cihpdCk7dGhpcy5yZW5kZXJlZCYmdGhpcy50b29sdGlwLnN0b3AoMSwwKS5maW5kKCIqIikucmVtb3ZlKCkuZW5kKCkucmVtb3ZlKCksdC5lYWNoKHRoaXMucGx1Z2lucyxmdW5jdGlvbigpe3RoaXMuZGVzdHJveSYmdGhpcy5kZXN0cm95KCl9KTtmb3IoZSBpbiB0aGlzLnRpbWVycyl0aGlzLnRpbWVycy5oYXNPd25Qcm9wZXJ0eShlKSYmY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzW2VdKTtpLnJlbW92ZURhdGEoeikucmVtb3ZlQXR0cigkKS5yZW1vdmVBdHRyKFYpLnJlbW92ZUF0dHIoImFyaWEtZGVzY3JpYmVkYnkiKSx0aGlzLm9wdGlvbnMuc3VwcHJlc3MmJm4mJmkuYXR0cigidGl0bGUiLG4pLnJlbW92ZUF0dHIoaXQpLHRoaXMuX3VuYXNzaWduRXZlbnRzKCksdGhpcy5vcHRpb25zPXRoaXMuZWxlbWVudHM9dGhpcy5jYWNoZT10aGlzLnRpbWVycz10aGlzLnBsdWdpbnM9dGhpcy5tb3VzZT1DLGRlbGV0ZSBULmFwaVt0aGlzLmlkXX19cmV0dXJuIHRoaXMuZGVzdHJveWVkP3RoaXMudGFyZ2V0OihlPT09RCYmImhpZGUiIT09dGhpcy50cmlnZ2VyaW5nfHwhdGhpcy5yZW5kZXJlZD9pLmNhbGwodGhpcyk6KHRoaXMudG9vbHRpcC5vbmUoInRvb2x0aXBoaWRkZW4iLHQucHJveHkoaSx0aGlzKSksIXRoaXMudHJpZ2dlcmluZyYmdGhpcy5oaWRlKCkpLHRoaXMudGFyZ2V0KX0seD1TLmNoZWNrcz17YnVpbHRpbjp7Il5pZCQiOmZ1bmN0aW9uKGUsaSxuLHIpe3ZhciBzPW49PT1EP1QubmV4dGlkOm4sbz16KyItIitzO3MhPT1ZJiZzLmxlbmd0aD4wJiYhdCgiIyIrbykubGVuZ3RoPyh0aGlzLl9pZD1vLHRoaXMucmVuZGVyZWQmJih0aGlzLnRvb2x0aXBbMF0uaWQ9dGhpcy5faWQsdGhpcy5lbGVtZW50cy5jb250ZW50WzBdLmlkPXRoaXMuX2lkKyItY29udGVudCIsdGhpcy5lbGVtZW50cy50aXRsZVswXS5pZD10aGlzLl9pZCsiLXRpdGxlIikpOmVbaV09cn0sIl5wcmVyZW5kZXIiOmZ1bmN0aW9uKHQsZSxpKXtpJiYhdGhpcy5yZW5kZXJlZCYmdGhpcy5yZW5kZXIodGhpcy5vcHRpb25zLnNob3cucmVhZHkpfSwiXmNvbnRlbnQudGV4dCQiOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLl91cGRhdGVDb250ZW50KGkpfSwiXmNvbnRlbnQuYXR0ciQiOmZ1bmN0aW9uKHQsZSxpLG4pe3RoaXMub3B0aW9ucy5jb250ZW50LnRleHQ9PT10aGlzLnRhcmdldC5hdHRyKG4pJiZ0aGlzLl91cGRhdGVDb250ZW50KHRoaXMudGFyZ2V0LmF0dHIoaSkpfSwiXmNvbnRlbnQudGl0bGUkIjpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIGk/KGkmJiF0aGlzLmVsZW1lbnRzLnRpdGxlJiZ0aGlzLl9jcmVhdGVUaXRsZSgpLHZvaWQgdGhpcy5fdXBkYXRlVGl0bGUoaSkpOnRoaXMuX3JlbW92ZVRpdGxlKCl9LCJeY29udGVudC5idXR0b24kIjpmdW5jdGlvbih0LGUsaSl7dGhpcy5fdXBkYXRlQnV0dG9uKGkpfSwiXmNvbnRlbnQudGl0bGUuKHRleHR8YnV0dG9uKSQiOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLnNldCgiY29udGVudC4iK2UsaSl9LCJecG9zaXRpb24uKG15fGF0KSQiOmZ1bmN0aW9uKHQsZSxpKXsic3RyaW5nIj09dHlwZW9mIGkmJih0aGlzLnBvc2l0aW9uW2VdPXRbZV09bmV3IEwoaSwiYXQiPT09ZSkpfSwiXnBvc2l0aW9uLmNvbnRhaW5lciQiOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLnJlbmRlcmVkJiZ0aGlzLnRvb2x0aXAuYXBwZW5kVG8oaSl9LCJec2hvdy5yZWFkeSQiOmZ1bmN0aW9uKHQsZSxpKXtpJiYoIXRoaXMucmVuZGVyZWQmJnRoaXMucmVuZGVyKEQpfHx0aGlzLnRvZ2dsZShEKSl9LCJec3R5bGUuY2xhc3NlcyQiOmZ1bmN0aW9uKHQsZSxpLG4pe3RoaXMucmVuZGVyZWQmJnRoaXMudG9vbHRpcC5yZW1vdmVDbGFzcyhuKS5hZGRDbGFzcyhpKX0sIl5zdHlsZS4od2lkdGh8aGVpZ2h0KSI6ZnVuY3Rpb24odCxlLGkpe3RoaXMucmVuZGVyZWQmJnRoaXMudG9vbHRpcC5jc3MoZSxpKX0sIl5zdHlsZS53aWRnZXR8Y29udGVudC50aXRsZSI6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcmVkJiZ0aGlzLl9zZXRXaWRnZXQoKX0sIl5zdHlsZS5kZWYiOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLnJlbmRlcmVkJiZ0aGlzLnRvb2x0aXAudG9nZ2xlQ2xhc3MoUSwhIWkpfSwiXmV2ZW50cy4ocmVuZGVyfHNob3d8bW92ZXxoaWRlfGZvY3VzfGJsdXIpJCI6ZnVuY3Rpb24oZSxpLG4pe3RoaXMucmVuZGVyZWQmJnRoaXMudG9vbHRpcFsodC5pc0Z1bmN0aW9uKG4pPyIiOiJ1biIpKyJiaW5kIl0oInRvb2x0aXAiK2ksbil9LCJeKHNob3d8aGlkZXxwb3NpdGlvbikuKGV2ZW50fHRhcmdldHxmaXhlZHxpbmFjdGl2ZXxsZWF2ZXxkaXN0YW5jZXx2aWV3cG9ydHxhZGp1c3QpIjpmdW5jdGlvbigpe2lmKHRoaXMucmVuZGVyZWQpe3ZhciB0PXRoaXMub3B0aW9ucy5wb3NpdGlvbjt0aGlzLnRvb2x0aXAuYXR0cigidHJhY2tpbmciLCJtb3VzZSI9PT10LnRhcmdldCYmdC5hZGp1c3QubW91c2UpLHRoaXMuX3VuYXNzaWduRXZlbnRzKCksdGhpcy5fYXNzaWduRXZlbnRzKCl9fX19LFMuZ2V0PWZ1bmN0aW9uKHQpe2lmKHRoaXMuZGVzdHJveWVkKXJldHVybiB0aGlzO3ZhciBlPXModGhpcy5vcHRpb25zLHQudG9Mb3dlckNhc2UoKSksaT1lWzBdW2VbMV1dO3JldHVybiBpLnByZWNlZGFuY2U/aS5zdHJpbmcoKTppfTt2YXIgcnQ9L15wb3NpdGlvblwuKG15fGF0fGFkanVzdHx0YXJnZXR8Y29udGFpbmVyfHZpZXdwb3J0KXxzdHlsZXxjb250ZW50fHNob3dcLnJlYWR5L2ksc3Q9L15wcmVyZW5kZXJ8c2hvd1wucmVhZHkvaTtTLnNldD1mdW5jdGlvbihlLGkpe2lmKHRoaXMuZGVzdHJveWVkKXJldHVybiB0aGlzO3ZhciBuLG89dGhpcy5yZW5kZXJlZCxhPVksbD10aGlzLm9wdGlvbnM7cmV0dXJuInN0cmluZyI9PXR5cGVvZiBlPyhuPWUsZT17fSxlW25dPWkpOmU9dC5leHRlbmQoe30sZSksdC5lYWNoKGUsZnVuY3Rpb24oaSxuKXtpZihvJiZzdC50ZXN0KGkpKXJldHVybiB2b2lkIGRlbGV0ZSBlW2ldO3ZhciByLGM9cyhsLGkudG9Mb3dlckNhc2UoKSk7cj1jWzBdW2NbMV1dLGNbMF1bY1sxXV09biYmbi5ub2RlVHlwZT90KG4pOm4sYT1ydC50ZXN0KGkpfHxhLGVbaV09W2NbMF0sY1sxXSxuLHJdfSkscihsKSx0aGlzLnBvc2l0aW9uaW5nPUQsdC5lYWNoKGUsdC5wcm94eShjLHRoaXMpKSx0aGlzLnBvc2l0aW9uaW5nPVksdGhpcy5yZW5kZXJlZCYmdGhpcy50b29sdGlwWzBdLm9mZnNldFdpZHRoPjAmJmEmJnRoaXMucmVwb3NpdGlvbigibW91c2UiPT09bC5wb3NpdGlvbi50YXJnZXQ/Qzp0aGlzLmNhY2hlLmV2ZW50KSx0aGlzfSxTLl91cGRhdGU9ZnVuY3Rpb24oZSxpKXt2YXIgbj10aGlzLHI9dGhpcy5jYWNoZTtyZXR1cm4gdGhpcy5yZW5kZXJlZCYmZT8odC5pc0Z1bmN0aW9uKGUpJiYoZT1lLmNhbGwodGhpcy5lbGVtZW50cy50YXJnZXQsci5ldmVudCx0aGlzKXx8IiIpLHQuaXNGdW5jdGlvbihlLnRoZW4pPyhyLndhaXRpbmc9RCxlLnRoZW4oZnVuY3Rpb24odCl7cmV0dXJuIHIud2FpdGluZz1ZLG4uX3VwZGF0ZSh0LGkpfSxDLGZ1bmN0aW9uKHQpe3JldHVybiBuLl91cGRhdGUodCxpKX0pKTplPT09WXx8IWUmJiIiIT09ZT9ZOihlLmpxdWVyeSYmZS5sZW5ndGg+MD9pLmVtcHR5KCkuYXBwZW5kKGUuY3NzKHtkaXNwbGF5OiJibG9jayIsdmlzaWJpbGl0eToidmlzaWJsZSJ9KSk6aS5odG1sKGUpLHRoaXMuX3dhaXRGb3JDb250ZW50KGkpLnRoZW4oZnVuY3Rpb24odCl7bi5yZW5kZXJlZCYmbi50b29sdGlwWzBdLm9mZnNldFdpZHRoPjAmJm4ucmVwb3NpdGlvbihyLmV2ZW50LCF0Lmxlbmd0aCl9KSkpOll9LFMuX3dhaXRGb3JDb250ZW50PWZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMuY2FjaGU7cmV0dXJuIGkud2FpdGluZz1ELCh0LmZuLmltYWdlc0xvYWRlZD9lLmltYWdlc0xvYWRlZCgpOihuZXcgdC5EZWZlcnJlZCkucmVzb2x2ZShbXSkpLmRvbmUoZnVuY3Rpb24oKXtpLndhaXRpbmc9WX0pLnByb21pc2UoKX0sUy5fdXBkYXRlQ29udGVudD1mdW5jdGlvbih0LGUpe3RoaXMuX3VwZGF0ZSh0LHRoaXMuZWxlbWVudHMuY29udGVudCxlKX0sUy5fdXBkYXRlVGl0bGU9ZnVuY3Rpb24odCxlKXt0aGlzLl91cGRhdGUodCx0aGlzLmVsZW1lbnRzLnRpdGxlLGUpPT09WSYmdGhpcy5fcmVtb3ZlVGl0bGUoWSl9LFMuX2NyZWF0ZVRpdGxlPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5lbGVtZW50cyxpPXRoaXMuX2lkKyItdGl0bGUiO2UudGl0bGViYXImJnRoaXMuX3JlbW92ZVRpdGxlKCksZS50aXRsZWJhcj10KCI8ZGl2IC8+Iix7ImNsYXNzIjp6KyItdGl0bGViYXIgIisodGhpcy5vcHRpb25zLnN0eWxlLndpZGdldD91KCJoZWFkZXIiKToiIil9KS5hcHBlbmQoZS50aXRsZT10KCI8ZGl2IC8+Iix7aWQ6aSwiY2xhc3MiOnorIi10aXRsZSIsImFyaWEtYXRvbWljIjpEfSkpLmluc2VydEJlZm9yZShlLmNvbnRlbnQpLmRlbGVnYXRlKCIucXRpcC1jbG9zZSIsIm1vdXNlZG93biBrZXlkb3duIG1vdXNldXAga2V5dXAgbW91c2VvdXQiLGZ1bmN0aW9uKGUpe3QodGhpcykudG9nZ2xlQ2xhc3MoInVpLXN0YXRlLWFjdGl2ZSB1aS1zdGF0ZS1mb2N1cyIsImRvd24iPT09ZS50eXBlLnN1YnN0cigtNCkpfSkuZGVsZWdhdGUoIi5xdGlwLWNsb3NlIiwibW91c2VvdmVyIG1vdXNlb3V0IixmdW5jdGlvbihlKXt0KHRoaXMpLnRvZ2dsZUNsYXNzKCJ1aS1zdGF0ZS1ob3ZlciIsIm1vdXNlb3ZlciI9PT1lLnR5cGUpfSksdGhpcy5vcHRpb25zLmNvbnRlbnQuYnV0dG9uJiZ0aGlzLl9jcmVhdGVCdXR0b24oKX0sUy5fcmVtb3ZlVGl0bGU9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5lbGVtZW50cztlLnRpdGxlJiYoZS50aXRsZWJhci5yZW1vdmUoKSxlLnRpdGxlYmFyPWUudGl0bGU9ZS5idXR0b249Qyx0IT09WSYmdGhpcy5yZXBvc2l0aW9uKCkpfSxTLl9jcmVhdGVQb3NDbGFzcz1mdW5jdGlvbih0KXtyZXR1cm4geisiLXBvcy0iKyh0fHx0aGlzLm9wdGlvbnMucG9zaXRpb24ubXkpLmFiYnJldigpfSxTLnJlcG9zaXRpb249ZnVuY3Rpb24oZSxpKXtpZighdGhpcy5yZW5kZXJlZHx8dGhpcy5wb3NpdGlvbmluZ3x8dGhpcy5kZXN0cm95ZWQpcmV0dXJuIHRoaXM7dGhpcy5wb3NpdGlvbmluZz1EO3ZhciBuLHIscyxsLGM9dGhpcy5jYWNoZSx1PXRoaXMudG9vbHRpcCxkPXRoaXMub3B0aW9ucy5wb3NpdGlvbixoPWQudGFyZ2V0LHA9ZC5teSxmPWQuYXQsbT1kLnZpZXdwb3J0LF89ZC5jb250YWluZXIsZz1kLmFkanVzdCx2PWcubWV0aG9kLnNwbGl0KCIgIikseT11Lm91dGVyV2lkdGgoWSksYj11Lm91dGVySGVpZ2h0KFkpLHc9MCxNPTAsaz11LmNzcygicG9zaXRpb24iKSxUPXtsZWZ0OjAsdG9wOjB9LFM9dVswXS5vZmZzZXRXaWR0aD4wLEw9ZSYmInNjcm9sbCI9PT1lLnR5cGUseD10KG8pLEU9X1swXS5vd25lckRvY3VtZW50LEM9dGhpcy5tb3VzZTtpZih0LmlzQXJyYXkoaCkmJjI9PT1oLmxlbmd0aClmPXt4OlIseTpQfSxUPXtsZWZ0OmhbMF0sdG9wOmhbMV19O2Vsc2UgaWYoIm1vdXNlIj09PWgpZj17eDpSLHk6UH0sKCFnLm1vdXNlfHx0aGlzLm9wdGlvbnMuaGlkZS5kaXN0YW5jZSkmJmMub3JpZ2luJiZjLm9yaWdpbi5wYWdlWD9lPWMub3JpZ2luOiFlfHxlJiYoInJlc2l6ZSI9PT1lLnR5cGV8fCJzY3JvbGwiPT09ZS50eXBlKT9lPWMuZXZlbnQ6QyYmQy5wYWdlWCYmKGU9QyksInN0YXRpYyIhPT1rJiYoVD1fLm9mZnNldCgpKSxFLmJvZHkub2Zmc2V0V2lkdGghPT0oby5pbm5lcldpZHRofHxFLmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCkmJihyPXQoYS5ib2R5KS5vZmZzZXQoKSksVD17bGVmdDplLnBhZ2VYLVQubGVmdCsociYmci5sZWZ0fHwwKSx0b3A6ZS5wYWdlWS1ULnRvcCsociYmci50b3B8fDApfSxnLm1vdXNlJiZMJiZDJiYoVC5sZWZ0LT0oQy5zY3JvbGxYfHwwKS14LnNjcm9sbExlZnQoKSxULnRvcC09KEMuc2Nyb2xsWXx8MCkteC5zY3JvbGxUb3AoKSk7ZWxzZXtpZigiZXZlbnQiPT09aD9lJiZlLnRhcmdldCYmInNjcm9sbCIhPT1lLnR5cGUmJiJyZXNpemUiIT09ZS50eXBlP2MudGFyZ2V0PXQoZS50YXJnZXQpOmUudGFyZ2V0fHwoYy50YXJnZXQ9dGhpcy5lbGVtZW50cy50YXJnZXQpOiJldmVudCIhPT1oJiYoYy50YXJnZXQ9dChoLmpxdWVyeT9oOnRoaXMuZWxlbWVudHMudGFyZ2V0KSksaD1jLnRhcmdldCxoPXQoaCkuZXEoMCksMD09PWgubGVuZ3RoKXJldHVybiB0aGlzO2hbMF09PT1hfHxoWzBdPT09bz8odz1udC5pT1M/by5pbm5lcldpZHRoOmgud2lkdGgoKSxNPW50LmlPUz9vLmlubmVySGVpZ2h0OmguaGVpZ2h0KCksaFswXT09PW8mJihUPXt0b3A6KG18fGgpLnNjcm9sbFRvcCgpLGxlZnQ6KG18fGgpLnNjcm9sbExlZnQoKX0pKTpCLmltYWdlbWFwJiZoLmlzKCJhcmVhIik/bj1CLmltYWdlbWFwKHRoaXMsaCxmLEIudmlld3BvcnQ/djpZKTpCLnN2ZyYmaCYmaFswXS5vd25lclNWR0VsZW1lbnQ/bj1CLnN2Zyh0aGlzLGgsZixCLnZpZXdwb3J0P3Y6WSk6KHc9aC5vdXRlcldpZHRoKFkpLE09aC5vdXRlckhlaWdodChZKSxUPWgub2Zmc2V0KCkpLG4mJih3PW4ud2lkdGgsTT1uLmhlaWdodCxyPW4ub2Zmc2V0LFQ9bi5wb3NpdGlvbiksVD10aGlzLnJlcG9zaXRpb24ub2Zmc2V0KGgsVCxfKSwobnQuaU9TPjMuMSYmbnQuaU9TPDQuMXx8bnQuaU9TPj00LjMmJm50LmlPUzw0LjMzfHwhbnQuaU9TJiYiZml4ZWQiPT09aykmJihULmxlZnQtPXguc2Nyb2xsTGVmdCgpLFQudG9wLT14LnNjcm9sbFRvcCgpKSwoIW58fG4mJm4uYWRqdXN0YWJsZSE9PVkpJiYoVC5sZWZ0Kz1mLng9PT1qP3c6Zi54PT09Rj93LzI6MCxULnRvcCs9Zi55PT09SD9NOmYueT09PUY/TS8yOjApfXJldHVybiBULmxlZnQrPWcueCsocC54PT09aj8teTpwLng9PT1GPy15LzI6MCksVC50b3ArPWcueSsocC55PT09SD8tYjpwLnk9PT1GPy1iLzI6MCksQi52aWV3cG9ydD8ocz1ULmFkanVzdGVkPUIudmlld3BvcnQodGhpcyxULGQsdyxNLHksYiksciYmcy5sZWZ0JiYoVC5sZWZ0Kz1yLmxlZnQpLHImJnMudG9wJiYoVC50b3ArPXIudG9wKSxzLm15JiYodGhpcy5wb3NpdGlvbi5teT1zLm15KSk6VC5hZGp1c3RlZD17bGVmdDowLHRvcDowfSxjLnBvc0NsYXNzIT09KGw9dGhpcy5fY3JlYXRlUG9zQ2xhc3ModGhpcy5wb3NpdGlvbi5teSkpJiYoYy5wb3NDbGFzcz1sLHUucmVtb3ZlQ2xhc3MoYy5wb3NDbGFzcykuYWRkQ2xhc3MobCkpLHRoaXMuX3RyaWdnZXIoIm1vdmUiLFtULG0uZWxlbXx8bV0sZSk/KGRlbGV0ZSBULmFkanVzdGVkLGk9PT1ZfHwhU3x8aXNOYU4oVC5sZWZ0KXx8aXNOYU4oVC50b3ApfHwibW91c2UiPT09aHx8IXQuaXNGdW5jdGlvbihkLmVmZmVjdCk/dS5jc3MoVCk6dC5pc0Z1bmN0aW9uKGQuZWZmZWN0KSYmKGQuZWZmZWN0LmNhbGwodSx0aGlzLHQuZXh0ZW5kKHt9LFQpKSx1LnF1ZXVlKGZ1bmN0aW9uKGUpe3QodGhpcykuY3NzKHtvcGFjaXR5OiIiLGhlaWdodDoiIn0pLG50LmllJiZ0aGlzLnN0eWxlLnJlbW92ZUF0dHJpYnV0ZSgiZmlsdGVyIiksZSgpfSkpLHRoaXMucG9zaXRpb25pbmc9WSx0aGlzKTp0aGlzfSxTLnJlcG9zaXRpb24ub2Zmc2V0PWZ1bmN0aW9uKGUsaSxuKXtmdW5jdGlvbiByKHQsZSl7aS5sZWZ0Kz1lKnQuc2Nyb2xsTGVmdCgpLGkudG9wKz1lKnQuc2Nyb2xsVG9wKCl9aWYoIW5bMF0pcmV0dXJuIGk7dmFyIHMsbyxsLGMsdT10KGVbMF0ub3duZXJEb2N1bWVudCksZD0hIW50LmllJiYiQ1NTMUNvbXBhdCIhPT1hLmNvbXBhdE1vZGUsaD1uWzBdO2RvInN0YXRpYyIhPT0obz10LmNzcyhoLCJwb3NpdGlvbiIpKSYmKCJmaXhlZCI9PT1vPyhsPWguZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkscih1LC0xKSk6KGw9dChoKS5wb3NpdGlvbigpLGwubGVmdCs9cGFyc2VGbG9hdCh0LmNzcyhoLCJib3JkZXJMZWZ0V2lkdGgiKSl8fDAsbC50b3ArPXBhcnNlRmxvYXQodC5jc3MoaCwiYm9yZGVyVG9wV2lkdGgiKSl8fDApLGkubGVmdC09bC5sZWZ0KyhwYXJzZUZsb2F0KHQuY3NzKGgsIm1hcmdpbkxlZnQiKSl8fDApLGkudG9wLT1sLnRvcCsocGFyc2VGbG9hdCh0LmNzcyhoLCJtYXJnaW5Ub3AiKSl8fDApLHN8fCJoaWRkZW4iPT09KGM9dC5jc3MoaCwib3ZlcmZsb3ciKSl8fCJ2aXNpYmxlIj09PWN8fCJCT0RZIj09PXQucHJvcChoLCJ0YWdOYW1lIil8fChzPXQoaCkpKTt3aGlsZShoPWgub2Zmc2V0UGFyZW50KTtyZXR1cm4gcyYmKHNbMF0hPT11WzBdfHxkKSYmcihzLDEpLGl9O3ZhciBvdD0oTD1TLnJlcG9zaXRpb24uQ29ybmVyPWZ1bmN0aW9uKHQsZSl7dD0oIiIrdCkucmVwbGFjZSgvKFtBLVpdKS8sIiAkMSIpLnJlcGxhY2UoL21pZGRsZS9naSxGKS50b0xvd2VyQ2FzZSgpLHRoaXMueD0odC5tYXRjaCgvbGVmdHxyaWdodC9pKXx8dC5tYXRjaCgvY2VudGVyLyl8fFsiaW5oZXJpdCJdKVswXS50b0xvd2VyQ2FzZSgpLHRoaXMueT0odC5tYXRjaCgvdG9wfGJvdHRvbXxjZW50ZXIvaSl8fFsiaW5oZXJpdCJdKVswXS50b0xvd2VyQ2FzZSgpLHRoaXMuZm9yY2VZPSEhZTt2YXIgaT10LmNoYXJBdCgwKTt0aGlzLnByZWNlZGFuY2U9InQiPT09aXx8ImIiPT09aT9POkF9KS5wcm90b3R5cGU7b3QuaW52ZXJ0PWZ1bmN0aW9uKHQsZSl7dGhpc1t0XT10aGlzW3RdPT09Uj9qOnRoaXNbdF09PT1qP1I6ZXx8dGhpc1t0XX0sb3Quc3RyaW5nPWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMueCxpPXRoaXMueSxuPWUhPT1pPyJjZW50ZXIiPT09ZXx8ImNlbnRlciIhPT1pJiYodGhpcy5wcmVjZWRhbmNlPT09T3x8dGhpcy5mb3JjZVkpP1tpLGVdOltlLGldOltlXTtyZXR1cm4gdCE9PSExP24uam9pbigiICIpOm59LG90LmFiYnJldj1mdW5jdGlvbigpe3ZhciB0PXRoaXMuc3RyaW5nKCExKTtyZXR1cm4gdFswXS5jaGFyQXQoMCkrKHRbMV0mJnRbMV0uY2hhckF0KDApfHwiIil9LG90LmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBMKHRoaXMuc3RyaW5nKCksdGhpcy5mb3JjZVkpfSxTLnRvZ2dsZT1mdW5jdGlvbihlLGkpe3ZhciBuPXRoaXMuY2FjaGUscj10aGlzLm9wdGlvbnMscz10aGlzLnRvb2x0aXA7aWYoaSl7aWYoL292ZXJ8ZW50ZXIvLnRlc3QoaS50eXBlKSYmbi5ldmVudCYmL291dHxsZWF2ZS8udGVzdChuLmV2ZW50LnR5cGUpJiZyLnNob3cudGFyZ2V0LmFkZChpLnRhcmdldCkubGVuZ3RoPT09ci5zaG93LnRhcmdldC5sZW5ndGgmJnMuaGFzKGkucmVsYXRlZFRhcmdldCkubGVuZ3RoKXJldHVybiB0aGlzO24uZXZlbnQ9dC5ldmVudC5maXgoaSl9aWYodGhpcy53YWl0aW5nJiYhZSYmKHRoaXMuaGlkZGVuRHVyaW5nV2FpdD1EKSwhdGhpcy5yZW5kZXJlZClyZXR1cm4gZT90aGlzLnJlbmRlcigxKTp0aGlzO2lmKHRoaXMuZGVzdHJveWVkfHx0aGlzLmRpc2FibGVkKXJldHVybiB0aGlzO3ZhciBvLGwsYyx1PWU/InNob3ciOiJoaWRlIixkPXRoaXMub3B0aW9uc1t1XSxoPXRoaXMub3B0aW9ucy5wb3NpdGlvbixwPXRoaXMub3B0aW9ucy5jb250ZW50LGY9dGhpcy50b29sdGlwLmNzcygid2lkdGgiKSxtPXRoaXMudG9vbHRpcC5pcygiOnZpc2libGUiKSxfPWV8fDE9PT1kLnRhcmdldC5sZW5ndGgsZz0haXx8ZC50YXJnZXQubGVuZ3RoPDJ8fG4udGFyZ2V0WzBdPT09aS50YXJnZXQ7cmV0dXJuKHR5cGVvZiBlKS5zZWFyY2goImJvb2xlYW58bnVtYmVyIikmJihlPSFtKSxvPSFzLmlzKCI6YW5pbWF0ZWQiKSYmbT09PWUmJmcsbD1vP0M6ISF0aGlzLl90cmlnZ2VyKHUsWzkwXSksdGhpcy5kZXN0cm95ZWQ/dGhpczoobCE9PVkmJmUmJnRoaXMuZm9jdXMoaSksIWx8fG8/dGhpczoodC5hdHRyKHNbMF0sImFyaWEtaGlkZGVuIiwhZSksZT8odGhpcy5tb3VzZSYmKG4ub3JpZ2luPXQuZXZlbnQuZml4KHRoaXMubW91c2UpKSx0LmlzRnVuY3Rpb24ocC50ZXh0KSYmdGhpcy5fdXBkYXRlQ29udGVudChwLnRleHQsWSksdC5pc0Z1bmN0aW9uKHAudGl0bGUpJiZ0aGlzLl91cGRhdGVUaXRsZShwLnRpdGxlLFkpLCFFJiYibW91c2UiPT09aC50YXJnZXQmJmguYWRqdXN0Lm1vdXNlJiYodChhKS5iaW5kKCJtb3VzZW1vdmUuIit6LHRoaXMuX3N0b3JlTW91c2UpLEU9RCksZnx8cy5jc3MoIndpZHRoIixzLm91dGVyV2lkdGgoWSkpLHRoaXMucmVwb3NpdGlvbihpLGFyZ3VtZW50c1syXSksZnx8cy5jc3MoIndpZHRoIiwiIiksZC5zb2xvJiYoInN0cmluZyI9PXR5cGVvZiBkLnNvbG8/dChkLnNvbG8pOnQoRyxkLnNvbG8pKS5ub3Qocykubm90KGQudGFyZ2V0KS5xdGlwKCJoaWRlIixuZXcgdC5FdmVudCgidG9vbHRpcHNvbG8iKSkpOihjbGVhclRpbWVvdXQodGhpcy50aW1lcnMuc2hvdyksZGVsZXRlIG4ub3JpZ2luLEUmJiF0KEcrJ1t0cmFja2luZz0idHJ1ZSJdOnZpc2libGUnLGQuc29sbykubm90KHMpLmxlbmd0aCYmKHQoYSkudW5iaW5kKCJtb3VzZW1vdmUuIit6KSxFPVkpLHRoaXMuYmx1cihpKSksYz10LnByb3h5KGZ1bmN0aW9uKCl7ZT8obnQuaWUmJnNbMF0uc3R5bGUucmVtb3ZlQXR0cmlidXRlKCJmaWx0ZXIiKSxzLmNzcygib3ZlcmZsb3ciLCIiKSwic3RyaW5nIj09dHlwZW9mIGQuYXV0b2ZvY3VzJiZ0KHRoaXMub3B0aW9ucy5zaG93LmF1dG9mb2N1cyxzKS5mb2N1cygpLHRoaXMub3B0aW9ucy5zaG93LnRhcmdldC50cmlnZ2VyKCJxdGlwLSIrdGhpcy5pZCsiLWluYWN0aXZlIikpOnMuY3NzKHtkaXNwbGF5OiIiLHZpc2liaWxpdHk6IiIsb3BhY2l0eToiIixsZWZ0OiIiLHRvcDoiIn0pLHRoaXMuX3RyaWdnZXIoZT8idmlzaWJsZSI6ImhpZGRlbiIpfSx0aGlzKSxkLmVmZmVjdD09PVl8fF89PT1ZPyhzW3VdKCksYygpKTp0LmlzRnVuY3Rpb24oZC5lZmZlY3QpPyhzLnN0b3AoMSwxKSxkLmVmZmVjdC5jYWxsKHMsdGhpcykscy5xdWV1ZSgiZngiLGZ1bmN0aW9uKHQpe2MoKSx0KCl9KSk6cy5mYWRlVG8oOTAsZT8xOjAsYyksZSYmZC50YXJnZXQudHJpZ2dlcigicXRpcC0iK3RoaXMuaWQrIi1pbmFjdGl2ZSIpLHRoaXMpKX0sUy5zaG93PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRvZ2dsZShELHQpfSxTLmhpZGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudG9nZ2xlKFksdCl9LFMuZm9jdXM9ZnVuY3Rpb24oZSl7aWYoIXRoaXMucmVuZGVyZWR8fHRoaXMuZGVzdHJveWVkKXJldHVybiB0aGlzO3ZhciBpPXQoRyksbj10aGlzLnRvb2x0aXAscj1wYXJzZUludChuWzBdLnN0eWxlLnpJbmRleCwxMCkscz1ULnppbmRleCtpLmxlbmd0aDtyZXR1cm4gbi5oYXNDbGFzcyhYKXx8dGhpcy5fdHJpZ2dlcigiZm9jdXMiLFtzXSxlKSYmKHIhPT1zJiYoaS5lYWNoKGZ1bmN0aW9uKCl7dGhpcy5zdHlsZS56SW5kZXg+ciYmKHRoaXMuc3R5bGUuekluZGV4PXRoaXMuc3R5bGUuekluZGV4LTEpfSksaS5maWx0ZXIoIi4iK1gpLnF0aXAoImJsdXIiLGUpKSxuLmFkZENsYXNzKFgpWzBdLnN0eWxlLnpJbmRleD1zKSx0aGlzfSxTLmJsdXI9ZnVuY3Rpb24odCl7cmV0dXJuIXRoaXMucmVuZGVyZWR8fHRoaXMuZGVzdHJveWVkP3RoaXM6KHRoaXMudG9vbHRpcC5yZW1vdmVDbGFzcyhYKSx0aGlzLl90cmlnZ2VyKCJibHVyIixbdGhpcy50b29sdGlwLmNzcygiekluZGV4IildLHQpLHRoaXMpfSxTLmRpc2FibGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZGVzdHJveWVkP3RoaXM6KCJ0b2dnbGUiPT09dD90PSEodGhpcy5yZW5kZXJlZD90aGlzLnRvb2x0aXAuaGFzQ2xhc3ModHQpOnRoaXMuZGlzYWJsZWQpOiJib29sZWFuIiE9dHlwZW9mIHQmJih0PUQpLHRoaXMucmVuZGVyZWQmJnRoaXMudG9vbHRpcC50b2dnbGVDbGFzcyh0dCx0KS5hdHRyKCJhcmlhLWRpc2FibGVkIix0KSx0aGlzLmRpc2FibGVkPSEhdCx0aGlzKX0sUy5lbmFibGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXNhYmxlKFkpfSxTLl9jcmVhdGVCdXR0b249ZnVuY3Rpb24oKXt2YXIgZT10aGlzLGk9dGhpcy5lbGVtZW50cyxuPWkudG9vbHRpcCxyPXRoaXMub3B0aW9ucy5jb250ZW50LmJ1dHRvbixzPSJzdHJpbmciPT10eXBlb2YgcixvPXM/cjoiQ2xvc2UgdG9vbHRpcCI7aS5idXR0b24mJmkuYnV0dG9uLnJlbW92ZSgpLHIuanF1ZXJ5P2kuYnV0dG9uPXI6aS5idXR0b249dCgiPGEgLz4iLHsiY2xhc3MiOiJxdGlwLWNsb3NlICIrKHRoaXMub3B0aW9ucy5zdHlsZS53aWRnZXQ/IiI6eisiLWljb24iKSx0aXRsZTpvLCJhcmlhLWxhYmVsIjpvfSkucHJlcGVuZCh0KCI8c3BhbiAvPiIseyJjbGFzcyI6InVpLWljb24gdWktaWNvbi1jbG9zZSIsaHRtbDoiJnRpbWVzOyJ9KSksaS5idXR0b24uYXBwZW5kVG8oaS50aXRsZWJhcnx8bikuYXR0cigicm9sZSIsImJ1dHRvbiIpLmNsaWNrKGZ1bmN0aW9uKHQpe3JldHVybiBuLmhhc0NsYXNzKHR0KXx8ZS5oaWRlKHQpLFl9KX0sUy5fdXBkYXRlQnV0dG9uPWZ1bmN0aW9uKHQpe2lmKCF0aGlzLnJlbmRlcmVkKXJldHVybiBZO3ZhciBlPXRoaXMuZWxlbWVudHMuYnV0dG9uO3Q/dGhpcy5fY3JlYXRlQnV0dG9uKCk6ZS5yZW1vdmUoKX0sUy5fc2V0V2lkZ2V0PWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5vcHRpb25zLnN0eWxlLndpZGdldCxlPXRoaXMuZWxlbWVudHMsaT1lLnRvb2x0aXAsbj1pLmhhc0NsYXNzKHR0KTtpLnJlbW92ZUNsYXNzKHR0KSx0dD10PyJ1aS1zdGF0ZS1kaXNhYmxlZCI6InF0aXAtZGlzYWJsZWQiLGkudG9nZ2xlQ2xhc3ModHQsbiksaS50b2dnbGVDbGFzcygidWktaGVscGVyLXJlc2V0ICIrdSgpLHQpLnRvZ2dsZUNsYXNzKFEsdGhpcy5vcHRpb25zLnN0eWxlLmRlZiYmIXQpLGUuY29udGVudCYmZS5jb250ZW50LnRvZ2dsZUNsYXNzKHUoImNvbnRlbnQiKSx0KSxlLnRpdGxlYmFyJiZlLnRpdGxlYmFyLnRvZ2dsZUNsYXNzKHUoImhlYWRlciIpLHQpLGUuYnV0dG9uJiZlLmJ1dHRvbi50b2dnbGVDbGFzcyh6KyItaWNvbiIsIXQpfSxTLl9zdG9yZU1vdXNlPWZ1bmN0aW9uKGUpe3JldHVybih0aGlzLm1vdXNlPXQuZXZlbnQuZml4KGUpKS50eXBlPSJtb3VzZW1vdmUiLHRoaXN9LFMuX2JpbmQ9ZnVuY3Rpb24oZSxpLG4scixzKXtpZihlJiZuJiZpLmxlbmd0aCl7dmFyIG89Ii4iK3RoaXMuX2lkKyhyPyItIityOiIiKTtyZXR1cm4gdChlKS5iaW5kKChpLnNwbGl0P2k6aS5qb2luKG8rIiAiKSkrbyx0LnByb3h5KG4sc3x8dGhpcykpLHRoaXN9fSxTLl91bmJpbmQ9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gZSYmdChlKS51bmJpbmQoIi4iK3RoaXMuX2lkKyhpPyItIitpOiIiKSksdGhpc30sUy5fdHJpZ2dlcj1mdW5jdGlvbihlLGksbil7dmFyIHI9bmV3IHQuRXZlbnQoInRvb2x0aXAiK2UpO3JldHVybiByLm9yaWdpbmFsRXZlbnQ9biYmdC5leHRlbmQoe30sbil8fHRoaXMuY2FjaGUuZXZlbnR8fEMsdGhpcy50cmlnZ2VyaW5nPWUsdGhpcy50b29sdGlwLnRyaWdnZXIocixbdGhpc10uY29uY2F0KGl8fFtdKSksdGhpcy50cmlnZ2VyaW5nPVksIXIuaXNEZWZhdWx0UHJldmVudGVkKCl9LFMuX2JpbmRFdmVudHM9ZnVuY3Rpb24oZSxpLG4scixzLG8pe3ZhciBhPW4uZmlsdGVyKHIpLmFkZChyLmZpbHRlcihuKSksbD1bXTthLmxlbmd0aCYmKHQuZWFjaChpLGZ1bmN0aW9uKGksbil7dmFyIHI9dC5pbkFycmF5KG4sZSk7cj4tMSYmbC5wdXNoKGUuc3BsaWNlKHIsMSlbMF0pfSksbC5sZW5ndGgmJih0aGlzLl9iaW5kKGEsbCxmdW5jdGlvbih0KXt2YXIgZT0hIXRoaXMucmVuZGVyZWQmJnRoaXMudG9vbHRpcFswXS5vZmZzZXRXaWR0aD4wOyhlP286cykuY2FsbCh0aGlzLHQpfSksbj1uLm5vdChhKSxyPXIubm90KGEpKSksdGhpcy5fYmluZChuLGUscyksdGhpcy5fYmluZChyLGksbyl9LFMuX2Fzc2lnbkluaXRpYWxFdmVudHM9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gaShlKXtyZXR1cm4gdGhpcy5kaXNhYmxlZHx8dGhpcy5kZXN0cm95ZWQ/WToodGhpcy5jYWNoZS5ldmVudD1lJiZ0LmV2ZW50LmZpeChlKSx0aGlzLmNhY2hlLnRhcmdldD1lJiZ0KGUudGFyZ2V0KSxjbGVhclRpbWVvdXQodGhpcy50aW1lcnMuc2hvdyksdm9pZCh0aGlzLnRpbWVycy5zaG93PWQuY2FsbCh0aGlzLGZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIoIm9iamVjdCI9PXR5cGVvZiBlfHxuLnNob3cucmVhZHkpfSxuLnByZXJlbmRlcj8wOm4uc2hvdy5kZWxheSkpKX12YXIgbj10aGlzLm9wdGlvbnMscj1uLnNob3cudGFyZ2V0LHM9bi5oaWRlLnRhcmdldCxvPW4uc2hvdy5ldmVudD90LnRyaW0oIiIrbi5zaG93LmV2ZW50KS5zcGxpdCgiICIpOltdLGE9bi5oaWRlLmV2ZW50P3QudHJpbSgiIituLmhpZGUuZXZlbnQpLnNwbGl0KCIgIik6W107dGhpcy5fYmluZCh0aGlzLmVsZW1lbnRzLnRhcmdldCxbInJlbW92ZSIsInJlbW92ZXF0aXAiXSxmdW5jdGlvbigpe3RoaXMuZGVzdHJveSghMCl9LCJkZXN0cm95IiksL21vdXNlKG92ZXJ8ZW50ZXIpL2kudGVzdChuLnNob3cuZXZlbnQpJiYhL21vdXNlKG91dHxsZWF2ZSkvaS50ZXN0KG4uaGlkZS5ldmVudCkmJmEucHVzaCgibW91c2VsZWF2ZSIpLHRoaXMuX2JpbmQociwibW91c2Vtb3ZlIixmdW5jdGlvbih0KXt0aGlzLl9zdG9yZU1vdXNlKHQpLHRoaXMuY2FjaGUub25UYXJnZXQ9RH0pLHRoaXMuX2JpbmRFdmVudHMobyxhLHIscyxpLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGltZXJzP3ZvaWQgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnNob3cpOll9KSwobi5zaG93LnJlYWR5fHxuLnByZXJlbmRlcikmJmkuY2FsbCh0aGlzLGUpfSxTLl9hc3NpZ25FdmVudHM9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLGk9dGhpcy5vcHRpb25zLG49aS5wb3NpdGlvbixyPXRoaXMudG9vbHRpcCxzPWkuc2hvdy50YXJnZXQsbD1pLmhpZGUudGFyZ2V0LGM9bi5jb250YWluZXIsdT1uLnZpZXdwb3J0LGQ9dChhKSxfPXQobyksZz1pLnNob3cuZXZlbnQ/dC50cmltKCIiK2kuc2hvdy5ldmVudCkuc3BsaXQoIiAiKTpbXSx2PWkuaGlkZS5ldmVudD90LnRyaW0oIiIraS5oaWRlLmV2ZW50KS5zcGxpdCgiICIpOltdO3QuZWFjaChpLmV2ZW50cyxmdW5jdGlvbih0LGkpe2UuX2JpbmQociwidG9nZ2xlIj09PXQ/WyJ0b29sdGlwc2hvdyIsInRvb2x0aXBoaWRlIl06WyJ0b29sdGlwIit0XSxpLG51bGwscil9KSwvbW91c2Uob3V0fGxlYXZlKS9pLnRlc3QoaS5oaWRlLmV2ZW50KSYmIndpbmRvdyI9PT1pLmhpZGUubGVhdmUmJnRoaXMuX2JpbmQoZCxbIm1vdXNlb3V0IiwiYmx1ciJdLGZ1bmN0aW9uKHQpey9zZWxlY3R8b3B0aW9uLy50ZXN0KHQudGFyZ2V0Lm5vZGVOYW1lKXx8dC5yZWxhdGVkVGFyZ2V0fHx0aGlzLmhpZGUodCl9KSxpLmhpZGUuZml4ZWQ/bD1sLmFkZChyLmFkZENsYXNzKEspKTovbW91c2Uob3ZlcnxlbnRlcikvaS50ZXN0KGkuc2hvdy5ldmVudCkmJnRoaXMuX2JpbmQobCwibW91c2VsZWF2ZSIsZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQodGhpcy50aW1lcnMuc2hvdyl9KSwoIiIraS5oaWRlLmV2ZW50KS5pbmRleE9mKCJ1bmZvY3VzIik+LTEmJnRoaXMuX2JpbmQoYy5jbG9zZXN0KCJodG1sIiksWyJtb3VzZWRvd24iLCJ0b3VjaHN0YXJ0Il0sZnVuY3Rpb24oZSl7dmFyIGk9dChlLnRhcmdldCksbj10aGlzLnJlbmRlcmVkJiYhdGhpcy50b29sdGlwLmhhc0NsYXNzKHR0KSYmdGhpcy50b29sdGlwWzBdLm9mZnNldFdpZHRoPjAscj1pLnBhcmVudHMoRykuZmlsdGVyKHRoaXMudG9vbHRpcFswXSkubGVuZ3RoPjA7aVswXT09PXRoaXMudGFyZ2V0WzBdfHxpWzBdPT09dGhpcy50b29sdGlwWzBdfHxyfHx0aGlzLnRhcmdldC5oYXMoaVswXSkubGVuZ3RofHwhbnx8dGhpcy5oaWRlKGUpfSksIm51bWJlciI9PXR5cGVvZiBpLmhpZGUuaW5hY3RpdmUmJih0aGlzLl9iaW5kKHMsInF0aXAtIit0aGlzLmlkKyItaW5hY3RpdmUiLGYsImluYWN0aXZlIiksdGhpcy5fYmluZChsLmFkZChyKSxULmluYWN0aXZlRXZlbnRzLGYpKSx0aGlzLl9iaW5kRXZlbnRzKGcsdixzLGwsaCxwKSx0aGlzLl9iaW5kKHMuYWRkKHIpLCJtb3VzZW1vdmUiLGZ1bmN0aW9uKHQpe2lmKCJudW1iZXIiPT10eXBlb2YgaS5oaWRlLmRpc3RhbmNlKXt2YXIgZT10aGlzLmNhY2hlLm9yaWdpbnx8e30sbj10aGlzLm9wdGlvbnMuaGlkZS5kaXN0YW5jZSxyPU1hdGguYWJzOyhyKHQucGFnZVgtZS5wYWdlWCk+PW58fHIodC5wYWdlWS1lLnBhZ2VZKT49bikmJnRoaXMuaGlkZSh0KX10aGlzLl9zdG9yZU1vdXNlKHQpfSksIm1vdXNlIj09PW4udGFyZ2V0JiZuLmFkanVzdC5tb3VzZSYmKGkuaGlkZS5ldmVudCYmdGhpcy5fYmluZChzLFsibW91c2VlbnRlciIsIm1vdXNlbGVhdmUiXSxmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jYWNoZT92b2lkKHRoaXMuY2FjaGUub25UYXJnZXQ9Im1vdXNlZW50ZXIiPT09dC50eXBlKTpZfSksdGhpcy5fYmluZChkLCJtb3VzZW1vdmUiLGZ1bmN0aW9uKHQpe3RoaXMucmVuZGVyZWQmJnRoaXMuY2FjaGUub25UYXJnZXQmJiF0aGlzLnRvb2x0aXAuaGFzQ2xhc3ModHQpJiZ0aGlzLnRvb2x0aXBbMF0ub2Zmc2V0V2lkdGg+MCYmdGhpcy5yZXBvc2l0aW9uKHQpfSkpLChuLmFkanVzdC5yZXNpemV8fHUubGVuZ3RoKSYmdGhpcy5fYmluZCh0LmV2ZW50LnNwZWNpYWwucmVzaXplP3U6XywicmVzaXplIixtKSxuLmFkanVzdC5zY3JvbGwmJnRoaXMuX2JpbmQoXy5hZGQobi5jb250YWluZXIpLCJzY3JvbGwiLG0pfSxTLl91bmFzc2lnbkV2ZW50cz1mdW5jdGlvbigpe3ZhciBlPXRoaXMub3B0aW9ucyxpPWUuc2hvdy50YXJnZXQsbj1lLmhpZGUudGFyZ2V0LHI9dC5ncmVwKFt0aGlzLmVsZW1lbnRzLnRhcmdldFswXSx0aGlzLnJlbmRlcmVkJiZ0aGlzLnRvb2x0aXBbMF0sZS5wb3NpdGlvbi5jb250YWluZXJbMF0sZS5wb3NpdGlvbi52aWV3cG9ydFswXSxlLnBvc2l0aW9uLmNvbnRhaW5lci5jbG9zZXN0KCJodG1sIilbMF0sbyxhXSxmdW5jdGlvbih0KXtyZXR1cm4ib2JqZWN0Ij09dHlwZW9mIHR9KTtpJiZpLnRvQXJyYXkmJihyPXIuY29uY2F0KGkudG9BcnJheSgpKSksbiYmbi50b0FycmF5JiYocj1yLmNvbmNhdChuLnRvQXJyYXkoKSkpLHRoaXMuX3VuYmluZChyKS5fdW5iaW5kKHIsImRlc3Ryb3kiKS5fdW5iaW5kKHIsImluYWN0aXZlIil9LHQoZnVuY3Rpb24oKXtfKEcsWyJtb3VzZWVudGVyIiwibW91c2VsZWF2ZSJdLGZ1bmN0aW9uKGUpe3ZhciBpPSJtb3VzZWVudGVyIj09PWUudHlwZSxuPXQoZS5jdXJyZW50VGFyZ2V0KSxyPXQoZS5yZWxhdGVkVGFyZ2V0fHxlLnRhcmdldCkscz10aGlzLm9wdGlvbnM7aT8odGhpcy5mb2N1cyhlKSxuLmhhc0NsYXNzKEspJiYhbi5oYXNDbGFzcyh0dCkmJmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5oaWRlKSk6Im1vdXNlIj09PXMucG9zaXRpb24udGFyZ2V0JiZzLnBvc2l0aW9uLmFkanVzdC5tb3VzZSYmcy5oaWRlLmV2ZW50JiZzLnNob3cudGFyZ2V0JiYhci5jbG9zZXN0KHMuc2hvdy50YXJnZXRbMF0pLmxlbmd0aCYmdGhpcy5oaWRlKGUpLG4udG9nZ2xlQ2xhc3MoWixpKX0pLF8oIlsiKyQrIl0iLEosZil9KSxUPXQuZm4ucXRpcD1mdW5jdGlvbihlLGksbil7dmFyIHM9KCIiK2UpLnRvTG93ZXJDYXNlKCksbz1DLGE9dC5tYWtlQXJyYXkoYXJndW1lbnRzKS5zbGljZSgxKSxjPWFbYS5sZW5ndGgtMV0sdT10aGlzWzBdP3QuZGF0YSh0aGlzWzBdLHopOkM7cmV0dXJuIWFyZ3VtZW50cy5sZW5ndGgmJnV8fCJhcGkiPT09cz91OiJzdHJpbmciPT10eXBlb2YgZT8odGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGU9dC5kYXRhKHRoaXMseik7aWYoIWUpcmV0dXJuIEQ7aWYoYyYmYy50aW1lU3RhbXAmJihlLmNhY2hlLmV2ZW50PWMpLCFpfHwib3B0aW9uIiE9PXMmJiJvcHRpb25zIiE9PXMpZVtzXSYmZVtzXS5hcHBseShlLGEpO2Vsc2V7aWYobj09PWwmJiF0LmlzUGxhaW5PYmplY3QoaSkpcmV0dXJuIG89ZS5nZXQoaSksWTtlLnNldChpLG4pfX0pLG8hPT1DP286dGhpcyk6Im9iamVjdCIhPXR5cGVvZiBlJiZhcmd1bWVudHMubGVuZ3RoP3ZvaWQgMDoodT1yKHQuZXh0ZW5kKEQse30sZSkpLHRoaXMuZWFjaChmdW5jdGlvbihlKXt2YXIgaSxuO3JldHVybiBuPXQuaXNBcnJheSh1LmlkKT91LmlkW2VdOnUuaWQsbj0hbnx8bj09PVl8fG4ubGVuZ3RoPDF8fFQuYXBpW25dP1QubmV4dGlkKys6bixpPWcodCh0aGlzKSxuLHUpLGk9PT1ZP0Q6KFQuYXBpW25dPWksdC5lYWNoKEIsZnVuY3Rpb24oKXsiaW5pdGlhbGl6ZSI9PT10aGlzLmluaXRpYWxpemUmJnRoaXMoaSl9KSx2b2lkIGkuX2Fzc2lnbkluaXRpYWxFdmVudHMoYykpfSkpfSx0LnF0aXA9ZSxULmFwaT17fSx0LmVhY2goe2F0dHI6ZnVuY3Rpb24oZSxpKXtpZih0aGlzLmxlbmd0aCl7dmFyIG49dGhpc1swXSxyPSJ0aXRsZSIscz10LmRhdGEobiwicXRpcCIpO2lmKGU9PT1yJiZzJiZzLm9wdGlvbnMmJiJvYmplY3QiPT10eXBlb2YgcyYmIm9iamVjdCI9PXR5cGVvZiBzLm9wdGlvbnMmJnMub3B0aW9ucy5zdXBwcmVzcylyZXR1cm4gYXJndW1lbnRzLmxlbmd0aDwyP3QuYXR0cihuLGl0KToocyYmcy5vcHRpb25zLmNvbnRlbnQuYXR0cj09PXImJnMuY2FjaGUuYXR0ciYmcy5zZXQoImNvbnRlbnQudGV4dCIsaSksdGhpcy5hdHRyKGl0LGkpKX1yZXR1cm4gdC5mblsiYXR0ciIrZXRdLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sY2xvbmU6ZnVuY3Rpb24oZSl7dmFyIGk9dC5mblsiY2xvbmUiK2V0XS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIGV8fGkuZmlsdGVyKCJbIitpdCsiXSIpLmF0dHIoInRpdGxlIixmdW5jdGlvbigpe3JldHVybiB0LmF0dHIodGhpcyxpdCl9KS5yZW1vdmVBdHRyKGl0KSxpfX0sZnVuY3Rpb24oZSxpKXtpZighaXx8dC5mbltlK2V0XSlyZXR1cm4gRDt2YXIgbj10LmZuW2UrZXRdPXQuZm5bZV07dC5mbltlXT1mdW5jdGlvbigpe3JldHVybiBpLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8bi5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSksdC51aXx8KHRbImNsZWFuRGF0YSIrZXRdPXQuY2xlYW5EYXRhLHQuY2xlYW5EYXRhPWZ1bmN0aW9uKGUpe2Zvcih2YXIgaSxuPTA7KGk9dChlW25dKSkubGVuZ3RoO24rKylpZihpLmF0dHIoVikpdHJ5e2kudHJpZ2dlckhhbmRsZXIoInJlbW92ZXF0aXAiKX1jYXRjaChyKXt9dFsiY2xlYW5EYXRhIitldF0uYXBwbHkodGhpcyxhcmd1bWVudHMpfSksVC52ZXJzaW9uPSIzLjAuMy01LWciLFQubmV4dGlkPTAsVC5pbmFjdGl2ZUV2ZW50cz1KLFQuemluZGV4PTE1ZTMsVC5kZWZhdWx0cz17cHJlcmVuZGVyOlksaWQ6WSxvdmVyd3JpdGU6RCxzdXBwcmVzczpELGNvbnRlbnQ6e3RleHQ6RCxhdHRyOiJ0aXRsZSIsdGl0bGU6WSxidXR0b246WX0scG9zaXRpb246e215OiJ0b3AgbGVmdCIsYXQ6ImJvdHRvbSByaWdodCIsdGFyZ2V0OlksY29udGFpbmVyOlksdmlld3BvcnQ6WSxhZGp1c3Q6e3g6MCx5OjAsbW91c2U6RCxzY3JvbGw6RCxyZXNpemU6RCxtZXRob2Q6ImZsaXBpbnZlcnQgZmxpcGludmVydCJ9LGVmZmVjdDpmdW5jdGlvbihlLGkpe3QodGhpcykuYW5pbWF0ZShpLHtkdXJhdGlvbjoyMDAscXVldWU6WX0pfX0sc2hvdzp7dGFyZ2V0OlksZXZlbnQ6Im1vdXNlZW50ZXIiLGVmZmVjdDpELGRlbGF5OjkwLHNvbG86WSxyZWFkeTpZLGF1dG9mb2N1czpZfSxoaWRlOnt0YXJnZXQ6WSxldmVudDoibW91c2VsZWF2ZSIsZWZmZWN0OkQsZGVsYXk6MCxmaXhlZDpZLGluYWN0aXZlOlksbGVhdmU6IndpbmRvdyIsZGlzdGFuY2U6WX0sc3R5bGU6e2NsYXNzZXM6IiIsd2lkZ2V0Olksd2lkdGg6WSxoZWlnaHQ6WSxkZWY6RH0sZXZlbnRzOntyZW5kZXI6Qyxtb3ZlOkMsc2hvdzpDLGhpZGU6Qyx0b2dnbGU6Qyx2aXNpYmxlOkMsaGlkZGVuOkMsZm9jdXM6QyxibHVyOkN9fTt2YXIgYXQsbHQsY3QsdXQsZHQsaHQ9Im1hcmdpbiIscHQ9ImJvcmRlciIsZnQ9ImNvbG9yIixtdD0iYmFja2dyb3VuZC1jb2xvciIsX3Q9InRyYW5zcGFyZW50IixndD0iICFpbXBvcnRhbnQiLHZ0PSEhYS5jcmVhdGVFbGVtZW50KCJjYW52YXMiKS5nZXRDb250ZXh0LHl0PS9yZ2JhP1woMCwgMCwgMCgsIDApP1wpfHRyYW5zcGFyZW50fCMxMjM0NTYvaSxidD17fSx3dD1bIldlYmtpdCIsIk8iLCJNb3oiLCJtcyJdO3Z0Pyh1dD1vLmRldmljZVBpeGVsUmF0aW98fDEsZHQ9ZnVuY3Rpb24oKXt2YXIgdD1hLmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpLmdldENvbnRleHQoIjJkIik7cmV0dXJuIHQuYmFja2luZ1N0b3JlUGl4ZWxSYXRpb3x8dC53ZWJraXRCYWNraW5nU3RvcmVQaXhlbFJhdGlvfHx0Lm1vekJhY2tpbmdTdG9yZVBpeGVsUmF0aW98fHQubXNCYWNraW5nU3RvcmVQaXhlbFJhdGlvfHx0Lm9CYWNraW5nU3RvcmVQaXhlbFJhdGlvfHwxfSgpLGN0PXV0L2R0KTpsdD1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIjxxdGlwdm1sOiIrdCsnIHhtbG5zPSJ1cm46c2NoZW1hcy1taWNyb3NvZnQuY29tOnZtbCIgY2xhc3M9InF0aXAtdm1sIiAnKyhlfHwiIikrJyBzdHlsZT0iYmVoYXZpb3I6IHVybCgjZGVmYXVsdCNWTUwpOyAnKyhpfHwiIikrJyIgLz4nfSx0LmV4dGVuZCh3LnByb3RvdHlwZSx7aW5pdDpmdW5jdGlvbihlKXt2YXIgaSxuO249dGhpcy5lbGVtZW50PWUuZWxlbWVudHMudGlwPXQoIjxkaXYgLz4iLHsiY2xhc3MiOnorIi10aXAifSkucHJlcGVuZFRvKGUudG9vbHRpcCksdnQ/KGk9dCgiPGNhbnZhcyAvPiIpLmFwcGVuZFRvKHRoaXMuZWxlbWVudClbMF0uZ2V0Q29udGV4dCgiMmQiKSxpLmxpbmVKb2luPSJtaXRlciIsaS5taXRlckxpbWl0PTFlNSxpLnNhdmUoKSk6KGk9bHQoInNoYXBlIiwnY29vcmRvcmlnaW49IjAsMCInLCJwb3NpdGlvbjphYnNvbHV0ZTsiKSx0aGlzLmVsZW1lbnQuaHRtbChpK2kpLGUuX2JpbmQodCgiKiIsbikuYWRkKG4pLFsiY2xpY2siLCJtb3VzZWRvd24iXSxmdW5jdGlvbih0KXt0LnN0b3BQcm9wYWdhdGlvbigpfSx0aGlzLl9ucykpLGUuX2JpbmQoZS50b29sdGlwLCJ0b29sdGlwbW92ZSIsdGhpcy5yZXBvc2l0aW9uLHRoaXMuX25zLHRoaXMpLHRoaXMuY3JlYXRlKCl9LF9zd2FwRGltZW5zaW9uczpmdW5jdGlvbigpe3RoaXMuc2l6ZVswXT10aGlzLm9wdGlvbnMuaGVpZ2h0LHRoaXMuc2l6ZVsxXT10aGlzLm9wdGlvbnMud2lkdGh9LF9yZXNldERpbWVuc2lvbnM6ZnVuY3Rpb24oKXt0aGlzLnNpemVbMF09dGhpcy5vcHRpb25zLndpZHRoLHRoaXMuc2l6ZVsxXT10aGlzLm9wdGlvbnMuaGVpZ2h0fSxfdXNlVGl0bGU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5xdGlwLmVsZW1lbnRzLnRpdGxlYmFyO3JldHVybiBlJiYodC55PT09UHx8dC55PT09RiYmdGhpcy5lbGVtZW50LnBvc2l0aW9uKCkudG9wK3RoaXMuc2l6ZVsxXS8yK3RoaXMub3B0aW9ucy5vZmZzZXQ8ZS5vdXRlckhlaWdodChEKSl9LF9wYXJzZUNvcm5lcjpmdW5jdGlvbih0KXt2YXIgZT10aGlzLnF0aXAub3B0aW9ucy5wb3NpdGlvbi5teTtyZXR1cm4gdD09PVl8fGU9PT1ZP3Q9WTp0PT09RD90PW5ldyBMKGUuc3RyaW5nKCkpOnQuc3RyaW5nfHwodD1uZXcgTCh0KSx0LmZpeGVkPUQpLHR9LF9wYXJzZVdpZHRoOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10aGlzLnF0aXAuZWxlbWVudHMscj1wdCt2KGUpKyJXaWR0aCI7cmV0dXJuKGk/YihpLHIpOmIobi5jb250ZW50LHIpfHxiKHRoaXMuX3VzZVRpdGxlKHQpJiZuLnRpdGxlYmFyfHxuLmNvbnRlbnQscil8fGIobi50b29sdGlwLHIpKXx8MH0sX3BhcnNlUmFkaXVzOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMucXRpcC5lbGVtZW50cyxpPXB0K3YodC55KSt2KHQueCkrIlJhZGl1cyI7cmV0dXJuIG50LmllPDk/MDpiKHRoaXMuX3VzZVRpdGxlKHQpJiZlLnRpdGxlYmFyfHxlLmNvbnRlbnQsaSl8fGIoZS50b29sdGlwLGkpfHwwfSxfaW52YWxpZENvbG91cjpmdW5jdGlvbih0LGUsaSl7dmFyIG49dC5jc3MoZSk7cmV0dXJuIW58fGkmJm49PT10LmNzcyhpKXx8eXQudGVzdChuKT9ZOm59LF9wYXJzZUNvbG91cnM6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5xdGlwLmVsZW1lbnRzLG49dGhpcy5lbGVtZW50LmNzcygiY3NzVGV4dCIsIiIpLHI9cHQrdihlW2UucHJlY2VkYW5jZV0pK3YoZnQpLHM9dGhpcy5fdXNlVGl0bGUoZSkmJmkudGl0bGViYXJ8fGkuY29udGVudCxvPXRoaXMuX2ludmFsaWRDb2xvdXIsYT1bXTtyZXR1cm4gYVswXT1vKG4sbXQpfHxvKHMsbXQpfHxvKGkuY29udGVudCxtdCl8fG8oaS50b29sdGlwLG10KXx8bi5jc3MobXQpLGFbMV09byhuLHIsZnQpfHxvKHMscixmdCl8fG8oaS5jb250ZW50LHIsZnQpfHxvKGkudG9vbHRpcCxyLGZ0KXx8aS50b29sdGlwLmNzcyhyKSx0KCIqIixuKS5hZGQobikuY3NzKCJjc3NUZXh0IixtdCsiOiIrX3QrZ3QrIjsiK3B0KyI6MCIrZ3QrIjsiKSxhfSxfY2FsY3VsYXRlU2l6ZTpmdW5jdGlvbih0KXt2YXIgZSxpLG4scj10LnByZWNlZGFuY2U9PT1PLHM9dGhpcy5vcHRpb25zLndpZHRoLG89dGhpcy5vcHRpb25zLmhlaWdodCxhPSJjIj09PXQuYWJicmV2KCksbD0ocj9zOm8pKihhPy41OjEpLGM9TWF0aC5wb3csdT1NYXRoLnJvdW5kLGQ9TWF0aC5zcXJ0KGMobCwyKStjKG8sMikpLGg9W3RoaXMuYm9yZGVyL2wqZCx0aGlzLmJvcmRlci9vKmRdO3JldHVybiBoWzJdPU1hdGguc3FydChjKGhbMF0sMiktYyh0aGlzLmJvcmRlciwyKSksaFszXT1NYXRoLnNxcnQoYyhoWzFdLDIpLWModGhpcy5ib3JkZXIsMikpLGU9ZCtoWzJdK2hbM10rKGE/MDpoWzBdKSxpPWUvZCxuPVt1KGkqcyksdShpKm8pXSxyP246bi5yZXZlcnNlKCl9LF9jYWxjdWxhdGVUaXA6ZnVuY3Rpb24odCxlLGkpe2k9aXx8MSxlPWV8fHRoaXMuc2l6ZTt2YXIgbj1lWzBdKmkscj1lWzFdKmkscz1NYXRoLmNlaWwobi8yKSxvPU1hdGguY2VpbChyLzIpLGE9e2JyOlswLDAsbixyLG4sMF0sYmw6WzAsMCxuLDAsMCxyXSx0cjpbMCxyLG4sMCxuLHJdLHRsOlswLDAsMCxyLG4scl0sdGM6WzAscixzLDAsbixyXSxiYzpbMCwwLG4sMCxzLHJdLHJjOlswLDAsbixvLDAscl0sbGM6W24sMCxuLHIsMCxvXX07cmV0dXJuIGEubHQ9YS5icixhLnJ0PWEuYmwsYS5sYj1hLnRyLGEucmI9YS50bCxhW3QuYWJicmV2KCldfSxfZHJhd0Nvb3JkczpmdW5jdGlvbih0LGUpe3QuYmVnaW5QYXRoKCksdC5tb3ZlVG8oZVswXSxlWzFdKSx0LmxpbmVUbyhlWzJdLGVbM10pLHQubGluZVRvKGVbNF0sZVs1XSksdC5jbG9zZVBhdGgoKX0sY3JlYXRlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5jb3JuZXI9KHZ0fHxudC5pZSkmJnRoaXMuX3BhcnNlQ29ybmVyKHRoaXMub3B0aW9ucy5jb3JuZXIpO3JldHVybiB0aGlzLmVuYWJsZWQ9ISF0aGlzLmNvcm5lciYmImMiIT09dGhpcy5jb3JuZXIuYWJicmV2KCksdGhpcy5lbmFibGVkJiYodGhpcy5xdGlwLmNhY2hlLmNvcm5lcj10LmNsb25lKCksdGhpcy51cGRhdGUoKSksdGhpcy5lbGVtZW50LnRvZ2dsZSh0aGlzLmVuYWJsZWQpLHRoaXMuY29ybmVyfSx1cGRhdGU6ZnVuY3Rpb24oZSxpKXtpZighdGhpcy5lbmFibGVkKXJldHVybiB0aGlzO3ZhciBuLHIscyxhLGwsYyx1LGQsaD10aGlzLnF0aXAuZWxlbWVudHMscD10aGlzLmVsZW1lbnQsZj1wLmNoaWxkcmVuKCksbT10aGlzLm9wdGlvbnMsXz10aGlzLnNpemUsZz1tLm1pbWljLHY9TWF0aC5yb3VuZDtlfHwoZT10aGlzLnF0aXAuY2FjaGUuY29ybmVyfHx0aGlzLmNvcm5lciksZz09PVk/Zz1lOihnPW5ldyBMKGcpLGcucHJlY2VkYW5jZT1lLnByZWNlZGFuY2UsImluaGVyaXQiPT09Zy54P2cueD1lLng6ImluaGVyaXQiPT09Zy55P2cueT1lLnk6Zy54PT09Zy55JiYoZ1tlLnByZWNlZGFuY2VdPWVbZS5wcmVjZWRhbmNlXSkpLHI9Zy5wcmVjZWRhbmNlLGUucHJlY2VkYW5jZT09PUE/dGhpcy5fc3dhcERpbWVuc2lvbnMoKTp0aGlzLl9yZXNldERpbWVuc2lvbnMoKSxuPXRoaXMuY29sb3I9dGhpcy5fcGFyc2VDb2xvdXJzKGUpLG5bMV0hPT1fdD8oZD10aGlzLmJvcmRlcj10aGlzLl9wYXJzZVdpZHRoKGUsZVtlLnByZWNlZGFuY2VdKSxtLmJvcmRlciYmZDwxJiYheXQudGVzdChuWzFdKSYmKG5bMF09blsxXSksdGhpcy5ib3JkZXI9ZD1tLmJvcmRlciE9PUQ/bS5ib3JkZXI6ZCk6dGhpcy5ib3JkZXI9ZD0wLHU9dGhpcy5zaXplPXRoaXMuX2NhbGN1bGF0ZVNpemUoZSkscC5jc3Moe3dpZHRoOnVbMF0saGVpZ2h0OnVbMV0sbGluZUhlaWdodDp1WzFdKyJweCJ9KSxjPWUucHJlY2VkYW5jZT09PU8/W3YoZy54PT09Uj9kOmcueD09PWo/dVswXS1fWzBdLWQ6KHVbMF0tX1swXSkvMiksdihnLnk9PT1QP3VbMV0tX1sxXTowKV06W3YoZy54PT09Uj91WzBdLV9bMF06MCksdihnLnk9PT1QP2Q6Zy55PT09SD91WzFdLV9bMV0tZDoodVsxXS1fWzFdKS8yKV0sdnQ/KHM9ZlswXS5nZXRDb250ZXh0KCIyZCIpLHMucmVzdG9yZSgpLHMuc2F2ZSgpLHMuY2xlYXJSZWN0KDAsMCw2ZTMsNmUzKSxhPXRoaXMuX2NhbGN1bGF0ZVRpcChnLF8sY3QpLGw9dGhpcy5fY2FsY3VsYXRlVGlwKGcsdGhpcy5zaXplLGN0KSxmLmF0dHIoTix1WzBdKmN0KS5hdHRyKEksdVsxXSpjdCksZi5jc3MoTix1WzBdKS5jc3MoSSx1WzFdKSx0aGlzLl9kcmF3Q29vcmRzKHMsbCkscy5maWxsU3R5bGU9blsxXSxzLmZpbGwoKSxzLnRyYW5zbGF0ZShjWzBdKmN0LGNbMV0qY3QpLHRoaXMuX2RyYXdDb29yZHMocyxhKSxzLmZpbGxTdHlsZT1uWzBdLHMuZmlsbCgpKTooYT10aGlzLl9jYWxjdWxhdGVUaXAoZyksYT0ibSIrYVswXSsiLCIrYVsxXSsiIGwiK2FbMl0rIiwiK2FbM10rIiAiK2FbNF0rIiwiK2FbNV0rIiB4ZSIsY1syXT1kJiYvXihyfGIpL2kudGVzdChlLnN0cmluZygpKT84PT09bnQuaWU/MjoxOjAsZi5jc3Moe2Nvb3Jkc2l6ZTp1WzBdK2QrIiAiK3VbMV0rZCxhbnRpYWxpYXM6IiIrKGcuc3RyaW5nKCkuaW5kZXhPZihGKT4tMSksbGVmdDpjWzBdLWNbMl0qTnVtYmVyKHI9PT1BKSx0b3A6Y1sxXS1jWzJdKk51bWJlcihyPT09Tyksd2lkdGg6dVswXStkLGhlaWdodDp1WzFdK2R9KS5lYWNoKGZ1bmN0aW9uKGUpe3ZhciBpPXQodGhpcyk7aVtpLnByb3A/InByb3AiOiJhdHRyIl0oe2Nvb3Jkc2l6ZTp1WzBdK2QrIiAiK3VbMV0rZCxwYXRoOmEsZmlsbGNvbG9yOm5bMF0sZmlsbGVkOiEhZSxzdHJva2VkOiFlfSkudG9nZ2xlKCEoIWQmJiFlKSksIWUmJmkuaHRtbChsdCgic3Ryb2tlIiwnd2VpZ2h0PSInKzIqZCsncHgiIGNvbG9yPSInK25bMV0rJyIgbWl0ZXJsaW1pdD0iMTAwMCIgam9pbnN0eWxlPSJtaXRlciInKSl9KSksby5vcGVyYSYmc2V0VGltZW91dChmdW5jdGlvbigpe2gudGlwLmNzcyh7ZGlzcGxheToiaW5saW5lLWJsb2NrIix2aXNpYmlsaXR5OiJ2aXNpYmxlIn0pfSwxKSxpIT09WSYmdGhpcy5jYWxjdWxhdGUoZSx1KX0sY2FsY3VsYXRlOmZ1bmN0aW9uKGUsaSl7aWYoIXRoaXMuZW5hYmxlZClyZXR1cm4gWTt2YXIgbixyLHM9dGhpcyxvPXRoaXMucXRpcC5lbGVtZW50cyxhPXRoaXMuZWxlbWVudCxsPXRoaXMub3B0aW9ucy5vZmZzZXQsYz17fTsKCXJldHVybiBlPWV8fHRoaXMuY29ybmVyLG49ZS5wcmVjZWRhbmNlLGk9aXx8dGhpcy5fY2FsY3VsYXRlU2l6ZShlKSxyPVtlLngsZS55XSxuPT09QSYmci5yZXZlcnNlKCksdC5lYWNoKHIsZnVuY3Rpb24odCxyKXt2YXIgYSx1LGQ7cj09PUY/KGE9bj09PU8/UjpQLGNbYV09IjUwJSIsY1todCsiLSIrYV09LU1hdGgucm91bmQoaVtuPT09Tz8wOjFdLzIpK2wpOihhPXMuX3BhcnNlV2lkdGgoZSxyLG8udG9vbHRpcCksdT1zLl9wYXJzZVdpZHRoKGUscixvLmNvbnRlbnQpLGQ9cy5fcGFyc2VSYWRpdXMoZSksY1tyXT1NYXRoLm1heCgtcy5ib3JkZXIsdD91OmwrKGQ+YT9kOi1hKSkpfSksY1tlW25dXS09aVtuPT09QT8wOjFdLGEuY3NzKHttYXJnaW46IiIsdG9wOiIiLGJvdHRvbToiIixsZWZ0OiIiLHJpZ2h0OiIifSkuY3NzKGMpLGN9LHJlcG9zaXRpb246ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCxlLGksbixyKXt0PT09VyYmYy5wcmVjZWRhbmNlPT09ZSYmdVtuXSYmY1tpXSE9PUY/Yy5wcmVjZWRhbmNlPWMucHJlY2VkYW5jZT09PUE/TzpBOnQhPT1XJiZ1W25dJiYoY1tlXT1jW2VdPT09Rj91W25dPjA/bjpyOmNbZV09PT1uP3I6bil9ZnVuY3Rpb24gcih0LGUsbil7Y1t0XT09PUY/bVtodCsiLSIrZV09Zlt0XT1zW2h0KyItIitlXS11W2VdOihvPXNbbl0hPT1sP1t1W2VdLC1zW2VdXTpbLXVbZV0sc1tlXV0sKGZbdF09TWF0aC5tYXgob1swXSxvWzFdKSk+b1swXSYmKGlbZV0tPXVbZV0sZltlXT1ZKSxtW3Nbbl0hPT1sP246ZV09Zlt0XSl9aWYodGhpcy5lbmFibGVkKXt2YXIgcyxvLGE9ZS5jYWNoZSxjPXRoaXMuY29ybmVyLmNsb25lKCksdT1pLmFkanVzdGVkLGQ9ZS5vcHRpb25zLnBvc2l0aW9uLmFkanVzdC5tZXRob2Quc3BsaXQoIiAiKSxoPWRbMF0scD1kWzFdfHxkWzBdLGY9e2xlZnQ6WSx0b3A6WSx4OjAseTowfSxtPXt9O3RoaXMuY29ybmVyLmZpeGVkIT09RCYmKG4oaCxBLE8sUixqKSxuKHAsTyxBLFAsSCksYy5zdHJpbmcoKT09PWEuY29ybmVyLnN0cmluZygpJiZhLmNvcm5lclRvcD09PXUudG9wJiZhLmNvcm5lckxlZnQ9PT11LmxlZnR8fHRoaXMudXBkYXRlKGMsWSkpLHM9dGhpcy5jYWxjdWxhdGUoYykscy5yaWdodCE9PWwmJihzLmxlZnQ9LXMucmlnaHQpLHMuYm90dG9tIT09bCYmKHMudG9wPS1zLmJvdHRvbSkscy51c2VyPXRoaXMub2Zmc2V0LGYubGVmdD1oPT09VyYmISF1LmxlZnQsZi5sZWZ0JiZyKEEsUixqKSxmLnRvcD1wPT09VyYmISF1LnRvcCxmLnRvcCYmcihPLFAsSCksdGhpcy5lbGVtZW50LmNzcyhtKS50b2dnbGUoIShmLngmJmYueXx8Yy54PT09RiYmZi55fHxjLnk9PT1GJiZmLngpKSxpLmxlZnQtPXMubGVmdC5jaGFyQXQ/cy51c2VyOmghPT1XfHxmLnRvcHx8IWYubGVmdCYmIWYudG9wP3MubGVmdCt0aGlzLmJvcmRlcjowLGkudG9wLT1zLnRvcC5jaGFyQXQ/cy51c2VyOnAhPT1XfHxmLmxlZnR8fCFmLmxlZnQmJiFmLnRvcD9zLnRvcCt0aGlzLmJvcmRlcjowLGEuY29ybmVyTGVmdD11LmxlZnQsYS5jb3JuZXJUb3A9dS50b3AsYS5jb3JuZXI9Yy5jbG9uZSgpfX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMucXRpcC5fdW5iaW5kKHRoaXMucXRpcC50b29sdGlwLHRoaXMuX25zKSx0aGlzLnF0aXAuZWxlbWVudHMudGlwJiZ0aGlzLnF0aXAuZWxlbWVudHMudGlwLmZpbmQoIioiKS5yZW1vdmUoKS5lbmQoKS5yZW1vdmUoKX19KSxhdD1CLnRpcD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IHcodCx0Lm9wdGlvbnMuc3R5bGUudGlwKX0sYXQuaW5pdGlhbGl6ZT0icmVuZGVyIixhdC5zYW5pdGl6ZT1mdW5jdGlvbih0KXtpZih0LnN0eWxlJiYidGlwImluIHQuc3R5bGUpe3ZhciBlPXQuc3R5bGUudGlwOyJvYmplY3QiIT10eXBlb2YgZSYmKGU9dC5zdHlsZS50aXA9e2Nvcm5lcjplfSksL3N0cmluZ3xib29sZWFuL2kudGVzdCh0eXBlb2YgZS5jb3JuZXIpfHwoZS5jb3JuZXI9RCl9fSx4LnRpcD17Il5wb3NpdGlvbi5teXxzdHlsZS50aXAuKGNvcm5lcnxtaW1pY3xib3JkZXIpJCI6ZnVuY3Rpb24oKXt0aGlzLmNyZWF0ZSgpLHRoaXMucXRpcC5yZXBvc2l0aW9uKCl9LCJec3R5bGUudGlwLihoZWlnaHR8d2lkdGgpJCI6ZnVuY3Rpb24odCl7dGhpcy5zaXplPVt0LndpZHRoLHQuaGVpZ2h0XSx0aGlzLnVwZGF0ZSgpLHRoaXMucXRpcC5yZXBvc2l0aW9uKCl9LCJeY29udGVudC50aXRsZXxzdHlsZS4oY2xhc3Nlc3x3aWRnZXQpJCI6ZnVuY3Rpb24oKXt0aGlzLnVwZGF0ZSgpfX0sdC5leHRlbmQoRCxULmRlZmF1bHRzLHtzdHlsZTp7dGlwOntjb3JuZXI6RCxtaW1pYzpZLHdpZHRoOjYsaGVpZ2h0OjYsYm9yZGVyOkQsb2Zmc2V0OjB9fX0pO3ZhciBNdCxrdCxUdD0icXRpcC1tb2RhbCIsU3Q9Ii4iK1R0O2t0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXtpZih0LmV4cHJbIjoiXS5mb2N1c2FibGUpcmV0dXJuIHQuZXhwclsiOiJdLmZvY3VzYWJsZTt2YXIgaSxuLHIscz0haXNOYU4odC5hdHRyKGUsInRhYmluZGV4IikpLG89ZS5ub2RlTmFtZSYmZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVybiJhcmVhIj09PW8/KGk9ZS5wYXJlbnROb2RlLG49aS5uYW1lLCEoIWUuaHJlZnx8IW58fCJtYXAiIT09aS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKSYmKHI9dCgiaW1nW3VzZW1hcD0jIituKyJdIilbMF0sISFyJiZyLmlzKCI6dmlzaWJsZSIpKSk6L2lucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b258b2JqZWN0Ly50ZXN0KG8pPyFlLmRpc2FibGVkOiJhIj09PW8/ZS5ocmVmfHxzOnN9ZnVuY3Rpb24gaSh0KXtjLmxlbmd0aDwxJiZ0Lmxlbmd0aD90Lm5vdCgiYm9keSIpLmJsdXIoKTpjLmZpcnN0KCkuZm9jdXMoKX1mdW5jdGlvbiBuKGUpe2lmKG8uaXMoIjp2aXNpYmxlIikpe3ZhciBuLHM9dChlLnRhcmdldCksYT1yLnRvb2x0aXAsbD1zLmNsb3Nlc3QoRyk7bj1sLmxlbmd0aDwxP1k6cGFyc2VJbnQobFswXS5zdHlsZS56SW5kZXgsMTApPnBhcnNlSW50KGFbMF0uc3R5bGUuekluZGV4LDEwKSxufHxzLmNsb3Nlc3QoRylbMF09PT1hWzBdfHxpKHMpfX12YXIgcixzLG8sbD10aGlzLGM9e307dC5leHRlbmQobCx7aW5pdDpmdW5jdGlvbigpe3JldHVybiBvPWwuZWxlbT10KCI8ZGl2IC8+Iix7aWQ6InF0aXAtb3ZlcmxheSIsaHRtbDoiPGRpdj48L2Rpdj4iLG1vdXNlZG93bjpmdW5jdGlvbigpe3JldHVybiBZfX0pLmhpZGUoKSx0KGEuYm9keSkuYmluZCgiZm9jdXNpbiIrU3QsbiksdChhKS5iaW5kKCJrZXlkb3duIitTdCxmdW5jdGlvbih0KXtyJiZyLm9wdGlvbnMuc2hvdy5tb2RhbC5lc2NhcGUmJjI3PT09dC5rZXlDb2RlJiZyLmhpZGUodCl9KSxvLmJpbmQoImNsaWNrIitTdCxmdW5jdGlvbih0KXtyJiZyLm9wdGlvbnMuc2hvdy5tb2RhbC5ibHVyJiZyLmhpZGUodCl9KSxsfSx1cGRhdGU6ZnVuY3Rpb24odCl7cj10LGM9dC5vcHRpb25zLnNob3cubW9kYWwuc3RlYWxmb2N1cyE9PVk/dC50b29sdGlwLmZpbmQoIioiKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4gZSh0aGlzKX0pOltdfSx0b2dnbGU6ZnVuY3Rpb24oZSxuLGMpe3ZhciB1PWUudG9vbHRpcCxkPWUub3B0aW9ucy5zaG93Lm1vZGFsLGg9ZC5lZmZlY3QscD1uPyJzaG93IjoiaGlkZSIsZj1vLmlzKCI6dmlzaWJsZSIpLG09dChTdCkuZmlsdGVyKCI6dmlzaWJsZTpub3QoOmFuaW1hdGVkKSIpLm5vdCh1KTtyZXR1cm4gbC51cGRhdGUoZSksbiYmZC5zdGVhbGZvY3VzIT09WSYmaSh0KCI6Zm9jdXMiKSksby50b2dnbGVDbGFzcygiYmx1cnMiLGQuYmx1ciksbiYmby5hcHBlbmRUbyhhLmJvZHkpLG8uaXMoIjphbmltYXRlZCIpJiZmPT09biYmcyE9PVl8fCFuJiZtLmxlbmd0aD9sOihvLnN0b3AoRCxZKSx0LmlzRnVuY3Rpb24oaCk/aC5jYWxsKG8sbik6aD09PVk/b1twXSgpOm8uZmFkZVRvKHBhcnNlSW50KGMsMTApfHw5MCxuPzE6MCxmdW5jdGlvbigpe258fG8uaGlkZSgpfSksbnx8by5xdWV1ZShmdW5jdGlvbihlKXtvLmNzcyh7bGVmdDoiIix0b3A6IiJ9KSx0KFN0KS5sZW5ndGh8fG8uZGV0YWNoKCksZSgpfSkscz1uLHIuZGVzdHJveWVkJiYocj1DKSxsKX19KSxsLmluaXQoKX0sa3Q9bmV3IGt0LHQuZXh0ZW5kKE0ucHJvdG90eXBlLHtpbml0OmZ1bmN0aW9uKGUpe3ZhciBpPWUudG9vbHRpcDtyZXR1cm4gdGhpcy5vcHRpb25zLm9uPyhlLmVsZW1lbnRzLm92ZXJsYXk9a3QuZWxlbSxpLmFkZENsYXNzKFR0KS5jc3MoInotaW5kZXgiLFQubW9kYWxfemluZGV4K3QoU3QpLmxlbmd0aCksZS5fYmluZChpLFsidG9vbHRpcHNob3ciLCJ0b29sdGlwaGlkZSJdLGZ1bmN0aW9uKGUsbixyKXt2YXIgcz1lLm9yaWdpbmFsRXZlbnQ7aWYoZS50YXJnZXQ9PT1pWzBdKWlmKHMmJiJ0b29sdGlwaGlkZSI9PT1lLnR5cGUmJi9tb3VzZShsZWF2ZXxlbnRlcikvLnRlc3Qocy50eXBlKSYmdChzLnJlbGF0ZWRUYXJnZXQpLmNsb3Nlc3Qoa3QuZWxlbVswXSkubGVuZ3RoKXRyeXtlLnByZXZlbnREZWZhdWx0KCl9Y2F0Y2gobyl7fWVsc2UoIXN8fHMmJiJ0b29sdGlwc29sbyIhPT1zLnR5cGUpJiZ0aGlzLnRvZ2dsZShlLCJ0b29sdGlwc2hvdyI9PT1lLnR5cGUscil9LHRoaXMuX25zLHRoaXMpLGUuX2JpbmQoaSwidG9vbHRpcGZvY3VzIixmdW5jdGlvbihlLG4pe2lmKCFlLmlzRGVmYXVsdFByZXZlbnRlZCgpJiZlLnRhcmdldD09PWlbMF0pe3ZhciByPXQoU3QpLHM9VC5tb2RhbF96aW5kZXgrci5sZW5ndGgsbz1wYXJzZUludChpWzBdLnN0eWxlLnpJbmRleCwxMCk7a3QuZWxlbVswXS5zdHlsZS56SW5kZXg9cy0xLHIuZWFjaChmdW5jdGlvbigpe3RoaXMuc3R5bGUuekluZGV4Pm8mJih0aGlzLnN0eWxlLnpJbmRleC09MSl9KSxyLmZpbHRlcigiLiIrWCkucXRpcCgiYmx1ciIsZS5vcmlnaW5hbEV2ZW50KSxpLmFkZENsYXNzKFgpWzBdLnN0eWxlLnpJbmRleD1zLGt0LnVwZGF0ZShuKTt0cnl7ZS5wcmV2ZW50RGVmYXVsdCgpfWNhdGNoKGEpe319fSx0aGlzLl9ucyx0aGlzKSx2b2lkIGUuX2JpbmQoaSwidG9vbHRpcGhpZGUiLGZ1bmN0aW9uKGUpe2UudGFyZ2V0PT09aVswXSYmdChTdCkuZmlsdGVyKCI6dmlzaWJsZSIpLm5vdChpKS5sYXN0KCkucXRpcCgiZm9jdXMiLGUpfSx0aGlzLl9ucyx0aGlzKSk6dGhpc30sdG9nZ2xlOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdCYmdC5pc0RlZmF1bHRQcmV2ZW50ZWQoKT90aGlzOnZvaWQga3QudG9nZ2xlKHRoaXMucXRpcCwhIWUsaSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLnF0aXAudG9vbHRpcC5yZW1vdmVDbGFzcyhUdCksdGhpcy5xdGlwLl91bmJpbmQodGhpcy5xdGlwLnRvb2x0aXAsdGhpcy5fbnMpLGt0LnRvZ2dsZSh0aGlzLnF0aXAsWSksZGVsZXRlIHRoaXMucXRpcC5lbGVtZW50cy5vdmVybGF5fX0pLE10PUIubW9kYWw9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBNKHQsdC5vcHRpb25zLnNob3cubW9kYWwpfSxNdC5zYW5pdGl6ZT1mdW5jdGlvbih0KXt0LnNob3cmJigib2JqZWN0IiE9dHlwZW9mIHQuc2hvdy5tb2RhbD90LnNob3cubW9kYWw9e29uOiEhdC5zaG93Lm1vZGFsfToidW5kZWZpbmVkIj09dHlwZW9mIHQuc2hvdy5tb2RhbC5vbiYmKHQuc2hvdy5tb2RhbC5vbj1EKSl9LFQubW9kYWxfemluZGV4PVQuemluZGV4LTIwMCxNdC5pbml0aWFsaXplPSJyZW5kZXIiLHgubW9kYWw9eyJec2hvdy5tb2RhbC4ob258Ymx1cikkIjpmdW5jdGlvbigpe3RoaXMuZGVzdHJveSgpLHRoaXMuaW5pdCgpLHRoaXMucXRpcC5lbGVtcy5vdmVybGF5LnRvZ2dsZSh0aGlzLnF0aXAudG9vbHRpcFswXS5vZmZzZXRXaWR0aD4wKX19LHQuZXh0ZW5kKEQsVC5kZWZhdWx0cyx7c2hvdzp7bW9kYWw6e29uOlksZWZmZWN0OkQsYmx1cjpELHN0ZWFsZm9jdXM6RCxlc2NhcGU6RH19fSksQi52aWV3cG9ydD1mdW5jdGlvbih0LGUsaSxuLHIscyxsKXtmdW5jdGlvbiBjKHQsaSxuLHIscyxvLGEsbCxjKXt2YXIgdT1lW3NdLHY9Ylt0XSx5PXdbdF0sTT1uPT09VyxrPXY9PT1zP2M6dj09PW8/LWM6LWMvMixUPXk9PT1zP2w6eT09PW8/LWw6LWwvMixTPV9bc10rZ1tzXS0ocD8wOmhbc10pLEw9Uy11LHg9dStjLShhPT09Tj9mOm0pLVMsRT1rLShiLnByZWNlZGFuY2U9PT10fHx2PT09YltpXT9UOjApLSh5PT09Rj9sLzI6MCk7cmV0dXJuIE0/KEU9KHY9PT1zPzE6LTEpKmssZVtzXSs9TD4wP0w6eD4wPy14OjAsZVtzXT1NYXRoLm1heCgtaFtzXStnW3NdLHUtRSxNYXRoLm1pbihNYXRoLm1heCgtaFtzXStnW3NdKyhhPT09Tj9mOm0pLHUrRSksZVtzXSwiY2VudGVyIj09PXY/dS1rOjFlOSkpKToocio9bj09PVU/MjowLEw+MCYmKHYhPT1zfHx4PjApPyhlW3NdLT1FK3IsZC5pbnZlcnQodCxzKSk6eD4wJiYodiE9PW98fEw+MCkmJihlW3NdLT0odj09PUY/LUU6RSkrcixkLmludmVydCh0LG8pKSxlW3NdPF9bc10mJi1lW3NdPngmJihlW3NdPXUsZD1iLmNsb25lKCkpKSxlW3NdLXV9dmFyIHUsZCxoLHAsZixtLF8sZyx2PWkudGFyZ2V0LHk9dC5lbGVtZW50cy50b29sdGlwLGI9aS5teSx3PWkuYXQsTT1pLmFkanVzdCxrPU0ubWV0aG9kLnNwbGl0KCIgIiksVD1rWzBdLFM9a1sxXXx8a1swXSxMPWkudmlld3BvcnQseD1pLmNvbnRhaW5lcixFPXtsZWZ0OjAsdG9wOjB9O3JldHVybiBMLmpxdWVyeSYmdlswXSE9PW8mJnZbMF0hPT1hLmJvZHkmJiJub25lIiE9PU0ubWV0aG9kPyhoPXgub2Zmc2V0KCl8fEUscD0ic3RhdGljIj09PXguY3NzKCJwb3NpdGlvbiIpLHU9ImZpeGVkIj09PXkuY3NzKCJwb3NpdGlvbiIpLGY9TFswXT09PW8/TC53aWR0aCgpOkwub3V0ZXJXaWR0aChZKSxtPUxbMF09PT1vP0wuaGVpZ2h0KCk6TC5vdXRlckhlaWdodChZKSxfPXtsZWZ0OnU/MDpMLnNjcm9sbExlZnQoKSx0b3A6dT8wOkwuc2Nyb2xsVG9wKCl9LGc9TC5vZmZzZXQoKXx8RSwic2hpZnQiPT09VCYmInNoaWZ0Ij09PVN8fChkPWIuY2xvbmUoKSksRT17bGVmdDoibm9uZSIhPT1UP2MoQSxPLFQsTS54LFIsaixOLG4scyk6MCx0b3A6Im5vbmUiIT09Uz9jKE8sQSxTLE0ueSxQLEgsSSxyLGwpOjAsbXk6ZH0pOkV9LEIucG9seXM9e3BvbHlnb246ZnVuY3Rpb24odCxlKXt2YXIgaSxuLHIscz17d2lkdGg6MCxoZWlnaHQ6MCxwb3NpdGlvbjp7dG9wOjFlMTAscmlnaHQ6MCxib3R0b206MCxsZWZ0OjFlMTB9LGFkanVzdGFibGU6WX0sbz0wLGE9W10sbD0xLGM9MSx1PTAsZD0wO2ZvcihvPXQubGVuZ3RoO28tLTspaT1bcGFyc2VJbnQodFstLW9dLDEwKSxwYXJzZUludCh0W28rMV0sMTApXSxpWzBdPnMucG9zaXRpb24ucmlnaHQmJihzLnBvc2l0aW9uLnJpZ2h0PWlbMF0pLGlbMF08cy5wb3NpdGlvbi5sZWZ0JiYocy5wb3NpdGlvbi5sZWZ0PWlbMF0pLGlbMV0+cy5wb3NpdGlvbi5ib3R0b20mJihzLnBvc2l0aW9uLmJvdHRvbT1pWzFdKSxpWzFdPHMucG9zaXRpb24udG9wJiYocy5wb3NpdGlvbi50b3A9aVsxXSksYS5wdXNoKGkpO2lmKG49cy53aWR0aD1NYXRoLmFicyhzLnBvc2l0aW9uLnJpZ2h0LXMucG9zaXRpb24ubGVmdCkscj1zLmhlaWdodD1NYXRoLmFicyhzLnBvc2l0aW9uLmJvdHRvbS1zLnBvc2l0aW9uLnRvcCksImMiPT09ZS5hYmJyZXYoKSlzLnBvc2l0aW9uPXtsZWZ0OnMucG9zaXRpb24ubGVmdCtzLndpZHRoLzIsdG9wOnMucG9zaXRpb24udG9wK3MuaGVpZ2h0LzJ9O2Vsc2V7Zm9yKDtuPjAmJnI+MCYmbD4wJiZjPjA7KWZvcihuPU1hdGguZmxvb3Iobi8yKSxyPU1hdGguZmxvbw==", "base64"));
  res.write(new Buffer("cihyLzIpLGUueD09PVI/bD1uOmUueD09PWo/bD1zLndpZHRoLW46bCs9TWF0aC5mbG9vcihuLzIpLGUueT09PVA/Yz1yOmUueT09PUg/Yz1zLmhlaWdodC1yOmMrPU1hdGguZmxvb3Ioci8yKSxvPWEubGVuZ3RoO28tLSYmIShhLmxlbmd0aDwyKTspdT1hW29dWzBdLXMucG9zaXRpb24ubGVmdCxkPWFbb11bMV0tcy5wb3NpdGlvbi50b3AsKGUueD09PVImJnU+PWx8fGUueD09PWomJnU8PWx8fGUueD09PUYmJih1PGx8fHU+cy53aWR0aC1sKXx8ZS55PT09UCYmZD49Y3x8ZS55PT09SCYmZDw9Y3x8ZS55PT09RiYmKGQ8Y3x8ZD5zLmhlaWdodC1jKSkmJmEuc3BsaWNlKG8sMSk7cy5wb3NpdGlvbj17bGVmdDphWzBdWzBdLHRvcDphWzBdWzFdfX1yZXR1cm4gc30scmVjdDpmdW5jdGlvbih0LGUsaSxuKXtyZXR1cm57d2lkdGg6TWF0aC5hYnMoaS10KSxoZWlnaHQ6TWF0aC5hYnMobi1lKSxwb3NpdGlvbjp7bGVmdDpNYXRoLm1pbih0LGkpLHRvcDpNYXRoLm1pbihlLG4pfX19LF9hbmdsZXM6e3RjOjEuNSx0cjo3LzQsdGw6NS80LGJjOi41LGJyOi4yNSxibDouNzUscmM6MixsYzoxLGM6MH0sZWxsaXBzZTpmdW5jdGlvbih0LGUsaSxuLHIpe3ZhciBzPUIucG9seXMuX2FuZ2xlc1tyLmFiYnJldigpXSxvPTA9PT1zPzA6aSpNYXRoLmNvcyhzKk1hdGguUEkpLGE9bipNYXRoLnNpbihzKk1hdGguUEkpO3JldHVybnt3aWR0aDoyKmktTWF0aC5hYnMobyksaGVpZ2h0OjIqbi1NYXRoLmFicyhhKSxwb3NpdGlvbjp7bGVmdDp0K28sdG9wOmUrYX0sYWRqdXN0YWJsZTpZfX0sY2lyY2xlOmZ1bmN0aW9uKHQsZSxpLG4pe3JldHVybiBCLnBvbHlzLmVsbGlwc2UodCxlLGksaSxuKX19LEIuc3ZnPWZ1bmN0aW9uKGUsaSxuKXtmb3IodmFyIHIscyxvLGwsYyx1LGQsaCxwLGY9aVswXSxtPXQoZi5vd25lclNWR0VsZW1lbnQpLF89Zi5vd25lckRvY3VtZW50LGc9KHBhcnNlSW50KGkuY3NzKCJzdHJva2Utd2lkdGgiKSwxMCl8fDApLzI7IWYuZ2V0QkJveDspZj1mLnBhcmVudE5vZGU7aWYoIWYuZ2V0QkJveHx8IWYucGFyZW50Tm9kZSlyZXR1cm4gWTtzd2l0Y2goZi5ub2RlTmFtZSl7Y2FzZSJlbGxpcHNlIjpjYXNlImNpcmNsZSI6aD1CLnBvbHlzLmVsbGlwc2UoZi5jeC5iYXNlVmFsLnZhbHVlLGYuY3kuYmFzZVZhbC52YWx1ZSwoZi5yeHx8Zi5yKS5iYXNlVmFsLnZhbHVlK2csKGYucnl8fGYucikuYmFzZVZhbC52YWx1ZStnLG4pO2JyZWFrO2Nhc2UibGluZSI6Y2FzZSJwb2x5Z29uIjpjYXNlInBvbHlsaW5lIjpmb3IoZD1mLnBvaW50c3x8W3t4OmYueDEuYmFzZVZhbC52YWx1ZSx5OmYueTEuYmFzZVZhbC52YWx1ZX0se3g6Zi54Mi5iYXNlVmFsLnZhbHVlLHk6Zi55Mi5iYXNlVmFsLnZhbHVlfV0saD1bXSx1PS0xLGw9ZC5udW1iZXJPZkl0ZW1zfHxkLmxlbmd0aDsrK3U8bDspYz1kLmdldEl0ZW0/ZC5nZXRJdGVtKHUpOmRbdV0saC5wdXNoLmFwcGx5KGgsW2MueCxjLnldKTtoPUIucG9seXMucG9seWdvbihoLG4pO2JyZWFrO2RlZmF1bHQ6aD1mLmdldEJCb3goKSxoPXt3aWR0aDpoLndpZHRoLGhlaWdodDpoLmhlaWdodCxwb3NpdGlvbjp7bGVmdDpoLngsdG9wOmgueX19fXJldHVybiBwPWgucG9zaXRpb24sbT1tWzBdLG0uY3JlYXRlU1ZHUG9pbnQmJihzPWYuZ2V0U2NyZWVuQ1RNKCksZD1tLmNyZWF0ZVNWR1BvaW50KCksZC54PXAubGVmdCxkLnk9cC50b3Asbz1kLm1hdHJpeFRyYW5zZm9ybShzKSxwLmxlZnQ9by54LHAudG9wPW8ueSksXyE9PWEmJiJtb3VzZSIhPT1lLnBvc2l0aW9uLnRhcmdldCYmKHI9dCgoXy5kZWZhdWx0Vmlld3x8Xy5wYXJlbnRXaW5kb3cpLmZyYW1lRWxlbWVudCkub2Zmc2V0KCksciYmKHAubGVmdCs9ci5sZWZ0LHAudG9wKz1yLnRvcCkpLF89dChfKSxwLmxlZnQrPV8uc2Nyb2xsTGVmdCgpLHAudG9wKz1fLnNjcm9sbFRvcCgpLGh9LEIuaW1hZ2VtYXA9ZnVuY3Rpb24oZSxpLG4pe2kuanF1ZXJ5fHwoaT10KGkpKTt2YXIgcixzLG8sYSxsLGM9KGkuYXR0cigic2hhcGUiKXx8InJlY3QiKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoInBvbHkiLCJwb2x5Z29uIiksdT10KCdpbWdbdXNlbWFwPSIjJytpLnBhcmVudCgibWFwIikuYXR0cigibmFtZSIpKyciXScpLGQ9dC50cmltKGkuYXR0cigiY29vcmRzIikpLGg9ZC5yZXBsYWNlKC8sJC8sIiIpLnNwbGl0KCIsIik7aWYoIXUubGVuZ3RoKXJldHVybiBZO2lmKCJwb2x5Z29uIj09PWMpYT1CLnBvbHlzLnBvbHlnb24oaCxuKTtlbHNle2lmKCFCLnBvbHlzW2NdKXJldHVybiBZO2ZvcihvPS0xLGw9aC5sZW5ndGgscz1bXTsrK288bDspcy5wdXNoKHBhcnNlSW50KGhbb10sMTApKTthPUIucG9seXNbY10uYXBwbHkodGhpcyxzLmNvbmNhdChuKSl9cmV0dXJuIHI9dS5vZmZzZXQoKSxyLmxlZnQrPU1hdGguY2VpbCgodS5vdXRlcldpZHRoKFkpLXUud2lkdGgoKSkvMiksci50b3ArPU1hdGguY2VpbCgodS5vdXRlckhlaWdodChZKS11LmhlaWdodCgpKS8yKSxhLnBvc2l0aW9uLmxlZnQrPXIubGVmdCxhLnBvc2l0aW9uLnRvcCs9ci50b3AsYX07dmFyIEx0LHh0PSc8aWZyYW1lIGNsYXNzPSJxdGlwLWJnaWZyYW1lIiBmcmFtZWJvcmRlcj0iMCIgdGFiaW5kZXg9Ii0xIiBzcmM9ImphdmFzY3JpcHQ6XCdcJzsiICBzdHlsZT0iZGlzcGxheTpibG9jazsgcG9zaXRpb246YWJzb2x1dGU7IHotaW5kZXg6LTE7IGZpbHRlcjphbHBoYShvcGFjaXR5PTApOyAtbXMtZmlsdGVyOiJwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuQWxwaGEoT3BhY2l0eT0wKSI7Ij48L2lmcmFtZT4nO3QuZXh0ZW5kKGsucHJvdG90eXBlLHtfc2Nyb2xsOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5xdGlwLmVsZW1lbnRzLm92ZXJsYXk7ZSYmKGVbMF0uc3R5bGUudG9wPXQobykuc2Nyb2xsVG9wKCkrInB4Iil9LGluaXQ6ZnVuY3Rpb24oZSl7dmFyIGk9ZS50b29sdGlwO3QoInNlbGVjdCwgb2JqZWN0IikubGVuZ3RoPDEmJih0aGlzLmJnaWZyYW1lPWUuZWxlbWVudHMuYmdpZnJhbWU9dCh4dCkuYXBwZW5kVG8oaSksZS5fYmluZChpLCJ0b29sdGlwbW92ZSIsdGhpcy5hZGp1c3RCR0lGcmFtZSx0aGlzLl9ucyx0aGlzKSksdGhpcy5yZWRyYXdDb250YWluZXI9dCgiPGRpdi8+Iix7aWQ6eisiLXJjb250YWluZXIifSkuYXBwZW5kVG8oYS5ib2R5KSxlLmVsZW1lbnRzLm92ZXJsYXkmJmUuZWxlbWVudHMub3ZlcmxheS5hZGRDbGFzcygicXRpcG1vZGFsLWllNmZpeCIpJiYoZS5fYmluZChvLFsic2Nyb2xsIiwicmVzaXplIl0sdGhpcy5fc2Nyb2xsLHRoaXMuX25zLHRoaXMpLGUuX2JpbmQoaSxbInRvb2x0aXBzaG93Il0sdGhpcy5fc2Nyb2xsLHRoaXMuX25zLHRoaXMpKSx0aGlzLnJlZHJhdygpfSxhZGp1c3RCR0lGcmFtZTpmdW5jdGlvbigpe3ZhciB0LGUsaT10aGlzLnF0aXAudG9vbHRpcCxuPXtoZWlnaHQ6aS5vdXRlckhlaWdodChZKSx3aWR0aDppLm91dGVyV2lkdGgoWSl9LHI9dGhpcy5xdGlwLnBsdWdpbnMudGlwLHM9dGhpcy5xdGlwLmVsZW1lbnRzLnRpcDtlPXBhcnNlSW50KGkuY3NzKCJib3JkZXJMZWZ0V2lkdGgiKSwxMCl8fDAsZT17bGVmdDotZSx0b3A6LWV9LHImJnMmJih0PSJ4Ij09PXIuY29ybmVyLnByZWNlZGFuY2U/W04sUl06W0ksUF0sZVt0WzFdXS09c1t0WzBdXSgpKSx0aGlzLmJnaWZyYW1lLmNzcyhlKS5jc3Mobil9LHJlZHJhdzpmdW5jdGlvbigpe2lmKHRoaXMucXRpcC5yZW5kZXJlZDwxfHx0aGlzLmRyYXdpbmcpcmV0dXJuIHRoaXM7dmFyIHQsZSxpLG4scj10aGlzLnF0aXAudG9vbHRpcCxzPXRoaXMucXRpcC5vcHRpb25zLnN0eWxlLG89dGhpcy5xdGlwLm9wdGlvbnMucG9zaXRpb24uY29udGFpbmVyO3JldHVybiB0aGlzLnF0aXAuZHJhd2luZz0xLHMuaGVpZ2h0JiZyLmNzcyhJLHMuaGVpZ2h0KSxzLndpZHRoP3IuY3NzKE4scy53aWR0aCk6KHIuY3NzKE4sIiIpLmFwcGVuZFRvKHRoaXMucmVkcmF3Q29udGFpbmVyKSxlPXIud2lkdGgoKSxlJTI8MSYmKGUrPTEpLGk9ci5jc3MoIm1heFdpZHRoIil8fCIiLG49ci5jc3MoIm1pbldpZHRoIil8fCIiLHQ9KGkrbikuaW5kZXhPZigiJSIpPi0xP28ud2lkdGgoKS8xMDA6MCxpPShpLmluZGV4T2YoIiUiKT4tMT90OjEqcGFyc2VJbnQoaSwxMCkpfHxlLG49KG4uaW5kZXhPZigiJSIpPi0xP3Q6MSpwYXJzZUludChuLDEwKSl8fDAsZT1pK24/TWF0aC5taW4oTWF0aC5tYXgoZSxuKSxpKTplLHIuY3NzKE4sTWF0aC5yb3VuZChlKSkuYXBwZW5kVG8obykpLHRoaXMuZHJhd2luZz0wLHRoaXN9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmJnaWZyYW1lJiZ0aGlzLmJnaWZyYW1lLnJlbW92ZSgpLHRoaXMucXRpcC5fdW5iaW5kKFtvLHRoaXMucXRpcC50b29sdGlwXSx0aGlzLl9ucyl9fSksTHQ9Qi5pZTY9ZnVuY3Rpb24odCl7cmV0dXJuIDY9PT1udC5pZT9uZXcgayh0KTpZfSxMdC5pbml0aWFsaXplPSJyZW5kZXIiLHguaWU2PXsiXmNvbnRlbnR8c3R5bGUkIjpmdW5jdGlvbigpe3RoaXMucmVkcmF3KCl9fX0pfSh3aW5kb3csZG9jdW1lbnQpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ2KSxpKDIzMyldLHI9ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4oZSxpKXtlLmFwcGx5KHRoaXMsdC5tYXAoaS5zcGxpdCgvXHMrLyksZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KHQpfSx0aGlzKSl9ZnVuY3Rpb24gcihlLGkpe3QuaXNGdW5jdGlvbihlKSYmZS5jYWxsKGkpfXJldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOmZ1bmN0aW9uKCl7dmFyIHQ9Im8tZm9ybS1maWVsZHNldCI7cmV0dXJuIHRoaXMub3B0aW9uc1sibGFiZWwtdG9wIl0mJih0Kz0iIG8tZm9ybS1sYWJlbC10b3AiKSx0aGlzLm9wdGlvbnMucmVhZE9ubHkmJih0Kz0iIG8tZm9ybS1yZWFkLW1vZGUiKSx0fSxhdHRyaWJ1dGVzOmZ1bmN0aW9uKCl7cmV0dXJueyJkYXRhLXNlIjp0aGlzLm9wdGlvbnNbImRhdGEtc2UiXXx8Im8tZm9ybS1maWVsZHNldCJ9fSxjb25zdHJ1Y3RvcjpmdW5jdGlvbihzKXtzLmNsYXNzTmFtZSYmKHRoaXMuaW5wdXRXcmFwcGVyQ2xhc3NOYW1lPXRoaXMuY2xhc3NOYW1lLHRoaXMub3B0aW9uc0NsYXNzTmFtZT1zLmNsYXNzTmFtZSxzLmNsYXNzTmFtZT1mdW5jdGlvbigpe3JldHVybiB0LnJlc3VsdCh0aGlzLCJpbnB1dFdyYXBwZXJDbGFzc05hbWUiLCIiKSsiICIrdC5yZXN1bHQodGhpcywib3B0aW9uc0NsYXNzTmFtZSIpfSksZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdC5lYWNoKHMuZXZlbnRzfHx7fSxmdW5jdGlvbih0LGUpe3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCxlLHQpfSx0aGlzKSx0LmVhY2gocy5iaW5kaW5nc3x8e30sZnVuY3Rpb24oZSxyKXt0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsaS5jaGFuZ2VFdmVudFN0cmluZyhyLnNwbGl0KC9ccysvKSksdC5iaW5kKG4sdGhpcyxlLHIpKX0sdGhpcyksaS5hcHBseVNob3dXaGVuKHRoaXMscy5zaG93V2hlbiksaS5hcHBseVRvZ2dsZVdoZW4odGhpcyxzLnRvZ2dsZVdoZW4pLHIocy5pbml0aWFsaXplLHRoaXMpfSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7dC5lYWNoKHRoaXMub3B0aW9ucy5iaW5kaW5nc3x8e30sbix0aGlzKSxyKHRoaXMub3B0aW9ucy5yZW5kZXIsdGhpcyl9LGdldExhYmVsOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2l6ZSgpPjE/dGhpcy5hdCgwKTpudWxsfSxnZXRJbnB1dDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldElucHV0Q29udGFpbmVyKCl9LGdldElucHV0Q29udGFpbmVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXQodGhpcy5zaXplKCk+MT8xOjApfSxnZXRJbnB1dHM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRJbnB1dENvbnRhaW5lcigpLnRvQXJyYXkoKX0sZm9jdXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRJbnB1dCgpLmZvY3VzKCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE3NyksaSgxNDYpLGkoMTczKSxpKDE0NCksaSgxNTUpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzKXtmdW5jdGlvbiBvKGUpe2lmKGUmJiFlLl9fZWRpdF9fKXJldHVybiB0LmV4dGVuZCh7X19lZGl0X186dC5jb25zdGFudCghMCl9LGUpfWZ1bmN0aW9uIGEoZSl7ZT10LnBpY2soZXx8e30sImFjdGlvbiIsImlkIiwiY2xhc3NOYW1lIiwidGV4dCIsInR5cGUiKTt2YXIgcixzLG87cmV0dXJuIGkuZXh0ZW5kKHt0YWdOYW1lOiJpbnB1dCIsY2xhc3NOYW1lOiJidXR0b24iLGV2ZW50czp7Y2xpY2s6ZnVuY3Rpb24oKXtlLmFjdGlvbiYmIXRoaXMuZGlzYWJsZWQoKSYmZS5hY3Rpb24uY2FsbCh0aGlzKX0sa2V5dXA6ZnVuY3Rpb24odCl7bi5pc0VudGVyKHQpJiZlLmFjdGlvbiYmIXRoaXMuZGlzYWJsZWQoKSYmZS5hY3Rpb24uY2FsbCh0aGlzKX19LGRpc2FibGVkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJGVsLnByb3AoImRpc2FibGVkIik9PT0hMH0sZGlzYWJsZTpmdW5jdGlvbigpe3RoaXMuJGVsLnByb3AoImRpc2FibGVkIiwhMCksdGhpcy4kZWwuYWRkQ2xhc3MoImJ0bi1kaXNhYmxlZCIpfSxlbmFibGU6ZnVuY3Rpb24oKXt0aGlzLiRlbC5wcm9wKCJkaXNhYmxlZCIsITEpLHRoaXMuJGVsLnJlbW92ZUNsYXNzKCJidG4tZGlzYWJsZWQiKX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciBpPXRoaXM7dGhpcy4kZWwuYXR0cigidHlwZSIsInNhdmUiPT1lLnR5cGU/InN1Ym1pdCI6ImJ1dHRvbiIpLHRoaXMuJGVsLnZhbChlLnRleHQpLGUuaWQmJnRoaXMuJGVsLmF0dHIoImlkIixlLmlkKSxlLmNsYXNzTmFtZSYmdGhpcy4kZWwuYWRkQ2xhc3MoZS5jbGFzc05hbWUpLGUudHlwZSYmdGhpcy4kZWwuYXR0cigiZGF0YS10eXBlIixlLnR5cGUpLHRoaXMuJGVsLm1vdXNlZG93bihmdW5jdGlvbigpe2kubW9kZWwuc2V0KCJfX3BlbmRpbmdfXyIsITApfSksdGhpcy4kZWwubW91c2V1cChmdW5jdGlvbigpe2kubW9kZWwuc2V0KCJfX3BlbmRpbmdfXyIsITEpfSksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJmb3JtOnNldC1zYXZpbmctc3RhdGUiLGZ1bmN0aW9uKCl7dGhpcy5kaXNhYmxlKCksInNhdmUiPT1lLnR5cGUmJihyPXNldFRpbWVvdXQodC5iaW5kKHRoaXMuX19jaGFuZ2VTYXZlVGV4dCx0aGlzKSwxZTMpKX0pLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZm9ybTpjbGVhci1zYXZpbmctc3RhdGUiLGZ1bmN0aW9uKCl7dGhpcy5lbmFibGUoKSwic2F2ZSI9PWUudHlwZSYmKGNsZWFyVGltZW91dChyKSxjbGVhckludGVydmFsKHMpLHRoaXMuJGVsLnZhbChlLnRleHQpKX0pfSxfX2NoYW5nZVNhdmVUZXh0OmZ1bmN0aW9uKCl7bz0wLHM9c2V0SW50ZXJ2YWwodC5iaW5kKHRoaXMuX19zaG93TG9hZGluZ1RleHQsdGhpcyksMjAwKX0sX19zaG93TG9hZGluZ1RleHQ6ZnVuY3Rpb24oKXt0aGlzLiRlbC52YWwoX1tvKyslXy5sZW5ndGhdKX19KX1mdW5jdGlvbiBsKGUsaSl7aWYoZXx8KGU9e30pLCJsYWJlbCI9PWUudHlwZSlyZXR1cm4gdm9pZChlLmxhYmVsfHxyLndhcm4oJ0EgbGFiZWwgaW5wdXQgbXVzdCBoYXZlIGEgImxhYmVsIiBwYXJhbWV0ZXInLGUpKTtpZigiYnV0dG9uIj09ZS50eXBlKXJldHVybiBlLnRpdGxlfHxlLmljb258fHIud2FybignQSBidXR0b24gaW5wdXQgbXVzdCBoYXZlIGEgInRpdGxlIiBhbmQvb3IgYW4gImljb24iIHBhcmFtZXRlcicsZSksdm9pZChlLmNsaWNrfHxlLmhyZWZ8fHIud2FybignQSBidXR0b24gaW5wdXQgbXVzdCBoYXZlIGEgImNsaWNrIiBhbmQvb3IgYW4gImhyZWYiIHBhcmFtZXRlcicsZSkpO2lmKGUubmFtZXx8ZS5pbnB1dHx8ci53YXJuKCdNaXNzaW5nICJuYW1lIiBvciAiaW5wdXQiIHBhcmFtZXRlcnMnLGUpLHQuaXNBcnJheShlLm5hbWUpJiZ0LmlzQXJyYXkoZS5pbnB1dCkpdGhyb3cgbmV3IEVycm9yKCdOb3QgYWxsb3dlZCB0byBoYXZlIGJvdGggIm5hbWUiIGFuZCAiaW5wdXQiIGRlZmluZWQgYXMgYXJyYXkuJyk7aWYoImxpc3QiIT1lLnR5cGUmJmUubmFtZSYmaSYmaS5hbGxvd3Mpe3ZhciBuPVtdO3QuaXNBcnJheShlLm5hbWUpP249ZS5uYW1lOm4ucHVzaChlLm5hbWUpLHQuZWFjaChuLGZ1bmN0aW9uKHQpe2lmKCFpLmFsbG93cyh0KSl0aHJvdyBuZXcgRXJyb3IoImZpZWxkIG5vdCBhbGxvd2VkOiAiK2UubmFtZSl9KX10LmlzQXJyYXkoZS5pbnB1dCkmJiJsaXN0IiE9ZS50eXBlJiZ0LmVhY2goZS5pbnB1dCxmdW5jdGlvbih0KXtsKHQsaSl9KTt2YXIgcz10LmtleXMoZSksbz10LmludGVyc2VjdGlvbihzLG0pO2lmKHQuc2l6ZShvKSE9dC5zaXplKGUpKXt2YXIgYT10LmNsb25lKG0pO2EudW5zaGlmdChzKSxyLndhcm4oIkludmFsaWQgaW5wdXQgcGFyYW1ldGVycyIsdC53aXRob3V0LmFwcGx5KG51bGwsYSksZSl9fWZ1bmN0aW9uIGMoZSxpLG4pe2U9dC5jbG9uZShlKSx0LmNvbnRhaW5zKFsibGlzdCIsImdyb3VwIl0sZS50eXBlKSYmKGUucGFyYW1zPXQuZGVmYXVsdHMoe2NyZWF0ZTpuLGlucHV0czp0Lm1hcCh0LmlzQXJyYXkoZS5pbnB1dCk/ZS5pbnB1dDpbZS5pbnB1dF0sZnVuY3Rpb24oZSl7cmV0dXJuIHQuZmlyc3QoYyhlLGksbikpfSl9LGUucGFyYW1zfHx7fSksZGVsZXRlIGUuaW5wdXQpO3ZhciByPXQuaXNBcnJheShlLmlucHV0KT90LmNsb25lKGUuaW5wdXQpOltlXTtyZXR1cm4gdC5tYXAocixmdW5jdGlvbihuKXt2YXIgcj10LmRlZmF1bHRzKHttb2RlbDppLm1vZGVsfSxuLHQub21pdChlLCJpbnB1dCIsImlucHV0cyIpLGkub3B0aW9ucyx7aWQ6dC51bmlxdWVJZCgiaW5wdXQiKSxyZWFkT25seTppLmlzUmVhZE9ubHkoKSxyZWFkOmkuaGFzUmVhZE1vZGUoKX0pO3JldHVybiBpLmlzUmVhZE9ubHkoKSYmKHIucmVhZD1yLnJlYWRPbmx5PSEwKSxyfSl9dmFyIHU9WyJtb2RlbCIsImlkIiwiaW5wdXRJZCIsInR5cGUiLCJsYWJlbCIsInN1YmxhYmVsIiwidG9vbHRpcCIsIm5hbWUiXSxkPVsid2lkZSIsIm11bHRpIiwiaW5wdXQiLCJleHBsYWluIiwiY3VzdG9tRXhwbGFpbiIsIm1vZGVsIiwibmFtZSIsInR5cGUiLCJhdXRvUmVuZGVyIl0saD1bIm1vZGVsIiwibmFtZSIsImxhYmVsLXRvcCIsInJlYWRPbmx5IiwiZXZlbnRzIiwiaW5pdGlhbGl6ZSIsInNob3dXaGVuIiwiYmluZGluZ3MiLCJyZW5kZXIiLCJjbGFzc05hbWUiLCJkYXRhLXNlIiwidG9nZ2xlV2hlbiJdLHA9WyJtb2RlbCIsIm5hbWUiLCJpbnB1dElkIiwidHlwZSIsImlucHV0IiwicGxhY2Vob2xkZXIiLCJsYWJlbCIsInJlYWRPbmx5IiwicmVhZCIsImRpc2FibGVkIiwicmVhZE1vZGVTdHJpbmciLCJvcHRpb25zIiwiZnJvbSIsInRvIiwiYXV0b1JlbmRlciIsImlubGluZVZhbGlkYXRpb24iLCJ2YWxpZGF0ZU9ubHlJZkRpcnR5IiwicGFyYW1zIl0sZj1bImVycm9yRmllbGQiXSxtPXQudW5pcSh0LnVuaW9uKHUsZCxoLHAsZikpLF89WyLigKIgICAgICAgICAiLCLigKIgIOKAoiAgICAgICIsIuKAoiAg4oCiICDigKIgICAiLCLigKIgIOKAoiAg4oCiICDigKIiLCIgICDigKIgIOKAoiAg4oCiIiwiICAgICAg4oCiICDigKIiLCIgICAgICAgICDigKIiLCIgICAgICAgICAgIiwiICAgICAgICAgICIsIiAgICAgICAgICAiXTtyZXR1cm57TEFCRUxfT1BUSU9OUzp1LENPTlRBSU5FUl9PUFRJT05TOmQsV1JBUFBFUl9PUFRJT05TOmgsSU5QVVRfT1BUSU9OUzpwLGdlbmVyYXRlSW5wdXRPcHRpb25zOmMsY2hhbmdlRXZlbnRTdHJpbmc6ZnVuY3Rpb24odCl7cmV0dXJuImNoYW5nZToiK3Quam9pbigiIGNoYW5nZToiKX0sY3JlYXRlUmVhZEZvcm1CdXR0b246ZnVuY3Rpb24obil7dmFyIHIscyxvO3JldHVybiJjYW5jZWwiPT1uLnR5cGU/KHM9bz1lLmxvY2FsaXplKCJvZm9ybS5jYW5jZWwiKSxyPWZ1bmN0aW9uKCl7dGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOmNhbmNlbCIpfSk6KHM9ZS5sb2NhbGl6ZSgib2Zvcm0uZWRpdCIpLG89cysiICIrbi5mb3JtVGl0bGUscj1mdW5jdGlvbigpe3RoaXMubW9kZWwuc2V0KCJfX2VkaXRfXyIsITApfSksaS5leHRlbmQoe3RhZ05hbWU6ImEiLGF0dHJpYnV0ZXM6e2hyZWY6IiMiLCJhcmlhLWxhYmVsIjpvfSx0ZW1wbGF0ZTpmdW5jdGlvbigpe3JldHVybiB0LmVzY2FwZShzKX0sZXZlbnRzOntjbGljazpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksci5jYWxsKHRoaXMpfX19KX0sY3JlYXRlQnV0dG9uOmZ1bmN0aW9uKGkpe3N3aXRjaChpPXQuY2xvbmUoaSksaS50eXBlKXtjYXNlInNhdmUiOnQuZGVmYXVsdHMoaSx7Y2xhc3NOYW1lOiJidXR0b24tcHJpbWFyeSJ9KTticmVhaztjYXNlImNhbmNlbCI6dC5kZWZhdWx0cyhpLHt0ZXh0OmUubG9jYWxpemUoIm9mb3JtLmNhbmNlbCIpLGFjdGlvbjpmdW5jdGlvbigpe3RoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpjYW5jZWwiKX19KTticmVhaztjYXNlInByZXZpb3VzIjp0LmRlZmF1bHRzKGkse3RleHQ6ZS5sb2NhbGl6ZSgib2Zvcm0ucHJldmlvdXMiKSxhY3Rpb246ZnVuY3Rpb24oKXt0aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06cHJldmlvdXMiKX19KX1yZXR1cm4gYShpKX0sdmFsaWRhdGVJbnB1dDpsLGFwcGx5U2hvd1doZW46ZnVuY3Rpb24odCxlKXt2YXIgaT1mdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24oKXt0LiRlbC50b2dnbGUoZSksdC5tb2RlbC50cmlnZ2VyKCJmb3JtOnJlc2l6ZSIpfX07cy5hcHBseURvV2hlbih0LG8oZSksZnVuY3Rpb24oZSxuKXtuLmFuaW1hdGU/dC4kZWxbInNsaWRlIisoZT8iRG93biI6IlVwIildKDIwMCxpKGUpKTp0LiRlbC50b2dnbGUoZSl9KX0sYXBwbHlUb2dnbGVXaGVuOmZ1bmN0aW9uKHQsZSl7cy5hcHBseURvV2hlbih0LG8oZSksZnVuY3Rpb24oZSxpKXt0LiRlbC50b2dnbGUoZSksdC5tb2RlbC50cmlnZ2VyKCJmb3JtOnJlc2l6ZSIpLGkuYW5pbWF0ZSYmdC5yZW5kZXIoKX0pfX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDYpXSxyPWZ1bmN0aW9uKHQpe3ZhciBlPSdcdCAgICA8ZGl2IGNsYXNzPSJva3RhLWZvcm0taW5mb2JveC1lcnJvciBpbmZvYm94IGluZm9ib3gtZXJyb3IiIHJvbGU9ImFsZXJ0Ij5cdCAgICAgIDxzcGFuIGNsYXNzPSJpY29uIGVycm9yLTE2Ij48L3NwYW4+XHQgICAgICB7eyNpZiBlcnJvclN1bW1hcnl9fVx0ICAgICAgICA8cD57e2Vycm9yU3VtbWFyeX19PC9wPlx0ICAgICAge3tlbHNlfX1cdCAgICAgICAgPHA+e3tpMThuIGNvZGU9Im9mb3JtLmVycm9yYmFubmVyLnRpdGxlIn19PC9wPlx0ICAgICAge3svaWZ9fVx0ICAgIDwvZGl2Plx0ICAnO3JldHVybiB0LmV4dGVuZCh7dGVtcGxhdGU6ZSxtb2RlbEV2ZW50czp7ImZvcm06Y2xlYXItZXJyb3JzIjoicmVtb3ZlIn19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0NiksaSgyMzMpXSxyPWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZToiby1mb3JtLWJ1dHRvbi1iYXIiLGluaXRpYWxpemU6ZnVuY3Rpb24oZSl7dGhpcy5hZGRCdXR0b24oe3R5cGU6InNhdmUiLHRleHQ6dC5yZXN1bHRDdHgoZSwic2F2ZSIsdGhpcyksaWQ6dC5yZXN1bHRDdHgoZSwic2F2ZUlkIix0aGlzKSxjbGFzc05hbWU6dC5yZXN1bHRDdHgoZSwic2F2ZUNsYXNzTmFtZSIsdGhpcyl9KSxlLm5vQ2FuY2VsQnV0dG9ufHx0aGlzLmFkZEJ1dHRvbih7dHlwZToiY2FuY2VsIix0ZXh0OnQucmVzdWx0Q3R4KGUsImNhbmNlbCIsdGhpcyl9KSxlLmhhc1ByZXZTdGVwJiZ0aGlzLmFkZEJ1dHRvbih7dHlwZToicHJldmlvdXMifSx7cHJlcGVuZDohMH0pfSxhZGRCdXR0b246ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5hZGQoaS5jcmVhdGVCdXR0b24odCksZSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg1KSxpKDIpLGkoMTQ3KSxpKDE0NiksaSgyMzgpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPWkudHBsO3JldHVybiBuLmV4dGVuZCh7cGFyYW1zOnt9LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7bi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy4kZWwuYWRkQ2xhc3MoInNpbXBsZW1vZGFsLXdyYXAiKSx0aGlzLnBhcmFtcz1lLmV4dGVuZCh7b25DbG9zZTplLmJpbmQoZS50aHJvdHRsZSh0aGlzLnJlbW92ZSw2NCksdGhpcyl9LHRoaXMucGFyYW1zfHx7fSl9LHJlbmRlcjpmdW5jdGlvbigpe3RoaXMuZGVsZWdhdGVFdmVudHMoKSxuLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBpPWUuZXh0ZW5kKHt9LGUucGljayh0aGlzLCJ0aXRsZSIsInN1YnRpdGxlIiksZS5waWNrKHRoaXMub3B0aW9ucywidGl0bGUiLCJzdWJ0aXRsZSIpKTtpZihpLnN1YnRpdGxlKXt2YXIgcz1lLnJlc3VsdEN0eChpLCJzdWJ0aXRsZSIsdGhpcyk7dGhpcy4kZWwucHJlcGVuZChyKCc8cCBjbGFzcz0ibW9kYWwtc3VidGl0bGUgdGV4dC1saWdodCBcdCAgICAgICAgICBwYWRkaW5nLTIwIG1hcmdpbi1idG0tMCI+e3tzdWJ0aXRsZX19PC9wPicpKHtzdWJ0aXRsZTpzfSkpfWlmKGkudGl0bGUpe3ZhciBvPWUucmVzdWx0Q3R4KGksInRpdGxlIix0aGlzKTt0aGlzLiRlbC5wcmVwZW5kKHIoJzxoMiBjbGFzcz0iYmxvY2sgbW9kYWwtdGl0bGUiPnt7dGl0bGV9fTwvaDI+Jykoe3RpdGxlOm99KSl9cmV0dXJuIGUuZGVmZXIoZS5iaW5kKGZ1bmN0aW9uKCl7dGhpcy4kZWwubW9kYWwodGhpcy5wYXJhbXMpLHRoaXMucmVzaXplKCl9LHRoaXMpKSx0KCJib2R5IikuY3NzKCJvdmVyZmxvdyIsImhpZGRlbiIpLHRoaXN9LHJlbW92ZTpmdW5jdGlvbigpe3JldHVybiB0Lm1vZGFsLmNsb3NlKCksdCgiYm9keSIpLmNzcygib3ZlcmZsb3ciLCIiKSxlLmRlZmVyKGZ1bmN0aW9uKCl7dC5tb2RhbC5jbG9zZSgpfSksbi5wcm90b3R5cGUucmVtb3ZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0scmVzaXplOmZ1bmN0aW9uKCl7dC5tb2RhbC51cGRhdGUodGhpcy4kZWwub3V0ZXJIZWlnaHQoKSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHIsczshZnVuY3Rpb24obyl7cj1baSg2KV0sbj1vLHM9ImZ1bmN0aW9uIj09dHlwZW9mIG4/bi5hcHBseShlLHIpOm4sISh2b2lkIDAhPT1zJiYodC5leHBvcnRzPXMpKX0oZnVuY3Rpb24odCl7dmFyIGU9W10saT10KGRvY3VtZW50KSxuPW5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSxyPXQod2luZG93KSxzPVtdLG89e2llUXVpcmtzOm51bGwsbXNpZTovbXNpZS8udGVzdChuKSYmIS9vcGVyYS8udGVzdChuKSxvcGVyYTovb3BlcmEvLnRlc3Qobil9O28uaWU2PW8ubXNpZSYmL21zaWUgNi4vLnRlc3QobikmJiJvYmplY3QiIT10eXBlb2Ygd2luZG93LlhNTEh0dHBSZXF1ZXN0LG8uaWU3PW8ubXNpZSYmL21zaWUgNy4wLy50ZXN0KG4pLHQubW9kYWw9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdC5tb2RhbC5pbXBsLmluaXQoZSxpKX0sdC5tb2RhbC5jbG9zZT1mdW5jdGlvbigpe3QubW9kYWwuaW1wbC5jbG9zZSgpfSx0Lm1vZGFsLmZvY3VzPWZ1bmN0aW9uKGUpe3QubW9kYWwuaW1wbC5mb2N1cyhlKX0sdC5tb2RhbC5zZXRDb250YWluZXJEaW1lbnNpb25zPWZ1bmN0aW9uKCl7dC5tb2RhbC5pbXBsLnNldENvbnRhaW5lckRpbWVuc2lvbnMoKX0sdC5tb2RhbC5zZXRQb3NpdGlvbj1mdW5jdGlvbigpe3QubW9kYWwuaW1wbC5zZXRQb3NpdGlvbigpfSx0Lm1vZGFsLnVwZGF0ZT1mdW5jdGlvbihlLGkpe3QubW9kYWwuaW1wbC51cGRhdGUoZSxpKX0sdC5mbi5tb2RhbD1mdW5jdGlvbihlKXtyZXR1cm4gdC5tb2RhbC5pbXBsLmluaXQodGhpcyxlKX0sdC5tb2RhbC5kZWZhdWx0cz17YXBwZW5kVG86ImJvZHkiLGZvY3VzOiEwLG9wYWNpdHk6NTAsb3ZlcmxheUlkOiJzaW1wbGVtb2RhbC1vdmVybGF5IixvdmVybGF5Q3NzOnt9LGNvbnRhaW5lcklkOiJzaW1wbGVtb2RhbC1jb250YWluZXIiLGNvbnRhaW5lckNzczp7fSxkYXRhSWQ6InNpbXBsZW1vZGFsLWRhdGEiLGRhdGFDc3M6e30sbWluSGVpZ2h0Om51bGwsbWluV2lkdGg6bnVsbCxtYXhIZWlnaHQ6bnVsbCxtYXhXaWR0aDpudWxsLGF1dG9SZXNpemU6ITEsYXV0b1Bvc2l0aW9uOiEwLHpJbmRleDoxZTMsY2xvc2U6ITAsY2xvc2VIVE1MOic8YSBjbGFzcz0ibW9kYWxDbG9zZUltZyIgdGl0bGU9IkNsb3NlIj48L2E+JyxjbG9zZUNsYXNzOiJzaW1wbGVtb2RhbC1jbG9zZSIsZXNjQ2xvc2U6ITAsb3ZlcmxheUNsb3NlOiExLGZpeGVkOiEwLHBvc2l0aW9uOm51bGwscGVyc2lzdDohMSxtb2RhbDohMCxvbk9wZW46bnVsbCxvblNob3c6bnVsbCxvbkNsb3NlOm51bGx9LHQubW9kYWwuaW1wbD17ZDp7fSxpbml0OmZ1bmN0aW9uKGUsaSl7dmFyIG49dGhpcztpZihuLmQuZGF0YSlyZXR1cm4hMTtpZihvLmllUXVpcmtzPW8ubXNpZSYmInVuZGVmaW5lZCIhPXR5cGVvZiB0LnN1cHBvcnQuYm94TW9kZWwmJiF0LnN1cHBvcnQuYm94TW9kZWwsbi5vPXQuZXh0ZW5kKHt9LHQubW9kYWwuZGVmYXVsdHMsaSksbi56SW5kZXg9bi5vLnpJbmRleCxuLm9jY2I9ITEsIm9iamVjdCI9PXR5cGVvZiBlKWU9ZSBpbnN0YW5jZW9mIHQ/ZTp0KGUpLG4uZC5wbGFjZWhvbGRlcj0hMSxlLnBhcmVudCgpLnBhcmVudCgpLnNpemUoKT4wJiYoZS5iZWZvcmUodCgiPHNwYW4+PC9zcGFuPiIpLmF0dHIoImlkIiwic2ltcGxlbW9kYWwtcGxhY2Vob2xkZXIiKS5jc3Moe2Rpc3BsYXk6Im5vbmUifSkpLG4uZC5wbGFjZWhvbGRlcj0hMCxuLmRpc3BsYXk9ZS5jc3MoImRpc3BsYXkiKSxuLm8ucGVyc2lzdHx8KG4uZC5vcmlnPWUuY2xvbmUoITApKSk7ZWxzZXtpZigic3RyaW5nIiE9dHlwZW9mIGUmJiJudW1iZXIiIT10eXBlb2YgZSlyZXR1cm4gYWxlcnQoIlNpbXBsZU1vZGFsIEVycm9yOiBVbnN1cHBvcnRlZCBkYXRhIHR5cGU6ICIrdHlwZW9mIGUpLG47ZT10KCI8ZGl2PjwvZGl2PiIpLmh0bWwoZSl9cmV0dXJuIG4uY3JlYXRlKGUpLGU9bnVsbCxuLm9wZW4oKSx0LmlzRnVuY3Rpb24obi5vLm9uU2hvdykmJm4uby5vblNob3cuYXBwbHkobixbbi5kXSksbn0sY3JlYXRlOmZ1bmN0aW9uKGkpe3ZhciBuPXRoaXM7bi5nZXREaW1lbnNpb25zKCksbi5vLm1vZGFsJiZvLmllNiYmKG4uZC5pZnJhbWU9dCgnPGlmcmFtZSBzcmM9ImphdmFzY3JpcHQ6ZmFsc2U7Ij48L2lmcmFtZT4nKS5jc3ModC5leHRlbmQobi5vLmlmcmFtZUNzcyx7ZGlzcGxheToibm9uZSIsb3BhY2l0eTowLHBvc2l0aW9uOiJmaXhlZCIsaGVpZ2h0OnNbMF0sd2lkdGg6c1sxXSx6SW5kZXg6bi5vLnpJbmRleCx0b3A6MCxsZWZ0OjB9KSkuYXBwZW5kVG8obi5vLmFwcGVuZFRvKSksbi5kLm92ZXJsYXk9dCgiPGRpdj48L2Rpdj4iKS5hdHRyKCJpZCIsbi5vLm92ZXJsYXlJZCkuYWRkQ2xhc3MoInNpbXBsZW1vZGFsLW92ZXJsYXkiKS5jc3ModC5leHRlbmQobi5vLm92ZXJsYXlDc3Mse2Rpc3BsYXk6Im5vbmUiLG9wYWNpdHk6bi5vLm9wYWNpdHkvMTAwLGhlaWdodDpuLm8ubW9kYWw/ZVswXTowLHdpZHRoOm4uby5tb2RhbD9lWzFdOjAscG9zaXRpb246ImZpeGVkIixsZWZ0OjAsdG9wOjAsekluZGV4Om4uby56SW5kZXgrMX0pKS5hcHBlbmRUbyhuLm8uYXBwZW5kVG8pLG4uZC5jb250YWluZXI9dCgiPGRpdj48L2Rpdj4iKS5hdHRyKCJpZCIsbi5vLmNvbnRhaW5lcklkKS5hdHRyKCJyb2xlIiwiZGlhbG9nIikuYWRkQ2xhc3MoInNpbXBsZW1vZGFsLWNvbnRhaW5lci1uZXciKS5jc3ModC5leHRlbmQoe3Bvc2l0aW9uOm4uby5maXhlZD8iZml4ZWQiOiJhYnNvbHV0ZSJ9LG4uby5jb250YWluZXJDc3Mse2Rpc3BsYXk6Im5vbmUiLHpJbmRleDpuLm8uekluZGV4KzJ9KSkuYXBwZW5kKG4uby5jbG9zZSYmbi5vLmNsb3NlSFRNTD90KG4uby5jbG9zZUhUTUwpLmFkZENsYXNzKG4uby5jbG9zZUNsYXNzKToiIikuYXBwZW5kVG8obi5vLmFwcGVuZFRvKSxuLmQud3JhcD10KCI8ZGl2PjwvZGl2PiIpLmF0dHIoInRhYkluZGV4IiwtMSkuYWRkQ2xhc3MoInNpbXBsZW1vZGFsLXdyYXAiKS5jc3Moe2hlaWdodDoiMTAwJSIsb3V0bGluZTowLHdpZHRoOiIxMDAlIn0pLmFwcGVuZFRvKG4uZC5jb250YWluZXIpLG4uZC5kYXRhPWkuYXR0cigiaWQiLGkuYXR0cigiaWQiKXx8bi5vLmRhdGFJZCkuYWRkQ2xhc3MoInNpbXBsZW1vZGFsLWRhdGEiKS5jc3ModC5leHRlbmQobi5vLmRhdGFDc3Mse2Rpc3BsYXk6Im5vbmUifSkpLmFwcGVuZFRvKCJib2R5IiksaT1udWxsLG4uc2V0Q29udGFpbmVyRGltZW5zaW9ucygpLG4uZC5kYXRhLmFwcGVuZFRvKG4uZC53cmFwKSwoby5pZTZ8fG8uaWVRdWlya3MpJiZuLmZpeElFKCl9LGJpbmRFdmVudHM6ZnVuY3Rpb24oKXt2YXIgbj10aGlzO3QoIi4iK24uby5jbG9zZUNsYXNzKS5iaW5kKCJjbGljay5zaW1wbGVtb2RhbCIsZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLG4uY2xvc2UoKX0pLG4uby5tb2RhbCYmbi5vLmNsb3NlJiZuLm8ub3ZlcmxheUNsb3NlJiZuLmQub3ZlcmxheS5iaW5kKCJjbGljay5zaW1wbGVtb2RhbCIsZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLG4uY2xvc2UoKX0pLGkuYmluZCgia2V5ZG93bi5zaW1wbGVtb2RhbCIsZnVuY3Rpb24odCl7bi5vLm1vZGFsJiY5PT09dC5rZXlDb2RlP24ud2F0Y2hUYWIodCk6bi5vLmNsb3NlJiZuLm8uZXNjQ2xvc2UmJjI3PT09dC5rZXlDb2RlJiYodC5wcmV2ZW50RGVmYXVsdCgpLG4uY2xvc2UoKSl9KSxyLmJpbmQoInJlc2l6ZS5zaW1wbGVtb2RhbCBvcmllbnRhdGlvbmNoYW5nZS5zaW1wbGVtb2RhbCIsZnVuY3Rpb24oKXtuLmdldERpbWVuc2lvbnMoKSxuLm8uYXV0b1Jlc2l6ZT9uLnNldENvbnRhaW5lckRpbWVuc2lvbnMoKTpuLm8uYXV0b1Bvc2l0aW9uJiZuLnNldFBvc2l0aW9uKCksby5pZTZ8fG8uaWVRdWlya3M/bi5maXhJRSgpOm4uby5tb2RhbCYmKG4uZC5pZnJhbWUmJm4uZC5pZnJhbWUuY3NzKHtoZWlnaHQ6c1swXSx3aWR0aDpzWzFdfSksbi5kLm92ZXJsYXkuY3NzKHtoZWlnaHQ6ZVswXSx3aWR0aDplWzFdfSkpfSl9LHVuYmluZEV2ZW50czpmdW5jdGlvbigpe3QoIi4iK3RoaXMuby5jbG9zZUNsYXNzKS51bmJpbmQoImNsaWNrLnNpbXBsZW1vZGFsIiksaS51bmJpbmQoImtleWRvd24uc2ltcGxlbW9kYWwiKSxyLnVuYmluZCgiLnNpbXBsZW1vZGFsIiksdGhpcy5kLm92ZXJsYXkudW5iaW5kKCJjbGljay5zaW1wbGVtb2RhbCIpfSxmaXhJRTpmdW5jdGlvbigpe3ZhciBlPXRoaXMsaT1lLm8ucG9zaXRpb247dC5lYWNoKFtlLmQuaWZyYW1lfHxudWxsLGUuby5tb2RhbD9lLmQub3ZlcmxheTpudWxsLCJmaXhlZCI9PT1lLmQuY29udGFpbmVyLmNzcygicG9zaXRpb24iKT9lLmQuY29udGFpbmVyOm51bGxdLGZ1bmN0aW9uKHQsZSl7aWYoZSl7dmFyIG49ImRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0IixyPSJkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoIixzPSJkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCIsbz0iZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0IixhPSJkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCIsbD0iZG9jdW1lbnQuYm9keS5zY3JvbGxXaWR0aCIsYz0iZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCIsdT0iZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIixkPSJkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdCIsaD0iZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCIscD1lWzBdLnN0eWxlO2lmKHAucG9zaXRpb249ImFic29sdXRlIix0PDIpcC5yZW1vdmVFeHByZXNzaW9uKCJoZWlnaHQiKSxwLnJlbW92ZUV4cHJlc3Npb24oIndpZHRoIikscC5zZXRFeHByZXNzaW9uKCJoZWlnaHQiLCIiK3MrIiA+ICIrbisiID8gIitzKyIgOiAiK24rJyArICJweCInKSxwLnNldEV4cHJlc3Npb24oIndpZHRoIiwiIitsKyIgPiAiK3IrIiA/ICIrbCsiIDogIityKycgKyAicHgiJyk7ZWxzZXt2YXIgZixtO2lmKGkmJmkuY29uc3RydWN0b3I9PT1BcnJheSl7dmFyIF89aVswXT8ibnVtYmVyIj09dHlwZW9mIGlbMF0/aVswXS50b1N0cmluZygpOmlbMF0ucmVwbGFjZSgvcHgvLCIiKTplLmNzcygidG9wIikucmVwbGFjZSgvcHgvLCIiKTtpZihmPV8uaW5kZXhPZigiJSIpPT09LTE/XysiICsgKHQgPSAiK2grIiA/ICIraCsiIDogIithKycpICsgInB4Iic6cGFyc2VJbnQoXy5yZXBsYWNlKC8lLywiIikpKyIgKiAoKCIrYysiIHx8ICIrbisiKSAvIDEwMCkgKyAodCA9ICIraCsiID8gIitoKyIgOiAiK2ErJykgKyAicHgiJyxpWzFdKXt2YXIgZz0ibnVtYmVyIj09dHlwZW9mIGlbMV0/aVsxXS50b1N0cmluZygpOmlbMV0ucmVwbGFjZSgvcHgvLCIiKTttPWcuaW5kZXhPZigiJSIpPT09LTE/ZysiICsgKHQgPSAiK2QrIiA/ICIrZCsiIDogIitvKycpICsgInB4Iic6cGFyc2VJbnQoZy5yZXBsYWNlKC8lLywiIikpKyIgKiAoKCIrdSsiIHx8ICIrcisiKSAvIDEwMCkgKyAodCA9ICIrZCsiID8gIitkKyIgOiAiK28rJykgKyAicHgiJ319ZWxzZSBmPSIoIitjKyIgfHwgIituKyIpIC8gMiAtICh0aGlzLm9mZnNldEhlaWdodCAvIDIpICsgKHQgPSAiK2grIiA/ICIraCsiIDogIithKycpICsgInB4IicsbT0iKCIrdSsiIHx8ICIrcisiKSAvIDIgLSAodGhpcy5vZmZzZXRXaWR0aCAvIDIpICsgKHQgPSAiK2QrIiA/ICIrZCsiIDogIitvKycpICsgInB4Iic7cC5yZW1vdmVFeHByZXNzaW9uKCJ0b3AiKSxwLnJlbW92ZUV4cHJlc3Npb24oImxlZnQiKSxwLnNldEV4cHJlc3Npb24oInRvcCIsZikscC5zZXRFeHByZXNzaW9uKCJsZWZ0IixtKX19fSl9LGZvY3VzOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMsbj1lJiZ0LmluQXJyYXkoZSxbImZpcnN0IiwibGFzdCJdKSE9PS0xP2U6ImZpcnN0IixyPXQoIjppbnB1dDplbmFibGVkOnZpc2libGU6IituLGkuZC53cmFwKTtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ci5sZW5ndGg+MD9yLmZvY3VzJiZyLmZvY3VzKCk6aSYmaS5kJiZpLmQud3JhcCYmaS5kLndyYXAuZm9jdXMmJmkuZC53cmFwLmZvY3VzKCl9LDEwKX0sZ2V0RGltZW5zaW9uczpmdW5jdGlvbigpe3ZhciB0PSJ1bmRlZmluZWQiPT10eXBlb2Ygd2luZG93LmlubmVySGVpZ2h0P3IuaGVpZ2h0KCk6d2luZG93LmlubmVySGVpZ2h0O2U9W2kuaGVpZ2h0KCksaS53aWR0aCgpXSxzPVt0LHIud2lkdGgoKV19LGdldFZhbDpmdW5jdGlvbih0LGUpe3JldHVybiB0PyJudW1iZXIiPT10eXBlb2YgdD90OiJhdXRvIj09PXQ/MDp0LmluZGV4T2YoIiUiKT4wP3BhcnNlSW50KHQucmVwbGFjZSgvJS8sIiIpKS8xMDAqKCJoIj09PWU/c1swXTpzWzFdKTpwYXJzZUludCh0LnJlcGxhY2UoL3B4LywiIikpOm51bGx9LHVwZGF0ZTpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXM7cmV0dXJuISFpLmQuZGF0YSYmKGkuZC5vcmlnSGVpZ2h0PWkuZ2V0VmFsKHQsImgiKSxpLmQub3JpZ1dpZHRoPWkuZ2V0VmFsKGUsInciKSxpLmQuZGF0YS5oaWRlKCksdCYmaS5kLmNvbnRhaW5lci5jc3MoImhlaWdodCIsdCksZSYmaS5kLmNvbnRhaW5lci5jc3MoIndpZHRoIixlKSxpLnNldENvbnRhaW5lckRpbWVuc2lvbnMoKSxpLmQuZGF0YS5zaG93KCksaS5vLmZvY3VzJiZpLmZvY3VzKCksaS51bmJpbmRFdmVudHMoKSx2b2lkIGkuYmluZEV2ZW50cygpKX0sc2V0Q29udGFpbmVyRGltZW5zaW9uczpmdW5jdGlvbigpe3ZhciB0PXRoaXMsZT1vLmllNnx8by5pZTcsaT10LmQub3JpZ0hlaWdodD90LmQub3JpZ0hlaWdodDpvLm9wZXJhP3QuZC5jb250YWluZXIuaGVpZ2h0KCk6dC5nZXRWYWwoZT90LmQuY29udGFpbmVyWzBdLmN1cnJlbnRTdHlsZS5oZWlnaHQ6dC5kLmNvbnRhaW5lci5jc3MoImhlaWdodCIpLCJoIiksbj10LmQub3JpZ1dpZHRoP3QuZC5vcmlnV2lkdGg6by5vcGVyYT90LmQuY29udGFpbmVyLndpZHRoKCk6dC5nZXRWYWwoZT90LmQuY29udGFpbmVyWzBdLmN1cnJlbnRTdHlsZS53aWR0aDp0LmQuY29udGFpbmVyLmNzcygid2lkdGgiKSwidyIpLHI9dC5kLmRhdGEub3V0ZXJIZWlnaHQoITApLGE9dC5kLmRhdGEub3V0ZXJXaWR0aCghMCk7dC5kLm9yaWdIZWlnaHQ9dC5kLm9yaWdIZWlnaHR8fGksdC5kLm9yaWdXaWR0aD10LmQub3JpZ1dpZHRofHxuO3ZhciBsPXQuby5tYXhIZWlnaHQ/dC5nZXRWYWwodC5vLm1heEhlaWdodCwiaCIpOm51bGwsYz10Lm8ubWF4V2lkdGg/dC5nZXRWYWwodC5vLm1heFdpZHRoLCJ3Iik6bnVsbCx1PWwmJmw8c1swXT9sOnNbMF0sZD1jJiZjPHNbMV0/YzpzWzFdLGg9dC5vLm1pbkhlaWdodD90LmdldFZhbCh0Lm8ubWluSGVpZ2h0LCJoIik6ImF1dG8iO2k9aT90Lm8uYXV0b1Jlc2l6ZSYmaT51P3U6aTxoP2g6aTpyP3I+dT91OnQuby5taW5IZWlnaHQmJiJhdXRvIiE9PWgmJnI8aD9oOnI6aDt2YXIgcD10Lm8ubWluV2lkdGg/dC5nZXRWYWwodC5vLm1pbldpZHRoLCJ3Iik6ImF1dG8iO249bj90Lm8uYXV0b1Jlc2l6ZSYmbj5kP2Q6bjxwP3A6bjphP2E+ZD9kOnQuby5taW5XaWR0aCYmImF1dG8iIT09cCYmYTxwP3A6YTpwLHQuZC5jb250YWluZXIuY3NzKHtoZWlnaHQ6aSx3aWR0aDpufSksdC5kLndyYXAuY3NzKHtvdmVyZmxvdzpyPml8fGE+bj8iYXV0byI6InZpc2libGUifSksdC5vLmF1dG9Qb3NpdGlvbiYmdC5zZXRQb3NpdGlvbigpfSxzZXRQb3NpdGlvbjpmdW5jdGlvbigpe3ZhciB0LGUsaT10aGlzLG49c1swXS8yLWkuZC5jb250YWluZXIub3V0ZXJIZWlnaHQoITApLzIsbz1zWzFdLzItaS5kLmNvbnRhaW5lci5vdXRlcldpZHRoKCEwKS8yLGE9ImZpeGVkIiE9PWkuZC5jb250YWluZXIuY3NzKCJwb3NpdGlvbiIpP3Iuc2Nyb2xsVG9wKCk6MDtpLm8ucG9zaXRpb24mJiJbb2JqZWN0IEFycmF5XSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaS5vLnBvc2l0aW9uKT8odD1hKyhpLm8ucG9zaXRpb25bMF18fG4pLGU9aS5vLnBvc2l0aW9uWzFdfHxvKToodD1hK24sZT1vKSxpLmQuY29udGFpbmVyLmNzcyh7bGVmdDplLHRvcDp0fSl9LHdhdGNoVGFiOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXM7aWYodChlLnRhcmdldCkucGFyZW50cygiLnNpbXBsZW1vZGFsLWNvbnRhaW5lci1uZXciKS5sZW5ndGg+MCl7aWYoaS5pbnB1dHM9dCgiOmlucHV0OmVuYWJsZWQ6dmlzaWJsZTpmaXJzdCwgOmlucHV0OmVuYWJsZWQ6dmlzaWJsZTpsYXN0IixpLmQuZGF0YVswXSksIWUuc2hpZnRLZXkmJmUudGFyZ2V0PT09aS5pbnB1dHNbaS5pbnB1dHMubGVuZ3RoLTFdfHxlLnNoaWZ0S2V5JiZlLnRhcmdldD09PWkuaW5wdXRzWzBdfHwwPT09aS5pbnB1dHMubGVuZ3RoKXtlLnByZXZlbnREZWZhdWx0KCk7dmFyIG49ZS5zaGlmdEtleT8ibGFzdCI6ImZpcnN0IjtpLmZvY3VzKG4pfX1lbHNlIGUucHJldmVudERlZmF1bHQoKSxpLmZvY3VzKCl9LG9wZW46ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2UuZC5pZnJhbWUmJmUuZC5pZnJhbWUuc2hvdygpLHQuaXNGdW5jdGlvbihlLm8ub25PcGVuKT9lLm8ub25PcGVuLmFwcGx5KGUsW2UuZF0pOihlLmQub3ZlcmxheS5zaG93KCksZS5kLmNvbnRhaW5lci5zaG93KCksZS5kLmRhdGEuc2hvdygpKSxlLm8uZm9jdXMmJmUuZm9jdXMoKSxlLmJpbmRFdmVudHMoKX0sY2xvc2U6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2lmKCFlLmQuZGF0YSlyZXR1cm4hMTtpZihlLnVuYmluZEV2ZW50cygpLHQuaXNGdW5jdGlvbihlLm8ub25DbG9zZSkmJiFlLm9jY2IpZS5vY2NiPSEwLGUuby5vbkNsb3NlLmFwcGx5KGUsW2UuZF0pO2Vsc2V7aWYoZS5kLnBsYWNlaG9sZGVyKXt2YXIgaT10KCIjc2ltcGxlbW9kYWwtcGxhY2Vob2xkZXIiKTtlLm8ucGVyc2lzdD9pLnJlcGxhY2VXaXRoKGUuZC5kYXRhLnJlbW92ZUNsYXNzKCJzaW1wbGVtb2RhbC1kYXRhIikuY3NzKCJkaXNwbGF5IixlLmRpc3BsYXkpKTooZS5kLmRhdGEuaGlkZSgpLnJlbW92ZSgpLGkucmVwbGFjZVdpdGgoZS5kLm9yaWcpKX1lbHNlIGUuZC5kYXRhLmhpZGUoKS5yZW1vdmUoKTtlLmQuY29udGFpbmVyLmhpZGUoKS5yZW1vdmUoKSxlLmQub3ZlcmxheS5oaWRlKCksZS5kLmlmcmFtZSYmZS5kLmlmcmFtZS5oaWRlKCkucmVtb3ZlKCksZS5kLm92ZXJsYXkucmVtb3ZlKCksZS5kPXt9fX19fSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDYpLGkoMTg3KSxpKDI0MCldLHI9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXtsaW5lczo5LGxlbmd0aDowLHdpZHRoOjgscmFkaXVzOjEyLGNvcm5lcnM6MSxyb3RhdGU6MjMsZGlyZWN0aW9uOjEsY29sb3I6IiM2NjYiLHNwZWVkOi44LHRyYWlsOjUwLHNoYWRvdzohMSxod2FjY2VsOiExLGNsYXNzTmFtZToiIix6SW5kZXg6MmU5LHRvcDoiYXV0byIsbGVmdDoiYXV0byJ9O3JldHVybiBlLmV4dGVuZCh7Y29uc3RydWN0b3I6ZnVuY3Rpb24oKXt0aGlzLnNwaW5PcHRpb25zfHwodGhpcy5zcGluT3B0aW9ucz17fSksdC5kZWZhdWx0cyh0aGlzLnNwaW5PcHRpb25zLG4pLGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxyZW5kZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zcGluQXRSZW5kZXJ8fHRoaXMuJGVsLmhpZGUoKSxlLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuc3BpbkF0UmVuZGVyJiZ0aGlzLnNwaW4oKSx0aGlzfSxzcGluOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJGVsLnNwaW4odGhpcy5zcGluT3B0aW9ucykuc2hvdygpLHRoaXN9LGVtcHR5OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy4kZWw7dC5mYWRlT3V0KGkuTE9BRElOR19GQURFLGZ1bmN0aW9uKCl7dC5zcGluKCExKX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNiksaSgyNDEpXSxyPWZ1bmN0aW9uKHQsZSl7dC5mbi5zcGluPWZ1bmN0aW9uKGkpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt0cnl7dmFyIG49dCh0aGlzKSxyPW4uZGF0YSgpO3Iuc3Bpbm5lciYmKHIuc3Bpbm5lci5zdG9wKCksZGVsZXRlIHIuc3Bpbm5lciksaSE9PSExJiYoci5zcGlubmVyPW5ldyBlKHQuZXh0ZW5kKHtjb2xvcjpuLmNzcygiY29sb3IiKX0saSkpLnNwaW4odGhpcykpfWNhdGNoKHMpe3dpbmRvdy5jb25zb2xlJiZ3aW5kb3cuY29uc29sZS5lcnJvcihzKX19KSx0aGlzfX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjshZnVuY3Rpb24ocyxvKXsib2JqZWN0Ij09dHlwZW9mIHQmJnQuZXhwb3J0cz90LmV4cG9ydHM9bygpOihuPW8scj0iZnVuY3Rpb24iPT10eXBlb2Ygbj9uLmNhbGwoZSxpLGUsdCk6biwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpKX0odGhpcyxmdW5jdGlvbigpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiB0KHQsZSl7dmFyIGksbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KHR8fCJkaXYiKTtmb3IoaSBpbiBlKW5baV09ZVtpXTtyZXR1cm4gbn1mdW5jdGlvbiBlKHQpe2Zvcih2YXIgZT0xLGk9YXJndW1lbnRzLmxlbmd0aDtlPGk7ZSsrKXQuYXBwZW5kQ2hpbGQoYXJndW1lbnRzW2VdKTtyZXR1cm4gdH1mdW5jdGlvbiBpKHQsZSxpLG4pe3ZhciByPVsib3BhY2l0eSIsZSx+figxMDAqdCksaSxuXS5qb2luKCItIikscz0uMDEraS9uKjEwMCxvPU1hdGgubWF4KDEtKDEtdCkvZSooMTAwLXMpLHQpLGE9Yy5zdWJzdHJpbmcoMCxjLmluZGV4T2YoIkFuaW1hdGlvbiIpKS50b0xvd2VyQ2FzZSgpLGw9YSYmIi0iK2ErIi0ifHwiIjtyZXR1cm4gaFtyXXx8KHUuaW5zZXJ0UnVsZSgiQCIrbCsia2V5ZnJhbWVzICIrcisiezAle29wYWNpdHk6IitvKyJ9IitzKyIle29wYWNpdHk6Iit0KyJ9IisocysuMDEpKyIle29wYWNpdHk6MX0iKyhzK2UpJTEwMCsiJXtvcGFjaXR5OiIrdCsifTEwMCV7b3BhY2l0eToiK28rIn19Iix1LmNzc1J1bGVzLmxlbmd0aCksaFtyXT0xKSxyfWZ1bmN0aW9uIG4odCxlKXt2YXIgaSxuLHI9dC5zdHlsZTtpZihlPWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrZS5zbGljZSgxKSx2b2lkIDAhPT1yW2VdKXJldHVybiBlO2ZvcihuPTA7bjxkLmxlbmd0aDtuKyspaWYoaT1kW25dK2Usdm9pZCAwIT09cltpXSlyZXR1cm4gaX1mdW5jdGlvbiByKHQsZSl7Zm9yKHZhciBpIGluIGUpdC5zdHlsZVtuKHQsaSl8fGldPWVbaV07cmV0dXJuIHR9ZnVuY3Rpb24gcyh0KXtmb3IodmFyIGU9MTtlPGFyZ3VtZW50cy5sZW5ndGg7ZSsrKXt2YXIgaT1hcmd1bWVudHNbZV07Zm9yKHZhciBuIGluIGkpdm9pZCAwPT09dFtuXSYmKHRbbl09aVtuXSl9cmV0dXJuIHR9ZnVuY3Rpb24gbyh0LGUpe3JldHVybiJzdHJpbmciPT10eXBlb2YgdD90OnRbZSV0Lmxlbmd0aF19ZnVuY3Rpb24gYSh0KXt0aGlzLm9wdHM9cyh0fHx7fSxhLmRlZmF1bHRzLHApfWZ1bmN0aW9uIGwoKXtmdW5jdGlvbiBpKGUsaSl7cmV0dXJuIHQoIjwiK2UrJyB4bWxucz0idXJuOnNjaGVtYXMtbWljcm9zb2Z0LmNvbTp2bWwiIGNsYXNzPSJzcGluLXZtbCI+JyxpKX11LmFkZFJ1bGUoIi5zcGluLXZtbCIsImJlaGF2aW9yOnVybCgjZGVmYXVsdCNWTUwpIiksYS5wcm90b3R5cGUubGluZXM9ZnVuY3Rpb24odCxuKXtmdW5jdGlvbiBzKCl7cmV0dXJuIHIoaSgiZ3JvdXAiLHtjb29yZHNpemU6dSsiICIrdSwKCWNvb3Jkb3JpZ2luOi1jKyIgIistY30pLHt3aWR0aDp1LGhlaWdodDp1fSl9ZnVuY3Rpb24gYSh0LGEsbCl7ZShoLGUocihzKCkse3JvdGF0aW9uOjM2MC9uLmxpbmVzKnQrImRlZyIsbGVmdDp+fmF9KSxlKHIoaSgicm91bmRyZWN0Iix7YXJjc2l6ZTpuLmNvcm5lcnN9KSx7d2lkdGg6YyxoZWlnaHQ6bi5zY2FsZSpuLndpZHRoLGxlZnQ6bi5zY2FsZSpuLnJhZGl1cyx0b3A6LW4uc2NhbGUqbi53aWR0aD4+MSxmaWx0ZXI6bH0pLGkoImZpbGwiLHtjb2xvcjpvKG4uY29sb3IsdCksb3BhY2l0eTpuLm9wYWNpdHl9KSxpKCJzdHJva2UiLHtvcGFjaXR5OjB9KSkpKX12YXIgbCxjPW4uc2NhbGUqKG4ubGVuZ3RoK24ud2lkdGgpLHU9MipuLnNjYWxlKmMsZD0tKG4ud2lkdGgrbi5sZW5ndGgpKm4uc2NhbGUqMisicHgiLGg9cihzKCkse3Bvc2l0aW9uOiJhYnNvbHV0ZSIsdG9wOmQsbGVmdDpkfSk7aWYobi5zaGFkb3cpZm9yKGw9MTtsPD1uLmxpbmVzO2wrKylhKGwsLTIsInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5CbHVyKHBpeGVscmFkaXVzPTIsbWFrZXNoYWRvdz0xLHNoYWRvd29wYWNpdHk9LjMpIik7Zm9yKGw9MTtsPD1uLmxpbmVzO2wrKylhKGwpO3JldHVybiBlKHQsaCl9LGEucHJvdG90eXBlLm9wYWNpdHk9ZnVuY3Rpb24odCxlLGksbil7dmFyIHI9dC5maXJzdENoaWxkO249bi5zaGFkb3cmJm4ubGluZXN8fDAsciYmZStuPHIuY2hpbGROb2Rlcy5sZW5ndGgmJihyPXIuY2hpbGROb2Rlc1tlK25dLHI9ciYmci5maXJzdENoaWxkLHI9ciYmci5maXJzdENoaWxkLHImJihyLm9wYWNpdHk9aSkpfX12YXIgYyx1LGQ9WyJ3ZWJraXQiLCJNb3oiLCJtcyIsIk8iXSxoPXt9LHA9e2xpbmVzOjEyLGxlbmd0aDo3LHdpZHRoOjUscmFkaXVzOjEwLHNjYWxlOjEsY29ybmVyczoxLGNvbG9yOiIjMDAwIixvcGFjaXR5Oi4yNSxyb3RhdGU6MCxkaXJlY3Rpb246MSxzcGVlZDoxLHRyYWlsOjEwMCxmcHM6MjAsekluZGV4OjJlOSxjbGFzc05hbWU6InNwaW5uZXIiLHRvcDoiNTAlIixsZWZ0OiI1MCUiLHNoYWRvdzohMSxod2FjY2VsOiExLHBvc2l0aW9uOiJhYnNvbHV0ZSJ9O2lmKGEuZGVmYXVsdHM9e30scyhhLnByb3RvdHlwZSx7c3BpbjpmdW5jdGlvbihlKXt0aGlzLnN0b3AoKTt2YXIgaT10aGlzLG49aS5vcHRzLHM9aS5lbD10KG51bGwse2NsYXNzTmFtZTpuLmNsYXNzTmFtZX0pO2lmKHIocyx7cG9zaXRpb246bi5wb3NpdGlvbix3aWR0aDowLHpJbmRleDpuLnpJbmRleCxsZWZ0Om4ubGVmdCx0b3A6bi50b3B9KSxlJiZlLmluc2VydEJlZm9yZShzLGUuZmlyc3RDaGlsZHx8bnVsbCkscy5zZXRBdHRyaWJ1dGUoInJvbGUiLCJwcm9ncmVzc2JhciIpLGkubGluZXMocyxpLm9wdHMpLCFjKXt2YXIgbyxhPTAsbD0obi5saW5lcy0xKSooMS1uLmRpcmVjdGlvbikvMix1PW4uZnBzLGQ9dS9uLnNwZWVkLGg9KDEtbi5vcGFjaXR5KS8oZCpuLnRyYWlsLzEwMCkscD1kL24ubGluZXM7IWZ1bmN0aW9uIGYoKXthKys7Zm9yKHZhciB0PTA7dDxuLmxpbmVzO3QrKylvPU1hdGgubWF4KDEtKGErKG4ubGluZXMtdCkqcCklZCpoLG4ub3BhY2l0eSksaS5vcGFjaXR5KHMsdCpuLmRpcmVjdGlvbitsLG8sbik7aS50aW1lb3V0PWkuZWwmJnNldFRpbWVvdXQoZix+figxZTMvdSkpfSgpfXJldHVybiBpfSxzdG9wOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5lbDtyZXR1cm4gdCYmKGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpLHQucGFyZW50Tm9kZSYmdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHQpLHRoaXMuZWw9dm9pZCAwKSx0aGlzfSxsaW5lczpmdW5jdGlvbihuLHMpe2Z1bmN0aW9uIGEoZSxpKXtyZXR1cm4gcih0KCkse3Bvc2l0aW9uOiJhYnNvbHV0ZSIsd2lkdGg6cy5zY2FsZSoocy5sZW5ndGgrcy53aWR0aCkrInB4IixoZWlnaHQ6cy5zY2FsZSpzLndpZHRoKyJweCIsYmFja2dyb3VuZDplLGJveFNoYWRvdzppLHRyYW5zZm9ybU9yaWdpbjoibGVmdCIsdHJhbnNmb3JtOiJyb3RhdGUoIit+figzNjAvcy5saW5lcyp1K3Mucm90YXRlKSsiZGVnKSB0cmFuc2xhdGUoIitzLnNjYWxlKnMucmFkaXVzKyJweCwwKSIsYm9yZGVyUmFkaXVzOihzLmNvcm5lcnMqcy5zY2FsZSpzLndpZHRoPj4xKSsicHgifSl9Zm9yKHZhciBsLHU9MCxkPShzLmxpbmVzLTEpKigxLXMuZGlyZWN0aW9uKS8yO3U8cy5saW5lczt1KyspbD1yKHQoKSx7cG9zaXRpb246ImFic29sdXRlIix0b3A6MSt+KHMuc2NhbGUqcy53aWR0aC8yKSsicHgiLHRyYW5zZm9ybTpzLmh3YWNjZWw/InRyYW5zbGF0ZTNkKDAsMCwwKSI6IiIsb3BhY2l0eTpzLm9wYWNpdHksYW5pbWF0aW9uOmMmJmkocy5vcGFjaXR5LHMudHJhaWwsZCt1KnMuZGlyZWN0aW9uLHMubGluZXMpKyIgIisxL3Muc3BlZWQrInMgbGluZWFyIGluZmluaXRlIn0pLHMuc2hhZG93JiZlKGwscihhKCIjMDAwIiwiMCAwIDRweCAjMDAwIikse3RvcDoiMnB4In0pKSxlKG4sZShsLGEobyhzLmNvbG9yLHUpLCIwIDAgMXB4IHJnYmEoMCwwLDAsLjEpIikpKTtyZXR1cm4gbn0sb3BhY2l0eTpmdW5jdGlvbih0LGUsaSl7ZTx0LmNoaWxkTm9kZXMubGVuZ3RoJiYodC5jaGlsZE5vZGVzW2VdLnN0eWxlLm9wYWNpdHk9aSl9fSksInVuZGVmaW5lZCIhPXR5cGVvZiBkb2N1bWVudCl7dT1mdW5jdGlvbigpe3ZhciBpPXQoInN0eWxlIix7dHlwZToidGV4dC9jc3MifSk7cmV0dXJuIGUoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImhlYWQiKVswXSxpKSxpLnNoZWV0fHxpLnN0eWxlU2hlZXR9KCk7dmFyIGY9cih0KCJncm91cCIpLHtiZWhhdmlvcjoidXJsKCNkZWZhdWx0I1ZNTCkifSk7IW4oZiwidHJhbnNmb3JtIikmJmYuYWRqP2woKTpjPW4oZiwiYW5pbWF0aW9uIil9cmV0dXJuIGF9KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0NiksaSgxODcpXSxyPWZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKGUsaSl7cmV0dXJuIHQucmVzdWx0Q3R4KGUub3B0aW9ucyxpLGUpfHx0LnJlc3VsdChlLGkpfWZ1bmN0aW9uIHIodCl7dmFyIGU9ImluZm9ib3ggY2xlYXJmaXggaW5mb2JveC0iK24odCwidHlwZSIpO3N3aXRjaChuKHQsInNpemUiKSl7Y2FzZSJzdGFuZGFyZCI6ZSs9IiI7YnJlYWs7Y2FzZSJjb21wYWN0IjplKz0iIGluZm9ib3gtY29tcGFjdCI7YnJlYWs7Y2FzZSJsYXJnZSI6ZSs9IiBpbmZvYm94LW1kIn1yZXR1cm4gbih0LCJkaXNtaXNzaWJsZSIpJiYoZSs9IiBpbmZvYm94LWRpc21pc3MiKSxlfXZhciBzPXsiY2xpY2sgLmluZm9ib3gtZGlzbWlzcy1saW5rIjpmdW5jdGlvbihlKXtlLnByZXZlbnREZWZhdWx0KCksdGhpcy4kZWwuZmFkZU91dChpLlVOTE9BRElOR19GQURFLHQuYmluZCh0aGlzLnJlbW92ZSx0aGlzKSl9fSxvPSdcdCAgICB7eyNpZiBkaXNtaXNzaWJsZX19XHQgICAgICA8YSBjbGFzcz0iaW5mb2JveC1kaXNtaXNzLWxpbmsiIHRpdGxlPSJEaXNtaXNzIiBocmVmPSIjIj5cdCAgICAgICAgPHNwYW4gY2xhc3M9ImRpc21pc3MtaWNvbiI+PC9zcGFuPlx0ICAgICAgPC9hPlx0ICAgIHt7L2lmfX1cdCAgICA8c3BhbiBjbGFzcz0iaWNvbiB7e2ljb259fSI+PC9zcGFuPlx0ICAgIHt7I2lmIHRpdGxlfX08aDM+e3t0aXRsZX19PC9oMz57ey9pZn19XHQgICAge3sjaWYgc3VidGl0bGV9fTxwPnt7c3VidGl0bGV9fTwvcD57ey9pZn19XHQgICAge3sjaWYgYnVsbGV0c319XHQgICAgICA8dWwgY2xhc3M9ImJ1bGxldHMiPlx0ICAgICAge3sjZWFjaCBidWxsZXRzfX08bGk+e3t0aGlzfX08L2xpPnt7L2VhY2h9fVx0ICAgICAgPC91bD5cdCAgICB7ey9pZn19XHQgICcsYT1lLmV4dGVuZCh7Y29udGVudDpudWxsLHNpemU6InN0YW5kYXJkIix0eXBlOiJpbmZvIixkaXNtaXNzaWJsZTohMSx0aXRsZTpudWxsLHN1YnRpdGxlOm51bGwsYnVsbGV0czpudWxsLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dGhpcy5ldmVudHM9dC5kZWZhdWx0cyh0aGlzLmV2ZW50c3x8e30scyksZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy4kZWwuYWRkQ2xhc3Mocih0aGlzKSksdGhpcy50ZW1wbGF0ZT1vO3ZhciBpPW4odGhpcywiY29udGVudCIpO2kmJnRoaXMuYWRkKGkpfSxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXt2YXIgdD1uKHRoaXMsInR5cGUiKTtyZXR1cm4idGlwIj09dCYmKHQ9ImxpZ2h0LWJ1bGIiKSx7aWNvbjp0KyItIisoImxhcmdlIj09bih0aGlzLCJzaXplIik/IjI0IjoiMTYiKSx0aXRsZTpuKHRoaXMsInRpdGxlIiksc3VidGl0bGU6bih0aGlzLCJzdWJ0aXRsZSIpLGJ1bGxldHM6bih0aGlzLCJidWxsZXRzIiksZGlzbWlzc2libGU6bih0aGlzLCJkaXNtaXNzaWJsZSIpfX19KTtyZXR1cm57Y3JlYXRlOmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgYSh0KX19fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTk3KV0scj1mdW5jdGlvbih0KXtyZXR1cm4gdC5leHRlbmQoe3NhdmU6Ik9LIixwYXJhbXM6e21pbldpZHRoOjUwMCxtYXhXaWR0aDo3MDAsY2xvc2U6ITB9LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dC5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5jb250ZW50JiZ0aGlzLmFkZCh0aGlzLmNvbnRlbnQpLHRoaXMubGlzdGVuVG8odGhpcywic2F2ZSIsZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9rfHx0aGlzLm9wdGlvbnMub2s7dCYmdCgpLHRoaXMucmVtb3ZlKCl9KSx0aGlzLmxpc3RlblRvKHRoaXMsImNhbmNlbCIsZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNhbmNlbEZufHx0aGlzLm9wdGlvbnMuY2FuY2VsRm47dCYmdCgpfSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDUpLGkoMTQ2KSxpKDE1NSldLHI9ZnVuY3Rpb24odCxlLGksbil7ZShkb2N1bWVudCkuY2xpY2soZnVuY3Rpb24odCl7dmFyIGk9ZSh0LnRhcmdldCksbj0oaS5oYXNDbGFzcygib3B0aW9uLXNlbGVjdGVkIil8fGkucGFyZW50cygpLmhhc0NsYXNzKCJvcHRpb24tc2VsZWN0ZWQiKSkmJmkuY2xvc2VzdCgiLmRyb3Bkb3duIikubGVuZ3RoPjA7bnx8ZSgiLmRyb3Bkb3duIC5vcHRpb25zIikuZmFkZU91dCgxMDApfSk7dmFyIHI9aS5leHRlbmQoe3RhZ05hbWU6ImxpIix0ZW1wbGF0ZTonXHQgICAgICA8YSBjbGFzcz0iaWNvbi0xNnt7I3VubGVzcyBpY29ufX0gbm8taWNvbnt7L3VubGVzc319Int7I2lmIHNlbGVuaXVtSWR9fSBkYXRhLXNlPSJ7e3NlbGVuaXVtSWR9fSJ7ey9pZn19Plx0ICAgICAgICB7eyNpZiBpY29ufX08c3BhbiBjbGFzcz0iaWNvbiB7e2ljb259fSI+PC9zcGFuPnt7L2lmfX1cdCAgICAgICAgPHAgY2xhc3M9e3sjaWYgdGl0bGV9fSJvcHRpb24tdGl0bGUie3tlbHNlfX0ibm8tdGl0bGUie3svaWZ9fT57e3RpdGxlfX08L3A+XHQgICAgICAgIHt7I2lmIHN1YnRpdGxlfX08cCBjbGFzcz0ib3B0aW9uLXN1YnRpdGxlIj57e3N1YnRpdGxlfX08L3A+e3svaWZ9fVx0ICAgICAgPC9hPlx0ICAgICcsY2xhc3NOYW1lOiJva3RhLWRyb3Bkb3duLW9wdGlvbiBvcHRpb24iLGV2ZW50czp7Y2xpY2s6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuJGVsLmhhc0NsYXNzKCJvcHRpb24tZGlzYWJsZWQiKT90LnN0b3BQcm9wYWdhdGlvbigpOnRoaXMub3B0aW9ucy5jbGljayYmdGhpcy5vcHRpb25zLmNsaWNrLmNhbGwodGhpcyl9fSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7bi5hcHBseURvV2hlbih0aGlzLHQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucywiZW5hYmxlV2hlbiIsdGhpcyksdGhpcy50b2dnbGVFbmFibGVkKSxuLmFwcGx5RG9XaGVuKHRoaXMsdC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLCJzaG93V2hlbiIsdGhpcyksdGhpcy50b2dnbGVWaXNpYmxlKX0scG9zdFJlbmRlcjpmdW5jdGlvbigpe3Quc2l6ZSh0LnJlc3VsdEN0eCh0aGlzLm9wdGlvbnMsImVuYWJsZVdoZW4iLHRoaXMpKXx8dGhpcy50b2dnbGVFbmFibGVkKCEwKSx0LnNpemUodC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLCJzaG93V2hlbiIsdGhpcykpfHx0aGlzLnRvZ2dsZVZpc2libGUoITApfSxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXtyZXR1cm57aWNvbjp0LnJlc3VsdEN0eCh0aGlzLm9wdGlvbnMsImljb24iLHRoaXMpLHRpdGxlOnQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucywidGl0bGUiLHRoaXMpLHN1YnRpdGxlOnQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucywic3VidGl0bGUiLHRoaXMpLHNlbGVuaXVtSWQ6dC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLCJzZWxlbml1bUlkIix0aGlzKX19LHRvZ2dsZUVuYWJsZWQ6ZnVuY3Rpb24oZSl7dmFyIGk9ZSYmdC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLCJlbmFibGVkIix0aGlzKTt0aGlzLiRlbC50b2dnbGVDbGFzcygib3B0aW9uLWRpc2FibGVkIiwhaSl9LHRvZ2dsZVZpc2libGU6ZnVuY3Rpb24oZSl7dmFyIGk9ZSYmdC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLCJ2aXNpYmxlIix0aGlzKTt0aGlzLiRlbC50b2dnbGVDbGFzcygib3B0aW9uLWhpZGRlbiIsIWkpfX0pLHM9eyJjbGljayBhLm9wdGlvbi1zZWxlY3RlZCI6ZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpLHQucmVzdWx0KHRoaXMsImRpc2FibGVkIik/ZS5zdG9wUHJvcGFnYXRpb24oKTp0aGlzLiQoImRpdi5vcHRpb25zIikudG9nZ2xlKCl9LCJjbGljayAuZHJvcGRvd24tZGlzYWJsZWQiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpfX0sbz1bImljb24iLCJ0aXRsZSIsInN1YnRpdGxlIiwiY2xpY2siLCJlbmFibGVXaGVuIiwic2hvd1doZW4iLCJlbmFibGVkIiwidmlzaWJsZSIsImF0dHJpYnV0ZXMiLCJzZWxlbml1bUlkIl07cmV0dXJuIGkuZXh0ZW5kKHtpdGVtczpbXSxpdGVtV2lkdGg6bnVsbCx3aWR0aDpudWxsLGljb246bnVsbCx0aXRsZTpudWxsLGRpc2FibGVkOiExLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dGhpcy5ldmVudHM9dC5kZWZhdWx0cyh0aGlzLmV2ZW50c3x8e30scyk7dmFyIGU9dGhpcy5jbGFzc05hbWU7dGhpcy5jbGFzc05hbWU9bnVsbCx0aGlzLnBvc3RSZW5kZXI9dC53cmFwKHRoaXMucG9zdFJlbmRlcix0LmJpbmQoZnVuY3Rpb24oZSl7dmFyIGk9dC5yZXN1bHQodGhpcywiaXRlbVdpZHRoIik7aSYmdGhpcy4kKCJ1bC5vcHRpb25zLXdyYXAiKS53aWR0aChpKTt2YXIgbj10LnJlc3VsdCh0aGlzLCJ3aWR0aCIpO24mJnRoaXMuJCgiYS5vcHRpb24tc2VsZWN0ZWQiKS53aWR0aChuLTMwKSx0LnJlc3VsdCh0aGlzLCJkaXNhYmxlZCIpJiZ0aGlzLmRpc2FibGUoKSxlLmNhbGwodGhpcyl9LHRoaXMpKSxpLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmNsYXNzTmFtZT1lLHRoaXMuJGVsLmFkZENsYXNzKCJkcm9wZG93biBtb3JlLWFjdGlvbnMgZmxvYXQtbCIpLHQuZWFjaCh0LnJlc3VsdCh0aGlzLCJpdGVtcyIpfHxbXSxmdW5jdGlvbih0KXt0aGlzLmFkZEl0ZW0odCx0aGlzLm9wdGlvbnMpfSx0aGlzKX0sdGVtcGxhdGU6J1x0ICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9ImxpbmstYnV0dG9uIGxpbmstYnV0dG9uLWljb24gb3B0aW9uLXNlbGVjdGVkIGNlbnRlciB7e2NsYXNzTmFtZX19Ij5cdCAgICAgICAge3sjaWYgaWNvbn19PHNwYW4gY2xhc3M9Imljb24ge3tpY29ufX0iPjwvc3Bhbj57ey9pZn19XHQgICAgICAgIHt7I2lmIHRpdGxlfX08c3BhbiBjbGFzcz0ib3B0aW9uLXNlbGVjdGVkLXRleHQiPnt7dGl0bGV9fTwvc3Bhbj57ey9pZn19XHQgICAgICAgIDxzcGFuIGNsYXNzPSJpY29uLWRtIj48L3NwYW4+XHQgICAgICA8L2E+XHQgICAgICA8ZGl2IGNsYXNzPSJvcHRpb25zIGNsZWFyZml4Ij5cdCAgICAgICAgPHVsIGNsYXNzPSJva3RhLWRyb3Bkb3duLWxpc3Qgb3B0aW9ucy13cmFwIGNsZWFyZml4Ij48L3VsPlx0ICAgICAgPC9kaXY+XHQgICAgJyxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXtyZXR1cm57aWNvbjp0LnJlc3VsdCh0aGlzLCJpY29uIiksY2xhc3NOYW1lOnQucmVzdWx0KHRoaXMsImNsYXNzTmFtZSIpfHwiIix0aXRsZTp0LnJlc3VsdCh0aGlzLCJ0aXRsZSIpfX0sZGlzYWJsZTpmdW5jdGlvbigpe3RoaXMuJCgiLm9wdGlvbi1zZWxlY3RlZCIpLmFkZENsYXNzKCJkcm9wZG93bi1kaXNhYmxlZCIpfSxlbmFibGU6ZnVuY3Rpb24oKXt0aGlzLiQoIi5vcHRpb24tc2VsZWN0ZWQiKS5yZW1vdmVDbGFzcygiZHJvcGRvd24tZGlzYWJsZWQiKX0sYWRkSXRlbTpmdW5jdGlvbihlKXtyZXR1cm4gZT10LnBpY2soZXx8e30sbyksdC5kZWZhdWx0cyhlLHt2aXNpYmxlOiEwLGVuYWJsZWQ6ITB9KSx0aGlzLmFkZChyLCJ1bC5vcHRpb25zLXdyYXAiLHtvcHRpb25zOmV9KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoNSksaSgyMzcpLGkoMTcyKSxpKDI0NildLHI9ZnVuY3Rpb24odCxlLGksbixyKXt2YXIgcz1mdW5jdGlvbigpe2Z1bmN0aW9uIGkodCxpLG4pe3ZhciBzLG8sYT1lKHQpLmZpbmQoaSk7aWYoYSlyZXR1cm4gcz1hLm91dGVySGVpZ2h0KCEwKS1hLmhlaWdodCgpLG89cihhLnNpYmxpbmdzKCkpK3Msbi1vfWZ1bmN0aW9uIG4oKXtyZXR1cm4gZSgiYm9keSIpLmFwcGVuZChhKSxlKCIubW9kYWwtc3RhZ2luZyIpfWZ1bmN0aW9uIHIoaSl7cmV0dXJuIHQucmVkdWNlKGksZnVuY3Rpb24odCxpKXtyZXR1cm4gdCtlKGkpLm91dGVySGVpZ2h0KCEwKX0sMCl9ZnVuY3Rpb24gcyh0LGUpe298fChvPW4oKSksby5odG1sKHQpO3ZhciBpPWUobyk7cmV0dXJuIG8uZW1wdHkoKSxpfXZhciBvLGE9JzxkaXYgY2xhc3M9Im1vZGFsLXN0YWdpbmcgc2ltcGxlbW9kYWwtd3JhcCIgc3R5bGU9InZpc2liaWxpdHk6IGhpZGRlbjsgcG9zaXRpb246IGFic29sdXRlOyI+PC9kaXY+JztyZXR1cm57bWVhc3VyZTpmdW5jdGlvbih0KXtyZXR1cm4gcyh0LGZ1bmN0aW9uKHQpe3JldHVybiB0LmhlaWdodCgpfSl9LGZpdDpmdW5jdGlvbih0LGUsbil7cmV0dXJuIHModCxmdW5jdGlvbih0KXtyZXR1cm4gaSh0LGUsbil9KX0scmVtb3ZlOmZ1bmN0aW9uKCl7byYmby5yZW1vdmUoKSxvPXZvaWQgMH19fSgpLG89e21pbldpZHRoOjYwMCxtYXhXaWR0aDo5NTAsYXV0b1Jlc2l6ZTohMSxhdXRvUG9zaXRpb246ITB9O3JldHVybiBpLmV4dGVuZCh7cmVzaXplT25Td2l0Y2g6ITEsY29uc3RydWN0b3I6ZnVuY3Rpb24oZSl7aWYodC5kZWZhdWx0cyh0aGlzLnBhcmFtcyxvKSxpLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxlfHwoZT17fSksdC5leHRlbmQodGhpcyx0LnBpY2soZSwiVmlldyIsImhlaWdodCIsInJlc2l6ZU9uU3dpdGNoIikpLCF0aGlzLlZpZXcpdGhyb3cgbmV3IEVycm9yKCJUaGUgTXVsdGlWaWV3TW9kYWxEaWFsb2cgbXVzdCBiZSBwcm92aWRlZCBhIFZpZXcgd2hlbiBpbml0aWFsaXplZCIpO3RoaXMuX3ByZWZldGNoRGV0ZWN0aW9uKGUsITEpLHRoaXMuU3RhZ2U9c30scmVuZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIGkucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5fc2V0SGVpZ2h0KCksdGhpcy5fc2V0Q29udGVudEhlaWdodCgpLHRoaXN9LHJlbW92ZTpmdW5jdGlvbigpe3MucmVtb3ZlKCksaS5wcm90b3R5cGUucmVtb3ZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sc3dpdGNoVmlldzpmdW5jdGlvbihlLGkpe2l8fChpPXt9KSxpPXQuY2xvbmUodC5leHRlbmQoaSx7Y3VycmVudFZpZXdIZWlnaHQ6dGhpcy5oZWlnaHR9KSksdC5leHRlbmQodGhpcyx0LnBpY2soaSwiaGVpZ2h0Iikse1ZpZXc6ZX0pLHRoaXMuX3ByZWZldGNoRGV0ZWN0aW9uKGksITApfSx1cGRhdGVUaXRsZTpmdW5jdGlvbihlKXtlPWV8fHRoaXMuY3VycmVudFZpZXcudGl0bGUsZSYmKHQuaXNGdW5jdGlvbihlKSYmKGU9ZS5jYWxsKHRoaXMpKSx0aGlzLnJlbmRlcmVkKCk/KHRoaXMuJCgiaDIuYmxvY2siKS5odG1sKGUpLHRoaXMuY3VycmVudFZpZXcuJCgiaDIub2t0YS1mb3JtLXRpdGxlIikucmVtb3ZlKCkpOih0aGlzLnRpdGxlPWUsdGhpcy5jdXJyZW50Vmlldy50aXRsZT0iIikpfSxfYWRkVmlldzpmdW5jdGlvbihlLGkpe3RoaXMuY3VycmVudFZpZXcmJnRoaXMuY3VycmVudFZpZXcucmVtb3ZlKCksdGhpcy5jdXJyZW50Vmlldz10aGlzLmFkZChlKS5hdCgwKSx0aGlzLnJlc2l6ZVNlbGVjdG9yPXRoaXMuY3VycmVudFZpZXcucmVzaXplU2VsZWN0b3J8fHRoaXMuY3VycmVudFZpZXcuZWwsdGhpcy51cGRhdGVUaXRsZShpLnRpdGxlKSx0aGlzLmxpc3RlblRvKHRoaXMuY3VycmVudFZpZXcsInJlc2l6ZSIsdC5kZWJvdW5jZSh0LmJpbmQodGhpcy5fc2V0Q29udGVudEhlaWdodCx0aGlzKSwxMDApKX0sX2FkZFNjcm9sbGJhcnM6ZnVuY3Rpb24odCxlKXt0LmhlaWdodChlKSx0LmNzcygib3ZlcmZsb3ciLCJhdXRvIil9LF9nZXRNYXhIZWlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5yb3VuZCguOSplKHdpbmRvdykuaGVpZ2h0KCkpfSxfc2V0Q29udGVudEhlaWdodDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuY3VycmVudFZpZXcsZT10LiQodGhpcy5yZXNpemVTZWxlY3RvciksaT1zLmZpdCh0LiRlbC5odG1sKCksdGhpcy5yZXNpemVTZWxlY3Rvcix0aGlzLmhlaWdodCk7ZS5oZWlnaHQoKSE9PWkmJmkmJih0aGlzLl9hZGRTY3JvbGxiYXJzKGUsaSksdGhpcy5yZXNpemUoKSl9LF9zZXRIZWlnaHQ6ZnVuY3Rpb24odCl7dmFyIGUsaSxuPXRoaXMuX2dldE1heEhlaWdodCgpLHI9dD92b2lkIDA6dGhpcy5oZWlnaHQ7cmV0dXJuIHI+bj92b2lkKHRoaXMuaGVpZ2h0PW4pOihpPXMuZml0KHRoaXMuJGVsLmh0bWwoKSx0aGlzLmN1cnJlbnRWaWV3LnJlc2l6ZVNlbGVjdG9yLHIpLHZvaWQoaT4yMHx8KGU9cy5tZWFzdXJlKHRoaXMuJGVsLmh0bWwoKSksdGhpcy5oZWlnaHQ9TWF0aC5taW4oZSxuKSkpKX0sX29uUHJlZmV0Y2hTdWNjZXNzOmZ1bmN0aW9uKGUsaSxyKXt2YXIgcz0hIXRoaXMuY3VycmVudFZpZXc7cmV0dXJuIHRoaXMuX3NwaW5uZXJIaWRlKCksdGhpcy5fYWRkVmlldyhlLGkpLCEoIXImJiFzKSYmKCFyJiZzP3RoaXMuX3Jlc2l6ZURpYWxvZyh7aGVpZ2h0OmkuaGVpZ2h0LHRyYW5zaXRpb246bi5FRkZFQ1RTLk5PTkV9KTp0aGlzLl9yZXNpemVEaWFsb2coaSksdm9pZCh0LmlzRnVuY3Rpb24oaS5wb3N0ZmV0Y2gpP3QuZGVmZXIoaS5wb3N0ZmV0Y2gpOnQuaXNGdW5jdGlvbihlLnBvc3RmZXRjaCkmJnQuZGVmZXIodC5iaW5kKGUucG9zdGZldGNoLGUpKSkpfSxfcmVzaXplRGlhbG9nOmZ1bmN0aW9uKHQpe3QuaGVpZ2h0P3RoaXMuX3NldEhlaWdodCgpOnRoaXMucmVzaXplT25Td2l0Y2gmJnRoaXMuX3NldEhlaWdodCghMCksdGhpcy5fc2V0Q29udGVudEhlaWdodCgpLG4uYW5pbWF0ZSh0aGlzLmN1cnJlbnRWaWV3LiRlbCx0LnRyYW5zaXRpb258fG4uRUZGRUNUUy5TTElERSl9LF9nZXRJbnN0YW50aWF0ZWRWaWV3OmZ1bmN0aW9uKGUpe3JldHVybiB0LmlzRnVuY3Rpb24oZSk/bmV3IGUodGhpcy5vcHRpb25zKTplfSxfcHJlZmV0Y2hFcnJvcjpmdW5jdGlvbih0KXt0aGlzLmhlaWdodD10LmN1cnJlbnRWaWV3SGVpZ2h0fHx0aGlzLmhlaWdodCx0aGlzLl9zZXRIZWlnaHQoKSx0aGlzLl9zZXRDb250ZW50SGVpZ2h0KCksdGhpcy5fc3Bpbm5lckhpZGUoKX0sX3NwaW5uZXJTaG93OmZ1bmN0aW9uKHQpe3RoaXMuY3VycmVudFZpZXc/KHRoaXMuc3Bpbm5lclZpZXc9bmV3IHIoe2VsVG9BdHRhY2hUbzp0aGlzLmN1cnJlbnRWaWV3LiQodGhpcy5yZXNpemVTZWxlY3Rvcil9KSx0aGlzLmFkZCh0aGlzLnNwaW5uZXJWaWV3KSk6dGhpcy5fYWRkVmlldyhuZXcgcih7aGVpZ2h0OnRoaXMuaGVpZ2h0fSkse3RpdGxlOnQudGl0bGV9KX0sX3NwaW5uZXJIaWRlOmZ1bmN0aW9uKCl7dGhpcy5zcGlubmVyVmlldyYmdGhpcy5zcGlubmVyVmlldy5yZW1vdmUoKX0sX2dldFByZWZldGNoRnVuY3Rpb246ZnVuY3Rpb24oZSxpKXt2YXIgbj10LmlzVW5kZWZpbmVkKGkucHJlZmV0Y2gpP2UucHJlZmV0Y2g6aS5wcmVmZXRjaDtyZXR1cm4hIW4mJih0LmlzRnVuY3Rpb24oaS5wcmVmZXRjaCk/aS5wcmVmZXRjaDp0LmlzRnVuY3Rpb24oZS5wcmVmZXRjaCk/dC5iaW5kKGUucHJlZmV0Y2gsZSk6dC5iaW5kKGUubW9kZWwuZmV0Y2gsZS5tb2RlbCkpfSxfcHJlZmV0Y2hEZXRlY3Rpb246ZnVuY3Rpb24oaSxuKXt2YXIgcj10aGlzLHM9dGhpcy5fZ2V0SW5zdGFudGlhdGVkVmlldyh0aGlzLlZpZXcpLG89dC5iaW5kKHRoaXMuX29uUHJlZmV0Y2hTdWNjZXNzLHRoaXMscyxpLG4pLGE9dGhpcy5fZ2V0UHJlZmV0Y2hGdW5jdGlvbihzLGkpO2E/KHRoaXMuX3NwaW5uZXJTaG93KHMpLGUud2hlbihhKCkpLmRvbmUobykuZmFpbChmdW5jdGlvbigpe3IuX3ByZWZldGNoRXJyb3IoaSl9KSk6bygpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgyMzkpLGkoMTQ2KV0scj1mdW5jdGlvbih0LGUsaSl7dmFyIG49MjA7cmV0dXJuIGkuZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5faW5pdGlhbFN0eWxlKHRoaXMub3B0aW9ucyl9LHBvc3RSZW5kZXI6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9nZXRQb3NpdGlvbigpO2UubGVmdDwwP3QuZGVsYXkodC5iaW5kKHRoaXMuc2hvd1NwaW5uZXIsdGhpcyksMjAwKTp0aGlzLnNob3dTcGlubmVyKCl9LHNob3dTcGlubmVyOmZ1bmN0aW9uKCl7dGhpcy5zcGlubmVyJiZ0aGlzLnNwaW5uZXIucmVtb3ZlKCk7dmFyIHQsaT10aGlzLl9nZXRQb3NpdGlvbigpO3RoaXMub3B0aW9ucy5lbFRvQXR0YWNoVG8mJnRoaXMuJGVsLmNzcyh7cG9zaXRpb246ImFic29sdXRlIn0pLHQ9ZS5leHRlbmQoe3NwaW5BdFJlbmRlcjohMCxzcGluT3B0aW9uczp7bGVmdDppLmxlZnQsdG9wOmkudG9wfX0pLHRoaXMuc3Bpbm5lcj1uZXcgdCx0aGlzLmFkZCh0aGlzLnNwaW5uZXIpfSxfaW5pdGlhbFN0eWxlOmZ1bmN0aW9uKGUpe3ZhciBpPXt9O2lmKGUuZWxUb0F0dGFjaFRvKXt2YXIgbj1lLmVsVG9BdHRhY2hUby5wb3NpdGlvbigpO2kud2lkdGg9ZS5lbFRvQXR0YWNoVG8ub3V0ZXJXaWR0aCgpLGkuaGVpZ2h0PWUuZWxUb0F0dGFjaFRvLm91dGVySGVpZ2h0KCksbiYmKGkudG9wPW4udG9wKX10LmV4dGVuZChpLHQucGljayhlLCJoZWlnaHQiLCJ3aWR0aCIpKSx0aGlzLiRlbC5jc3MoaSl9LF9nZXRQb3NpdGlvbjpmdW5jdGlvbigpe3JldHVybntsZWZ0OnRoaXMuJGVsLm91dGVyV2lkdGgoKS8yLW4sdG9wOnRoaXMuJGVsLm91dGVySGVpZ2h0KCkvMi1ufX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDI0OSksaSgyNjMpLGkoMjUyKSxpKDI1MSksaSgyNjQpLGkoMjUwKSxpKDI2MCksaSgyNjEpLGkoMjY2KSxpKDI0OCksaSgyNTYpLGkoMjU4KSxpKDI2NSksaSgyNTcpLGkoMjYyKSxpKDI1MyksaSgyNTkpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSxsLGMsdSxkLGgscCxmLG0sXyl7cmV0dXJue0NvbnRlbnQ6dCxEYXRhTGlzdDplLERlYWRTaW1wbGVEYXRhTGlzdDppLEVtcHR5Om4sRm9vdGVyOnIsTG9hZGluZzpzLFNpZGViYXI6byxTaWRlYmFyRmlsdGVyU2V0OmEsU2ltcGxlRGF0YUxpc3Q6bCxUYWJsZTpjLFRvb2xCYXI6dSxjb21wb25lbnRzOntMZXR0ZXJzTmF2OmQsTG9hZE1vcmU6aCxTZWFyY2hCb3g6cCxTaWRlYmFyRmlsdGVyOmZ9LHV0aWw6e0RhdGFsaXN0RmFjdG9yeTptLEZpbHRlckZhY3Rvcnk6X319fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSl7fSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ2KSxpKDI1MCksaSgyNTEpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3JldHVybiBlLmV4dGVuZCh7RW1wdHk6bnVsbCxMb2FkaW5nOm51bGwsdGVtcGxhdGU6JzxkaXYgY2xhc3M9ImRhdGEtbGlzdC1jb250ZW50IiBkYXRhLXNlPSJkYXRhLWxpc3QtY29udGVudCI+PC9kaXY+Jyxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe2lmKGUuYXBwbHkodGhpcyxhcmd1bWVudHMpLCF0aGlzLmNvbGxlY3Rpb24pdGhyb3cgbmV3IEVycm9yKCJNaXNzaW5nIEFyZ3VtZW50czogY29sbGVjdGlvbiIpO3RoaXMuVG9vbGJhciYmdGhpcy5hZGQodGhpcy5Ub29sYmFyLHtwcmVwZW5kOiEwfSksdGhpcy5NYWluJiZ0aGlzLmFkZCh0aGlzLk1haW4pO3ZhciB0PXRoaXMuRW1wdHl8fG4scj10aGlzLkxvYWRpbmd8fGk7dGhpcy5hZGQodCksdGhpcy5hZGQociksdGhpcy4kZWwuYWRkQ2xhc3MoImRhdGEtbGlzdC1jb250ZW50LXdyYXAiKSx0aGlzLiRlbC5hdHRyKCJkYXRhLXNlIiwiZGF0YS1saXN0LWNvbnRlbnQtd3JhcCIpfSxhZGQ6ZnVuY3Rpb24oKXt2YXIgaT10LnRvQXJyYXkoYXJndW1lbnRzKTtyZXR1cm4idW5kZWZpbmVkIj09dHlwZW9mIGlbMV0mJihpWzFdPSIuZGF0YS1saXN0LWNvbnRlbnQiKSxlLnByb3RvdHlwZS5hZGQuYXBwbHkodGhpcyxpKX0saGVpZ2h0OmZ1bmN0aW9uKHQpe3JldHVybiB0P3ZvaWQgdGhpcy4kKCIuZGF0YS1saXN0LWNvbnRlbnQiKS5jc3MoIm1pbi1oZWlnaHQiLHQpOnRoaXMuJGVsLmhlaWdodCgpfSx0eXBlOiJjb250ZW50In0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMjM5KV0scj1mdW5jdGlvbih0KXtyZXR1cm4gdC5leHRlbmQoe2NsYXNzTmFtZToiZGF0YS1saXN0LWxvYWQtd3JhcCIsdHlwZToibG9hZGluZyIsdGVtcGxhdGU6J1x0ICAgICAgPGRpdiBjbGFzcz0iZGF0YS1saXN0LWxvYWQtbWFzayI+PC9kaXY+XHQgICAgICA8aDQgY2xhc3M9ImRhdGEtbGlzdC1oZWFkIj5Mb2FkaW5nLi4uPC9oND5cdCAgICAnLHNwaW5PcHRpb25zOntjbGFzc05hbWU6ImRhdGEtbGlzdC1zcGlubmVyIn0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3QucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCJyZXF1ZXN0Iix0aGlzLnNwaW4pLHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCJzeW5jIGVycm9yIix0aGlzLmVtcHR5KX0sc3BpbjpmdW5jdGlvbihlKXtlPT09dGhpcy5jb2xsZWN0aW9uJiZ0LnByb3RvdHlwZS5zcGluLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ3KSxpKDE0NiksaSgxNzcpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe2Z1bmN0aW9uIHIoZSxpKXtyZXR1cm4gZS5zdGF0ZS5nZXQoImVtcHR5LmVzY2FwZSIpPT09ITF8fHQucmVzdWx0KGUsImVzY2FwZSIpPT09ITE/aTp0LmVzY2FwZShpKX1yZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToiZGF0YS1saXN0LWVtcHR5LW1zZyIsdHlwZToiZW1wdHkiLGVzY2FwZTohMCx0aXRsZTp2b2lkIDAsc3VidGl0bGU6dm9pZCAwLHRlbXBsYXRlOidcdCAgICAgIDxwIGNsYXNzPSJkYXRhLWxpc3QtZW1wdHktYmluYXJ5Ij5cdCAgICAgICAgMDExMDExMTAwMTEwMTExMTAxMTEwMTAwMDExMDEwMDAwMTEwMTAwMTAxMTAxMTEwMDExMDAxMTFcdCAgICAgICAgPHNwYW4gY2xhc3M9ImRhdGEtbGlzdC1lbXB0eS1pbWciPjwvc3Bhbj5cdCAgICAgIDwvcD5cdCAgICAgIDxoNCBjbGFzcz0iZGF0YS1saXN0LWhlYWQgZGF0YS1saXN0LWVtcHR5LWhlYWQiPnt7dGl0bGV9fTwvaDQ+XHQgICAgICA8aDUgY2xhc3M9ImRhdGEtbGlzdC1oZWFkIGRhdGEtbGlzdC1lbXB0eS1oZWFkIGRhdGEtbGlzdC1lbXB0eS1zdWJoZWFkIj57e3tzdWJ0aXRsZX19fTwvaDU+XHQgICAgJyxjb25zdHJ1Y3RvcjpmdW5jdGlvbihuKXt2YXIgcj1uJiZuLnRlbXBsYXRlfHx0aGlzLnRlbXBsYXRlO3RoaXMuX190ZW1wbGF0ZT10LmlzU3RyaW5nKHIpP2UudHBsKHIpOnIsaS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIHM9dGhpcy5vcHRpb25zLmRlYm91bmNlVGltZXx8MjAwLG89cysxMDt0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwic3luYyBhZGQgcmVtb3ZlIHJlc2V0Iix0LmRlYm91bmNlKHRoaXMudG9nZ2xlLHMpKSx0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwiZXJyb3IiLHQuZGVib3VuY2UodGhpcy5fc2hvd0Vycm9yLG8pKSx0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwicmVxdWVzdCIsdGhpcy5lbXB0eSl9LF9zaG93RXJyb3I6ZnVuY3Rpb24oZSxpLHIpe2lmKGU9PT10aGlzLmNvbGxlY3Rpb24pe2lmKCF0LmlzU3RyaW5nKHIpKXRyeXt2YXIgcz1pLnJlc3BvbnNlSlNPTnx8SlNPTi5wYXJzZShpLnJlc3BvbnNlVGV4dCk7cj1zLmVycm9yU3VtbWFyeX1jYXRjaChvKXt9dGhpcy5fX2RvUmVuZGVyKG4ubG9jYWxpemUoImRhdGFsaXN0LmVycm9yX3RpdGxlIiksdC5pc1N0cmluZyhyKT9yOm4ubG9jYWxpemUoImRhdGFsaXN0LmVycm9yX3N1YnRpdGxlIikpfX0scmVuZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LF9fZG9SZW5kZXI6ZnVuY3Rpb24odCxlKXt0aGlzLiRlbC5odG1sKHRoaXMuX190ZW1wbGF0ZSh7dGl0bGU6dCxzdWJ0aXRsZTpyKHRoaXMsZSl9KSkuc2hvdygpfSxfX2dldFZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBpPXQucmVzdWx0KHRoaXMsZSk7cmV0dXJuIGk9PT0hMT8iIjp0aGlzLnN0YXRlLmdldCgiZW1wdHkuIitlKXx8aXx8bi5sb2NhbGl6ZSgiZGF0YWxpc3QuZW1wdHlfIitlKX0saXNFbXB0eVN0YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmNvbGxlY3Rpb24uc2l6ZSgpfSx0b2dnbGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0VtcHR5U3RhdGUoKT90aGlzLl9fZG9SZW5kZXIodGhpcy5fX2dldFZhbHVlKCJ0aXRsZSIpLHRoaXMuX19nZXRWYWx1ZSgic3VidGl0bGUiKSk6dGhpcy5lbXB0eSgpLHRoaXN9LGVtcHR5OmZ1bmN0aW9uKCl7dGhpcy4kZWwuZW1wdHkoKS5oaWRlKCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDI1MyksaSgyNTUpLGkoMjU5KSxpKDI2MyksaSgyNDkpLGkoMjQ4KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvKXtmdW5jdGlvbiBhKGUsaSxuKXt0LmlzVW5kZWZpbmVkKG4pJiYobj10aGlzW2VdLmxlbmd0aCksdGhpc1tlXS5zcGxpY2UobiwwLGkpfXJldHVybiByLmV4dGVuZCh7YXR0cmlidXRlczp7ImRhdGEtc2UiOiJkYXRhLWxpc3QifSxlbXB0eVN0YXRlOnt0aXRsZTp2b2lkIDAsc3VidGl0bGU6dm9pZCAwLGVzY2FwZTp2b2lkIDB9LGNvbHVtbnM6W10sdG9vbGJhcjpbXSxpbm5lclRvb2xiYXI6ITEsZmlsdGVyczpbXSxhZGRDb2x1bW46dC5wYXJ0aWFsKGEsIl9fY29sdW1ucyIpLGFkZFRvb2xiYXJDb21wb25lbnQ6dC5wYXJ0aWFsKGEsIl9fdG9vbGJhciIpLGFkZEZpbHRlclNldDp0LnBhcnRpYWwoYSwiX19maWx0ZXJzIiksX19wcm9jZXNzQWN0aW9uczpmdW5jdGlvbihpKXtpZighdC5pc09iamVjdChpKXx8dC5pc0FycmF5KGkpKXJldHVybiBpO3ZhciBuPXQub21pdChpLCJhY3Rpb25zIikscj10LnBpY2soaSwiZHJvcGRvd24iLCJ0aHJlc2hvbGQiKTtyZXR1cm4gaS5hY3Rpb25zJiYobi52aWV3PWUuY3JlYXRlQWN0aW9ucyh0LnJlc3VsdChpLCJhY3Rpb25zIikscikpLG59LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dGhpcy5fX3Rvb2xiYXI9dC5jbG9uZSh0aGlzLnRvb2xiYXJ8fFtdKSx0aGlzLl9fZmlsdGVycz10LmNsb25lKHRoaXMuZmlsdGVyc3x8W10pLHRoaXMuX19jb2x1bW5zPXQuY2xvbmUodGhpcy5jb2x1bW5zfHxbXSksci5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHJlbmRlcjpmdW5jdGlvbigpe3RoaXMucmVtb3ZlQ2hpbGRyZW4oKSx0aGlzLl9fdG9vbGJhci5sZW5ndGgmJih0aGlzLlRvb2xiYXI9aS5jcmVhdGVUb29sYmFyKHRoaXMuX190b29sYmFyKSksdGhpcy5Ub29sYmFyJiYhdGhpcy5pbm5lclRvb2xiYXImJnRoaXMuVG9vbGJhciYmdGhpcy5hZGQodGhpcy5Ub29sYmFyKSx0aGlzLl9fZmlsdGVycy5sZW5ndGgmJih0aGlzLlNpZGViYXI9bi5jcmVhdGVGaWx0ZXJzKHRoaXMuX19maWx0ZXJzKSksdGhpcy5TaWRlYmFyJiZ0aGlzLmFkZCh0aGlzLlNpZGViYXIpO3ZhciBhPXQubWFwKHRoaXMuX19jb2x1bW5zLHRoaXMuX19wcm9jZXNzQWN0aW9ucyk7cmV0dXJuIHRoaXMuYWRkKHMuZXh0ZW5kKHtUb29sYmFyOnRoaXMuaW5uZXJUb29sYmFyJiZ0aGlzLlRvb2xiYXIsTWFpbjpvLmV4dGVuZCh7YXR0cmlidXRlczp7ImRhdGEtc2UiOiJkYXRhLWxpc3QtdGFibGUifSxjb2x1bW5zOmEsaXRlbTp0aGlzLml0ZW0saGVhZGVyOnRoaXMuaGVhZGVyLGNhcHRpb246dGhpcy5jYXB0aW9uLGZvb3Rlcjp0aGlzLmZvb3Rlcn0pLEVtcHR5OnRoaXMuRW1wdHl8fGUuY3JlYXRlRW1wdHlWaWV3KHRoaXMuZW1wdHlTdGF0ZSksTG9hZGluZzp0aGlzLkxvYWRpbmd9KSksci5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDEpLGkoMjUxKSxpKDI1NCldLHI9ZnVuY3Rpb24odCxlLGksbil7cmV0dXJue2NyZWF0ZUhlYWRlcjpmdW5jdGlvbigpe3JldHVybiBlLmNyZWF0ZUhlYWRlci5hcHBseShlLGFyZ3VtZW50cyl9LGNyZWF0ZVJvdzpmdW5jdGlvbigpe3JldHVybiBlLmNyZWF0ZVJvdy5hcHBseShlLGFyZ3VtZW50cyl9LGNyZWF0ZUFjdGlvbnM6ZnVuY3Rpb24oZSxpKXtpZihpPWl8fHt9LCF0LmlzQXJyYXkoZSl8fCFlLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoZSsiIGhhcyB0byBiZSBhIG5vbi1lbXB0eSBhcnJheS4iKTtyZXR1cm4gaS5hY3Rpb25PcHRpb25zPXQubWFwKGUsdC5jbG9uZSksbi5leHRlbmQoaSl9LGNyZWF0ZUVtcHR5VmlldzpmdW5jdGlvbihlKXtyZXR1cm4gaS5leHRlbmQodC5jbG9uZShlKXx8e30pfX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE1MyksaSgxNDYpLGkoMTM5KSxpKDE3NyldLHI9ZnVuY3Rpb24odCxlLGksbixyKXtyZXR1cm4gaS5leHRlbmQoe2FjdGlvbk9wdGlvbnM6W10sdGl0bGU6ci5sb2NhbGl6ZSgiZGF0YWxpc3QuY29sdW1uLmFjdGlvbnMuZGVmYXVsdC50aXRsZSIpLHRocmVzaG9sZDoyLF9fY291bnRWaXNpYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIHQuZmlsdGVyKHRoaXMuYWN0aW9uT3B0aW9ucyxmdW5jdGlvbihlKXtyZXR1cm4gdC5pc1VuZGVmaW5lZChlLnZpc2libGUpfHx0LnJlc3VsdEN0eChlLCJ2aXNpYmxlIix0aGlzKX0sdGhpcykubGVuZ3RofSxfX2FkZEJ1dHRvbnM6ZnVuY3Rpb24oKXt0LmVhY2godGhpcy5hY3Rpb25PcHRpb25zLGZ1bmN0aW9uKHQpe3RoaXMuYWRkKGUuY3JlYXRlKHQpKX0sdGhpcyl9LF9fYWRkRHJvcERvd246ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmRyb3Bkb3dufHx7fTt0aGlzLmFkZChuLmV4dGVuZCh7dGl0bGU6dC50aXRsZXx8dGhpcy50aXRsZSxpY29uOnQuaWNvbixkaXNhYmxlZDp0LmRpc2FibGVkfHwhMSx3aWR0aDp0LndpZHRoLGl0ZW1XaWR0aDp0Lml0ZW1XaWR0aHx8MTgwLGl0ZW1zOnRoaXMuYWN0aW9uT3B0aW9uc30pKX0scmVuZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVtb3ZlQ2hpbGRyZW4oKSx0aGlzLl9fY291bnRWaXNpYmxlKCk8PXRoaXMudGhyZXNob2xkP3RoaXMuX19hZGRCdXR0b25zKCk6dGhpcy5fX2FkZERyb3BEb3duKCksaS5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMzUpLGkoMTUzKSxpKDI1NiksaSgyNTcpLGkoMjU4KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyl7cmV0dXJue2NyZWF0ZVRvb2xiYXI6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcztyZXR1cm4gbi5leHRlbmQoe2luaXRpYWxpemU6ZnVuY3Rpb24oKXt0LmVhY2goZSxmdW5jdGlvbih0KXt0aGlzLmFkZChpLl9fY3JlYXRlQ29tcG9uZW50KHQpKX0sdGhpcyl9fSl9LF9fY3JlYXRlQ29tcG9uZW50OmZ1bmN0aW9uKG4pe2lmKHQuaXNGdW5jdGlvbihuKXx8dC5pc09iamVjdChuKSYmbiBpbnN0YW5jZW9mIGUuVmlldylyZXR1cm4gbjtzd2l0Y2gobi50eXBlKXtjYXNlImJ1dHRvbiI6cmV0dXJuIGkuY3JlYXRlKG4pO2Nhc2Uic2VhcmNoIjpyZXR1cm4gci5leHRlbmQoe2luaXRpYWxpemU6ZnVuY3Rpb24oKXt0LmV4dGVuZCh0aGlzLm9wdGlvbnMsdC5waWNrKG4sImZpZWxkIiwibWluQ2hhcnMiKSx7ImZsb2F0IjpuLmFsaWdufSl9fSk7Y2FzZSJsZXR0ZXJzIjpyZXR1cm4gcy5leHRlbmQoe2luaXRpYWxpemU6ZnVuY3Rpb24oKXt0LmV4dGVuZCh0aGlzLm9wdGlvbnMsdC5waWNrKG4sImZpZWxkIikpfX0pO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJOb3QgSW1wbGVtZW50ZWQiKX19fX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQ2KV0scj1mdW5jdGlvbih0LGUpe3JldHVybiBlLmV4dGVuZCh7YXR0cmlidXRlczp7fSxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe3QuZGVmYXVsdHModGhpcy5hdHRyaWJ1dGVzLHsiZGF0YS1zZSI6ImRhdGEtbGlzdC10b29sYmFyIn0pLGUuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuJGVsLmFkZENsYXNzKCJkYXRhLWxpc3QtdG9vbGJhciBjbGVhcmZpeCIpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxODcpLGkoMTczKSxpKDE0NiksaSgyMDQpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPW4uZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgPHNwYW4gY2xhc3M9InNlYXJjaC1ib3ggaW5wdXQtZml4Ij5cdCAgICAgIDxzcGFuIGNsYXNzPSJpY29uLW9ubHkgaWNvbi0xNiBtYWduaWZ5aW5nLWdsYXNzLTE2Ij48L3NwYW4+XHQgICAgICA8aW5wdXQgY2xhc3M9InRleHQtZmllbGQtZGVmYXVsdCIgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9Int7cGxhY2Vob2xkZXJ9fSI+XHQgICAgICA8YSBocmVmPSIjIiBjbGFzcz0ibGluay1idXR0b24gYWxsb3ctaW4tcmVhZC1vbmx5IGNsZWFyLXNlYXJjaCBpY29uLTE2IiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPlx0ICAgICAgICAgIDxzcGFuIGNsYXNzPSJpY29uIGNsZWFyLWlucHV0LTE2Ij48L3NwYW4+XHQgICAgICA8L2E+XHQgICAgPC9zcGFuPlx0ICAnLGV2ZW50czp7ImlucHV0IC50ZXh0LWZpZWxkLWRlZmF1bHQiOiJ1cGRhdGUiLCJjbGljayAuY2xlYXItc2VhcmNoIjoicmVzZXQiLCJrZXl1cCAudGV4dC1maWVsZC1kZWZhdWx0IjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdC53aGljaD09PWkuRVNDP3RoaXMucmVzZXQoKTp0aGlzLnVwZGF0ZSgpfX0sY29uc3RydWN0b3I6ZnVuY3Rpb24oKXtpZihuLmFwcGx5KHRoaXMsYXJndW1lbnRzKSwhdGhpcy5zdGF0ZSl0aHJvdyBuZXcgRXJyb3IoIk5vIFN0YXRlIFByb3ZpZGVkIik7dGhpcy5vcHRpb25zLm1pbkNoYXJzfHwodGhpcy5vcHRpb25zLm1pbkNoYXJzPTIpLHRoaXMub3B0aW9ucy5wbGFjZWhvbGRlcnx8KHRoaXMub3B0aW9ucy5wbGFjZWhvbGRlcj0iU2VhcmNoLi4uIiksdGhpcy4kZWwuYWRkQ2xhc3MoInNlYXJjaC1ib3gtd3JhcCIpLHRoaXMuJGVsLmFkZENsYXNzKCJyaWdodCI9PT10aGlzLm9wdGlvbnNbImZsb2F0Il0/ImZsb2F0LXIiOiJmbG9hdC1sIiksdGhpcy5maWVsZD10aGlzLm9wdGlvbnMuZmllbGR8fCJzZWFyY2giLHRoaXMubGlzdGVuVG8odGhpcy5zdGF0ZSwiY2hhbmdlOiIrdGhpcy5maWVsZCx0aGlzLl91cGRhdGVWYWx1ZSksdGhpcy5fdXBkYXRlU3RhdGU9dC5kZWJvdW5jZSh0aGlzLl91cGRhdGVTdGF0ZSxlLkRFQk9VTkNFX0RFTEFZKSx0LmJpbmRBbGwodGhpcywiX3VwZGF0ZVN0YXRlIiwidXBkYXRlIil9LHJlbmRlcjpmdW5jdGlvbigpe3JldHVybiBuLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcyksdGhpcy5fdXBkYXRlVmFsdWUoKSx0aGlzfSx1cGRhdGU6ZnVuY3Rpb24oKXt0aGlzLiQoIi5jbGVhci1zZWFyY2giKS50b2dnbGUoISF0aGlzLnZhbCgpKSx0aGlzLl91cGRhdGVTdGF0ZSgpfSxyZW1vdmU6ZnVuY3Rpb24oKXt0aGlzLiQoImlucHV0Iikub2ZmKCksbi5wcm90b3R5cGUucmVtb3ZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0scmVzZXQ6ZnVuY3Rpb24odCl7dCYmdC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMudmFsKCIiKSx0aGlzLnVwZGF0ZSgpfSx2YWw6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLiQoImlucHV0Iik7cmV0dXJuIHQudmFsLmFwcGx5KHQsYXJndW1lbnRzKX0sX3N0YXRlVmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGF0ZS5nZXQodGhpcy5maWVsZCl8fCIifSxfdXBkYXRlU3RhdGU6ZnVuY3Rpb24oKXt0aGlzLl9jaGFuZ2VkKCkmJnRoaXMuc3RhdGUuc2V0KHRoaXMuZmllbGQsdGhpcy52YWwoKSl9LF91cGRhdGVWYWx1ZTpmdW5jdGlvbigpe3RoaXMuX2NoYW5nZWQoKSYmdGhpcy52YWwodGhpcy5fc3RhdGVWYWx1ZSgpKSYmdGhpcy4kKCIuY2xlYXItc2VhcmNoIikudG9nZ2xlKCEhdGhpcy52YWwoKSl9LF9jaGFuZ2VkOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy52YWwoKXx8IiIsZT10Lmxlbmd0aDtyZXR1cm4oMD09PWV8fGU+PXRoaXMub3B0aW9ucy5taW5DaGFycykmJnRoaXMuX3N0YXRlVmFsdWUoKSE9dH19KTtyZXR1cm4gcn0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDUpLGkoMTQ3KSxpKDE0NildLHI9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPWUudHBsKCdcdCAgICA8bGk+XHQgICAgICA8YSBocmVmPSIjIiBjbGFzcz0iZGF0YS1saXN0LW5hdi1saW5rIGRhdGEtbGlzdC1wYWdlci1uYXYtbGluayIgZGF0YS12YWx1ZT0ie3t2YWx1ZX19Ij57e2xhYmVsfX08L2E+XHQgICAgPC9saT5cdCAgJykscj1pLmV4dGVuZCh7dGFnTmFtZToidWwiLGNsYXNzTmFtZToiZGF0YS1saXN0LXBhZ2VyLWFscGhhIGNsZWFyZml4IGZsb2F0LXIiLGV2ZW50czp7ImNsaWNrIGxpIGEiOmZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKSx0aGlzLmF1dG9CaW5kJiZ0aGlzLnN0YXRlLnVuc2V0KCJzZWFyY2giKTt2YXIgaT10KGUudGFyZ2V0KS5kYXRhKCJ2YWx1ZSIpO2k9PT1yLkRFRkFVTFRfVkFMVUU/dGhpcy5zdGF0ZS51bnNldCh0aGlzLmZpZWxkKTp0aGlzLnN0YXRlLnNldCh0aGlzLmZpZWxkLGkpLHRoaXMudG9nZ2xlKCl9fSxjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe2lmKGkuYXBwbHkodGhpcyxhcmd1bWVudHMpLCF0aGlzLnN0YXRlKXRocm93IG5ldyBFcnJvcigiTm8gU3RhdGUgUHJvdmlkZWQiKTt0aGlzLmF1dG9CaW5kPXRoaXMub3B0aW9ucy5hdXRvQmluZCE9PSExLHRoaXMuZmllbGQ9dGhpcy5vcHRpb25zLmZpZWxkfHwicHJlZml4Iix0aGlzLmxpc3RlblRvKHRoaXMuc3RhdGUsImNoYW5nZToiK3RoaXMuZmllbGQsdGhpcy5fdG9nZ2xlQ2xhc3MpLHRoaXMuYXV0b0JpbmQmJnRoaXMubGlzdGVuVG8odGhpcy5zdGF0ZSwiY2hhbmdlOnNlYXJjaCIsdGhpcy50b2dnbGUpfSxyZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLiRlbC5odG1sKG4oe3ZhbHVlOnIuREVGQVVMVF9WQUxVRSxsYWJlbDpyLkRFRkFVTFRfTEFCRUx9KSk7Zm9yKHZhciB0PTY1O3Q8PTkwO3QrKyl7dmFyIGU9U3RyaW5nLmZyb21DaGFyQ29kZSh0KTt0aGlzLiRlbC5hcHBlbmQobih7dmFsdWU6ZSxsYWJlbDplfSkpfXJldHVybiB0aGlzLmF1dG9CaW5kJiZ0aGlzLnRvZ2dsZSgpLHRoaXN9LHZhbDpmdW5jdGlvbigpe3JldHVybiB0aGlzLiQoImxpIGEuIityLkFDVElWRV9DTEFTU19OQU1FKS5kYXRhKCJ2YWx1ZSIpfSxfdG9nZ2xlQ2xhc3M6ZnVuY3Rpb24oKXtpZih0aGlzLiQoImxpIGEiKS5yZW1vdmVDbGFzcyhyLkFDVElWRV9DTEFTU19OQU1FKSwhdGhpcy5fZGlzYWJsZWQpe3ZhciB0PXRoaXMuc3RhdGUuZ2V0KHRoaXMuZmllbGQpfHxyLkRFRkFVTFRfVkFMVUU7dGhpcy4kKCdsaSBhW2RhdGEtdmFsdWU9IicrdCsnIl0nKS5hZGRDbGFzcyhyLkFDVElWRV9DTEFTU19OQU1FKSx0aGlzLnZhbCgpfHx0aGlzLnN0YXRlLnVuc2V0KHRoaXMuZmllbGQpfX0sZW5hYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2Rpc2FibGVkPSExLHRoaXMuX3RvZ2dsZUNsYXNzKCksdGhpc30sZGlzYWJsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kaXNhYmxlZD0hMCx0aGlzLl90b2dnbGVDbGFzcygpLHRoaXN9LHRvZ2dsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXRlLmdldCgic2VhcmNoIik/dGhpcy5kaXNhYmxlKCk6dGhpcy5lbmFibGUoKX19LHtERUZBVUxUX1ZBTFVFOiJhbGwiLERFRkFVTFRfTEFCRUw6IkFsbCIsQUNUSVZFX0NMQVNTX05BTUU6ImRhdGEtbGlzdC1uYXYtbGluay1hY3RpdmUifSk7cmV0dXJuIHJ9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDM1KSxpKDE0NCksaSgxNzcpLGkoMTk4KSxpKDI2MCksaSgyNjEpLGkoMjYyKV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvLGEpe2Z1bmN0aW9uIGwoZSxpKXt2YXIgbjtpZih0LmlzQXJyYXkoZSkpe3ZhciByPWU7aT1yWzBdLGU9clsxXSxuPXJbMl19cmV0dXJue2xhYmVsOmUsdmFsdWU6aSxjb3VudDpufX1yZXR1cm57Y3JlYXRlRmlsdGVyczpmdW5jdGlvbihuKXt2YXIgcj10aGlzO3JldHVybiBzLmV4dGVuZCh7aW5pdGlhbGl6ZTpmdW5jdGlvbigpe3QuZWFjaChuLGZ1bmN0aW9uKG4pe2lmKHQuaXNGdW5jdGlvbihuKXx8dC5pc09iamVjdChuKSYmbiBpbnN0YW5jZW9mIGUuVmlldylyZXR1cm4gdGhpcy5hZGQobik7c3dpdGNoKG4udHlwZSl7Y2FzZSJmb3JtIjpyZXR1cm4gdGhpcy5hZGQoci5fX2NyZWF0ZUZpbHRlckZvcm0obikpO2RlZmF1bHQ6aS53YXJuKCJhIHR5cGUgc2hvdWxkIGJlIHNwZWNpZmllZCBmb3IgZmlsdGVycyIpO2Nhc2UiZmlsdGVyc2V0IjpyZXR1cm4gdGhpcy5hZGQoci5fX2NyZWF0ZUZpbHRlclNldChuKSl9fSx0aGlzKX19KX0sX19jcmVhdGVGaWx0ZXJGb3JtOmZ1bmN0aW9uKGUpe3JldHVybiB0LmlzVW5kZWZpbmVkKGUudXNlQXBwbHlCdXR0b24pfHwoZS5ub0J1dHRvbkJhcj0hZS51c2VBcHBseUJ1dHRvbiksZT10LmV4dGVuZCh7Y2xhc3NOYW1lOiJkYXRhLWxpc3Qtc2lkZWJhciBkYXRhLWxpc3Qtc2lkZWJhci1maWx0ZXItZm9ybSIsbm9DYW5jZWxCdXR0b246ITAsYXV0b0JpbmQ6ITAsc2F2ZTpuLmxvY2FsaXplKCJkYXRhbGlzdC5hcHBseV9maWx0ZXIiKSxub0J1dHRvbkJhcjohMCxjb25zdHJ1Y3RvcjpmdW5jdGlvbih0KXt0Lm1vZGVsPXQuc3RhdGUuY2xvbmUoKSxyLmNhbGwodGhpcyx0KSx0aGlzLmF1dG9CaW5kJiZ0aGlzLmxpc3RlblRvKHRoaXMuc3RhdGUsImNoYW5nZTpzZWFyY2giLHRoaXMudG9nZ2xlKTt2YXIgaT1lLm5vQnV0dG9uQmFyPyJjaGFuZ2UiOiJzYXZlIixuPWUubm9CdXR0b25CYXI/dGhpcy5tb2RlbDp0aGlzO3RoaXMubGlzdGVuVG8obixpLGZ1bmN0aW9uKHQpe3RoaXMuc3RhdGUuc2V0KHQudG9KU09OKCkpfSl9LHJlbmRlcjpmdW5jdGlvbigpe3JldHVybiByLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuYXV0b0JpbmQmJnRoaXMudG9nZ2xlKCksdGhpc30sdG9nZ2xlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdGUuZ2V0KCJzZWFyY2giKT90aGlzLmRpc2FibGUoKTp0aGlzLmVuYWJsZSgpfX0sZSksZS5pbnB1dHM9dC5tYXAoZS5pbnB1dHMsZnVuY3Rpb24oZSl7cmV0dXJuIHQuZXh0ZW5kKHsibGFiZWwtdG9wIjohMH0sZSl9KSxyLmV4dGVuZChlKX0sX19jcmVhdGVGaWx0ZXJTZXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIG8uZXh0ZW5kKHt0aXRsZTplLmxhYmVsLGF1dG9CaW5kOnQuaXNVbmRlZmluZWQoZS5hdXRvQmluZCk/by5wcm90b3R5cGUuYXV0b0JpbmQ6ZS5hdXRvQmluZCxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dC5lYWNoKHQucmVzdWx0KGUsIm9wdGlvbnMiKSxmdW5jdGlvbih0LGkpe3ZhciBuPWwodCxpKTt0aGlzLmFkZChhLCJ1bCIse29wdGlvbnM6e2ZpZWxkOmUuZmllbGQsbGFiZWw6bi5sYWJlbCx2YWx1ZTpuLnZhbHVlLGNvdW50Om4uY291bnR9fSl9LHRoaXMpfX0pfX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDYpXSxyPWZ1bmN0aW9uKHQpe3JldHVybiB0LmV4dGVuZCh7Y29uc3RydWN0b3I6ZnVuY3Rpb24oKXt0LmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLiRlbC5hZGRDbGFzcygiZGF0YS1saXN0LXNpZGViYXItd3JhcCIpfSxoZWlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kZWwuaGVpZ2h0KCl9LHR5cGU6InNpZGViYXIifSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDE0NyksaSgxNDYpXSxyPWZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKGUpe3ZhciBpPWUucHJvdG90eXBlP3QucmVzdWx0KGUucHJvdG90eXBlLCJ0YWdOYW1lIik6dC5yZXN1bHQoZSwidGFnTmFtZSIpO3JldHVybiJsaSI9PT1pLnRvTG93ZXJDYXNlKCl9dmFyIHI9ZS50cGwoJ1x0ICAgIHt7I2lmIHRpdGxlfX1cdCAgICAgIDxoMyBjbGFzcz0iZGF0YS1saXN0LXNpZGViYXItaGVhZGluZyI+e3t0aXRsZX19PC9oMz5cdCAgICB7ey9pZn19XHQgICAgPHVsIGNsYXNzPSJkYXRhLWxpc3QtbmF2Ij48L3VsPlx0ICAnKTtyZXR1cm4gaS5leHRlbmQoe2F0dHJpYnV0ZXM6eyJkYXRhLXNlIjoiZGF0YS1saXN0LWZpbHRlcnNldCJ9LGNsYXNzTmFtZToiZGF0YS1saXN0LXNpZGViYXIiLGF1dG9CaW5kOiEwLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7aS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5hdXRvQmluZCYmdGhpcy5saXN0ZW5Ubyh0aGlzLnN0YXRlLCJjaGFuZ2U6c2VhcmNoIix0aGlzLnRvZ2dsZSksdC5pc1VuZGVmaW5lZCh0aGlzLnRpdGxlKSYmKHRoaXMudGl0bGU9IkZpbHRlcnMiKX0scmVuZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGVtcGxhdGU9cih7dGl0bGU6dGhpcy50aXRsZX0pLGkucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5hdXRvQmluZCYmdGhpcy50b2dnbGUoKSx0aGlzfSxhZGQ6ZnVuY3Rpb24oZSl7aWYoIW4oZSkpdGhyb3cgbmV3IEVycm9yKCJVbnN1cHBvcnRlZCBUYWcgTmFtZSIpO2UuYXV0b0JpbmQ9dGhpcy5hdXRvQmluZDt2YXIgcj10LnRvQXJyYXkoYXJndW1lbnRzKTtyZXR1cm4gclsxXXx8KHJbMV09Ii5kYXRhLWxpc3QtbmF2IiksaS5wcm90b3R5cGUuYWRkLmFwcGx5KHRoaXMscil9LHRvZ2dsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXRlLmdldCgic2VhcmNoIik/dGhpcy5kaXNhYmxlKCk6dGhpcy5lbmFibGUoKX0sZGlzYWJsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmludm9rZSgiZGlzYWJsZSIpLHRoaXN9LGVuYWJsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmludm9rZSgiZW5hYmxlIiksdGhpc30saGVpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJGVsLmhlaWdodCgpfSx0eXBlOiJzaWRlYmFyIn0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDcpLGkoMTQ2KV0scj1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIGkuZXh0ZW5kKHt0YWdOYW1lOiJsaSIsdGVtcGxhdGU6ZS50cGwoJ1x0ICAgICAgPGEgY2xhc3M9ImRhdGEtbGlzdC1uYXYtbGluayBncmFkaWVudCIgaHJlZj0iIyIgZGF0YS1zZT0ie3t2YWx1ZX19Ij5cdCAgICAgICAge3tsYWJlbH19XHQgICAgICAgIDxzcGFuIGNsYXNzPSJkYXRhLWxpc3QtZmlsdGVyLWNvdW50Ij57e2NvdW50fX08L3NwYW4+XHQgICAgICAgIDxzcGFuIGNsYXNzPSJkYXRhLWxpc3QtbmF2LWxpbmstYXJyb3ciPjwvc3Bhbj5cdCAgICAgIDwvYT5cdCAgICAnKSxhdXRvQmluZDohMCxldmVudHM6eyJjbGljayBhIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5hdXRvQmluZCYmdGhpcy5zdGF0ZS5nZXQoInNlYXJjaCIpJiZ0aGlzLnN0YXRlLnVuc2V0KCJzZWFyY2giKSx0aGlzLnN0YXRlLnNldCh0aGlzLmZpZWxkLHRoaXMub3B0aW9ucy52YWx1ZSl9fSxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe2lmKCF0aGlzLnN0YXRlfHwhdC5sYWJlbHx8InVuZGVmaW5lZCI9PXR5cGVvZiB0LnZhbHVlKXRocm93IG5ldyBFcnJvcigiTWlzc2luZyBBcmd1bWVudHMiKTt0aGlzLmZpZWxkPXQmJnQuZmllbGR8fCJmaWx0ZXIiLHRoaXMubGlzdGVuVG8odGhpcy5zdGF0ZSwiY2hhbmdlOiIrdGhpcy5maWVsZCx0aGlzLl90b2dnbGVTZWxlY3RlZCksdGhpcy5lbmFibGUoKX0sZGlzYWJsZTpmdW5jdGlvbigpe3RoaXMuX3RvZ2dsZUVuYWJsZWQoITEpfSxlbmFibGU6ZnVuY3Rpb24oKXt0aGlzLl90b2dnbGVFbmFibGVkKCEwKX0sX3RvZ2dsZUVuYWJsZWQ6ZnVuY3Rpb24odCl7dGhpcy5fZGlzYWJsZWQ9IXQsdGhpcy5fdG9nZ2xlU2VsZWN0ZWQoKX0scmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy50ZW1wbGF0ZSh7bGFiZWw6dGhpcy5vcHRpb25zLmxhYmVsLGNvdW50OnQuaXNVbmRlZmluZWQodGhpcy5vcHRpb25zLmNvdW50KT8iIjp0aGlzLm9wdGlvbnMuY291bnQsdmFsdWU6dGhpcy5vcHRpb25zLnZhbHVlfSk7cmV0dXJuIHRoaXMuJGVsLmh0bWwoZSksdGhpcy5lbmFibGUoKSx0aGlzfSxfdG9nZ2xlU2VsZWN0ZWQ6ZnVuY3Rpb24oKXt2YXIgdD0hdGhpcy5fZGlzYWJsZWQmJnRoaXMuc3RhdGUuZ2V0KHRoaXMuZmllbGQpPT10aGlzLm9wdGlvbnMudmFsdWU7dGhpcy4kKCJhIikudG9nZ2xlQ2xhc3MoImRhdGEtbGlzdC1uYXYtbGluay1hY3RpdmUiLHQpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDYpXSxyPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuZXh0ZW5kKHtkZWJvdW5jZVRpbWU6MTAwLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy4kZWwuYWRkQ2xhc3MoImRhdGEtbGlzdCBkYXRhLWxpc3Qtc2lkZWJhci1sZWZ0IGNsZWFyZml4Iil9LHJlbmRlcjpmdW5jdGlvbigpe3JldHVybiBlLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHQuZGVmZXIodC5iaW5kKHRoaXMuYmFsYW5jZSx0aGlzKSksdGhpcy5maW5kV2hlcmUoe3R5cGU6InNpZGViYXIifSl8fHRoaXMuJGVsLnJlbW92ZUNsYXNzKCJkYXRhLWxpc3Qtc2lkZWJhci1sZWZ0IiksdGhpc30sYmFsYW5jZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zaWRlYmFyPXRoaXMuZmluZFdoZXJlKHt0eXBlOiJzaWRlYmFyIn0pLHRoaXMuY29udGVudD10aGlzLmZpbmRXaGVyZSh7dHlwZToiY29udGVudCJ9KSwhdGhpcy5zaWRlYmFyfHwhdGhpcy5jb250ZW50fHx0aGlzLnNpZGViYXIuaGVpZ2h0KCk8PXRoaXMuY29udGVudC5oZWlnaHQoKX0sYmFsYW5jZTp0LmRlYm91bmNlKGZ1bmN0aW9uKCl7dGhpcy5iYWxhbmNlZCgpfHx0aGlzLmNvbnRlbnQuaGVpZ2h0KHRoaXMuc2lkZWJhci5oZWlnaHQoKSszMCl9LHRoaXMuZGVib3VuY2VUaW1lKX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDcpLGkoMTQ2KSxpKDI2NSldLHI9ZnVuY3Rpb24odCxlLGksbil7dmFyIHI9ZS50cGwoJ1x0ICAgIDx0cj5cdCAgICAgIDx0ZCBjb2xzcGFuPSJ7e2NvbHNwYW59fSI+PC90ZD5cdCAgICA8L3RyPlx0ICAnKSxzPWkuZXh0ZW5kKHt0YWdOYW1lOiJ0Zm9vdCIsY2xhc3NOYW1lOiJkYXRhLWxpc3QtcGFnZXItZm9vdGVyIixjb25zdHJ1Y3RvcjpmdW5jdGlvbigpe2kuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCJyZXF1ZXN0Iix0aGlzLmVtcHR5KSx0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwic3luYyByZXNldCIsdC5kZWJvdW5jZSh0aGlzLnJlbmRlciw1MCkpfSxyZW5kZXI6ZnVuY3Rpb24oKXtpZih0aGlzLmNvbGxlY3Rpb24uaGFzTW9yZSgpKXt2YXIgdD10aGlzLm9wdGlvbnMuY29sc3Bhbnx8dGhpcy5jb2xzcGFufHwxMDA7dGhpcy4kZWwuaHRtbChyKHtjb2xzcGFuOnR9KSksdGhpcy4kKCJ0ZCIpLmh0bWwobmV3IG4odGhpcy5vcHRpb25zKS5yZW5kZXIoKS5lbCl9ZWxzZSB0aGlzLmVtcHR5KCk7cmV0dXJuIHRoaXN9LGVtcHR5OmZ1bmN0aW9uKCl7dGhpcy4kZWwuZW1wdHkoKX19KTtyZXR1cm4gc30uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDE0NildLHI9ZnVuY3Rpb24odCl7dmFyIGU9dC5leHRlbmQoe2VsOic8YSBocmVmPSIjIiBjbGFzcz0iZGF0YS1saXN0LXBhZ2VyLWZvb3Rlci1saW5rIj48L2E+Jyx0ZW1wbGF0ZTone3tpMThuIGNvZGU9ImRhdGFsaXN0LnNob3dfbW9yZSJ9fScsZXZlbnRzOntjbGljazpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5jb2xsZWN0aW9uLmZldGNoTW9yZSYmdGhpcy5jb2xsZWN0aW9uLmZldGNoTW9yZSgpfX19KTtyZXR1cm4gZX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxOTgpLGkoMjAzKSxpKDI2OCksaSgyNjkpLGkoMjcwKSxpKDIzNCksaSgyMjUpLGkoMjMzKSxpKDE5OSksaSgyMDApLGkoMjMwKSxpKDIzMiksaSgyNzEpLGkoMjI0KSxpKDI3NSksaSgyNzIpLGkoMjI4KSxpKDIxMCksaSgyNzYpLGkoMjEzKSxpKDI3NyksaSgyNzQpLGkoMjE1KSxpKDI3OCksaSgyODEpLGkoMjE0KSxpKDIwOCksaSgyODIpLGkoMjA2KSxpKDIyMiksaSgyMDUpLGkoMjAyKSxpKDI3MyksaSgyMTEpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSxsLGMsdSxkLGgscCxmLG0sXyxnLHYseSxiLHcsTSxrLFQsUyxMLHgsRSxELFksQyxBLE8pe3JldHVybntCYXNlRm9ybTp0LEJhc2VJbnB1dDplLGNvbXBvbmVudHM6e1RleHRDb3VudGVyRXhwbGFpbjppLFdpemFyZFRpdGxlOm59LGhlbHBlcnM6e0VudW1UeXBlSGVscGVyOnIsRXJyb3JCYW5uZXI6cyxFcnJvclBhcnNlcjpvLEZvcm1VdGlsOmEsSW5wdXRDb250YWluZXI6bCxJbnB1dEZhY3Rvcnk6YyxJbnB1dExhYmVsOnUsSW5wdXRXcmFwcGVyOmQsU2NoZW1hRm9ybUZhY3Rvcnk6aH0saW5wdXRzOntCYXNlRmlsZVVwbG9hZGVyOnAsQmFzZVBpY2tlcjpmLEJvb2xlYW5TZWxlY3Q6bSxDZXJ0aWZpY2F0aW9uRmlsZVVwbG9hZGVyOl8sQ2hlY2tCb3g6ZyxDaGVja0JveFNldDp2LERhdGVCb3g6eSxEYXRlVGltZVBpY2tlcjpiLERlbGV0YWJsZUJveDp3LEdyb3VwUGlja2VyOk0sR3JvdXBTZWxlY3Q6ayxJZHBQaWNrZXI6VCxOdW1iZXJCb3g6UyxSYWRpbzpMLFNjb3Blc1BpY2tlcjp4LFNlbGVjdDpFLFNpbXBsZUNoZWNrQm94U2V0OkQsVGV4dEFyZWE6WSxUZXh0Qm94OkMsVGV4dEJveFNldDpBLFRleHRTZWxlY3Q6T319fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDYpXSxyPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAge3sjaWYgaGFzUmVtYWluaW5nfX1cdCAgICAgIHt7aTE4biBjb2RlPSJjaGFyYWN0ZXJzLnJlbWFpbmluZyIgYnVuZGxlPSJtZXNzYWdlcyIgYXJndW1lbnRzPSJjb3VudCJ9fVx0ICAgIHt7L2lmfX1cdCAgICB7eyN1bmxlc3MgaGFzUmVtYWluaW5nfX1cdCAgICAgIDxkaXYgY2xhc3M9Im8tZm9ybS10ZXh0LWNvdW50ZXItb3ZlciI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJjaGFyYWN0ZXJzLm92ZXIiIGJ1bmRsZT0ibWVzc2FnZXMiIGFyZ3VtZW50cz0iY291bnQifX1cdCAgICAgIDwvZGl2Plx0ICAgIHt7L3VubGVzc319JywKCW1vZGVsRXZlbnRzOmZ1bmN0aW9uKCl7dmFyIGU9e307cmV0dXJuIGVbImNoYW5nZToiK3RoaXMub3B0aW9ucy5maWVsZF09dC50aHJvdHRsZSh0aGlzLnJlbmRlciw1MCksZX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe2lmKCF0aGlzLm9wdGlvbnMubW9kZWx8fCF0aGlzLm9wdGlvbnMuZmllbGQpdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgY3JlYXRlIFRleHRDb3VudGVyRXhwbGFpbi4gbWlzc2luZyBhcmd1bWVudHMgWyJtb2RlbCIsICJmaWVsZCJdJyk7dmFyIGU9dGhpcy5vcHRpb25zLm1vZGVsLmdldFByb3BlcnR5U2NoZW1hKHRoaXMub3B0aW9ucy5maWVsZCk7aWYoIWV8fCF0LmlzTnVtYmVyKGUubWF4TGVuZ3RoKSl0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBjcmVhdGUgVGV4dENvdW50ZXJFeHBsYWluLiBwcm9wZXJ0eSBtaXNzaW5nICJtYXhMZW5ndGgiIGRlZmluaXRpb24nKTt0aGlzLmZpZWxkPXRoaXMub3B0aW9ucy5maWVsZCx0aGlzLm1heExlbmd0aD1lLm1heExlbmd0aH0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5tb2RlbC5nZXQodGhpcy5maWVsZCl8fCIiLGU9dGhpcy5tYXhMZW5ndGgsaT1lLXQubGVuZ3RoLG49aT49MDtyZXR1cm57aGFzUmVtYWluaW5nOm4sY291bnQ6bj9pOk1hdGguYWJzKGkpfX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDE0NildLHI9ZnVuY3Rpb24odCl7dmFyIGU9dC5leHRlbmQoe3RhZ05hbWU6ImgyIixjbGFzc05hbWU6IndpemFyZC1oZWFkIix0ZW1wbGF0ZTonPHNwYW4gY2xhc3M9InN0ZXAtbnVtIj57e3N0ZXB9fTwvc3Bhbj57e3RpdGxlfX0nfSk7cmV0dXJuIGV9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDUpLGkoMTc2KSxpKDIyMildLHI9ZnVuY3Rpb24odCxlLGksbil7ZnVuY3Rpb24gcihlKXt2YXIgcj17bmFtZTplLm5hbWUsbGFiZWw6ZS50aXRsZSxyZWFkT25seTplLnJlYWRPbmx5LGN1c3RvbUV4cGxhaW46ZS5leHBsYWluLG9wdGlvbnM6cyhlLmVudW1WYWx1ZXMpLHBhcmFtczp7ZW51bVZhbHVlczplLmVudW1WYWx1ZXN9fTtyZXR1cm4gZS5kaXNwbGF5VHlwZT09PWkuREFUQVRZUEUub2JqZWN0PyhyLnRvPWwsci5mcm9tPWEpOmUuZGlzcGxheVR5cGU9PT1pLkFSUkFZRElTUExBWVRZUEUuYXJyYXlvZm9iamVjdCYmKHIudG89ZnVuY3Rpb24oZSl7cmV0dXJuIHQubWFwKGUsbCx0aGlzKX0sci5mcm9tPWZ1bmN0aW9uKGUpe3JldHVybiB0Lm1hcChlLGEsdGhpcyl9KSxpLmlzQXJyYXlEYXRhVHlwZShlLmRpc3BsYXlUeXBlKT9yLmlucHV0PW46ci50eXBlPSJzZWxlY3QiLHJ9ZnVuY3Rpb24gcyhpKXtyZXR1cm4gdC5pc0FycmF5KGkpP3QuYWxsKGksZS5pc1BsYWluT2JqZWN0KT90LnJlZHVjZShpLG8se30pOnQub2JqZWN0KGksaSk6e319ZnVuY3Rpb24gbyh0LGkpe2lmKGUuaXNQbGFpbk9iamVjdChpKSYmaS5oYXNPd25Qcm9wZXJ0eShjKSl7dmFyIG49YShpKSxyPWkubmFtZTt0W25dPXJ9cmV0dXJuIHR9ZnVuY3Rpb24gYSh0KXtyZXR1cm4gdCYmdFtjXX1mdW5jdGlvbiBsKGUpe2lmKHRoaXMub3B0aW9ucy5wYXJhbXMmJnQuaXNBcnJheSh0aGlzLm9wdGlvbnMucGFyYW1zLmVudW1WYWx1ZXMpKXJldHVybiB0LmZpbmQodGhpcy5vcHRpb25zLnBhcmFtcy5lbnVtVmFsdWVzLGZ1bmN0aW9uKHQpe3JldHVybiB0W2NdPT09ZX0pO3Rocm93IG5ldyBFcnJvcigiQ2FuIG5vdCBmaW5kIGVudW0gb2JqZWN0IGZyb20gRW51bSBWYWx1ZXMgbGlzdCBmb3Iga2V5OiAiK2UpfXZhciBjPSJuYW1lIjtyZXR1cm57Z2V0RW51bUlucHV0T3B0aW9uczpyLGdldERyb3Bkb3duT3B0aW9uczpzfX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTc3KSxpKDI3MiksaSgyNzMpLGkoMjIyKSxpKDI3MCldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMpe2Z1bmN0aW9uIG8ocil7dmFyIHM9ci5nZXQoIl9fZGlzcGxheVR5cGVfXyIpLG89ci5nZXQoIl9fcG9zc2libGVWYWx1ZXNfXyIpLGE9ci5nZXQoIm5hbWUiKSxjPXIuZ2V0KCJ0aXRsZSIpLGQ9e3R5cGU6InRleHQiLG5hbWU6YSxsYWJlbDpjfHxhfTtzd2l0Y2gocyl7Y2FzZSJhcnJheW9mc3RyaW5nIjpkLmlucHV0PW4sZC5wYXJhbXM9e2l0ZW1UeXBlOiJzdHJpbmcifTticmVhaztjYXNlImFycmF5b2ZudW1iZXIiOmQuaW5wdXQ9bixkLnBhcmFtcz17aXRlbVR5cGU6Im51bWJlciJ9O2JyZWFrO2Nhc2UiYXJyYXlvZmludGVnZXIiOmQuaW5wdXQ9bixkLnBhcmFtcz17aXRlbVR5cGU6ImludGVnZXIifTticmVhaztjYXNlImFycmF5b2ZvYmplY3QiOmQuaW5wdXQ9bixkLnBhcmFtcz17aXRlbVR5cGU6ci5nZXQoIml0ZW1zIikudHlwZX07YnJlYWs7Y2FzZSJib29sZWFuIjpkLmlucHV0PWk7YnJlYWs7Y2FzZSJpbnRlZ2VyIjpjYXNlIm51bWJlciI6ZC50bz1sO2JyZWFrO2Nhc2UicmVmZXJlbmNlIjpkLnR5cGU9InNlbGVjdCIsZC5vcHRpb25zPXUobyk7YnJlYWs7Y2FzZSJpbWFnZSI6ZC5yZWFkT25seT0hMCxkLmZyb209ZnVuY3Rpb24oaSl7cmV0dXJuIHQuaXNFbXB0eShpKT8iIjplLmxvY2FsaXplKCJ1c2VyLnByb2ZpbGUuaW1hZ2UuaW1hZ2Vfc2V0Iil9O2JyZWFrO2Nhc2UicGFzc3dvcmQiOmQudHlwZT0icGFzc3dvcmQiO2JyZWFrO2Nhc2UiZGF0ZSI6ZC50eXBlPSJkYXRlIjticmVhaztjYXNlInVyaSI6Y2FzZSJjb3VudHJ5LWNvZGUiOmNhc2UibGFuZ3VhZ2UtY29kZSI6Y2FzZSJlbWFpbCI6Y2FzZSJsb2NhbGUiOmNhc2UidGltZXpvbmUiOmNhc2Uic3RyaW5nIjpjYXNlIm9iamVjdCI6YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoInVua25vd24gdHlwZTogIitzKX1yZXR1cm4gZH1mdW5jdGlvbiBhKGUpe3ZhciBpPXt9LG49ZS5nZXQoIm5hbWUiKSxvPWUuZ2V0KCJfX2Rpc3BsYXlUeXBlX18iKSxhPWUuZ2V0KCJfX3Bvc3NpYmxlVmFsdWVzX18iKSxsPWUuZ2V0KCJfX2ZpZWxkTmFtZVByZWZpeF9fIik7aWYobCYmKGkubmFtZT1sK24saS5lcnJvckZpZWxkPW4pLGUuaXNFbnVtVHlwZSgpKXt2YXIgZD17ZGlzcGxheVR5cGU6byx0aXRsZTplLmdldCgidGl0bGUiKSxlbnVtVmFsdWVzOmUuZ2V0RW51bVZhbHVlcygpfTtpPXQuZXh0ZW5kKHt9LHMuZ2V0RW51bUlucHV0T3B0aW9ucyhkKSxpKX1lbHNlIGMobykmJmEmJihpLmlucHV0PXIsaS5vcHRpb25zPXUoYSkpO3JldHVybiBpfWZ1bmN0aW9uIGwodCl7dmFyIGk9ZS5wYXJzZUZsb2F0KHQpO3JldHVybiIiPT09dD9udWxsOml9ZnVuY3Rpb24gYyh0KXtyZXR1cm4gdCYmdC5pbmRleE9mKCJhcnJheSIpPj0wfWZ1bmN0aW9uIHUoZSl7cmV0dXJuIHQub2JqZWN0KGUsZSl9ZnVuY3Rpb24gZCh0KXt2YXIgZT10LmdldCgiaXRlbXMiKTtyZXR1cm4gZT9lLm9iamVjdE5hbWU6dC5nZXQoIm9iamVjdE5hbWUiKX1mdW5jdGlvbiBoKGUsaSxuKXt2YXIgcixzLG89ZS5nZXQoIm5hbWUiKSxhPW4uX19uZXN0ZWRQcm9wZXJ0eV9fLGw9aVtvXSxjPW4uZ2V0KG8pO2EmJmUuc2V0KCJfX2ZpZWxkTmFtZVByZWZpeF9fIixhKSxyPWlbZChlKV0sbCYmYyYmKGw9dC51bmlvbihsLGMpKSxyJiZyLmxlbmd0aD9zPXI6bCYmbC5sZW5ndGgmJihzPWwpLGUuc2V0KCJfX3Bvc3NpYmxlVmFsdWVzX18iLHMpfWZ1bmN0aW9uIHAodCxlLGkpe3JldHVybiB0LmVhY2goZnVuY3Rpb24odCl7aCh0LGUsaSl9KSx0fWZ1bmN0aW9uIGYodCxlKXtyZXR1cm4gdC5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuIG0odCxlKX0pfWZ1bmN0aW9uIG0oZSxpKXt2YXIgbj1kKGUpLHI9aVtuXTtyZXR1cm4hbnx8IXQocikuaXNFbXB0eSgpfXJldHVybntjcmVhdGVJbnB1dE9wdGlvbnM6ZnVuY3Rpb24oZSl7dmFyIGk9YShlKSxuPW8oZSk7cmV0dXJuIGkucGFyYW1zJiZuLnBhcmFtcyYmKGkucGFyYW1zPXQuZGVmYXVsdHMoaS5wYXJhbXMsbi5wYXJhbXMpKSx0LmRlZmF1bHRzKGksbil9LGhhc1ZhbGlkU2NoZW1hUHJvcHM6ZnVuY3Rpb24oZSxpKXtpZih0LmlzRW1wdHkoZSkpcmV0dXJuITE7dmFyIG49ZihlLGkpO3JldHVybiEhbi5sZW5ndGh9LHByZXBhcmVTY2hlbWE6ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0LnJlc2V0KGYodCxlKSkscCh0LGUsaSl9LGF1Z21lbnRTY2hlbWFQcm9wczpwLGF1Z21lbnRTY2hlbWFQcm9wOmh9fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMjA2KV0scj1mdW5jdGlvbih0KXt2YXIgZT17dW5kZWZpbmVkOiJ1bmRlZmluZWQiLCJ0cnVlIjoidHJ1ZSIsImZhbHNlIjoiZmFsc2UifSxpPWZ1bmN0aW9uKHQpe3JldHVybiB0PyJ0cnVlIjp0PT09ITE/ImZhbHNlIjoidW5kZWZpbmVkIn0sbj1mdW5jdGlvbih0KXtzd2l0Y2godCl7Y2FzZSJ1bmRlZmluZWQiOnJldHVybiBudWxsO2Nhc2UidHJ1ZSI6cmV0dXJuITA7Y2FzZSJmYWxzZSI6cmV0dXJuITE7ZGVmYXVsdDpyZXR1cm4gbnVsbH19O3JldHVybiB0LmV4dGVuZCh7aW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5vcHRpb25zPWUsdGhpcy5vcHRpb25zLmZyb209aSx0aGlzLm9wdGlvbnMudG89bn19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMjAzKSxpKDE3NiksaSgyNzQpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3JldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOiJhcnJheS1pbnB1dCIsdGVtcGxhdGU6JzxhIGhyZWY9IiMiIGNsYXNzPSJhcnJheS1pbnB1dHMtYnV0dG9uIGxpbmstYnV0dG9uIj5BZGQgQW5vdGhlcjwvYT4nLHBhcmFtczp7aXRlbVR5cGU6InN0cmluZyJ9LGV2ZW50czp7ImNsaWNrIC5hcnJheS1pbnB1dHMtYnV0dG9uIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5pc0VkaXRNb2RlKCkmJnRoaXMuYWRkTmV3RWxlbWVudCgpfX0saW5pdGlhbGl6ZTpmdW5jdGlvbihlKXtlfHwoZT17fSksdGhpcy5wYXJhbXM9dC5kZWZhdWx0cyhlLnBhcmFtc3x8e30sdGhpcy5wYXJhbXMpLHRoaXMudW5pcXVlSWRQcmVmaXg9ImFycmF5In0sZnJvbTpmdW5jdGlvbihlKXtyZXR1cm4gdC5pc0FycmF5KGUpP2U6W119LGVkaXRNb2RlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NldEFycmF5T2JqZWN0KCksdGhpcy4kZWwuaHRtbCh0aGlzLnRlbXBsYXRlKSx0LmVhY2godGhpcy5hcnJheU9iamVjdCx0LmJpbmQodGhpcy5fYWRkRGVsZXRhYmxlQm94LHRoaXMpKSx0aGlzfSxyZWFkTW9kZTpmdW5jdGlvbigpe3RoaXMuZWRpdE1vZGUoKSx0aGlzLiQoIi5hcnJheS1pbnB1dHMtYnV0dG9uIikuYWRkQ2xhc3MoImxpbmstYnV0dG9uLWRpc2FibGVkIil9LHZhbDpmdW5jdGlvbigpe3ZhciBlPXQudmFsdWVzKHRoaXMuYXJyYXlPYmplY3QpO3JldHVybiB0LmNvbnRhaW5zKFtpLkRBVEFUWVBFLm51bWJlcixpLkRBVEFUWVBFLmludGVnZXJdLHRoaXMucGFyYW1zLml0ZW1UeXBlKSYmKGU9dC5maWx0ZXIoZSx0LmlzTnVtYmVyKSksZX0sZm9jdXM6ZnVuY3Rpb24oKXt9LGFkZE5ld0VsZW1lbnQ6ZnVuY3Rpb24oKXt2YXIgZT0iIixpPXQudW5pcXVlSWQodGhpcy51bmlxdWVJZFByZWZpeCk7dGhpcy5hcnJheU9iamVjdFtpXT1lLHRoaXMuX2FkZERlbGV0YWJsZUJveChlLGkpLHRoaXMudXBkYXRlKCl9LF9hZGREZWxldGFibGVCb3g6ZnVuY3Rpb24oZSxpKXt2YXIgcj1uZXcgbih0LmV4dGVuZCh0LnBpY2sodGhpcy5vcHRpb25zLCJyZWFkIiwicmVhZE9ubHkiLCJtb2RlbCIpLHtrZXk6aSx2YWx1ZTplLGl0ZW1UeXBlOnRoaXMucGFyYW1zLml0ZW1UeXBlfSkpO3JldHVybiB0aGlzLmxpc3RlblRvKHIsInVwZGF0ZUFycmF5IixmdW5jdGlvbihlKXt0LmlzTnVsbChlKT8oZGVsZXRlIHRoaXMuYXJyYXlPYmplY3RbaV0sdGhpcy5zdG9wTGlzdGVuaW5nKHIpKTp0aGlzLmFycmF5T2JqZWN0W2ldPWUsdGhpcy51cGRhdGUoKX0pLHIucmVuZGVyKCkuJGVsLmhpZGUoKSx0aGlzLiQoIi5hcnJheS1pbnB1dHMtYnV0dG9uIikuYmVmb3JlKHIuZWwpLHIuJGVsLnNsaWRlRG93bigpLHJ9LF9zZXRBcnJheU9iamVjdDpmdW5jdGlvbigpe3ZhciBlPXRoaXMubW9kZWwuZ2V0KHRoaXMub3B0aW9ucy5uYW1lKTtpZih0aGlzLmFycmF5T2JqZWN0PXt9LHQuaXNBcnJheShlKSYmIXQuaXNFbXB0eShlKSl7dmFyIGk9W10sbj10aGlzO3QoZS5sZW5ndGgpLnRpbWVzKGZ1bmN0aW9uKCl7aS5wdXNoKHQudW5pcXVlSWQobi51bmlxdWVJZFByZWZpeCkpfSksdGhpcy5hcnJheU9iamVjdD10Lm9iamVjdChpLGUpfX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTQyKSxpKDE3NiksaSgxNzcpLGkoMTQ3KSxpKDE4NyldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMpe3ZhciBvPWZ1bmN0aW9uKHQpe3JldHVybi9eW2FlaW91XS8udGVzdCh0KX0sYT1mdW5jdGlvbih0KXtyZXR1cm4gbyh0KT8iYW4iOiJhIn0sbD1yLnRwbCgnXHQgICAgPGRpdiBjbGFzcz0iby1mb3JtLWlucHV0LWdyb3VwLWNvbnRyb2xzIj5cdCAgICAgIDxzcGFuIGNsYXNzPSJpbnB1dC1maXggby1mb3JtLWNvbnRyb2wiPlx0ICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9Im8tZm9ybS10ZXh0IiBuYW1lPSJ7e2tleX19IiBpZD0ie3trZXl9fSIgdmFsdWU9Int7dmFsdWV9fSIgXHQgICAgICAgIHBsYWNlaG9sZGVyPSJ7e3BsYWNlaG9sZGVyfX0iLz5cdCAgICAgIDwvc3Bhbj5cdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rLWJ1dHRvbiBsaW5rLWJ1dHRvbi1pY29uIGljb24tb25seSBjbGVhci1pbnB1dC0xNiI+XHQgICAgICAgIDxzcGFuIGNsYXNzPSJpY29uICI+PC9zcGFuPlx0ICAgICAgPC9hPlx0ICAgIDwvZGl2Plx0ICAgIDxwIGNsYXNzPSJvLWZvcm0taW5wdXQtZXJyb3Igby1mb3JtLWV4cGxhaW4iPlx0ICAgICAgPHNwYW4gY2xhc3M9Imljb24gaWNvbi0xNiBlcnJvci0xNi1zbWFsbCI+PC9zcGFuPiB7e2Vycm9yRXhwbGFpbn19XHQgICAgPC9wPlx0ICAnKSxjPSJvLWZvcm0taGFzLWVycm9ycyIsdT0idXBkYXRlQXJyYXkiO3JldHVybiBlLmV4dGVuZCh7dGFnTmFtZToiZGl2IixjbGFzc05hbWU6Im8tZm9ybS1pbnB1dC1ncm91cCIsZXZlbnRzOnsiY2xpY2sgYSI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMucmVtb3ZlKCl9LCJrZXl1cCBpbnB1dCI6ZnVuY3Rpb24oKXt0aGlzLnVwZGF0ZSgpfX0saXNFZGl0TW9kZTpmdW5jdGlvbigpe3JldHVybiF0aGlzLm9wdGlvbnMucmVhZE9ubHkmJih0aGlzLm9wdGlvbnMucmVhZCE9PSEwfHx0aGlzLm1vZGVsLmdldCgiX19lZGl0X18iKT09PSEwKX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMudGVtcGxhdGU9bCh0LmV4dGVuZCh0aGlzLm9wdGlvbnMse3BsYWNlaG9sZGVyOnRoaXMuZ2V0UGxhY2Vob2xkZXJUZXh0KCksZXJyb3JFeHBsYWluOnRoaXMuZ2V0RXJyb3JFeHBsYWluVGV4dCgpfSkpLHRoaXMudXBkYXRlPXQuZGVib3VuY2UodGhpcy51cGRhdGUsdGhpcy5vcHRpb25zLmRlYm91bmNlRGVsYXl8fHMuREVCT1VOQ0VfREVMQVkpfSxyZW5kZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0VkaXRNb2RlKCk/dGhpcy4kZWwuaHRtbCh0aGlzLnRlbXBsYXRlKToodGhpcy4kZWwudGV4dCh0aGlzLm9wdGlvbnMudmFsdWUpLHRoaXMuJCgiYSIpLmhpZGUoKSksdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyKHUsbnVsbCksdGhpcy4kZWwuc2xpZGVVcCh0LmJpbmQoZnVuY3Rpb24oKXtlLnByb3RvdHlwZS5yZW1vdmUuY2FsbCh0aGlzLGFyZ3VtZW50cyl9LHRoaXMpKX0sdXBkYXRlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy4kKCJpbnB1dCIpLnZhbCgpLHI9dC5vYmplY3QoW2kuREFUQVRZUEUubnVtYmVyLGkuREFUQVRZUEUuaW50ZWdlcl0sW24ucGFyc2VGbG9hdCx0aGlzLnBhcnNlSW50XSk7dC5oYXMocix0aGlzLm9wdGlvbnMuaXRlbVR5cGUpJiYoZT1yW3RoaXMub3B0aW9ucy5pdGVtVHlwZV0oZSksdC5pc051bWJlcihlKT90aGlzLmNsZWFySW52YWxpZCgpOnRoaXMubWFya0ludmFsaWQoKSksdGhpcy50cmlnZ2VyKHUsZSl9LG1hcmtJbnZhbGlkOmZ1bmN0aW9uKCl7dGhpcy4kZWwuYWRkQ2xhc3MoYyl9LGNsZWFySW52YWxpZDpmdW5jdGlvbigpe3RoaXMuJGVsLnJlbW92ZUNsYXNzKGMpfSxnZXRQbGFjZWhvbGRlclRleHQ6ZnVuY3Rpb24oKXt2YXIgdD1bIkVudGVyIl07cmV0dXJuIHQucHVzaChhKHRoaXMub3B0aW9ucy5pdGVtVHlwZSkpLHQucHVzaCh0aGlzLm9wdGlvbnMuaXRlbVR5cGUudG9Mb3dlckNhc2UoKSksdC5qb2luKCIgIil9LGdldEVycm9yRXhwbGFpblRleHQ6ZnVuY3Rpb24oKXt2YXIgdD1bIlZhbHVlIG11c3QgYmUiXTtyZXR1cm4gdC5wdXNoKGEodGhpcy5vcHRpb25zLml0ZW1UeXBlKSksdC5wdXNoKHRoaXMub3B0aW9ucy5pdGVtVHlwZS50b0xvd2VyQ2FzZSgpKSx0LmpvaW4oIiAiKX0scGFyc2VJbnQ6ZnVuY3Rpb24oZSl7aWYoL14tP1xkKyQvLnRlc3QoZSkpe3ZhciBpPXBhcnNlSW50KGUsMTApO3JldHVybiB0LmlzTmFOKGkpP2U6aX1yZXR1cm4gZX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgyKSxpKDUpLGkoMTczKSxpKDE0NyksaSgyMDMpLGkoMjA5KSxpKDcpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9bi50cGwoJ1x0ICAgIDxzcGFuIGNsYXNzPSJib2xkIG1hcmdpbi1uMTAiPnt7dGl0bGV9fTwvc3Bhbj5cdCAgJyksbz1uLnRwbCgnXHQgICAgPGlucHV0IHR5cGU9ImNoZWNrYm94IiBuYW1lPSJ7e25hbWV9fSIgaWQ9Int7aWR9fSIvPlx0ICAgIDxsYWJlbCBmb3I9Int7aWR9fSI+e3tsYWJlbH19PC9sYWJlbD5cdCAgJyksYT1uLnRwbCgie3tzdWZmaQ==", "base64"));
  res.write(new Buffer("eH19e3tpZH19Iik7cmV0dXJuIHIuZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKGUpe2lmKHRoaXMuYWxsT3B0aW9ucz1lLm9wdGlvbnMuYWxsLHRoaXMuc3VmZml4PWUubmFtZSx0aGlzLmdyb3VwZWRPcHRpb25zPXt9LGUub3B0aW9ucy5tdWx0aUNvbHVtbil7dmFyIGk9ZS5vcHRpb25zLmdyb3VwQnlGaWVsZDt0LmVhY2godGhpcy5hbGxPcHRpb25zLGZ1bmN0aW9uKHQpe3RoaXMuZ3JvdXBlZE9wdGlvbnNbdFtpXV18fCh0aGlzLmdyb3VwZWRPcHRpb25zW3QuY2F0ZWdvcnldPVtdKSx0aGlzLmdyb3VwZWRPcHRpb25zW3QuY2F0ZWdvcnldLnB1c2godCl9LHRoaXMpfX0sZXZlbnRzOnsiY2hhbmdlIDpjaGVja2JveCI6InVwZGF0ZSIsa2V5dXA6ZnVuY3Rpb24odCl7dmFyIG49dC53aGljaHx8dC5rZXlDb2RlO249PT1pLlNQQUNFJiZlKHQudGFyZ2V0KS5jbGljaygpfX0scHJlUmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy4kZWwuZW1wdHkoKTt2YXIgZT10LmtleXModGhpcy5ncm91cGVkT3B0aW9ucyk7dGhpcy5vcHRpb25zLm9wdGlvbnMubXVsdGlDb2x1bW4mJmUubGVuZ3RoPjE/dGhpcy5yZW5kZXJNdWx0aUNvbHVtbihlKTp0aGlzLnJlbmRlclNpbmdsZUNvbHVtbigpO3ZhciBpPXRoaXMuJCgiaW5wdXQiKTt0LmRlZmVyKHQuYmluZChpLmN1c3RvbUlucHV0LGkpKX0scmVuZGVyU2luZ2xlQ29sdW1uOmZ1bmN0aW9uKCl7dC5lYWNoKHRoaXMuYWxsT3B0aW9ucyxmdW5jdGlvbihlKXt0aGlzLiRlbC5hcHBlbmQobyh7bmFtZTphKHQuZXh0ZW5kKHRoaXMsZSkpLGlkOmEodC5leHRlbmQodGhpcyxlKSksbGFiZWw6ZS5kaXNwbGF5TmFtZXx8ZS5uYW1lfSkpfSx0aGlzKX0scmVuZGVyTXVsdGlDb2x1bW46ZnVuY3Rpb24oZSl7dmFyIGk9Mz09ZS5sZW5ndGg/InN1LWNoZWNrYm94LTNjb2x1bW5zIjoic3UtY2hlY2tib3gtMmNvbHVtbnMiO3QuZWFjaChlLGZ1bmN0aW9uKGUsbil7dmFyIHI9ImNvbHVtbiIrbjt0aGlzLiRlbC5hcHBlbmQoJzxzcGFuIGNsYXNzPSInK2krJyIgaWQ9IicrcisnIj4nKTt2YXIgbD10aGlzLiRlbC5maW5kKCIjIityKTtsLmFwcGVuZChzKHt0aXRsZTplfSkpLHQuZWFjaCh0aGlzLmdyb3VwZWRPcHRpb25zW2VdLGZ1bmN0aW9uKGUpe2wuYXBwZW5kKG8oe25hbWU6YSh0LmV4dGVuZCh0aGlzLGUpKSxpZDphKHQuZXh0ZW5kKHRoaXMsZSkpLGxhYmVsOmUuZGlzcGxheU5hbWV8fGUubmFtZX0pKX0sdGhpcyksdGhpcy4kZWwuYXBwZW5kKCI8L3NwYW4+Iil9LHRoaXMpfSxlZGl0TW9kZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLiQoIjpjaGVja2JveCIpLnByb3AoImNoZWNrZWQiLCExKSx0LmVhY2godGhpcy5tb2RlbC5nZXQodGhpcy5vcHRpb25zLm5hbWUpLGZ1bmN0aW9uKGUpe3RoaXMuJCgiaW5wdXQjIithKHQuZXh0ZW5kKHRoaXMsZSkpKS5wcm9wKCJjaGVja2VkIixlLmVuYWJsZWQpfSx0aGlzKSx0aGlzLmdldE1vZGVsVmFsdWUoKSx0aGlzfSx2YWw6ZnVuY3Rpb24oKXt2YXIgZT1bXTtyZXR1cm4gdC5lYWNoKHRoaXMuYWxsT3B0aW9ucyxmdW5jdGlvbihpKXtpLmVuYWJsZWQ9dGhpcy4kKCI6aW5wdXQjIithKHQuZXh0ZW5kKHRoaXMsaSkpKS5wcm9wKCJjaGVja2VkIiksZS5wdXNoKGkpfSx0aGlzKSxlfSx1cGRhdGU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnZhbCgpO3RoaXMubW9kZWwuc2V0KHRoaXMub3B0aW9ucy5uYW1lLEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodCkpKX0sZm9jdXM6ZnVuY3Rpb24oKXt9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDcpLGkoMjAzKSxpKDE3MyksaSgzNiksaSgyKSxpKDEzOSksaSgyMDQpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9ImlucHV0LWZpeCBvLWZvcm0tY29udHJvbCBkYXRlLXRpbWUiLG89bmV3IFJlZ0V4cCgiKDBbMC05XXwxWzAtOV18MlswLTNdKTpbMC01XVswLTldOlswLTVdWzAtOV0iKSxhPTUwMCxsPTg7cmV0dXJuIGUuZXh0ZW5kKHt0ZW1wbGF0ZTp0LnRwbCgnXHQgICAgICA8c3BhbiBjbGFzcz0iaWNvbiBpY29uLTE2IGljb24tb25seSBjYWxlbmRhci0xNiIvPlx0ICAgICAgPGlucHV0IHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJ7e3BsYWNlaG9sZGVyfX0iIGF1dG9jb21wbGV0ZT0ib2ZmIlx0ICAgICAgICBuYW1lPSJkYXRlIiBjbGFzcz0iZGF0ZS1pbnB1dCIgaWQ9Int7aW5wdXRJZH19X2RhdGUiIHZhbHVlPSJ7e2RhdGVWYWx1ZX19Ii8+XHQgICAgICA8c3BhbiBjbGFzcz0iaWNvbiBpY29uLTE2IGljb24tb25seSB0aW1lLWFsdC0xNiIvPlx0ICAgICAgPGlucHV0IHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJ7e3BsYWNlaG9sZGVyfX0iIG1heGxlbmd0aD0iOCIgbWlubGVuZ3RoPSI4IiBhdXRvY29tcGxldGU9Im9mZiJcdCAgICAgICAgbmFtZT0idGltZSIgY2xhc3M9InRpbWUtaW5wdXQiIGlkPSJ7e2lucHV0SWR9fV90aW1lIiB2YWx1ZT0ie3t0aW1lVmFsdWV9fSIvPlx0ICAgICcpLGV2ZW50czp7ImlucHV0IGlucHV0Ijoid2FpdEFuZFVwZGF0ZSIsImNoYW5nZSBpbnB1dCI6IndhaXRBbmRVcGRhdGUiLCJrZXlkb3duIGlucHV0Ijoid2FpdEFuZFVwZGF0ZSIsImtleXVwIGlucHV0IjpmdW5jdGlvbih0KXtpLmlzRW50ZXIodCk/dGhpcy5tb2RlbC50cmlnZ2VyKCJmb3JtOnNhdmUiKTppLmlzRXNjKHQpJiZ0aGlzLm1vZGVsLnRyaWdnZXIoImZvcm06Y2FuY2VsIil9fSx3YWl0QW5kVXBkYXRlOnIuZGVib3VuY2UoZnVuY3Rpb24odCl7aWYoInRpbWUtaW5wdXQiPT09dC5jdXJyZW50VGFyZ2V0LmNsYXNzTmFtZSl7aWYodC5jdXJyZW50VGFyZ2V0LnZhbHVlLmxlbmd0aDxsKXJldHVybjtvLnRlc3QodC5jdXJyZW50VGFyZ2V0LnZhbHVlKXx8KHQuY3VycmVudFRhcmdldC52YWx1ZT0iMDA6MDA6MDAiKX10aGlzLnVwZGF0ZSgpfSxhKSxlZGl0TW9kZTpmdW5jdGlvbigpe3RoaXMuJGVsLmFkZENsYXNzKHMpO3ZhciB0PW4udXRjKHRoaXMuZ2V0TW9kZWxWYWx1ZSgpKTt0aGlzLm9wdGlvbnMuZGF0ZVZhbHVlPXQuZm9ybWF0KCJNTS9ERC9ZWVlZIiksdGhpcy5vcHRpb25zLnRpbWVWYWx1ZT10LmZvcm1hdCgiSEg6bW06c3MiKSxlLnByb3RvdHlwZS5lZGl0TW9kZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy4kKCIuZGF0ZS1pbnB1dCIpLnBsYWNlaG9sZGVyKCksdGhpcy4kKCIuZGF0ZS1pbnB1dCIpLmRhdGVwaWNrZXIodGhpcy5vcHRpb25zLnBhcmFtcyl9LHJlYWRNb2RlOmZ1bmN0aW9uKCl7ZS5wcm90b3R5cGUucmVhZE1vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuJGVsLnJlbW92ZUNsYXNzKHMpfSx2YWw6ZnVuY3Rpb24oKXtyZXR1cm57ZGF0ZTp0aGlzLiQoJ2lucHV0W3R5cGU9InRleHQiXS5kYXRlLWlucHV0JykudmFsKCksdGltZTp0aGlzLiQoJ2lucHV0W3R5cGU9InRleHQiXS50aW1lLWlucHV0JykudmFsKCl9fSxmb2N1czpmdW5jdGlvbigpe30sdG86ZnVuY3Rpb24odCl7cmV0dXJuIG4udXRjKHQuZGF0ZSt0LnRpbWUsIk1NL0REL1lZWVlISDptbTpzcyIpLmZvcm1hdCgpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxNDcpLGkoMjc5KSxpKDE3NyksaSgyODApXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9ZS50cGwoJ1x0ICAgIDxkaXYgY2xhc3M9ImNsZWFyZml4Ij5cdCAgICAgIDxzcGFuIGNsYXNzPSJsaW5rLWJ1dHRvbiBsaW5rLWJ1dHRvbi1zbWFsbCI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJvZm9ybS5ncm91cHNlbGVjdC5hZGQiIGJ1bmRsZT0ibWVzc2FnZXMifX1cdCAgICAgIDwvc3Bhbj5cdCAgICAgIDxkaXYgY2xhc3M9Imdyb3VwLW1lZGl1bS1hcHAtbG9nby13cmFwcGVyIj48aW1nIGNsYXNzPSJhcHAtbG9nbyIgc3JjPSJ7e21lZGl1bUljb25Vcmx9fSIvPjwvZGl2Plx0ICAgICAgPGRpdiBjbGFzcz0iZ3JvdXAtZGVzYyI+XHQgICAgICAgIDxoMyBjbGFzcz0iZ3JvdXAtZGVzYy1oZWFkZXIiPnt7e2hpZ2hsaWdodGVkTmFtZX19fTwvaDM+XHQgICAgICAgIDxzcGFuIGNsYXNzPSJncm91cC1kZXNjLWluZm8iPnt7I2lmIGFwcEdyb3VwfX17e2FwcEdyb3VwfX0gJiMxODM7IHt7L2lmfX1cdCAgICAgICAge3sjaWYgZGVzY3JpcHRpb259fVx0ICAgICAgICAgIHt7ZGVzY3JpcHRpb259fVx0ICAgICAgICB7e2Vsc2V9fVx0ICAgICAgICAgIHt7aTE4biBjb2RlPSJvZm9ybS5ncm91cHNlbGVjdC5ub19kZXNjcmlwdGlvbiIgYnVuZGxlPSJtZXNzYWdlcyJ9fVx0ICAgICAgICB7ey9pZn19PC9zcGFuPlx0ICAgICAgICA8dWwgY2xhc3M9Imdyb3VwLWRlc2Mtc3RhdHMiPlx0ICAgICAgICAgIDxsaSBjbGFzcz0iaWNvbi0xNiI+PHNwYW4gY2xhc3M9Imljb24gcGVyc29uLTE2LWdyYXkiPjwvc3Bhbj57e3VzZXJzQ291bnR9fTwvbGk+XHQgICAgICAgICAgPGxpIGNsYXNzPSJpY29uLTE2Ij48c3BhbiBjbGFzcz0iaWNvbiBhcHAtMTYtZ3JheSI+PC9zcGFuPnt7YXBwc0NvdW50fX08L2xpPlx0ICAgICAgICAgIHt7I2lmIGdyb3VwUHVzaE1hcHBpbmdzQ291bnR9fVx0ICAgICAgICAgICAgPGxpIGNsYXNzPSJpY29uLTE2Ij5cdCAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Imljb24gaW5hY3RpdmUtc3luYy0xNiI+PC9zcGFuPnt7Z3JvdXBQdXNoTWFwcGluZ3NDb3VudH19IGFwcHNcdCAgICAgICAgICAgIDwvbGk+XHQgICAgICAgICAge3svaWZ9fVx0ICAgICAgICA8L3VsPlx0ICAgICAgPC9kaXY+XHQgICAgPC9kaXY+XHQgICcpLG89ZS50cGwoJ1x0ICAgIDxkaXY+XHQgICAgICA8c3BhbiBjbGFzcz0iZ3JvdXAtc21hbGwtYXBwLWxvZ28td3JhcHBlciI+XHQgICAgICAgIDxpbWcgY2xhc3M9ImxvZ28iIHNyYz0ie3tzbWFsbEljb25Vcmx9fSIvPlx0ICAgICAgPC9zcGFuPlx0ICAgICAgPHNwYW4gY2xhc3M9InNlbGVjdDItY2hvc2VuLXRleHQiPnt7bmFtZX19PC9zcGFuPlx0ICAgIDwvZGl2Plx0ICAnKSxhPWUudHBsKCdcdCAgICAgIHt7I2lmIHNtYWxsSWNvblVybH19XHQgICAgICA8c3BhbiBjbGFzcz0iZ3JvdXAtc21hbGwtYXBwLWxvZ28td3JhcHBlciI+XHQgICAgICAgIDxpbWcgY2xhc3M9ImxvZ28iIHNyYz0ie3tzbWFsbEljb25Vcmx9fSIvPlx0ICAgICAgPC9zcGFuPlx0ICAgICAge3svaWZ9fVx0ICAgICAgPHNwYW4gY2xhc3M9InNlbGVjdDItY2hvc2VuLXRleHQiPnt7bmFtZX19PC9zcGFuPlx0ICAnKTtyZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToiZ3JvdXAtc2VsZWN0LXdyYXAiLGFwaVVSTDoiL2FwaS92MS9ncm91cHMiLGV4dHJhUGFyYW1zOntleHBhbmQ6InN0YXRzLGFwcCIsbGltaXQ6MTB9LHBsYWNlaG9sZGVyOm4ubG9jYWxpemUoIm9mb3JtLmdyb3Vwc2VsZWN0LnBsYWNlaG9sZGVyIiwibWVzc2FnZXMiKSxmb3JtYXRJbnB1dFRvb1Nob3J0Om4ubG9jYWxpemUoIm9mb3JtLmdyb3Vwc2VsZWN0LnNob3J0X2lucHV0IiwibWVzc2FnZXMiKSx0b1N0cmluZ1ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIGEodGhpcy5fZW50aXR5KX0sZm9ybWF0U2VsZWN0aW9uOmZ1bmN0aW9uKHQpe3JldHVybiB0LmVtcHR5P3QubmFtZTpvKHQpfSxmb3JtYXRSZXN1bHQ6ZnVuY3Rpb24odCxlLGksbil7aWYodC5lbXB0eSlyZXR1cm4gdGhpcy5zZWxlY3RFbXB0eU9wdGlvblRlbXBsYXRlKCk7aWYodC5kaXNhYmxlZClyZXR1cm4gZS5hZGRDbGFzcygic2VhcmNoLWluZm8tbXNnIiksdGhpcy5zZWFyY2hJbmZvTXNnVGVtcGxhdGUodCk7dmFyIG89W107cmV0dXJuIHIudXRpbC5tYXJrTWF0Y2godC5uYW1lLGkudGVybSxvLG4pLHQuaGlnaGxpZ2h0ZWROYW1lPW8uam9pbigiIikscyh0KX0scGFyc2U6ZnVuY3Rpb24oZSl7dmFyIGk9dC5leHRlbmQoe30sZSxlLnByb2ZpbGUsZS5fZW1iZWRkZWQuc3RhdHMse3NtYWxsSWNvblVybDp0LmZpbmRXaGVyZShlLl9saW5rcy5sb2dvLHtuYW1lOiJtZWRpdW0ifSkuaHJlZixtZWRpdW1JY29uVXJsOnQuZmluZFdoZXJlKGUuX2xpbmtzLmxvZ28se25hbWU6Im1lZGl1bSJ9KS5ocmVmLG5hbWU6ZS5wcm9maWxlLm5hbWUsYXBwR3JvdXA6ZS5fZW1iZWRkZWQuYXBwJiZlLl9lbWJlZGRlZC5hcHAubGFiZWx9KTtyZXR1cm4gdC5waWNrKGksImlkIiwibmFtZSIsImRlc2NyaXB0aW9uIiwic21hbGxJY29uVXJsIiwibWVkaXVtSWNvblVybCIsInVzZXJzQ291bnQiLCJhcHBzQ291bnQiLCJncm91cFB1c2hNYXBwaW5nc0NvdW50IiwiYXBwR3JvdXAiKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoNSksaSgyMDMpLGkoMTQ3KSxpKDE3NyksaSgyODApXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9e2tleXVwOmZ1bmN0aW9uKHQpe3Quc3RvcFByb3BhZ2F0aW9uKCl9fTtyZXR1cm4gaS5leHRlbmQoe3RlbXBsYXRlOm4udHBsKCc8aW5wdXQgbmFtZT0ie3tuYW1lfX0iIGlkPSJ7e2lucHV0SWR9fSIgdHlwZT0iaGlkZGVuIj48L2lucHV0PicpLHNlbGVjdEVtcHR5T3B0aW9uVGVtcGxhdGU6bi50cGwoJ1x0ICAgICAgPGRpdiBjbGFzcz0iZW1wdHktb3B0aW9uIiI+PHA+e3tpMThuIGNvZGU9Im9mb3JtLmJhc2VzZWxlY3QucmVzZXQiIGJ1bmRsZT0ibWVzc2FnZXMifX08L3A+PC9kaXY+XHQgICAgJyksc2VhcmNoSW5mb01zZ1RlbXBsYXRlOm4udHBsKCI8cD57e25hbWV9fTwvcD4iKSxldmVudHM6e30sbmFtZUF0dHJpYnV0ZToibmFtZSIsZXh0cmFQYXJhbXM6e30sYXBpVVJMOm51bGwscXVlcnlQYXJhbToicSIscGxhY2Vob2xkZXI6dm9pZCAwLGRyb3Bkb3duQ3NzQ2xhc3M6dm9pZCAwLGZvcm1hdE5vTWF0Y2hlczpyLmxvY2FsaXplKCJvZm9ybS5iYXNlc2VsZWN0Lm5vcmVzdWx0cyIsIm1lc3NhZ2VzIiksZm9ybWF0U2VhcmNoaW5nOnIubG9jYWxpemUoIm9mb3JtLmJhc2VzZWxlY3Quc2VhcmNoaW5nIiwibWVzc2FnZXMiKSxmb3JtYXRBamF4RXJyb3I6ci5sb2NhbGl6ZSgib2Zvcm0uYmFzZXNlbGVjdC5hamF4X2Vycm9yIiwibWVzc2FnZXMiKSxmb3JtYXRJbnB1dFRvb1Nob3J0OnIubG9jYWxpemUoIm9mb3JtLmJhc2VzZWxlY3Quc2hvcnRfaW5wdXQiLCJtZXNzYWdlcyIpLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKGUpe2lmKCF0aGlzLmFwaVVSTCl0aHJvdyBuZXcgRXJyb3IoImFwaVVSTCBub3QgcHJvdmlkZWQiKTt0LmRlZmF1bHRzKHRoaXMuZXZlbnRzLHMpLGkuY2FsbCh0aGlzLGUpLHRoaXMuZXh0cmFQYXJhbXMuZmlsdGVyPXRoaXMuZ2V0UGFyYW0oImZpbHRlciIpLHRoaXMuX2VudGl0eT17fSx0LmJpbmRBbGwodGhpcywiYnVpbGRRdWVyeSIsInBhcnNlQWxsIiwicHJvY2Vzc1Jlc3VsdHMiLCJpbml0U2VsZWN0aW9uIiwic2VsZWN0RW50aXR5IiwiZ2V0TmFtZVZhbHVlIiwiZm9ybWF0UmVzdWx0Iil9LHRvU3RyaW5nVmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZW50aXR5W3RoaXMubmFtZUF0dHJpYnV0ZV18fHRoaXMuZGVmYXVsdFZhbHVlKCl9LHZhbDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl92YWx1ZX0sZm9jdXM6ZnVuY3Rpb24oKXt0LmRlZmVyKHQuYmluZChmdW5jdGlvbigpe3RoaXMuJCgiLnNlbGVjdDItZm9jdXNzZXIiKS5mb2N1cygpfSx0aGlzKSl9LHJlYWRNb2RlOmZ1bmN0aW9uKCl7dGhpcy4kZWwuZW1wdHkoKSx0aGlzLnByZWZldGNoKHQuYmluZChmdW5jdGlvbihlKXtlLmxlbmd0aD90aGlzLl9lbnRpdHk9dGhpcy5wYXJzZSh0LmZpcnN0KGUpKTp0aGlzLl9lbnRpdHk9e30sdGhpcy4kZWwuaHRtbCh0aGlzLmdldFJlYWRNb2RlU3RyaW5nKCkpLHRoaXMubW9kZWwudHJpZ2dlcigiZm9ybTpyZXNpemUiKX0sdGhpcykpfSxlZGl0TW9kZTpmdW5jdGlvbigpe3RoaXMuJGVsLmVtcHR5KCksaS5wcm90b3R5cGUuZWRpdE1vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciB0PXRoaXMuX3NlbGVjdDIoKTt0Lm9uKCJzZWxlY3QyLXNlbGVjdGluZyIsdGhpcy5zZWxlY3RFbnRpdHkpLHRoaXMuX3ByZWZpbGwodCl9LF9zZWxlY3QyOmZ1bmN0aW9uKCl7dmFyIGU9e2FqYXg6e3VybDp0aGlzLmFwaVVSTCxkYXRhVHlwZToianNvbiIscXVpZXRNaWxsaXM6MTAwLGRhdGE6dGhpcy5idWlsZFF1ZXJ5LHJlc3VsdHM6dGhpcy5wcm9jZXNzUmVzdWx0c30sd2lkdGg6dGhpcy5vcHRpb25zLnBhcmFtcyYmdC5yZXN1bHRDdHgodGhpcy5vcHRpb25zLnBhcmFtcywid2lkdGgiLHRoaXMpfHx0LnJlc3VsdCh0aGlzLCJ3aWR0aCIpfHwiMTAwJSIsdGV4dDp0aGlzLmdldE5hbWVWYWx1ZSxkcm9wZG93bkNzc0NsYXNzOnRoaXMub3B0aW9ucy5wYXJhbXMmJnQucmVzdWx0Q3R4KHRoaXMub3B0aW9ucy5wYXJhbXMsImRyb3Bkb3duQ3NzQ2xhc3MiLHRoaXMpfHx0LnJlc3VsdCh0aGlzLCJkcm9wZG93bkNzc0NsYXNzIiksb3Blbk9uRW50ZXI6ITAsZm9ybWF0UmVzdWx0OnRoaXMuZm9ybWF0UmVzdWx0LGZvcm1hdFNlbGVjdGlvbjp0aGlzLmZvcm1hdFNlbGVjdGlvbixmb3JtYXROb01hdGNoZXM6dGhpcy5mb3JtYXROb01hdGNoZXMsZm9ybWF0U2VhcmNoaW5nOnRoaXMuZm9ybWF0U2VhcmNoaW5nLGZvcm1hdEFqYXhFcnJvcjp0aGlzLmZvcm1hdEFqYXhFcnJvcixpbml0U2VsZWN0aW9uOnRoaXMuaW5pdFNlbGVjdGlvbn07cmV0dXJuIHRoaXMuX2VtcHR5T3B0aW9uPXtpZDoiIixlbXB0eTohMCxuYW1lOnRoaXMub3B0aW9ucy5wbGFjZWhvbGRlcnx8dGhpcy5wbGFjZWhvbGRlcn0sdGhpcy5fbm9SZXN1bHRzTXNnPXtkaXNhYmxlZDohMCxuYW1lOnRoaXMub3B0aW9ucy5mb3JtYXROb01hdGNoZXN8fHRoaXMuZm9ybWF0Tm9NYXRjaGVzfSx0aGlzLl9zdGFydFR5cGluZ01zZz17ZGlzYWJsZWQ6ITAsbmFtZTp0aGlzLm9wdGlvbnMuZm9ybWF0SW5wdXRUb29TaG9ydHx8dGhpcy5mb3JtYXRJbnB1dFRvb1Nob3J0fSx0aGlzLiQoImlucHV0Iikuc2VsZWN0MihlKX0saW5pdFNlbGVjdGlvbjpmdW5jdGlvbih0LGUpe2UodGhpcy5fZW50aXR5JiZ0aGlzLl9lbnRpdHkuaWQ/dGhpcy5fZW50aXR5OnRoaXMuX2VtcHR5T3B0aW9uKX0sYnVpbGRRdWVyeTpmdW5jdGlvbihlKXt2YXIgaT17fTtyZXR1cm4gaVt0aGlzLnF1ZXJ5UGFyYW1dPWUsdGhpcy5leHRyYVBhcmFtcyYmIXQuaXNFbXB0eSh0aGlzLmV4dHJhUGFyYW1zKSYmdC5leHRlbmQoaSx0aGlzLmV4dHJhUGFyYW1zKSxpfSxwcm9jZXNzUmVzdWx0czpmdW5jdGlvbih0LGUsaSl7dmFyIG49W107cmV0dXJuIiI9PT1pLnRlcm0/bj1bdGhpcy5fc3RhcnRUeXBpbmdNc2csdGhpcy5fZW1wdHlPcHRpb25dOihuPXRoaXMucGFyc2VBbGwodCksMD09PW4ubGVuZ3RoP24ucHVzaCh0aGlzLl9ub1Jlc3VsdHNNc2csdGhpcy5fZW1wdHlPcHRpb24pOm4ucHVzaCh0aGlzLl9lbXB0eU9wdGlvbikpLHtyZXN1bHRzOm59fSxmb3JtYXRSZXN1bHQ6ZnVuY3Rpb24oKXt9LGZvcm1hdFNlbGVjdGlvbjpmdW5jdGlvbigpe30sZ2V0TmFtZVZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB0W3RoaXMubmFtZUF0dHJpYnV0ZV19LHBhcnNlQWxsOmZ1bmN0aW9uKGUpe3JldHVybiB0Lm1hcChlLHRoaXMucGFyc2UpfSxwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdH0sX3ByZWZpbGw6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpczt0aGlzLmRpc2FibGUoKSx0aGlzLnByZWZldGNoKGZ1bmN0aW9uKG4pe24ubGVuZ3RoJiYoaS5fZW50aXR5PWkucGFyc2UodC5maXJzdChuKSkpLGUuc2VsZWN0MigidmFsIixpLl9lbnRpdHkpLGkuZW5hYmxlKCl9LHQuYmluZChpLmVuYWJsZSxpKSl9LHByZWZldGNoOmZ1bmN0aW9uKHQsaSl7dmFyIG49dGhpcy5nZXRNb2RlbFZhbHVlKCk7aWYoIW4pcmV0dXJuIHZvaWQgdChbXSk7dmFyIHI9ZS5nZXQodGhpcy5hcGlVUkwsdGhpcy5idWlsZFByZWZldGNoUXVlcnkobiksdCk7aSYmci5lcnJvcihpKX0sYnVpbGRQcmVmZXRjaFF1ZXJ5OmZ1bmN0aW9uKGUpe3JldHVybiB0LmV4dGVuZCh7fSx0aGlzLmV4dHJhUGFyYW1zLHtmaWx0ZXI6J2lkIGVxICInK2UrJyInfSl9LHNlbGVjdEVudGl0eTpmdW5jdGlvbih0KXt0aGlzLl91cGRhdGVNb2RlbCh0LmNob2ljZSl9LF91cGRhdGVNb2RlbDpmdW5jdGlvbih0KXt0aGlzLl9lbnRpdHk9dCx0aGlzLl92YWx1ZT10LmlkLHRoaXMudXBkYXRlKCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSg2KV0scj1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gZnVuY3Rpb24odCl7InVuZGVmaW5lZCI9PXR5cGVvZiB0LmZuLmVhY2gyJiZ0LmV4dGVuZCh0LmZuLHtlYWNoMjpmdW5jdGlvbihlKXtmb3IodmFyIGk9dChbMF0pLG49LTEscj10aGlzLmxlbmd0aDsrK248ciYmKGkuY29udGV4dD1pWzBdPXRoaXNbbl0pJiZlLmNhbGwoaVswXSxuLGkpIT09ITE7KTtyZXR1cm4gdGhpc319KX0odCksZnVuY3Rpb24odCxpKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXt2YXIgaT10KGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCIiKSk7ZS5iZWZvcmUoaSksaS5iZWZvcmUoZSksaS5yZW1vdmUoKX1mdW5jdGlvbiByKHQpe2Z1bmN0aW9uIGUodCl7cmV0dXJuIFVbdF18fHR9cmV0dXJuIHQucmVwbGFjZSgvW15cdTAwMDAtXHUwMDdFXS9nLGUpfWZ1bmN0aW9uIHModCxlKXtmb3IodmFyIGk9MCxuPWUubGVuZ3RoO2k8bjtpKz0xKWlmKGEodCxlW2ldKSlyZXR1cm4gaTtyZXR1cm4tMX1mdW5jdGlvbiBvKCl7dmFyIGU9dChGKTtlLmFwcGVuZFRvKCJib2R5Iik7dmFyIGk9e3dpZHRoOmUud2lkdGgoKS1lWzBdLmNsaWVudFdpZHRoLGhlaWdodDplLmhlaWdodCgpLWVbMF0uY2xpZW50SGVpZ2h0fTtyZXR1cm4gZS5yZW1vdmUoKSxpfWZ1bmN0aW9uIGEodCxlKXtyZXR1cm4gdD09PWV8fHQhPT1pJiZlIT09aSYmKG51bGwhPT10JiZudWxsIT09ZSYmKHQuY29uc3RydWN0b3I9PT1TdHJpbmc/dCsiIj09ZSsiIjplLmNvbnN0cnVjdG9yPT09U3RyaW5nJiZlKyIiPT10KyIiKSl9ZnVuY3Rpb24gbChlLGkpe3ZhciBuLHIscztpZihudWxsPT09ZXx8ZS5sZW5ndGg8MSlyZXR1cm5bXTtmb3Iobj1lLnNwbGl0KGkpLHI9MCxzPW4ubGVuZ3RoO3I8cztyKz0xKW5bcl09dC50cmltKG5bcl0pO3JldHVybiBufWZ1bmN0aW9uIGModCl7cmV0dXJuIHQub3V0ZXJXaWR0aCghMSktdC53aWR0aCgpfWZ1bmN0aW9uIHUoZSl7dmFyIG49ImtleXVwLWNoYW5nZS12YWx1ZSI7ZS5vbigia2V5ZG93biIsZnVuY3Rpb24oKXt0LmRhdGEoZSxuKT09PWkmJnQuZGF0YShlLG4sZS52YWwoKSl9KSxlLm9uKCJrZXl1cCIsZnVuY3Rpb24oKXt2YXIgcj10LmRhdGEoZSxuKTtyIT09aSYmZS52YWwoKSE9PXImJih0LnJlbW92ZURhdGEoZSxuKSxlLnRyaWdnZXIoImtleXVwLWNoYW5nZSIpKX0pfWZ1bmN0aW9uIGQoZSl7ZS5vbigibW91c2Vtb3ZlIixmdW5jdGlvbihlKXt2YXIgbj1qO24hPT1pJiZuLng9PT1lLnBhZ2VYJiZuLnk9PT1lLnBhZ2VZfHx0KGUudGFyZ2V0KS50cmlnZ2VyKCJtb3VzZW1vdmUtZmlsdGVyZWQiLGUpfSl9ZnVuY3Rpb24gaCh0LGUsbil7bj1ufHxpO3ZhciByO3JldHVybiBmdW5jdGlvbigpe3ZhciBpPWFyZ3VtZW50czt3aW5kb3cuY2xlYXJUaW1lb3V0KHIpLHI9d2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLmFwcGx5KG4saSl9LHQpfX1mdW5jdGlvbiBwKHQsZSl7dmFyIGk9aCh0LGZ1bmN0aW9uKHQpe2UudHJpZ2dlcigic2Nyb2xsLWRlYm91bmNlZCIsdCl9KTtlLm9uKCJzY3JvbGwiLGZ1bmN0aW9uKHQpe3ModC50YXJnZXQsZS5nZXQoKSk+PTAmJmkodCl9KX1mdW5jdGlvbiBmKHQpe3RbMF0hPT1kb2N1bWVudC5hY3RpdmVFbGVtZW50JiZ3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe3ZhciBlLGk9dFswXSxuPXQudmFsKCkubGVuZ3RoO3QuZm9jdXMoKTt2YXIgcj1pLm9mZnNldFdpZHRoPjB8fGkub2Zmc2V0SGVpZ2h0PjA7ciYmaT09PWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQmJihpLnNldFNlbGVjdGlvblJhbmdlP2kuc2V0U2VsZWN0aW9uUmFuZ2UobixuKTppLmNyZWF0ZVRleHRSYW5nZSYmKGU9aS5jcmVhdGVUZXh0UmFuZ2UoKSxlLmNvbGxhcHNlKCExKSxlLnNlbGVjdCgpKSl9LDApfWZ1bmN0aW9uIG0oZSl7ZT10KGUpWzBdO3ZhciBpPTAsbj0wO2lmKCJzZWxlY3Rpb25TdGFydCJpbiBlKWk9ZS5zZWxlY3Rpb25TdGFydCxuPWUuc2VsZWN0aW9uRW5kLWk7ZWxzZSBpZigic2VsZWN0aW9uImluIGRvY3VtZW50KXtlLmZvY3VzKCk7dmFyIHI9ZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7bj1kb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKS50ZXh0Lmxlbmd0aCxyLm1vdmVTdGFydCgiY2hhcmFjdGVyIiwtZS52YWx1ZS5sZW5ndGgpLGk9ci50ZXh0Lmxlbmd0aC1ufXJldHVybntvZmZzZXQ6aSxsZW5ndGg6bn19ZnVuY3Rpb24gXyh0KXt0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKX1mdW5jdGlvbiBnKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpfWZ1bmN0aW9uIHYoZSl7aWYoIVApe3ZhciBpPWVbMF0uY3VycmVudFN0eWxlfHx3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlWzBdLG51bGwpO1A9dChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSkuY3NzKHtwb3NpdGlvbjoiYWJzb2x1dGUiLGxlZnQ6Ii0xMDAwMHB4Iix0b3A6Ii0xMDAwMHB4IixkaXNwbGF5OiJub25lIixmb250U2l6ZTppLmZvbnRTaXplLGZvbnRGYW1pbHk6aS5mb250RmFtaWx5LGZvbnRTdHlsZTppLmZvbnRTdHlsZSxmb250V2VpZ2h0OmkuZm9udFdlaWdodCxsZXR0ZXJTcGFjaW5nOmkubGV0dGVyU3BhY2luZyx0ZXh0VHJhbnNmb3JtOmkudGV4dFRyYW5zZm9ybSx3aGl0ZVNwYWNlOiJub3dyYXAifSksUC5hdHRyKCJjbGFzcyIsInNlbGVjdDItc2l6ZXIiKSx0KCJib2R5IikuYXBwZW5kKFApfXJldHVybiBQLnRleHQoZS52YWwoKSksUC53aWR0aCgpfWZ1bmN0aW9uIHkoZSxpLG4pe3ZhciByLHMsbz1bXTtyPXQudHJpbShlLmF0dHIoImNsYXNzIikpLHImJihyPSIiK3IsdChyLnNwbGl0KC9ccysvKSkuZWFjaDIoZnVuY3Rpb24oKXswPT09dGhpcy5pbmRleE9mKCJzZWxlY3QyLSIpJiZvLnB1c2godGhpcyl9KSkscj10LnRyaW0oaS5hdHRyKCJjbGFzcyIpKSxyJiYocj0iIityLHQoci5zcGxpdCgvXHMrLykpLmVhY2gyKGZ1bmN0aW9uKCl7MCE9PXRoaXMuaW5kZXhPZigic2VsZWN0Mi0iKSYmKHM9bih0aGlzKSxzJiZvLnB1c2gocykpfSkpLGUuYXR0cigiY2xhc3MiLG8uam9pbigiICIpKX1mdW5jdGlvbiBiKHQsZSxpLG4pe3ZhciBzPXIodC50b1VwcGVyQ2FzZSgpKS5pbmRleE9mKHIoZS50b1VwcGVyQ2FzZSgpKSksbz1lLmxlbmd0aDtyZXR1cm4gczwwP3ZvaWQgaS5wdXNoKG4odCkpOihpLnB1c2gobih0LnN1YnN0cmluZygwLHMpKSksaS5wdXNoKCI8c3BhbiBjbGFzcz0nc2VsZWN0Mi1tYXRjaCc+IiksaS5wdXNoKG4odC5zdWJzdHJpbmcocyxzK28pKSksaS5wdXNoKCI8L3NwYW4+Iiksdm9pZCBpLnB1c2gobih0LnN1YnN0cmluZyhzK28sdC5sZW5ndGgpKSkpfWZ1bmN0aW9uIHcodCl7dmFyIGU9eyJcXCI6IiYjOTI7IiwiJiI6IiZhbXA7IiwiPCI6IiZsdDsiLCI+IjoiJmd0OyIsJyInOiImcXVvdDsiLCInIjoiJiMzOTsiLCIvIjoiJiM0NzsifTtyZXR1cm4gU3RyaW5nKHQpLnJlcGxhY2UoL1smPD4iJ1wvXFxdL2csZnVuY3Rpb24odCl7cmV0dXJuIGVbdF19KX1mdW5jdGlvbiBNKGUpe3ZhciBuLHI9bnVsbCxzPWUucXVpZXRNaWxsaXN8fDEwMCxvPWUudXJsLGE9dGhpcztyZXR1cm4gZnVuY3Rpb24obCl7d2luZG93LmNsZWFyVGltZW91dChuKSxuPXdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dmFyIG49ZS5kYXRhLHM9byxjPWUudHJhbnNwb3J0fHx0LmZuLnNlbGVjdDIuYWpheERlZmF1bHRzLnRyYW5zcG9ydCx1PXt0eXBlOmUudHlwZXx8IkdFVCIsY2FjaGU6ZS5jYWNoZXx8ITEsanNvbnBDYWxsYmFjazplLmpzb25wQ2FsbGJhY2t8fGksZGF0YVR5cGU6ZS5kYXRhVHlwZXx8Impzb24ifSxkPXQuZXh0ZW5kKHt9LHQuZm4uc2VsZWN0Mi5hamF4RGVmYXVsdHMucGFyYW1zLHUpO249bj9uLmNhbGwoYSxsLnRlcm0sbC5wYWdlLGwuY29udGV4dCk6bnVsbCxzPSJmdW5jdGlvbiI9PXR5cGVvZiBzP3MuY2FsbChhLGwudGVybSxsLnBhZ2UsbC5jb250ZXh0KTpzLHImJiJmdW5jdGlvbiI9PXR5cGVvZiByLmFib3J0JiZyLmFib3J0KCksZS5wYXJhbXMmJih0LmlzRnVuY3Rpb24oZS5wYXJhbXMpP3QuZXh0ZW5kKGQsZS5wYXJhbXMuY2FsbChhKSk6dC5leHRlbmQoZCxlLnBhcmFtcykpLHQuZXh0ZW5kKGQse3VybDpzLGRhdGFUeXBlOmUuZGF0YVR5cGUsZGF0YTpuLHN1Y2Nlc3M6ZnVuY3Rpb24odCl7dmFyIGk9ZS5yZXN1bHRzKHQsbC5wYWdlLGwpO2wuY2FsbGJhY2soaSl9LGVycm9yOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj17aGFzRXJyb3I6ITAsanFYSFI6dCx0ZXh0U3RhdHVzOmUsZXJyb3JUaHJvd246aX07bC5jYWxsYmFjayhuKX19KSxyPWMuY2FsbChhLGQpfSxzKX19ZnVuY3Rpb24gayhlKXt2YXIgaSxuLHI9ZSxzPWZ1bmN0aW9uKHQpe3JldHVybiIiK3QudGV4dH07dC5pc0FycmF5KHIpJiYobj1yLHI9e3Jlc3VsdHM6bn0pLHQuaXNGdW5jdGlvbihyKT09PSExJiYobj1yLHI9ZnVuY3Rpb24oKXtyZXR1cm4gbn0pO3ZhciBvPXIoKTtyZXR1cm4gby50ZXh0JiYocz1vLnRleHQsdC5pc0Z1bmN0aW9uKHMpfHwoaT1vLnRleHQscz1mdW5jdGlvbih0KXtyZXR1cm4gdFtpXX0pKSxmdW5jdGlvbihlKXt2YXIgaSxuPWUudGVybSxvPXtyZXN1bHRzOltdfTtyZXR1cm4iIj09PW4/dm9pZCBlLmNhbGxiYWNrKHIoKSk6KGk9ZnVuY3Rpb24ocixvKXt2YXIgYSxsO2lmKHI9clswXSxyLmNoaWxkcmVuKXthPXt9O2ZvcihsIGluIHIpci5oYXNPd25Qcm9wZXJ0eShsKSYmKGFbbF09cltsXSk7YS5jaGlsZHJlbj1bXSx0KHIuY2hpbGRyZW4pLmVhY2gyKGZ1bmN0aW9uKHQsZSl7aShlLGEuY2hpbGRyZW4pfSksKGEuY2hpbGRyZW4ubGVuZ3RofHxlLm1hdGNoZXIobixzKGEpLHIpKSYmby5wdXNoKGEpfWVsc2UgZS5tYXRjaGVyKG4scyhyKSxyKSYmby5wdXNoKHIpfSx0KHIoKS5yZXN1bHRzKS5lYWNoMihmdW5jdGlvbih0LGUpe2koZSxvLnJlc3VsdHMpfSksdm9pZCBlLmNhbGxiYWNrKG8pKX19ZnVuY3Rpb24gVChlKXt2YXIgbj10LmlzRnVuY3Rpb24oZSk7cmV0dXJuIGZ1bmN0aW9uKHIpe3ZhciBzPXIudGVybSxvPXtyZXN1bHRzOltdfSxhPW4/ZShyKTplO3QuaXNBcnJheShhKSYmKHQoYSkuZWFjaChmdW5jdGlvbigpe3ZhciB0PXRoaXMudGV4dCE9PWksZT10P3RoaXMudGV4dDp0aGlzOygiIj09PXN8fHIubWF0Y2hlcihzLGUpKSYmby5yZXN1bHRzLnB1c2godD90aGlzOntpZDp0aGlzLHRleHQ6dGhpc30pfSksci5jYWxsYmFjayhvKSl9fWZ1bmN0aW9uIFMoZSxpKXtpZih0LmlzRnVuY3Rpb24oZSkpcmV0dXJuITA7aWYoIWUpcmV0dXJuITE7aWYoInN0cmluZyI9PXR5cGVvZiBlKXJldHVybiEwO3Rocm93IG5ldyBFcnJvcihpKyIgbXVzdCBiZSBhIHN0cmluZywgZnVuY3Rpb24sIG9yIGZhbHN5IHZhbHVlIil9ZnVuY3Rpb24gTChlLGkpe2lmKHQuaXNGdW5jdGlvbihlKSl7dmFyIG49QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpO3JldHVybiBlLmFwcGx5KGksbil9cmV0dXJuIGV9ZnVuY3Rpb24geChlKXt2YXIgaT0wO3JldHVybiB0LmVhY2goZSxmdW5jdGlvbih0LGUpe2UuY2hpbGRyZW4/aSs9eChlLmNoaWxkcmVuKTppKyt9KSxpfWZ1bmN0aW9uIEUodCxlLG4scil7dmFyIHMsbyxsLGMsdSxkPXQsaD0hMTtpZighci5jcmVhdGVTZWFyY2hDaG9pY2V8fCFyLnRva2VuU2VwYXJhdG9yc3x8ci50b2tlblNlcGFyYXRvcnMubGVuZ3RoPDEpcmV0dXJuIGk7Zm9yKDs7KXtmb3Iobz0tMSxsPTAsYz1yLnRva2VuU2VwYXJhdG9ycy5sZW5ndGg7bDxjJiYodT1yLnRva2VuU2VwYXJhdG9yc1tsXSxvPXQuaW5kZXhPZih1KSwhKG8+PTApKTtsKyspO2lmKG88MClicmVhaztpZihzPXQuc3Vic3RyaW5nKDAsbyksdD10LnN1YnN0cmluZyhvK3UubGVuZ3RoKSxzLmxlbmd0aD4wJiYocz1yLmNyZWF0ZVNlYXJjaENob2ljZS5jYWxsKHRoaXMscyxlKSxzIT09aSYmbnVsbCE9PXMmJnIuaWQocykhPT1pJiZudWxsIT09ci5pZChzKSkpe2ZvcihoPSExLGw9MCxjPWUubGVuZ3RoO2w8YztsKyspaWYoYShyLmlkKHMpLHIuaWQoZVtsXSkpKXtoPSEwO2JyZWFrfWh8fG4ocyl9fXJldHVybiBkIT09dD90OnZvaWQgMH1mdW5jdGlvbiBEKCl7dmFyIGU9dGhpczt0LmVhY2goYXJndW1lbnRzLGZ1bmN0aW9uKHQsaSl7ZVtpXS5yZW1vdmUoKSxlW2ldPW51bGx9KX1mdW5jdGlvbiBZKGUsaSl7dmFyIG49ZnVuY3Rpb24oKXt9O3JldHVybiBuLnByb3RvdHlwZT1uZXcgZSxuLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1uLG4ucHJvdG90eXBlLnBhcmVudD1lLnByb3RvdHlwZSxuLnByb3RvdHlwZT10LmV4dGVuZChuLnByb3RvdHlwZSxpKSxufWlmKGU9PT1pKXt2YXIgQyxBLE8sTixJLFAsUixILGo9e3g6MCx5OjB9LEM9e1RBQjo5LEVOVEVSOjEzLEVTQzoyNyxTUEFDRTozMixMRUZUOjM3LFVQOjM4LFJJR0hUOjM5LERPV046NDAsU0hJRlQ6MTYsQ1RSTDoxNyxBTFQ6MTgsUEFHRV9VUDozMyxQQUdFX0RPV046MzQsSE9NRTozNixFTkQ6MzUsQkFDS1NQQUNFOjgsREVMRVRFOjQ2LGlzQXJyb3c6ZnVuY3Rpb24odCl7c3dpdGNoKHQ9dC53aGljaD90LndoaWNoOnQpe2Nhc2UgQy5MRUZUOmNhc2UgQy5SSUdIVDpjYXNlIEMuVVA6Y2FzZSBDLkRPV046cmV0dXJuITB9cmV0dXJuITF9LGlzQ29udHJvbDpmdW5jdGlvbih0KXt2YXIgZT10LndoaWNoO3N3aXRjaChlKXtjYXNlIEMuU0hJRlQ6Y2FzZSBDLkNUUkw6Y2FzZSBDLkFMVDpyZXR1cm4hMH1yZXR1cm4hIXQubWV0YUtleX0saXNGdW5jdGlvbktleTpmdW5jdGlvbih0KXtyZXR1cm4gdD10LndoaWNoP3Qud2hpY2g6dCx0Pj0xMTImJnQ8PTEyM319LEY9IjxkaXYgY2xhc3M9J3NlbGVjdDItbWVhc3VyZS1zY3JvbGxiYXInPjwvZGl2PiIsVT17IuKStiI6IkEiLCLvvKEiOiJBIiwiw4AiOiJBIiwiw4EiOiJBIiwiw4IiOiJBIiwi4bqmIjoiQSIsIuG6pCI6IkEiLCLhuqoiOiJBIiwi4bqoIjoiQSIsIsODIjoiQSIsIsSAIjoiQSIsIsSCIjoiQSIsIuG6sCI6IkEiLCLhuq4iOiJBIiwi4bq0IjoiQSIsIuG6siI6IkEiLCLIpiI6IkEiLCLHoCI6IkEiLCLDhCI6IkEiLCLHniI6IkEiLCLhuqIiOiJBIiwiw4UiOiJBIiwix7oiOiJBIiwix40iOiJBIiwiyIAiOiJBIiwiyIIiOiJBIiwi4bqgIjoiQSIsIuG6rCI6IkEiLCLhurYiOiJBIiwi4biAIjoiQSIsIsSEIjoiQSIsIsi6IjoiQSIsIuKxryI6IkEiLCLqnLIiOiJBQSIsIsOGIjoiQUUiLCLHvCI6IkFFIiwix6IiOiJBRSIsIuqctCI6IkFPIiwi6py2IjoiQVUiLCLqnLgiOiJBViIsIuqcuiI6IkFWIiwi6py8IjoiQVkiLCLikrciOiJCIiwi77yiIjoiQiIsIuG4giI6IkIiLCLhuIQiOiJCIiwi4biGIjoiQiIsIsmDIjoiQiIsIsaCIjoiQiIsIsaBIjoiQiIsIuKSuCI6IkMiLCLvvKMiOiJDIiwixIYiOiJDIiwixIgiOiJDIiwixIoiOiJDIiwixIwiOiJDIiwiw4ciOiJDIiwi4biIIjoiQyIsIsaHIjoiQyIsIsi7IjoiQyIsIuqcviI6IkMiLCLikrkiOiJEIiwi77ykIjoiRCIsIuG4iiI6IkQiLCLEjiI6IkQiLCLhuIwiOiJEIiwi4biQIjoiRCIsIuG4kiI6IkQiLCLhuI4iOiJEIiwixJAiOiJEIiwixosiOiJEIiwixooiOiJEIiwixokiOiJEIiwi6p25IjoiRCIsIsexIjoiRFoiLCLHhCI6IkRaIiwix7IiOiJEeiIsIseFIjoiRHoiLCLikroiOiJFIiwi77ylIjoiRSIsIsOIIjoiRSIsIsOJIjoiRSIsIsOKIjoiRSIsIuG7gCI6IkUiLCLhur4iOiJFIiwi4buEIjoiRSIsIuG7giI6IkUiLCLhurwiOiJFIiwixJIiOiJFIiwi4biUIjoiRSIsIuG4liI6IkUiLCLElCI6IkUiLCLEliI6IkUiLCLDiyI6IkUiLCLhuroiOiJFIiwixJoiOiJFIiwiyIQiOiJFIiwiyIYiOiJFIiwi4bq4IjoiRSIsIuG7hiI6IkUiLCLIqCI6IkUiLCLhuJwiOiJFIiwixJgiOiJFIiwi4biYIjoiRSIsIuG4miI6IkUiLCLGkCI6IkUiLCLGjiI6IkUiLCLikrsiOiJGIiwi77ymIjoiRiIsIuG4niI6IkYiLCLGkSI6IkYiLCLqnbsiOiJGIiwi4pK8IjoiRyIsIu+8pyI6IkciLCLHtCI6IkciLCLEnCI6IkciLCLhuKAiOiJHIiwixJ4iOiJHIiwixKAiOiJHIiwix6YiOiJHIiwixKIiOiJHIiwix6QiOiJHIiwixpMiOiJHIiwi6p6gIjoiRyIsIuqdvSI6IkciLCLqnb4iOiJHIiwi4pK9IjoiSCIsIu+8qCI6IkgiLCLEpCI6IkgiLCLhuKIiOiJIIiwi4bimIjoiSCIsIsieIjoiSCIsIuG4pCI6IkgiLCLhuKgiOiJIIiwi4biqIjoiSCIsIsSmIjoiSCIsIuKxpyI6IkgiLCLisbUiOiJIIiwi6p6NIjoiSCIsIuKSviI6IkkiLCLvvKkiOiJJIiwiw4wiOiJJIiwiw40iOiJJIiwiw44iOiJJIiwixKgiOiJJIiwixKoiOiJJIiwixKwiOiJJIiwixLAiOiJJIiwiw48iOiJJIiwi4biuIjoiSSIsIuG7iCI6IkkiLCLHjyI6IkkiLCLIiCI6IkkiLCLIiiI6IkkiLCLhu4oiOiJJIiwixK4iOiJJIiwi4bisIjoiSSIsIsaXIjoiSSIsIuKSvyI6IkoiLCLvvKoiOiJKIiwixLQiOiJKIiwiyYgiOiJKIiwi4pOAIjoiSyIsIu+8qyI6IksiLCLhuLAiOiJLIiwix6giOiJLIiwi4biyIjoiSyIsIsS2IjoiSyIsIuG4tCI6IksiLCLGmCI6IksiLCLisakiOiJLIiwi6p2AIjoiSyIsIuqdgiI6IksiLCLqnYQiOiJLIiwi6p6iIjoiSyIsIuKTgSI6IkwiLCLvvKwiOiJMIiwixL8iOiJMIiwixLkiOiJMIiwixL0iOiJMIiwi4bi2IjoiTCIsIuG4uCI6IkwiLCLEuyI6IkwiLCLhuLwiOiJMIiwi4bi6IjoiTCIsIsWBIjoiTCIsIsi9IjoiTCIsIuKxoiI6IkwiLCLisaAiOiJMIiwi6p2IIjoiTCIsIuqdhiI6IkwiLCLqnoAiOiJMIiwix4ciOiJMSiIsIseIIjoiTGoiLCLik4IiOiJNIiwi77ytIjoiTSIsIuG4viI6Ik0iLCLhuYAiOiJNIiwi4bmCIjoiTSIsIuKxriI6Ik0iLCLGnCI6Ik0iLCLik4MiOiJOIiwi77yuIjoiTiIsIse4IjoiTiIsIsWDIjoiTiIsIsORIjoiTiIsIuG5hCI6Ik4iLCLFhyI6Ik4iLCLhuYYiOiJOIiwixYUiOiJOIiwi4bmKIjoiTiIsIuG5iCI6Ik4iLCLIoCI6Ik4iLCLGnSI6Ik4iLCLqnpAiOiJOIiwi6p6kIjoiTiIsIseKIjoiTkoiLCLHiyI6Ik5qIiwi4pOEIjoiTyIsIu+8ryI6Ik8iLCLDkiI6Ik8iLCLDkyI6Ik8iLCLDlCI6Ik8iLCLhu5IiOiJPIiwi4buQIjoiTyIsIuG7liI6Ik8iLCLhu5QiOiJPIiwiw5UiOiJPIiwi4bmMIjoiTyIsIsisIjoiTyIsIuG5jiI6Ik8iLCLFjCI6Ik8iLCLhuZAiOiJPIiwi4bmSIjoiTyIsIsWOIjoiTyIsIsiuIjoiTyIsIsiwIjoiTyIsIsOWIjoiTyIsIsiqIjoiTyIsIuG7jiI6Ik8iLCLFkCI6Ik8iLCLHkSI6Ik8iLCLIjCI6Ik8iLCLIjiI6Ik8iLCLGoCI6Ik8iLCLhu5wiOiJPIiwi4buaIjoiTyIsIuG7oCI6Ik8iLCLhu54iOiJPIiwi4buiIjoiTyIsIuG7jCI6Ik8iLCLhu5giOiJPIiwix6oiOiJPIiwix6wiOiJPIiwiw5giOiJPIiwix74iOiJPIiwixoYiOiJPIiwixp8iOiJPIiwi6p2KIjoiTyIsIuqdjCI6Ik8iLCLGoiI6Ik9JIiwi6p2OIjoiT08iLCLIoiI6Ik9VIiwi4pOFIjoiUCIsIu+8sCI6IlAiLCLhuZQiOiJQIiwi4bmWIjoiUCIsIsakIjoiUCIsIuKxoyI6IlAiLCLqnZAiOiJQIiwi6p2SIjoiUCIsIuqdlCI6IlAiLCLik4YiOiJRIiwi77yxIjoiUSIsIuqdliI6IlEiLCLqnZgiOiJRIiwiyYoiOiJRIiwi4pOHIjoiUiIsIu+8siI6IlIiLCLFlCI6IlIiLCLhuZgiOiJSIiwixZgiOiJSIiwiyJAiOiJSIiwiyJIiOiJSIiwi4bmaIjoiUiIsIuG5nCI6IlIiLCLFliI6IlIiLCLhuZ4iOiJSIiwiyYwiOiJSIiwi4rGkIjoiUiIsIuqdmiI6IlIiLCLqnqYiOiJSIiwi6p6CIjoiUiIsIuKTiCI6IlMiLCLvvLMiOiJTIiwi4bqeIjoiUyIsIsWaIjoiUyIsIuG5pCI6IlMiLCLFnCI6IlMiLCLhuaAiOiJTIiwixaAiOiJTIiwi4bmmIjoiUyIsIuG5oiI6IlMiLCLhuagiOiJTIiwiyJgiOiJTIiwixZ4iOiJTIiwi4rG+IjoiUyIsIuqeqCI6IlMiLCLqnoQiOiJTIiwi4pOJIjoiVCIsIu+8tCI6IlQiLCLhuaoiOiJUIiwixaQiOiJUIiwi4bmsIjoiVCIsIsiaIjoiVCIsIsWiIjoiVCIsIuG5sCI6IlQiLCLhua4iOiJUIiwixaYiOiJUIiwixqwiOiJUIiwixq4iOiJUIiwiyL4iOiJUIiwi6p6GIjoiVCIsIuqcqCI6IlRaIiwi4pOKIjoiVSIsIu+8tSI6IlUiLCLDmSI6IlUiLCLDmiI6IlUiLCLDmyI6IlUiLCLFqCI6IlUiLCLhubgiOiJVIiwixaoiOiJVIiwi4bm6IjoiVSIsIsWsIjoiVSIsIsOcIjoiVSIsIsebIjoiVSIsIseXIjoiVSIsIseVIjoiVSIsIseZIjoiVSIsIuG7piI6IlUiLCLFriI6IlUiLCLFsCI6IlUiLCLHkyI6IlUiLCLIlCI6IlUiLCLIliI6IlUiLCLGryI6IlUiLCLhu6oiOiJVIiwi4buoIjoiVSIsIuG7riI6IlUiLCLhu6wiOiJVIiwi4buwIjoiVSIsIuG7pCI6IlUiLCLhubIiOiJVIiwixbIiOiJVIiwi4bm2IjoiVSIsIuG5tCI6IlUiLCLJhCI6IlUiLCLik4siOiJWIiwi77y2IjoiViIsIuG5vCI6IlYiLCLhub4iOiJWIiwixrIiOiJWIiwi6p2eIjoiViIsIsmFIjoiViIsIuqdoCI6IlZZIiwi4pOMIjoiVyIsIu+8tyI6IlciLCLhuoAiOiJXIiwi4bqCIjoiVyIsIsW0IjoiVyIsIuG6hiI6IlciLCLhuoQiOiJXIiwi4bqIIjoiVyIsIuKxsiI6IlciLCLik40iOiJYIiwi77y4IjoiWCIsIuG6iiI6IlgiLCLhuowiOiJYIiwi4pOOIjoiWSIsIu+8uSI6IlkiLCLhu7IiOiJZIiwiw50iOiJZIiwixbYiOiJZIiwi4bu4IjoiWSIsIsiyIjoiWSIsIuG6jiI6IlkiLCLFuCI6IlkiLCLhu7YiOiJZIiwi4bu0IjoiWSIsIsazIjoiWSIsIsmOIjoiWSIsIuG7viI6IlkiLCLik48iOiJaIiwi77y6IjoiWiIsIsW5IjoiWiIsIuG6kCI6IloiLCLFuyI6IloiLCLFvSI6IloiLCLhupIiOiJaIiwi4bqUIjoiWiIsIsa1IjoiWiIsIsikIjoiWiIsIuKxvyI6IloiLCLisasiOiJaIiwi6p2iIjoiWiIsIuKTkCI6ImEiLCLvvYEiOiJhIiwi4bqaIjoiYSIsIsOgIjoiYSIsIsOhIjoiYSIsIsOiIjoiYSIsIuG6pyI6ImEiLCLhuqUiOiJhIiwi4bqrIjoiYSIsIuG6qSI6ImEiLCLDoyI6ImEiLCLEgSI6ImEiLCLEgyI6ImEiLCLhurEiOiJhIiwi4bqvIjoiYSIsIuG6tSI6ImEiLCLhurMiOiJhIiwiyKciOiJhIiwix6EiOiJhIiwiw6QiOiJhIiwix58iOiJhIiwi4bqjIjoiYSIsIsOlIjoiYSIsIse7IjoiYSIsIseOIjoiYSIsIsiBIjoiYSIsIsiDIjoiYSIsIuG6oSI6ImEiLCLhuq0iOiJhIiwi4bq3IjoiYSIsIuG4gSI6ImEiLCLEhSI6ImEiLCLisaUiOiJhIiwiyZAiOiJhIiwi6pyzIjoiYWEiLCLDpiI6ImFlIiwix70iOiJhZSIsIsejIjoiYWUiLCLqnLUiOiJhbyIsIuqctyI6ImF1Iiwi6py5IjoiYXYiLCLqnLsiOiJhdiIsIuqcvSI6ImF5Iiwi4pORIjoiYiIsIu+9giI6ImIiLCLhuIMiOiJiIiwi4biFIjoiYiIsIuG4hyI6ImIiLCLGgCI6ImIiLCLGgyI6ImIiLCLJkyI6ImIiLCLik5IiOiJjIiwi772DIjoiYyIsIsSHIjoiYyIsIsSJIjoiYyIsIsSLIjoiYyIsIsSNIjoiYyIsIsOnIjoiYyIsIuG4iSI6ImMiLCLGiCI6ImMiLCLIvCI6ImMiLCLqnL8iOiJjIiwi4oaEIjoiYyIsIuKTkyI6ImQiLCLvvYQiOiJkIiwi4biLIjoiZCIsIsSPIjoiZCIsIuG4jSI6ImQiLCLhuJEiOiJkIiwi4biTIjoiZCIsIuG4jyI6ImQiLCLEkSI6ImQiLCLGjCI6ImQiLCLJliI6ImQiLCLJlyI6ImQiLCLqnboiOiJkIiwix7MiOiJkeiIsIseGIjoiZHoiLCLik5QiOiJlIiwi772FIjoiZSIsIsOoIjoiZSIsIsOpIjoiZSIsIsOqIjoiZSIsIuG7gSI6ImUiLCLhur8iOiJlIiwi4buFIjoiZSIsIuG7gyI6ImUiLCLhur0iOiJlIiwixJMiOiJlIiwi4biVIjoiZSIsIuG4lyI6ImUiLCLElSI6ImUiLCLElyI6ImUiLCLDqyI6ImUiLCLhursiOiJlIiwixJsiOiJlIiwiyIUiOiJlIiwiyIciOiJlIiwi4bq5IjoiZSIsIuG7hyI6ImUiLCLIqSI6ImUiLCLhuJ0iOiJlIiwixJkiOiJlIiwi4biZIjoiZSIsIuG4myI6ImUiLCLJhyI6ImUiLCLJmyI6ImUiLCLHnSI6ImUiLCLik5UiOiJmIiwi772GIjoiZiIsIuG4nyI6ImYiLCLGkiI6ImYiLCLqnbwiOiJmIiwi4pOWIjoiZyIsIu+9hyI6ImciLCLHtSI6ImciLCLEnSI6ImciLCLhuKEiOiJnIiwixJ8iOiJnIiwixKEiOiJnIiwix6ciOiJnIiwixKMiOiJnIiwix6UiOiJnIiwiyaAiOiJnIiwi6p6hIjoiZyIsIuG1uSI6ImciLCLqnb8iOiJnIiwi4pOXIjoiaCIsIu+9iCI6ImgiLCLEpSI6ImgiLCLhuKMiOiJoIiwi4binIjoiaCIsIsifIjoiaCIsIuG4pSI6ImgiLCLhuKkiOiJoIiwi4birIjoiaCIsIuG6liI6ImgiLCLEpyI6ImgiLCLisagiOiJoIiwi4rG2IjoiaCIsIsmlIjoiaCIsIsaVIjoiaHYiLCLik5giOiJpIiwi772JIjoiaSIsIsOsIjoiaSIsIsOtIjoiaSIsIsOuIjoiaSIsIsSpIjoiaSIsIsSrIjoiaSIsIsStIjoiaSIsIsOvIjoiaSIsIuG4ryI6ImkiLCLhu4kiOiJpIiwix5AiOiJpIiwiyIkiOiJpIiwiyIsiOiJpIiwi4buLIjoiaSIsIsSvIjoiaSIsIuG4rSI6ImkiLCLJqCI6ImkiLCLEsSI6ImkiLCLik5kiOiJqIiwi772KIjoiaiIsIsS1IjoiaiIsIsewIjoiaiIsIsmJIjoiaiIsIuKTmiI6ImsiLCLvvYsiOiJrIiwi4bixIjoiayIsIsepIjoiayIsIuG4syI6ImsiLCLEtyI6ImsiLCLhuLUiOiJrIiwixpkiOiJrIiwi4rGqIjoiayIsIuqdgSI6ImsiLCLqnYMiOiJrIiwi6p2FIjoiayIsIuqeoyI6ImsiLCLik5siOiJsIiwi772MIjoibCIsIsWAIjoibCIsIsS6IjoibCIsIsS+IjoibCIsIuG4tyI6ImwiLCLhuLkiOiJsIiwixLwiOiJsIiwi4bi9IjoibCIsIuG4uyI6ImwiLCLFvyI6ImwiLCLFgiI6ImwiLCLGmiI6ImwiLCLJqyI6ImwiLCLisaEiOiJsIiwi6p2JIjoibCIsIuqegSI6ImwiLCLqnYciOiJsIiwix4kiOiJsaiIsIuKTnCI6Im0iLCLvvY0iOiJtIiwi4bi/IjoibSIsIuG5gSI6Im0iLCLhuYMiOiJtIiwiybEiOiJtIiwiya8iOiJtIiwi4pOdIjoibiIsIu+9jiI6Im4iLCLHuSI6Im4iLCLFhCI6Im4iLCLDsSI6Im4iLCLhuYUiOiJuIiwixYgiOiJuIiwi4bmHIjoibiIsIsWGIjoibiIsIuG5iyI6Im4iLCLhuYkiOiJuIiwixp4iOiJuIiwiybIiOiJuIiwixYkiOiJuIiwi6p6RIjoibiIsIuqepSI6Im4iLCLHjCI6Im5qIiwi4pOeIjoibyIsIu+9jyI6Im8iLCLDsiI6Im8iLCLDsyI6Im8iLCLDtCI6Im8iLCLhu5MiOiJvIiwi4buRIjoibyIsIuG7lyI6Im8iLCLhu5UiOiJvIiwiw7UiOiJvIiwi4bmNIjoibyIsIsitIjoibyIsIuG5jyI6Im8iLCLFjSI6Im8iLCLhuZEiOiJvIiwi4bmTIjoibyIsIsWPIjoibyIsIsivIjoibyIsIsixIjoibyIsIsO2IjoibyIsIsirIjoibyIsIuG7jyI6Im8iLCLFkSI6Im8iLCLHkiI6Im8iLCLIjSI6Im8iLCLIjyI6Im8iLCLGoSI6Im8iLCLhu50iOiJvIiwi4bubIjoibyIsIuG7oSI6Im8iLCLhu58iOiJvIiwi4bujIjoibyIsIuG7jSI6Im8iLCLhu5kiOiJvIiwix6siOiJvIiwix60iOiJvIiwiw7giOiJvIiwix78iOiJvIiwiyZQiOiJvIiwi6p2LIjoibyIsIuqdjSI6Im8iLCLJtSI6Im8iLCLGoyI6Im9pIiwiyKMiOiJvdSIsIuqdjyI6Im9vIiwi4pOfIjoicCIsIu+9kCI6InAiLCLhuZUiOiJwIiwi4bmXIjoicCIsIsalIjoicCIsIuG1vSI6InAiLCLqnZEiOiJwIiwi6p2TIjoicCIsIuqdlSI6InAiLCLik6AiOiJxIiwi772RIjoicSIsIsmLIjoicSIsIuqdlyI6InEiLCLqnZkiOiJxIiwi4pOhIjoiciIsIu+9kiI6InIiLCLFlSI6InIiLCLhuZkiOiJyIiwixZkiOiJyIiwiyJEiOiJyIiwiyJMiOiJyIiwi4bmbIjoiciIsIuG5nSI6InIiLCLFlyI6InIiLCLhuZ8iOiJyIiwiyY0iOiJyIiwiyb0iOiJyIiwi6p2bIjoiciIsIuqepyI6InIiLCLqnoMiOiJyIiwi4pOiIjoicyIsIu+9kyI6InMiLCLDnyI6InMiLCLFmyI6InMiLCLhuaUiOiJzIiwixZ0iOiJzIiwi4bmhIjoicyIsIsWhIjoicyIsIuG5pyI6InMiLCLhuaMiOiJzIiwi4bmpIjoicyIsIsiZIjoicyIsIsWfIjoicyIsIsi/IjoicyIsIuqeqSI6InMiLCLqnoUiOiJzIiwi4bqbIjoicyIsIuKToyI6InQiLCLvvZQiOiJ0Iiwi4bmrIjoidCIsIuG6lyI6InQiLCLFpSI6InQiLCLhua0iOiJ0IiwiyJsiOiJ0IiwixaMiOiJ0Iiwi4bmxIjoidCIsIuG5ryI6InQiLCLFpyI6InQiLCLGrSI6InQiLCLKiCI6InQiLCLisaYiOiJ0Iiwi6p6HIjoidCIsIuqcqSI6InR6Iiwi4pOkIjoidSIsIu+9lSI6InUiLCLDuSI6InUiLCLDuiI6InUiLCLDuyI6InUiLCLFqSI6InUiLCLhubkiOiJ1IiwixasiOiJ1Iiwi4bm7IjoidSIsIsWtIjoidSIsIsO8IjoidSIsIsecIjoidSIsIseYIjoidSIsIseWIjoidSIsIseaIjoidSIsIuG7pyI6InUiLAoJIsWvIjoidSIsIsWxIjoidSIsIseUIjoidSIsIsiVIjoidSIsIsiXIjoidSIsIsawIjoidSIsIuG7qyI6InUiLCLhu6kiOiJ1Iiwi4buvIjoidSIsIuG7rSI6InUiLCLhu7EiOiJ1Iiwi4bulIjoidSIsIuG5syI6InUiLCLFsyI6InUiLCLhubciOiJ1Iiwi4bm1IjoidSIsIsqJIjoidSIsIuKTpSI6InYiLCLvvZYiOiJ2Iiwi4bm9IjoidiIsIuG5vyI6InYiLCLKiyI6InYiLCLqnZ8iOiJ2IiwiyowiOiJ2Iiwi6p2hIjoidnkiLCLik6YiOiJ3Iiwi772XIjoidyIsIuG6gSI6InciLCLhuoMiOiJ3IiwixbUiOiJ3Iiwi4bqHIjoidyIsIuG6hSI6InciLCLhupgiOiJ3Iiwi4bqJIjoidyIsIuKxsyI6InciLCLik6ciOiJ4Iiwi772YIjoieCIsIuG6iyI6IngiLCLhuo0iOiJ4Iiwi4pOoIjoieSIsIu+9mSI6InkiLCLhu7MiOiJ5Iiwiw70iOiJ5IiwixbciOiJ5Iiwi4bu5IjoieSIsIsizIjoieSIsIuG6jyI6InkiLCLDvyI6InkiLCLhu7ciOiJ5Iiwi4bqZIjoieSIsIuG7tSI6InkiLCLGtCI6InkiLCLJjyI6InkiLCLhu78iOiJ5Iiwi4pOpIjoieiIsIu+9miI6InoiLCLFuiI6InoiLCLhupEiOiJ6IiwixbwiOiJ6Iiwixb4iOiJ6Iiwi4bqTIjoieiIsIuG6lSI6InoiLCLGtiI6InoiLCLIpSI6InoiLCLJgCI6InoiLCLisawiOiJ6Iiwi6p2jIjoieiIsIs6GIjoizpEiLCLOiCI6Is6VIiwizokiOiLOlyIsIs6KIjoizpkiLCLOqiI6Is6ZIiwizowiOiLOnyIsIs6OIjoizqUiLCLOqyI6Is6lIiwizo8iOiLOqSIsIs6sIjoizrEiLCLOrSI6Is61Iiwizq4iOiLOtyIsIs6vIjoizrkiLCLPiiI6Is65IiwizpAiOiLOuSIsIs+MIjoizr8iLCLPjSI6Is+FIiwiz4siOiLPhSIsIs6wIjoiz4UiLCLPiSI6Is+JIiwiz4IiOiLPgyJ9O1I9dChkb2N1bWVudCksST1mdW5jdGlvbigpe3ZhciB0PTE7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQrK319KCksQT1ZKE9iamVjdCx7YmluZDpmdW5jdGlvbih0KXt2YXIgZT10aGlzO3JldHVybiBmdW5jdGlvbigpe3QuYXBwbHkoZSxhcmd1bWVudHMpfX0saW5pdDpmdW5jdGlvbihlKXt2YXIgbixyLHM9Ii5zZWxlY3QyLXJlc3VsdHMiO3RoaXMub3B0cz1lPXRoaXMucHJlcGFyZU9wdHMoZSksdGhpcy5pZD1lLmlkLGUuZWxlbWVudC5kYXRhKCJzZWxlY3QyIikhPT1pJiZudWxsIT09ZS5lbGVtZW50LmRhdGEoInNlbGVjdDIiKSYmZS5lbGVtZW50LmRhdGEoInNlbGVjdDIiKS5kZXN0cm95KCksdGhpcy5jb250YWluZXI9dGhpcy5jcmVhdGVDb250YWluZXIoKSx0aGlzLmxpdmVSZWdpb249dCgiLnNlbGVjdDItaGlkZGVuLWFjY2Vzc2libGUiKSwwPT10aGlzLmxpdmVSZWdpb24ubGVuZ3RoJiYodGhpcy5saXZlUmVnaW9uPXQoIjxzcGFuPiIse3JvbGU6InN0YXR1cyIsImFyaWEtbGl2ZSI6InBvbGl0ZSJ9KS5hZGRDbGFzcygic2VsZWN0Mi1oaWRkZW4tYWNjZXNzaWJsZSIpLmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpKSx0aGlzLmNvbnRhaW5lcklkPSJzMmlkXyIrKGUuZWxlbWVudC5hdHRyKCJpZCIpfHwiYXV0b2dlbiIrSSgpKSx0aGlzLmNvbnRhaW5lckV2ZW50TmFtZT10aGlzLmNvbnRhaW5lcklkLnJlcGxhY2UoLyhbLl0pL2csIl8iKS5yZXBsYWNlKC8oWzsmLFwtXC5cK1wqXH4nOiJcIVxeIyQlQFxbXF1cKFwpPT5cfF0pL2csIlxcJDEiKSx0aGlzLmNvbnRhaW5lci5hdHRyKCJpZCIsdGhpcy5jb250YWluZXJJZCksdGhpcy5jb250YWluZXIuYXR0cigidGl0bGUiLGUuZWxlbWVudC5hdHRyKCJ0aXRsZSIpKSx0aGlzLmJvZHk9dCgiYm9keSIpLHkodGhpcy5jb250YWluZXIsdGhpcy5vcHRzLmVsZW1lbnQsdGhpcy5vcHRzLmFkYXB0Q29udGFpbmVyQ3NzQ2xhc3MpLHRoaXMuY29udGFpbmVyLmF0dHIoInN0eWxlIixlLmVsZW1lbnQuYXR0cigic3R5bGUiKSksdGhpcy5jb250YWluZXIuY3NzKEwoZS5jb250YWluZXJDc3MsdGhpcy5vcHRzLmVsZW1lbnQpKSx0aGlzLmNvbnRhaW5lci5hZGRDbGFzcyhMKGUuY29udGFpbmVyQ3NzQ2xhc3MsdGhpcy5vcHRzLmVsZW1lbnQpKSx0aGlzLmVsZW1lbnRUYWJJbmRleD10aGlzLm9wdHMuZWxlbWVudC5hdHRyKCJ0YWJpbmRleCIpLHRoaXMub3B0cy5lbGVtZW50LmRhdGEoInNlbGVjdDIiLHRoaXMpLmF0dHIoInRhYmluZGV4IiwiLTEiKS5iZWZvcmUodGhpcy5jb250YWluZXIpLm9uKCJjbGljay5zZWxlY3QyIixfKSx0aGlzLmNvbnRhaW5lci5kYXRhKCJzZWxlY3QyIix0aGlzKSx0aGlzLmRyb3Bkb3duPXRoaXMuY29udGFpbmVyLmZpbmQoIi5zZWxlY3QyLWRyb3AiKSx5KHRoaXMuZHJvcGRvd24sdGhpcy5vcHRzLmVsZW1lbnQsdGhpcy5vcHRzLmFkYXB0RHJvcGRvd25Dc3NDbGFzcyksdGhpcy5kcm9wZG93bi5hZGRDbGFzcyhMKGUuZHJvcGRvd25Dc3NDbGFzcyx0aGlzLm9wdHMuZWxlbWVudCkpLHRoaXMuZHJvcGRvd24uZGF0YSgic2VsZWN0MiIsdGhpcyksdGhpcy5kcm9wZG93bi5vbigiY2xpY2siLF8pLHRoaXMucmVzdWx0cz1uPXRoaXMuY29udGFpbmVyLmZpbmQocyksdGhpcy5zZWFyY2g9cj10aGlzLmNvbnRhaW5lci5maW5kKCJpbnB1dC5zZWxlY3QyLWlucHV0IiksdGhpcy5xdWVyeUNvdW50PTAsdGhpcy5yZXN1bHRzUGFnZT0wLHRoaXMuY29udGV4dD1udWxsLHRoaXMuaW5pdENvbnRhaW5lcigpLHRoaXMuY29udGFpbmVyLm9uKCJjbGljayIsXyksZCh0aGlzLnJlc3VsdHMpLHRoaXMuZHJvcGRvd24ub24oIm1vdXNlbW92ZS1maWx0ZXJlZCIscyx0aGlzLmJpbmQodGhpcy5oaWdobGlnaHRVbmRlckV2ZW50KSksdGhpcy5kcm9wZG93bi5vbigidG91Y2hzdGFydCB0b3VjaG1vdmUgdG91Y2hlbmQiLHMsdGhpcy5iaW5kKGZ1bmN0aW9uKHQpe3RoaXMuX3RvdWNoRXZlbnQ9ITAsdGhpcy5oaWdobGlnaHRVbmRlckV2ZW50KHQpfSkpLHRoaXMuZHJvcGRvd24ub24oInRvdWNobW92ZSIscyx0aGlzLmJpbmQodGhpcy50b3VjaE1vdmVkKSksdGhpcy5kcm9wZG93bi5vbigidG91Y2hzdGFydCB0b3VjaGVuZCIscyx0aGlzLmJpbmQodGhpcy5jbGVhclRvdWNoTW92ZWQpKSx0aGlzLmRyb3Bkb3duLm9uKCJjbGljayIsdGhpcy5iaW5kKGZ1bmN0aW9uKHQpe3RoaXMuX3RvdWNoRXZlbnQmJih0aGlzLl90b3VjaEV2ZW50PSExLHRoaXMuc2VsZWN0SGlnaGxpZ2h0ZWQoKSl9KSkscCg4MCx0aGlzLnJlc3VsdHMpLHRoaXMuZHJvcGRvd24ub24oInNjcm9sbC1kZWJvdW5jZWQiLHMsdGhpcy5iaW5kKHRoaXMubG9hZE1vcmVJZk5lZWRlZCkpLHQodGhpcy5jb250YWluZXIpLm9uKCJjaGFuZ2UiLCIuc2VsZWN0Mi1pbnB1dCIsZnVuY3Rpb24odCl7dC5zdG9wUHJvcGFnYXRpb24oKX0pLHQodGhpcy5kcm9wZG93bikub24oImNoYW5nZSIsIi5zZWxlY3QyLWlucHV0IixmdW5jdGlvbih0KXt0LnN0b3BQcm9wYWdhdGlvbigpfSksdC5mbi5tb3VzZXdoZWVsJiZuLm1vdXNld2hlZWwoZnVuY3Rpb24odCxlLGkscil7dmFyIHM9bi5zY3JvbGxUb3AoKTtyPjAmJnMtcjw9MD8obi5zY3JvbGxUb3AoMCksXyh0KSk6cjwwJiZuLmdldCgwKS5zY3JvbGxIZWlnaHQtbi5zY3JvbGxUb3AoKStyPD1uLmhlaWdodCgpJiYobi5zY3JvbGxUb3Aobi5nZXQoMCkuc2Nyb2xsSGVpZ2h0LW4uaGVpZ2h0KCkpLF8odCkpfSksdShyKSxyLm9uKCJrZXl1cC1jaGFuZ2UgaW5wdXQgcGFzdGUiLHRoaXMuYmluZCh0aGlzLnVwZGF0ZVJlc3VsdHMpKSxyLm9uKCJmb2N1cyIsZnVuY3Rpb24oKXtyLmFkZENsYXNzKCJzZWxlY3QyLWZvY3VzZWQiKX0pLHIub24oImJsdXIiLGZ1bmN0aW9uKCl7ci5yZW1vdmVDbGFzcygic2VsZWN0Mi1mb2N1c2VkIil9KSx0aGlzLmRyb3Bkb3duLm9uKCJtb3VzZXVwIixzLHRoaXMuYmluZChmdW5jdGlvbihlKXt0KGUudGFyZ2V0KS5jbG9zZXN0KCIuc2VsZWN0Mi1yZXN1bHQtc2VsZWN0YWJsZSIpLmxlbmd0aD4wJiYodGhpcy5oaWdobGlnaHRVbmRlckV2ZW50KGUpLHRoaXMuc2VsZWN0SGlnaGxpZ2h0ZWQoZSkpfSkpLHRoaXMuZHJvcGRvd24ub24oImNsaWNrIG1vdXNldXAgbW91c2Vkb3duIHRvdWNoc3RhcnQgdG91Y2hlbmQgZm9jdXNpbiIsZnVuY3Rpb24odCl7dC5zdG9wUHJvcGFnYXRpb24oKX0pLHRoaXMubmV4dFNlYXJjaFRlcm09aSx0LmlzRnVuY3Rpb24odGhpcy5vcHRzLmluaXRTZWxlY3Rpb24pJiYodGhpcy5pbml0U2VsZWN0aW9uKCksdGhpcy5tb25pdG9yU291cmNlKCkpLG51bGwhPT1lLm1heGltdW1JbnB1dExlbmd0aCYmdGhpcy5zZWFyY2guYXR0cigibWF4bGVuZ3RoIixlLm1heGltdW1JbnB1dExlbmd0aCk7dmFyIGE9ZS5lbGVtZW50LnByb3AoImRpc2FibGVkIik7YT09PWkmJihhPSExKSx0aGlzLmVuYWJsZSghYSk7dmFyIGw9ZS5lbGVtZW50LnByb3AoInJlYWRvbmx5Iik7bD09PWkmJihsPSExKSx0aGlzLnJlYWRvbmx5KGwpLEg9SHx8bygpLHRoaXMuYXV0b2ZvY3VzPWUuZWxlbWVudC5wcm9wKCJhdXRvZm9jdXMiKSxlLmVsZW1lbnQucHJvcCgiYXV0b2ZvY3VzIiwhMSksdGhpcy5hdXRvZm9jdXMmJnRoaXMuZm9jdXMoKSx0aGlzLnNlYXJjaC5hdHRyKCJwbGFjZWhvbGRlciIsZS5zZWFyY2hJbnB1dFBsYWNlaG9sZGVyKX0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciB0PXRoaXMub3B0cy5lbGVtZW50LGU9dC5kYXRhKCJzZWxlY3QyIiksbj10aGlzO3RoaXMuY2xvc2UoKSx0Lmxlbmd0aCYmdFswXS5kZXRhY2hFdmVudCYmbi5fc3luYyYmdC5lYWNoKGZ1bmN0aW9uKCl7dGhpcy5kZXRhY2hFdmVudCgib25wcm9wZXJ0eWNoYW5nZSIsbi5fc3luYyl9KSx0aGlzLnByb3BlcnR5T2JzZXJ2ZXImJih0aGlzLnByb3BlcnR5T2JzZXJ2ZXIuZGlzY29ubmVjdCgpLHRoaXMucHJvcGVydHlPYnNlcnZlcj1udWxsKSx0aGlzLl9zeW5jPW51bGwsZSE9PWkmJihlLmNvbnRhaW5lci5yZW1vdmUoKSxlLmxpdmVSZWdpb24ucmVtb3ZlKCksZS5kcm9wZG93bi5yZW1vdmUoKSx0LnJlbW92ZUNsYXNzKCJzZWxlY3QyLW9mZnNjcmVlbiIpLnJlbW92ZURhdGEoInNlbGVjdDIiKS5vZmYoIi5zZWxlY3QyIikucHJvcCgiYXV0b2ZvY3VzIix0aGlzLmF1dG9mb2N1c3x8ITEpLHRoaXMuZWxlbWVudFRhYkluZGV4P3QuYXR0cih7dGFiaW5kZXg6dGhpcy5lbGVtZW50VGFiSW5kZXh9KTp0LnJlbW92ZUF0dHIoInRhYmluZGV4IiksdC5zaG93KCkpLEQuY2FsbCh0aGlzLCJjb250YWluZXIiLCJsaXZlUmVnaW9uIiwiZHJvcGRvd24iLCJyZXN1bHRzIiwic2VhcmNoIil9LG9wdGlvblRvRGF0YTpmdW5jdGlvbih0KXtyZXR1cm4gdC5pcygib3B0aW9uIik/e2lkOnQucHJvcCgidmFsdWUiKSx0ZXh0OnQudGV4dCgpLGVsZW1lbnQ6dC5nZXQoKSxjc3M6dC5hdHRyKCJjbGFzcyIpLGRpc2FibGVkOnQucHJvcCgiZGlzYWJsZWQiKSxsb2NrZWQ6YSh0LmF0dHIoImxvY2tlZCIpLCJsb2NrZWQiKXx8YSh0LmRhdGEoImxvY2tlZCIpLCEwKX06dC5pcygib3B0Z3JvdXAiKT97dGV4dDp0LmF0dHIoImxhYmVsIiksY2hpbGRyZW46W10sZWxlbWVudDp0LmdldCgpLGNzczp0LmF0dHIoImNsYXNzIil9OnZvaWQgMH0scHJlcGFyZU9wdHM6ZnVuY3Rpb24oZSl7dmFyIG4scixzLG8sYz10aGlzO2lmKG49ZS5lbGVtZW50LCJzZWxlY3QiPT09bi5nZXQoMCkudGFnTmFtZS50b0xvd2VyQ2FzZSgpJiYodGhpcy5zZWxlY3Q9cj1lLmVsZW1lbnQpLHImJnQuZWFjaChbImlkIiwibXVsdGlwbGUiLCJhamF4IiwicXVlcnkiLCJjcmVhdGVTZWFyY2hDaG9pY2UiLCJpbml0U2VsZWN0aW9uIiwiZGF0YSIsInRhZ3MiXSxmdW5jdGlvbigpe2lmKHRoaXMgaW4gZSl0aHJvdyBuZXcgRXJyb3IoIk9wdGlvbiAnIit0aGlzKyInIGlzIG5vdCBhbGxvd2VkIGZvciBTZWxlY3QyIHdoZW4gYXR0YWNoZWQgdG8gYSA8c2VsZWN0PiBlbGVtZW50LiIpfSksZT10LmV4dGVuZCh7fSx7cG9wdWxhdGVSZXN1bHRzOmZ1bmN0aW9uKG4scixzKXt2YXIgbyxhPXRoaXMub3B0cy5pZCxsPXRoaXMubGl2ZVJlZ2lvbjsobz1mdW5jdGlvbihuLHIsdSl7dmFyIGQsaCxwLGYsbSxfLGcsdix5LGI7bj1lLnNvcnRSZXN1bHRzKG4scixzKTt2YXIgdz1bXTtmb3IoZD0wLGg9bi5sZW5ndGg7ZDxoO2QrPTEpcD1uW2RdLG09cC5kaXNhYmxlZD09PSEwLGY9IW0mJmEocCkhPT1pLF89cC5jaGlsZHJlbiYmcC5jaGlsZHJlbi5sZW5ndGg+MCxnPXQoIjxsaT48L2xpPiIpLGcuYWRkQ2xhc3MoInNlbGVjdDItcmVzdWx0cy1kZXB0LSIrdSksZy5hZGRDbGFzcygic2VsZWN0Mi1yZXN1bHQiKSxnLmFkZENsYXNzKGY/InNlbGVjdDItcmVzdWx0LXNlbGVjdGFibGUiOiJzZWxlY3QyLXJlc3VsdC11bnNlbGVjdGFibGUiKSxtJiZnLmFkZENsYXNzKCJzZWxlY3QyLWRpc2FibGVkIiksXyYmZy5hZGRDbGFzcygic2VsZWN0Mi1yZXN1bHQtd2l0aC1jaGlsZHJlbiIpLGcuYWRkQ2xhc3MoYy5vcHRzLmZvcm1hdFJlc3VsdENzc0NsYXNzKHApKSxnLmF0dHIoInJvbGUiLCJwcmVzZW50YXRpb24iKSx2PXQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpLHYuYWRkQ2xhc3MoInNlbGVjdDItcmVzdWx0LWxhYmVsIiksdi5hdHRyKCJpZCIsInNlbGVjdDItcmVzdWx0LWxhYmVsLSIrSSgpKSx2LmF0dHIoInJvbGUiLCJvcHRpb24iKSxiPWUuZm9ybWF0UmVzdWx0KHAsdixzLGMub3B0cy5lc2NhcGVNYXJrdXApLGIhPT1pJiYodi5odG1sKGIpLGcuYXBwZW5kKHYpKSxfJiYoeT10KCI8dWw+PC91bD4iKSx5LmFkZENsYXNzKCJzZWxlY3QyLXJlc3VsdC1zdWIiKSxvKHAuY2hpbGRyZW4seSx1KzEpLGcuYXBwZW5kKHkpKSxnLmRhdGEoInNlbGVjdDItZGF0YSIscCksdy5wdXNoKGdbMF0pO3IuYXBwZW5kKHcpLGwudGV4dChlLmZvcm1hdE1hdGNoZXMobi5sZW5ndGgpKX0pKHIsbiwwKX19LHQuZm4uc2VsZWN0Mi5kZWZhdWx0cyxlKSwiZnVuY3Rpb24iIT10eXBlb2YgZS5pZCYmKHM9ZS5pZCxlLmlkPWZ1bmN0aW9uKHQpe3JldHVybiB0W3NdfSksdC5pc0FycmF5KGUuZWxlbWVudC5kYXRhKCJzZWxlY3QyVGFncyIpKSl7aWYoInRhZ3MiaW4gZSl0aHJvdyJ0YWdzIHNwZWNpZmllZCBhcyBib3RoIGFuIGF0dHJpYnV0ZSAnZGF0YS1zZWxlY3QyLXRhZ3MnIGFuZCBpbiBvcHRpb25zIG9mIFNlbGVjdDIgIitlLmVsZW1lbnQuYXR0cigiaWQiKTtlLnRhZ3M9ZS5lbGVtZW50LmRhdGEoInNlbGVjdDJUYWdzIil9aWYocj8oZS5xdWVyeT10aGlzLmJpbmQoZnVuY3Rpb24odCl7dmFyIGUscixzLG89e3Jlc3VsdHM6W10sbW9yZTohMX0sYT10LnRlcm07cz1mdW5jdGlvbihlLGkpe3ZhciBuO2UuaXMoIm9wdGlvbiIpP3QubWF0Y2hlcihhLGUudGV4dCgpLGUpJiZpLnB1c2goYy5vcHRpb25Ub0RhdGEoZSkpOmUuaXMoIm9wdGdyb3VwIikmJihuPWMub3B0aW9uVG9EYXRhKGUpLGUuY2hpbGRyZW4oKS5lYWNoMihmdW5jdGlvbih0LGUpe3MoZSxuLmNoaWxkcmVuKX0pLG4uY2hpbGRyZW4ubGVuZ3RoPjAmJmkucHVzaChuKSl9LGU9bi5jaGlsZHJlbigpLHRoaXMuZ2V0UGxhY2Vob2xkZXIoKSE9PWkmJmUubGVuZ3RoPjAmJihyPXRoaXMuZ2V0UGxhY2Vob2xkZXJPcHRpb24oKSxyJiYoZT1lLm5vdChyKSkpLGUuZWFjaDIoZnVuY3Rpb24odCxlKXtzKGUsby5yZXN1bHRzKX0pLHQuY2FsbGJhY2sobyl9KSxlLmlkPWZ1bmN0aW9uKHQpe3JldHVybiB0LmlkfSk6InF1ZXJ5ImluIGV8fCgiYWpheCJpbiBlPyhvPWUuZWxlbWVudC5kYXRhKCJhamF4LXVybCIpLG8mJm8ubGVuZ3RoPjAmJihlLmFqYXgudXJsPW8pLGUucXVlcnk9TS5jYWxsKGUuZWxlbWVudCxlLmFqYXgpKToiZGF0YSJpbiBlP2UucXVlcnk9ayhlLmRhdGEpOiJ0YWdzImluIGUmJihlLnF1ZXJ5PVQoZS50YWdzKSxlLmNyZWF0ZVNlYXJjaENob2ljZT09PWkmJihlLmNyZWF0ZVNlYXJjaENob2ljZT1mdW5jdGlvbihlKXtyZXR1cm57aWQ6dC50cmltKGUpLHRleHQ6dC50cmltKGUpfX0pLGUuaW5pdFNlbGVjdGlvbj09PWkmJihlLmluaXRTZWxlY3Rpb249ZnVuY3Rpb24oaSxuKXt2YXIgcj1bXTt0KGwoaS52YWwoKSxlLnNlcGFyYXRvcikpLmVhY2goZnVuY3Rpb24oKXt2YXIgaT17aWQ6dGhpcyx0ZXh0OnRoaXN9LG49ZS50YWdzO3QuaXNGdW5jdGlvbihuKSYmKG49bigpKSx0KG4pLmVhY2goZnVuY3Rpb24oKXtpZihhKHRoaXMuaWQsaS5pZCkpcmV0dXJuIGk9dGhpcywhMX0pLHIucHVzaChpKX0pLG4ocil9KSkpLCJmdW5jdGlvbiIhPXR5cGVvZiBlLnF1ZXJ5KXRocm93InF1ZXJ5IGZ1bmN0aW9uIG5vdCBkZWZpbmVkIGZvciBTZWxlY3QyICIrZS5lbGVtZW50LmF0dHIoImlkIik7aWYoInRvcCI9PT1lLmNyZWF0ZVNlYXJjaENob2ljZVBvc2l0aW9uKWUuY3JlYXRlU2VhcmNoQ2hvaWNlUG9zaXRpb249ZnVuY3Rpb24odCxlKXt0LnVuc2hpZnQoZSl9O2Vsc2UgaWYoImJvdHRvbSI9PT1lLmNyZWF0ZVNlYXJjaENob2ljZVBvc2l0aW9uKWUuY3JlYXRlU2VhcmNoQ2hvaWNlUG9zaXRpb249ZnVuY3Rpb24odCxlKXt0LnB1c2goZSl9O2Vsc2UgaWYoImZ1bmN0aW9uIiE9dHlwZW9mIGUuY3JlYXRlU2VhcmNoQ2hvaWNlUG9zaXRpb24pdGhyb3ciaW52YWxpZCBjcmVhdGVTZWFyY2hDaG9pY2VQb3NpdGlvbiBvcHRpb24gbXVzdCBiZSAndG9wJywgJ2JvdHRvbScgb3IgYSBjdXN0b20gZnVuY3Rpb24iO3JldHVybiBlfSxtb25pdG9yU291cmNlOmZ1bmN0aW9uKCl7dmFyIGUsbj10aGlzLm9wdHMuZWxlbWVudCxyPXRoaXM7bi5vbigiY2hhbmdlLnNlbGVjdDIiLHRoaXMuYmluZChmdW5jdGlvbih0KXt0aGlzLm9wdHMuZWxlbWVudC5kYXRhKCJzZWxlY3QyLWNoYW5nZS10cmlnZ2VyZWQiKSE9PSEwJiZ0aGlzLmluaXRTZWxlY3Rpb24oKX0pKSx0aGlzLl9zeW5jPXRoaXMuYmluZChmdW5jdGlvbigpe3ZhciB0PW4ucHJvcCgiZGlzYWJsZWQiKTt0PT09aSYmKHQ9ITEpLHRoaXMuZW5hYmxlKCF0KTt2YXIgZT1uLnByb3AoInJlYWRvbmx5Iik7ZT09PWkmJihlPSExKSx0aGlzLnJlYWRvbmx5KGUpLHkodGhpcy5jb250YWluZXIsdGhpcy5vcHRzLmVsZW1lbnQsdGhpcy5vcHRzLmFkYXB0Q29udGFpbmVyQ3NzQ2xhc3MpLHRoaXMuY29udGFpbmVyLmFkZENsYXNzKEwodGhpcy5vcHRzLmNvbnRhaW5lckNzc0NsYXNzLHRoaXMub3B0cy5lbGVtZW50KSkseSh0aGlzLmRyb3Bkb3duLHRoaXMub3B0cy5lbGVtZW50LHRoaXMub3B0cy5hZGFwdERyb3Bkb3duQ3NzQ2xhc3MpLHRoaXMuZHJvcGRvd24uYWRkQ2xhc3MoTCh0aGlzLm9wdHMuZHJvcGRvd25Dc3NDbGFzcyx0aGlzLm9wdHMuZWxlbWVudCkpfSksbi5sZW5ndGgmJm5bMF0uYXR0YWNoRXZlbnQmJm4uZWFjaChmdW5jdGlvbigpe3RoaXMuYXR0YWNoRXZlbnQoIm9ucHJvcGVydHljaGFuZ2UiLHIuX3N5bmMpfSksZT13aW5kb3cuTXV0YXRpb25PYnNlcnZlcnx8d2luZG93LldlYktpdE11dGF0aW9uT2JzZXJ2ZXJ8fHdpbmRvdy5Nb3pNdXRhdGlvbk9ic2VydmVyLGUhPT1pJiYodGhpcy5wcm9wZXJ0eU9ic2VydmVyJiYoZGVsZXRlIHRoaXMucHJvcGVydHlPYnNlcnZlcix0aGlzLnByb3BlcnR5T2JzZXJ2ZXI9bnVsbCksdGhpcy5wcm9wZXJ0eU9ic2VydmVyPW5ldyBlKGZ1bmN0aW9uKGUpe3QuZWFjaChlLHIuX3N5bmMpfSksdGhpcy5wcm9wZXJ0eU9ic2VydmVyLm9ic2VydmUobi5nZXQoMCkse2F0dHJpYnV0ZXM6ITAsc3VidHJlZTohMX0pKX0sdHJpZ2dlclNlbGVjdDpmdW5jdGlvbihlKXt2YXIgaT10LkV2ZW50KCJzZWxlY3QyLXNlbGVjdGluZyIse3ZhbDp0aGlzLmlkKGUpLG9iamVjdDplLGNob2ljZTplfSk7cmV0dXJuIHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIoaSksIWkuaXNEZWZhdWx0UHJldmVudGVkKCl9LHRyaWdnZXJDaGFuZ2U6ZnVuY3Rpb24oZSl7ZT1lfHx7fSxlPXQuZXh0ZW5kKHt9LGUse3R5cGU6ImNoYW5nZSIsdmFsOnRoaXMudmFsKCl9KSx0aGlzLm9wdHMuZWxlbWVudC5kYXRhKCJzZWxlY3QyLWNoYW5nZS10cmlnZ2VyZWQiLCEwKSx0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKGUpLHRoaXMub3B0cy5lbGVtZW50LmRhdGEoInNlbGVjdDItY2hhbmdlLXRyaWdnZXJlZCIsITEpLHRoaXMub3B0cy5lbGVtZW50LmNsaWNrKCksdGhpcy5vcHRzLmJsdXJPbkNoYW5nZSYmdGhpcy5vcHRzLmVsZW1lbnQuYmx1cigpfSxpc0ludGVyZmFjZUVuYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbmFibGVkSW50ZXJmYWNlPT09ITB9LGVuYWJsZUludGVyZmFjZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2VuYWJsZWQmJiF0aGlzLl9yZWFkb25seSxlPSF0O3JldHVybiB0IT09dGhpcy5lbmFibGVkSW50ZXJmYWNlJiYodGhpcy5jb250YWluZXIudG9nZ2xlQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWRpc2FibGVkIixlKSx0aGlzLmNsb3NlKCksdGhpcy5lbmFibGVkSW50ZXJmYWNlPXQsITApfSxlbmFibGU6ZnVuY3Rpb24odCl7dD09PWkmJih0PSEwKSx0aGlzLl9lbmFibGVkIT09dCYmKHRoaXMuX2VuYWJsZWQ9dCx0aGlzLm9wdHMuZWxlbWVudC5wcm9wKCJkaXNhYmxlZCIsIXQpLHRoaXMuZW5hYmxlSW50ZXJmYWNlKCkpfSxkaXNhYmxlOmZ1bmN0aW9uKCl7dGhpcy5lbmFibGUoITEpfSxyZWFkb25seTpmdW5jdGlvbih0KXt0PT09aSYmKHQ9ITEpLHRoaXMuX3JlYWRvbmx5IT09dCYmKHRoaXMuX3JlYWRvbmx5PXQsdGhpcy5vcHRzLmVsZW1lbnQucHJvcCgicmVhZG9ubHkiLHQpLHRoaXMuZW5hYmxlSW50ZXJmYWNlKCkpfSxvcGVuZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuY29udGFpbmVyJiZ0aGlzLmNvbnRhaW5lci5oYXNDbGFzcygic2VsZWN0Mi1kcm9wZG93bi1vcGVuIil9LHBvc2l0aW9uRHJvcGRvd246ZnVuY3Rpb24oKXt2YXIgZSxpLG4scixzLG89dGhpcy5kcm9wZG93bixhPXRoaXMuY29udGFpbmVyLGw9YS5vZmZzZXQoKSxjPWEub3V0ZXJIZWlnaHQoITEpLHU9YS5vdXRlcldpZHRoKCExKSxkPW8ub3V0ZXJIZWlnaHQoITEpLGg9dCh3aW5kb3cpLHA9aC53aWR0aCgpLGY9aC5oZWlnaHQoKSxtPWguc2Nyb2xsTGVmdCgpK3AsXz1oLnNjcm9sbFRvcCgpK2YsZz1sLnRvcCtjLHY9bC5sZWZ0LHk9ZytkPD1fLGI9bC50b3AtZD49aC5zY3JvbGxUb3AoKSx3PW8ub3V0ZXJXaWR0aCghMSksTT1mdW5jdGlvbigpe3JldHVybiB2K3c8PW19LGs9ZnVuY3Rpb24oKXtyZXR1cm4gbC5sZWZ0K20rYS5vdXRlcldpZHRoKCExKT53fSxUPW8uaGFzQ2xhc3MoInNlbGVjdDItZHJvcC1hYm92ZSIpO1Q/KGk9ITAsIWImJnkmJihuPSEwLGk9ITEpKTooaT0hMSwheSYmYiYmKG49ITAsaT0hMCkpLG4mJihvLmhpZGUoKSxsPXRoaXMuY29udGFpbmVyLm9mZnNldCgpLGM9dGhpcy5jb250YWluZXIub3V0ZXJIZWlnaHQoITEpLHU9dGhpcy5jb250YWluZXIub3V0ZXJXaWR0aCghMSksZD1vLm91dGVySGVpZ2h0KCExKSxtPWguc2Nyb2xsTGVmdCgpK3AsXz1oLnNjcm9sbFRvcCgpK2YsZz1sLnRvcCtjLHY9bC5sZWZ0LHc9by5vdXRlcldpZHRoKCExKSxvLnNob3coKSx0aGlzLmZvY3VzU2VhcmNoKCkpLHRoaXMub3B0cy5kcm9wZG93bkF1dG9XaWR0aD8ocz10KCIuc2VsZWN0Mi1yZXN1bHRzIixvKVswXSxvLmFkZENsYXNzKCJzZWxlY3QyLWRyb3AtYXV0by13aWR0aCIpLG8uY3NzKCJ3aWR0aCIsIiIpLHc9by5vdXRlcldpZHRoKCExKSsocy5zY3JvbGxIZWlnaHQ9PT1zLmNsaWVudEhlaWdodD8wOkgud2lkdGgpLHc+dT91PXc6dz11LGQ9by5vdXRlckhlaWdodCghMSkpOnRoaXMuY29udGFpbmVyLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWRyb3AtYXV0by13aWR0aCIpLCJzdGF0aWMiIT09dGhpcy5ib2R5LmNzcygicG9zaXRpb24iKSYmKGU9dGhpcy5ib2R5Lm9mZnNldCgpLGctPWUudG9wLHYtPWUubGVmdCksIU0oKSYmaygpJiYodj1sLmxlZnQrdGhpcy5jb250YWluZXIub3V0ZXJXaWR0aCghMSktdykscj17bGVmdDp2LHdpZHRoOnV9LGk/KHIudG9wPWwudG9wLWQsci5ib3R0b209ImF1dG8iLHRoaXMuY29udGFpbmVyLmFkZENsYXNzKCJzZWxlY3QyLWRyb3AtYWJvdmUiKSxvLmFkZENsYXNzKCJzZWxlY3QyLWRyb3AtYWJvdmUiKSk6KHIudG9wPWcsci5ib3R0b209ImF1dG8iLHRoaXMuY29udGFpbmVyLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWRyb3AtYWJvdmUiKSxvLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWRyb3AtYWJvdmUiKSkscj10LmV4dGVuZChyLEwodGhpcy5vcHRzLmRyb3Bkb3duQ3NzLHRoaXMub3B0cy5lbGVtZW50KSksby5jc3Mocil9LHNob3VsZE9wZW46ZnVuY3Rpb24oKXt2YXIgZTtyZXR1cm4hdGhpcy5vcGVuZWQoKSYmKHRoaXMuX2VuYWJsZWQhPT0hMSYmdGhpcy5fcmVhZG9ubHkhPT0hMCYmKGU9dC5FdmVudCgic2VsZWN0Mi1vcGVuaW5nIiksdGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcihlKSwhZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkpfSxjbGVhckRyb3Bkb3duQWxpZ25tZW50UHJlZmVyZW5jZTpmdW5jdGlvbigpe3RoaXMuY29udGFpbmVyLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWRyb3AtYWJvdmUiKSx0aGlzLmRyb3Bkb3duLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWRyb3AtYWJvdmUiKX0sb3BlbjpmdW5jdGlvbigpe3JldHVybiEhdGhpcy5zaG91bGRPcGVuKCkmJih0aGlzLm9wZW5pbmcoKSxSLm9uKCJtb3VzZW1vdmUuc2VsZWN0MkV2ZW50IixmdW5jdGlvbih0KXtqLng9dC5wYWdlWCxqLnk9dC5wYWdlWX0pLCEwKX0sb3BlbmluZzpmdW5jdGlvbigpe3ZhciBlLGk9dGhpcy5jb250YWluZXJFdmVudE5hbWUscj0ic2Nyb2xsLiIraSxzPSJyZXNpemUuIitpLG89Im9yaWVudGF0aW9uY2hhbmdlLiIraTt0aGlzLmNvbnRhaW5lci5hZGRDbGFzcygic2VsZWN0Mi1kcm9wZG93bi1vcGVuIikuYWRkQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpLHRoaXMuY2xlYXJEcm9wZG93bkFsaWdubWVudFByZWZlcmVuY2UoKSx0aGlzLmRyb3Bkb3duWzBdIT09dGhpcy5ib2R5LmNoaWxkcmVuKCkubGFzdCgpWzBdJiZ0aGlzLmRyb3Bkb3duLmRldGFjaCgpLmFwcGVuZFRvKHRoaXMuYm9keSksZT10KCIjc2VsZWN0Mi1kcm9wLW1hc2siKSwwPT1lLmxlbmd0aCYmKGU9dChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSksZS5hdHRyKCJpZCIsInNlbGVjdDItZHJvcC1tYXNrIikuYXR0cigiY2xhc3MiLCJzZWxlY3QyLWRyb3AtbWFzayIpLGUuaGlkZSgpLGUuYXBwZW5kVG8odGhpcy5ib2R5KSxlLm9uKCJtb3VzZWRvd24gdG91Y2hzdGFydCBjbGljayIsZnVuY3Rpb24oaSl7bihlKTt2YXIgcixzPXQoIiNzZWxlY3QyLWRyb3AiKTtzLmxlbmd0aD4wJiYocj1zLmRhdGEoInNlbGVjdDIiKSxyLm9wdHMuc2VsZWN0T25CbHVyJiZyLnNlbGVjdEhpZ2hsaWdodGVkKHtub0ZvY3VzOiEwfSksci5jbG9zZSgpLGkucHJldmVudERlZmF1bHQoKSxpLnN0b3BQcm9wYWdhdGlvbigpKX0pKSx0aGlzLmRyb3Bkb3duLnByZXYoKVswXSE9PWVbMF0mJnRoaXMuZHJvcGRvd24uYmVmb3JlKGUpLHQoIiNzZWxlY3QyLWRyb3AiKS5yZW1vdmVBdHRyKCJpZCIpLHRoaXMuZHJvcGRvd24uYXR0cigiaWQiLCJzZWxlY3QyLWRyb3AiKSxlLnNob3coKSx0aGlzLnBvc2l0aW9uRHJvcGRvd24oKSx0aGlzLmRyb3Bkb3duLnNob3coKSx0aGlzLnBvc2l0aW9uRHJvcGRvd24oKSx0aGlzLmRyb3Bkb3duLmFkZENsYXNzKCJzZWxlY3QyLWRyb3AtYWN0aXZlIik7dmFyIGE9dGhpczt0aGlzLmNvbnRhaW5lci5wYXJlbnRzKCkuYWRkKHdpbmRvdykuZWFjaChmdW5jdGlvbigpe3QodGhpcykub24ocysiICIrcisiICIrbyxmdW5jdGlvbih0KXthLm9wZW5lZCgpJiZhLnBvc2l0aW9uRHJvcGRvd24oKX0pfSl9LGNsb3NlOmZ1bmN0aW9uKCl7aWYodGhpcy5vcGVuZWQoKSl7dmFyIGU9dGhpcy5jb250YWluZXJFdmVudE5hbWUsaT0ic2Nyb2xsLiIrZSxuPSJyZXNpemUuIitlLHI9Im9yaWVudGF0aW9uY2hhbmdlLiIrZTt0aGlzLmNvbnRhaW5lci5wYXJlbnRzKCkuYWRkKHdpbmRvdykuZWFjaChmdW5jdGlvbigpe3QodGhpcykub2ZmKGkpLm9mZihuKS5vZmYocil9KSx0aGlzLmNsZWFyRHJvcGRvd25BbGlnbm1lbnRQcmVmZXJlbmNlKCksdCgiI3NlbGVjdDItZHJvcC1tYXNrIikuaGlkZSgpLHRoaXMuZHJvcGRvd24ucmVtb3ZlQXR0cigiaWQiKSx0aGlzLmRyb3Bkb3duLmhpZGUoKSx0aGlzLmNvbnRhaW5lci5yZW1vdmVDbGFzcygic2VsZWN0Mi1kcm9wZG93bi1vcGVuIikucmVtb3ZlQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpLHRoaXMucmVzdWx0cy5lbXB0eSgpLFIub2ZmKCJtb3VzZW1vdmUuc2VsZWN0MkV2ZW50IiksdGhpcy5jbGVhclNlYXJjaCgpLHRoaXMuc2VhcmNoLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWFjdGl2ZSIpLHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIodC5FdmVudCgic2VsZWN0Mi1jbG9zZSIpKX19LGV4dGVybmFsU2VhcmNoOmZ1bmN0aW9uKHQpe3RoaXMub3BlbigpLHRoaXMuc2VhcmNoLnZhbCh0KSx0aGlzLnVwZGF0ZVJlc3VsdHMoITEpfSxjbGVhclNlYXJjaDpmdW5jdGlvbigpe30sZ2V0TWF4aW11bVNlbGVjdGlvblNpemU6ZnVuY3Rpb24oKXtyZXR1cm4gTCh0aGlzLm9wdHMubWF4aW11bVNlbGVjdGlvblNpemUsdGhpcy5vcHRzLmVsZW1lbnQpfSxlbnN1cmVIaWdobGlnaHRWaXNpYmxlOmZ1bmN0aW9uKCl7dmFyIGUsaSxuLHIscyxvLGEsbCxjPXRoaXMucmVzdWx0cztpZihpPXRoaXMuaGlnaGxpZ2h0KCksIShpPDApKXtpZigwPT1pKXJldHVybiB2b2lkIGMuc2Nyb2xsVG9wKDApO2U9dGhpcy5maW5kSGlnaGxpZ2h0YWJsZUNob2ljZXMoKS5maW5kKCIuc2VsZWN0Mi1yZXN1bHQtbGFiZWwiKSxuPXQoZVtpXSksbD0obi5vZmZzZXQoKXx8e30pLnRvcHx8MCxyPWwrbi5vdXRlckhlaWdodCghMCksaT09PWUubGVuZ3RoLTEmJihhPWMuZmluZCgibGkuc2VsZWN0Mi1tb3JlLXJlc3VsdHMiKSxhLmxlbmd0aD4wJiYocj1hLm9mZnNldCgpLnRvcCthLm91dGVySGVpZ2h0KCEwKSkpLHM9Yy5vZmZzZXQoKS50b3ArYy5vdXRlckhlaWdodCghMCkscj5zJiZjLnNjcm9sbFRvcChjLnNjcm9sbFRvcCgpKyhyLXMpKSxvPWwtYy5vZmZzZXQoKS50b3AsbzwwJiYibm9uZSIhPW4uY3NzKCJkaXNwbGF5IikmJmMuc2Nyb2xsVG9wKGMuc2Nyb2xsVG9wKCkrbyl9fSxmaW5kSGlnaGxpZ2h0YWJsZUNob2ljZXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXN1bHRzLmZpbmQoIi5zZWxlY3QyLXJlc3VsdC1zZWxlY3RhYmxlOm5vdCguc2VsZWN0Mi1kaXNhYmxlZCk6bm90KC5zZWxlY3QyLXNlbGVjdGVkKSIpfSxtb3ZlSGlnaGxpZ2h0OmZ1bmN0aW9uKGUpe2Zvcih2YXIgaT10aGlzLmZpbmRIaWdobGlnaHRhYmxlQ2hvaWNlcygpLG49dGhpcy5oaWdobGlnaHQoKTtuPi0xJiZuPGkubGVuZ3RoOyl7bis9ZTt2YXIgcj10KGlbbl0pO2lmKHIuaGFzQ2xhc3MoInNlbGVjdDItcmVzdWx0LXNlbGVjdGFibGUiKSYmIXIuaGFzQ2xhc3MoInNlbGVjdDItZGlzYWJsZWQiKSYmIXIuaGFzQ2xhc3MoInNlbGVjdDItc2VsZWN0ZWQiKSl7dGhpcy5oaWdobGlnaHQobik7YnJlYWt9fX0saGlnaGxpZ2h0OmZ1bmN0aW9uKGUpe3ZhciBpLG4scj10aGlzLmZpbmRIaWdobGlnaHRhYmxlQ2hvaWNlcygpO3JldHVybiAwPT09YXJndW1lbnRzLmxlbmd0aD9zKHIuZmlsdGVyKCIuc2VsZWN0Mi1oaWdobGlnaHRlZCIpWzBdLHIuZ2V0KCkpOihlPj1yLmxlbmd0aCYmKGU9ci5sZW5ndGgtMSksZTwwJiYoZT0wKSx0aGlzLnJlbW92ZUhpZ2hsaWdodCgpLGk9dChyW2VdKSxpLmFkZENsYXNzKCJzZWxlY3QyLWhpZ2hsaWdodGVkIiksdGhpcy5zZWFyY2guYXR0cigiYXJpYS1hY3RpdmVkZXNjZW5kYW50IixpLmZpbmQoIi5zZWxlY3QyLXJlc3VsdC1sYWJlbCIpLmF0dHIoImlkIikpLHRoaXMuZW5zdXJlSGlnaGxpZ2h0VmlzaWJsZSgpLHRoaXMubGl2ZVJlZ2lvbi50ZXh0KGkudGV4dCgpKSxuPWkuZGF0YSgic2VsZWN0Mi1kYXRhIiksdm9pZChuJiZ0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKHt0eXBlOiJzZWxlY3QyLWhpZ2hsaWdodCIsdmFsOnRoaXMuaWQobiksY2hvaWNlOm59KSkpfSxyZW1vdmVIaWdobGlnaHQ6ZnVuY3Rpb24oKXt0aGlzLnJlc3VsdHMuZmluZCgiLnNlbGVjdDItaGlnaGxpZ2h0ZWQiKS5yZW1vdmVDbGFzcygic2VsZWN0Mi1oaWdobGlnaHRlZCIpfSx0b3VjaE1vdmVkOmZ1bmN0aW9uKCl7dGhpcy5fdG91Y2hNb3ZlZD0hMH0sY2xlYXJUb3VjaE1vdmVkOmZ1bmN0aW9uKCl7dGhpcy5fdG91Y2hNb3ZlZD0hMX0sY291bnRTZWxlY3RhYmxlUmVzdWx0czpmdW5jdGlvbigpe3JldHVybiB0aGlzLmZpbmRIaWdobGlnaHRhYmxlQ2hvaWNlcygpLmxlbmd0aH0saGlnaGxpZ2h0VW5kZXJFdmVudDpmdW5jdGlvbihlKXt2YXIgaT10KGUudGFyZ2V0KS5jbG9zZXN0KCIuc2VsZWN0Mi1yZXN1bHQtc2VsZWN0YWJsZSIpO2lmKGkubGVuZ3RoPjAmJiFpLmlzKCIuc2VsZWN0Mi1oaWdobGlnaHRlZCIpKXt2YXIgbj10aGlzLmZpbmRIaWdobGlnaHRhYmxlQ2hvaWNlcygpO3RoaXMuaGlnaGxpZ2h0KG4uaW5kZXgoaSkpfWVsc2UgMD09aS5sZW5ndGgmJnRoaXMucmVtb3ZlSGlnaGxpZ2h0KCl9LGxvYWRNb3JlSWZOZWVkZWQ6ZnVuY3Rpb24oKXt2YXIgdCxlPXRoaXMucmVzdWx0cyxpPWUuZmluZCgibGkuc2VsZWN0Mi1tb3JlLXJlc3VsdHMiKSxuPXRoaXMucmVzdWx0c1BhZ2UrMSxyPXRoaXMscz10aGlzLnNlYXJjaC52YWwoKSxvPXRoaXMuY29udGV4dDswIT09aS5sZW5ndGgmJih0PWkub2Zmc2V0KCkudG9wLWUub2Zmc2V0KCkudG9wLWUuaGVpZ2h0KCksdDw9dGhpcy5vcHRzLmxvYWRNb3JlUGFkZGluZyYmKGkuYWRkQ2xhc3MoInNlbGVjdDItYWN0aXZlIiksdGhpcy5vcHRzLnF1ZXJ5KHtlbGVtZW50OnRoaXMub3B0cy5lbGVtZW50LHRlcm06cyxwYWdlOm4sY29udGV4dDpvLG1hdGNoZXI6dGhpcy5vcHRzLm1hdGNoZXIsY2FsbGJhY2s6dGhpcy5iaW5kKGZ1bmN0aW9uKHQpe3Iub3BlbmVkKCkmJihyLm9wdHMucG9wdWxhdGVSZXN1bHRzLmNhbGwodGhpcyxlLHQucmVzdWx0cyx7dGVybTpzLHBhZ2U6bixjb250ZXh0Om99KSxyLnBvc3Rwcm9jZXNzUmVzdWx0cyh0LCExLCExKSx0Lm1vcmU9PT0hMD8oaS5kZXRhY2goKS5hcHBlbmRUbyhlKS50ZXh0KEwoci5vcHRzLmZvcm1hdExvYWRNb3JlLHIub3B0cy5lbGVtZW50LG4rMSkpLHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ci5sb2FkTW9yZUlmTmVlZGVkKCl9LDEwKSk6aS5yZW1vdmUoKSxyLnBvc2l0aW9uRHJvcGRvd24oKSxyLnJlc3VsdHNQYWdlPW4sci5jb250ZXh0PXQuY29udGV4dCx0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKHt0eXBlOiJzZWxlY3QyLWxvYWRlZCIsaXRlbXM6dH0pKX0pfSkpKX0sdG9rZW5pemU6ZnVuY3Rpb24oKXt9LHVwZGF0ZVJlc3VsdHM6ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gbigpe2MucmVtb3ZlQ2xhc3MoInNlbGVjdDItYWN0aXZlIiksaC5wb3NpdGlvbkRyb3Bkb3duKCksdS5maW5kKCIuc2VsZWN0Mi1uby1yZXN1bHRzLC5zZWxlY3QyLXNlbGVjdGlvbi1saW1pdCwuc2VsZWN0Mi1zZWFyY2hpbmciKS5sZW5ndGg/aC5saXZlUmVnaW9uLnRleHQodS50ZXh0KCkpOmgubGl2ZVJlZ2lvbi50ZXh0KGgub3B0cy5mb3JtYXRNYXRjaGVzKHUuZmluZCgiLnNlbGVjdDItcmVzdWx0LXNlbGVjdGFibGUiKS5sZW5ndGgpKX1mdW5jdGlvbiByKHQpe3UuaHRtbCh0KSxuKCl9dmFyIHMsbyxsLGM9dGhpcy5zZWFyY2gsdT10aGlzLnJlc3VsdHMsZD10aGlzLm9wdHMsaD10aGlzLHA9Yy52YWwoKSxmPXQuZGF0YSh0aGlzLmNvbnRhaW5lciwic2VsZWN0Mi1sYXN0LXRlcm0iKTtpZigoZT09PSEwfHwhZnx8IWEocCxmKSkmJih0LmRhdGEodGhpcy5jb250YWluZXIsInNlbGVjdDItbGFzdC10ZXJtIixwKSxlPT09ITB8fHRoaXMuc2hvd1NlYXJjaElucHV0IT09ITEmJnRoaXMub3BlbmVkKCkpKXtsPSsrdGhpcy5xdWVyeUNvdW50O3ZhciBtPXRoaXMuZ2V0TWF4aW11bVNlbGVjdGlvblNpemUoKTtpZihtPj0xJiYocz10aGlzLmRhdGEoKSx0LmlzQXJyYXkocykmJnMubGVuZ3RoPj1tJiZTKGQuZm9ybWF0U2VsZWN0aW9uVG9vQmlnLCJmb3JtYXRTZWxlY3Rpb25Ub29CaWciKSkpcmV0dXJuIHZvaWQgcigiPGxpIGNsYXNzPSdzZWxlY3QyLXNlbGVjdGlvbi1saW1pdCc+IitMKGQuZm9ybWF0U2VsZWN0aW9uVG9vQmlnLGQuZWxlbWVudCxtKSsiPC9saT4iKTtpZihjLnZhbCgpLmxlbmd0aDxkLm1pbmltdW1JbnB1dExlbmd0aClyZXR1cm4gcihTKGQuZm9ybWF0SW5wdXRUb29TaG9ydCwiZm9ybWF0SW5wdXRUb29TaG9ydCIpPyI8bGkgY2xhc3M9J3NlbGVjdDItbm8tcmVzdWx0cyc+IitMKGQuZm9ybWF0SW5wdXRUb29TaG9ydCxkLmVsZW1lbnQsYy52YWwoKSxkLm1pbmltdW1JbnB1dExlbmd0aCkrIjwvbGk+IjoiIiksdm9pZChlJiZ0aGlzLnNob3dTZWFyY2gmJnRoaXMuc2hvd1NlYXJjaCghMCkpO2lmKGQubWF4aW11bUlucHV0TGVuZ3RoJiZjLnZhbCgpLmxlbmd0aD5kLm1heGltdW1JbnB1dExlbmd0aClyZXR1cm4gdm9pZCByKFMoZC5mb3JtYXRJbnB1dFRvb0xvbmcsImZvcm1hdElucHV0VG9vTG9uZyIpPyI8bGkgY2xhc3M9J3NlbGVjdDItbm8tcmVzdWx0cyc+IitMKGQuZm9ybWF0SW5wdXRUb29Mb25nLGQuZWxlbWVudCxjLnZhbCgpLGQubWF4aW11bUlucHV0TGVuZ3RoKSsiPC9saT4iOiIiKTtkLmZvcm1hdFNlYXJjaGluZyYmMD09PXRoaXMuZmluZEhpZ2hsaWdodGFibGVDaG9pY2VzKCkubGVuZ3RoJiZyKCI8bGkgY2xhc3M9J3NlbGVjdDItc2VhcmNoaW5nJz4iK0woZC5mb3JtYXRTZWFyY2hpbmcsZC5lbGVtZW50KSsiPC9saT4iKSxjLmFkZENsYXNzKCJzZWxlY3QyLWFjdGl2ZSIpLHRoaXMucmVtb3ZlSGlnaGxpZ2h0KCksbz10aGlzLnRva2VuaXplKCksbyE9aSYmbnVsbCE9byYmYy52YWwobyksdGhpcy5yZXN1bHRzUGFnZT0xLGQucXVlcnkoe2VsZW1lbnQ6ZC5lbGVtZW50LHRlcm06Yy52YWwoKSxwYWdlOnRoaXMucmVzdWx0c1BhZ2UsY29udGV4dDpudWxsLG1hdGNoZXI6ZC5tYXRjaGVyLGNhbGxiYWNrOnRoaXMuYmluZChmdW5jdGlvbihzKXt2YXIgbztpZihsPT10aGlzLnF1ZXJ5Q291bnQpe2lmKCF0aGlzLm9wZW5lZCgpKXJldHVybiB2b2lkIHRoaXMuc2VhcmNoLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWFjdGl2ZSIpO2lmKHMuaGFzRXJyb3IhPT1pJiZTKGQuZm9ybWF0QWpheEVycm9yLCJmb3JtYXRBamF4RXJyb3IiKSlyZXR1cm4gdm9pZCByKCI8bGkgY2xhc3M9J3NlbGVjdDItYWpheC1lcnJvcic+IitMKGQuZm9ybWF0QWpheEVycm9yLGQuZWxlbWVudCxzLmpxWEhSLHMudGV4dFN0YXR1cyxzLmVycm9yVGhyb3duKSsiPC9saT4iKTtpZih0aGlzLmNvbnRleHQ9cy5jb250ZXh0PT09aT9udWxsOnMuY29udGV4dCx0aGlzLm9wdHMuY3JlYXRlU2VhcmNoQ2hvaWNlJiYiIiE9PWMudmFsKCkmJihvPXRoaXMub3B0cy5jcmVhdGVTZWFyY2hDaG9pY2UuY2FsbChoLGMudmFsKCkscy5yZXN1bHRzKSxvIT09aSYmbnVsbCE9PW8mJmguaWQobykhPT1pJiZudWxsIT09aC5pZChvKSYmMD09PXQocy5yZXN1bHRzKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4gYShoLmlkKHRoaXMpLGguaWQobykpfSkubGVuZ3RoJiZ0aGlzLm9wdHMuY3JlYXRlU2VhcmNoQ2hvaWNlUG9zaXRpb24ocy5yZXN1bHRzLG8pKSwwPT09cy5yZXN1bHRzLmxlbmd0aCYmUyhkLmZvcm1hdE5vTWF0Y2hlcywiZm9ybWF0Tm9NYXRjaGVzIikpcmV0dXJuIHZvaWQgcigiPGxpIGNsYXNzPSdzZWxlY3QyLW5vLXJlc3VsdHMnPiIrTChkLmZvcm1hdE5vTWF0Y2hlcyxkLmVsZW1lbnQsYy52YWwoKSkrIjwvbGk+Iik7dS5lbXB0eSgpLGgub3B0cy5wb3B1bGF0ZVJlc3VsdHMuY2FsbCh0aGlzLHUscy5yZXN1bHRzLHt0ZXJtOmMudmFsKCkscGFnZTp0aGlzLnJlc3VsdHNQYWdlLGNvbnRleHQ6bnVsbH0pLHMubW9yZT09PSEwJiZTKGQuZm9ybWF0TG9hZE1vcmUsImZvcm1hdExvYWRNb3JlIikmJih1LmFwcGVuZCgiPGxpIGNsYXNzPSdzZWxlY3QyLW1vcmUtcmVzdWx0cyc+IitkLmVzY2FwZU1hcmt1cChMKGQuZm9ybWF0TG9hZE1vcmUsZC5lbGVtZW50LHRoaXMucmVzdWx0c1BhZ2UpKSsiPC9saT4iKSx3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe2gubG9hZE1vcmVJZk5lZWRlZCgpfSwxMCkpLHRoaXMucG9zdHByb2Nlc3NSZXN1bHRzKHMsZSksbigpLHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIoe3R5cGU6InNlbGVjdDItbG9hZGVkIixpdGVtczpzfSl9fSl9KX19LGNhbmNlbDpmdW5jdGlvbigpe3RoaXMuY2xvc2UoKX0sYmx1cjpmdW5jdGlvbigpe3RoaXMub3B0cy5zZWxlY3RPbkJsdXImJnRoaXMuc2VsZWN0SGlnaGxpZ2h0ZWQoe25vRm9jdXM6ITB9KSx0aGlzLmNsb3NlKCksdGhpcy5jb250YWluZXIucmVtb3ZlQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpLHRoaXMuc2VhcmNoWzBdPT09ZG9jdW1lbnQuYWN0aXZlRWxlbWVudCYmdGhpcy5zZWFyY2guYmx1cigpLHRoaXMuY2xlYXJTZWFyY2goKSx0aGlzLnNlbGVjdGlvbi5maW5kKCIuc2VsZWN0Mi1zZWFyY2gtY2hvaWNlLWZvY3VzIikucmVtb3ZlQ2xhc3MoInNlbGVjdDItc2VhcmNoLWNob2ljZS1mb2N1cyIpfSxmb2N1c1NlYXJjaDpmdW5jdGlvbigpe2YodGhpcy5zZWFyY2gpfSxzZWxlY3RIaWdobGlnaHRlZDpmdW5jdGlvbih0KXtpZih0aGlzLl90b3VjaE1vdmVkKXJldHVybiB2b2lkIHRoaXMuY2xlYXJUb3VjaE1vdmVkKCk7dmFyIGU9dGhpcy5oaWdobGlnaHQoKSxpPXRoaXMucmVzdWx0cy5maW5kKCIuc2VsZWN0Mi1oaWdobGlnaHRlZCIpLG49aS5jbG9zZXN0KCIuc2VsZWN0Mi1yZXN1bHQiKS5kYXRhKCJzZWxlY3QyLWRhdGEiKTtuPyh0aGlzLmhpZ2hsaWdodChlKSx0aGlzLm9uU2VsZWN0KG4sdCkpOnQmJnQubm9Gb2N1cyYmdGhpcy5jbG9zZSgpfSxnZXRQbGFjZWhvbGRlcjpmdW5jdGlvbigpe3ZhciB0O3JldHVybiB0aGlzLm9wdHMuZWxlbWVudC5hdHRyKCJwbGFjZWhvbGRlciIpfHx0aGlzLm9wdHMuZWxlbWVudC5hdHRyKCJkYXRhLXBsYWNlaG9sZGVyIil8fHRoaXMub3B0cy5lbGVtZW50LmRhdGEoInBsYWNlaG9sZGVyIil8fHRoaXMub3B0cy5wbGFjZWhvbGRlcnx8KCh0PXRoaXMuZ2V0UGxhY2Vob2xkZXJPcHRpb24oKSkhPT1pP3QudGV4dCgpOmkpfSxnZXRQbGFjZWhvbGRlck9wdGlvbjpmdW5jdGlvbigpe2lmKHRoaXMuc2VsZWN0KXt2YXIgZT10aGlzLnNlbGVjdC5jaGlsZHJlbigib3B0aW9uIikuZmlyc3QoKTtpZih0aGlzLm9wdHMucGxhY2Vob2xkZXJPcHRpb24hPT1pKXJldHVybiJmaXJzdCI9PT10aGlzLm9wdHMucGxhY2Vob2xkZXJPcHRpb24mJmV8fCJmdW5jdGlvbiI9PXR5cGVvZiB0aGlzLm9wdHMucGxhY2Vob2xkZXJPcHRpb24mJnRoaXMub3B0cy5wbGFjZWhvbGRlck9wdGlvbih0aGlzLnNlbGVjdCk7aWYoIiI9PT10LnRyaW0oZS50ZXh0KCkpJiYiIj09PWUudmFsKCkpcmV0dXJuIGV9fSxpbml0Q29udGFpbmVyV2lkdGg6ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dmFyIGUsbixyLHMsbyxhO2lmKCJvZmYiPT09dGhpcy5vcHRzLndpZHRoKXJldHVybiBudWxsO2lmKCJlbGVtZW50Ij09PXRoaXMub3B0cy53aWR0aClyZXR1cm4gMD09PXRoaXMub3B0cy5lbGVtZW50Lm91dGVyV2lkdGgoITEpPyJhdXRvIjp0aGlzLm9wdHMuZWxlbWVudC5vdXRlcldpZHRoKCExKSsicHgiO2lmKCJjb3B5Ij09PXRoaXMub3B0cy53aWR0aHx8InJlc29sdmUiPT09dGhpcy5vcHRzLndpZHRoKXtpZihlPXRoaXMub3B0cy5lbGVtZW50LmF0dHIoInN0eWxlIiksZSE9PWkpZm9yKG49ZS5zcGxpdCgiOyIpLHM9MCxvPW4ubGVuZ3RoO3M8bztzKz0xKWlmKGE9bltzXS5yZXBsYWNlKC9ccy9nLCIiKSxyPWEubWF0Y2goL153aWR0aDooKFstK10/KFswLTldKlwuKT9bMC05XSspKHB4fGVtfGV4fCV8aW58Y218bW18cHR8cGMpKS9pKSxudWxsIT09ciYmci5sZW5ndGg+PTEpcmV0dXJuIHJbMV07cmV0dXJuInJlc29sdmUiPT09dGhpcy5vcHRzLndpZHRoPyhlPXRoaXMub3B0cy5lbGVtZW50LmNzcygid2lkdGgiKSxlLmluZGV4T2YoIiUiKT4wP2U6MD09PXRoaXMub3B0cy5lbGVtZW50Lm91dGVyV2lkdGgoITEpPyJhdXRvIjp0aGlzLm9wdHMuZWxlbWVudC5vdXRlcldpZHRoKCExKSsicHgiKTpudWxsfXJldHVybiB0LmlzRnVuY3Rpb24odGhpcy5vcHRzLndpZHRoKT90aGlzLm9wdHMud2lkdGgoKTp0aGlzLm9wdHMud2lkdGh9dmFyIG49ZS5jYWxsKHRoaXMpO251bGwhPT1uJiZ0aGlzLmNvbnRhaW5lci5jc3MoIndpZHRoIixuKX19KSxPPVkoQSx7Y3JlYXRlQ29udGFpbmVyOmZ1bmN0aW9uKCl7dmFyIGU9dChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSkuYXR0cih7ImNsYXNzIjoic2VsZWN0Mi1jb250YWluZXIifSkuaHRtbChbIjxhIGhyZWY9J2phdmFzY3JpcHQ6dm9pZCgwKScgY2xhc3M9J3NlbGVjdDItY2hvaWNlJyB0YWJpbmRleD0nLTEnPiIsIiAgIDxzcGFuIGNsYXNzPSdzZWxlY3QyLWNob3Nlbic+JiMxNjA7PC9zcGFuPjxhYmJyIGNsYXNzPSdzZWxlY3QyLXNlYXJjaC1jaG9pY2UtY2xvc2UnPjwvYWJicj4iLCIgICA8c3BhbiBjbGFzcz0nc2VsZWN0Mi1hcnJvdycgcm9sZT0ncHJlc2VudGF0aW9uJz48YiByb2xlPSdwcmVzZW50YXRpb24nPjwvYj48L3NwYW4+IiwiPC9hPiIsIjxsYWJlbCBmb3I9JycgY2xhc3M9J3NlbGVjdDItb2Zmc2NyZWVuJz48L2xhYmVsPiIsIjxpbnB1dCBjbGFzcz0nc2VsZWN0Mi1mb2N1c3NlciBzZWxlY3QyLW9mZnNjcmVlbicgdHlwZT0ndGV4dCcgYXJpYS1oYXNwb3B1cD0ndHJ1ZScgcm9sZT0nYnV0dG9uJyAvPiIsIjxkaXYgY2xhc3M9J3NlbGVjdDItZHJvcCBzZWxlY3QyLWRpc3BsYXktbm9uZSc+IiwiICAgPGRpdiBjbGFzcz0nc2VsZWN0Mi1zZWFyY2gnPiIsIiAgICAgICA8bGFiZWwgZm9yPScnIGNsYXNzPSdzZWxlY3QyLW9mZnNjcmVlbic+PC9sYWJlbD4iLCIgICAgICAgPGlucHV0IHR5cGU9J3RleHQnIGF1dG9jb21wbGV0ZT0nb2ZmJyBhdXRvY29ycmVjdD0nb2ZmJyBhdXRvY2FwaXRhbGl6ZT0nb2ZmJyBzcGVsbGNoZWNrPSdmYWxzZScgY2xhc3M9J3NlbGVjdDItaW5wdXQnIHJvbGU9J2NvbWJvYm94JyBhcmlhLWV4cGFuZGVkPSd0cnVlJyIsIiAgICAgICBhcmlhLWF1dG9jb21wbGV0ZT0nbGlzdCcgLz4iLCIgICA8L2Rpdj4iLCIgICA8dWwgY2xhc3M9J3NlbGVjdDItcmVzdWx0cycgcm9sZT0nbGlzdGJveCc+IiwiICAgPC91bD4iLCI8L2Rpdj4iXS5qb2luKCIiKSk7cmV0dXJuIGV9LGVuYWJsZUludGVyZmFjZTpmdW5jdGlvbigpe3RoaXMucGFyZW50LmVuYWJsZUludGVyZmFjZS5hcHBseSh0aGlzLGFyZ3VtZW50cykmJnRoaXMuZm9jdXNzZXIucHJvcCgiZGlzYWJsZWQiLCF0aGlzLmlzSW50ZXJmYWNlRW5hYmxlZCgpKX0sb3BlbmluZzpmdW5jdGlvbigpe3ZhciBlLG4scjt0aGlzLm9wdHMubWluaW11bVJlc3VsdHNGb3JTZWFyY2g+PTAmJnRoaXMuc2hvd1NlYXJjaCghMCksdGhpcy5wYXJlbnQub3BlbmluZy5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5zaG93U2VhcmNoSW5wdXQhPT0hMSYmdGhpcy5zZWFyY2gudmFsKHRoaXMuZm9jdXNzZXIudmFsKCkpLHRoaXMub3B0cy5zaG91bGRGb2N1c0lucHV0KHRoaXMpJiYodGhpcy5zZWFyY2guZm9jdXMoKSxlPXRoaXMuc2VhcmNoLmdldCgwKSxlLmNyZWF0ZVRleHRSYW5nZT8obj1lLmNyZWF0ZVRleHRSYW5nZSgpLG4uY29sbGFwc2UoITEpLG4uc2VsZWN0KCkpOmUuc2V0U2VsZWN0aW9uUmFuZ2UmJihyPXRoaXMuc2VhcmNoLnZhbCgpLmxlbmd0aCxlLnNldFNlbGVjdGlvblJhbmdlKHIscikpKSwiIj09PXRoaXMuc2VhcmNoLnZhbCgpJiZ0aGlzLm5leHRTZWFyY2hUZXJtIT1pJiYodGhpcy5zZWFyY2gudmFsKHRoaXMubmV4dFNlYXJjaFRlcm0pLHRoaXMuc2VhcmNoLnNlbGVjdCgpKSx0aGlzLmZvY3Vzc2VyLnByb3AoImRpc2FibGVkIiwhMCkudmFsKCIiKSx0aGlzLnVwZGF0ZVJlc3VsdHMoITApLHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIodC5FdmVudCgic2VsZWN0Mi1vcGVuIikpfSxjbG9zZTpmdW5jdGlvbigpe3RoaXMub3BlbmVkKCkmJih0aGlzLnBhcmVudC5jbG9zZS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5mb2N1c3Nlci5wcm9wKCJkaXNhYmxlZCIsITEpLHRoaXMub3B0cy5zaG91bGRGb2N1c0lucHV0KHRoaXMpJiZ0aGlzLmZvY3Vzc2VyLmZvY3VzKCkpfSxmb2N1czpmdW5jdGlvbigpe3RoaXMub3BlbmVkKCk/dGhpcy5jbG9zZSgpOih0aGlzLmZvY3Vzc2VyLnByb3AoImRpc2FibGVkIiwhMSksdGhpcy5vcHRzLnNob3VsZEZvY3VzSW5wdXQodGhpcykmJnRoaXMuZm9jdXNzZXIuZm9jdXMoKSl9LGlzRm9jdXNlZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRhaW5lci5oYXNDbGFzcygic2VsZWN0Mi1jb250YWluZXItYWN0aXZlIil9LGNhbmNlbDpmdW5jdGlvbigpe3RoaXMucGFyZW50LmNhbmNlbC5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5mb2N1c3Nlci5wcm9wKCJkaXNhYmxlZCIsITEpLHRoaXMub3B0cy5zaG91bGRGb2N1c0lucHV0KHRoaXMpJiZ0aGlzLmZvY3Vzc2VyLmZvY3VzKCl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0KCJsYWJlbFtmb3I9JyIrdGhpcy5mb2N1c3Nlci5hdHRyKCJpZCIpKyInXSIpLmF0dHIoImZvciIsdGhpcy5vcHRzLmVsZW1lbnQuYXR0cigiaWQiKSksdGhpcy5wYXJlbnQuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyksRC5jYWxsKHRoaXMsInNlbGVjdGlvbiIsImZvY3Vzc2VyIil9LGluaXRDb250YWluZXI6ZnVuY3Rpb24oKXt2YXIgZSxpLHI9dGhpcy5jb250YWluZXIscz10aGlzLmRyb3Bkb3duLG89SSgpO3RoaXMub3B0cy5taW5pbXVtUmVzdWx0c0ZvclNlYXJjaDwwP3RoaXMuc2hvd1NlYXJjaCghMSk6dGhpcy5zaG93U2VhcmNoKCEwKSx0aGlzLnNlbGVjdGlvbj1lPXIuZmluZCgiLnNlbGVjdDItY2hvaWNlIiksdGhpcy5mb2N1c3Nlcj1yLmZpbmQoIi5zZWxlY3QyLWZvY3Vzc2VyIiksZS5maW5kKCIuc2VsZWN0Mi1jaG9zZW4iKS5hdHRyKCJpZCIsInNlbGVjdDItY2hvc2VuLSIrbyksdGhpcy5mb2N1c3Nlci5hdHRyKCJhcmlhLWxhYmVsbGVkYnkiLCJzZWxlY3QyLWNob3Nlbi0iK28pLHRoaXMucmVzdWx0cy5hdHRyKCJpZCIsInNlbGVjdDItcmVzdWx0cy0iK28pLHRoaXMuc2VhcmNoLmF0dHIoImFyaWEtb3ducyIsInNlbGVjdDItcmVzdWx0cy0iK28pLHRoaXMuZm9jdXNzZXIuYXR0cigiaWQiLCJzMmlkX2F1dG9nZW4iK28pLGk9dCgibGFiZWxbZm9yPSciK3RoaXMub3B0cy5lbGVtZW50LmF0dHIoImlkIikrIiddIiksdGhpcy5mb2N1c3Nlci5wcmV2KCkudGV4dChpLnRleHQoKSkuYXR0cigiZm9yIix0aGlzLmZvY3Vzc2VyLmF0dHIoImlkIikpO3ZhciBhPXRoaXMub3B0cy5lbGVtZW50LmF0dHIoInRpdGxlIik7dGhpcy5vcHRzLmVsZW1lbnQuYXR0cigidGl0bGUiLGF8fGkudGV4dCgpKSx0aGlzLmZvY3Vzc2VyLmF0dHIoInRhYmluZGV4Iix0aGlzLmVsZW1lbnRUYWJJbmRleCksdGhpcy5zZWFyY2guYXR0cigiaWQiLHRoaXMuZm9jdXNzZXIuYXR0cigiaWQiKSsiX3NlYXJjaCIpLHRoaXMuc2VhcmNoLnByZXYoKS50ZXh0KHQoImxhYmVsW2Zvcj0nIit0aGlzLmZvY3Vzc2VyLmF0dHIoImlkIikrIiddIikudGV4dCgpKS5hdHRyKCJmb3IiLHRoaXMuc2VhcmNoLmF0dHIoImlkIikpLHRoaXMuc2VhcmNoLm9uKCJrZXlkb3duIix0aGlzLmJpbmQoZnVuY3Rpb24odCl7aWYodGhpcy5pc0ludGVyZmFjZUVuYWJsZWQoKSYmMjI5IT10LmtleUNvZGUpe2lmKHQud2hpY2g9PT1DLlBBR0VfVVB8fHQud2hpY2g9PT1DLlBBR0VfRE9XTilyZXR1cm4gdm9pZCBfKHQpO3N3aXRjaCh0LndoaWNoKXtjYXNlIEMuVVA6Y2FzZSBDLkRPV046cmV0dXJuIHRoaXMubW92ZUhpZ2hsaWdodCh0LndoaWNoPT09Qy5VUD8tMToxKSx2b2lkIF8odCk7Y2FzZSBDLkVOVEVSOnJldHVybiB0aGlzLnNlbGVjdEhpZ2hsaWdodGVkKCksdm9pZCBfKHQpO2Nhc2UgQy5UQUI6cmV0dXJuIHZvaWQgdGhpcy5zZWxlY3RIaWdobGlnaHRlZCh7bm9Gb2N1czohMH0pO2Nhc2UgQy5FU0M6cmV0dXJuIHRoaXMuY2FuY2VsKHQpLHZvaWQgXyh0KX19fSkpLHRoaXMuc2VhcmNoLm9uKCJibHVyIix0aGlzLmJpbmQoZnVuY3Rpb24odCl7ZG9jdW1lbnQuYWN0aXZlRWxlbWVudD09PXRoaXMuYm9keS5nZXQoMCkmJndpbmRvdy5zZXRUaW1lb3V0KHRoaXMuYmluZChmdW5jdGlvbigpe3RoaXMub3BlbmVkKCkmJnRoaXMuc2VhcmNoLmZvY3VzKCl9KSwwKX0pKSx0aGlzLmZvY3Vzc2VyLm9uKCJrZXlkb3duIix0aGlzLmJpbmQoZnVuY3Rpb24odCl7aWYodGhpcy5pc0ludGVyZmFjZUVuYWJsZWQoKSYmdC53aGljaCE9PUMuVEFCJiYhQy5pc0NvbnRyb2wodCkmJiFDLmlzRnVuY3Rpb25LZXkodCkmJnQud2hpY2ghPT1DLkVTQyl7aWYodGhpcy5vcHRzLm9wZW5PbkVudGVyPT09ITEmJnQud2hpY2g9PT1DLkVOVEVSKXJldHVybiB2b2lkIF8odCk7aWYodC53aGljaD09Qy5ET1dOfHx0LndoaWNoPT1DLlVQfHx0LndoaWNoPT1DLkVOVEVSJiZ0aGlzLm9wdHMub3Blbk9uRW50ZXIpe2lmKHQuYWx0S2V5fHx0LmN0cmxLZXl8fHQuc2hpZnRLZXl8fHQubWV0YUtleSlyZXR1cm47cmV0dXJuIHRoaXMub3BlbigpLHZvaWQgXyh0KX1yZXR1cm4gdC53aGljaD09Qy5ERUxFVEV8fHQud2hpY2g9PUMuQkFDS1NQQUNFPyh0aGlzLm9wdHMuYWxsb3dDbGVhciYmdGhpcy5jbGVhcigpLHZvaWQgXyh0KSk6dm9pZCAwfX0pKSx1KHRoaXMuZm9jdXNzZXIpLHRoaXMuZm9jdXNzZXIub24oImtleXVwLWNoYW5nZSBpbnB1dCIsdGhpcy5iaW5kKGZ1bmN0aW9uKHQpe2lmKHRoaXMub3B0cy5taW5pbXVtUmVzdWx0c0ZvclNlYXJjaD49MCl7aWYodC5zdG9wUHJvcGFnYXRpb24oKSx0aGlzLm9wZW5lZCgpKXJldHVybjt0aGlzLm9wZW4oKX19KSksZS5vbigibW91c2Vkb3duIHRvdWNoc3RhcnQiLCJhYmJyIix0aGlzLmJpbmQoZnVuY3Rpb24odCl7dGhpcy5pc0ludGVyZmFjZUVuYWJsZWQoKSYmKHRoaXMuY2xlYXIoKSxnKHQpLHRoaXMuY2xvc2UoKSx0aGlzLnNlbGVjdGlvbi5mb2N1cygpKX0pKSxlLm9uKCJtb3VzZWRvd24gdG91Y2hzdGFydCIsdGhpcy5iaW5kKGZ1bmN0aW9uKGkpe24oZSksdGhpcy5jb250YWluZXIuaGFzQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpfHx0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKHQuRXZlbnQoInNlbGVjdDItZm9jdXMiKSksdGhpcy5vcGVuZWQoKT90aGlzLmNsb3NlKCk6dGhpcy5pc0ludGVyZmFjZUVuYWJsZWQoKSYmdGhpcy5vcGVuKCksXyhpKX0pKSxzLm9uKCJtb3VzZWRvd24gdG91Y2hzdGFydCIsdGhpcy5iaW5kKGZ1bmN0aW9uKCl7dGhpcy5vcHRzLnNob3VsZEZvY3VzSW5wdXQodGhpcykmJnRoaXMuc2VhcmNoLmZvY3VzKCl9KSksZS5vbigiZm9jdXMiLHRoaXMuYmluZChmdW5jdGlvbih0KXtfKHQpfSkpLHRoaXMuZm9jdXNzZXIub24oImZvY3VzIix0aGlzLmJpbmQoZnVuY3Rpb24oKXt0aGlzLmNvbnRhaW5lci5oYXNDbGFzcygic2VsZWN0Mi1jb250YWluZXItYWN0aXZlIil8fHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIodC5FdmVudCgic2VsZWN0Mi1mb2N1cyIpKSx0aGlzLmNvbnRhaW5lci5hZGRDbGFzcygic2VsZWN0Mi1jb250YWluZXItYWN0aXZlIil9KSkub24oImJsdXIiLHRoaXMuYmluZChmdW5jdGlvbigpe3RoaXMub3BlbmVkKCl8fCh0aGlzLmNvbnRhaW5lci5yZW1vdmVDbGFzcygic2VsZWN0Mi1jb250YWluZXItYWN0aXZlIiksdGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcih0LkV2ZW50KCJzZWxlY3QyLWJsdXIiKSkpfSkpLHRoaXMuc2VhcmNoLm9uKCJmb2N1cyIsdGhpcy5iaW5kKGZ1bmN0aW9uKCl7dGhpcy5jb250YWluZXIuaGFzQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpfHx0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKHQuRXZlbnQoInNlbGVjdDItZm9jdXMiKSksdGhpcy5jb250YWluZXIuYWRkQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpfSkpLHRoaXMuaW5pdENvbnRhaW5lcldpZHRoKCksdGhpcy5vcHRzLmVsZW1lbnQuYWRkQ2xhc3MoInNlbGVjdDItb2Zmc2NyZWVuIiksdGhpcy5zZXRQbGFjZWhvbGRlcigpfSxjbGVhcjpmdW5jdGlvbihlKXt2YXIgaT10aGlzLnNlbGVjdGlvbi5kYXRhKCJzZWxlY3QyLWRhdGEiKTtpZihpKXt2YXIgbj10LkV2ZW50KCJzZWxlY3QyLWNsZWFyaW5nIik7aWYodGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcihuKSxuLmlzRGVmYXVsdFByZXZlbnRlZCgpKXJldHVybjt2YXIgcj10aGlzLmdldFBsYWNlaG9sZGVyT3B0aW9uKCk7dGhpcy5vcHRzLmVsZW1lbnQudmFsKHI/ci52YWwoKToiIiksdGhpcy5zZWxlY3Rpb24uZmluZCgiLnNlbGVjdDItY2hvc2VuIikuZW1wdHkoKSx0aGlzLnNlbGVjdGlvbi5yZW1vdmVEYXRhKCJzZWxlY3QyLWRhdGEiKSx0aGlzLnNldFBsYWNlaG9sZGVyKCksZSE9PSExJiYodGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcih7dHlwZToic2VsZWN0Mi1yZW1vdmVkIix2YWw6dGhpcy5pZChpKSxjaG9pY2U6aX0pLHRoaXMudHJpZ2dlckNoYW5nZSh7cmVtb3ZlZDppfSkpfX0saW5pdFNlbGVjdGlvbjpmdW5jdGlvbigpe2lmKHRoaXMuaXNQbGFjZWhvbGRlck9wdGlvblNlbGVjdGVkKCkpdGhpcy51cGRhdGVTZWxlY3Rpb24obnVsbCksdGhpcy5jbG9zZSgpLHRoaXMuc2V0UGxhY2Vob2xkZXIoKTtlbHNle3ZhciB0PXRoaXM7dGhpcy5vcHRzLmluaXRTZWxlY3Rpb24uY2FsbChudWxsLHRoaXMub3B0cy5lbGVtZW50LGZ1bmN0aW9uKGUpe2UhPT1pJiZudWxsIT09ZSYmKHQudXBkYXRlU2VsZWN0aW9uKGUpLHQuY2xvc2UoKSx0LnNldFBsYWNlaG9sZGVyKCksdC5uZXh0U2VhcmNoVGVybT10Lm9wdHMubmV4dFNlYXJjaFRlcm0oZSx0LnNlYXJjaC52YWwoKSkpfSl9fSxpc1BsYWNlaG9sZGVyT3B0aW9uU2VsZWN0ZWQ6ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdGhpcy5nZXRQbGFjZWhvbGRlcigpIT09aSYmKCh0PXRoaXMuZ2V0UGxhY2Vob2xkZXJPcHRpb24oKSkhPT1pJiZ0LnByb3AoInNlbGVjdGVkIil8fCIiPT09dGhpcy5vcHRzLmVsZW1lbnQudmFsKCl8fHRoaXMub3B0cy5lbGVtZW50LnZhbCgpPT09aXx8bnVsbD09PXRoaXMub3B0cy5lbGVtZW50LnZhbCgpKX0scHJlcGFyZU9wdHM6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnBhcmVudC5wcmVwYXJlT3B0cy5hcHBseSh0aGlzLGFyZ3VtZW50cyksaT10aGlzO3JldHVybiJzZWxlY3QiPT09ZS5lbGVtZW50LmdldCgwKS50YWdOYW1lLnRvTG93ZXJDYXNlKCk/ZS5pbml0U2VsZWN0aW9uPWZ1bmN0aW9uKHQsZSl7dmFyIG49dC5maW5kKCJvcHRpb24iKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWxlY3RlZCYmIXRoaXMuZGlzYWJsZWR9KTtlKGkub3B0aW9uVG9EYXRhKG4pKX06ImRhdGEiaW4gZSYmKGUuaW5pdFNlbGVjdGlvbj1lLmluaXRTZWxlY3Rpb258fGZ1bmN0aW9uKGksbil7dmFyIHI9aS52YWwoKSxzPW51bGw7ZS5xdWVyeSh7bWF0Y2hlcjpmdW5jdGlvbih0LGksbil7dmFyIG89YShyLGUuaWQobikpO3JldHVybiBvJiYocz1uKSxvfSxjYWxsYmFjazp0LmlzRnVuY3Rpb24obik/ZnVuY3Rpb24oKXtuKHMpfTp0Lm5vb3B9KX0pLGV9LGdldFBsYWNlaG9sZGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VsZWN0JiZ0aGlzLmdldFBsYWNlaG9sZGVyT3B0aW9uKCk9PT1pP2k6dGhpcy5wYXJlbnQuZ2V0UGxhY2Vob2xkZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzZXRQbGFjZWhvbGRlcjpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0UGxhY2Vob2xkZXIoKTtpZih0aGlzLmlzUGxhY2Vob2xkZXJPcHRpb25TZWxlY3RlZCgpJiZ0IT09aSl7aWYodGhpcy5zZWxlY3QmJnRoaXMuZ2V0UGxhY2Vob2xkZXJPcHRpb24oKT09PWkpcmV0dXJuO3RoaXMuc2VsZWN0aW9uLmZpbmQoIi5zZWxlY3QyLWNob3NlbiIpLmh0bWwodGhpcy5vcHRzLmVzY2FwZU1hcmt1cCh0KSksdGhpcy5zZWxlY3Rpb24uYWRkQ2xhc3MoInNlbGVjdDItZGVmYXVsdCIpLHRoaXMuY29udGFpbmVyLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWFsbG93Y2xlYXIiKX19LHBvc3Rwcm9jZXNzUmVzdWx0czpmdW5jdGlvbih0LGUsaSl7dmFyIG49MCxyPXRoaXM7aWYodGhpcy5maW5kSGlnaGxpZ2h0YWJsZUNob2ljZXMoKS5lYWNoMihmdW5jdGlvbih0LGUpe2lmKGEoci5pZChlLmRhdGEoInNlbGVjdDItZGF0YSIpKSxyLm9wdHMuZWxlbWVudC52YWwoKSkpcmV0dXJuIG49dCwhMX0pLGkhPT0hMSYmKGU9PT0hMCYmbj49MD90aGlzLmhpZ2hsaWdodChuKTp0aGlzLmhpZ2hsaWdodCgwKSksZT09PSEwKXt2YXIgcz10aGlzLm9wdHMubWluaW11bVJlc3VsdHNGb3JTZWFyY2g7cz49MCYmdGhpcy5zaG93U2VhcmNoKHgodC5yZXN1bHRzKT49cyl9fSxzaG93U2VhcmNoOmZ1bmN0aW9uKGUpe3RoaXMuc2hvd1NlYXJjaElucHV0IT09ZSYmKHRoaXMuc2hvd1NlYXJjaElucHV0PWUsdGhpcy5kcm9wZG93bi5maW5kKCIuc2VsZWN0Mi1zZWFyY2giKS50b2dnbGVDbGFzcygic2VsZWN0Mi1zZWFyY2gtaGlkZGVuIiwhZSksdGhpcy5kcm9wZG93bi5maW5kKCIuc2VsZWN0Mi1zZWFyY2giKS50b2dnbGVDbGFzcygic2VsZWN0Mi1vZmZzY3JlZW4iLCFlKSx0KHRoaXMuZHJvcGRvd24sdGhpcy5jb250YWluZXIpLnRvZ2dsZUNsYXNzKCJzZWxlY3QyLXdpdGgtc2VhcmNoYm94IixlKSl9LG9uU2VsZWN0OmZ1bmN0aW9uKHQsZSl7aWYodGhpcy50cmlnZ2VyU2VsZWN0KHQpKXt2YXIgaT10aGlzLm9wdHMuZWxlbWVudC52YWwoKSxuPXRoaXMuZGF0YSgpO3RoaXMub3B0cy5lbGVtZW50LnZhbCh0aGlzLmlkKHQpKSx0aGlzLnVwZGF0ZVNlbGVjdGlvbih0KSx0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKHt0eXBlOiJzZWxlY3QyLXNlbGVjdGVkIix2YWw6dGhpcy5pZCh0KSxjaG9pY2U6dH0pLHRoaXMubmV4dFNlYXJjaFRlcm09dGhpcy5vcHRzLm5leHRTZWFyY2hUZXJtKHQsdGhpcy5zZWFyY2gudmFsKCkpLHRoaXMuY2xvc2UoKSxlJiZlLm5vRm9jdXN8fCF0aGlzLm9wdHMuc2hvdWxkRm9jdXNJbnB1dCh0aGlzKXx8dGhpcy5mb2N1c3Nlci5mb2N1cygpLGEoaSx0aGlzLmlkKHQpKXx8dGhpcy50cmlnZ2VyQ2hhbmdlKHthZGRlZDp0LHJlbW92ZWQ6bn0pfX0sdXBkYXRlU2VsZWN0aW9uOmZ1bmN0aW9uKHQpe3ZhciBlLG4scj10aGlzLnNlbGVjdGlvbi5maW5kKCIuc2VsZWN0Mi1jaG9zZW4iKTt0aGlzLnNlbGVjdGlvbi5kYXRhKCJzZWxlY3QyLWRhdGEiLHQpLHIuZW1wdHkoKSxudWxsIT09dCYmKGU9dGhpcy5vcHRzLmZvcm1hdFNlbGVjdGlvbih0LHIsdGhpcy5vcHRzLmVzY2FwZU1hcmt1cCkpLGUhPT1pJiZyLmFwcGVuZChlKSxuPXRoaXMub3B0cy5mb3JtYXRTZWxlY3Rpb25Dc3NDbGFzcyh0LHIpLG4hPT1pJiZyLmFkZENsYXNzKG4pLHRoaXMuc2VsZWN0aW9uLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWRlZmF1bHQiKSx0aGlzLm9wdHMuYWxsb3dDbGVhciYmdGhpcy5nZXRQbGFjZWhvbGRlcigpIT09aSYmdGhpcy5jb250YWluZXIuYWRkQ2xhc3MoInNlbGVjdDItYWxsb3djbGVhciIpfSx2YWw6ZnVuY3Rpb24oKXt2YXIgdCxlPSExLG49bnVsbCxyPXRoaXMscz10aGlzLmRhdGEoKTtpZigwPT09YXJndW1lbnRzLmxlbmd0aClyZXR1cm4gdGhpcy5vcHRzLmVsZW1lbnQudmFsKCk7aWYodD1hcmd1bWVudHNbMF0sYXJndW1lbnRzLmxlbmd0aD4xJiYoZT1hcmd1bWVudHNbMV0pLHRoaXMuc2VsZWN0KXRoaXMuc2VsZWN0LnZhbCh0KS5maW5kKCJvcHRpb24iKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWxlY3RlZH0pLmVhY2gyKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIG49ci5vcHRpb25Ub0RhdGEoZSksITF9KSx0aGlzLnVwZGF0ZVNlbGVjdGlvbihuKSx0aGlzLnNldFBsYWNlaG9sZGVyKCksZSYmdGhpcy50cmlnZ2VyQ2hhbmdlKHthZGRlZDpuLHJlbW92ZWQ6c30pO2Vsc2V7aWYoIXQmJjAhPT10KXJldHVybiB2b2lkIHRoaXMuY2xlYXIoZSk7aWYodGhpcy5vcHRzLmluaXRTZWxlY3Rpb249PT1pKXRocm93IG5ldyBFcnJvcigiY2Fubm90IGNhbGwgdmFsKCkgaWYgaW5pdFNlbGVjdGlvbigpIGlzIG5vdCBkZWZpbmVkIik7dGhpcy5vcHRzLmVsZW1lbnQudmFsKHQpLHRoaXMub3B0cy5pbml0U2VsZWN0aW9uKHRoaXMub3B0cy5lbGVtZW50LGZ1bmN0aW9uKHQpe3Iub3B0cy5lbGVtZW50LnZhbCh0P3IuaWQodCk6IiIpLHIudXBkYXRlU2VsZWN0aW9uKHQpLHIuc2V0UGxhY2Vob2xkZXIoKSxlJiZyLnRyaWdnZXJDaGFuZ2Uoe2FkZGVkOnQscmVtb3ZlZDpzfSl9KX19LGNsZWFyU2VhcmNoOmZ1bmN0aW9uKCl7dGhpcy5zZWFyY2gudmFsKCIiKSx0aGlzLmZvY3Vzc2VyLnZhbCgiIil9LGRhdGE6ZnVuY3Rpb24odCl7dmFyIGUsbj0hMTtyZXR1cm4gMD09PWFyZ3VtZW50cy5sZW5ndGg/KGU9dGhpcy5zZWxlY3Rpb24uZGF0YSgic2VsZWN0Mi1kYXRhIiksZT09aSYmKGU9bnVsbCksZSk6KGFyZ3VtZW50cy5sZW5ndGg+MSYmKG49YXJndW1lbnRzWzFdKSwKCXZvaWQodD8oZT10aGlzLmRhdGEoKSx0aGlzLm9wdHMuZWxlbWVudC52YWwodD90aGlzLmlkKHQpOiIiKSx0aGlzLnVwZGF0ZVNlbGVjdGlvbih0KSxuJiZ0aGlzLnRyaWdnZXJDaGFuZ2Uoe2FkZGVkOnQscmVtb3ZlZDplfSkpOnRoaXMuY2xlYXIobikpKX19KSxOPVkoQSx7Y3JlYXRlQ29udGFpbmVyOmZ1bmN0aW9uKCl7dmFyIGU9dChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSkuYXR0cih7ImNsYXNzIjoic2VsZWN0Mi1jb250YWluZXIgc2VsZWN0Mi1jb250YWluZXItbXVsdGkifSkuaHRtbChbIjx1bCBjbGFzcz0nc2VsZWN0Mi1jaG9pY2VzJz4iLCIgIDxsaSBjbGFzcz0nc2VsZWN0Mi1zZWFyY2gtZmllbGQnPiIsIiAgICA8bGFiZWwgZm9yPScnIGNsYXNzPSdzZWxlY3QyLW9mZnNjcmVlbic+PC9sYWJlbD4iLCIgICAgPGlucHV0IHR5cGU9J3RleHQnIGF1dG9jb21wbGV0ZT0nb2ZmJyBhdXRvY29ycmVjdD0nb2ZmJyBhdXRvY2FwaXRhbGl6ZT0nb2ZmJyBzcGVsbGNoZWNrPSdmYWxzZScgY2xhc3M9J3NlbGVjdDItaW5wdXQnPiIsIiAgPC9saT4iLCI8L3VsPiIsIjxkaXYgY2xhc3M9J3NlbGVjdDItZHJvcCBzZWxlY3QyLWRyb3AtbXVsdGkgc2VsZWN0Mi1kaXNwbGF5LW5vbmUnPiIsIiAgIDx1bCBjbGFzcz0nc2VsZWN0Mi1yZXN1bHRzJz4iLCIgICA8L3VsPiIsIjwvZGl2PiJdLmpvaW4oIiIpKTtyZXR1cm4gZX0scHJlcGFyZU9wdHM6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnBhcmVudC5wcmVwYXJlT3B0cy5hcHBseSh0aGlzLGFyZ3VtZW50cyksaT10aGlzO3JldHVybiJzZWxlY3QiPT09ZS5lbGVtZW50LmdldCgwKS50YWdOYW1lLnRvTG93ZXJDYXNlKCk/ZS5pbml0U2VsZWN0aW9uPWZ1bmN0aW9uKHQsZSl7dmFyIG49W107dC5maW5kKCJvcHRpb24iKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWxlY3RlZCYmIXRoaXMuZGlzYWJsZWR9KS5lYWNoMihmdW5jdGlvbih0LGUpe24ucHVzaChpLm9wdGlvblRvRGF0YShlKSl9KSxlKG4pfToiZGF0YSJpbiBlJiYoZS5pbml0U2VsZWN0aW9uPWUuaW5pdFNlbGVjdGlvbnx8ZnVuY3Rpb24oaSxuKXt2YXIgcj1sKGkudmFsKCksZS5zZXBhcmF0b3IpLHM9W107ZS5xdWVyeSh7bWF0Y2hlcjpmdW5jdGlvbihpLG4sbyl7dmFyIGw9dC5ncmVwKHIsZnVuY3Rpb24odCl7cmV0dXJuIGEodCxlLmlkKG8pKX0pLmxlbmd0aDtyZXR1cm4gbCYmcy5wdXNoKG8pLGx9LGNhbGxiYWNrOnQuaXNGdW5jdGlvbihuKT9mdW5jdGlvbigpe2Zvcih2YXIgdD1bXSxpPTA7aTxyLmxlbmd0aDtpKyspZm9yKHZhciBvPXJbaV0sbD0wO2w8cy5sZW5ndGg7bCsrKXt2YXIgYz1zW2xdO2lmKGEobyxlLmlkKGMpKSl7dC5wdXNoKGMpLHMuc3BsaWNlKGwsMSk7YnJlYWt9fW4odCl9OnQubm9vcH0pfSksZX0sc2VsZWN0Q2hvaWNlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuY29udGFpbmVyLmZpbmQoIi5zZWxlY3QyLXNlYXJjaC1jaG9pY2UtZm9jdXMiKTtlLmxlbmd0aCYmdCYmdFswXT09ZVswXXx8KGUubGVuZ3RoJiZ0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKCJjaG9pY2UtZGVzZWxlY3RlZCIsZSksZS5yZW1vdmVDbGFzcygic2VsZWN0Mi1zZWFyY2gtY2hvaWNlLWZvY3VzIiksdCYmdC5sZW5ndGgmJih0aGlzLmNsb3NlKCksdC5hZGRDbGFzcygic2VsZWN0Mi1zZWFyY2gtY2hvaWNlLWZvY3VzIiksdGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcigiY2hvaWNlLXNlbGVjdGVkIix0KSkpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dCgibGFiZWxbZm9yPSciK3RoaXMuc2VhcmNoLmF0dHIoImlkIikrIiddIikuYXR0cigiZm9yIix0aGlzLm9wdHMuZWxlbWVudC5hdHRyKCJpZCIpKSx0aGlzLnBhcmVudC5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKSxELmNhbGwodGhpcywic2VhcmNoQ29udGFpbmVyIiwic2VsZWN0aW9uIil9LGluaXRDb250YWluZXI6ZnVuY3Rpb24oKXt2YXIgZSxpPSIuc2VsZWN0Mi1jaG9pY2VzIjt0aGlzLnNlYXJjaENvbnRhaW5lcj10aGlzLmNvbnRhaW5lci5maW5kKCIuc2VsZWN0Mi1zZWFyY2gtZmllbGQiKSx0aGlzLnNlbGVjdGlvbj1lPXRoaXMuY29udGFpbmVyLmZpbmQoaSk7dmFyIG49dGhpczt0aGlzLnNlbGVjdGlvbi5vbigiY2xpY2siLCIuc2VsZWN0Mi1jb250YWluZXI6bm90KC5zZWxlY3QyLWNvbnRhaW5lci1kaXNhYmxlZCkgLnNlbGVjdDItc2VhcmNoLWNob2ljZTpub3QoLnNlbGVjdDItbG9ja2VkKSIsZnVuY3Rpb24oZSl7bi5zZWFyY2hbMF0uZm9jdXMoKSxuLnNlbGVjdENob2ljZSh0KHRoaXMpKX0pLHRoaXMuc2VhcmNoLmF0dHIoImlkIiwiczJpZF9hdXRvZ2VuIitJKCkpLHRoaXMuc2VhcmNoLnByZXYoKS50ZXh0KHQoImxhYmVsW2Zvcj0nIit0aGlzLm9wdHMuZWxlbWVudC5hdHRyKCJpZCIpKyInXSIpLnRleHQoKSkuYXR0cigiZm9yIix0aGlzLnNlYXJjaC5hdHRyKCJpZCIpKSx0aGlzLnNlYXJjaC5vbigiaW5wdXQgcGFzdGUiLHRoaXMuYmluZChmdW5jdGlvbigpe3RoaXMuc2VhcmNoLmF0dHIoInBsYWNlaG9sZGVyIikmJjA9PXRoaXMuc2VhcmNoLnZhbCgpLmxlbmd0aHx8dGhpcy5pc0ludGVyZmFjZUVuYWJsZWQoKSYmKHRoaXMub3BlbmVkKCl8fHRoaXMub3BlbigpKX0pKSx0aGlzLnNlYXJjaC5hdHRyKCJ0YWJpbmRleCIsdGhpcy5lbGVtZW50VGFiSW5kZXgpLHRoaXMua2V5ZG93bnM9MCx0aGlzLnNlYXJjaC5vbigia2V5ZG93biIsdGhpcy5iaW5kKGZ1bmN0aW9uKHQpe2lmKHRoaXMuaXNJbnRlcmZhY2VFbmFibGVkKCkpeysrdGhpcy5rZXlkb3duczt2YXIgaT1lLmZpbmQoIi5zZWxlY3QyLXNlYXJjaC1jaG9pY2UtZm9jdXMiKSxuPWkucHJldigiLnNlbGVjdDItc2VhcmNoLWNob2ljZTpub3QoLnNlbGVjdDItbG9ja2VkKSIpLHI9aS5uZXh0KCIuc2VsZWN0Mi1zZWFyY2gtY2hvaWNlOm5vdCguc2VsZWN0Mi1sb2NrZWQpIikscz1tKHRoaXMuc2VhcmNoKTtpZihpLmxlbmd0aCYmKHQud2hpY2g9PUMuTEVGVHx8dC53aGljaD09Qy5SSUdIVHx8dC53aGljaD09Qy5CQUNLU1BBQ0V8fHQud2hpY2g9PUMuREVMRVRFfHx0LndoaWNoPT1DLkVOVEVSKSl7dmFyIG89aTtyZXR1cm4gdC53aGljaD09Qy5MRUZUJiZuLmxlbmd0aD9vPW46dC53aGljaD09Qy5SSUdIVD9vPXIubGVuZ3RoP3I6bnVsbDp0LndoaWNoPT09Qy5CQUNLU1BBQ0U/dGhpcy51bnNlbGVjdChpLmZpcnN0KCkpJiYodGhpcy5zZWFyY2gud2lkdGgoMTApLG89bi5sZW5ndGg/bjpyKTp0LndoaWNoPT1DLkRFTEVURT90aGlzLnVuc2VsZWN0KGkuZmlyc3QoKSkmJih0aGlzLnNlYXJjaC53aWR0aCgxMCksbz1yLmxlbmd0aD9yOm51bGwpOnQud2hpY2g9PUMuRU5URVImJihvPW51bGwpLHRoaXMuc2VsZWN0Q2hvaWNlKG8pLF8odCksdm9pZChvJiZvLmxlbmd0aHx8dGhpcy5vcGVuKCkpfWlmKCh0LndoaWNoPT09Qy5CQUNLU1BBQ0UmJjE9PXRoaXMua2V5ZG93bnN8fHQud2hpY2g9PUMuTEVGVCkmJjA9PXMub2Zmc2V0JiYhcy5sZW5ndGgpcmV0dXJuIHRoaXMuc2VsZWN0Q2hvaWNlKGUuZmluZCgiLnNlbGVjdDItc2VhcmNoLWNob2ljZTpub3QoLnNlbGVjdDItbG9ja2VkKSIpLmxhc3QoKSksdm9pZCBfKHQpO2lmKHRoaXMuc2VsZWN0Q2hvaWNlKG51bGwpLHRoaXMub3BlbmVkKCkpc3dpdGNoKHQud2hpY2gpe2Nhc2UgQy5VUDpjYXNlIEMuRE9XTjpyZXR1cm4gdGhpcy5tb3ZlSGlnaGxpZ2h0KHQud2hpY2g9PT1DLlVQPy0xOjEpLHZvaWQgXyh0KTtjYXNlIEMuRU5URVI6cmV0dXJuIHRoaXMuc2VsZWN0SGlnaGxpZ2h0ZWQoKSx2b2lkIF8odCk7Y2FzZSBDLlRBQjpyZXR1cm4gdGhpcy5zZWxlY3RIaWdobGlnaHRlZCh7bm9Gb2N1czohMH0pLHZvaWQgdGhpcy5jbG9zZSgpO2Nhc2UgQy5FU0M6cmV0dXJuIHRoaXMuY2FuY2VsKHQpLHZvaWQgXyh0KX1pZih0LndoaWNoIT09Qy5UQUImJiFDLmlzQ29udHJvbCh0KSYmIUMuaXNGdW5jdGlvbktleSh0KSYmdC53aGljaCE9PUMuQkFDS1NQQUNFJiZ0LndoaWNoIT09Qy5FU0Mpe2lmKHQud2hpY2g9PT1DLkVOVEVSKXtpZih0aGlzLm9wdHMub3Blbk9uRW50ZXI9PT0hMSlyZXR1cm47aWYodC5hbHRLZXl8fHQuY3RybEtleXx8dC5zaGlmdEtleXx8dC5tZXRhS2V5KXJldHVybn10aGlzLm9wZW4oKSx0LndoaWNoIT09Qy5QQUdFX1VQJiZ0LndoaWNoIT09Qy5QQUdFX0RPV058fF8odCksdC53aGljaD09PUMuRU5URVImJl8odCl9fX0pKSx0aGlzLnNlYXJjaC5vbigia2V5dXAiLHRoaXMuYmluZChmdW5jdGlvbih0KXt0aGlzLmtleWRvd25zPTAsdGhpcy5yZXNpemVTZWFyY2goKX0pKSx0aGlzLnNlYXJjaC5vbigiYmx1ciIsdGhpcy5iaW5kKGZ1bmN0aW9uKGUpe3RoaXMuY29udGFpbmVyLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWNvbnRhaW5lci1hY3RpdmUiKSx0aGlzLnNlYXJjaC5yZW1vdmVDbGFzcygic2VsZWN0Mi1mb2N1c2VkIiksdGhpcy5zZWxlY3RDaG9pY2UobnVsbCksdGhpcy5vcGVuZWQoKXx8dGhpcy5jbGVhclNlYXJjaCgpLGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcih0LkV2ZW50KCJzZWxlY3QyLWJsdXIiKSl9KSksdGhpcy5jb250YWluZXIub24oImNsaWNrIixpLHRoaXMuYmluZChmdW5jdGlvbihlKXt0aGlzLmlzSW50ZXJmYWNlRW5hYmxlZCgpJiYodChlLnRhcmdldCkuY2xvc2VzdCgiLnNlbGVjdDItc2VhcmNoLWNob2ljZSIpLmxlbmd0aD4wfHwodGhpcy5zZWxlY3RDaG9pY2UobnVsbCksdGhpcy5jbGVhclBsYWNlaG9sZGVyKCksdGhpcy5jb250YWluZXIuaGFzQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpfHx0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKHQuRXZlbnQoInNlbGVjdDItZm9jdXMiKSksdGhpcy5vcGVuKCksdGhpcy5mb2N1c1NlYXJjaCgpLGUucHJldmVudERlZmF1bHQoKSkpfSkpLHRoaXMuY29udGFpbmVyLm9uKCJmb2N1cyIsaSx0aGlzLmJpbmQoZnVuY3Rpb24oKXt0aGlzLmlzSW50ZXJmYWNlRW5hYmxlZCgpJiYodGhpcy5jb250YWluZXIuaGFzQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpfHx0aGlzLm9wdHMuZWxlbWVudC50cmlnZ2VyKHQuRXZlbnQoInNlbGVjdDItZm9jdXMiKSksdGhpcy5jb250YWluZXIuYWRkQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpLHRoaXMuZHJvcGRvd24uYWRkQ2xhc3MoInNlbGVjdDItZHJvcC1hY3RpdmUiKSx0aGlzLmNsZWFyUGxhY2Vob2xkZXIoKSl9KSksdGhpcy5pbml0Q29udGFpbmVyV2lkdGgoKSx0aGlzLm9wdHMuZWxlbWVudC5hZGRDbGFzcygic2VsZWN0Mi1vZmZzY3JlZW4iKSx0aGlzLmNsZWFyU2VhcmNoKCl9LGVuYWJsZUludGVyZmFjZTpmdW5jdGlvbigpe3RoaXMucGFyZW50LmVuYWJsZUludGVyZmFjZS5hcHBseSh0aGlzLGFyZ3VtZW50cykmJnRoaXMuc2VhcmNoLnByb3AoImRpc2FibGVkIiwhdGhpcy5pc0ludGVyZmFjZUVuYWJsZWQoKSl9LGluaXRTZWxlY3Rpb246ZnVuY3Rpb24oKXtpZigiIj09PXRoaXMub3B0cy5lbGVtZW50LnZhbCgpJiYiIj09PXRoaXMub3B0cy5lbGVtZW50LnRleHQoKSYmKHRoaXMudXBkYXRlU2VsZWN0aW9uKFtdKSx0aGlzLmNsb3NlKCksdGhpcy5jbGVhclNlYXJjaCgpKSx0aGlzLnNlbGVjdHx8IiIhPT10aGlzLm9wdHMuZWxlbWVudC52YWwoKSl7dmFyIHQ9dGhpczt0aGlzLm9wdHMuaW5pdFNlbGVjdGlvbi5jYWxsKG51bGwsdGhpcy5vcHRzLmVsZW1lbnQsZnVuY3Rpb24oZSl7ZSE9PWkmJm51bGwhPT1lJiYodC51cGRhdGVTZWxlY3Rpb24oZSksdC5jbG9zZSgpLHQuY2xlYXJTZWFyY2goKSl9KX19LGNsZWFyU2VhcmNoOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRQbGFjZWhvbGRlcigpLGU9dGhpcy5nZXRNYXhTZWFyY2hXaWR0aCgpO3QhPT1pJiYwPT09dGhpcy5nZXRWYWwoKS5sZW5ndGgmJnRoaXMuc2VhcmNoLmhhc0NsYXNzKCJzZWxlY3QyLWZvY3VzZWQiKT09PSExPyh0aGlzLnNlYXJjaC52YWwodCkuYWRkQ2xhc3MoInNlbGVjdDItZGVmYXVsdCIpLHRoaXMuc2VhcmNoLndpZHRoKGU+MD9lOnRoaXMuY29udGFpbmVyLmNzcygid2lkdGgiKSkpOnRoaXMuc2VhcmNoLnZhbCgiIikud2lkdGgoMTApfSxjbGVhclBsYWNlaG9sZGVyOmZ1bmN0aW9uKCl7dGhpcy5zZWFyY2guaGFzQ2xhc3MoInNlbGVjdDItZGVmYXVsdCIpJiZ0aGlzLnNlYXJjaC52YWwoIiIpLnJlbW92ZUNsYXNzKCJzZWxlY3QyLWRlZmF1bHQiKX0sb3BlbmluZzpmdW5jdGlvbigpe3RoaXMuY2xlYXJQbGFjZWhvbGRlcigpLHRoaXMucmVzaXplU2VhcmNoKCksdGhpcy5wYXJlbnQub3BlbmluZy5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5mb2N1c1NlYXJjaCgpLCIiPT09dGhpcy5zZWFyY2gudmFsKCkmJnRoaXMubmV4dFNlYXJjaFRlcm0hPWkmJih0aGlzLnNlYXJjaC52YWwodGhpcy5uZXh0U2VhcmNoVGVybSksdGhpcy5zZWFyY2guc2VsZWN0KCkpLHRoaXMudXBkYXRlUmVzdWx0cyghMCksdGhpcy5vcHRzLnNob3VsZEZvY3VzSW5wdXQodGhpcykmJnRoaXMuc2VhcmNoLmZvY3VzKCksdGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcih0LkV2ZW50KCJzZWxlY3QyLW9wZW4iKSl9LGNsb3NlOmZ1bmN0aW9uKCl7dGhpcy5vcGVuZWQoKSYmdGhpcy5wYXJlbnQuY2xvc2UuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxmb2N1czpmdW5jdGlvbigpe3RoaXMuY2xvc2UoKSx0aGlzLnNlYXJjaC5mb2N1cygpfSxpc0ZvY3VzZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWFyY2guaGFzQ2xhc3MoInNlbGVjdDItZm9jdXNlZCIpfSx1cGRhdGVTZWxlY3Rpb246ZnVuY3Rpb24oZSl7dmFyIGk9W10sbj1bXSxyPXRoaXM7dChlKS5lYWNoKGZ1bmN0aW9uKCl7cyhyLmlkKHRoaXMpLGkpPDAmJihpLnB1c2goci5pZCh0aGlzKSksbi5wdXNoKHRoaXMpKX0pLGU9bix0aGlzLnNlbGVjdGlvbi5maW5kKCIuc2VsZWN0Mi1zZWFyY2gtY2hvaWNlIikucmVtb3ZlKCksdChlKS5lYWNoKGZ1bmN0aW9uKCl7ci5hZGRTZWxlY3RlZENob2ljZSh0aGlzKX0pLHIucG9zdHByb2Nlc3NSZXN1bHRzKCl9LHRva2VuaXplOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5zZWFyY2gudmFsKCk7dD10aGlzLm9wdHMudG9rZW5pemVyLmNhbGwodGhpcyx0LHRoaXMuZGF0YSgpLHRoaXMuYmluZCh0aGlzLm9uU2VsZWN0KSx0aGlzLm9wdHMpLG51bGwhPXQmJnQhPWkmJih0aGlzLnNlYXJjaC52YWwodCksdC5sZW5ndGg+MCYmdGhpcy5vcGVuKCkpfSxvblNlbGVjdDpmdW5jdGlvbih0LGUpe3RoaXMudHJpZ2dlclNlbGVjdCh0KSYmIiIhPT10LnRleHQmJih0aGlzLmFkZFNlbGVjdGVkQ2hvaWNlKHQpLHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIoe3R5cGU6InNlbGVjdGVkIix2YWw6dGhpcy5pZCh0KSxjaG9pY2U6dH0pLHRoaXMubmV4dFNlYXJjaFRlcm09dGhpcy5vcHRzLm5leHRTZWFyY2hUZXJtKHQsdGhpcy5zZWFyY2gudmFsKCkpLHRoaXMuY2xlYXJTZWFyY2goKSx0aGlzLnVwZGF0ZVJlc3VsdHMoKSwhdGhpcy5zZWxlY3QmJnRoaXMub3B0cy5jbG9zZU9uU2VsZWN0fHx0aGlzLnBvc3Rwcm9jZXNzUmVzdWx0cyh0LCExLHRoaXMub3B0cy5jbG9zZU9uU2VsZWN0PT09ITApLHRoaXMub3B0cy5jbG9zZU9uU2VsZWN0Pyh0aGlzLmNsb3NlKCksdGhpcy5zZWFyY2gud2lkdGgoMTApKTp0aGlzLmNvdW50U2VsZWN0YWJsZVJlc3VsdHMoKT4wPyh0aGlzLnNlYXJjaC53aWR0aCgxMCksdGhpcy5yZXNpemVTZWFyY2goKSx0aGlzLmdldE1heGltdW1TZWxlY3Rpb25TaXplKCk+MCYmdGhpcy52YWwoKS5sZW5ndGg+PXRoaXMuZ2V0TWF4aW11bVNlbGVjdGlvblNpemUoKT90aGlzLnVwZGF0ZVJlc3VsdHMoITApOnRoaXMubmV4dFNlYXJjaFRlcm0hPWkmJih0aGlzLnNlYXJjaC52YWwodGhpcy5uZXh0U2VhcmNoVGVybSksdGhpcy51cGRhdGVSZXN1bHRzKCksdGhpcy5zZWFyY2guc2VsZWN0KCkpLHRoaXMucG9zaXRpb25Ecm9wZG93bigpKToodGhpcy5jbG9zZSgpLHRoaXMuc2VhcmNoLndpZHRoKDEwKSksdGhpcy50cmlnZ2VyQ2hhbmdlKHthZGRlZDp0fSksZSYmZS5ub0ZvY3VzfHx0aGlzLmZvY3VzU2VhcmNoKCkpfSxjYW5jZWw6ZnVuY3Rpb24oKXt0aGlzLmNsb3NlKCksdGhpcy5mb2N1c1NlYXJjaCgpfSxhZGRTZWxlY3RlZENob2ljZTpmdW5jdGlvbihlKXt2YXIgbixyLHM9IWUubG9ja2VkLG89dCgiPGxpIGNsYXNzPSdzZWxlY3QyLXNlYXJjaC1jaG9pY2UnPiAgICA8ZGl2PjwvZGl2PiAgICA8YSBocmVmPScjJyBjbGFzcz0nc2VsZWN0Mi1zZWFyY2gtY2hvaWNlLWNsb3NlJyB0YWJpbmRleD0nLTEnPjwvYT48L2xpPiIpLGE9dCgiPGxpIGNsYXNzPSdzZWxlY3QyLXNlYXJjaC1jaG9pY2Ugc2VsZWN0Mi1sb2NrZWQnPjxkaXY+PC9kaXY+PC9saT4iKSxsPXM/bzphLGM9dGhpcy5pZChlKSx1PXRoaXMuZ2V0VmFsKCk7bj10aGlzLm9wdHMuZm9ybWF0U2VsZWN0aW9uKGUsbC5maW5kKCJkaXYiKSx0aGlzLm9wdHMuZXNjYXBlTWFya3VwKSxuIT1pJiZsLmZpbmQoImRpdiIpLnJlcGxhY2VXaXRoKCI8ZGl2PiIrbisiPC9kaXY+Iikscj10aGlzLm9wdHMuZm9ybWF0U2VsZWN0aW9uQ3NzQ2xhc3MoZSxsLmZpbmQoImRpdiIpKSxyIT1pJiZsLmFkZENsYXNzKHIpLHMmJmwuZmluZCgiLnNlbGVjdDItc2VhcmNoLWNob2ljZS1jbG9zZSIpLm9uKCJtb3VzZWRvd24iLF8pLm9uKCJjbGljayBkYmxjbGljayIsdGhpcy5iaW5kKGZ1bmN0aW9uKGUpe3RoaXMuaXNJbnRlcmZhY2VFbmFibGVkKCkmJih0aGlzLnVuc2VsZWN0KHQoZS50YXJnZXQpKSx0aGlzLnNlbGVjdGlvbi5maW5kKCIuc2VsZWN0Mi1zZWFyY2gtY2hvaWNlLWZvY3VzIikucmVtb3ZlQ2xhc3MoInNlbGVjdDItc2VhcmNoLWNob2ljZS1mb2N1cyIpLF8oZSksdGhpcy5jbG9zZSgpLHRoaXMuZm9jdXNTZWFyY2goKSl9KSkub24oImZvY3VzIix0aGlzLmJpbmQoZnVuY3Rpb24oKXt0aGlzLmlzSW50ZXJmYWNlRW5hYmxlZCgpJiYodGhpcy5jb250YWluZXIuYWRkQ2xhc3MoInNlbGVjdDItY29udGFpbmVyLWFjdGl2ZSIpLHRoaXMuZHJvcGRvd24uYWRkQ2xhc3MoInNlbGVjdDItZHJvcC1hY3RpdmUiKSl9KSksbC5kYXRhKCJzZWxlY3QyLWRhdGEiLGUpLGwuaW5zZXJ0QmVmb3JlKHRoaXMuc2VhcmNoQ29udGFpbmVyKSx1LnB1c2goYyksdGhpcy5zZXRWYWwodSl9LHVuc2VsZWN0OmZ1bmN0aW9uKGUpe3ZhciBpLG4scj10aGlzLmdldFZhbCgpO2lmKGU9ZS5jbG9zZXN0KCIuc2VsZWN0Mi1zZWFyY2gtY2hvaWNlIiksMD09PWUubGVuZ3RoKXRocm93IkludmFsaWQgYXJndW1lbnQ6ICIrZSsiLiBNdXN0IA==", "base64"));
  res.write(new Buffer("YmUgLnNlbGVjdDItc2VhcmNoLWNob2ljZSI7aWYoaT1lLmRhdGEoInNlbGVjdDItZGF0YSIpKXt2YXIgbz10LkV2ZW50KCJzZWxlY3QyLXJlbW92aW5nIik7aWYoby52YWw9dGhpcy5pZChpKSxvLmNob2ljZT1pLHRoaXMub3B0cy5lbGVtZW50LnRyaWdnZXIobyksby5pc0RlZmF1bHRQcmV2ZW50ZWQoKSlyZXR1cm4hMTtmb3IoOyhuPXModGhpcy5pZChpKSxyKSk+PTA7KXIuc3BsaWNlKG4sMSksdGhpcy5zZXRWYWwociksdGhpcy5zZWxlY3QmJnRoaXMucG9zdHByb2Nlc3NSZXN1bHRzKCk7cmV0dXJuIGUucmVtb3ZlKCksdGhpcy5vcHRzLmVsZW1lbnQudHJpZ2dlcih7dHlwZToic2VsZWN0Mi1yZW1vdmVkIix2YWw6dGhpcy5pZChpKSxjaG9pY2U6aX0pLHRoaXMudHJpZ2dlckNoYW5nZSh7cmVtb3ZlZDppfSksITB9fSxwb3N0cHJvY2Vzc1Jlc3VsdHM6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXRoaXMuZ2V0VmFsKCkscj10aGlzLnJlc3VsdHMuZmluZCgiLnNlbGVjdDItcmVzdWx0Iiksbz10aGlzLnJlc3VsdHMuZmluZCgiLnNlbGVjdDItcmVzdWx0LXdpdGgtY2hpbGRyZW4iKSxhPXRoaXM7ci5lYWNoMihmdW5jdGlvbih0LGUpe3ZhciBpPWEuaWQoZS5kYXRhKCJzZWxlY3QyLWRhdGEiKSk7cyhpLG4pPj0wJiYoZS5hZGRDbGFzcygic2VsZWN0Mi1zZWxlY3RlZCIpLGUuZmluZCgiLnNlbGVjdDItcmVzdWx0LXNlbGVjdGFibGUiKS5hZGRDbGFzcygic2VsZWN0Mi1zZWxlY3RlZCIpKX0pLG8uZWFjaDIoZnVuY3Rpb24odCxlKXtlLmlzKCIuc2VsZWN0Mi1yZXN1bHQtc2VsZWN0YWJsZSIpfHwwIT09ZS5maW5kKCIuc2VsZWN0Mi1yZXN1bHQtc2VsZWN0YWJsZTpub3QoLnNlbGVjdDItc2VsZWN0ZWQpIikubGVuZ3RofHxlLmFkZENsYXNzKCJzZWxlY3QyLXNlbGVjdGVkIil9KSx0aGlzLmhpZ2hsaWdodCgpPT0tMSYmaSE9PSExJiZhLmhpZ2hsaWdodCgwKSwhdGhpcy5vcHRzLmNyZWF0ZVNlYXJjaENob2ljZSYmIXIuZmlsdGVyKCIuc2VsZWN0Mi1yZXN1bHQ6bm90KC5zZWxlY3QyLXNlbGVjdGVkKSIpLmxlbmd0aD4wJiYoIXR8fHQmJiF0Lm1vcmUmJjA9PT10aGlzLnJlc3VsdHMuZmluZCgiLnNlbGVjdDItbm8tcmVzdWx0cyIpLmxlbmd0aCkmJlMoYS5vcHRzLmZvcm1hdE5vTWF0Y2hlcywiZm9ybWF0Tm9NYXRjaGVzIikmJnRoaXMucmVzdWx0cy5hcHBlbmQoIjxsaSBjbGFzcz0nc2VsZWN0Mi1uby1yZXN1bHRzJz4iK0woYS5vcHRzLmZvcm1hdE5vTWF0Y2hlcyxhLm9wdHMuZWxlbWVudCxhLnNlYXJjaC52YWwoKSkrIjwvbGk+Iil9LGdldE1heFNlYXJjaFdpZHRoOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VsZWN0aW9uLndpZHRoKCktYyh0aGlzLnNlYXJjaCl9LHJlc2l6ZVNlYXJjaDpmdW5jdGlvbigpe3ZhciB0LGUsaSxuLHIscz1jKHRoaXMuc2VhcmNoKTt0PXYodGhpcy5zZWFyY2gpKzEwLGU9dGhpcy5zZWFyY2gub2Zmc2V0KCkubGVmdCxpPXRoaXMuc2VsZWN0aW9uLndpZHRoKCksbj10aGlzLnNlbGVjdGlvbi5vZmZzZXQoKS5sZWZ0LHI9aS0oZS1uKS1zLHI8dCYmKHI9aS1zKSxyPDQwJiYocj1pLXMpLHI8PTAmJihyPXQpLHRoaXMuc2VhcmNoLndpZHRoKE1hdGguZmxvb3IocikpfSxnZXRWYWw6ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdGhpcy5zZWxlY3Q/KHQ9dGhpcy5zZWxlY3QudmFsKCksbnVsbD09PXQ/W106dCk6KHQ9dGhpcy5vcHRzLmVsZW1lbnQudmFsKCksbCh0LHRoaXMub3B0cy5zZXBhcmF0b3IpKX0sc2V0VmFsOmZ1bmN0aW9uKGUpe3ZhciBpO3RoaXMuc2VsZWN0P3RoaXMuc2VsZWN0LnZhbChlKTooaT1bXSx0KGUpLmVhY2goZnVuY3Rpb24oKXtzKHRoaXMsaSk8MCYmaS5wdXNoKHRoaXMpfSksdGhpcy5vcHRzLmVsZW1lbnQudmFsKDA9PT1pLmxlbmd0aD8iIjppLmpvaW4odGhpcy5vcHRzLnNlcGFyYXRvcikpKX0sYnVpbGRDaGFuZ2VEZXRhaWxzOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBlPWUuc2xpY2UoMCksdD10LnNsaWNlKDApLGk9MDtpPGUubGVuZ3RoO2krKylmb3IodmFyIG49MDtuPHQubGVuZ3RoO24rKylhKHRoaXMub3B0cy5pZChlW2ldKSx0aGlzLm9wdHMuaWQodFtuXSkpJiYoZS5zcGxpY2UoaSwxKSxpPjAmJmktLSx0LnNwbGljZShuLDEpLG4tLSk7cmV0dXJue2FkZGVkOmUscmVtb3ZlZDp0fX0sdmFsOmZ1bmN0aW9uKGUsbil7dmFyIHIscz10aGlzO2lmKDA9PT1hcmd1bWVudHMubGVuZ3RoKXJldHVybiB0aGlzLmdldFZhbCgpO2lmKHI9dGhpcy5kYXRhKCksci5sZW5ndGh8fChyPVtdKSwhZSYmMCE9PWUpcmV0dXJuIHRoaXMub3B0cy5lbGVtZW50LnZhbCgiIiksdGhpcy51cGRhdGVTZWxlY3Rpb24oW10pLHRoaXMuY2xlYXJTZWFyY2goKSx2b2lkKG4mJnRoaXMudHJpZ2dlckNoYW5nZSh7YWRkZWQ6dGhpcy5kYXRhKCkscmVtb3ZlZDpyfSkpO2lmKHRoaXMuc2V0VmFsKGUpLHRoaXMuc2VsZWN0KXRoaXMub3B0cy5pbml0U2VsZWN0aW9uKHRoaXMuc2VsZWN0LHRoaXMuYmluZCh0aGlzLnVwZGF0ZVNlbGVjdGlvbikpLG4mJnRoaXMudHJpZ2dlckNoYW5nZSh0aGlzLmJ1aWxkQ2hhbmdlRGV0YWlscyhyLHRoaXMuZGF0YSgpKSk7ZWxzZXtpZih0aGlzLm9wdHMuaW5pdFNlbGVjdGlvbj09PWkpdGhyb3cgbmV3IEVycm9yKCJ2YWwoKSBjYW5ub3QgYmUgY2FsbGVkIGlmIGluaXRTZWxlY3Rpb24oKSBpcyBub3QgZGVmaW5lZCIpO3RoaXMub3B0cy5pbml0U2VsZWN0aW9uKHRoaXMub3B0cy5lbGVtZW50LGZ1bmN0aW9uKGUpe3ZhciBpPXQubWFwKGUscy5pZCk7cy5zZXRWYWwoaSkscy51cGRhdGVTZWxlY3Rpb24oZSkscy5jbGVhclNlYXJjaCgpLG4mJnMudHJpZ2dlckNoYW5nZShzLmJ1aWxkQ2hhbmdlRGV0YWlscyhyLHMuZGF0YSgpKSl9KX10aGlzLmNsZWFyU2VhcmNoKCl9LG9uU29ydFN0YXJ0OmZ1bmN0aW9uKCl7aWYodGhpcy5zZWxlY3QpdGhyb3cgbmV3IEVycm9yKCJTb3J0aW5nIG9mIGVsZW1lbnRzIGlzIG5vdCBzdXBwb3J0ZWQgd2hlbiBhdHRhY2hlZCB0byA8c2VsZWN0Pi4gQXR0YWNoIHRvIDxpbnB1dCB0eXBlPSdoaWRkZW4nLz4gaW5zdGVhZC4iKTt0aGlzLnNlYXJjaC53aWR0aCgwKSx0aGlzLnNlYXJjaENvbnRhaW5lci5oaWRlKCl9LG9uU29ydEVuZDpmdW5jdGlvbigpe3ZhciBlPVtdLGk9dGhpczt0aGlzLnNlYXJjaENvbnRhaW5lci5zaG93KCksdGhpcy5zZWFyY2hDb250YWluZXIuYXBwZW5kVG8odGhpcy5zZWFyY2hDb250YWluZXIucGFyZW50KCkpLHRoaXMucmVzaXplU2VhcmNoKCksdGhpcy5zZWxlY3Rpb24uZmluZCgiLnNlbGVjdDItc2VhcmNoLWNob2ljZSIpLmVhY2goZnVuY3Rpb24oKXtlLnB1c2goaS5vcHRzLmlkKHQodGhpcykuZGF0YSgic2VsZWN0Mi1kYXRhIikpKX0pLHRoaXMuc2V0VmFsKGUpLHRoaXMudHJpZ2dlckNoYW5nZSgpfSxkYXRhOmZ1bmN0aW9uKGUsaSl7dmFyIG4scixzPXRoaXM7cmV0dXJuIDA9PT1hcmd1bWVudHMubGVuZ3RoP3RoaXMuc2VsZWN0aW9uLmNoaWxkcmVuKCIuc2VsZWN0Mi1zZWFyY2gtY2hvaWNlIikubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIHQodGhpcykuZGF0YSgic2VsZWN0Mi1kYXRhIil9KS5nZXQoKToocj10aGlzLmRhdGEoKSxlfHwoZT1bXSksbj10Lm1hcChlLGZ1bmN0aW9uKHQpe3JldHVybiBzLm9wdHMuaWQodCl9KSx0aGlzLnNldFZhbChuKSx0aGlzLnVwZGF0ZVNlbGVjdGlvbihlKSx0aGlzLmNsZWFyU2VhcmNoKCksaSYmdGhpcy50cmlnZ2VyQ2hhbmdlKHRoaXMuYnVpbGRDaGFuZ2VEZXRhaWxzKHIsdGhpcy5kYXRhKCkpKSx2b2lkIDApfX0pLHQuZm4uc2VsZWN0Mj1mdW5jdGlvbigpe3ZhciBuLHIsbyxhLGwsYz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksdT1bInZhbCIsImRlc3Ryb3kiLCJvcGVuZWQiLCJvcGVuIiwiY2xvc2UiLCJmb2N1cyIsImlzRm9jdXNlZCIsImNvbnRhaW5lciIsImRyb3Bkb3duIiwib25Tb3J0U3RhcnQiLCJvblNvcnRFbmQiLCJlbmFibGUiLCJkaXNhYmxlIiwicmVhZG9ubHkiLCJwb3NpdGlvbkRyb3Bkb3duIiwiZGF0YSIsInNlYXJjaCJdLGQ9WyJvcGVuZWQiLCJpc0ZvY3VzZWQiLCJjb250YWluZXIiLCJkcm9wZG93biJdLGg9WyJ2YWwiLCJkYXRhIl0scD17c2VhcmNoOiJleHRlcm5hbFNlYXJjaCJ9O3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtpZigwPT09Yy5sZW5ndGh8fCJvYmplY3QiPT10eXBlb2YgY1swXSluPTA9PT1jLmxlbmd0aD97fTp0LmV4dGVuZCh7fSxjWzBdKSxuLmVsZW1lbnQ9dCh0aGlzKSwic2VsZWN0Ij09PW4uZWxlbWVudC5nZXQoMCkudGFnTmFtZS50b0xvd2VyQ2FzZSgpP2w9bi5lbGVtZW50LnByb3AoIm11bHRpcGxlIik6KGw9bi5tdWx0aXBsZXx8ITEsInRhZ3MiaW4gbiYmKG4ubXVsdGlwbGU9bD0hMCkpLHI9bD9uZXcgZVsiY2xhc3MiXS5tdWx0aTpuZXcgZVsiY2xhc3MiXS5zaW5nbGUsci5pbml0KG4pO2Vsc2V7aWYoInN0cmluZyIhPXR5cGVvZiBjWzBdKXRocm93IkludmFsaWQgYXJndW1lbnRzIHRvIHNlbGVjdDIgcGx1Z2luOiAiK2M7aWYocyhjWzBdLHUpPDApdGhyb3ciVW5rbm93biBtZXRob2Q6ICIrY1swXTtpZihhPWkscj10KHRoaXMpLmRhdGEoInNlbGVjdDIiKSxyPT09aSlyZXR1cm47aWYobz1jWzBdLCJjb250YWluZXIiPT09bz9hPXIuY29udGFpbmVyOiJkcm9wZG93biI9PT1vP2E9ci5kcm9wZG93bjoocFtvXSYmKG89cFtvXSksYT1yW29dLmFwcGx5KHIsYy5zbGljZSgxKSkpLHMoY1swXSxkKT49MHx8cyhjWzBdLGgpPj0wJiYxPT1jLmxlbmd0aClyZXR1cm4hMX19KSxhPT09aT90aGlzOmF9LHQuZm4uc2VsZWN0Mi5kZWZhdWx0cz17d2lkdGg6ImNvcHkiLGxvYWRNb3JlUGFkZGluZzowLGNsb3NlT25TZWxlY3Q6ITAsb3Blbk9uRW50ZXI6ITAsY29udGFpbmVyQ3NzOnt9LGRyb3Bkb3duQ3NzOnt9LGNvbnRhaW5lckNzc0NsYXNzOiIiLGRyb3Bkb3duQ3NzQ2xhc3M6IiIsZm9ybWF0UmVzdWx0OmZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPVtdO3JldHVybiBiKHRoaXMudGV4dCh0KSxpLnRlcm0scixuKSxyLmpvaW4oIiIpfSxmb3JtYXRTZWxlY3Rpb246ZnVuY3Rpb24odCxlLG4pe3JldHVybiB0P24odGhpcy50ZXh0KHQpKTppfSxzb3J0UmVzdWx0czpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHR9LGZvcm1hdFJlc3VsdENzc0NsYXNzOmZ1bmN0aW9uKHQpe3JldHVybiB0LmNzc30sZm9ybWF0U2VsZWN0aW9uQ3NzQ2xhc3M6ZnVuY3Rpb24odCxlKXtyZXR1cm4gaX0sbWluaW11bVJlc3VsdHNGb3JTZWFyY2g6MCxtaW5pbXVtSW5wdXRMZW5ndGg6MCxtYXhpbXVtSW5wdXRMZW5ndGg6bnVsbCxtYXhpbXVtU2VsZWN0aW9uU2l6ZTowLGlkOmZ1bmN0aW9uKHQpe3JldHVybiB0PT1pP251bGw6dC5pZH0sdGV4dDpmdW5jdGlvbihlKXtyZXR1cm4gZSYmdGhpcy5kYXRhJiZ0aGlzLmRhdGEudGV4dD90LmlzRnVuY3Rpb24odGhpcy5kYXRhLnRleHQpP3RoaXMuZGF0YS50ZXh0KGUpOmVbdGhpcy5kYXRhLnRleHRdOmUudGV4dH0sbWF0Y2hlcjpmdW5jdGlvbih0LGUpe3JldHVybiByKCIiK2UpLnRvVXBwZXJDYXNlKCkuaW5kZXhPZihyKCIiK3QpLnRvVXBwZXJDYXNlKCkpPj0wfSxzZXBhcmF0b3I6IiwiLHRva2VuU2VwYXJhdG9yczpbXSx0b2tlbml6ZXI6RSxlc2NhcGVNYXJrdXA6dyxibHVyT25DaGFuZ2U6ITEsc2VsZWN0T25CbHVyOiExLGFkYXB0Q29udGFpbmVyQ3NzQ2xhc3M6ZnVuY3Rpb24odCl7cmV0dXJuIHR9LGFkYXB0RHJvcGRvd25Dc3NDbGFzczpmdW5jdGlvbih0KXtyZXR1cm4gbnVsbH0sbmV4dFNlYXJjaFRlcm06ZnVuY3Rpb24odCxlKXtyZXR1cm4gaX0sc2VhcmNoSW5wdXRQbGFjZWhvbGRlcjoiIixjcmVhdGVTZWFyY2hDaG9pY2VQb3NpdGlvbjoidG9wIixzaG91bGRGb2N1c0lucHV0OmZ1bmN0aW9uKHQpe3ZhciBlPSJvbnRvdWNoc3RhcnQiaW4gd2luZG93fHxuYXZpZ2F0b3IubXNNYXhUb3VjaFBvaW50cz4wO3JldHVybiFlfHwhKHQub3B0cy5taW5pbXVtUmVzdWx0c0ZvclNlYXJjaDwwKX19LHQuZm4uc2VsZWN0Mi5sb2NhbGVzPVtdLHQuZm4uc2VsZWN0Mi5sb2NhbGVzLmVuPXtmb3JtYXRNYXRjaGVzOmZ1bmN0aW9uKHQpe3JldHVybiAxPT09dD8iT25lIHJlc3VsdCBpcyBhdmFpbGFibGUsIHByZXNzIGVudGVyIHRvIHNlbGVjdCBpdC4iOnQrIiByZXN1bHRzIGFyZSBhdmFpbGFibGUsIHVzZSB1cCBhbmQgZG93biBhcnJvdyBrZXlzIHRvIG5hdmlnYXRlLiJ9LGZvcm1hdE5vTWF0Y2hlczpmdW5jdGlvbigpe3JldHVybiJObyBtYXRjaGVzIGZvdW5kIn0sZm9ybWF0QWpheEVycm9yOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4iTG9hZGluZyBmYWlsZWQifSxmb3JtYXRJbnB1dFRvb1Nob3J0OmZ1bmN0aW9uKHQsZSl7dmFyIGk9ZS10Lmxlbmd0aDtyZXR1cm4iUGxlYXNlIGVudGVyICIraSsiIG9yIG1vcmUgY2hhcmFjdGVyIisoMT09aT8iIjoicyIpfSxmb3JtYXRJbnB1dFRvb0xvbmc6ZnVuY3Rpb24odCxlKXt2YXIgaT10Lmxlbmd0aC1lO3JldHVybiJQbGVhc2UgZGVsZXRlICIraSsiIGNoYXJhY3RlciIrKDE9PWk/IiI6InMiKX0sZm9ybWF0U2VsZWN0aW9uVG9vQmlnOmZ1bmN0aW9uKHQpe3JldHVybiJZb3UgY2FuIG9ubHkgc2VsZWN0ICIrdCsiIGl0ZW0iKygxPT10PyIiOiJzIil9LGZvcm1hdExvYWRNb3JlOmZ1bmN0aW9uKHQpe3JldHVybiJMb2FkaW5nIG1vcmUgcmVzdWx0c+KApiJ9LGZvcm1hdFNlYXJjaGluZzpmdW5jdGlvbigpe3JldHVybiJTZWFyY2hpbmfigKYifX0sdC5leHRlbmQodC5mbi5zZWxlY3QyLmRlZmF1bHRzLHQuZm4uc2VsZWN0Mi5sb2NhbGVzLmVuKSx0LmZuLnNlbGVjdDIuYWpheERlZmF1bHRzPXt0cmFuc3BvcnQ6dC5hamF4LHBhcmFtczp7dHlwZToiR0VUIixjYWNoZTohMSxkYXRhVHlwZToianNvbiJ9fSxlPXtxdWVyeTp7YWpheDpNLGxvY2FsOmssdGFnczpUfSx1dGlsOntkZWJvdW5jZTpoLG1hcmtNYXRjaDpiLGVzY2FwZU1hcmt1cDp3LHN0cmlwRGlhY3JpdGljczpyfSwiY2xhc3MiOnsiYWJzdHJhY3QiOkEsc2luZ2xlOk8sbXVsdGk6Tn19fX0odCksZX0uYXBwbHkoZSxuKSwvKgoJCUNvcHlyaWdodCAyMDEyIElnb3IgVmF5bmJlcmcKCgkJVmVyc2lvbjogQEB2ZXJAQCBUaW1lc3RhbXA6IEBAdGltZXN0YW1wQEAKCgkJVGhpcyBzb2Z0d2FyZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkFwYWNoZSBMaWNlbnNlIikgb3IgdGhlIEdOVQoJCUdlbmVyYWwgUHVibGljIExpY2Vuc2UgdmVyc2lvbiAyICh0aGUgIkdQTCBMaWNlbnNlIikuIFlvdSBtYXkgY2hvb3NlIGVpdGhlciBsaWNlbnNlIHRvIGdvdmVybiB5b3VyCgkJdXNlIG9mIHRoaXMgc29mdHdhcmUgb25seSB1cG9uIHRoZSBjb25kaXRpb24gdGhhdCB5b3UgYWNjZXB0IGFsbCBvZiB0aGUgdGVybXMgb2YgZWl0aGVyIHRoZSBBcGFjaGUKCQlMaWNlbnNlIG9yIHRoZSBHUEwgTGljZW5zZS4KCgkJWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBBcGFjaGUgTGljZW5zZSBhbmQgdGhlIEdQTCBMaWNlbnNlIGF0OgoKCQkgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkJICAgIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMi4wLmh0bWwKCgkJVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUKCQlBcGFjaGUgTGljZW5zZSBvciB0aGUgR1BMIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SCgkJQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBBcGFjaGUgTGljZW5zZSBhbmQgdGhlIEdQTCBMaWNlbnNlIGZvcgoJCXRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSBhbmQgdGhlIEdQTCBMaWNlbnNlLgoJCSovCgkhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUpe30sZnVuY3Rpb24odCxlKXt9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTg1KSxpKDE4NCldLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm57VGFiOnQsVGFiczplfX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDI4NSksaSgyODYpLGkoMjg3KV0scj1mdW5jdGlvbih0LGUsaSl7cmV0dXJue0ZpbGVVcGxvYWQ6dCxVcGxvYWRlcjplLFVwbG9hZElmcmFtZTppfX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDUpLGkoMTQ3KSxpKDE0NildLHI9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPWUudHBsKCdcdCAgICA8aW5wdXQgdHlwZT0iZmlsZSIgbmFtZT0iZmlsZSIgY2xhc3M9Im0tZmlsZSI+XHQgICAgPGRpdiBjbGFzcz0iZmFjYWRlIj5cdCAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0idGV4dC1maWVsZC1kZWZhdWx0IiBkaXNhYmxlZD5cdCAgICAgIHt7e2ltZyBzcmM9Ii9pbWcvdWkvYnV0dG9uL2ZpbGUtYnJvd3NlLTAxLnBuZyIgYWx0PSJCcm93c2UgZmlsZXMuLi4iIGNsYXNzPSJicm93c2UifX19XHQgICAgPC9kaXY+XHQgICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgY2xhc3M9ImhpZGUiIG5hbWU9Il94c3JmVG9rZW4iIHZhbHVlPSJ7e3Rva2VufX0iPlx0ICAnKSxyPWkuZXh0ZW5kKHt0ZW1wbGF0ZTpuLGNsYXNzTmFtZToiZmlsZS1pbnB1dC1mYWNhZGUgbWFyZ2luLXRvcC0xMCBtYXJnaW4tYnRtLTEwIGNsZWFyZml4IixldmVudHM6eyJjaGFuZ2UgLm0tZmlsZSI6InVwZGF0ZURpc3BsYXlWYWwifSx1cGRhdGVEaXNwbGF5VmFsOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRGaWxlbmFtZSgpO3QubWF0Y2goL15DOlxcZmFrZXBhdGgvKSYmKHQ9dC5yZXBsYWNlKCJDOlxcZmFrZXBhdGhcXCIsIiIpKSx0aGlzLnVwZGF0ZURpc3BsYXkodCl9LHVwZGF0ZURpc3BsYXk6ZnVuY3Rpb24odCl7dGhpcy4kKCIudGV4dC1maWVsZC1kZWZhdWx0IikudmFsKHQpfSxnZXRGaWxlbmFtZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLiQoIi5tLWZpbGUiKS52YWwoKX0scmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGU9dCgiI194c3JmVG9rZW4iKS50ZXh0KCk7cmV0dXJuIHRoaXMuJGVsLmh0bWwodGhpcy50ZW1wbGF0ZSh7dG9rZW46ZX0pKSx0aGlzfX0pO3JldHVybiByfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTY5KSxpKDE0NiksaSgyODcpLGkoMjg4KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj1lLmV4dGVuZCh7Y2xhc3NOYW1lOiJ1cGxvYWQtaG9sZGVyIixpbml0aWFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaWZyYW1lPW5ldyBpKHtuYW1lOnRoaXMuY2lkfSksdGhpcy5hZGQodGhpcy5pZnJhbWUsbnVsbCwhMCksdGhpcy51cGxvYWRGb3JtPW5ldyBuKHt0YXJnZXQ6dGhpcy5jaWQsZW5kcG9pbnQ6dGhpcy5vcHRpb25zLmVuZHBvaW50fSksdGhpcy5hZGQodGhpcy51cGxvYWRGb3JtLG51bGwsITApLHRoaXMubGlzdGVuVG8odGhpcy5pZnJhbWUsdC5VUExPQURfRE9ORSxmdW5jdGlvbigpe3RoaXMudXBsb2FkRm9ybS51cGxvYWREb25lKCl9KSx0aGlzfX0pO3JldHVybiByfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMTY5KSxpKDE0NiksaSg3KV0scj1mdW5jdGlvbih0LGUpe3ZhciBpPWUuZXh0ZW5kKHt0YWdOYW1lOiJpZnJhbWUiLGNsYXNzTmFtZToiaGlkZSIsYXR0cmlidXRlczpmdW5jdGlvbigpe3JldHVybntuYW1lOnRoaXMub3B0aW9ucy5uYW1lLGlkOnRoaXMub3B0aW9ucy5uYW1lfX0sZXZlbnRzOntsb2FkOmZ1bmN0aW9uKCl7dHJ5e3ZhciBlPXRoaXMuJGVsLmNvbnRlbnRzKCkudGV4dCgpO2lmKGUpcmV0dXJuIHZvaWQgdGhpcy50cmlnZ2VyKHQuVVBMT0FEX0RPTkUsSlNPTi5wYXJzZShlKSl9Y2F0Y2goaSl7fXRoaXMudHJpZ2dlcih0LlVQTE9BRF9FTVBUWV9DT05URU5UKX19fSk7cmV0dXJuIGl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDYpLGkoMjg1KSxpKDI4OSldLHI9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXQuZXh0ZW5kKHt0YWdOYW1lOiJmb3JtIixjbGFzc05hbWU6ImNsZWFyZml4IHBhZGRpbmctYnRtLTEwIixhdHRyaWJ1dGVzOmZ1bmN0aW9uKCl7cmV0dXJue21ldGhvZDoicG9zdCIsZW5jdHlwZToibXVsdGlwYXJ0L2Zvcm0tZGF0YSIsYWN0aW9uOnRoaXMub3B0aW9ucy5lbmRwb2ludCx0YXJnZXQ6dGhpcy5vcHRpb25zLnRhcmdldH19LGV2ZW50czp7c3VibWl0OmZ1bmN0aW9uKCl7dGhpcy5zdWJtaXRCdG4uZGlzYWJsZSghMCl9fSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmlsZVVwbG9hZD1uZXcgZSx0aGlzLmFkZCh0aGlzLmZpbGVVcGxvYWQpLHRoaXMuc3VibWl0QnRuPW5ldyBpLHRoaXMuYWRkKHRoaXMuc3VibWl0QnRuKSx0aGlzfSx1cGxvYWREb25lOmZ1bmN0aW9uKCl7dGhpcy5zdWJtaXRCdG4uZGlzYWJsZSghMSl9fSk7cmV0dXJuIG59LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgxNDYpXSxyPWZ1bmN0aW9uKHQpe3ZhciBlPXQuZXh0ZW5kKHt0YWdOYW1lOiJpbnB1dCIsY2xhc3NOYW1lOiJidXR0b24iLGF0dHJpYnV0ZXM6e3R5cGU6InN1Ym1pdCIsdmFsdWU6IlVwbG9hZCBMb2dvIn0sZGlzYWJsZTpmdW5jdGlvbih0KXt0aGlzLiRlbC5wcm9wKCJkaXNhYmxlZCIsdCl9fSk7cmV0dXJuIGV9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMDgpLGkoMzU5KSxpKDMxOCksaSgzMjEpLGkoMzMyKSxpKDMzNiksaSgzMzgpLGkoMzQxKSxpKDM0MyksaSgzNDQpLGkoMzQ1KSxpKDM0NiksaSgzNDcpLGkoMzQ4KSxpKDM0OSksaSgzNTIpLGkoMzUzKSxpKDM1NCksaSgzNTUpLGkoMzU3KSxpKDI5MSksaSgzNjUpLGkoMzY2KSxpKDM2NyksaSgzNzApLGkoMzcxKSxpKDM3MyksaSgzNzQpLGkoMzc1KSxpKDM3NiksaSgzNzcpLGkoMzc4KSxpKDM3OSksaSgzODApLGkoMzEwKSxpKDM4MSksaSgzODgpLGkoMzE1KSxpKDM4OSldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhLGwsYyx1LGQsaCxwLGYsbSxfLGcsdix5LGIsdyxNLGssVCxTLEwseCxFLEQsWSxDLEEsTyxOLEksUCxSLEgpe3JldHVybiB0LmV4dGVuZCh7cm91dGVzOnsiIjoicHJpbWFyeUF1dGgiLHNpZ25pbjoicHJpbWFyeUF1dGgiLCJzaWduaW4vdmVyaWZ5L2R1by93ZWIiOiJ2ZXJpZnlEdW8iLCJzaWduaW4vdmVyaWZ5L2ZpZG8vd2ViYXV0aG4iOiJ2ZXJpZnlXaW5kb3dzSGVsbG8iLCJzaWduaW4vdmVyaWZ5L2ZpZG8vdTJmIjoidmVyaWZ5VTJGIiwic2lnbmluL3ZlcmlmeS86cHJvdmlkZXIvOmZhY3RvclR5cGUiOiJ2ZXJpZnkiLCJzaWduaW4vZW5yb2xsIjoiZW5yb2xsQ2hvaWNlcyIsInNpZ25pbi9lbnJvbGwvZHVvL3dlYiI6ImVucm9sbER1byIsInNpZ25pbi9lbnJvbGwvb2t0YS9xdWVzdGlvbiI6ImVucm9sbFF1ZXN0aW9uIiwic2lnbmluL2Vucm9sbC9va3RhL3NtcyI6ImVucm9sbFNtcyIsInNpZ25pbi9lbnJvbGwvb2t0YS9jYWxsIjoiZW5yb2xsQ2FsbCIsInNpZ25pbi9lbnJvbGwtYWN0aXZhdGUvb2t0YS9zbXMiOiJlbnJvbGxTbXMiLCJzaWduaW4vZW5yb2xsL3JzYS90b2tlbiI6ImVucm9sbFJzYSIsInNpZ25pbi9lbnJvbGwvZGVsX29hdGgvdG9rZW4iOiJlbnJvbGxPblByZW0iLCJzaWduaW4vZW5yb2xsL3N5bWFudGVjL3Rva2VuIjoiZW5yb2xsU3ltYW50ZWNWaXAiLCJzaWduaW4vZW5yb2xsL3l1Ymljby90b2tlbjpoYXJkd2FyZSI6ImVucm9sbFl1YmlrZXkiLCJzaWduaW4vZW5yb2xsL2ZpZG8vd2ViYXV0aG4iOiJlbnJvbGxXaW5kb3dzSGVsbG8iLCJzaWduaW4vZW5yb2xsL2ZpZG8vdTJmIjoiZW5yb2xsVTJGIiwic2lnbmluL2Vucm9sbC86cHJvdmlkZXIvOmZhY3RvclR5cGUiOiJlbnJvbGxUb3RwRmFjdG9yIiwic2lnbmluL2Vucm9sbC1hY3RpdmF0ZS9va3RhL3B1c2giOiJzY2FuQmFyY29kZVB1c2hGYWN0b3IiLCJzaWduaW4vZW5yb2xsLWFjdGl2YXRlL29rdGEvcHVzaC9tYW51YWwiOiJtYW51YWxTZXR1cFB1c2hGYWN0b3IiLCJzaWduaW4vZW5yb2xsLWFjdGl2YXRlL29rdGEvcHVzaC9zZW50IjoiYWN0aXZhdGlvbkxpbmtTZW50Iiwic2lnbmluL2Vucm9sbC1hY3RpdmF0ZS9va3RhL3Rva2VuOnNvZnR3YXJlOnRvdHAvcGFzc2NvZGUiOiJlbnRlclBhc3Njb2RlSW5QdXNoRW5yb2xsbWVudEZsb3ciLCJzaWduaW4vZW5yb2xsLWFjdGl2YXRlLzpwcm92aWRlci86ZmFjdG9yVHlwZSI6InNjYW5CYXJjb2RlVG90cEZhY3RvciIsInNpZ25pbi9lbnJvbGwtYWN0aXZhdGUvOnByb3ZpZGVyLzpmYWN0b3JUeXBlL2FjdGl2YXRlIjoiYWN0aXZhdGVUb3RwRmFjdG9yIiwic2lnbmluL2Vucm9sbC1hY3RpdmF0ZS86cHJvdmlkZXIvOmZhY3RvclR5cGUvbWFudWFsIjoibWFudWFsU2V0dXBUb3RwRmFjdG9yIiwic2lnbmluL3Bhc3N3b3JkLWV4cGlyZWQiOiJwYXNzd29yZEV4cGlyZWQiLCJzaWduaW4vY3VzdG9tLXBhc3N3b3JkLWV4cGlyZWQiOiJjdXN0b21QYXNzd29yZEV4cGlyZWQiLCJzaWduaW4vZm9yZ290LXBhc3N3b3JkIjoiZm9yZ290UGFzc3dvcmQiLCJzaWduaW4vcmVjb3ZlcnktY2hhbGxlbmdlIjoicmVjb3ZlcnlDaGFsbGVuZ2UiLCJzaWduaW4vcmVjb3ZlcnktZW1haWxlZCI6InJlY292ZXJ5RW1haWxTZW50Iiwic2lnbmluL3JlY292ZXJ5LXF1ZXN0aW9uIjoicmVjb3ZlcnlRdWVzdGlvbiIsInNpZ25pbi9wYXNzd29yZC1yZXNldCI6InBhc3N3b3JkUmVzZXQiLCJzaWduaW4vcmVzZXQtcGFzc3dvcmQvOnRva2VuIjoicmVjb3ZlcnlMb2FkaW5nIiwic2lnbmluL3VzZXItdW5sb2NrLzp0b2tlbiI6InJlY292ZXJ5TG9hZGluZyIsInNpZ25pbi9yZWNvdmVyeS86dG9rZW4iOiJyZWNvdmVyeUxvYWRpbmciLCJzaWduaW4vdW5sb2NrLWVtYWlsZWQiOiJ1bmxvY2tFbWFpbFNlbnQiLCJzaWduaW4vdW5sb2NrIjoidW5sb2NrQWNjb3VudCIsInNpZ25pbi9hY2NvdW50LXVubG9ja2VkIjoiYWNjb3VudFVubG9ja2VkIiwic2lnbmluL3JlZnJlc2gtYXV0aC1zdGF0ZSgvOnRva2VuKSI6InJlZnJlc2hBdXRoU3RhdGUiLCJzaWduaW4vcmVnaXN0ZXIiOiJyZWdpc3RlciIsInNpZ25pbi9yZWdpc3Rlci1jb21wbGV0ZSI6InJlZ2lzdGVyQ29tcGxldGUiLCIqd2lsZGNhcmQiOiJwcmltYXJ5QXV0aCJ9LHN0YXRlTGVzc1JvdXRlSGFuZGxlcnM6WyJwcmltYXJ5QXV0aCIsImZvcmdvdFBhc3N3b3JkIiwicmVjb3ZlcnlMb2FkaW5nIiwidW5sb2NrQWNjb3VudCIsInJlZnJlc2hBdXRoU3RhdGUiLCJyZWdpc3RlciIsInJlZ2lzdGVyQ29tcGxldGUiXSxwcmltYXJ5QXV0aDpmdW5jdGlvbigpe3RoaXMucmVuZGVyKGUse0JlYWNvbjpSfSl9LHZlcmlmeUR1bzpmdW5jdGlvbigpe3RoaXMucmVuZGVyKGkse3Byb3ZpZGVyOiJEVU8iLGZhY3RvclR5cGU6IndlYiIsQmVhY29uOkh9KX0sdmVyaWZ5V2luZG93c0hlbGxvOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIocix7cHJvdmlkZXI6IkZJRE8iLGZhY3RvclR5cGU6IndlYmF1dGhuIixCZWFjb246SH0pfSx2ZXJpZnlVMkY6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihzLHtwcm92aWRlcjoiRklETyIsZmFjdG9yVHlwZToidTJmIixCZWFjb246SH0pfSx2ZXJpZnk6ZnVuY3Rpb24odCxlKXt0aGlzLnJlbmRlcihuLHtwcm92aWRlcjp0LnRvVXBwZXJDYXNlKCksZmFjdG9yVHlwZTplLEJlYWNvbjpIfSl9LGVucm9sbENob2ljZXM6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihvLHtCZWFjb246Un0pfSxlbnJvbGxEdW86ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihhLHtwcm92aWRlcjoiRFVPIixmYWN0b3JUeXBlOiJ3ZWIiLEJlYWNvbjpIfSl9LGVucm9sbFF1ZXN0aW9uOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIobCx7cHJvdmlkZXI6Ik9LVEEiLGZhY3RvclR5cGU6InF1ZXN0aW9uIixCZWFjb246SH0pfSxlbnJvbGxTbXM6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcih1LHtwcm92aWRlcjoiT0tUQSIsZmFjdG9yVHlwZToic21zIixCZWFjb246SH0pfSxlbnJvbGxDYWxsOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIodSx7cHJvdmlkZXI6Ik9LVEEiLGZhY3RvclR5cGU6ImNhbGwiLEJlYWNvbjpIfSl9LGVucm9sbFJzYTpmdW5jdGlvbigpe3RoaXMucmVuZGVyKGQse3Byb3ZpZGVyOiJSU0EiLGZhY3RvclR5cGU6InRva2VuIixCZWFjb246SH0pfSxlbnJvbGxPblByZW06ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihkLHtwcm92aWRlcjoiREVMX09BVEgiLGZhY3RvclR5cGU6InRva2VuIixCZWFjb246SH0pfSxlbnJvbGxTeW1hbnRlY1ZpcDpmdW5jdGlvbigpe3RoaXMucmVuZGVyKGgse3Byb3ZpZGVyOiJTWU1BTlRFQyIsZmFjdG9yVHlwZToidG9rZW4iLEJlYWNvbjpIfSl9LGVucm9sbFl1YmlrZXk6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihwLHtwcm92aWRlcjoiWVVCSUNPIixmYWN0b3JUeXBlOiJ0b2tlbjpoYXJkd2FyZSIsQmVhY29uOkh9KX0sZW5yb2xsVG90cEZhY3RvcjpmdW5jdGlvbih0LGUpe3RoaXMucmVuZGVyKGYse3Byb3ZpZGVyOnQudG9VcHBlckNhc2UoKSxmYWN0b3JUeXBlOmUsQmVhY29uOkh9KX0sZW5yb2xsV2luZG93c0hlbGxvOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIoYyx7cHJvdmlkZXI6IkZJRE8iLGZhY3RvclR5cGU6IndlYmF1dGhuIixCZWFjb246SH0pfSxlbnJvbGxVMkY6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihtLHtwcm92aWRlcjoiRklETyIsZmFjdG9yVHlwZToidTJmIixCZWFjb246SH0pfSxzY2FuQmFyY29kZVRvdHBGYWN0b3I6ZnVuY3Rpb24odCxlKXt0aGlzLnJlbmRlcihfLHtwcm92aWRlcjp0LnRvVXBwZXJDYXNlKCksZmFjdG9yVHlwZTplLEJlYWNvbjpIfSl9LHNjYW5CYXJjb2RlUHVzaEZhY3RvcjpmdW5jdGlvbigpe3RoaXMucmVuZGVyKGcse3Byb3ZpZGVyOiJPS1RBIixmYWN0b3JUeXBlOiJwdXNoIixCZWFjb246SH0pfSxhY3RpdmF0ZVRvdHBGYWN0b3I6ZnVuY3Rpb24odCxlKXt0aGlzLnJlbmRlcih2LHtwcm92aWRlcjp0LnRvVXBwZXJDYXNlKCksZmFjdG9yVHlwZTplLEJlYWNvbjpIfSl9LG1hbnVhbFNldHVwVG90cEZhY3RvcjpmdW5jdGlvbih0LGUpe3RoaXMucmVuZGVyKHkse3Byb3ZpZGVyOnQudG9VcHBlckNhc2UoKSxmYWN0b3JUeXBlOmUsQmVhY29uOkh9KX0sbWFudWFsU2V0dXBQdXNoRmFjdG9yOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIoYix7cHJvdmlkZXI6Ik9LVEEiLGZhY3RvclR5cGU6InB1c2giLEJlYWNvbjpIfSl9LGFjdGl2YXRpb25MaW5rU2VudDpmdW5jdGlvbigpe3RoaXMucmVuZGVyKHcse3Byb3ZpZGVyOiJPS1RBIixmYWN0b3JUeXBlOiJwdXNoIixCZWFjb246SH0pfSxlbnRlclBhc3Njb2RlSW5QdXNoRW5yb2xsbWVudEZsb3c6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihNLHtwcm92aWRlcjoiT0tUQSIsZmFjdG9yVHlwZToidG9rZW46c29mdHdhcmU6dG90cCIsQmVhY29uOkh9KX0scGFzc3dvcmRFeHBpcmVkOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIoayx7QmVhY29uOlJ9KX0sY3VzdG9tUGFzc3dvcmRFeHBpcmVkOmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIoVCx7QmVhY29uOlJ9KX0sZm9yZ290UGFzc3dvcmQ6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihTKX0scmVjb3ZlcnlDaGFsbGVuZ2U6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihMLHtCZWFjb246Un0pfSxyZWNvdmVyeUVtYWlsU2VudDpmdW5jdGlvbigpe3RoaXMucmVuZGVyKHgse0JlYWNvbjpSfSl9LHVubG9ja0VtYWlsU2VudDpmdW5jdGlvbigpe3RoaXMucmVuZGVyKE8se0JlYWNvbjpSfSl9LHJlY292ZXJ5UXVlc3Rpb246ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihFLHtCZWFjb246Un0pfSxwYXNzd29yZFJlc2V0OmZ1bmN0aW9uKCl7dGhpcy5yZW5kZXIoRCx7QmVhY29uOlJ9KX0scmVjb3ZlcnlMb2FkaW5nOmZ1bmN0aW9uKHQpe3RoaXMucmVuZGVyKFkse3Rva2VuOnQsQmVhY29uOlJ9KX0sdW5sb2NrQWNjb3VudDpmdW5jdGlvbigpe3RoaXMucmVuZGVyKEMpfSxhY2NvdW50VW5sb2NrZWQ6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihBLHtCZWFjb246Un0pfSxyZWZyZXNoQXV0aFN0YXRlOmZ1bmN0aW9uKHQpe3RoaXMucmVuZGVyKE4se3Rva2VuOnQsQmVhY29uOlJ9KX0scmVnaXN0ZXI6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcihJKX0scmVnaXN0ZXJDb21wbGV0ZTpmdW5jdGlvbigpe3RoaXMucmVuZGVyKFApfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjkyKSxpKDI5NCksaSgyOTUpLGkoMjk2KSxpKDI5OSksaSgzMDQpLGkoMzA1KSxpKDMwNildLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhLGwpe2Z1bmN0aW9uIGModCxlKXt2YXIgaT1zLmNyZWF0ZUFjdGl2YXRlRmFjdG9yVXJsKHQub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImFjdGl2YXRlZEZhY3RvclByb3ZpZGVyIiksdC5vcHRpb25zLmFwcFN0YXRlLmdldCgiYWN0aXZhdGVkRmFjdG9yVHlwZSIpLGUpO3Qub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsaSl9ZnVuY3Rpb24gdSh0KXt2YXIgZSxpOyJTTVMiPT09dC5tb2RlbC5nZXQoImFjdGl2YXRpb25UeXBlIikmJihpPXQubW9kZWwuZ2V0KCJjb3VudHJ5Q29kZSIpLGU9dC5tb2RlbC5nZXQoInBob25lTnVtYmVyIikpLHQub3B0aW9ucy5hcHBTdGF0ZS5zZXQoe2ZhY3RvckFjdGl2YXRpb25UeXBlOnQubW9kZWwuZ2V0KCJhY3RpdmF0aW9uVHlwZSIpLHVzZXJDb3VudHJ5Q29kZTppLHVzZXJQaG9uZU51bWJlcjplfSl9ZnVuY3Rpb24gZCh0LGUpe3JldHVybiB0Lm1vZGVsLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24oaSl7cmV0dXJuIGkucHJldigpLnRoZW4oZnVuY3Rpb24odCl7dmFyIGk9aC5maW5kV2hlcmUodC5mYWN0b3JzLHtmYWN0b3JUeXBlOmUscHJvdmlkZXI6Ik9LVEEifSk7cmV0dXJuIGkuZW5yb2xsKCl9KS50aGVuKGZ1bmN0aW9uKGUpe3ZhciBpLG4scixzPWUuZGF0YTtpZihzJiZzLl9lbWJlZGRlZCYmcy5fZW1iZWRkZWQuZmFjdG9yJiZzLl9lbWJlZGRlZC5mYWN0b3IuX2VtYmVkZGVkJiZzLl9lbWJlZGRlZC5mYWN0b3IuX2VtYmVkZGVkLmFjdGl2YXRpb24pe3ZhciBvPXMuX2VtYmVkZGVkLmZhY3RvcjtpZihyPW8uX2VtYmVkZGVkLmFjdGl2YXRpb24uc2hhcmVkU2VjcmV0LG8uX2VtYmVkZGVkLmFjdGl2YXRpb24uX2xpbmtzJiZvLl9lbWJlZGRlZC5hY3RpdmF0aW9uLl9saW5rcy5zZW5kKXt2YXIgYT1vLl9lbWJlZGRlZC5hY3RpdmF0aW9uLl9saW5rcy5zZW5kLGw9aC5maW5kV2hlcmUoYSx7bmFtZToic21zIn0pO2k9bD9sLmhyZWY6bnVsbDt2YXIgYz1oLmZpbmRXaGVyZShhLHtuYW1lOiJlbWFpbCJ9KTtuPWM/Yy5ocmVmOm51bGx9fXJldHVybiB0Lm1vZGVsLnNldCh7U01TOmksRU1BSUw6bixzaGFyZWRTZWNyZXQ6cn0pLGV9KX0pfXZhciBoPXQuXztyZXR1cm4gbi5leHRlbmQoe2NsYXNzTmFtZToiZW5yb2xsLW1hbnVhbC1wdXNoIixNb2RlbDpmdW5jdGlvbigpe3JldHVybntsb2NhbDp7YWN0aXZhdGlvblR5cGU6WyJzdHJpbmciLCEwLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImZhY3RvckFjdGl2YXRpb25UeXBlIil8fCJTTVMiXSxjb3VudHJ5Q29kZTpbInN0cmluZyIsITEsIlVTIl0scGhvbmVOdW1iZXI6InN0cmluZyIsU01TOlsic3RyaW5nIiwhMSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJ0ZXh0QWN0aXZhdGlvbkxpbmtVcmwiKV0sRU1BSUw6WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImVtYWlsQWN0aXZhdGlvbkxpbmtVcmwiKV0sc2hhcmVkU2VjcmV0Olsic3RyaW5nIiwhMSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJzaGFyZWRTZWNyZXQiKV0sX19mYWN0b3JUeXBlX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5mYWN0b3JUeXBlXSxfX3Byb3ZpZGVyX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5wcm92aWRlcl19LGRlcml2ZWQ6e2NvdW50cnlDYWxsaW5nQ29kZTp7ZGVwczpbImNvdW50cnlDb2RlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIisiK2UuZ2V0Q2FsbGluZ0NvZGVGb3JDb3VudHJ5KHQpfX0sZnVsbFBob25lTnVtYmVyOntkZXBzOlsiY291bnRyeUNhbGxpbmdDb2RlIiwicGhvbmVOdW1iZXIiXSxmbjpmdW5jdGlvbih0LGUpe3JldHVybiB0K2V9fX19fSxGb3JtOnt0aXRsZTpmdW5jdGlvbigpe3ZhciBlPWkuZ2V0RmFjdG9yTGFiZWwodGhpcy5tb2RlbC5nZXQoIl9fcHJvdmlkZXJfXyIpLHRoaXMubW9kZWwuZ2V0KCJfX2ZhY3RvclR5cGVfXyIpKTtyZXR1cm4gdC5sb2MoImVucm9sbC50b3RwLnRpdGxlIiwibG9naW4iLFtlXSl9LHN1YnRpdGxlOmgucGFydGlhbCh0LmxvYywiZW5yb2xsLnRvdHAuY2Fubm90U2NhbkJhcmNvZGUiLCJsb2dpbiIpLG5vQnV0dG9uQmFyOiEwLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoic3RlcC1tYW51YWwtc2V0dXAifSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXt2YXIgaT1bci5JbnB1dCh7bmFtZToiYWN0aXZhdGlvblR5cGUiLHR5cGU6InNlbGVjdCIsd2lkZTohMCxvcHRpb25zOntTTVM6dC5sb2MoImVucm9sbC50b3RwLnNlbmRTbXMiLCJsb2dpbiIpLEVNQUlMOnQubG9jKCJlbnJvbGwudG90cC5zZW5kRW1haWwiLCJsb2dpbiIpLE1BTlVBTDp0LmxvYygiZW5yb2xsLnRvdHAuc2V0dXBNYW51YWxseSIsImxvZ2luIil9fSksci5JbnB1dCh7bmFtZToiY291bnRyeUNvZGUiLHR5cGU6InNlbGVjdCIsd2lkZTohMCxvcHRpb25zOmUuZ2V0Q291bnRyaWVzKCksc2hvd1doZW46e2FjdGl2YXRpb25UeXBlOiJTTVMifX0pLHIuSW5wdXQoe3BsYWNlaG9sZGVyOnQubG9jKCJtZmEucGhvbmVOdW1iZXIucGxhY2Vob2xkZXIiLCJsb2dpbiIpLGNsYXNzTmFtZToiZW5yb2xsLXNtcy1waG9uZSIsbmFtZToicGhvbmVOdW1iZXIiLGlucHV0OmEsdHlwZToidGV4dCIsc2hvd1doZW46e2FjdGl2YXRpb25UeXBlOiJTTVMifX0pLHIuVmlldyh7VmlldzonXHQgICAgICAgICAgICAgIDxwIGNsYXNzPSJva3RhLWZvcm0tc3VidGl0bGUgby1mb3JtLWV4cGxhaW4gdGV4dC1hbGlnbi1jIj5cdCAgICAgICAgICAgICAgICB7e2kxOG4gY29kZT0iZW5yb2xsLnRvdHAuc2hhcmVkU2VjcmV0SW5zdHJ1Y3Rpb25zIiBidW5kbGU9ImxvZ2luIn19XHQgICAgICAgICAgICAgIDwvcD5cdCAgICAgICAgICAgICcsc2hvd1doZW46e2FjdGl2YXRpb25UeXBlOiJNQU5VQUwifX0pLHIuSW5wdXQoe25hbWU6InNoYXJlZFNlY3JldCIsaW5wdXQ6bCx0eXBlOiJ0ZXh0IixkaXNhYmxlZDohMCxzaG93V2hlbjp7YWN0aXZhdGlvblR5cGU6Ik1BTlVBTCJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImNoYW5nZTpzaGFyZWRTZWNyZXQiLHRoaXMucmVuZGVyKX19KSxyLlZpZXcoe1ZpZXc6JzxkaXYgZGF0YS10eXBlPSJuZXh0LWJ1dHRvbi13cmFwIj48L2Rpdj4nLHNob3dXaGVuOnthY3RpdmF0aW9uVHlwZToiTUFOVUFMIn19KSxyLkJ1dHRvbih7dGl0bGU6dC5sb2MoIm9mb3JtLm5leHQiLCJsb2dpbiIpLGNsYXNzTmFtZToiYnV0dG9uIGJ1dHRvbi1wcmltYXJ5IGJ1dHRvbi13aWRlIGJ1dHRvbi1uZXh0IixhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6Im5leHQtYnV0dG9uIn0sY2xpY2s6aC5iaW5kKGZ1bmN0aW9uKCl7dSh0aGlzKSxjKHRoaXMsInBhc3Njb2RlIil9LHRoaXMpfSwnW2RhdGEtdHlwZT0ibmV4dC1idXR0b24td3JhcCJdJyksci5Ub29sYmFyKHtub0NhbmNlbEJ1dHRvbjohMCxzYXZlOnQubG9jKCJvZm9ybS5zZW5kIiwibG9naW4iKSxzaG93V2hlbjp7YWN0aXZhdGlvblR5cGU6ZnVuY3Rpb24odCl7cmV0dXJuIlNNUyI9PT10fHwiRU1BSUwiPT09dH19fSldO3JldHVybiBpfX0sRm9vdGVyOm8saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMuc2V0SW5pdGlhbE1vZGVsKCksdGhpcy5saXN0ZW5Ubyh0aGlzLmZvcm0sInNhdmUiLGZ1bmN0aW9uKCl7dmFyIHQ9dGhpczt0aGlzLm1vZGVsLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5nZXQoImFjdGl2YXRpb25UeXBlIikudG9Mb3dlckNhc2UoKSxuPXt9O3JldHVybiJzbXMiPT09aSYmKG4ucHJvZmlsZT17cGhvbmVOdW1iZXI6dGhpcy5nZXQoImZ1bGxQaG9uZU51bWJlciIpfSksZS5mYWN0b3IuYWN0aXZhdGlvbi5zZW5kKGksbikudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gdSh0KSxoLmRlZmVyKGZ1bmN0aW9uKCl7Yyh0LCJzZW50Iil9KSxlfSl9KX0pLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiY2hhbmdlOmFjdGl2YXRpb25UeXBlIixmdW5jdGlvbih0LGUpe3RoaXMuZm9ybS5jbGVhckVycm9ycygpLCJNQU5VQUwiPT09ZSYmInRva2VuOnNvZnR3YXJlOnRvdHAiIT09dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiYWN0aXZhdGVkRmFjdG9yVHlwZSIpP2QodGhpcywidG9rZW46c29mdHdhcmU6dG90cCIpOiJwdXNoIiE9PXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImFjdGl2YXRlZEZhY3RvclR5cGUiKSYmZCh0aGlzLCJwdXNoIil9KX0sc2V0SW5pdGlhbE1vZGVsOmZ1bmN0aW9uKCl7IlNNUyI9PT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJmYWN0b3JBY3RpdmF0aW9uVHlwZSIpJiZ0aGlzLm1vZGVsLnNldCh7Y291bnRyeUNvZGU6dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlckNvdW50cnlDb2RlIil8fCJVUyIscGhvbmVOdW1iZXI6dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlclBob25lTnVtYmVyIil9KX0sdHJhcEF1dGhSZXNwb25zZTpmdW5jdGlvbigpe2lmKHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImlzTWZhRW5yb2xsQWN0aXZhdGUiKXx8dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFFbnJvbGwiKSlyZXR1cm4hMH19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMTc4KSxpKDI5MyldLHI9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXt9O3JldHVybiBuLmdldENvdW50cmllcz1mdW5jdGlvbigpe3ZhciBpPXQub21pdChlLmNvdW50cnksIkhNIiwiQlYiLCJURiIpLG49dC5tYXAoaSxmdW5jdGlvbih0LGUpe3JldHVybntuYW1lOnQsY29kZTplfX0pO249dC5zb3J0QnkobiwibmFtZSIpO3ZhciByPXt9O3JldHVybiB0LmVhY2gobixmdW5jdGlvbih0KXtyW3QuY29kZV09dC5uYW1lfSkscn0sbi5nZXRDYWxsaW5nQ29kZUZvckNvdW50cnk9ZnVuY3Rpb24odCl7cmV0dXJuIGlbdF19LG59LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpeyEodC5leHBvcnRzPXtVUzoiMSIsQUc6IjEiLEFJOiIxIixBUzoiMSIsQkI6IjEiLEJNOiIxIixCUzoiMSIsQ0E6IjEiLERNOiIxIixETzoiMSIsR0Q6IjEiLEdVOiIxIixKTToiMSIsS046IjEiLEtZOiIxIixMQzoiMSIsTVA6IjEiLE1TOiIxIixQUjoiMSIsU1g6IjEiLFRDOiIxIixUVDoiMSIsVkM6IjEiLFZHOiIxIixWSToiMSIsUlU6IjciLEtaOiI3IixFRzoiMjAiLFpBOiIyNyIsR1I6IjMwIixOTDoiMzEiLEJFOiIzMiIsRlI6IjMzIixFUzoiMzQiLEhVOiIzNiIsSVQ6IjM5IixSTzoiNDAiLENIOiI0MSIsQVQ6IjQzIixHQjoiNDQiLEdHOiI0NCIsSU06IjQ0IixKRToiNDQiLERLOiI0NSIsU0U6IjQ2IixOTzoiNDciLFNKOiI0NyIsUEw6IjQ4IixERToiNDkiLFBFOiI1MSIsTVg6IjUyIixDVToiNTMiLEFSOiI1NCIsQlI6IjU1IixDTDoiNTYiLENPOiI1NyIsVkU6IjU4IixNWToiNjAiLEFVOiI2MSIsQ0M6IjYxIixDWDoiNjEiLElEOiI2MiIsUEg6IjYzIixOWjoiNjQiLFNHOiI2NSIsVEg6IjY2IixKUDoiODEiLEtSOiI4MiIsVk46Ijg0IixDTjoiODYiLFRSOiI5MCIsSU46IjkxIixQSzoiOTIiLEFGOiI5MyIsTEs6Ijk0IixNTToiOTUiLElSOiI5OCIsU1M6IjIxMSIsTUE6IjIxMiIsRUg6IjIxMiIsRFo6IjIxMyIsVE46IjIxNiIsTFk6IjIxOCIsR006IjIyMCIsU046IjIyMSIsTVI6IjIyMiIsTUw6IjIyMyIsR046IjIyNCIsQ0k6IjIyNSIsQkY6IjIyNiIsTkU6IjIyNyIsVEc6IjIyOCIsQko6IjIyOSIsTVU6IjIzMCIsTFI6IjIzMSIsU0w6IjIzMiIsR0g6IjIzMyIsTkc6IjIzNCIsVEQ6IjIzNSIsQ0Y6IjIzNiIsQ006IjIzNyIsQ1Y6IjIzOCIsU1Q6IjIzOSIsR1E6IjI0MCIsR0E6IjI0MSIsQ0c6IjI0MiIsQ0Q6IjI0MyIsQU86IjI0NCIsR1c6IjI0NSIsSU86IjI0NiIsQUM6IjI0NyIsU0M6IjI0OCIsU0Q6IjI0OSIsUlc6IjI1MCIsRVQ6IjI1MSIsU086IjI1MiIsREo6IjI1MyIsS0U6IjI1NCIsVFo6IjI1NSIsVUc6IjI1NiIsQkk6IjI1NyIsTVo6IjI1OCIsWk06IjI2MCIsTUc6IjI2MSIsUkU6IjI2MiIsWVQ6IjI2MiIsWlc6IjI2MyIsTkE6IjI2NCIsTVc6IjI2NSIsTFM6IjI2NiIsQlc6IjI2NyIsU1o6IjI2OCIsS006IjI2OSIsU0g6IjI5MCIsVEE6IjI5MCIsRVI6IjI5MSIsQVc6IjI5NyIsRk86IjI5OCIsR0w6IjI5OSIsR0k6IjM1MCIsUFQ6IjM1MSIsTFU6IjM1MiIsSUU6IjM1MyIsSVM6IjM1NCIsQUw6IjM1NSIsTVQ6IjM1NiIsQ1k6IjM1NyIsRkk6IjM1OCIsQVg6IjM1OCIsQkc6IjM1OSIsTFQ6IjM3MCIsTFY6IjM3MSIsRUU6IjM3MiIsTUQ6IjM3MyIsQU06IjM3NCIsQlk6IjM3NSIsQUQ6IjM3NiIsTUM6IjM3NyIsU006IjM3OCIsVkE6IjM3OSIsVUE6IjM4MCIsUlM6IjM4MSIsTUU6IjM4MiIsSFI6IjM4NSIsU0k6IjM4NiIsQkE6IjM4NyIsTUs6IjM4OSIsQ1o6IjQyMCIsU0s6IjQyMSIsTEk6IjQyMyIsRks6IjUwMCIsQlo6IjUwMSIsR1Q6IjUwMiIsU1Y6IjUwMyIsSE46IjUwNCIsTkk6IjUwNSIsQ1I6IjUwNiIsUEE6IjUwNyIsUE06IjUwOCIsSFQ6IjUwOSIsR1A6IjU5MCIsQkw6IjU5MCIsTUY6IjU5MCIsQk86IjU5MSIsR1k6IjU5MiIsRUM6IjU5MyIsR0Y6IjU5NCIsUFk6IjU5NSIsTVE6IjU5NiIsU1I6IjU5NyIsVVk6IjU5OCIsQ1c6IjU5OSIsQlE6IjU5OSIsVEw6IjY3MCIsTkY6IjY3MiIsQk46IjY3MyIsTlI6IjY3NCIsUEc6IjY3NSIsVE86IjY3NiIsU0I6IjY3NyIsVlU6IjY3OCIsRko6IjY3OSIsUFc6IjY4MCIsV0Y6IjY4MSIsQ0s6IjY4MiIsTlU6IjY4MyIsV1M6IjY4NSIsS0k6IjY4NiIsTkM6IjY4NyIsVFY6IjY4OCIsUEY6IjY4OSIsVEs6IjY5MCIsRk06IjY5MSIsTUg6IjY5MiIsIjAwMSI6Ijk3OSIsS1A6Ijg1MCIsSEs6Ijg1MiIsTU86Ijg1MyIsS0g6Ijg1NSIsTEE6Ijg1NiIsQkQ6Ijg4MCIsVFc6Ijg4NiIsTVY6Ijk2MCIsTEI6Ijk2MSIsSk86Ijk2MiIsU1k6Ijk2MyIsSVE6Ijk2NCIsS1c6Ijk2NSIsU0E6Ijk2NiIsWUU6Ijk2NyIsT006Ijk2OCIsUFM6Ijk3MCIsQUU6Ijk3MSIsSUw6Ijk3MiIsQkg6Ijk3MyIsUUE6Ijk3NCIsQlQ6Ijk3NSIsTU46Ijk3NiIsTlA6Ijk3NyIsVEo6Ijk5MiIsVE06Ijk5MyIsQVo6Ijk5NCIsR0U6Ijk5NSIsS0c6Ijk5NiIsVVo6Ijk5OCIsR1M6NTAwLFBOOjY0LEFROjY3MixVTToxLEFOOjU5OX0pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDE4OCldLHI9ZnVuY3Rpb24odCxlKXt2YXIgaT10Ll8sbj17fSxyPXtPS1RBX1ZFUklGWTp7bGFiZWw6ImZhY3Rvci50b3RwU29mdC5va3RhVmVyaWZ5IixkZXNjcmlwdGlvbjoiZmFjdG9yLnRvdHBTb2Z0LmRlc2NyaXB0aW9uIixpY29uQ2xhc3NOYW1lOiJtZmEtb2t0YS12ZXJpZnkiLHNvcnRPcmRlcjoxfSxPS1RBX1ZFUklGWV9QVVNIOntsYWJlbDoiZmFjdG9yLm9rdGFWZXJpZnlQdXNoIixkZXNjcmlwdGlvbjoiZmFjdG9yLnB1c2guZGVzY3JpcHRpb24iLGljb25DbGFzc05hbWU6Im1mYS1va3RhLXZlcmlmeSIsc29ydE9yZGVyOjF9LFNNUzp7bGFiZWw6ImZhY3Rvci5zbXMiLGRlc2NyaXB0aW9uOiJmYWN0b3Iuc21zLmRlc2NyaXB0aW9uIixpY29uQ2xhc3NOYW1lOiJtZmEtb2t0YS1zbXMiLHNvcnRPcmRlcjoyfSxDQUxMOntsYWJlbDoiZmFjdG9yLmNhbGwiLGRlc2NyaXB0aW9uOiJmYWN0b3IuY2FsbC5kZXNjcmlwdGlvbiIsaWNvbkNsYXNzTmFtZToibWZhLW9rdGEtY2FsbCIsc29ydE9yZGVyOjN9LFdJTkRPV1NfSEVMTE86e2xhYmVsOiJmYWN0b3Iud2luZG93c0hlbGxvIixkZXNjcmlwdGlvbjoiZmFjdG9yLndpbmRvd3NIZWxsby5zaWduaW4uZGVzY3JpcHRpb24iLGljb25DbGFzc05hbWU6Im1mYS13aW5kb3dzLWhlbGxvIixzb3J0T3JkZXI6NH0sVTJGOntsYWJlbDoiZmFjdG9yLnUyZiIsZGVzY3JpcHRpb246ImZhY3Rvci51MmYuZGVzY3JpcHRpb24iLGljb25DbGFzc05hbWU6Im1mYS11MmYiLHNvcnRPcmRlcjo1fSxZVUJJS0VZOntsYWJlbDoiZmFjdG9yLnRvdHBIYXJkLnl1YmlrZXkiLGRlc2NyaXB0aW9uOiJmYWN0b3IudG90cEhhcmQueXViaWtleS5kZXNjcmlwdGlvbiIsaWNvbkNsYXNzTmFtZToibWZhLXl1YmlrZXkiLHNvcnRPcmRlcjo2fSxEVU86e2xhYmVsOiJmYWN0b3IuZHVvIixkZXNjcmlwdGlvbjoiZmFjdG9yLmR1by5kZXNjcmlwdGlvbiIsaWNvbkNsYXNzTmFtZToibWZhLWR1byIsc29ydE9yZGVyOjd9LEdPT0dMRV9BVVRIOntsYWJlbDoiZmFjdG9yLnRvdHBTb2Z0Lmdvb2dsZUF1dGhlbnRpY2F0b3IiLGRlc2NyaXB0aW9uOiJmYWN0b3IudG90cFNvZnQuZGVzY3JpcHRpb24iLGljb25DbGFzc05hbWU6Im1mYS1nb29nbGUtYXV0aCIsc29ydE9yZGVyOjh9LFNZTUFOVEVDX1ZJUDp7bGFiZWw6ImZhY3Rvci50b3RwSGFyZC5zeW1hbnRlY1ZpcCIsZGVzY3JpcHRpb246ImZhY3Rvci50b3RwSGFyZC5kZXNjcmlwdGlvbiIsaWNvbkNsYXNzTmFtZToibWZhLXN5bWFudGVjIixzb3J0T3JkZXI6OX0sUlNBX1NFQ1VSSUQ6e2xhYmVsOiJmYWN0b3IudG90cEhhcmQucnNhU2VjdXJJZCIsZGVzY3JpcHRpb246ImZhY3Rvci50b3RwSGFyZC5kZXNjcmlwdGlvbiIsaWNvbkNsYXNzTmFtZToibWZhLXJzYSIsc29ydE9yZGVyOjEwfSxPTl9QUkVNOntsYWJlbDoiIixkZXNjcmlwdGlvbjoiZmFjdG9yLnRvdHBIYXJkLmRlc2NyaXB0aW9uIixpY29uQ2xhc3NOYW1lOiJtZmEtb25wcmVtIixzb3J0T3JkZXI6MTB9LEVNQUlMOntsYWJlbDoiZmFjdG9yLmVtYWlsIixkZXNjcmlwdGlvbjoiIixpY29uQ2xhc3NOYW1lOiJtZmEtb2t0YS1lbWFpbCIsc29ydE9yZGVyOjExfSxRVUVTVElPTjp7bGFiZWw6ImZhY3Rvci5zZWN1cml0eVF1ZXN0aW9uIixkZXNjcmlwdGlvbjoiZmFjdG9yLnNlY3VyaXR5UXVlc3Rpb24uZGVzY3JpcHRpb24iLGljb25DbGFzc05hbWU6Im1mYS1va3RhLXNlY3VyaXR5LXF1ZXN0aW9uIixzb3J0T3JkZXI6MTJ9fTtyZXR1cm4gbi5nZXRGYWN0b3JOYW1lPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIk9LVEEiPT09dCYmInRva2VuOnNvZnR3YXJlOnRvdHAiPT09ZT8iT0tUQV9WRVJJRlkiOiJPS1RBIj09PXQmJiJwdXNoIj09PWU/Ik9LVEFfVkVSSUZZX1BVU0giOiJHT09HTEUiPT09dD8iR09PR0xFX0FVVEgiOiJTWU1BTlRFQyI9PT10JiYidG9rZW4iPT09ZT8iU1lNQU5URUNfVklQIjoiUlNBIj09PXQmJiJ0b2tlbiI9PT1lPyJSU0FfU0VDVVJJRCI6IkRFTF9PQVRIIj09PXQmJiJ0b2tlbiI9PT1lPyJPTl9QUkVNIjoiRFVPIj09PXQmJiJ3ZWIiPT09ZT8iRFVPIjoiWVVCSUNPIj09PXQmJiJ0b2tlbjpoYXJkd2FyZSI9PT1lPyJZVUJJS0VZIjoiT0tUQSI9PT10JiYic21zIj09PWU/IlNNUyI6Ik9LVEEiPT09dCYmImNhbGwiPT09ZT8iQ0FMTCI6Ik9LVEEiPT09dCYmInF1ZXN0aW9uIj09PWU/IlFVRVNUSU9OIjoiRklETyI9PT10JiYid2ViYXV0aG4iPT09ZT8iV0lORE9XU19IRUxMTyI6IkZJRE8iPT09dCYmInUyZiI9PT1lPyJVMkYiOiJPS1RBIj09PXQmJiJlbWFpbCI9PT1lPyJFTUFJTCI6dm9pZCAwfSxuLmlzT2t0YVZlcmlmeT1mdW5jdGlvbih0LGUpe3JldHVybiJPS1RBIj09PXQmJigidG9rZW46c29mdHdhcmU6dG90cCI9PT1lfHwicHVzaCI9PT1lKX0sbi5nZXRGYWN0b3JMYWJlbD1mdW5jdGlvbihlLGkpe3ZhciBzPXJbbi5nZXRGYWN0b3JOYW1lKGUsaSldLmxhYmVsO3JldHVybiB0LmxvYyhzLCJsb2dpbiIpfSxuLmdldEZhY3RvckRlc2NyaXB0aW9uPWZ1bmN0aW9uKGUsaSl7dmFyIHM9cltuLmdldEZhY3Rvck5hbWUoZSxpKV0uZGVzY3JpcHRpb247cmV0dXJuIHQubG9jKHMsImxvZ2luIil9LG4uZ2V0RmFjdG9ySWNvbkNsYXNzTmFtZT1mdW5jdGlvbih0LGUpe3JldHVybiByW24uZ2V0RmFjdG9yTmFtZSh0LGUpXS5pY29uQ2xhc3NOYW1lfSxuLmdldEZhY3RvclNvcnRPcmRlcj1mdW5jdGlvbih0LGUpe3JldHVybiByW24uZ2V0RmFjdG9yTmFtZSh0LGUpXS5zb3J0T3JkZXJ9LG4uZ2V0UmVtZW1iZXJEZXZpY2VWYWx1ZT1mdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5nZXQoInJlbWVtYmVyRGV2aWNlQnlEZWZhdWx0Iil9LG4uZ2V0U2VjdXJpdHlRdWVzdGlvbkxhYmVsPWZ1bmN0aW9uKGUpe3ZhciBpPXQubG9jKCJzZWN1cml0eS4iK2UucXVlc3Rpb24pO3JldHVybiBpLmluZGV4T2YoIkwxME5fRVJST1IiKTwwP2k6ZS5xdWVzdGlvblRleHR9LG4uZ2V0UGFzc3dvcmRDb21wbGV4aXR5RGVzY3JpcHRpb249ZnVuY3Rpb24obil7dmFyIHI9W10scz1mdW5jdGlvbihlKXt2YXIgaTtzd2l0Y2goZS51bml0KXtjYXNlIkRBWSI6aT0icGFzc3dvcmQuY29tcGxleGl0eS5taW5BZ2VEYXlzIjticmVhaztjYXNlIkhPVVIiOmk9InBhc3N3b3JkLmNvbXBsZXhpdHkubWluQWdlSG91cnMiO2JyZWFrO2Nhc2UiTUlOVVRFIjppPSJwYXNzd29yZC5jb21wbGV4aXR5Lm1pbkFnZU1pbnV0ZXMifXJldHVybiB0LmxvYyhpLCJsb2dpbiIsW2UudGltZV0pfTtpZihuLmNvbXBsZXhpdHkpe3ZhciBvPXttaW5MZW5ndGg6e2kxOG46InBhc3N3b3JkLmNvbXBsZXhpdHkubGVuZ3RoIixhcmdzOiEwfSxtaW5Mb3dlckNhc2U6e2kxOG46InBhc3N3b3JkLmNvbXBsZXhpdHkubG93ZXJjYXNlIn0sbWluVXBwZXJDYXNlOntpMThuOiJwYXNzd29yZC5jb21wbGV4aXR5LnVwcGVyY2FzZSJ9LG1pbk51bWJlcjp7aTE4bjoicGFzc3dvcmQuY29tcGxleGl0eS5udW1iZXIifSxtaW5TeW1ib2w6e2kxOG46InBhc3N3b3JkLmNvbXBsZXhpdHkuc3ltYm9sIn0sZXhjbHVkZVVzZXJuYW1lOntpMThuOiJwYXNzd29yZC5jb21wbGV4aXR5Lm5vX3VzZXJuYW1lIn19LGE9bi5jb21wbGV4aXR5LGw9aS5tYXAoYSxmdW5jdGlvbihlLGkpe2lmKCEoZTw9MCkpe3ZhciBuPW9baV07cmV0dXJuIG4uYXJncz90LmxvYyhuLmkxOG4sImxvZ2luIixbZV0pOnQubG9jKG4uaTE4biwibG9naW4iKX19KTtsPWkuY29tcGFjdChsKSxsLmxlbmd0aCYmKGw9aS5yZWR1Y2UobCxmdW5jdGlvbihlLGkpe3JldHVybiBlP2UrdC5sb2MoInBhc3N3b3JkLmNvbXBsZXhpdHkubGlzdC5lbGVtZW50IiwibG9naW4iLFtpXSk6aX0pLHIucHVzaCh0LmxvYygicGFzc3dvcmQuY29tcGxleGl0eS5kZXNjcmlwdGlvbiIsImxvZ2luIixbbF0pKSl9aWYobi5hZ2UmJm4uYWdlLmhpc3RvcnlDb3VudD4wJiZyLnB1c2godC5sb2MoInBhc3N3b3JkLmNvbXBsZXhpdHkuaGlzdG9yeSIsImxvZ2luIixbbi5hZ2UuaGlzdG9yeUNvdW50XSkpLG4uYWdlJiZuLmFnZS5taW5BZ2VNaW51dGVzPjApe3ZhciBjPWUuZ2V0VGltZUluSGlnaGVzdFJlbGV2YW50VW5pdChuLmFnZS5taW5BZ2VNaW51dGVzLCJNSU5VVEUiKSx1PXMoYyk7ci5wdXNoKHUpfXJldHVybiByLmpvaW4oIiAiKX0sbn0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NiksaSgyMzYpLGkoMjMzKSxpKDI5NyksaSgyOTgpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzKXt2YXIgbz10Ll8sYT10LkZvcm0uZXh0ZW5kKHtsYXlvdXQ6Im8tZm9ybS10aGVtZSIsbm9DYW5jZWxCdXR0b246ITAsY29uc3RydWN0b3I6ZnVuY3Rpb24ocil7dC5Gb3JtLmNhbGwodGhpcyxyKSxvLmVhY2goby5yZXN1bHQodGhpcywiZm9ybUNoaWxkcmVuIil8fFtdLGZ1bmN0aW9uKHIpe3N3aXRjaChyLnR5cGUpe2Nhc2UgZS5JTlBVVDp0aGlzLmFkZElucHV0KG8uZXh0ZW5kKHtsYWJlbDohMSwibGFiZWwtdG9wIjohMH0sci52aWV3T3B0aW9ucykpO2JyZWFrO2Nhc2UgZS5CVVRUT046dGhpcy5hZGQodC5jcmVhdGVCdXR0b24oby5leHRlbmQoe21vZGVsOnRoaXMubW9kZWx9LHIudmlld09wdGlvbnMpKSxyLmFkZE9wdGlvbnMpLG4uYXBwbHlTaG93V2hlbih0aGlzLmxhc3QoKSxyLnZpZXdPcHRpb25zJiZyLnZpZXdPcHRpb25zLnNob3dXaGVuKTticmVhaztjYXNlIGUuRElWSURFUjp0aGlzLmFkZERpdmlkZXIoci52aWV3T3B0aW9ucyk7YnJlYWs7Y2FzZSBlLlRPT0xCQVI6dGhpcy5hZGQoaSx7b3B0aW9uczpyLnZpZXdPcHRpb25zfSksbi5hcHBseVNob3dXaGVuKHRoaXMubGFzdCgpLHIudmlld09wdGlvbnMmJnIudmlld09wdGlvbnMuc2hvd1doZW4pO2JyZWFrO2Nhc2UgZS5WSUVXOnRoaXMuYWRkKHIudmlld09wdGlvbnMuVmlldyxyLmFkZE9wdGlvbnMpLG4uYXBwbHlTaG93V2hlbih0aGlzLmxhc3QoKSxyLnZpZXdPcHRpb25zLnNob3dXaGVuKTticmVhaztkZWZhdWx0OnRocm93IG5ldyBFcnJvcigiVW5yZWNvZ25pemVkIGNoaWxkIHR5cGU6ICIrci50eXBlKX19LHRoaXMpfX0pO3JldHVybiByLmV4dGVuZCh7Y29uc3RydWN0b3I6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmluaXRpYWxpemU7aWYodGhpcy5pbml0aWFsaXplPWZ1bmN0aW9uKCl7fSxyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLk1vZGVsJiZ0aGlzLkZvcm0pe3ZhciBlPXMuZXh0ZW5kKG8uZXh0ZW5kKHtwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zZXR0aW5ncz10LnNldHRpbmdzLHRoaXMuYXBwU3RhdGU9dC5hcHBTdGF0ZSxvLm9taXQodCxbInNldHRpbmdzIiwiYXBwU3RhdGUiXSl9fSxvLnJlc3VsdCh0aGlzLCJNb2RlbCIpKSk7dGhpcy5tb2RlbD1uZXcgZSh7c2V0dGluZ3M6dGhpcy5zZXR0aW5ncyxhcHBTdGF0ZTp0aGlzLm9wdGlvbnMuYXBwU3RhdGV9LHtwYXJzZTohMH0pO3ZhciBpPWEuZXh0ZW5kKG8ucmVzdWx0KHRoaXMsIkZvcm0iLHRoaXMpKTt0aGlzLmZvcm09bmV3IGkodGhpcy50b0pTT04oKSksdGhpcy5hZGQodGhpcy5mb3JtKX10aGlzLkZvb3RlciYmKHRoaXMuZm9vdGVyPW5ldyB0aGlzLkZvb3Rlcih0aGlzLnRvSlNPTigpKSx0aGlzLmFkZCh0aGlzLmZvb3RlcikpLHRoaXMuYWRkTGlzdGVuZXJzKCksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHRvSlNPTjpmdW5jdGlvbigpe3ZhciB0PXIucHJvdG90eXBlLnRvSlNPTi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIG8uZXh0ZW5kKG8ucGljayh0aGlzLm9wdGlvbnMsImFwcFN0YXRlIiksdCl9LGJhY2s6ZnVuY3Rpb24oKXt0aGlzLmZvb3RlciYmdGhpcy5mb290ZXIuYmFjayYmdGhpcy5mb290ZXIuYmFjaygpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbjtuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtyZXR1cm4gZnVuY3Rpb24oZSxpKXtyZXR1cm57dHlwZTp0LHZpZXdPcHRpb25zOmUsYWRkT3B0aW9uczppfX19dmFyIGU9IklOUFVUIixpPSJCVVRUT04iLG49IkRJVklERVIiLHI9IlRPT0xCQVIiLHM9IlZJRVciO3JldHVybntJbnB1dDp0KGUpLEJ1dHRvbjp0KGkpLERpdmlkZXI6dChuKSxUb29sYmFyOnQociksVmlldzp0KHMpLElOUFVUOmUsQlVUVE9OOmksRElWSURFUjpuLFRPT0xCQVI6cixWSUVXOnN9fS5jYWxsKGUsaSxlLHQpLCEodm9pZCAwIT09biYmKHQuZXhwb3J0cz1uKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjEpXSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaShlKXtyZXR1cm4gbi5maW5kKGUuZ2V0Q2hpbGRyZW4oKSxmdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIHQuRm9ybX0pfXZhciBuPXQuXztyZXR1cm4gdC5Db250cm9sbGVyLmV4dGVuZCh7YWRkTGlzdGVuZXJzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5tb2RlbC5nZXQoImJhY2t1cEZhY3RvciIpO3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwic2F2ZSIsZnVuY3Rpb24oKXt2YXIgdD1pKHRoaXMpLGU9dC5kaXNhYmxlU3VibWl0QnV0dG9uO2UmJiF0LmRpc2FibGVTdWJtaXRCdXR0b24oKXx8dGhpcy50b2dnbGVCdXR0b25TdGF0ZSghMCl9KSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImVycm9yIixmdW5jdGlvbigpe3RoaXMudG9nZ2xlQnV0dG9uU3RhdGUoITEpfSk7dmFyIGU9bi5iaW5kKGZ1bmN0aW9uKHQpe3RoaXMub3B0aW9ucy5hcHBTdGF0ZS5zZXQoInRyYW5zYWN0aW9uIix0KX0sdGhpcykscj1uLmJpbmQoZnVuY3Rpb24odCl7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnNldCgidHJhbnNhY3Rpb25FcnJvciIsdCl9LHRoaXMpO3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwic2V0VHJhbnNhY3Rpb24iLGUpLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwic2V0VHJhbnNhY3Rpb25FcnJvciIsciksdCYmKHRoaXMubGlzdGVuVG8odCwic2V0VHJhbnNhY3Rpb24iLGUpLHRoaXMubGlzdGVuVG8odCwic2V0VHJhbnNhY3Rpb25FcnJvciIscikpfSxmZXRjaEluaXRpYWxEYXRhOmZ1bmN0aW9uKCl7cmV0dXJuIGUoKX0sdHJhcEF1dGhSZXNwb25zZTpmdW5jdGlvbigpe3JldHVybiExfSx0b0pTT046ZnVuY3Rpb24oKXt2YXIgZT10LkNvbnRyb2xsZXIucHJvdG90eXBlLnRvSlNPTi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIG4uZXh0ZW5kKG4ucGljayh0aGlzLm9wdGlvbnMsImFwcFN0YXRlIiksZSl9LHRvZ2dsZUJ1dHRvblN0YXRlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuJGVsLmZpbmQoIi5idXR0b24iKTtlLnRvZ2dsZUNsYXNzKCJsaW5rLWJ1dHRvbi1kaXNhYmxlZCIsdCkucHJvcCgiZGlzYWJsZWQiLHQpfSxwb3N0UmVuZGVyQW5pbWF0aW9uOmZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyKCJwYWdlUmVuZGVyZWQiLHtwYWdlOnRoaXMuY2xhc3NOYW1lfSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyMSldLHI9ZnVuY3Rpb24odCxlKXt2YXIgaT10Ll8sbj1bIk9BdXRoRXJyb3IiLCJBdXRoU2RrRXJyb3IiLCJBdXRoUG9sbFN0b3BFcnJvciIsIkF1dGhBcGlFcnJvciJdO3JldHVybiB0Lk1vZGVsLmV4dGVuZCh7ZG9UcmFuc2FjdGlvbjpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXM7cmV0dXJuIHQuY2FsbCh0aGlzLHRoaXMuYXBwU3RhdGUuZ2V0KCJ0cmFuc2FjdGlvbiIpKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiByLnRyaWdnZXIoInNldFRyYW5zYWN0aW9uIix0KSx0fSkuZmFpbChmdW5jdGlvbih0KXtpZigiQXV0aFBvbGxTdG9wRXJyb3IiIT09dC5uYW1lJiYoci50cmlnZ2VyKCJzZXRUcmFuc2FjdGlvbkVycm9yIix0KSxyLnRyaWdnZXIoImVycm9yIixyLHQueGhyKSxlfHxpLmluZGV4T2Yobix0Lm5hbWUpPT09LTEpKXRocm93IHR9KX0sbWFuYWdlVHJhbnNhY3Rpb246ZnVuY3Rpb24odCl7dmFyIG49dGhpcyxyPXQuY2FsbCh0aGlzLHRoaXMuYXBwU3RhdGUuZ2V0KCJ0cmFuc2FjdGlvbiIpLGkuYmluZCh0aGlzLnNldFRyYW5zYWN0aW9uLHRoaXMpKTtyZXR1cm4gZS5pc1Byb21pc2UocikmJnIuZmFpbChmdW5jdGlvbih0KXsiQXV0aFBvbGxTdG9wRXJyb3IiIT09dC5uYW1lJiYobi50cmlnZ2VyKCJzZXRUcmFuc2FjdGlvbkVycm9yIix0KSxuLnRyaWdnZXIoImVycm9yIixuLHQueGhyKSl9KSxlLnJlc29sdmUocil9LHN0YXJ0VHJhbnNhY3Rpb246ZnVuY3Rpb24odCl7dmFyIGk9dGhpcyxuPXQuY2FsbCh0aGlzLHRoaXMuc2V0dGluZ3MuZ2V0QXV0aENsaWVudCgpKTtyZXR1cm4gZS5pc1Byb21pc2Uobik/bi50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiBpLnRyaWdnZXIoInNldFRyYW5zYWN0aW9uIix0KSx0fSkuZmFpbChmdW5jdGlvbih0KXt0aHJvdyBpLnRyaWdnZXIoInNldFRyYW5zYWN0aW9uRXJyb3IiLHQpLGkudHJpZ2dlcigiZXJyb3IiLGksdC54aHIpLHR9KTplLnJlc29sdmUobil9LHNldFRyYW5zYWN0aW9uOmZ1bmN0aW9uKHQpe3RoaXMuYXBwU3RhdGUuc2V0KCJ0cmFuc2FjdGlvbiIsdCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgxOTApLGkoMzAwKSxpKDMwMSksaSgxODIpLGkoMzAyKSxpKDMwMyldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyl7dmFyIGE9e30sbD10LnRwbCgic2lnbmluL3ZlcmlmeS97e3Byb3ZpZGVyfX0ve3tmYWN0b3JUeXBlfX0iKSxjPXQudHBsKCJzaWduaW4vZW5yb2xsL3t7cHJvdmlkZXJ9fS97e2ZhY3RvclR5cGV9fSIpLHU9dC50cGwoInNpZ25pbi9lbnJvbGwtYWN0aXZhdGUve3twcm92aWRlcn19L3t7ZmFjdG9yVHlwZX19e3sjaWYgc3RlcH19L3t7c3RlcH19e3svaWZ9fSIpLGQ9dC50cGwoInNpZ25pbi9yZWNvdmVyeS97e3JlY292ZXJ5VG9rZW59fSIpLGg9dC50cGwoInNpZ25pbi9yZWZyZXNoLWF1dGgtc3RhdGV7eyNpZiB0b2tlbn19L3t7dG9rZW59fXt7L2lmfX0iKSxwPXQudHBsKCJ7e2Jhc2VVcmx9fS9sb2dpbi9zZXNzaW9uQ29va2llUmVkaXJlY3Q/Y2hlY2tBY2NvdW50U2V0dXBDb21wbGV0ZT10cnVlJnRva2VuPXt7e3Rva2VufX19JnJlZGlyZWN0VXJsPXt7e3JlZGlyZWN0VXJsfX19Iik7cmV0dXJuIGEuY3JlYXRlVmVyaWZ5VXJsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGwoe3Byb3ZpZGVyOmVuY29kZVVSSUNvbXBvbmVudCh0LnRvTG93ZXJDYXNlKCkpLGZhY3RvclR5cGU6ZW5jb2RlVVJJQ29tcG9uZW50KGUpfSl9LGEuY3JlYXRlRW5yb2xsRmFjdG9yVXJsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGMoe3Byb3ZpZGVyOmVuY29kZVVSSUNvbXBvbmVudCh0LnRvTG93ZXJDYXNlKCkpLGZhY3RvclR5cGU6ZW5jb2RlVVJJQ29tcG9uZW50KGUpfSl9LGEuY3JlYXRlQWN0aXZhdGVGYWN0b3JVcmw9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB1KHtwcm92aWRlcjplbmNvZGVVUklDb21wb25lbnQodC50b0xvd2VyQ2FzZSgpKSxmYWN0b3JUeXBlOmVuY29kZVVSSUNvbXBvbmVudChlKSxzdGVwOiEhaSYmZW5jb2RlVVJJQ29tcG9uZW50KGkpfSl9LGEuY3JlYXRlUmVjb3ZlcnlVcmw9ZnVuY3Rpb24odCl7cmV0dXJuIGQoe3JlY292ZXJ5VG9rZW46ZW5jb2RlVVJJQ29tcG9uZW50KHQpfSl9LGEuY3JlYXRlUmVmcmVzaFVybD1mdW5jdGlvbih0KXt2YXIgZT10P2VuY29kZVVSSUNvbXBvbmVudCh0KTpudWxsO3JldHVybiBoKHt0b2tlbjplfSl9LGEucm91dGVBZnRlckF1dGhTdGF0dXNDaGFuZ2U9ZnVuY3Rpb24obCxjLHUpe2lmKGMmJmMueGhyJiZyLmNvcnNJc05vdEVuYWJsZWQoYy54aHIpKXJldHVybiB2b2lkIGwuc2V0dGluZ3MuY2FsbEdsb2JhbEVycm9yKG5ldyBzLlVuc3VwcG9ydGVkQnJvd3NlckVycm9yKHQubG9jKCJlcnJvci5lbmFibGVkLmNvcnMiKSkpO2lmKGMmJmMuZXJyb3JDb2RlPT09by5JTlZBTElEX1RPS0VOX0VYQ0VQVElPTilyZXR1cm4gbC5hcHBTdGF0ZS5zZXQoImZsYXNoRXJyb3IiLHQubG9jKCJlcnJvci5leHBpcmVkLnNlc3Npb24iKSksbC5jb250cm9sbGVyLnN0YXRlLnNldCgibmF2aWdhdGVEaXIiLG4uRElSRUNUSU9OX0JBQ0spLHZvaWQgbC5uYXZpZ2F0ZSgiIix7dHJpZ2dlcjohMH0pO2lmKCFjJiZ1JiZ1LnN0YXR1cyYmKGwuYXBwU3RhdGUuc2V0QXV0aFJlc3BvbnNlKHUpLCFsLmNvbnRyb2xsZXJ8fCFsLmNvbnRyb2xsZXIudHJhcEF1dGhSZXNwb25zZSh1KSkpc3dpdGNoKHUuc3RhdHVzKXtjYXNlIlNVQ0NFU1MiOmlmKHUucmVjb3ZlcnlUeXBlPT09bi5SRUNPVkVSWV9UWVBFX1VOTE9DSylyZXR1cm4gdm9pZCBsLm5hdmlnYXRlKCJzaWduaW4vYWNjb3VudC11bmxvY2tlZCIse3RyaWdnZXI6ITB9KTtpZihsLnNldHRpbmdzLmdldCgib2F1dGgyRW5hYmxlZCIpKXJldHVybiB2b2lkIGkuZ2V0VG9rZW5zKGwuc2V0dGluZ3Mse3Nlc3Npb25Ub2tlbjp1LnNlc3Npb25Ub2tlbn0sbC5jb250cm9sbGVyKTt2YXIgZD17dXNlcjp1Ll9lbWJlZGRlZC51c2VyLHR5cGU6dS50eXBlfTtpZih1LnR5cGU9PT1uLlNFU1NJT05fU1RFUF9VUCl7dmFyIGg9dS5fbGlua3MmJnUuX2xpbmtzLm5leHQmJnUuX2xpbmtzLm5leHQuaHJlZjtkLnN0ZXBVcD17dXJsOmgsZmluaXNoOmZ1bmN0aW9uKCl7ZS5yZWRpcmVjdChoKX19fWVsc2UgZC50eXBlPW4uU0VTU0lPTl9TU08sZC5zZXNzaW9uPXt0b2tlbjp1LnNlc3Npb25Ub2tlbixzZXRDb29raWVBbmRSZWRpcmVjdDpmdW5jdGlvbih0KXtlLnJlZGlyZWN0KHAoe2Jhc2VVcmw6bC5zZXR0aW5ncy5nZXQoImJhc2VVcmwiKSx0b2tlbjplbmNvZGVVUklDb21wb25lbnQodS5zZXNzaW9uVG9rZW4pLHJlZGlyZWN0VXJsOmVuY29kZVVSSUNvbXBvbmVudCh0KX0pKX19O3JldHVybiB2b2lkIGwuc2V0dGluZ3MuY2FsbEdsb2JhbFN1Y2Nlc3Mobi5TVUNDRVNTLGQpO2Nhc2UiTUZBX1JFUVVJUkVEIjp2YXIgZj1sLmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpLmdldERlZmF1bHRGYWN0b3IoKSxtPWEuY3JlYXRlVmVyaWZ5VXJsKGYuZ2V0KCJwcm92aWRlciIpLGYuZ2V0KCJmYWN0b3JUeXBlIikpO3JldHVybiB2b2lkIGwubmF2aWdhdGUobSx7dHJpZ2dlcjohMH0pO2Nhc2UiTUZBX0NIQUxMRU5HRSI6cmV0dXJuIHZvaWQgbC5hcHBTdGF0ZS5nZXQoInRyYW5zYWN0aW9uIikucHJldigpLnRoZW4oZnVuY3Rpb24odCl7bC5hcHBTdGF0ZS5zZXQoInRyYW5zYWN0aW9uIix0KX0pLmRvbmUoKTtjYXNlIk1GQV9FTlJPTEwiOnJldHVybiB2b2lkIGwubmF2aWdhdGUoInNpZ25pbi9lbnJvbGwiLHt0cmlnZ2VyOiEwfSk7Y2FzZSJNRkFfRU5ST0xMX0FDVElWQVRFIjp2YXIgXz1hLmNyZWF0ZUFjdGl2YXRlRmFjdG9yVXJsKGwuYXBwU3RhdGUuZ2V0KCJhY3RpdmF0ZWRGYWN0b3JQcm92aWRlciIpLGwuYXBwU3RhdGUuZ2V0KCJhY3RpdmF0ZWRGYWN0b3JUeXBlIikpO3JldHVybiB2b2lkIGwubmF2aWdhdGUoXyx7dHJpZ2dlcjohMH0pO2Nhc2UiUEFTU1dPUkRfV0FSTiI6Y2FzZSJQQVNTV09SRF9FWFBJUkVEIjpyZXR1cm4gdm9pZChsLnNldHRpbmdzLmdldCgiZmVhdHVyZXMuY3VzdG9tRXhwaXJlZFBhc3N3b3JkIikmJiFsLmFwcFN0YXRlLmdldCgiaXNQd2RNYW5hZ2VkQnlPa3RhIik/bC5uYXZpZ2F0ZSgic2lnbmluL2N1c3RvbS1wYXNzd29yZC1leHBpcmVkIix7dHJpZ2dlcjohMH0pOmwubmF2aWdhdGUoInNpZ25pbi9wYXNzd29yZC1leHBpcmVkIix7dHJpZ2dlcjohMH0pKTtjYXNlIlJFQ09WRVJZX0NIQUxMRU5HRSI6dmFyIGc9dS5mYWN0b3JUeXBlLnRvTG93ZXJDYXNlKCk9PT1uLlJFQ09WRVJZX0ZBQ1RPUl9UWVBFX0VNQUlMLnRvTG93ZXJDYXNlKCksdj11LnJlY292ZXJ5VHlwZT09PW4uUkVDT1ZFUllfVFlQRV9QQVNTV09SRCx5PXUucmVjb3ZlcnlUeXBlPT09bi5SRUNPVkVSWV9UWVBFX1VOTE9DSztyZXR1cm4gdm9pZCh2JiZnP2wubmF2aWdhdGUoInNpZ25pbi9yZWNvdmVyeS1lbWFpbGVkIix7dHJpZ2dlcjohMH0pOnkmJmc/bC5uYXZpZ2F0ZSgic2lnbmluL3VubG9jay1lbWFpbGVkIix7dHJpZ2dlcjohMH0pOmwubmF2aWdhdGUoInNpZ25pbi9yZWNvdmVyeS1jaGFsbGVuZ2UiLHt0cmlnZ2VyOiEwfSkpO2Nhc2UiUkVDT1ZFUlkiOnJldHVybiB2b2lkIGwubmF2aWdhdGUoInNpZ25pbi9yZWNvdmVyeS1xdWVzdGlvbiIse3RyaWdnZXI6ITB9KTtjYXNlIlBBU1NXT1JEX1JFU0VUIjpyZXR1cm4gdm9pZCBsLm5hdmlnYXRlKCJzaWduaW4vcGFzc3dvcmQtcmVzZXQiLHt0cmlnZ2VyOiEwfSk7Y2FzZSJMT0NLRURfT1VUIjpyZXR1cm4gdm9pZChsLnNldHRpbmdzLmdldCgiZmVhdHVyZXMuc2VsZlNlcnZpY2VVbmxvY2siKT9sLm5hdmlnYXRlKCJzaWduaW4vdW5sb2NrIix7dHJpZ2dlcjohMH0pOmwuY29udHJvbGxlci5tb2RlbC50cmlnZ2VyKCJlcnJvciIsbC5jb250cm9sbGVyLm1vZGVsLHtyZXNwb25zZUpTT046e2Vycm9yQ2F1c2VzOltdLGVycm9yU3VtbWFyeTp0LmxvYygiZXJyb3IuYXV0aC5sb2NrZWRPdXQiLCJsb2dpbiIpfX0pKTtjYXNlIlVOQVVUSEVOVElDQVRFRCI6cmV0dXJuIHZvaWQgbC5uYXZpZ2F0ZSgic2lnbmluIix7dHJpZ2dlcjohMH0pO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJVbmtub3duIHN0YXR1czogIit1LnN0YXR1cyl9fSxhfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzAxKSxpKDMwMildLHI9ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCxlKXtyZXR1cm4gcy5pc0FycmF5KHQucmVzcG9uc2VUeXBlKT9zLmNvbnRhaW5zKHQucmVzcG9uc2VUeXBlLGUpOmU9PT10LnJlc3BvbnNlVHlwZX12YXIgcj17fSxzPXQuXztyZXR1cm4gci5nZXRUb2tlbnM9ZnVuY3Rpb24ocixvLGEpe2Z1bmN0aW9uIGwodCl7ci5jYWxsR2xvYmFsU3VjY2VzcyhlLlNVQ0NFU1MsdCl9ZnVuY3Rpb24gYyh0KXsiYWNjZXNzX2RlbmllZCI9PT10LmVycm9yQ29kZT8oYS5tb2RlbC50cmlnZ2VyKCJlcnJvciIsYS5tb2RlbCx7cmVzcG9uc2VKU09OOnR9KSxhLm1vZGVsLmFwcFN0YXRlLnRyaWdnZXIoInJlbW92ZUxvYWRpbmciKSk6ci5jYWxsR2xvYmFsRXJyb3IobmV3IGkuT0F1dGhFcnJvcih0Lm1lc3NhZ2UpKX12YXIgdT1yLmdldEF1dGhDbGllbnQoKSxkPXIudG9KU09OKHt2ZXJib3NlOiEwfSksaD17fSxwPXt9O3MuZXh0ZW5kKGgscy5waWNrKGQsImNsaWVudElkIiwicmVkaXJlY3RVcmkiKSxzLnBpY2soZC5hdXRoUGFyYW1zLCJyZXNwb25zZVR5cGUiLCJyZXNwb25zZU1vZGUiLCJkaXNwbGF5Iiwic2NvcGVzIiwic3RhdGUiLCJub25jZSIpLG8pLHAucG9wdXBUaXRsZT10LmxvYygic29jaWFsYXV0aC5wb3B1cC50aXRsZSIsImxvZ2luIikscC50aW1lb3V0PWQub0F1dGhUaW1lb3V0LHMuZXh0ZW5kKHAscy5waWNrKGQuYXV0aFBhcmFtcywiaXNzdWVyIiwiYXV0aG9yaXplVXJsIikpLCJwYWdlIj09PWguZGlzcGxheXx8bihoLCJjb2RlIik/dS50b2tlbi5nZXRXaXRoUmVkaXJlY3QoaCxwKTpoLnNlc3Npb25Ub2tlbj91LnRva2VuLmdldFdpdGhvdXRQcm9tcHQoaCxwKS50aGVuKGwpLmZhaWwoYykuZG9uZSgpOnUudG9rZW4uZ2V0V2l0aFBvcHVwKGgscCkudGhlbihsKS5mYWlsKGMpLmRvbmUoKX0scn0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7ISh0LmV4cG9ydHM9e0RJUkVDVElPTl9CQUNLOiJESVJFQ1RJT05fQkFDSyIsUkVDT1ZFUllfVFlQRV9QQVNTV09SRDoiUEFTU1dPUkQiLFJFQ09WRVJZX1RZUEVfVU5MT0NLOiJVTkxPQ0siLFJFQ09WRVJZX0ZBQ1RPUl9UWVBFX1NNUzoiU01TIixSRUNPVkVSWV9GQUNUT1JfVFlQRV9FTUFJTDoiRU1BSUwiLFJFQ09WRVJZX0ZBQ1RPUl9UWVBFX0NBTEw6IkNBTEwiLFNVQ0NFU1M6IlNVQ0NFU1MiLEZPUkdPVF9QQVNTV09SRF9FTUFJTF9TRU5UOiJGT1JHT1RfUEFTU1dPUkRfRU1BSUxfU0VOVCIsVU5MT0NLX0FDQ09VTlRfRU1BSUxfU0VOVDoiVU5MT0NLX0FDQ09VTlRfRU1BSUxfU0VOVCIsQ09ORklHX0VSUk9SOiJDT05GSUdfRVJST1IiLFVOU1VQUE9SVEVEX0JST1dTRVJfRVJST1I6IlVOU1VQUE9SVEVEX0JST1dTRVJfRVJST1IiLE9BVVRIX0VSUk9SOiJPQVVUSF9FUlJPUiIsQUxMX09QVElPTkFMX05PTkVfRU5ST0xMRUQ6IkFMTF9PUFRJT05BTF9OT05FX0VOUk9MTEVEIixBTExfT1BUSU9OQUxfU09NRV9FTlJPTExFRDoiQUxMX09QVElPTkFMX1NPTUVfRU5ST0xMRUQiLEhBU19SRVFVSVJFRF9OT05FX0VOUk9MTEVEOiJIQVNfUkVRVUlSRURfTk9ORV9FTlJPTExFRCIsSEFTX1JFUVVJUkVEX1NPTUVfUkVRVUlSRURfRU5ST0xMRUQ6IkhBU19SRVFVSVJFRF9TT01FX1JFUVVJUkVEX0VOUk9MTEVEIixIQVNfUkVRVUlSRURfQUxMX1JFUVVJUkVEX0VOUk9MTEVEOiJIQVNfUkVRVUlSRURfQUxMX1JFUVVJUkVEX0VOUk9MTEVEIixQUklNQVJZX0FVVEg6IlBSSU1BUllfQVVUSCIsRk9SR09UX1BBU1NXT1JEOiJGT1JHT1RfUEFTU1dPUkQiLFVOTE9DS19BQ0NPVU5UOiJVTkxPQ0tfQUNDT1VOVCIsU0VTU0lPTl9TU086IlNFU1NJT05fU1NPIixTRVNTSU9OX1NURVBfVVA6IlNFU1NJT05fU1RFUF9VUCJ9KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgzMDEpXSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaShpKXt0aGlzLm5hbWU9ZS5DT05GSUdfRVJST1IsdGhpcy5tZXNzYWdlPWl8fHQubG9jKCJlcnJvci5jb25maWciKX1mdW5jdGlvbiBuKGkpe3RoaXMubmFtZT1lLlVOU1VQUE9SVEVEX0JST1dTRVJfRVJST1IsdGhpcy5tZXNzYWdlPWl8fHQubG9jKCJlcnJvci51bnN1cHBvcnRlZC5icm93c2VyIil9ZnVuY3Rpb24gcih0KXt0aGlzLm5hbWU9ZS5PQVVUSF9FUlJPUix0aGlzLm1lc3NhZ2U9dH1yZXR1cm4gaS5wcm90b3R5cGU9bmV3IEVycm9yLG4ucHJvdG90eXBlPW5ldyBFcnJvcixyLnByb3RvdHlwZT1uZXcgRXJyb3Ise0NvbmZpZ0Vycm9yOmksVW5zdXBwb3J0ZWRCcm93c2VyRXJyb3I6bixPQXV0aEVycm9yOnJ9fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXshKHQuZXhwb3J0cz17SU5WQUxJRF9UT0tFTl9FWENFUFRJT046IkUwMDAwMDExIn0pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5OSldLHI9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKHQpe3ZhciBpPWUuY3JlYXRlQWN0aXZhdGVGYWN0b3JVcmwodC5nZXQoImFjdGl2YXRlZEZhY3RvclByb3ZpZGVyIiksdC5nZXQoImFjdGl2YXRlZEZhY3RvclR5cGUiKSk7dC50cmlnZ2VyKCJuYXZpZ2F0ZSIsaSl9dmFyIG49dC5fO3JldHVybiB0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICA8YSBocmVmPSIjIiBjbGFzcz0ibGluayBoZWxwIGpzLWJhY2siIGRhdGEtc2U9ImJhY2stbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJtZmEuYmFja1RvRmFjdG9ycyIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9ImxpbmsgaGVscCBnb3RvIGpzLWdvdG8iIGRhdGEtc2U9ImdvdG8tbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJtZmEuc2NhbkJhcmNvZGUiIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgIDwvYT5cdCAgICAnLGNsYXNzTmFtZToiYXV0aC1mb290ZXIiLGV2ZW50czp7ImNsaWNrIC5qcy1iYWNrIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5iYWNrKCl9LCJjbGljayAuanMtZ290byI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpO3ZhciBlPW4ucGFydGlhbChpLHRoaXMub3B0aW9ucy5hcHBTdGF0ZSk7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnVuc2V0KCJmYWN0b3JBY3RpdmF0aW9uVHlwZSIpLCJwdXNoIiE9PXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImFjdGl2YXRlZEZhY3RvclR5cGUiKT90aGlzLm1vZGVsLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQucHJldigpLnRoZW4oZnVuY3Rpb24odCl7dmFyIGU9bi5maW5kV2hlcmUodC5mYWN0b3JzLHtmYWN0b3JUeXBlOiJwdXNoIixwcm92aWRlcjoiT0tUQSJ9KTtyZXR1cm4gZS5lbnJvbGwoKX0pfSkudGhlbihlKTp0aGlzLm1vZGVsLnN0YXJ0VHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQudHgucmVzdW1lKCl9KS50aGVuKGZ1bmN0aW9uKCl7c2V0VGltZW91dChlKX0pfX0sYmFjazpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dC5vcHRpb25zLmFwcFN0YXRlLnVuc2V0KCJmYWN0b3JBY3RpdmF0aW9uVHlwZSIpLHQub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInByZXZMaW5rIik/dGhpcy5tb2RlbC5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnByZXYoKX0pLnRoZW4oZnVuY3Rpb24oKXt0Lm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCJzaWduaW4vZW5yb2xsIik7Cgl9KTp0Lm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCJzaWduaW4vZW5yb2xsIil9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyMDIpXSxyPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5fO3JldHVybiBlLmV4dGVuZCh7dGVtcGxhdGU6dC5IYW5kbGViYXJzLmNvbXBpbGUoJ1x0ICAgICAgPHNwYW4gY2xhc3M9Im9rdGEtZm9ybS1sYWJlbC1pbmxpbmUgby1mb3JtLWxhYmVsLWlubGluZSI+e3tjb3VudHJ5Q2FsbGluZ0NvZGV9fTwvc3Bhbj5cdCAgICAgIDxzcGFuIGNsYXNzPSJva3RhLWZvcm0taW5wdXQtZmllbGQgaW5wdXQtZml4IG8tZm9ybS1jb250cm9sIj5cdCAgICAgICAgPGlucHV0IHR5cGU9Int7dHlwZX19IiBwbGFjZWhvbGRlcj0ie3twbGFjZWhvbGRlcn19IiBuYW1lPSJ7e25hbWV9fSIgXHQgICAgICAgICAgaWQ9Int7aW5wdXRJZH19IiB2YWx1ZT0ie3t2YWx1ZX19IiBhdXRvY29tcGxldGU9Im9mZiIvPlx0ICAgICAgPC9zcGFuPlx0ICAgICcpLGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImNoYW5nZTpjb3VudHJ5Q2FsbGluZ0NvZGUiLGZ1bmN0aW9uKCl7dGhpcy4kKCIuby1mb3JtLWxhYmVsLWlubGluZSIpLnRleHQodGhpcy5tb2RlbC5nZXQoImNvdW50cnlDYWxsaW5nQ29kZSIpKX0pfSxwcmVSZW5kZXI6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuY291bnRyeUNhbGxpbmdDb2RlPXRoaXMubW9kZWwuZ2V0KCJjb3VudHJ5Q2FsbGluZ0NvZGUiKX0scG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMuJGVsLnJlbW92ZUNsYXNzKCJpbnB1dC1maXggby1mb3JtLWNvbnRyb2wiKSxpLmRlZmVyKGkuYmluZChmdW5jdGlvbigpe3RoaXMuJGVsLnBhcmVudCgpLmFkZENsYXNzKCJvLWZvcm0taW5wdXQtZ3JvdXAiKX0sdGhpcykpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNSksaSgzMDcpLGkoMTgyKSxpKDIwMiksaSgyMzEpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe2Z1bmN0aW9uIHIodCl7dmFyIGU9dC50aXRsZSxpPXQudGV4dDtyZXR1cm4hKCFlfHwhaXx8ZT09PWkpfWZ1bmN0aW9uIHModCl7cmV0dXJuIHIodCk/dDp7dGV4dDp0LnRleHR8fHR9fXJldHVybiBuLmV4dGVuZCh7dGVtcGxhdGU6ZS5jb21waWxlKCdcdCAgICAgIHt7I2lmIHBhcmFtc319XHQgICAgICAgIHt7I2lmIHBhcmFtcy5pbm5lclRvb2x0aXB9fVx0ICAgICAgICAgIDxzcGFuIGNsYXNzPSJpbnB1dC10b29sdGlwIGljb24gZm9ybS1oZWxwLTE2Ij48L3NwYW4+XHQgICAgICAgIHt7L2lmfX1cdCAgICAgICAge3sjaWYgcGFyYW1zLmljb259fVx0ICAgICAgICAgIDxzcGFuIGNsYXNzPSJpY29uIGlucHV0LWljb24ge3twYXJhbXMuaWNvbn19Ij48L3NwYW4+XHQgICAgICAgIHt7L2lmfX1cdCAgICAgIHt7L2lmfX1cdCAgICAgIDxpbnB1dCB0eXBlPSJ7e3R5cGV9fSIgcGxhY2Vob2xkZXI9Int7cGxhY2Vob2xkZXJ9fSIgYXJpYS1sYWJlbD0ie3twbGFjZWhvbGRlcn19Ilx0ICAgICAgICBuYW1lPSJ7e25hbWV9fSIgaWQ9Int7aW5wdXRJZH19IiB2YWx1ZT0ie3t2YWx1ZX19IiBhdXRvY29tcGxldGU9Im9mZiIvPlx0ICAgICcpLHBvc3RSZW5kZXI6ZnVuY3Rpb24oKXt2YXIgZSxpPXRoaXMub3B0aW9ucy5wYXJhbXM7aWYoIm51bWJlciI9PT10aGlzLm9wdGlvbnMudHlwZSl7dmFyIG49dGhpcy4kKCJpbnB1dCIpO24uYXR0cih7cGF0dGVybjoiWzAtOV0qIixpbnB1dG1vZGU6Im51bWVyaWMifSl9aSYmaS5pbm5lclRvb2x0aXAmJihlPXMoaS5pbm5lclRvb2x0aXApLHRoaXMuJCgiLmlucHV0LXRvb2x0aXAiKS5xdGlwKHtjb250ZW50OmUsc3R5bGU6e2NsYXNzZXM6Im9rdGEtc2lnbi1pbi10b29sdGlwIHF0aXAtY3VzdG9tIHF0aXAtc2hhZG93In0scG9zaXRpb246e215OiJib3R0b20gbGVmdCIsdGFyZ2V0OiJtb3VzZSIsYWRqdXN0OnttZXRob2Q6ImZsaXAiLG1vdXNlOiEwLHk6LTUseDo1fSx2aWV3cG9ydDp0KCJib2R5Iil9fSkpfSxmb2N1czpmdW5jdGlvbigpe2lmKCFpLmlzSUUoKSlyZXR1cm4gbi5wcm90b3R5cGUuZm9jdXMuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koNCksaSgyKSxpKDUpLGkoMTc3KSxpKDEzOSksaSgzNildLHI9ZnVuY3Rpb24odCxlLGksbixyLHMpe2Z1bmN0aW9uIG8odCxlKXtyZXR1cm4gcy51dGMoZSkuem9uZSgiLTA3OjAwIikuZm9ybWF0KHQpfWZ1bmN0aW9uIGEodCl7cmV0dXJuIHQmJnQucmVwbGFjZSgvXlxzK3xccyskL2csIiIpfWZ1bmN0aW9uIGwodCl7cmV0dXJuIDA9PT10LmluZGV4T2YoYyk/dDpjK3R9dmFyIGM9Ii9hc3NldHMiO3JldHVybiB0LnJlZ2lzdGVySGVscGVyKCJpMThuIixmdW5jdGlvbih0KXt2YXIgaSxyPWEodC5oYXNoLmNvZGUpLHM9YSh0Lmhhc2guYnVuZGxlKSxvPWEodC5oYXNoLmFyZ3VtZW50cyk7cmV0dXJuIG8mJihpPWUubWFwKGEobykuc3BsaXQoIjsiKSxmdW5jdGlvbih0KXt0PWEodCk7dmFyIGksbj10aGlzO3JldHVybiBlLmVhY2godC5zcGxpdCgiLiIpLGZ1bmN0aW9uKHQpe2k9aT9pW3RdOm5bdF19KSxpfSx0aGlzKSksbi5sb2NhbGl6ZShyLHMsaSl9KSx0LnJlZ2lzdGVySGVscGVyKCJ4c3JmVG9rZW5JbnB1dCIsZnVuY3Rpb24oKXtyZXR1cm4nPGlucHV0IHR5cGU9ImhpZGRlbiIgY2xhc3M9ImhpZGUiIG5hbWU9Il94c3JmVG9rZW4iIHZhbHVlPSInK2koIiNfeHNyZlRva2VuIikudGV4dCgpKyciPid9KSx0LnJlZ2lzdGVySGVscGVyKCJpbWciLGZ1bmN0aW9uKHQpe3ZhciBpPSJ1bmRlZmluZWQiIT10eXBlb2Ygb2t0YSYmb2t0YS5jZG5VcmxIb3N0bmFtZXx8IiIsbj1lLnBpY2sodC5oYXNoLFsic3JjIiwiYWx0Iiwid2lkdGgiLCJoZWlnaHQiLCJjbGFzcyIsInRpdGxlIl0pO24uc3JjPSIiK2krbChuLnNyYyk7dmFyIHI9ZS5tYXAobixmdW5jdGlvbih0LGkpe3JldHVybiBpKyc9IicrZS5lc2NhcGUodCkrJyInfSk7cmV0dXJuIjxpbWcgIityLmpvaW4oIiAiKSsiLz4ifSksdC5yZWdpc3RlckhlbHBlcigic2hvcnREYXRlIixlLnBhcnRpYWwobywiTU1NIEREIikpLHQucmVnaXN0ZXJIZWxwZXIoIm1lZGl1bURhdGUiLGUucGFydGlhbChvLCJNTU1NIERELCBZWVlZIikpLHQucmVnaXN0ZXJIZWxwZXIoImxvbmdEYXRlIixlLnBhcnRpYWwobywiTU1NTSBERCwgWVlZWSwgaDptbWEiKSksdC5yZWdpc3RlckhlbHBlcigiZm9ybWF0RGF0ZSIsbyksdC5yZWdpc3RlckhlbHBlcigibWFya2Rvd24iLGZ1bmN0aW9uKGUpe3JldHVybiByKHQsZSl9KSx0fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzUpLGkoMTgyKSxpKDMxMCksaSgzMTEpLGkoMzEyKSxpKDMxNSksaSgzMDkpLGkoMzE2KSxpKDI5OSksaSgzMTMpLGkoMzAyKSxpKDE3OCldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhLGwsYyx1LGQsaCl7ZnVuY3Rpb24gcCh0LGUpe3JldHVybiBfLmZpbmQodC5zdGF0ZUxlc3NSb3V0ZUhhbmRsZXJzLGZ1bmN0aW9uKGkpe3JldHVybiBlPT09dFtpXX0pfWZ1bmN0aW9uIGYodCxlKXtyZXR1cm4hIXQmJih0IT09b3x8ZS5nZXQoImZlYXR1cmVzLnNlY3VyaXR5SW1hZ2UiKSl9ZnVuY3Rpb24gbSh0LGUsaSxuKXt2YXIgcj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dC50cmlnZ2VyKCJsb2FkaW5nIiwhMCl9LDIwMCk7cmV0dXJuIGgubG9hZExhbmd1YWdlKHQuZ2V0KCJsYW5ndWFnZUNvZGUiKSxlLHtiYXNlVXJsOmkscmV3cml0ZTpufSkudGhlbihmdW5jdGlvbigpe2NsZWFyVGltZW91dChyKSx0LnRyaWdnZXIoImxvYWRpbmciLCExKX0pfXZhciBfPXQuXyxnPXQuJDtyZXR1cm4gdC5Sb3V0ZXIuZXh0ZW5kKHtFdmVudHM6ZS5FdmVudHMsaW5pdGlhbGl6ZTpmdW5jdGlvbihlKXt0aGlzLnNldHRpbmdzPW5ldyByKF8ub21pdChlLCJlbCIsImF1dGhDbGllbnQiKSx7cGFyc2U6ITB9KSx0aGlzLnNldHRpbmdzLnNldEF1dGhDbGllbnQoZS5hdXRoQ2xpZW50KSxlLmVsfHx0aGlzLnNldHRpbmdzLmNhbGxHbG9iYWxFcnJvcihuZXcgZC5Db25maWdFcnJvcih0LmxvYygiZXJyb3IucmVxdWlyZWQuZWwiKSkpLGcoImJvZHkgPiBkaXYiKS5vbigiY2xpY2siLGZ1bmN0aW9uKCl7fSksdGhpcy5hcHBTdGF0ZT1uZXcgbCh7YmFzZVVybDp0aGlzLnNldHRpbmdzLmdldCgiYmFzZVVybCIpLHNldHRpbmdzOnRoaXMuc2V0dGluZ3N9LHtwYXJzZTohMH0pO3ZhciBpPW5ldyBhKHthcHBTdGF0ZTp0aGlzLmFwcFN0YXRlfSk7dC4kKGUuZWwpLmFwcGVuZChpLnJlbmRlcigpLiRlbCksdGhpcy5lbD0iI29rdGEtc2lnbi1pbiIsdGhpcy5oZWFkZXI9bmV3IHMoe2VsOnRoaXMuZWwsYXBwU3RhdGU6dGhpcy5hcHBTdGF0ZSxzZXR0aW5nczp0aGlzLnNldHRpbmdzfSksdGhpcy5saXN0ZW5Ubyh0aGlzLmFwcFN0YXRlLCJjaGFuZ2U6dHJhbnNhY3Rpb25FcnJvciIsZnVuY3Rpb24odCxlKXtjLnJvdXRlQWZ0ZXJBdXRoU3RhdHVzQ2hhbmdlKHRoaXMsZSl9KSx0aGlzLmxpc3RlblRvKHRoaXMuYXBwU3RhdGUsImNoYW5nZTp0cmFuc2FjdGlvbiIsZnVuY3Rpb24odCxlKXtjLnJvdXRlQWZ0ZXJBdXRoU3RhdHVzQ2hhbmdlKHRoaXMsbnVsbCxlLmRhdGEpfSksdGhpcy5saXN0ZW5Ubyh0aGlzLmFwcFN0YXRlLCJuYXZpZ2F0ZSIsZnVuY3Rpb24odCl7dGhpcy5uYXZpZ2F0ZSh0LHt0cmlnZ2VyOiEwfSl9KX0sZXhlY3V0ZTpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuc2V0dGluZ3MuZ2V0KCJyZWNvdmVyeVRva2VuIik7aWYoaSlyZXR1cm4gdGhpcy5zZXR0aW5ncy51bnNldCgicmVjb3ZlcnlUb2tlbiIpLHZvaWQgdGhpcy5uYXZpZ2F0ZShjLmNyZWF0ZVJlY292ZXJ5VXJsKGkpLHt0cmlnZ2VyOiEwfSk7dmFyIG49dGhpcy5zZXR0aW5ncy5nZXQoInN0YXRlVG9rZW4iKTtpZihuKXJldHVybiB0aGlzLnNldHRpbmdzLnVuc2V0KCJzdGF0ZVRva2VuIiksdm9pZCB0aGlzLm5hdmlnYXRlKGMuY3JlYXRlUmVmcmVzaFVybChuKSx7dHJpZ2dlcjohMH0pO3ZhciByPXRoaXMuYXBwU3RhdGUuZ2V0KCJ0cmFuc2FjdGlvbiIpO3JldHVybiByJiZyLmRhdGF8fHAodGhpcyx0KT92b2lkIHQuYXBwbHkodGhpcyxlKTp0aGlzLnNldHRpbmdzLmdldEF1dGhDbGllbnQoKS50eC5leGlzdHMoKT92b2lkIHRoaXMubmF2aWdhdGUoYy5jcmVhdGVSZWZyZXNoVXJsKCkse3RyaWdnZXI6ITB9KTp2b2lkIHRoaXMubmF2aWdhdGUoIiIse3RyaWdnZXI6ITB9KX0sbmF2aWdhdGU6ZnVuY3Rpb24oaSxuKXtyZXR1cm4gdGhpcy5zZXR0aW5ncy5nZXQoImZlYXR1cmVzLnJvdXRlciIpP3QuUm91dGVyLnByb3RvdHlwZS5uYXZpZ2F0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk6biYmbi50cmlnZ2VyP2UuaGlzdG9yeS5sb2FkVXJsKGkpOnZvaWQgMH0scmVuZGVyOmZ1bmN0aW9uKHQsZSl7ZXx8KGU9e30pO3ZhciBpPWUuQmVhY29uLG49Xy5leHRlbmQoe3NldHRpbmdzOnRoaXMuc2V0dGluZ3MsYXBwU3RhdGU6dGhpcy5hcHBTdGF0ZX0sXy5vbWl0KGUsIkJlYWNvbiIpKTtpZih0aGlzLmhlYWRlci5yZW5kZXJlZCgpfHwodGhpcy5lbD10aGlzLmhlYWRlci5yZW5kZXIoKS5nZXRDb250ZW50RWwoKSksIWguaXNMb2FkZWQodGhpcy5hcHBTdGF0ZS5nZXQoImxhbmd1YWdlQ29kZSIpKSlyZXR1cm4gbSh0aGlzLmFwcFN0YXRlLHRoaXMuc2V0dGluZ3MuZ2V0KCJpMThuIiksdGhpcy5zZXR0aW5ncy5nZXQoImFzc2V0cy5iYXNlVXJsIiksdGhpcy5zZXR0aW5ncy5nZXQoImFzc2V0cy5yZXdyaXRlIikpLnRoZW4oXy5iaW5kKHRoaXMucmVuZGVyLHRoaXMsdCxlKSkuZG9uZSgpO3ZhciByPXRoaXMuY29udHJvbGxlcjt0aGlzLmNvbnRyb2xsZXI9bmV3IHQobiksdGhpcy5saXN0ZW5Ubyh0aGlzLmNvbnRyb2xsZXIsImFsbCIsdGhpcy50cmlnZ2VyKSx0aGlzLmNvbnRyb2xsZXIuZmV0Y2hJbml0aWFsRGF0YSgpLnRoZW4oXy5iaW5kKGZ1bmN0aW9uKCl7cmV0dXJuIGYoaSx0aGlzLnNldHRpbmdzKXx8KGk9bnVsbCksdGhpcy5oZWFkZXIuc2V0QmVhY29uKGksbiksdGhpcy5jb250cm9sbGVyLnJlbmRlcigpLHI/dS5zd2FwUGFnZXMoeyRwYXJlbnQ6dGhpcy5lbCwkb2xkUm9vdDpyLiRlbCwkbmV3Um9vdDp0aGlzLmNvbnRyb2xsZXIuJGVsLGRpcjpyLnN0YXRlLmdldCgibmF2aWdhdGVEaXIiKSxjdHg6dGhpcyxzdWNjZXNzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5hcHBTdGF0ZS5nZXQoImZsYXNoRXJyb3IiKSxlPXRoaXMuY29udHJvbGxlci5tb2RlbDtyLnJlbW92ZSgpLHIuJGVsLnJlbW92ZSgpLHRoaXMuY29udHJvbGxlci5wb3N0UmVuZGVyQW5pbWF0aW9uKCksdCYmKGUudHJpZ2dlcigiZXJyb3IiLGUse3Jlc3BvbnNlSlNPTjp7ZXJyb3JTdW1tYXJ5OnR9fSksdGhpcy5hcHBTdGF0ZS51bnNldCgiZmxhc2hFcnJvciIpKX19KToodGhpcy5lbC5hcHBlbmQodGhpcy5jb250cm9sbGVyLmVsKSx2b2lkIHRoaXMuY29udHJvbGxlci5wb3N0UmVuZGVyQW5pbWF0aW9uKCkpfSx0aGlzKSkuZmFpbChmdW5jdGlvbigpe3ImJihyLnJlbW92ZSgpLHIuJGVsLnJlbW92ZSgpKX0pLmRvbmUoKX0sc3RhcnQ6ZnVuY3Rpb24oKXt2YXIgZT0hMTt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciYmKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb3BzdGF0ZSIsXy5iaW5kKGZ1bmN0aW9uKHQpe3RoaXMuY29udHJvbGxlci5iYWNrJiYodC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdGhpcy5jb250cm9sbGVyLmJhY2soKSl9LHRoaXMpKSxlPWkuc3VwcG9ydHNQdXNoU3RhdGUoKSksdC5Sb3V0ZXIucHJvdG90eXBlLnN0YXJ0LmNhbGwodGhpcyx7cHVzaFN0YXRlOmV9KX0saGlkZTpmdW5jdGlvbigpe3RoaXMuaGVhZGVyLiRlbC5oaWRlKCl9LHNob3c6ZnVuY3Rpb24oKXt0aGlzLmhlYWRlci4kZWwuc2hvdygpfSxyZW1vdmU6ZnVuY3Rpb24oKXt0aGlzLmNvbnRyb2xsZXIucmVtb3ZlKCksdGhpcy5oZWFkZXIuJGVsLnJlbW92ZSgpLGUuaGlzdG9yeS5zdG9wKCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMildLHI9ZnVuY3Rpb24odCl7dmFyIGU9ImNhbi1yZW1vdmUtYmVhY29uIjtyZXR1cm4gdC5WaWV3LmV4dGVuZCh7Y2xhc3NOYW1lOiJhdXRoLWNvbnRhaW5lciBtYWluLWNvbnRhaW5lciIsaWQ6Im9rdGEtc2lnbi1pbiIsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJhdXRoLWNvbnRhaW5lciJ9LGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dGhpcy5saXN0ZW5Ubyh0LmFwcFN0YXRlLCJjaGFuZ2U6YmVhY29uVHlwZSIsZnVuY3Rpb24odCxpKXt0aGlzLiRlbC50b2dnbGVDbGFzcyhlLCJzZWN1cml0eSI9PT1pKX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KV0scj1mdW5jdGlvbih0LGUpe3JldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOiJyZWZyZXNoLWF1dGgtc3RhdGUiLE1vZGVsOnt9LEZvcm06e25vQnV0dG9uQmFyOiEwfSxwcmVSZW5kZXI6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMudG9rZW4sZT10aGlzLm9wdGlvbnMuYXBwU3RhdGU7dGhpcy5tb2RlbC5zdGFydFRyYW5zYWN0aW9uKGZ1bmN0aW9uKGkpe3JldHVybiB0PyhlLnRyaWdnZXIoImxvYWRpbmciLCEwKSxpLnR4LnJlc3VtZSh7c3RhdGVUb2tlbjp0fSkpOmkudHguZXhpc3RzKCk/KGUudHJpZ2dlcigibG9hZGluZyIsITApLGkudHgucmVzdW1lKCkpOnZvaWQgZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsIiIpfSl9LHJlbW92ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibG9hZGluZyIsITEpLGUucHJvdG90eXBlLnJlbW92ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyMSksaSgzMDIpLGkoMTgyKSxpKDMxKSxpKDE4MSksaSgzMDApLGkoMSldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhKXt2YXIgbD0iZW4iLGM9WyJmYWNlYm9vayIsImdvb2dsZSIsImxpbmtlZGluIiwibWljcm9zb2Z0Il0sdT1bInRva2VuIiwiaWRfdG9rZW4iLCJjb2RlIl0sZD10LnRwbCgie3tvcmlnaW59fSIpLGg9dC5fLHA9aS5Db25maWdFcnJvcixmPWkuVW5zdXBwb3J0ZWRCcm93c2VyRXJyb3IsbT10LnRwbCgiaHR0cHM6Ly9vazFzdGF0aWMub2t0YWNkbi5jb20vYXNzZXRzL2pzL3Nkay9va3RhLXNpZ25pbi13aWRnZXQve3t2ZXJzaW9ufX0iKTtyZXR1cm4gdC5Nb2RlbC5leHRlbmQoe2ZsYXQ6ITAsYXV0aENsaWVudDp2b2lkIDAsbG9jYWw6e2Jhc2VVcmw6WyJzdHJpbmciLCEwXSxyZWNvdmVyeVRva2VuOlsic3RyaW5nIiwhMSx2b2lkIDBdLHN0YXRlVG9rZW46WyJzdHJpbmciLCExLHZvaWQgMF0sdXNlcm5hbWU6WyJzdHJpbmciLCExXSxzaWduT3V0TGluazpbInN0cmluZyIsITFdLHRyYW5zZm9ybVVzZXJuYW1lOlsiZnVuY3Rpb24iLCExXSxnbG9iYWxTdWNjZXNzRm46ImZ1bmN0aW9uIixnbG9iYWxFcnJvckZuOiJmdW5jdGlvbiIscHJvY2Vzc0NyZWRzOiJmdW5jdGlvbiIsbG9nbzoic3RyaW5nIixsb2dvVGV4dDpbInN0cmluZyIsITFdLGhlbHBTdXBwb3J0TnVtYmVyOiJzdHJpbmciLCJmZWF0dXJlcy5yb3V0ZXIiOlsiYm9vbGVhbiIsITAsITFdLCJmZWF0dXJlcy5zZWN1cml0eUltYWdlIjpbImJvb2xlYW4iLCEwLCExXSwiZmVhdHVyZXMucmVtZW1iZXJNZSI6WyJib29sZWFuIiwhMCwhMF0sImZlYXR1cmVzLmF1dG9QdXNoIjpbImJvb2xlYW4iLCEwLCExXSwiZmVhdHVyZXMuc21zUmVjb3ZlcnkiOlsiYm9vbGVhbiIsITAsITFdLCJmZWF0dXJlcy5jYWxsUmVjb3ZlcnkiOlsiYm9vbGVhbiIsITAsITFdLCJmZWF0dXJlcy53aW5kb3dzVmVyaWZ5IjpbImJvb2xlYW4iLCEwLCExXSwiZmVhdHVyZXMuc2VsZlNlcnZpY2VVbmxvY2siOlsiYm9vbGVhbiIsITAsITFdLCJmZWF0dXJlcy5tdWx0aU9wdGlvbmFsRmFjdG9yRW5yb2xsIjpbImJvb2xlYW4iLCEwLCExXSwiZmVhdHVyZXMucHJldmVudEJyb3dzZXJGcm9tU2F2aW5nT2t0YVBhc3N3b3JkIjpbImJvb2xlYW4iLCEwLCEwXSwiZmVhdHVyZXMuZGV2aWNlRmluZ2VycHJpbnRpbmciOlsiYm9vbGVhbiIsITEsITFdLCJmZWF0dXJlcy5oaWRlU2lnbk91dExpbmtJbk1GQSI6WyJib29sZWFuIiwhMSwhMV0sImZlYXR1cmVzLmN1c3RvbUV4cGlyZWRQYXNzd29yZCI6WyJib29sZWFuIiwhMCwhMV0sImZlYXR1cmVzLnJlZ2lzdHJhdGlvbiI6WyJib29sZWFuIiwhMSwhMV0sbGFuZ3VhZ2U6WyJhbnkiLCExXSxpMThuOlsib2JqZWN0IiwhMV0sImFzc2V0cy5iYXNlVXJsIjpbInN0cmluZyIsITFdLCJhc3NldHMucmV3cml0ZSI6e3R5cGU6ImZ1bmN0aW9uIix2YWx1ZTpoLmlkZW50aXR5fSxhdXRoU2NoZW1lOlsic3RyaW5nIiwhMSwiT0FVVEgyIl0sImF1dGhQYXJhbXMuZGlzcGxheSI6e3R5cGU6InN0cmluZyIsdmFsdWVzOlsibm9uZSIsInBvcHVwIiwicGFnZSJdfSwiYXV0aFBhcmFtcy5yZXNwb25zZU1vZGUiOnt0eXBlOiJzdHJpbmciLHZhbHVlczpbInF1ZXJ5IiwiZnJhZ21lbnQiLCJmb3JtX3Bvc3QiLCJva3RhX3Bvc3RfbWVzc2FnZSJdfSwiYXV0aFBhcmFtcy5yZXNwb25zZVR5cGUiOlsiYW55IiwhMSwiaWRfdG9rZW4iXSwiYXV0aFBhcmFtcy5zY29wZXMiOlsiYXJyYXkiLCExXSwiYXV0aFBhcmFtcy5pc3N1ZXIiOlsic3RyaW5nIiwhMV0sImF1dGhQYXJhbXMuYXV0aG9yaXplVXJsIjpbInN0cmluZyIsITFdLCJhdXRoUGFyYW1zLnN0YXRlIjpbInN0cmluZyIsITFdLCJhdXRoUGFyYW1zLm5vbmNlIjpbInN0cmluZyIsITFdLGNsaWVudElkOiJzdHJpbmciLHJlZGlyZWN0VXJpOiJzdHJpbmciLGlkcHM6WyJhcnJheSIsITEsW11dLGlkcERpc3BsYXk6e3R5cGU6InN0cmluZyIsdmFsdWVzOlsiUFJJTUFSWSIsIlNFQ09OREFSWSJdLHZhbHVlOiJTRUNPTkRBUlkifSxvQXV0aFRpbWVvdXQ6WyJudW1iZXIiLCExXSwiaGVscExpbmtzLmhlbHAiOiJzdHJpbmciLCJoZWxwTGlua3MuZm9yZ290UGFzc3dvcmQiOiJzdHJpbmciLCJoZWxwTGlua3MudW5sb2NrIjoic3RyaW5nIiwiaGVscExpbmtzLmN1c3RvbSI6ImFycmF5IixjdXN0b21CdXR0b25zOlsiYXJyYXkiLCExLFtdXSwicmVnaXN0cmF0aW9uLmNsaWNrIjoiZnVuY3Rpb24ifSxkZXJpdmVkOntzdXBwb3J0ZWRMYW5ndWFnZXM6e2RlcHM6WyJpMThuIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIGgudW5pb24oYS5zdXBwb3J0ZWRMYW5ndWFnZXMsaC5rZXlzKHQpKX0sY2FjaGU6ITB9LGxhbmd1YWdlQ29kZTp7ZGVwczpbImxhbmd1YWdlIiwic3VwcG9ydGVkTGFuZ3VhZ2VzIl0sZm46ZnVuY3Rpb24odCxlKXt2YXIgaSxzPW4uZ2V0VXNlckxhbmd1YWdlcygpLG89aC5jbG9uZShzKSxhPXIudG9Mb3dlcihlKTtoLmlzU3RyaW5nKHQpP28udW5zaGlmdCh0KTpoLmlzRnVuY3Rpb24odCkmJm8udW5zaGlmdCh0KGUscykpLG8ucHVzaChsKSxpPXIudG9Mb3dlcihyLmV4cGFuZExhbmd1YWdlcyhvKSk7dmFyIGMsdTtmb3IoYz0wO2M8aS5sZW5ndGg7YysrKWlmKHU9YS5pbmRleE9mKGlbY10pLHU+LTEpcmV0dXJuIGVbdV19fSxvYXV0aDJFbmFibGVkOntkZXBzOlsiY2xpZW50SWQiLCJhdXRoU2NoZW1lIiwiYXV0aFBhcmFtcy5yZXNwb25zZVR5cGUiXSxmbjpmdW5jdGlvbih0LGUsaSl7aWYoIXQpcmV0dXJuITE7aWYoIm9hdXRoMiIhPT1lLnRvTG93ZXJDYXNlKCkpcmV0dXJuITE7dmFyIG49aC5pc0FycmF5KGkpP2k6W2ldO3JldHVybiBoLmludGVyc2VjdGlvbihuLHUpLmxlbmd0aD4wfSxjYWNoZTohMH0sb2F1dGhSZWRpcmVjdFVyaTp7ZGVwczpbInJlZGlyZWN0VXJpIl0sZm46ZnVuY3Rpb24odCl7aWYodClyZXR1cm4gdDt2YXIgZT13aW5kb3cubG9jYXRpb24ub3JpZ2luO2lmKCFlKXt2YXIgaT13aW5kb3cubG9jYXRpb24uaHJlZixuPXdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZTsiIiE9PW4mJihlPWkuc3Vic3RyaW5nKDAsaS5sYXN0SW5kZXhPZihuKSkpfXJldHVybiBkKHtvcmlnaW46ZX0pfX0sY29uZmlndXJlZFNvY2lhbElkcHM6e2RlcHM6WyJpZHBzIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIGguZmlsdGVyKHQsZnVuY3Rpb24odCl7cmV0dXJuIGguY29udGFpbnMoYyx0LnR5cGUudG9Mb3dlckNhc2UoKSl9KX0sY2FjaGU6ITB9LHNvY2lhbEF1dGhQb3NpdGlvblRvcDp7ZGVwczpbImNvbmZpZ3VyZWRTb2NpYWxJZHBzIiwiaWRwRGlzcGxheSJdLGZuOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIWguaXNFbXB0eSh0KSYmIlBSSU1BUlkiPT09ZS50b1VwcGVyQ2FzZSgpfSxjYWNoZTohMH0sY29uZmlndXJlZEJ1dHRvbnM6e2RlcHM6WyJjb25maWd1cmVkU29jaWFsSWRwcyIsImN1c3RvbUJ1dHRvbnMiXSxmbjpmdW5jdGlvbihlLGkpe3ZhciBuPXRoaXMscj1bXTtyZXR1cm4gaC5lYWNoKGUsZnVuY3Rpb24oZSl7dmFyIGk9ZS50eXBlLnRvTG93ZXJDYXNlKCkscz0ic29jaWFsLWF1dGgtIitpKyItYnV0dG9uIixhPXtpZDplLmlkLHR5cGU6ZS50eXBlLGRhdGFBdHRyOnMsY2xhc3NOYW1lOiJzb2NpYWwtYXV0aC1idXR0b24gIitzLHRpdGxlOmUudGl0bGU9dC5sb2MoInNvY2lhbGF1dGguIitpKyIubGFiZWwiKSxjbGljazpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksby5nZXRUb2tlbnMobix7aWRwOmUuaWR9KX19O3IucHVzaChhKX0pLGguaXNBcnJheShpKSYmaC5lYWNoKGksZnVuY3Rpb24odCl7dmFyIGU9e3RpdGxlOnQudGl0bGUsY2xhc3NOYW1lOnQuY2xhc3NOYW1lKyIgZGVmYXVsdC1jdXN0b20tYnV0dG9uIixjbGljazp0LmNsaWNrfTtyLnB1c2goZSl9KSxyfSxjYWNoZTohMH0saGFzQ29uZmlndXJlZEJ1dHRvbnM6e2RlcHM6WyJjb25maWd1cmVkQnV0dG9ucyJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiFoLmlzRW1wdHkodCl9LGNhY2hlOiEwfX0saW5pdGlhbGl6ZTpmdW5jdGlvbihlKXtlLmJhc2VVcmw/ZS5nbG9iYWxTdWNjZXNzRm4/bi5jb3JzSXNOb3RTdXBwb3J0ZWQoKSYmdGhpcy5jYWxsR2xvYmFsRXJyb3IobmV3IGYodC5sb2MoImVycm9yLnVuc3VwcG9ydGVkLmNvcnMiKSkpOnRoaXMuY2FsbEdsb2JhbEVycm9yKG5ldyBwKHQubG9jKCJlcnJvci5yZXF1aXJlZC5zdWNjZXNzIikpKTp0aGlzLmNhbGxHbG9iYWxFcnJvcihuZXcgcCh0LmxvYygiZXJyb3IucmVxdWlyZWQuYmFzZVVybCIpKSl9LHNldEF1dGhDbGllbnQ6ZnVuY3Rpb24odCl7dGhpcy5hdXRoQ2xpZW50PXR9LGdldEF1dGhDbGllbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hdXRoQ2xpZW50fSxzZXQ6ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIHQuTW9kZWwucHJvdG90eXBlLnNldC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9Y2F0Y2goZSl7dmFyIGk9ZS5tZXNzYWdlP2UubWVzc2FnZTplO3RoaXMuY2FsbEdsb2JhbEVycm9yKG5ldyBwKGkpKX19LGNhbGxHbG9iYWxTdWNjZXNzOmZ1bmN0aW9uKHQsZSl7dmFyIGk9aC5leHRlbmQoZSx7c3RhdHVzOnR9KTtoLmRlZmVyKGgucGFydGlhbCh0aGlzLmdldCgiZ2xvYmFsU3VjY2Vzc0ZuIiksaSkpfSxjYWxsR2xvYmFsRXJyb3I6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXQoImdsb2JhbEVycm9yRm4iKXx8dGhpcy5vcHRpb25zLmdsb2JhbEVycm9yRm47aWYoIWUpdGhyb3cgdDtlKHQpfSx0cmFuc2Zvcm1Vc2VybmFtZTpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuZ2V0KCJ0cmFuc2Zvcm1Vc2VybmFtZSIpO3JldHVybiBpJiZoLmlzRnVuY3Rpb24oaSk/aSh0LGUpOnR9LHByb2Nlc3NDcmVkczpmdW5jdGlvbih0KXt2YXIgaT10aGlzLmdldCgicHJvY2Vzc0NyZWRzIik7cmV0dXJuIGUuUHJvbWlzZShmdW5jdGlvbihlKXtoLmlzRnVuY3Rpb24oaSk/Mj09PWkubGVuZ3RoP2kodCxlKTooaSh0KSxlKCkpOmUoKX0pfSxwYXJzZTpmdW5jdGlvbih0KXtpZih0LmF1dGhQYXJhbXMmJnQuYXV0aFBhcmFtcy5zY29wZSYmKHMuZGVwcmVjYXRlKCdVc2UgInNjb3BlcyIgaW5zdGVhZCBvZiAic2NvcGUiJyksdC5hdXRoUGFyYW1zLnNjb3Blcz10LmF1dGhQYXJhbXMuc2NvcGUsZGVsZXRlIHQuYXV0aFBhcmFtcy5zY29wZSksdC5sYWJlbHN8fHQuY291bnRyeSl7cy5kZXByZWNhdGUoJ1VzZSAiaTE4biIgaW5zdGVhZCBvZiAibGFiZWxzIiBhbmQgImNvdW50cnkiJyk7dmFyIGU9dC5sYWJlbHN8fHt9O2guZWFjaCh0LmNvdW50cnksZnVuY3Rpb24odCxpKXtlWyJjb3VudHJ5LiIraV09dH0pLHQuaTE4bj17fSxoLmVhY2goYS5zdXBwb3J0ZWRMYW5ndWFnZXMsZnVuY3Rpb24oaSl7dC5pMThuW2ldPWV9KSxkZWxldGUgdC5sYWJlbHMsZGVsZXRlIHQuY291bnRyeX10LmFzc2V0c3x8KHQuYXNzZXRzPXt9KTt2YXIgaT10LmFzc2V0cy5iYXNlVXJsO3JldHVybiBpPyIvIj09PWlbaS5sZW5ndGgtMV0mJih0LmFzc2V0cy5iYXNlVXJsPWkuc3Vic3RyaW5nKDAsaS5sZW5ndGgtMSkpOnQuYXNzZXRzLmJhc2VVcmw9bSh7dmVyc2lvbjphLnZlcnNpb259KSx0fX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzEzKSxpKDMxNCldLHI9ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4odCl7cmV0dXJuIHQmJnQuZXF1YWxzKGkpfWZ1bmN0aW9uIHIodCl7dC5jdXJyZW50QmVhY29uJiYodC5jdXJyZW50QmVhY29uLnJlbW92ZSgpLHQuY3VycmVudEJlYWNvbj1udWxsKX1mdW5jdGlvbiBzKHQsZSxpLG4pe3QuYWRkKGUse3NlbGVjdG9yOmksb3B0aW9uczpufSksdC5jdXJyZW50QmVhY29uPXQuZmlyc3QoKX1mdW5jdGlvbiBvKHQsZSxpKXtyZXR1cm4gdHx8ZT8hdCYmaS5sb2FkaW5nPyJsb2FkIjp0JiZuKHQpP2U/InN3YXAiOiJ1bmxvYWQiOnQmJnQuZXF1YWxzKGUsaSk/InNhbWUiOiF0JiZlPyJhZGQiOnQmJiFlPyJyZW1vdmUiOnQgaW5zdGFuY2VvZiBlPyJmYWRlIjoic3dhcCI6Im5vbmUifXZhciBhPSJuby1iZWFjb24iLGw9ImJlYWNvbi1zbWFsbCBiZWFjb24tbG9hZGluZyI7cmV0dXJuIHQuVmlldy5leHRlbmQoe2N1cnJlbnRCZWFjb246bnVsbCx0ZW1wbGF0ZTonXHQgICAgICA8ZGl2IGNsYXNzPSJva3RhLXNpZ24taW4taGVhZGVyIGF1dGgtaGVhZGVyIj5cdCAgICAgICAge3sjaWYgbG9nb319XHQgICAgICAgIDxpbWcgc3JjPSJ7e2xvZ299fSIgY2xhc3M9ImF1dGgtb3JnLWxvZ28iIGFsdD0ie3tsb2dvVGV4dH19Ii8+XHQgICAgICAgIHt7L2lmfX1cdCAgICAgICAgPGRpdiBkYXRhLXR5cGU9ImJlYWNvbi1jb250YWluZXIiIGNsYXNzPSJiZWFjb24tY29udGFpbmVyIj48L2Rpdj5cdCAgICAgIDwvZGl2Plx0ICAgICAgPGRpdiBjbGFzcz0iYXV0aC1jb250ZW50Ij48ZGl2IGNsYXNzPSJhdXRoLWNvbnRlbnQtaW5uZXIiPjwvZGl2PjwvZGl2Plx0ICAgICcsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0LnNldHRpbmdzLmdldCgiZmVhdHVyZXMuc2VjdXJpdHlJbWFnZSIpfHwodGhpcy4kZWwuYWRkQ2xhc3MoYSksdGhpcy5saXN0ZW5Ubyh0LmFwcFN0YXRlLCJsb2FkaW5nIix0aGlzLnNldExvYWRpbmdCZWFjb24pLHRoaXMubGlzdGVuVG8odC5hcHBTdGF0ZSwicmVtb3ZlTG9hZGluZyIsdGhpcy5yZW1vdmVMb2FkaW5nQmVhY29uKSl9LHNldEJlYWNvbjpmdW5jdGlvbih0LGkpe3ZhciBjPSdbZGF0YS10eXBlPSJiZWFjb24tY29udGFpbmVyIl0nLHU9dGhpcy4kKGMpLGQ9byh0aGlzLmN1cnJlbnRCZWFjb24sdCxpKSxoPXRoaXM7c3dpdGNoKGQpe2Nhc2Uibm9uZSI6cmV0dXJuIHZvaWQgdGhpcy4kZWwuYWRkQ2xhc3MoYSk7Y2FzZSJzYW1lIjpyZXR1cm47Y2FzZSJhZGQiOnJldHVybiB0aGlzLiRlbC5yZW1vdmVDbGFzcyhhKSxzKHRoaXMsdCxjLGkpLGUuZXhwbG9kZSh1KTtjYXNlInJlbW92ZSI6cmV0dXJuIHRoaXMuJGVsLmFkZENsYXNzKGEpLGUuaW1wbG9kZSh1KS50aGVuKGZ1bmN0aW9uKCl7cihoKX0pLmRvbmUoKTtjYXNlImZhZGUiOmlmKCF0aGlzLmN1cnJlbnRCZWFjb24uZmFkZU91dCl0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjdXJyZW50IGJlYWNvbiBpcyBtaXNzaW5nIHRoZSAiZmFkZU91dCIgbWV0aG9kJyk7cmV0dXJuIGkuYW5pbWF0ZT0hMCx0aGlzLmN1cnJlbnRCZWFjb24uZmFkZU91dCgpLnRoZW4oZnVuY3Rpb24oKXtyKGgpLHMoaCx0LGMsaSl9KS5kb25lKCk7Y2FzZSJzd2FwIjpyZXR1cm4gZS5zd2FwQmVhY29ucyh7JGVsOnUsc3dhcDpmdW5jdGlvbigpe3ZhciBlPW4oaC5jdXJyZW50QmVhY29uKTtyKGgpLGUmJih1LnJlbW92ZUNsYXNzKGwpLGguJGVsLnJlbW92ZUNsYXNzKGEpKSxzKGgsdCxjLGkpfX0pLmRvbmUoKTtjYXNlImxvYWQiOnJldHVybiB1LmFkZENsYXNzKGwpLHMoaCx0LGMsaSksZS5leHBsb2RlKHUpO2Nhc2UidW5sb2FkIjpyZXR1cm4gdGhpcy5yZW1vdmVMb2FkaW5nQmVhY29uKCk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoJ3RoZSAiJytkKyciIGlzIG5vdCByZWNvZ25pemVkJyl9fSxzZXRMb2FkaW5nQmVhY29uOmZ1bmN0aW9uKHQpe3QmJiFuKHRoaXMuY3VycmVudEJlYWNvbikmJnRoaXMuc2V0QmVhY29uKGkse2xvYWRpbmc6ITB9KX0scmVtb3ZlTG9hZGluZ0JlYWNvbjpmdW5jdGlvbigpe3ZhciB0PXRoaXMsaT10aGlzLiQoJ1tkYXRhLXR5cGU9ImJlYWNvbi1jb250YWluZXIiXScpO3JldHVybiBlLmltcGxvZGUoaSkudGhlbihmdW5jdGlvbigpe3IodCksaS5yZW1vdmVDbGFzcyhsKX0pLmRvbmUoKX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2V0dGluZ3MudG9KU09OKHt2ZXJib3NlOiEwfSl9LGdldENvbnRlbnRFbDpmdW5jdGlvbigpe3JldHVybiB0aGlzLiQoIi5hdXRoLWNvbnRlbnQtaW5uZXIiKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIxKSxpKDMwMSldLHI9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKGUsaSxuKXt2YXIgcj10LmRlZmVyKCk7cmV0dXJuIGUuYW5pbWF0ZSh7InRleHQtaW5kZW50IjoxfSx7ZHVyYXRpb246MjAwLGVhc2luZzoic3dpbmciLHN0ZXA6ZnVuY3Rpb24odCxyKXtyLnN0YXJ0PWksci5lbmQ9bixlLmNzcygidHJhbnNmb3JtIiwic2NhbGUoIit0KyIsICIrdCsiKSIpfSxhbHdheXM6ZnVuY3Rpb24oKXtyLnJlc29sdmUoZSl9fSksci5wcm9taXNlfWZ1bmN0aW9uIG4oZSxpLG4pe3ZhciByPXQuZGVmZXIoKTtyZXR1cm4gZS5hbmltYXRlKHsidGV4dC1pbmRlbnQiOjF9LHtkdXJhdGlvbjoxNTAsZWFzaW5nOiJzd2luZyIsc3RlcDpmdW5jdGlvbih0LHIpe3Iuc3RhcnQ9aSxyLmVuZD1uLGUuY3NzKCJ0cmFuc2Zvcm0iLCJyb3RhdGUoIit0KyJkZWcpIil9LGFsd2F5czpmdW5jdGlvbigpe3IucmVzb2x2ZShlKX19KSxyLnByb21pc2V9dmFyIHI9MjAwLHM9e307cmV0dXJuIHMuc3dhcFBhZ2VzPWZ1bmN0aW9uKGkpe3ZhciBuPXQuZGVmZXIoKSxzPWkuJHBhcmVudCxvPWkuJG9sZFJvb3QsYT1pLiRuZXdSb290LGw9aS5zdWNjZXNzLGM9aS5jdHgsdT0idHJhbnNpdGlvbi1mcm9tLXJpZ2h0IjtyZXR1cm4gaS5kaXImJmkuZGlyPT09ZS5ESVJFQ1RJT05fQkFDSyYmKHU9InRyYW5zaXRpb24tZnJvbS1sZWZ0IiksYS5hZGRDbGFzcyh1KSxzLmFwcGVuZChhKSxzLmFkZENsYXNzKCJhbmltYXRpb24tY29udGFpbmVyLW92ZXJmbG93IiksYS5hbmltYXRlKHtsZWZ0OiIwcHgiLHRvcDoiMHB4IixvcGFjaXR5OjF9LHIsZnVuY3Rpb24oKXtzLnJlbW92ZUNsYXNzKCJhbmltYXRpb24tY29udGFpbmVyLW92ZXJmbG93IiksYS5yZW1vdmVDbGFzcyh1KSxhLnJlbW92ZUF0dHIoInN0eWxlIiksbC5jYWxsKGMpLG4ucmVzb2x2ZSgpfSksby5hbmltYXRlKHtoZWlnaHQ6YS5oZWlnaHQoKSxvcGFjaXR5OjB9LC44KnIpLG4ucHJvbWlzZX0scy5zd2FwQmVhY29ucz1mdW5jdGlvbih0KXt2YXIgZT10LiRlbCxpPXQuc3dhcCxuPXQuY3R4O3JldHVybiB0aGlzLmltcGxvZGUoZSkudGhlbihmdW5jdGlvbigpe3JldHVybiBpLmNhbGwobiksZX0pLnRoZW4odGhpcy5leHBsb2RlKX0scy5leHBsb2RlPWZ1bmN0aW9uKHQpe3JldHVybiBpKHQsMCwxKX0scy5pbXBsb2RlPWZ1bmN0aW9uKHQpe3JldHVybiBpKHQsMSwwKX0scy5yYWRpYWxQcm9ncmVzc0Jhcj1mdW5jdGlvbih0KXt2YXIgZT10LiRlbCxpPXQuc3dhcCxyPWUuY2hpbGRyZW4oKTtyZXR1cm4gbihyLDAsMTgwKS50aGVuKGZ1bmN0aW9uKCl7ZS5jc3Moe2NsaXA6ImF1dG8ifSl9KS50aGVuKGZ1bmN0aW9uKCl7dmFyIHQ9ci5lcSgwKTtyZXR1cm4gaSgpLG4odCwxODAsMzYwKX0pLnRoZW4oZnVuY3Rpb24oKXtlLmNzcyh7Y2xpcDoicmVjdCgwcHgsIDk2cHgsIDk2cHgsIDQ4cHgpIn0pLHIuY3NzKHt0cmFuc2Zvcm06InJvdGF0ZSgwZGVnKSIsInRleHQtaW5kZW50IjoiMXB4In0pfSl9LHN9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMildLHI9ZnVuY3Rpb24odCl7cmV0dXJuIHQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxkaXYgY2xhc3M9ImJlYWNvbi1ibGFuayIvPlx0ICAgICAgPGRpdiBjbGFzcz0iYmctaGVscGVyIGF1dGgtYmVhY29uIGF1dGgtYmVhY29uLXNlY3VyaXR5IiBkYXRhLXNlPSJsb2FkaW5nLWJlYWNvbiI+XHQgICAgICA8ZGl2IGNsYXNzPSJva3RhLXNpZ24taW4tYmVhY29uLWJvcmRlciBhdXRoLWJlYWNvbi1ib3JkZXIganMtYXV0aC1iZWFjb24tYm9yZGVyIi8+XHQgICAgICA8L2Rpdj5cdCAgICAnLGVxdWFsczpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdGhpcyBpbnN0YW5jZW9mIHR9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgzMTMpXSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSh0LGUpe3ZhciBpPWUuZ2V0KCJzZWN1cml0eUltYWdlIiksbj1lLmdldCgic2VjdXJpdHlJbWFnZURlc2NyaXB0aW9uIikscj1lLmdldCgiaXNVbmRlZmluZWRVc2VyIikscz1lLmdldCgiaXNOZXdVc2VyIiksYT0hciYmIXM7cmV0dXJuIHQuY3NzKCJiYWNrZ3JvdW5kLWltYWdlIiwiIiksdC5yZW1vdmVDbGFzcygibmV3LXVzZXIgdW5kZWZpbmVkLXVzZXIiKSxzP3ZvaWQgdC5hZGRDbGFzcygibmV3LXVzZXIiKTpyP3ZvaWQgdC5hZGRDbGFzcygidW5kZWZpbmVkLXVzZXIiKTphPyh0LnJlbW92ZUF0dHIoImFyaWEtZGVzY3JpYmVkYnkiKSx0LmZpbmQoIi5hY2Nlc3NpYmlsaXR5LXRleHQiKS50ZXh0KG4pLHZvaWQgdC5jc3MoImJhY2tncm91bmQtaW1hZ2UiLCJ1cmwoIitvLmVzY2FwZShpKSsiKSIpKTp2b2lkIDB9ZnVuY3Rpb24gbihlLGkpe2Eod2luZG93KS5vbigicmVzaXplLnNlY3VyaXR5QmVhY29uUXRpcCIsby5kZWJvdW5jZShmdW5jdGlvbigpe2UuaXMoIjp2aXNpYmxlIikmJmUucXRpcCgic2hvdyIpfSwzMDApKSxlLnF0aXAoe3ByZXJlbmRlcjohMCxjb250ZW50Ont0ZXh0OnQubG9jKCJwcmltYXJ5YXV0aC5uZXdVc2VyLnRvb2x0aXAiLCJsb2dpbiIsW28uZXNjYXBlKGkpXSksYnV0dG9uOnQubG9jKCJwcmltYXJ5YXV0aC5uZXdVc2VyLnRvb2x0aXAuY2xvc2UiLCJsb2dpbiIpfSxzdHlsZTp7Y2xhc3Nlczoib2t0YS1zZWN1cml0eS1pbWFnZS10b29sdGlwIHNlY3VyaXR5LWltYWdlLXF0aXAgcXRpcC1jdXN0b20gcXRpcC1zaGFkb3cgcXRpcC1yb3VuZGVkIix0aXA6e2hlaWdodDoxMix3aWR0aDoxNn19LHBvc2l0aW9uOntteToidG9wIGNlbnRlciIsYXQ6ImNlbnRlciIsdGFyZ2V0OmEoIi5hdXRoLWJlYWNvbi1zZWN1cml0eSIpLGFkanVzdDp7bWV0aG9kOiJmbGlwIixzY3JvbGw6ITEscmVzaXplOiEwfSxlZmZlY3Q6ITF9LGhpZGU6e2V2ZW50OiExLGZpeGVkOiEwfSxzaG93OntldmVudDohMSxkZWxheToyMDB9LGV2ZW50czp7bW92ZTpmdW5jdGlvbih0LGUpe2UuZWxlbWVudHMudGFyZ2V0LmlzKCI6dmlzaWJsZSIpfHwoZS5zZXQoImhpZGUuZWZmZWN0IiwhMSksZS5oaWRlKCksZS5zZXQoImhpZGUuZWZmZWN0IiwhMCkpfX19KSxlLnF0aXAoInRvZ2dsZSIsZS5pcygiOnZpc2libGUiKSl9ZnVuY3Rpb24gcih0KXt0LnF0aXAoImRlc3Ryb3kiKSxhKHdpbmRvdykub2ZmKCJyZXNpemUuc2VjdXJpdHlCZWFjb25RdGlwIil9ZnVuY3Rpb24gcyh0LHMsbyl7dmFyIGE9dC5maW5kKCIuYXV0aC1iZWFjb24tc2VjdXJpdHkiKSxsPXQuZmluZCgiLmpzLWF1dGgtYmVhY29uLWJvcmRlciIpLGM9IXMuZ2V0KCJpc1VuZGVmaW5lZFVzZXIiKSx1PXMuZ2V0KCJpc05ld1VzZXIiKSxkPXQuZmluZCgiLnJhZGlhbC1wcm9ncmVzcy1iYXIiKSxoPXMuZ2V0KCJiYXNlVXJsIikubWF0Y2goL2h0dHBzPzpcL1wvKC5bXlwvXSspLylbMV0scD0yMDA7cmV0dXJuIG8/KHIoYSksdm9pZChjPyhsLnJlbW92ZUNsYXNzKCJhdXRoLWJlYWNvbi1ib3JkZXIiKSxlLnJhZGlhbFByb2dyZXNzQmFyKHskZWw6ZCxzd2FwOmZ1bmN0aW9uKCl7YS5mYWRlT3V0KHAsZnVuY3Rpb24oKXtpKGEscyksYS5mYWRlSW4ocCl9KX19KS50aGVuKGZ1bmN0aW9uKCl7bC5hZGRDbGFzcygiYXV0aC1iZWFjb24tYm9yZGVyIil9KS50aGVuKGZ1bmN0aW9uKCl7dSYmbihhLGgpfSkpOmEuZmFkZU91dChwLGZ1bmN0aW9uKCl7aShhLHMpLGwucmVtb3ZlQ2xhc3MoImF1dGgtYmVhY29uLWJvcmRlciIpLGEuZmFkZUluKHApfSkpKTooaShhLHMpLHZvaWQgbC50b2dnbGVDbGFzcygiYXV0aC1iZWFjb24tYm9yZGVyIixjKSl9dmFyIG89dC5fLGE9dC4kO3JldHVybiB0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgPGRpdiBjbGFzcz0iYmVhY29uLWJsYW5rIj5cdCAgICAgIDxkaXYgY2xhc3M9InJhZGlhbC1wcm9ncmVzcy1iYXIiPlx0ICAgICAgICA8ZGl2IGNsYXNzPSJjaXJjbGUgbGVmdCI+PC9kaXY+XHQgICAgICAgIDxkaXYgY2xhc3M9ImNpcmNsZSByaWdodCI+PC9kaXY+XHQgICAgICA8L2Rpdj5cdCAgICA8L2Rpdj5cdCAgICA8ZGl2IGFyaWEtbGl2ZT0icG9saXRlIiByb2xlPSJpbWFnZSIgY2xhc3M9ImJnLWhlbHBlciBhdXRoLWJlYWNvbiBhdXRoLWJlYWNvbi1zZWN1cml0eSIgZGF0YS1zZT0ic2VjdXJpdHktYmVhY29uIj5cdCAgICAgIDxzcGFuIGNsYXNzPSJhY2Nlc3NpYmlsaXR5LXRleHQiPjwvc3Bhbj5cdCAgICAgIDxkaXYgY2xhc3M9Im9rdGEtc2lnbi1pbi1iZWFjb24tYm9yZGVyIGF1dGgtYmVhY29uLWJvcmRlciBqcy1hdXRoLWJlYWNvbi1ib3JkZXIiPlx0ICAgICAgPC9kaXY+XHQgICAgPC9kaXY+XHQgICAgJyxjbGFzc05hbWU6ImpzLXNlY3VyaXR5LWJlYWNvbiIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0aGlzLnVwZGF0ZT1vLnBhcnRpYWwocyx0aGlzLiRlbCx0LmFwcFN0YXRlKSx0aGlzLmxpc3RlblRvKHQuYXBwU3RhdGUsImNoYW5nZTpzZWN1cml0eUltYWdlIix0aGlzLnVwZGF0ZSksdGhpcy5saXN0ZW5Ubyh0LmFwcFN0YXRlLCJsb2FkaW5nIixmdW5jdGlvbih0KXt0aGlzLiRlbC50b2dnbGVDbGFzcygiYmVhY29uLWxvYWRpbmciLHQpLHRoaXMucmVtb3ZlQW50aVBoaXNoaW5nTWVzc2FnZSgpfSksdGhpcy5vcHRpb25zLmFwcFN0YXRlLnNldCgiYmVhY29uVHlwZSIsInNlY3VyaXR5IiksdGhpcy5saXN0ZW5Ubyh0LmFwcFN0YXRlLCJuYXZpZ2F0ZSIsdGhpcy5yZW1vdmVBbnRpUGhpc2hpbmdNZXNzYWdlKX0scG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMudXBkYXRlKCExKX0sZXF1YWxzOmZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0aGlzIGluc3RhbmNlb2YgdH0scmVtb3ZlQW50aVBoaXNoaW5nTWVzc2FnZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuJGVsLmZpbmQoIi5hdXRoLWJlYWNvbi1zZWN1cml0eSIpO3QucXRpcCgiZGVzdHJveSIpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjEpLGkoMzE3KSxpKDE4MiksaSgzMDIpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7ZnVuY3Rpb24gcyh0LGkpe3ZhciBuPV8oe2Jhc2VVcmw6dCx1c2VybmFtZTppfSk7cmV0dXJuIGEuaXNFbXB0eShpKXx8YS5pc1VuZGVmaW5lZChpKT9lKHtzZWN1cml0eUltYWdlOmQsc2VjdXJpdHlJbWFnZURlc2NyaXB0aW9uOmZ9KTplKGwuZ2V0KG4pKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiB0LnB3ZEltZz09PXU/e3NlY3VyaXR5SW1hZ2U6aCxzZWN1cml0eUltYWdlRGVzY3JpcHRpb246cH06e3NlY3VyaXR5SW1hZ2U6dC5wd2RJbWcsc2VjdXJpdHlJbWFnZURlc2NyaXB0aW9uOnQuaW1hZ2VEZXNjcmlwdGlvbnx8bX19KX1mdW5jdGlvbiBvKGUpe2lmKGU+NjAmJmU8PTE0NDApe3ZhciBpPWUvNjA7cmV0dXJuIHQubG9jKCJob3VycyIsImxvZ2luIixbaV0pfWlmKGU+MTQ0MCl7dmFyIG49ZS8xNDQwO3JldHVybiB0LmxvYygiZGF5cyIsImxvZ2luIixbbl0pfXJldHVybiAxPT09ZT90LmxvYygibWludXRlcy5vbmVNaW51dGUiLCJsb2dpbiIpOnQubG9jKCJtaW51dGVzIiwibG9naW4iLFtlXSl9dmFyIGE9dC5fLGw9dC4kLGM9dC5IYW5kbGViYXJzLmNvbXBpbGUsdT0iL2ltZy9zZWN1cml0eS91bmtub3duLnBuZyIsZD0iL2ltZy9zZWN1cml0eS9kZWZhdWx0LnBuZyIsaD0iL2ltZy9zZWN1cml0eS91bmtub3duLWRldmljZS5wbmciLHA9IiIsZj0iIixtPSIiLF89Yygie3tiYXNlVXJsfX0vbG9naW4vZ2V0aW1hZ2U/dXNlcm5hbWU9e3t1c2VybmFtZX19Iik7cmV0dXJuIHQuTW9kZWwuZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7aWYodGhpcy5zZXR0aW5ncy5nZXQoImZlYXR1cmVzLnNlY3VyaXR5SW1hZ2UiKSl7dmFyIGU9dGhpczt0aGlzLmxpc3RlblRvKHRoaXMsImNoYW5nZTp1c2VybmFtZSIsZnVuY3Rpb24oaSxvKXtzKHRoaXMuZ2V0KCJiYXNlVXJsIiksbykudGhlbihmdW5jdGlvbih0KXtpLnNldCgic2VjdXJpdHlJbWFnZSIsdC5zZWN1cml0eUltYWdlKSxpLnNldCgic2VjdXJpdHlJbWFnZURlc2NyaXB0aW9uIix0LnNlY3VyaXR5SW1hZ2VEZXNjcmlwdGlvbil9KS5mYWlsKGZ1bmN0aW9uKGkpe2lmKCFuLmNvcnNJc05vdEVuYWJsZWQoaSkpdGhyb3cgaTtlLnNldHRpbmdzLmNhbGxHbG9iYWxFcnJvcihuZXcgci5VbnN1cHBvcnRlZEJyb3dzZXJFcnJvcih0LmxvYygiZXJyb3IuZW5hYmxlZC5jb3JzIikpKX0pLmRvbmUoKX0pfX0sbG9jYWw6e2Jhc2VVcmw6InN0cmluZyIsbGFzdEF1dGhSZXNwb25zZTpbIm9iamVjdCIsITAse31dLHRyYW5zYWN0aW9uOiJvYmplY3QiLHRyYW5zYWN0aW9uRXJyb3I6Im9iamVjdCIsdXNlcm5hbWU6InN0cmluZyIsZmFjdG9yczoib2JqZWN0Iixwb2xpY3k6Im9iamVjdCIsc2VjdXJpdHlJbWFnZTpbInN0cmluZyIsITAsZF0sc2VjdXJpdHlJbWFnZURlc2NyaXB0aW9uOlsic3RyaW5nIiwhMCxmXSx1c2VyQ291bnRyeUNvZGU6InN0cmluZyIsdXNlclBob25lTnVtYmVyOiJzdHJpbmciLGZhY3RvckFjdGl2YXRpb25UeXBlOiJzdHJpbmciLGZsYXNoRXJyb3I6Im9iamVjdCIsYmVhY29uVHlwZToic3RyaW5nIixsYW5ndWFnZUNvZGU6WyJzdHJpbmciLCEwXX0sc2V0QXV0aFJlc3BvbnNlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXM7aWYodC5fZW1iZWRkZWQmJnQuX2VtYmVkZGVkLnBvbGljeSYmdGhpcy5zZXQoInBvbGljeSIsdC5fZW1iZWRkZWQucG9saWN5KSx0Ll9lbWJlZGRlZCYmdC5fZW1iZWRkZWQuZmFjdG9ycyl7dmFyIG49dGhpcy5zZXR0aW5ncyxyPWEubWFwKHQuX2VtYmVkZGVkLmZhY3RvcnMsZnVuY3Rpb24odCl7cmV0dXJuIHQuc2V0dGluZ3M9bix0LmFwcFN0YXRlPWUsdH0pO3RoaXMuc2V0KCJmYWN0b3JzIixuZXcgaS5Db2xsZWN0aW9uKHIse3BhcnNlOiEwfSkpfXRoaXMuc2V0KCJsYXN0QXV0aFJlc3BvbnNlIix0KX0sZGVyaXZlZDp7aXNTdWNjZXNzUmVzcG9uc2U6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIlNVQ0NFU1MiPT09dC5zdGF0dXN9fSxpc01mYVJlcXVpcmVkOntkZXBzOlsibGFzdEF1dGhSZXNwb25zZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiJNRkFfUkVRVUlSRUQiPT09dC5zdGF0dXN9fSxpc01mYUVucm9sbDp7ZGVwczpbImxhc3RBdXRoUmVzcG9uc2UiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4iTUZBX0VOUk9MTCI9PT10LnN0YXR1c319LGlzTWZhQ2hhbGxlbmdlOntkZXBzOlsibGFzdEF1dGhSZXNwb25zZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiJNRkFfQ0hBTExFTkdFIj09PXQuc3RhdHVzfX0saXNVbmF1dGhlbnRpY2F0ZWQ6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIlVOQVVUSEVOVElDQVRFRCI9PT10LnN0YXR1c319LGlzTWZhUmVqZWN0ZWRCeVVzZXI6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIlJFSkVDVEVEIj09PXQuZmFjdG9yUmVzdWx0fX0saXNNZmFUaW1lb3V0OntkZXBzOlsibGFzdEF1dGhSZXNwb25zZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiJUSU1FT1VUIj09PXQuZmFjdG9yUmVzdWx0fX0saXNNZmFFbnJvbGxBY3RpdmF0ZTp7ZGVwczpbImxhc3RBdXRoUmVzcG9uc2UiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4iTUZBX0VOUk9MTF9BQ1RJVkFURSI9PT10LnN0YXR1c319LGlzV2FpdGluZ0ZvckFjdGl2YXRpb246e2RlcHM6WyJpc01mYUVucm9sbEFjdGl2YXRlIiwibGFzdEF1dGhSZXNwb25zZSJdLGZuOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQmJiJXQUlUSU5HIj09PWUuZmFjdG9yUmVzdWx0fX0saGFzTWZhUmVxdWlyZWRPcHRpb25zOntkZXBzOlsibGFzdEF1dGhSZXNwb25zZSIsImZhY3RvcnMiXSxmbjpmdW5jdGlvbih0LGUpe3JldHVybigiTUZBX1JFUVVJUkVEIj09PXQuc3RhdHVzfHwiTUZBX0NIQUxMRU5HRSI9PT10LnN0YXR1cykmJihlJiZlLmxlbmd0aD4xKX19LHVzZXJJZDp7ZGVwczpbImxhc3RBdXRoUmVzcG9uc2UiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdC5fZW1iZWRkZWQmJnQuX2VtYmVkZGVkLnVzZXI/dC5fZW1iZWRkZWQudXNlci5pZDpudWxsfX0saXNQd2RFeHBpcmluZ1Nvb246e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIlBBU1NXT1JEX1dBUk4iPT09dC5zdGF0dXN9fSxwYXNzd29yZEV4cGlyZURheXM6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQuX2VtYmVkZGVkJiZ0Ll9lbWJlZGRlZC5wb2xpY3kmJnQuX2VtYmVkZGVkLnBvbGljeS5leHBpcmF0aW9uP3QuX2VtYmVkZGVkLnBvbGljeS5leHBpcmF0aW9uLnBhc3N3b3JkRXhwaXJlRGF5czpudWxsfX0saXNQd2RNYW5hZ2VkQnlPa3RhOntkZXBzOlsibGFzdEF1dGhSZXNwb25zZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiEodC5fbGlua3MmJnQuX2xpbmtzLm5leHQmJnQuX2xpbmtzLm5leHQudGl0bGUpfX0scGFzc3dvcmRFeHBpcmVkV2Vic2l0ZU5hbWU6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQuX2xpbmtzJiZ0Ll9saW5rcy5uZXh0JiZ0Ll9saW5rcy5uZXh0LnRpdGxlP3QuX2xpbmtzLm5leHQudGl0bGU6bnVsbH19LHBhc3N3b3JkRXhwaXJlZExpbmtVcmw6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQuX2xpbmtzJiZ0Ll9saW5rcy5uZXh0JiZ0Ll9saW5rcy5uZXh0LnRpdGxlJiZ0Ll9saW5rcy5uZXh0LmhyZWY/dC5fbGlua3MubmV4dC5ocmVmOm51bGx9fSxyZWNvdmVyeVR5cGU6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVjb3ZlcnlUeXBlfX0sZmFjdG9yVHlwZTp7ZGVwczpbImxhc3RBdXRoUmVzcG9uc2UiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdC5mYWN0b3JUeXBlfX0sZmFjdG9yOntkZXBzOlsibGFzdEF1dGhSZXNwb25zZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiB0Ll9lbWJlZGRlZCYmdC5fZW1iZWRkZWQuZmFjdG9yP3QuX2VtYmVkZGVkLmZhY3RvcjpudWxsfX0sYWN0aXZhdGVkRmFjdG9ySWQ6e2RlcHM6WyJmYWN0b3IiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdD90LmlkOm51bGx9fSxhY3RpdmF0ZWRGYWN0b3JUeXBlOntkZXBzOlsiZmFjdG9yIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQ/dC5mYWN0b3JUeXBlOm51bGx9fSxhY3RpdmF0ZWRGYWN0b3JQcm92aWRlcjp7ZGVwczpbImZhY3RvciJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiB0P3QucHJvdmlkZXI6bnVsbH19LHFyY29kZTp7ZGVwczpbImZhY3RvciJdLGZuOmZ1bmN0aW9uKHQpe3RyeXtyZXR1cm4gdC5fZW1iZWRkZWQuYWN0aXZhdGlvbi5fbGlua3MucXJjb2RlLmhyZWZ9Y2F0Y2goZSl7cmV0dXJuIG51bGx9fX0sYWN0aXZhdGlvblNlbmRMaW5rczp7ZGVwczpbImZhY3RvciJdLGZuOmZ1bmN0aW9uKHQpe3ZhciBlO3RyeXtlPXQuX2VtYmVkZGVkLmFjdGl2YXRpb24uX2xpbmtzLnNlbmR9Y2F0Y2goaSl7ZT1bXQ==", "base64"));
  res.write(new Buffer("fXJldHVybiBlfX0sdGV4dEFjdGl2YXRpb25MaW5rVXJsOntkZXBzOlsiYWN0aXZhdGlvblNlbmRMaW5rcyJdLGZuOmZ1bmN0aW9uKHQpe3ZhciBlPWEuZmluZFdoZXJlKHQse25hbWU6InNtcyJ9KTtyZXR1cm4gZT9lLmhyZWY6bnVsbH19LGVtYWlsQWN0aXZhdGlvbkxpbmtVcmw6e2RlcHM6WyJhY3RpdmF0aW9uU2VuZExpbmtzIl0sZm46ZnVuY3Rpb24odCl7dmFyIGU9YS5maW5kV2hlcmUodCx7bmFtZToiZW1haWwifSk7cmV0dXJuIGU/ZS5ocmVmOm51bGx9fSxzaGFyZWRTZWNyZXQ6e2RlcHM6WyJmYWN0b3IiXSxmbjpmdW5jdGlvbih0KXt0cnl7cmV0dXJuIHQuX2VtYmVkZGVkLmFjdGl2YXRpb24uc2hhcmVkU2VjcmV0fWNhdGNoKGUpe3JldHVybiBudWxsfX19LGR1b0Vucm9sbEFjdGl2YXRpb246e2RlcHM6WyJmYWN0b3IiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5fZW1iZWRkZWQmJnQuX2VtYmVkZGVkLmFjdGl2YXRpb24/dC5fZW1iZWRkZWQuYWN0aXZhdGlvbjpudWxsfX0scHJldkxpbms6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQuX2xpbmtzJiZ0Ll9saW5rcy5wcmV2P3QuX2xpbmtzLnByZXYuaHJlZjpudWxsfX0sdXNlcjp7ZGVwczpbImxhc3RBdXRoUmVzcG9uc2UiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdC5fZW1iZWRkZWQmJnQuX2VtYmVkZGVkLnVzZXI/dC5fZW1iZWRkZWQudXNlcjpudWxsfX0scmVjb3ZlcnlRdWVzdGlvbjp7ZGVwczpbInVzZXIiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5yZWNvdmVyeV9xdWVzdGlvbj90LnJlY292ZXJ5X3F1ZXN0aW9uLnF1ZXN0aW9uOm51bGx9fSx1c2VyUHJvZmlsZTp7ZGVwczpbInVzZXIiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5wcm9maWxlP3QucHJvZmlsZTpudWxsfX0sdXNlckVtYWlsOntkZXBzOlsidXNlclByb2ZpbGUiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5sb2dpbj90LmxvZ2luOm51bGx9fSx1c2VyRnVsbE5hbWU6e2RlcHM6WyJ1c2VyUHJvZmlsZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiB0JiYodC5maXJzdE5hbWV8fHQubGFzdE5hbWUpP3QuZmlyc3ROYW1lKyIgIit0Lmxhc3ROYW1lOiIifX0saGFzRXhpc3RpbmdQaG9uZXM6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7aWYoIXQuX2VtYmVkZGVkfHwhdC5fZW1iZWRkZWQuZmFjdG9ycylyZXR1cm4hMTt2YXIgZT10Ll9lbWJlZGRlZC5mYWN0b3JzLGk9YS5maW5kV2hlcmUoZSx7ZmFjdG9yVHlwZToic21zIixwcm92aWRlcjoiT0tUQSJ9KTtyZXR1cm4hKCFpfHwhaS5fZW1iZWRkZWQpJiYhIWkuX2VtYmVkZGVkLnBob25lcy5sZW5ndGh9fSxoYXNFeGlzdGluZ1Bob25lc0ZvckNhbGw6e2RlcHM6WyJsYXN0QXV0aFJlc3BvbnNlIl0sZm46ZnVuY3Rpb24odCl7aWYoIXQuX2VtYmVkZGVkfHwhdC5fZW1iZWRkZWQuZmFjdG9ycylyZXR1cm4hMTt2YXIgZT10Ll9lbWJlZGRlZC5mYWN0b3JzLGk9YS5maW5kV2hlcmUoZSx7ZmFjdG9yVHlwZToiY2FsbCIscHJvdmlkZXI6Ik9LVEEifSk7cmV0dXJuISghaXx8IWkuX2VtYmVkZGVkKSYmISFpLl9lbWJlZGRlZC5waG9uZXMubGVuZ3RofX0saXNVbmRlZmluZWRVc2VyOntkZXBzOlsic2VjdXJpdHlJbWFnZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiB0PT09ZH19LGlzTmV3VXNlcjp7ZGVwczpbInNlY3VyaXR5SW1hZ2UiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdD09PWh9fSxhbGxvd1JlbWVtYmVyRGV2aWNlOntkZXBzOlsicG9saWN5Il0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQuYWxsb3dSZW1lbWJlckRldmljZX19LHJlbWVtYmVyRGV2aWNlTGFiZWw6e2RlcHM6WyJwb2xpY3kiXSxmbjpmdW5jdGlvbihlKXtpZihlJiZlLnJlbWVtYmVyRGV2aWNlTGlmZXRpbWVJbk1pbnV0ZXM+MCl7dmFyIGk9byhlLnJlbWVtYmVyRGV2aWNlTGlmZXRpbWVJbk1pbnV0ZXMpO3JldHVybiB0LmxvYygicmVtZW1iZXJEZXZpY2UudGltZWJhc2VkIiwibG9naW4iLFtpXSl9cmV0dXJuIGUmJjA9PT1lLnJlbWVtYmVyRGV2aWNlTGlmZXRpbWVJbk1pbnV0ZXM/dC5sb2MoInJlbWVtYmVyRGV2aWNlLmRldmljZWJhc2VkIiwibG9naW4iKTp0LmxvYygicmVtZW1iZXJEZXZpY2UiLCJsb2dpbiIpfX0scmVtZW1iZXJEZXZpY2VCeURlZmF1bHQ6e2RlcHM6WyJwb2xpY3kiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5yZW1lbWJlckRldmljZUJ5RGVmYXVsdH19fSxwYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zZXR0aW5ncz10LnNldHRpbmdzLGEuZXh0ZW5kKGEub21pdCh0LCJzZXR0aW5ncyIpLHtsYW5ndWFnZUNvZGU6dGhpcy5zZXR0aW5ncy5nZXQoImxhbmd1YWdlQ29kZSIpfSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyMSksaSgyOTQpLGkoMjk4KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj10Ll8scz02ZTMsbz1uLmV4dGVuZCh7ZXh0cmFQcm9wZXJ0aWVzOiEwLGZsYXQ6ITEscHJvcHM6e2lkOiJzdHJpbmciLGZhY3RvclR5cGU6e3R5cGU6InN0cmluZyIsdmFsdWVzOlsic21zIiwiY2FsbCIsImVtYWlsIiwidG9rZW4iLCJ0b2tlbjpzb2Z0d2FyZTp0b3RwIiwidG9rZW46aGFyZHdhcmUiLCJxdWVzdGlvbiIsInB1c2giLCJ1MmYiXX0scHJvdmlkZXI6e3R5cGU6InN0cmluZyIsdmFsdWVzOlsiT0tUQSIsIlJTQSIsIkRFTF9PQVRIIiwiU1lNQU5URUMiLCJHT09HTEUiLCJZVUJJQ08iLCJGSURPIl19LGVucm9sbG1lbnQ6e3R5cGU6InN0cmluZyIsdmFsdWVzOlsiT1BUSU9OQUwiLCJSRVFVSVJFRCJdfSxzdGF0dXM6e3R5cGU6InN0cmluZyIsdmFsdWVzOlsiTk9UX1NFVFVQIiwiQUNUSVZFIl19LHByb2ZpbGU6WyJvYmplY3QiXSx2ZW5kb3JOYW1lOiJzdHJpbmcifSxsb2NhbDp7YW5zd2VyOiJzdHJpbmciLGJhY2t1cEZhY3Rvcjoib2JqZWN0IixzaG93QW5zd2VyOiJib29sZWFuIixyZW1lbWJlckRldmljZToiYm9vbGVhbiIsYXV0b1B1c2g6WyJib29sZWFuIiwhMCwhMV19LGRlcml2ZWQ6e2lzT2t0YUZhY3Rvcjp7ZGVwczpbInByb3ZpZGVyIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIk9LVEEiPT09dH19LGZhY3Rvck5hbWU6e2RlcHM6WyJwcm92aWRlciIsImZhY3RvclR5cGUiXSxmbjppLmdldEZhY3Rvck5hbWV9LGZhY3RvckxhYmVsOntkZXBzOlsicHJvdmlkZXIiLCJmYWN0b3JUeXBlIiwidmVuZG9yTmFtZSJdLGZuOmZ1bmN0aW9uKHQsZSxuKXtyZXR1cm4iREVMX09BVEgiPT09dD9uOmkuZ2V0RmFjdG9yTGFiZWwodCxlKX19LGZhY3RvckRlc2NyaXB0aW9uOntkZXBzOlsicHJvdmlkZXIiLCJmYWN0b3JUeXBlIl0sZm46aS5nZXRGYWN0b3JEZXNjcmlwdGlvbn0sc29ydE9yZGVyOntkZXBzOlsicHJvdmlkZXIiLCJmYWN0b3JUeXBlIl0sZm46aS5nZXRGYWN0b3JTb3J0T3JkZXJ9LGljb25DbGFzc05hbWU6e2RlcHM6WyJwcm92aWRlciIsImZhY3RvclR5cGUiXSxmbjppLmdldEZhY3Rvckljb25DbGFzc05hbWV9LHNlY3VyaXR5UXVlc3Rpb246e2RlcHM6WyJwcm9maWxlIiwiZmFjdG9yVHlwZSJdLGZuOmZ1bmN0aW9uKHQsZSl7cmV0dXJuInF1ZXN0aW9uIiE9PWU/bnVsbDp0JiZpLmdldFNlY3VyaXR5UXVlc3Rpb25MYWJlbCh0KX19LHBob25lTnVtYmVyOntkZXBzOlsicHJvZmlsZSIsImZhY3RvclR5cGUiXSxmbjpmdW5jdGlvbih0LGUpe3JldHVybiByLmNvbnRhaW5zKFsic21zIiwiY2FsbCJdLGUpP3QmJnQucGhvbmVOdW1iZXI6bnVsbH19LGVtYWlsOntkZXBzOlsicHJvZmlsZSIsImZhY3RvclR5cGUiXSxmbjpmdW5jdGlvbih0LGUpe3JldHVybiJlbWFpbCI9PT1lP3QmJnQuZW1haWw6bnVsbH19LGRldmljZU5hbWU6e2RlcHM6WyJwcm9maWxlIiwiZmFjdG9yVHlwZSJdLGZuOmZ1bmN0aW9uKHQsZSl7cmV0dXJuInB1c2giIT09ZT9udWxsOnQmJnQubmFtZX19LGVucm9sbGVkOntkZXBzOlsic3RhdHVzIl0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIkFDVElWRSI9PT10fX0scmVxdWlyZWQ6e2RlcHM6WyJlbnJvbGxtZW50Il0sZm46ZnVuY3Rpb24odCl7cmV0dXJuIlJFUVVJUkVEIj09PXR9fSxjYW5Vc2VSZXNlbmQ6e2RlcHM6WyJwcm92aWRlciIsImZhY3RvclR5cGUiXSxmbjpmdW5jdGlvbih0LGUpe3JldHVybiJPS1RBIj09PXQmJnIuY29udGFpbnMoWyJwdXNoIiwic21zIiwiY2FsbCIsImVtYWlsIl0sZSl9fSxpc1NNU0NhbGxvckVtYWlsOntkZXBzOlsiZmFjdG9yVHlwZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiByLmNvbnRhaW5zKFsic21zIiwiY2FsbCIsImVtYWlsIl0sdCl9fX0scGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0dGluZ3M9dC5zZXR0aW5ncyx0aGlzLmFwcFN0YXRlPXQuYXBwU3RhdGUsdC5yZW1lbWJlckRldmljZT1pLmdldFJlbWVtYmVyRGV2aWNlVmFsdWUodGhpcy5hcHBTdGF0ZSksci5vbWl0KHQsWyJzZXR0aW5ncyIsImFwcFN0YXRlIl0pfSx2YWxpZGF0ZTpmdW5jdGlvbigpe2lmKHRoaXMuZ2V0KCJpc1NNU0NhbGxvckVtYWlsIikmJiF0aGlzLmdldCgiYW5zd2VyIikpcmV0dXJue2Fuc3dlcjp0LmxvYygibW9kZWwudmFsaWRhdGlvbi5maWVsZC5ibGFuayIpfX0sc2F2ZTpmdW5jdGlvbigpe3ZhciB0PSEhdGhpcy5nZXQoInJlbWVtYmVyRGV2aWNlIik7cmV0dXJuIHRoaXMuZG9UcmFuc2FjdGlvbihmdW5jdGlvbihpKXt2YXIgbj17cmVtZW1iZXJEZXZpY2U6dH07InF1ZXN0aW9uIj09PXRoaXMuZ2V0KCJmYWN0b3JUeXBlIik/bi5hbnN3ZXI9dGhpcy5nZXQoImFuc3dlciIpOm4ucGFzc0NvZGU9dGhpcy5nZXQoImFuc3dlciIpO3ZhciBvO2lmKCJNRkFfUkVRVUlSRUQiPT09aS5zdGF0dXMpe3ZhciBhPXIuZmluZFdoZXJlKGkuZmFjdG9ycyx7aWQ6dGhpcy5nZXQoImlkIil9KTtvPWEudmVyaWZ5KG4pfWVsc2UgaWYodGhpcy5nZXQoImNhblVzZVJlc2VuZCIpJiYhdGhpcy5nZXQoImFuc3dlciIpJiZpLnJlc2VuZCl7dmFyIGw9aS5kYXRhLl9saW5rcy5yZXNlbmRbMF07bz1pLnJlc2VuZChsLm5hbWUpfWVsc2Ugbz1pLnZlcmlmeShuKTtyZXR1cm4gdGhpcy50cmlnZ2VyKCJzYXZlIiksby50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiJNRkFfQ0hBTExFTkdFIj09PXQuc3RhdHVzJiZ0LnBvbGw/ZS5kZWxheShzKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHQucG9sbChzKX0pOnR9KS5mYWlsKGZ1bmN0aW9uKHQpe3Rocm93IHR9KX0pfX0pLGE9dC5Db2xsZWN0aW9uLmV4dGVuZCh7bW9kZWw6byxjb21wYXJhdG9yOiJzb3J0T3JkZXIiLHBhcnNlOmZ1bmN0aW9uKHQpe3RoaXMubGFzdFVzZWRGYWN0b3I9dFswXTt2YXIgZT1yLmZpbmRXaGVyZSh0LHtwcm92aWRlcjoiT0tUQSIsZmFjdG9yVHlwZToicHVzaCJ9KTtpZighZSlyZXR1cm4gdDt2YXIgaT1yLmZpbmRXaGVyZSh0LHtwcm92aWRlcjoiT0tUQSIsZmFjdG9yVHlwZToidG9rZW46c29mdHdhcmU6dG90cCJ9KSxuPWk9PT10WzBdLHM9ci5yZWR1Y2UodCxmdW5jdGlvbih0LG4pe3ZhciByPSJPS1RBIj09PW4ucHJvdmlkZXIscz1yJiYidG9rZW46c29mdHdhcmU6dG90cCI9PT1uLmZhY3RvclR5cGUsYT1yJiYicHVzaCI9PT1uLmZhY3RvclR5cGUsbD0iQUNUSVZFIiE9PW4uc3RhdHVzLGM9cyYmKGx8fCJBQ1RJVkUiPT09ZS5zdGF0dXMpLHU9YSYmbCYmIkFDVElWRSI9PT1pLnN0YXR1cztyZXR1cm4gY3x8dT90OihhJiYobi5iYWNrdXBGYWN0b3I9bmV3IG8oaSx7cGFyc2U6ITB9KSksdC5wdXNoKG4pLHQpfSxbXSk7cmV0dXJuIG4mJih0aGlzLmxhc3RVc2VkRmFjdG9yPWUpLHN9LGdldERlZmF1bHRGYWN0b3I6ZnVuY3Rpb24oKXt2YXIgdD1yLnBpY2sodGhpcy5sYXN0VXNlZEZhY3RvciwiZmFjdG9yVHlwZSIsInByb3ZpZGVyIik7cmV0dXJuIHRoaXMuZmluZFdoZXJlKHQpfSxnZXRGaXJzdFVuZW5yb2xsZWRSZXF1aXJlZEZhY3RvcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmZpbmRXaGVyZSh7cmVxdWlyZWQ6ITAsZW5yb2xsZWQ6ITF9KX19KTtyZXR1cm57TW9kZWw6byxDb2xsZWN0aW9uOmF9fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzE5KSxpKDIxKSxpKDI5NCksaSgyOTUpLGkoMzAxKSxpKDI5NiksaSgzMjApXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSl7dmFyIGw9dC4kLGM9dC5fO3JldHVybiByLmV4dGVuZCh7Y2xhc3NOYW1lOiJtZmEtdmVyaWZ5LWR1byBkdW8tZm9ybSIsTW9kZWw6e3Byb3BzOntob3N0OiJzdHJpbmciLHNpZ25hdHVyZToic3RyaW5nIixwb3N0QWN0aW9uOiJzdHJpbmciLGZhY3RvcklkOiJzdHJpbmciLHN0YXRlVG9rZW46InN0cmluZyIscmVtZW1iZXJEZXZpY2U6ImJvb2xlYW4ifSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dmFyIHQ9bi5nZXRSZW1lbWJlckRldmljZVZhbHVlKHRoaXMuYXBwU3RhdGUpO3RoaXMuc2V0KCJyZW1lbWJlckRldmljZSIsdCk7Cgl9LGdldEluaXRPcHRpb25zOmZ1bmN0aW9uKCl7dmFyIHQ9ISF0aGlzLmdldCgicmVtZW1iZXJEZXZpY2UiKTtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpe3ZhciBpPXtyZW1lbWJlckRldmljZTp0fSxuPWMuZmluZFdoZXJlKGUuZmFjdG9ycyx7cHJvdmlkZXI6IkRVTyIsZmFjdG9yVHlwZToid2ViIn0pO3JldHVybiBuLnZlcmlmeShpKS5mYWlsKGZ1bmN0aW9uKHQpe3Rocm93IHR9KX0pfSx2ZXJpZnk6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXQoInBvc3RBY3Rpb24iKSxuPXRoaXMuZ2V0KCJmYWN0b3JJZCIpLHI9dGhpcyxzPXtpZDpuLHN0YXRlVG9rZW46dGhpcy5nZXQoInN0YXRlVG9rZW4iKSxzaWdfcmVzcG9uc2U6dH0sbz10aGlzLmdldCgicmVtZW1iZXJEZXZpY2UiKTtyZXR1cm4gaShsLnBvc3QoZSxzKSkudGhlbihmdW5jdGlvbigpe3JldHVybiByLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIG8mJihlPXtyZW1lbWJlckRldmljZTpvfSksdC5wb2xsKGUpfSl9KS5mYWlsKGZ1bmN0aW9uKHQpe3IudHJpZ2dlcigiZXJyb3IiLHIsdC54aHIpfSl9fSxGb3JtOnthdXRvU2F2ZTohMCxub0J1dHRvbkJhcjohMCx0aXRsZTpjLnBhcnRpYWwodC5sb2MsImZhY3Rvci5kdW8iKSxhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ImZhY3Rvci1kdW8ifSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5hZGQoJzxpZnJhbWUgZnJhbWVib3JkZXI9IjAiIHRpdGxlPSInK3RoaXMudGl0bGUoKSsnIj48L2lmcmFtZT4nKSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhbGxvd1JlbWVtYmVyRGV2aWNlIikmJnRoaXMuYWRkSW5wdXQoe2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInJlbWVtYmVyRGV2aWNlTGFiZWwiKSxjbGFzc05hbWU6Im1hcmdpbi1idG0tMCIsbmFtZToicmVtZW1iZXJEZXZpY2UiLHR5cGU6ImNoZWNrYm94In0pLGUuaW5pdCh7aG9zdDp0aGlzLm1vZGVsLmdldCgiaG9zdCIpLHNpZ19yZXF1ZXN0OnRoaXMubW9kZWwuZ2V0KCJzaWduYXR1cmUiKSxpZnJhbWU6dGhpcy4kKCJpZnJhbWUiKS5nZXQoMCkscG9zdF9hY3Rpb246Yy5iaW5kKHRoaXMubW9kZWwudmVyaWZ5LHRoaXMubW9kZWwpfSl9fSxGb290ZXI6YSxmZXRjaEluaXRpYWxEYXRhOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcztyZXR1cm4gdGhpcy5tb2RlbC5nZXRJbml0T3B0aW9ucygpLnRoZW4oZnVuY3Rpb24oZSl7dmFyIGk9ZS5kYXRhO2lmKCEoaS5fZW1iZWRkZWQmJmkuX2VtYmVkZGVkLmZhY3RvciYmaS5fZW1iZWRkZWQuZmFjdG9yLl9lbWJlZGRlZCYmaS5fZW1iZWRkZWQuZmFjdG9yLl9lbWJlZGRlZC52ZXJpZmljYXRpb24pKXRocm93IG5ldyBFcnJvcigiUmVzcG9uc2UgZG9lcyBub3QgaGF2ZSBkdW8gdmVyaWZpY2F0aW9uIG9wdGlvbnMiKTt2YXIgbj1pLl9lbWJlZGRlZC5mYWN0b3IuX2VtYmVkZGVkLnZlcmlmaWNhdGlvbjt0Lm1vZGVsLnNldCh7aG9zdDpuLmhvc3Qsc2lnbmF0dXJlOm4uc2lnbmF0dXJlLHBvc3RBY3Rpb246bi5fbGlua3MuY29tcGxldGUuaHJlZixmYWN0b3JJZDppLl9lbWJlZGRlZC5mYWN0b3IuaWQsc3RhdGVUb2tlbjppLnN0YXRlVG9rZW59KX0pfSx0cmFwQXV0aFJlc3BvbnNlOmZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFDaGFsbGVuZ2UiKSlyZXR1cm4hMH0sYmFjazpmdW5jdGlvbigpe319KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG47bj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXt0aHJvdyBuZXcgRXJyb3IoIkR1byBXZWIgU0RLIGVycm9yOiAiK3QrKGU/IlxuU2VlICIrZSsiIGZvciBtb3JlIGluZm9ybWF0aW9uIjoiIikpfWZ1bmN0aW9uIGUodCl7cmV0dXJuIHQucmVwbGFjZSgvKFthLXpdKShbQS1aXSkvLCIkMS0kMiIpLnRvTG93ZXJDYXNlKCl9ZnVuY3Rpb24gaSh0LGkpe3JldHVybiJkYXRhc2V0ImluIHQ/dC5kYXRhc2V0W2ldOnQuZ2V0QXR0cmlidXRlKCJkYXRhLSIrZShpKSl9ZnVuY3Rpb24gbih0LGUsaSxuKXsiYWRkRXZlbnRMaXN0ZW5lciJpbiB3aW5kb3c/dC5hZGRFdmVudExpc3RlbmVyKGUsbiwhMSk6dC5hdHRhY2hFdmVudChpLG4pfWZ1bmN0aW9uIHIodCxlLGksbil7InJlbW92ZUV2ZW50TGlzdGVuZXIiaW4gd2luZG93P3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLG4sITEpOnQuZGV0YWNoRXZlbnQoaSxuKX1mdW5jdGlvbiBzKHQpe24oZG9jdW1lbnQsIkRPTUNvbnRlbnRMb2FkZWQiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLHQpfWZ1bmN0aW9uIG8odCl7cihkb2N1bWVudCwiRE9NQ29udGVudExvYWRlZCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsdCl9ZnVuY3Rpb24gYSh0KXtuKHdpbmRvdywibWVzc2FnZSIsIm9ubWVzc2FnZSIsdCl9ZnVuY3Rpb24gbCh0KXtyKHdpbmRvdywibWVzc2FnZSIsIm9ubWVzc2FnZSIsdCl9ZnVuY3Rpb24gYyhlKXtpZihlKXswPT09ZS5pbmRleE9mKCJFUlJ8IikmJnQoZS5zcGxpdCgifCIpWzFdKSxlLmluZGV4T2YoIjoiKSE9PS0xJiYyPT09ZS5zcGxpdCgiOiIpLmxlbmd0aHx8dCgiRHVvIHdhcyBnaXZlbiBhIGJhZCB0b2tlbi4gIFRoaXMgbWlnaHQgaW5kaWNhdGUgYSBjb25maWd1cmF0aW9uIHByb2JsZW0gd2l0aCBvbmUgb2YgRHVvJ3MgY2xpZW50IGxpYnJhcmllcy4iLCJodHRwczovL3d3dy5kdW9zZWN1cml0eS5jb20vZG9jcy9kdW93ZWIjZmlyc3Qtc3RlcHMiKTt2YXIgaT1lLnNwbGl0KCI6Iik7cmV0dXJuIGc9ZSx2PWlbMF0seT1pWzFdLHtzaWdSZXF1ZXN0OmUsZHVvU2lnOmlbMF0sYXBwU2lnOmlbMV19fX1mdW5jdGlvbiB1KCl7aWYoYj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChrKSwhYil0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgcGFnZSBkb2VzIG5vdCBjb250YWluIGFuIGlmcmFtZSBmb3IgRHVvIHRvIHVzZS5BZGQgYW4gZWxlbWVudCBsaWtlIDxpZnJhbWUgaWQ9ImR1b19pZnJhbWUiPjwvaWZyYW1lPiB0byB0aGlzIHBhZ2UuICBTZWUgaHR0cHM6Ly93d3cuZHVvc2VjdXJpdHkuY29tL2RvY3MvZHVvd2ViIzMuLXNob3ctdGhlLWlmcmFtZSBmb3IgbW9yZSBpbmZvcm1hdGlvbi4nKTtmKCksbyh1KX1mdW5jdGlvbiBkKHQpe3JldHVybiBCb29sZWFuKHQub3JpZ2luPT09Imh0dHBzOi8vIitfJiYic3RyaW5nIj09dHlwZW9mIHQuZGF0YSYmKHQuZGF0YS5tYXRjaCh3KXx8dC5kYXRhLm1hdGNoKE0pKSl9ZnVuY3Rpb24gaCh0KXt0JiYodC5ob3N0JiYoXz10Lmhvc3QpLHQuc2lnX3JlcXVlc3QmJmModC5zaWdfcmVxdWVzdCksdC5wb3N0X2FjdGlvbiYmKFQ9dC5wb3N0X2FjdGlvbiksdC5wb3N0X2FyZ3VtZW50JiYoUz10LnBvc3RfYXJndW1lbnQpLHQuaWZyYW1lJiYoInRhZ05hbWUiaW4gdC5pZnJhbWU/Yj10LmlmcmFtZToic3RyaW5nIj09dHlwZW9mIHQuaWZyYW1lJiYoaz10LmlmcmFtZSkpKSxiP2YoKTooYj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChrKSxiP2YoKTpzKHUpKSxvKGgpfWZ1bmN0aW9uIHAodCl7ZCh0KSYmKG0odC5kYXRhKSxsKHApKX1mdW5jdGlvbiBmKCl7X3x8KF89aShiLCJob3N0IiksX3x8dCgiTm8gQVBJIGhvc3RuYW1lIGlzIGdpdmVuIGZvciBEdW8gdG8gdXNlLiAgQmUgc3VyZSB0byBwYXNzIGEgYGhvc3RgIHBhcmFtZXRlciB0byBEdW8uaW5pdCwgb3IgdGhyb3VnaCB0aGUgYGRhdGEtaG9zdGAgYXR0cmlidXRlIG9uIHRoZSBpZnJhbWUgZWxlbWVudC4iLCJodHRwczovL3d3dy5kdW9zZWN1cml0eS5jb20vZG9jcy9kdW93ZWIjMy4tc2hvdy10aGUtaWZyYW1lIikpLHYmJnl8fChjKGkoYiwic2lnUmVxdWVzdCIpKSx2JiZ5fHx0KCJObyB2YWxpZCBzaWduZWQgcmVxdWVzdCBpcyBnaXZlbi4gIEJlIHN1cmUgdG8gZ2l2ZSB0aGUgYHNpZ19yZXF1ZXN0YCBwYXJhbWV0ZXIgdG8gRHVvLmluaXQsIG9yIHVzZSB0aGUgYGRhdGEtc2lnLXJlcXVlc3RgIGF0dHJpYnV0ZSBvbiB0aGUgaWZyYW1lIGVsZW1lbnQuIiwiaHR0cHM6Ly93d3cuZHVvc2VjdXJpdHkuY29tL2RvY3MvZHVvd2ViIzMuLXNob3ctdGhlLWlmcmFtZSIpKSwiIj09PVQmJihUPWkoYiwicG9zdEFjdGlvbiIpfHxUKSwic2lnX3Jlc3BvbnNlIj09PVMmJihTPWkoYiwicG9zdEFyZ3VtZW50Iil8fFMpLGIuc3JjPVsiaHR0cHM6Ly8iLF8sIi9mcmFtZS93ZWIvdjEvYXV0aD90eD0iLHYsIiZwYXJlbnQ9Iixkb2N1bWVudC5sb2NhdGlvbi5ocmVmXS5qb2luKCIiKSxhKHApfWZ1bmN0aW9uIG0odCl7VCh0KyI6Iit5KX12YXIgXyxnLHYseSxiLHc9L14oPzpBVVRIfEVOUk9MTCkrXHxbQS1aYS16MC05XCtcLz1dK1x8W0EtWmEtejAtOVwrXC89XSskLyxNPS9eRVJSXHxbXHdcc1wuXChcKV0rJC8saz0iZHVvX2lmcmFtZSIsVD0iIixTPSJzaWdfcmVzcG9uc2UiO3JldHVybiBzKGgpLHtpbml0OmgsX3BhcnNlU2lnUmVxdWVzdDpjLF9pc0R1b01lc3NhZ2U6ZH19LmNhbGwoZSxpLGUsdCksLyoqCgkJICogRHVvIFdlYiBTREsgdjIKCQkgKiBDb3B5cmlnaHQgMjAxNSwgRHVvIFNlY3VyaXR5CgkJICovCgkhKHZvaWQgMCE9PW4mJih0LmV4cG9ydHM9bikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDMwMSksaSgxOTApXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Ll87cmV0dXJuIHQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIHt7bGlua0NsYXNzTmFtZX19IiBkYXRhLXNlPSJzaWdub3V0LWxpbmsiPlx0ICAgICAgICB7e2xpbmtUZXh0fX1cdCAgICAgIDwvYT5cdCAgICAnLGNsYXNzTmFtZToiYXV0aC1mb290ZXIgY2xlYXJmaXgiLGV2ZW50czp7ImNsaWNrIGEiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKTt2YXIgbj10aGlzO3RoaXMubW9kZWwuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdC5jYW5jZWwoKX0pLnRoZW4oZnVuY3Rpb24oKXtuLnNldHRpbmdzLmdldCgic2lnbk91dExpbmsiKT9pLnJlZGlyZWN0KG4uc2V0dGluZ3MuZ2V0KCJzaWduT3V0TGluayIpKToobi5zdGF0ZS5zZXQoIm5hdmlnYXRlRGlyIixlLkRJUkVDVElPTl9CQUNLKSxuLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCIiKSl9KX19LGdldFRlbXBsYXRlRGF0YTpmdW5jdGlvbigpe3JldHVybntsaW5rQ2xhc3NOYW1lOm4uaXNVbmRlZmluZWQodGhpcy5vcHRpb25zLmxpbmtDbGFzc05hbWUpPyJnb3RvIjp0aGlzLm9wdGlvbnMubGlua0NsYXNzTmFtZSxsaW5rVGV4dDp0aGlzLm9wdGlvbnMubGlua1RleHR8fHQubG9jKCJzaWdub3V0IiwibG9naW4iKX19fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyMTApLGkoMjk3KSxpKDMyNCksaSgzMjcpLGkoMzI4KSxpKDMyMiksaSgzMjkpLGkoMzMwKSxpKDMzMSksaSgzMjApXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSxsLGMsdSl7cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6Im1mYS12ZXJpZnkiLGluaXRpYWxpemU6ZnVuY3Rpb24oaSl7dmFyIG4sZD1pLmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpLGg9aS5mYWN0b3JUeXBlLHA9aS5wcm92aWRlcjtzd2l0Y2goaCl7Y2FzZSJxdWVzdGlvbiI6bj1vO2JyZWFrO2Nhc2Uic21zIjpjYXNlImNhbGwiOmNhc2UiZW1haWwiOm49YTticmVhaztjYXNlInRva2VuIjpjYXNlInRva2VuOnNvZnR3YXJlOnRvdHAiOm49cjticmVhaztjYXNlInRva2VuOmhhcmR3YXJlIjpuPXM7YnJlYWs7Y2FzZSJwdXNoIjpuPWw7YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoIlVucmVjb2duaXplZCBmYWN0b3IgdHlwZSIpfWlmKHRoaXMubW9kZWw9ZC5maW5kV2hlcmUoe3Byb3ZpZGVyOnAsZmFjdG9yVHlwZTpofSksIXRoaXMubW9kZWwpdGhyb3cgbmV3IEVycm9yKCJVbnJlY29nbml6ZWQgZmFjdG9yL3Byb3ZpZGVyIik7dGhpcy5hZGRMaXN0ZW5lcnMoKSx0aGlzLmFkZChuZXcgbih0aGlzLnRvSlNPTigpKSksInB1c2giPT09aCYmdGhpcy5tb2RlbC5nZXQoImlzT2t0YUZhY3RvciIpJiYodGhpcy5hZGQoYyx7b3B0aW9uczp7bW9kZWw6dGhpcy5tb2RlbC5nZXQoImJhY2t1cEZhY3RvciIpfX0pLHRoaXMuc2V0dGluZ3MuZ2V0KCJmZWF0dXJlcy5hdXRvUHVzaCIpJiZ0aGlzLmFkZChlLHtvcHRpb25zOnttb2RlbDp0aGlzLm1vZGVsLG5hbWU6ImF1dG9QdXNoIixwbGFjZWhvbGRlcjp0LmxvYygiYXV0b1B1c2giLCJsb2dpbiIpLGxhYmVsOiExLCJsYWJlbC10b3AiOiExLGNsYXNzTmFtZToibWFyZ2luLWJ0bS0wIn19KSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhbGxvd1JlbWVtYmVyRGV2aWNlIikmJnRoaXMuYWRkKGUse29wdGlvbnM6e21vZGVsOnRoaXMubW9kZWwsbmFtZToicmVtZW1iZXJEZXZpY2UiLHBsYWNlaG9sZGVyOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInJlbWVtYmVyRGV2aWNlTGFiZWwiKSxsYWJlbDohMSwibGFiZWwtdG9wIjohMCxjbGFzc05hbWU6Im1hcmdpbi1idG0tMCJ9fSksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJjaGFuZ2U6cmVtZW1iZXJEZXZpY2UiLGZ1bmN0aW9uKHQsZSl7dC5nZXQoImJhY2t1cEZhY3RvciIpLnNldCgicmVtZW1iZXJEZXZpY2UiLGUpfSkpLHRoaXMuc2V0dGluZ3MuZ2V0KCJmZWF0dXJlcy5oaWRlU2lnbk91dExpbmtJbk1GQSIpfHx0aGlzLmFkZChuZXcgdSh0aGlzLnRvSlNPTigpKSl9LHRyYXBBdXRoUmVzcG9uc2U6ZnVuY3Rpb24oKXtyZXR1cm4hKCF0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc01mYUNoYWxsZW5nZSIpJiYhdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFSZXF1aXJlZCIpKXx8KCJwdXNoIj09dGhpcy5vcHRpb25zLmZhY3RvclR5cGUmJih0aGlzLnNldHRpbmdzLmdldCgiZmVhdHVyZXMuYXV0b1B1c2giKSYmdGhpcy5tb2RlbC5nZXQoImF1dG9QdXNoIik/bi5zZXRBdXRvUHVzaENvb2tpZSh0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJ1c2VySWQiKSk6bi5yZW1vdmVBdXRvUHVzaENvb2tpZSh0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJ1c2VySWQiKSkpLCExKX0sYmFjazpmdW5jdGlvbigpe319KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDMyMyldLHI9ZnVuY3Rpb24odCxlKXt2YXIgaT10Ll87cmV0dXJuIHQuRm9ybS5leHRlbmQoe2NsYXNzTmFtZToibWZhLXZlcmlmeS1xdWVzdGlvbiIsYXV0b1NhdmU6ITAsbm9DYW5jZWxCdXR0b246ITAsc2F2ZTppLnBhcnRpYWwodC5sb2MsIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKSxzY3JvbGxPbkVycm9yOiExLGxheW91dDoiby1mb3JtLXRoZW1lIixhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ImZhY3Rvci1xdWVzdGlvbiJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLnRpdGxlPXRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpLHRoaXMuYWRkSW5wdXQoe2xhYmVsOnRoaXMubW9kZWwuZ2V0KCJzZWN1cml0eVF1ZXN0aW9uIiksImxhYmVsLXRvcCI6ITAscGxhY2Vob2xkZXI6dC5sb2MoIm1mYS5jaGFsbGVuZ2UuYW5zd2VyLnBsYWNlaG9sZGVyIiwibG9naW4iKSxjbGFzc05hbWU6ImF1dGgtcGFzc2NvZGUiLG5hbWU6ImFuc3dlciIsdHlwZToicGFzc3dvcmQiLGlucHV0OmV9KSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhbGxvd1JlbWVtYmVyRGV2aWNlIikmJnRoaXMuYWRkSW5wdXQoe2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInJlbWVtYmVyRGV2aWNlTGFiZWwiKSxjbGFzc05hbWU6Im1hcmdpbi1idG0tMCIsbmFtZToicmVtZW1iZXJEZXZpY2UiLHR5cGU6ImNoZWNrYm94In0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzA2KV0scj1mdW5jdGlvbih0LGUpe3JldHVybiBlLmV4dGVuZCh7dGVtcGxhdGU6dC50cGwoJ1x0ICAgICAgPGlucHV0IHR5cGU9InBhc3N3b3JkIiBwbGFjZWhvbGRlcj0ie3twbGFjZWhvbGRlcn19IiBuYW1lPSJ7e25hbWV9fSIgaWQ9Int7aW5wdXRJZH19IiB2YWx1ZT0ie3t2YWx1ZX19Ii8+XHQgICAgICA8c3BhbiBjbGFzcz0icGFzc3dvcmQtdG9nZ2xlIj5cdCAgICAgICAgPHNwYW4gY2xhc3M9ImJ1dHRvbiBidXR0b24tZGFyayBidXR0b24tc2hvdyI+XHQgICAgICAgICAge3tpMThuIGNvZGU9Im1mYS5jaGFsbGVuZ2UuYW5zd2VyLnNob3dBbnN3ZXIiIGJ1bmRsZT0ibG9naW4ifX08L3NwYW4+XHQgICAgICAgIDxzcGFuIGNsYXNzPSJidXR0b24gYnV0dG9uLWhpZGUiPnt7aTE4biBjb2RlPSJtZmEuY2hhbGxlbmdlLmFuc3dlci5oaWRlQW5zd2VyIiBidW5kbGU9ImxvZ2luIn19PC9zcGFuPlx0ICAgICAgPC9zcGFuPicpLGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLmV2ZW50c1siY2xpY2sgLnBhc3N3b3JkLXRvZ2dsZSAuYnV0dG9uLXNob3ciXT0iX3Nob3dQYXNzd29yZCIsdGhpcy5ldmVudHNbImNsaWNrIC5wYXNzd29yZC10b2dnbGUgLmJ1dHRvbi1oaWRlIl09Il9oaWRlUGFzc3dvcmQiLHRoaXMuZGVsZWdhdGVFdmVudHMoKX0sY2hhbmdlVHlwZTpmdW5jdGlvbih0KXtlLnByb3RvdHlwZS5jaGFuZ2VUeXBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLiQoIi5wYXNzd29yZC10b2dnbGUiKS50b2dnbGVDbGFzcygicGFzc3dvcmQtdG9nZ2xlLW9uIiwicGFzc3dvcmQiIT09dCl9LF9zaG93UGFzc3dvcmQ6ZnVuY3Rpb24oKXt0aGlzLmNoYW5nZVR5cGUoInRleHQiKX0sX2hpZGVQYXNzd29yZDpmdW5jdGlvbigpe3RoaXMuY2hhbmdlVHlwZSgicGFzc3dvcmQiKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDMyNSksaSgzMjYpXSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSh0KXtzLnJlbW92ZUNvb2tpZSh0LHtwYXRoOiIvIn0pfWZ1bmN0aW9uIG4odCxlKXtzLmNvb2tpZSh0LGUse2V4cGlyZXM6bCxwYXRoOiIvIn0pfWZ1bmN0aW9uIHIodCl7cmV0dXJuIGErZS5nZXRTdHJpbmdIYXNoKHQpfXZhciBzPXQuJCxvPSJsbiIsYT0iYXV0b19wdXNoXyIsbD0zNjUsYz17fTtyZXR1cm4gYy5nZXRDb29raWVVc2VybmFtZT1mdW5jdGlvbigpe3JldHVybiBzLmNvb2tpZShvKX0sYy5zZXRVc2VybmFtZUNvb2tpZT1mdW5jdGlvbih0KXtuKG8sdCl9LGMucmVtb3ZlVXNlcm5hbWVDb29raWU9ZnVuY3Rpb24oKXtpKG8pfSxjLmlzQXV0b1B1c2hFbmFibGVkPWZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDAhPT10JiYidHJ1ZSI9PT1zLmNvb2tpZShyKHQpKX0sYy5zZXRBdXRvUHVzaENvb2tpZT1mdW5jdGlvbih0KXt2b2lkIDAhPT10JiZuKHIodCksITApfSxjLnJlbW92ZUF1dG9QdXNoQ29va2llPWZ1bmN0aW9uKHQpe3ZvaWQgMCE9PXQmJmkocih0KSl9LGN9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuO249ZnVuY3Rpb24oKXt2YXIgdD17fTtyZXR1cm4gdC5nZXRTdHJpbmdIYXNoPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT01MzgxLGk9dC5sZW5ndGg7aTspZT0zMyplXnQuY2hhckNvZGVBdCgtLWkpO3JldHVybiBlPj4+MH0sdH0uY2FsbChlLGksZSx0KSwhKHZvaWQgMCE9PW4mJih0LmV4cG9ydHM9bikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scixzOy8qIQoJCSAqIGpRdWVyeSBDb29raWUgUGx1Z2luIHYxLjQuMQoJCSAqIGh0dHBzOi8vZ2l0aHViLmNvbS9jYXJoYXJ0bC9qcXVlcnktY29va2llCgkJICoKCQkgKiBDb3B5cmlnaHQgMjAxMyBLbGF1cyBIYXJ0bAoJCSAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZQoJCSAqLwoJIWZ1bmN0aW9uKG8pe3I9W2koNildLG49byxzPSJmdW5jdGlvbiI9PXR5cGVvZiBuP24uYXBwbHkoZSxyKTpuLCEodm9pZCAwIT09cyYmKHQuZXhwb3J0cz1zKSl9KGZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUodCl7cmV0dXJuIGEucmF3P3Q6ZW5jb2RlVVJJQ29tcG9uZW50KHQpfWZ1bmN0aW9uIGkodCl7cmV0dXJuIGEucmF3P3Q6ZGVjb2RlVVJJQ29tcG9uZW50KHQpfWZ1bmN0aW9uIG4odCl7cmV0dXJuIGUoYS5qc29uP0pTT04uc3RyaW5naWZ5KHQpOlN0cmluZyh0KSl9ZnVuY3Rpb24gcih0KXswPT09dC5pbmRleE9mKCciJykmJih0PXQuc2xpY2UoMSwtMSkucmVwbGFjZSgvXFwiL2csJyInKS5yZXBsYWNlKC9cXFxcL2csIlxcIikpO3RyeXtyZXR1cm4gdD1kZWNvZGVVUklDb21wb25lbnQodC5yZXBsYWNlKG8sIiAiKSksYS5qc29uP0pTT04ucGFyc2UodCk6dH1jYXRjaChlKXt9fWZ1bmN0aW9uIHMoZSxpKXt2YXIgbj1hLnJhdz9lOnIoZSk7cmV0dXJuIHQuaXNGdW5jdGlvbihpKT9pKG4pOm59dmFyIG89L1wrL2csYT10LmNvb2tpZT1mdW5jdGlvbihyLG8sbCl7aWYodm9pZCAwIT09byYmIXQuaXNGdW5jdGlvbihvKSl7aWYobD10LmV4dGVuZCh7fSxhLmRlZmF1bHRzLGwpLCJudW1iZXIiPT10eXBlb2YgbC5leHBpcmVzKXt2YXIgYz1sLmV4cGlyZXMsdT1sLmV4cGlyZXM9bmV3IERhdGU7dS5zZXRUaW1lKCt1Kzg2NGU1KmMpfXJldHVybiBkb2N1bWVudC5jb29raWU9W2UociksIj0iLG4obyksbC5leHBpcmVzPyI7IGV4cGlyZXM9IitsLmV4cGlyZXMudG9VVENTdHJpbmcoKToiIixsLnBhdGg/IjsgcGF0aD0iK2wucGF0aDoiIixsLmRvbWFpbj8iOyBkb21haW49IitsLmRvbWFpbjoiIixsLnNlY3VyZT8iOyBzZWN1cmUiOiIiXS5qb2luKCIiKX1mb3IodmFyIGQ9cj92b2lkIDA6e30saD1kb2N1bWVudC5jb29raWU/ZG9jdW1lbnQuY29va2llLnNwbGl0KCI7ICIpOltdLHA9MCxmPWgubGVuZ3RoO3A8ZjtwKyspe3ZhciBtPWhbcF0uc3BsaXQoIj0iKSxfPWkobS5zaGlmdCgpKSxnPW0uam9pbigiPSIpO2lmKHImJnI9PT1fKXtkPXMoZyxvKTticmVha31yfHx2b2lkIDA9PT0oZz1zKGcpKXx8KGRbX109Zyl9cmV0dXJuIGR9O2EuZGVmYXVsdHM9e30sdC5yZW1vdmVDb29raWU9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdm9pZCAwIT09dC5jb29raWUoZSkmJih0LmNvb2tpZShlLCIiLHQuZXh0ZW5kKHt9LGkse2V4cGlyZXM6LTF9KSksIXQuY29va2llKGUpKX19KX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5fO3JldHVybiB0LkZvcm0uZXh0ZW5kKHtjbGFzc05hbWU6Im1mYS12ZXJpZnktdG90cCIsYXV0b1NhdmU6ITAsbm9DYW5jZWxCdXR0b246ITAsc2F2ZTppLnBhcnRpYWwodC5sb2MsIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKSxzY3JvbGxPbkVycm9yOiExLGxheW91dDoiby1mb3JtLXRoZW1lIixhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ImZhY3Rvci10b3RwIn0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciBpPXRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpLG49IlJTQSI9PT10aGlzLm1vZGVsLmdldCgicHJvdmlkZXIiKXx8IkRFTF9PQVRIIj09PXRoaXMubW9kZWwuZ2V0KCJwcm92aWRlciIpO3RoaXMudGl0bGU9aSx0aGlzLnN1YnRpdGxlPXQubG9jKCJtZmEuY2hhbGxlbmdlLnRpdGxlIiwibG9naW4iLFtpXSksdGhpcy5hZGRJbnB1dCh7bGFiZWw6ITEsImxhYmVsLXRvcCI6ITAscGxhY2Vob2xkZXI6dC5sb2MoIm1mYS5jaGFsbGVuZ2UuZW50ZXJDb2RlLnBsYWNlaG9sZGVyIiwibG9naW4iKSxjbGFzc05hbWU6Im8tZm9ybS1maWVsZHNldCBvLWZvcm0tbGFiZWwtdG9wIGF1dGgtcGFzc2NvZGUiLG5hbWU6ImFuc3dlciIsaW5wdXQ6ZSx0eXBlOm4/InBhc3N3b3JkIjoidGV4dCJ9KSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhbGxvd1JlbWVtYmVyRGV2aWNlIikmJnRoaXMuYWRkSW5wdXQoe2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInJlbWVtYmVyRGV2aWNlTGFiZWwiKSxjbGFzc05hbWU6Im1hcmdpbi1idG0tMCIsbmFtZToicmVtZW1iZXJEZXZpY2UiLHR5cGU6ImNoZWNrYm94In0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzA2KV0scj1mdW5jdGlvbih0LGUpe3ZhciBpPXQuXztyZXR1cm4gdC5Gb3JtLmV4dGVuZCh7Y2xhc3NOYW1lOiJtZmEtdmVyaWZ5LXl1YmlrZXkiLGF1dG9TYXZlOiEwLG5vQ2FuY2VsQnV0dG9uOiEwLHNhdmU6aS5wYXJ0aWFsKHQubG9jLCJtZmEuY2hhbGxlbmdlLnZlcmlmeSIsImxvZ2luIiksc2Nyb2xsT25FcnJvcjohMSxsYXlvdXQ6Im8tZm9ybS10aGVtZSIsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJmYWN0b3IteXViaWtleSJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt2YXIgaT10aGlzLm1vZGVsLmdldCgiZmFjdG9yTGFiZWwiKTt0aGlzLnRpdGxlPWksdGhpcy5zdWJ0aXRsZT10LmxvYygiZmFjdG9yLnRvdHBIYXJkLnl1YmlrZXkuZGVzY3JpcHRpb24iLCJsb2dpbiIpLHRoaXMuYWRkSW5wdXQoe2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLGNsYXNzTmFtZToiby1mb3JtLWZpZWxkc2V0IG8tZm9ybS1sYWJlbC10b3AgYXV0aC1wYXNzY29kZSIsbmFtZToiYW5zd2VyIixpbnB1dDplLHR5cGU6InBhc3N3b3JkIixwbGFjZWhvbGRlcjp0LmxvYygiZmFjdG9yLnRvdHBIYXJkLnl1YmlrZXkucGxhY2Vob2xkZXIiLCJsb2dpbiIpfSksdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiYWxsb3dSZW1lbWJlckRldmljZSIpJiZ0aGlzLmFkZElucHV0KHtsYWJlbDohMSwibGFiZWwtdG9wIjohMCxjbGFzc05hbWU6Im1hcmdpbi1idG0tMCIscGxhY2Vob2xkZXI6dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgicmVtZW1iZXJEZXZpY2VMYWJlbCIpLG5hbWU6InJlbWVtYmVyRGV2aWNlIix0eXBlOiJjaGVja2JveCJ9KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDIxKSxpKDMwNildLHI9ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG4oZSl7c3dpdGNoKGUpe2Nhc2Uic21zIjpyZXR1cm57YnV0dG9uRGF0YVNlOiJzbXMtc2VuZC1jb2RlIixidXR0b25DbGFzc05hbWU6InNtcy1yZXF1ZXN0LWJ1dHRvbiIsZm9ybVN1Ym1pdDp0LmxvYygibWZhLnNlbmRDb2RlIiwibG9naW4iKSxmb3JtUmV0cnk6dC5sb2MoIm1mYS5yZXNlbmRDb2RlIiwibG9naW4iKSxmb3JtU3VibWl0dGVkOnQubG9jKCJtZmEuc2VudCIsImxvZ2luIiksc3VidGl0bGU6cih7c3VidGl0bGU6dGhpcy5tb2RlbC5nZXQoInBob25lTnVtYmVyIil9KX07Y2FzZSJjYWxsIjpyZXR1cm57YnV0dG9uRGF0YVNlOiJtYWtlLWNhbGwiLGJ1dHRvbkNsYXNzTmFtZToiY2FsbC1yZXF1ZXN0LWJ1dHRvbiIsZm9ybVN1Ym1pdDp0LmxvYygibWZhLmNhbGwiLCJsb2dpbiIpLGZvcm1SZXRyeTp0LmxvYygibWZhLnJlZGlhbCIsImxvZ2luIiksZm9ybVN1Ym1pdHRlZDp0LmxvYygibWZhLmNhbGxpbmciLCJsb2dpbiIpLHN1YnRpdGxlOnIoe3N1YnRpdGxlOnRoaXMubW9kZWwuZ2V0KCJwaG9uZU51bWJlciIpfSl9O2Nhc2UiZW1haWwiOnJldHVybntidXR0b25EYXRhU2U6ImVtYWlsLXNlbmQtY29kZSIsYnV0dG9uQ2xhc3NOYW1lOiJlbWFpbC1yZXF1ZXN0LWJ1dHRvbiIsZm9ybVN1Ym1pdDp0LmxvYygibWZhLnNlbmRFbWFpbCIsImxvZ2luIiksZm9ybVJldHJ5OnQubG9jKCJtZmEucmVzZW5kRW1haWwiLCJsb2dpbiIpLGZvcm1TdWJtaXR0ZWQ6dC5sb2MoIm1mYS5zZW50IiwibG9naW4iKSxzdWJ0aXRsZTpyKHtzdWJ0aXRsZTp0aGlzLm1vZGVsLmdldCgiZW1haWwiKX0pfTtkZWZhdWx0OnJldHVybntidXR0b25EYXRhU2U6IiIsYnV0dG9uQ2xhc3NOYW1lOiIiLGZvcm1TdWJtaXQ6IiIsZm9ybVJldHJ5OiIiLGZvcm1TdWJtaXR0ZWQ6IiJ9fX12YXIgcj10LkhhbmRsZWJhcnMuY29tcGlsZSgiKHt7c3VidGl0bGV9fSkiKSxzPXQuXyxvPTNlNDtyZXR1cm4gdC5Gb3JtLmV4dGVuZCh7Y2xhc3NOYW1lOiJtZmEtdmVyaWZ5LXBhc3Njb2RlIixhdXRvU2F2ZTohMCxub0NhbmNlbEJ1dHRvbjohMCxzYXZlOnMucGFydGlhbCh0LmxvYywibWZhLmNoYWxsZW5nZS52ZXJpZnkiLCJsb2dpbiIpLHNjcm9sbE9uRXJyb3I6ITEsbGF5b3V0OiJvLWZvcm0tdGhlbWUiLGRpc2FibGVTdWJtaXRCdXR0b246ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5hcHBTdGF0ZS5nZXQoImlzTWZhQ2hhbGxlbmdlIikmJnRoaXMubW9kZWwuZ2V0KCJhbnN3ZXIiKX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciByPXRoaXM7dGhpcy50aXRsZT10aGlzLm1vZGVsLmdldCgiZmFjdG9yTGFiZWwiKTt2YXIgYT10aGlzLm1vZGVsLmdldCgiZmFjdG9yVHlwZSIpLGw9bi5jYWxsKHRoaXMsYSk7dGhpcy4kZWwuYXR0cigiZGF0YS1zZSIsImZhY3Rvci0iK2EpLHRoaXMuc3VidGl0bGU9bC5zdWJ0aXRsZSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImVycm9yIixmdW5jdGlvbigpe3RoaXMuY2xlYXJFcnJvcnMoKX0pLHRoaXMuYWRkKHQuY3JlYXRlQnV0dG9uKHthdHRyaWJ1dGVzOnsiZGF0YS1zZSI6bC5idXR0b25EYXRhU2V9LGNsYXNzTmFtZToiYnV0dG9uICIrbC5idXR0b25DbGFzc05hbWUsdGl0bGU6bC5mb3JtU3VibWl0LGNsaWNrOmZ1bmN0aW9uKCl7ci5jbGVhckVycm9ycygpLHRoaXMuZGlzYWJsZSgpLHRoaXMub3B0aW9ucy50aXRsZT1sLmZvcm1TdWJtaXR0ZWQsdGhpcy5yZW5kZXIoKSx0aGlzLm1vZGVsLnNldCgiYW5zd2VyIiwiIiksdGhpcy5tb2RlbC5zYXZlKCkudGhlbihmdW5jdGlvbigpe3JldHVybiByLmdldElucHV0cygpLmZpcnN0KCkucmVuZGVyKCkuZm9jdXMoKSxlLmRlbGF5KG8pfSkudGhlbihzLmJpbmQoZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMudGl0bGU9bC5mb3JtUmV0cnksdGhpcy5lbmFibGUoKSx0aGlzLnJlbmRlcigpfSx0aGlzKSl9fSkpLHRoaXMuYWRkSW5wdXQoe2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnQubG9jKCJtZmEuY2hhbGxlbmdlLmVudGVyQ29kZS5wbGFjZWhvbGRlciIsImxvZ2luIiksY2xhc3NOYW1lOiJvLWZvcm0tZmllbGRzZXQgby1mb3JtLWxhYmVsLXRvcCBhdXRoLXBhc3Njb2RlIixuYW1lOiJhbnN3ZXIiLGlucHV0OmksdHlwZToidGV4dCJ9KSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhbGxvd1JlbWVtYmVyRGV2aWNlIikmJnRoaXMuYWRkSW5wdXQoe2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInJlbWVtYmVyRGV2aWNlTGFiZWwiKSxjbGFzc05hbWU6Im1hcmdpbi1idG0tMCIsbmFtZToicmVtZW1iZXJEZXZpY2UiLHR5cGU6ImNoZWNrYm94In0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzI0KSxpKDMxKV0scj1mdW5jdGlvbih0LGUsaSl7dmFyIG49dC5fLHI9dC5IYW5kbGViYXJzLmNvbXBpbGUoInt7ZmFjdG9yTmFtZX19ICh7e3tkZXZpY2VOYW1lfX19KSIpLHM9M2U0LG89JzxkaXYgY2xhc3M9Im9rdGEtZm9ybS1pbmZvYm94LXdhcm5pbmcgaW5mb2JveCBpbmZvYm94LXdhcm5pbmciPlx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Imljb24gd2FybmluZy0xNiI+PC9zcGFuPlx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgPHA+e3t3YXJuaW5nfX08L3A+XHQgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+JztyZXR1cm4gdC5Gb3JtLmV4dGVuZCh7Y2xhc3NOYW1lOiJtZmEtdmVyaWZ5LXB1c2giLGF1dG9TYXZlOiEwLG5vQ2FuY2VsQnV0dG9uOiEwLHNhdmU6bi5wYXJ0aWFsKHQubG9jLCJva3RhdmVyaWZ5LnNlbmQiLCJsb2dpbiIpLHNjcm9sbE9uRXJyb3I6ITEsbGF5b3V0OiJvLWZvcm0tdGhlbWUiLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoiZmFjdG9yLXB1c2gifSxldmVudHM6e3N1Ym1pdDoic3VibWl0In0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMuZW5hYmxlZD0hMCx0aGlzLmxpc3RlblRvKHRoaXMub3B0aW9ucy5hcHBTdGF0ZSwiY2hhbmdlOmlzTWZhUmVqZWN0ZWRCeVVzZXIiLGZ1bmN0aW9uKGUsaSl7dGhpcy5zZXRTdWJtaXRTdGF0ZShpKSxpJiZ0aGlzLnNob3dFcnJvcih0LmxvYygib2t0YXZlcmlmeS5yZWplY3RlZCIsImxvZ2luIikpfSksdGhpcy5saXN0ZW5Ubyh0aGlzLm9wdGlvbnMuYXBwU3RhdGUsImNoYW5nZTppc01mYVRpbWVvdXQiLGZ1bmN0aW9uKGUsaSl7dGhpcy5zZXRTdWJtaXRTdGF0ZShpKSxpJiZ0aGlzLnNob3dFcnJvcih0LmxvYygib2t0YXZlcmlmeS50aW1lb3V0IiwibG9naW4iKSl9KSx0aGlzLmxpc3RlblRvKHRoaXMub3B0aW9ucy5hcHBTdGF0ZSwiY2hhbmdlOmlzTWZhUmVxdWlyZWQiLGZ1bmN0aW9uKHQsZSl7ZSYmKHRoaXMuY2xlYXJFcnJvcnMoKSx0aGlzLmNsZWFyV2FybmluZ3MoKSl9KSx0aGlzLnRpdGxlPXIoe2ZhY3Rvck5hbWU6dGhpcy5tb2RlbC5nZXQoImZhY3RvckxhYmVsIiksZGV2aWNlTmFtZTp0aGlzLm1vZGVsLmdldCgiZGV2aWNlTmFtZSIpfSl9LHNldFN1Ym1pdFN0YXRlOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMuJGVsLmZpbmQoIi5idXR0b24iKTt0aGlzLmVuYWJsZWQ9ZSxlPyhpLnJlbW92ZUNsYXNzKCJsaW5rLWJ1dHRvbi1kaXNhYmxlZCIpLGkucHJvcCgidmFsdWUiLHQubG9jKCJva3RhdmVyaWZ5LnNlbmQiLCJsb2dpbiIpKSxpLnByb3AoImRpc2FibGVkIiwhMSkpOihpLmFkZENsYXNzKCJsaW5rLWJ1dHRvbi1kaXNhYmxlZCIpLGkucHJvcCgidmFsdWUiLHQubG9jKCJva3RhdmVyaWZ5LnNlbnQiLCJsb2dpbiIpKSxpLnByb3AoImRpc2FibGVkIiwhMCkpfSxzdWJtaXQ6ZnVuY3Rpb24odCl7dm9pZCAwIT09dCYmdC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuZW5hYmxlZCYmKHRoaXMuc2V0U3VibWl0U3RhdGUoITEpLHRoaXMuZG9TYXZlKCkpfSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5zZXR0aW5ncy5nZXQoImZlYXR1cmVzLmF1dG9QdXNoIikmJmUuaXNBdXRvUHVzaEVuYWJsZWQodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlcklkIikpJiYodGhpcy5tb2RlbC5zZXQoImF1dG9QdXNoIiwhMCksbi5kZWZlcihuLmJpbmQodGhpcy5zdWJtaXQsdGhpcykpKX0sZG9TYXZlOmZ1bmN0aW9uKCl7dmFyIGU7dGhpcy5jbGVhckVycm9ycygpLHRoaXMuY2xlYXJXYXJuaW5ncygpLHRoaXMubW9kZWwuaXNWYWxpZCgpJiYodGhpcy5saXN0ZW5Ub09uY2UodGhpcy5tb2RlbCwiZXJyb3IiLGZ1bmN0aW9uKCl7dGhpcy5zZXRTdWJtaXRTdGF0ZSghMCksdGhpcy5jbGVhcldhcm5pbmdzKCksY2xlYXJUaW1lb3V0KGUpfSksdGhpcy50cmlnZ2VyKCJzYXZlIix0aGlzLm1vZGVsKSxlPWkuY2FsbEFmdGVyVGltZW91dChuLmJpbmQoZnVuY3Rpb24oKXt0aGlzLnNob3dXYXJuaW5nKHQubG9jKCJva3RhdmVyaWZ5Lndhcm5pbmciLCJsb2dpbiIpKX0sdGhpcykscykpfSxzaG93RXJyb3I6ZnVuY3Rpb24odCl7dGhpcy5jbGVhcldhcm5pbmdzKCksdGhpcy5tb2RlbC50cmlnZ2VyKCJlcnJvciIsdGhpcy5tb2RlbCx7cmVzcG9uc2VKU09OOntlcnJvclN1bW1hcnk6dH19KX0sc2hvd1dhcm5pbmc6ZnVuY3Rpb24odCl7dGhpcy5jbGVhcldhcm5pbmdzKCksdGhpcy5hZGQobywiLm8tZm9ybS1lcnJvci1jb250YWluZXIiLHtvcHRpb25zOnt3YXJuaW5nOnR9fSl9LGNsZWFyV2FybmluZ3M6ZnVuY3Rpb24oKXt0aGlzLiQoIi5va3RhLWZvcm0taW5mb2JveC13YXJuaW5nIikucmVtb3ZlKCl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaShpKXtpLmFkZERpdmlkZXIoKSxpLmFkZElucHV0KHtsYWJlbDohMSwibGFiZWwtdG9wIjohMCxwbGFjZWhvbGRlcjp0LmxvYygibWZhLmNoYWxsZW5nZS5lbnRlckNvZGUucGxhY2Vob2xkZXIiLCJsb2dpbiIpLGNsYXNzTmFtZToiby1mb3JtLWZpZWxkc2V0IG8tZm9ybS1sYWJlbC10b3AgaW5saW5lLWlucHV0IGF1dGgtcGFzc2NvZGUiLG5hbWU6ImFuc3dlciIsaW5wdXQ6ZSx0eXBlOiJ0ZXh0In0pLGkuYWRkKHQuY3JlYXRlQnV0dG9uKHthdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ImlubGluZS10b3RwLXZlcmlmeSJ9LGNsYXNzTmFtZToiYnV0dG9uIGlubGluZS10b3RwLXZlcmlmeSIsdGl0bGU6dC5sb2MoIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKSxjbGljazpmdW5jdGlvbigpe2kubW9kZWwubWFuYWdlVHJhbnNhY3Rpb24oZnVuY3Rpb24odCxlKXtyZXR1cm4iTUZBX0NIQUxMRU5HRSI9PT10LnN0YXR1cyYmdC5wcmV2P3QucHJldigpLnRoZW4oZnVuY3Rpb24odCl7ZSh0KSxpLm1vZGVsLnNhdmUoKX0pOnZvaWQgaS5tb2RlbC5zYXZlKCl9KX19KSksaS5hdCgxKS5mb2N1cygpfXJldHVybiB0LkZvcm0uZXh0ZW5kKHthdXRvU2F2ZTohMCxub0J1dHRvbkJhcjohMCxzY3JvbGxPbkVycm9yOiExLGxheW91dDoiby1mb3JtLXRoZW1lIixjbGFzc05hbWU6Im1mYS12ZXJpZnktdG90cC1pbmxpbmUiLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoiZmFjdG9yLWlubGluZS10b3RwIn0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJlcnJvciIsZnVuY3Rpb24oKXt0aGlzLmNsZWFyRXJyb3JzKCl9KSx0aGlzLmFkZCh0LmNyZWF0ZUJ1dHRvbih7Y2xhc3NOYW1lOiJsaW5rIixhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ImlubGluZS10b3RwLWFkZCJ9LHRpdGxlOnQubG9jKCJtZmEuY2hhbGxlbmdlLm9yRW50ZXJDb2RlIiwibG9naW4iKSxjbGljazpmdW5jdGlvbigpe3RoaXMucmVtb3ZlKCksaShlKX19KSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTUpLGkoMjk2KSxpKDMzMyksaSgzMzQpLGkoMzIwKSxpKDMzNSldLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyl7dmFyIGE9dC5fO3JldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOiJtZmEtdmVyaWZ5IHZlcmlmeS13aW5kb3dzLWhlbGxvIixNb2RlbDp7bG9jYWw6e19fYXV0b1RyaWdnZXJlZF9fOiJib29sZWFuIn0sc2F2ZTpmdW5jdGlvbigpe2lmKG4uaXNBdmFpbGFibGUoKSl7dGhpcy50cmlnZ2VyKCJyZXF1ZXN0Iik7dmFyIHQ9dGhpcztyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpe3ZhciBpPWEuZmluZFdoZXJlKGUuZmFjdG9ycyx7ZmFjdG9yVHlwZToid2ViYXV0aG4iLHByb3ZpZGVyOiJGSURPIn0pO3JldHVybiBpLnZlcmlmeSgpLnRoZW4oZnVuY3Rpb24ocil7dmFyIHM9ci5mYWN0b3I7cmV0dXJuIG4uZ2V0QXNzZXJ0aW9uKHMuY2hhbGxlbmdlLm5vbmNlLFt7aWQ6cy5wcm9maWxlLmNyZWRlbnRpYWxJZH1dKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiBpLnZlcmlmeSh7YXV0aGVudGljYXRvckRhdGE6dC5hdXRoZW50aWNhdG9yRGF0YSxjbGllbnREYXRhOnQuY2xpZW50RGF0YSxzaWduYXR1cmVEYXRhOnQuc2lnbmF0dXJlfSl9KS50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiB0LnRyaWdnZXIoInN5bmMiKSx0LnRyaWdnZXIoInNpZ25JbiIpLGV9KS5mYWlsKGZ1bmN0aW9uKGkpe3N3aXRjaChpLm1lc3NhZ2Upe2Nhc2UiQWJvcnRFcnJvciI6Y2FzZSJOb3RGb3VuZEVycm9yIjpjYXNlIk5vdFN1cHBvcnRlZEVycm9yIjpyZXR1cm4gdC50cmlnZ2VyKCJhYm9ydCIsaS5tZXNzYWdlKSxlfXRocm93IGl9KX0pfSl9fX0sRm9ybTp7YXV0b1NhdmU6ITAsaGFzU2F2aW5nU3RhdGU6ITEsdGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJmYWN0b3Iud2luZG93c0hlbGxvIiwibG9naW4iKSxzdWJ0aXRsZTpmdW5jdGlvbigpe3JldHVybiBuLmlzQXZhaWxhYmxlKCk/dC5sb2MoInZlcmlmeS53aW5kb3dzSGVsbG8uc3VidGl0bGUiLCJsb2dpbiIpOiIifSxzYXZlOmEucGFydGlhbCh0LmxvYywidmVyaWZ5LndpbmRvd3NIZWxsby5zYXZlIiwibG9naW4iKSxjdXN0b21TYXZpbmdTdGF0ZTp7c3RvcDoiYWJvcnQifSxtb2RlbEV2ZW50czpmdW5jdGlvbigpe3JldHVybiBuLmlzQXZhaWxhYmxlKCk/e3JlcXVlc3Q6Il9zdGFydEVucm9sbG1lbnQiLGVycm9yOiJfc3RvcEVucm9sbG1lbnQiLGFib3J0OiJfc3RvcEVucm9sbG1lbnQiLHNpZ25JbjoiX3N1Y2Nlc3NFbnJvbGxtZW50In06e319LG5vQnV0dG9uQmFyOmZ1bmN0aW9uKCl7cmV0dXJuIW4uaXNBdmFpbGFibGUoKX0sZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7dmFyIGU9W107cmV0dXJuIG4uaXNBdmFpbGFibGUoKXx8ZS5wdXNoKGkuVmlldyh7VmlldzpuZXcgbyh7bWVzc2FnZTp0LmxvYygiZW5yb2xsLndpbmRvd3NIZWxsby5lcnJvci5ub3RXaW5kb3dzIiwibG9naW4iKX0pfSx7c2VsZWN0b3I6Ii5vLWZvcm0tZXJyb3ItY29udGFpbmVyIn0pKSxlLnB1c2goaS5WaWV3KHtWaWV3Om5ldyByKHttb2RlbDp0aGlzLm1vZGVsLHZpc2libGU6ITF9KX0pKSxlfSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7MSE9PXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImZhY3RvcnMiKS5sZW5ndGh8fHRoaXMubW9kZWwuZ2V0KCJfX2F1dG9UcmlnZ2VyZWRfXyIpfHwodGhpcy5tb2RlbC5zZXQoIl9fYXV0b1RyaWdnZXJlZF9fIiwhMCksdGhpcy5tb2RlbC5zYXZlKCkpfSxfc3RhcnRFbnJvbGxtZW50OmZ1bmN0aW9uKCl7dGhpcy5zdWJ0aXRsZT10LmxvYygidmVyaWZ5LndpbmRvd3NIZWxsby5zdWJ0aXRsZS5sb2FkaW5nIiwibG9naW4iKSx0aGlzLm1vZGVsLnRyaWdnZXIoInNwaW5uZXI6c2hvdyIpLHRoaXMuX3Jlc2V0RXJyb3JNZXNzYWdlKCksdGhpcy5yZW5kZXIoKSx0aGlzLiQoIi5vLWZvcm0tYnV0dG9uLWJhciIpLmFkZENsYXNzKCJoaWRlIil9LF9zdG9wRW5yb2xsbWVudDpmdW5jdGlvbihlKXt0aGlzLnN1YnRpdGxlPXQubG9jKCJ2ZXJpZnkud2luZG93c0hlbGxvLnN1YnRpdGxlIiwibG9naW4iKSx0aGlzLm1vZGVsLnRyaWdnZXIoInNwaW5uZXI6aGlkZSIpLHRoaXMuJCgiLm8tZm9ybS1idXR0b24tYmFyIikucmVtb3ZlQ2xhc3MoImhpZGUiKTt2YXIgaTtzd2l0Y2goZSl7Y2FzZSJOb3RGb3VuZEVycm9yIjppPXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImZhY3RvcnMiKS5sZW5ndGg+MT90LmxvYygidmVyaWZ5LndpbmRvd3NIZWxsby5lcnJvci5ub3RGb3VuZC5zZWxlY3RBbm90aGVyIiwibG9naW4iKTp0LmxvYygidmVyaWZ5LndpbmRvd3NIZWxsby5lcnJvci5ub3RGb3VuZCIsImxvZ2luIik7YnJlYWs7Y2FzZSJOb3RTdXBwb3J0ZWRFcnJvciI6aT10LmxvYygiZW5yb2xsLndpbmRvd3NIZWxsby5lcnJvci5ub3RDb25maWd1cmVkSHRtbCIsImxvZ2luIil9aWYodGhpcy5fcmVzZXRFcnJvck1lc3NhZ2UoKSxpKXt2YXIgbj1uZXcgbyh7bWVzc2FnZTppfSk7dGhpcy4kKCIuby1mb3JtLWVycm9yLWNvbnRhaW5lciIpLmFkZENsYXNzKCJvLWZvcm0taGFzLWVycm9ycyIpLHRoaXMuYWRkKG4se3NlbGVjdG9yOiIuby1mb3JtLWVycm9yLWNvbnRhaW5lciJ9KSx0aGlzLl9lcnJvck1lc3NhZ2VWaWV3PXRoaXMubGFzdCgpfXRoaXMucmVuZGVyKCl9LF9zdWNjZXNzRW5yb2xsbWVudDpmdW5jdGlvbigpe3RoaXMuc3VidGl0bGU9dC5sb2MoInZlcmlmeS53aW5kb3dzSGVsbG8uc3VidGl0bGUuc2lnbmluZ0luIiwibG9naW4iKSx0aGlzLnJlbmRlcigpLHRoaXMuJCgiLm8tZm9ybS1idXR0b24tYmFyIikuYWRkQ2xhc3MoImhpZGUiKX0sX3Jlc2V0RXJyb3JNZXNzYWdlOmZ1bmN0aW9uKCl7dGhpcy5fZXJyb3JNZXNzYWdlVmlldyYmdGhpcy5fZXJyb3JNZXNzYWdlVmlldy5yZW1vdmUoKSx0aGlzLl9lcnJvck1lc3NhZ2VWaWV3PXZvaWQgMCx0aGlzLmNsZWFyRXJyb3JzKCl9fSxiYWNrOmZ1bmN0aW9uKCl7fSxGb290ZXI6c30pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjEpXSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSh0KXtyZXR1cm4gbmV3IGUodCl9ZnVuY3Rpb24gbih0LGUsbil7ZT1lLm1hcChmdW5jdGlvbih0KXtyZXR1cm57dHlwZToiRklET18yXzAiLGFsZ29yaXRobTp0LmFsZ29yaXRobX19KTt2YXIgcj13aW5kb3cubXNDcmVkZW50aWFscy5tYWtlQ3JlZGVudGlhbCh0LGUsbikudGhlbihmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmZyZWV6ZSh7Y3JlZGVudGlhbDp7aWQ6dC5pZH0scHVibGljS2V5OkpTT04ucGFyc2UodC5wdWJsaWNLZXkpLGF0dGVzdGF0aW9uOnQuYXR0ZXN0YXRpb259KX0pO3JldHVybiBpKHIpfWZ1bmN0aW9uIHIodCxlKXt2YXIgbj1lLm1hcChmdW5jdGlvbih0KXtyZXR1cm57dHlwZToiRklET18yXzAiLGlkOnQuaWR9fSkscj17YWNjZXB0Om59LHM9d2luZG93Lm1zQ3JlZGVudGlhbHMuZ2V0QXNzZXJ0aW9uKHQscikudGhlbihmdW5jdGlvbih0KXt2YXIgZT10LnNpZ25hdHVyZTtyZXR1cm4gT2JqZWN0LmZyZWV6ZSh7Y3JlZGVudGlhbDp7aWQ6dC5pZH0sY2xpZW50RGF0YTplLmNsaWVudERhdGEsYXV0aGVudGljYXRvckRhdGE6ZS5hdXRobnJEYXRhLHNpZ25hdHVyZTplLnNpZ25hdHVyZX0pfSk7cmV0dXJuIGkocyl9cmV0dXJue21ha2VDcmVkZW50aWFsOm4sZ2V0QXNzZXJ0aW9uOnIsaXNBdmFpbGFibGU6ZnVuY3Rpb24oKXtyZXR1cm4gd2luZG93Lmhhc093blByb3BlcnR5KCJtc0NyZWRlbnRpYWxzIil9fX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKV0scj1mdW5jdGlvbih0KXtyZXR1cm4gdC5WaWV3LmV4dGVuZCh7Y2xhc3NOYW1lOiJva3RhLXdhaXRpbmctc3Bpbm5lciIsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJvLWZvcm0tb2t0YS13YWl0aW5nLXNwaW5uZXIifSxtb2RlbEV2ZW50czp7InNwaW5uZXI6c2hvdyI6InNob3ciLCJzcGlubmVyOmhpZGUiOiJoaWRlIn0saW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0JiZ0LnZpc2libGU9PT0hMSYmdGhpcy5oaWRlKCl9LHNob3c6ZnVuY3Rpb24oKXt0aGlzLiRlbC5yZW1vdmVDbGFzcygiaGlkZSIpfSxoaWRlOmZ1bmN0aW9uKCl7dGhpcy4kZWwuYWRkQ2xhc3MoImhpZGUiKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDE0NildLHI9ZnVuY3Rpb24odCxlKXt2YXIgaT0nXHQgICAgPHNwYW4gY2xhc3M9Imljb24gZXJyb3ItMjQiPjwvc3Bhbj5cdCAgICA8aDQ+PHN0cm9uZz57e3ttZXNzYWdlfX19PC9zdHJvbmc+PC9oND5cdCAgJztyZXR1cm4gZS5leHRlbmQoe3RlbXBsYXRlOmksY2xhc3NOYW1lOiJva3RhLWluZm9ib3gtZXJyb3IgaW5mb2JveCBpbmZvYm94LWVycm9yIGluZm9ib3gtbWQgbWFyZ2luLWJ0bS0yNSIsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJvLWZvcm0tZXJyb3ItaHRtbCJ9LG1lc3NhZ2U6IiIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0JiZ0Lm1lc3NhZ2UmJih0aGlzLm1lc3NhZ2U9dC5tZXNzYWdlKX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJue21lc3NhZ2U6dGhpcy5tZXNzYWdlfX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NSksaSgyOTYpLGkoMzIwKSxpKDIxKSxpKDMzNSksaSgxODIpLGkoMzM3KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvKXtmdW5jdGlvbiBhKHQsZSl7c3dpdGNoKHQpe2Nhc2UgMTpyZXR1cm4gZT8idTJmLmVycm9yLm90aGVyLm9uZUZhY3RvciI6InUyZi5lcnJvci5vdGhlciI7Y2FzZSAyOmNhc2UgMzpyZXR1cm4gZT8idTJmLmVycm9yLmJhZFJlcXVlc3Qub25lRmFjdG9yIjoidTJmLmVycm9yLmJhZFJlcXVlc3QiO2Nhc2UgNDpyZXR1cm4gZT8idTJmLmVycm9yLnVuc3VwcG9ydGVkLm9uZUZhY3RvciI6InUyZi5lcnJvci51bnN1cHBvcnRlZCI7Y2FzZSA1OnJldHVybiJ1MmYuZXJyb3IudGltZW91dCJ9fXZhciBsPXQuXztyZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZToidmVyaWZ5LXUyZiIsTW9kZWw6e3NhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50cmlnZ2VyKCJyZXF1ZXN0IiksdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpe3ZhciBpPWwuZmluZFdoZXJlKGUuZmFjdG9ycyx7ZmFjdG9yVHlwZToidTJmIixwcm92aWRlcjoiRklETyJ9KSxuPXRoaXM7cmV0dXJuIGkudmVyaWZ5KCkudGhlbihmdW5jdGlvbihlKXt2YXIgcz1lLmZhY3RvcixvPXMucHJvZmlsZS5hcHBJZCxsPVt7dmVyc2lvbjpzLnByb2ZpbGUudmVyc2lvbixrZXlIYW5kbGU6cy5wcm9maWxlLmNyZWRlbnRpYWxJZH1dO24udHJpZ2dlcigicmVxdWVzdCIpO3ZhciBjPXIuZGVmZXIoKTtyZXR1cm4gdTJmLnNpZ24obyxzLmNoYWxsZW5nZS5ub25jZSxsLGZ1bmN0aW9uKGUpe2lmKG4udHJpZ2dlcigiZXJyb3JzOmNsZWFyIiksIWUuZXJyb3JDb2RlfHwwPT09ZS5lcnJvckNvZGUpcmV0dXJuIGkudmVyaWZ5KHtjbGllbnREYXRhOmUuY2xpZW50RGF0YSxzaWduYXR1cmVEYXRhOmUuc2lnbmF0dXJlRGF0YX0pLnRoZW4oYy5yZXNvbHZlKTt2YXIgcj0xPT09bi5vcHRpb25zLmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpLmxlbmd0aDtjLnJlamVjdCh7eGhyOntyZXNwb25zZUpTT046e2Vycm9yU3VtbWFyeTp0LmxvYyhhKGUuZXJyb3JDb2RlLHIpLCJsb2dpbiIpfX19KX0pLGMucHJvbWlzZX0pfSl9fSxGb3JtOnthdXRvU2F2ZTohMCxoYXNTYXZpbmdTdGF0ZTohMSx0aXRsZTpsLnBhcnRpYWwodC5sb2MsImZhY3Rvci51MmYiLCJsb2dpbiIpLGNsYXNzTmFtZToidmVyaWZ5LXUyZi1mb3JtIixub0NhbmNlbEJ1dHRvbjohMCxzYXZlOmwucGFydGlhbCh0LmxvYywidmVyaWZ5LnUyZi5yZXRyeSIsImxvZ2luIiksbm9CdXR0b25CYXI6ZnVuY3Rpb24oKXtyZXR1cm4hd2luZG93Lmhhc093blByb3BlcnR5KCJ1MmYiKX0sbW9kZWxFdmVudHM6e3JlcXVlc3Q6Il9zdGFydEVucm9sbG1lbnQiLGVycm9yOiJfc3RvcEVucm9sbG1lbnQifSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXt2YXIgZT1bXTtpZih3aW5kb3cuaGFzT3duUHJvcGVydHkoInUyZiIpKWUucHVzaChpLlZpZXcoe1ZpZXc6J1x0ICAgICAgICAgICAgPGRpdiBjbGFzcz0idTJmLXZlcmlmeS10ZXh0Ij5cdCAgICAgICAgICAgICAgPHA+e3tpMThuIGNvZGU9InZlcmlmeS51MmYuaW5zdHJ1Y3Rpb25zIiBidW5kbGU9ImxvZ2luIn19PC9wPlx0ICAgICAgICAgICAgICA8cD57e2kxOG4gY29kZT0idmVyaWZ5LnUyZi5pbnN0cnVjdGlvbnNCbHVldG9vdGgiIGJ1bmRsZT0ibG9naW4ifX08L3A+XHQgICAgICAgICAgICAgIDxkaXYgZGF0YS1zZT0idTJmLXdhaXRpbmciIGNsYXNzPSJva3RhLXdhaXRpbmctc3Bpbm5lciI+PC9kaXY+XHQgICAgICAgICAgICA8L2Rpdj4nfSkpO2Vsc2V7dmFyIG49InUyZi5lcnJvci5ub3RTdXBwb3J0ZWRCcm93c2VyIjtvLmlzRmlyZWZveCgpP249InUyZi5lcnJvci5ub0ZpcmVmb3hFeHRlbnNpb24iOjE9PT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJmYWN0b3JzIikubGVuZ3RoJiYobj0idTJmLmVycm9yLm5vdFN1cHBvcnRlZEJyb3dzZXIub25lRmFjdG9yIiksZS5wdXNoKGkuVmlldyh7VmlldzpuZXcgcyh7bWVzc2FnZTp0LmxvYyhuLCJsb2dpbiIpfSl9LHtzZWxlY3RvcjoiLm8tZm9ybS1lcnJvci1jb250YWluZXIifSkpfXJldHVybiBlfSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7bC5kZWZlcihsLmJpbmQoZnVuY3Rpb24oKXt3aW5kb3cuaGFzT3duUHJvcGVydHkoInUyZiIpP3RoaXMubW9kZWwuc2F2ZSgpOnRoaXMuJCgnW2RhdGEtc2U9InUyZi13YWl0aW5nIl0nKS5hZGRDbGFzcygiaGlkZSIpfSx0aGlzKSl9LF9zdGFydEVucm9sbG1lbnQ6ZnVuY3Rpb24oKXt0aGlzLiQoIi5va3RhLXdhaXRpbmctc3Bpbm5lciIpLnJlbW92ZUNsYXNzKCJoaWRlIiksdGhpcy4kKCIuby1mb3JtLWJ1dHRvbi1iYXIiKS5oaWRlKCl9LF9zdG9wRW5yb2xsbWVudDpmdW5jdGlvbigpe3RoaXMuJCgiLm9rdGEtd2FpdGluZy1zcGlubmVyIikuYWRkQ2xhc3MoImhpZGUiKSx0aGlzLiQoIi5vLWZvcm0tYnV0dG9uLWJhciIpLnNob3coKX19LGJhY2s6ZnVuY3Rpb24oKXt9LEZvb3RlcjpufSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlKXsKCS8vQ29weXJpZ2h0IDIwMTQtMjAxNSBHb29nbGUgSW5jLiBBbGwgcmlnaHRzIHJlc2VydmVkLgoJLy9saWNlbnNlIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgb3IgYXQKCS8vaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vb3Blbi1zb3VyY2UvbGljZW5zZXMvYnNkCgkidXNlIHN0cmljdCI7IWZ1bmN0aW9uKCl7aWYoISgidTJmImluIHdpbmRvdykmJiJjaHJvbWUiaW4gd2luZG93KXt2YXIgdCxlPXdpbmRvdy51MmY9e307ZS5FWFRFTlNJT05fSUQ9ImttZW5kZmFwZ2dqZWhvZG5kZmxtbWdhZ2RiYW1obmZkIixlLk1lc3NhZ2VUeXBlcz17VTJGX1JFR0lTVEVSX1JFUVVFU1Q6InUyZl9yZWdpc3Rlcl9yZXF1ZXN0IixVMkZfUkVHSVNURVJfUkVTUE9OU0U6InUyZl9yZWdpc3Rlcl9yZXNwb25zZSIsVTJGX1NJR05fUkVRVUVTVDoidTJmX3NpZ25fcmVxdWVzdCIsVTJGX1NJR05fUkVTUE9OU0U6InUyZl9zaWduX3Jlc3BvbnNlIixVMkZfR0VUX0FQSV9WRVJTSU9OX1JFUVVFU1Q6InUyZl9nZXRfYXBpX3ZlcnNpb25fcmVxdWVzdCIsVTJGX0dFVF9BUElfVkVSU0lPTl9SRVNQT05TRToidTJmX2dldF9hcGlfdmVyc2lvbl9yZXNwb25zZSJ9LGUuRXJyb3JDb2Rlcz17T0s6MCxPVEhFUl9FUlJPUjoxLEJBRF9SRVFVRVNUOjIsQ09ORklHVVJBVElPTl9VTlNVUFBPUlRFRDozLERFVklDRV9JTkVMSUdJQkxFOjQsVElNRU9VVDo1fSxlLlUyZlJlcXVlc3QsZS5VMmZSZXNwb25zZSxlLkVycm9yLGUuVHJhbnNwb3J0LGUuVHJhbnNwb3J0cyxlLlNpZ25SZXF1ZXN0LGUuU2lnblJlc3BvbnNlLGUuUmVnaXN0ZXJSZXF1ZXN0LGUuUmVnaXN0ZXJSZXNwb25zZSxlLlJlZ2lzdGVyZWRLZXksZS5HZXRKc0FwaVZlcnNpb25SZXNwb25zZSxlLmdldE1lc3NhZ2VQb3J0PWZ1bmN0aW9uKHQpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgY2hyb21lJiZjaHJvbWUucnVudGltZSl7dmFyIGk9e3R5cGU6ZS5NZXNzYWdlVHlwZXMuVTJGX1NJR05fUkVRVUVTVCxzaWduUmVxdWVzdHM6W119O2Nocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKGUuRVhURU5TSU9OX0lELGksZnVuY3Rpb24oKXtjaHJvbWUucnVudGltZS5sYXN0RXJyb3I/ZS5nZXRJZnJhbWVQb3J0Xyh0KTplLmdldENocm9tZVJ1bnRpbWVQb3J0Xyh0KX0pfWVsc2UgZS5pc0FuZHJvaWRDaHJvbWVfKCk/ZS5nZXRBdXRoZW50aWNhdG9yUG9ydF8odCk6ZS5pc0lvc0Nocm9tZV8oKT9lLmdldElvc1BvcnRfKHQpOmUuZ2V0SWZyYW1lUG9ydF8odCl9LGUuaXNBbmRyb2lkQ2hyb21lXz1mdW5jdGlvbigpe3ZhciB0PW5hdmlnYXRvci51c2VyQWdlbnQ7cmV0dXJuIHQuaW5kZXhPZigiQ2hyb21lIikhPS0xJiZ0LmluZGV4T2YoIkFuZHJvaWQiKSE9LTF9LGUuaXNJb3NDaHJvbWVfPWZ1bmN0aW9uKCl7cmV0dXJuICQuaW5BcnJheShuYXZpZ2F0b3IucGxhdGZvcm0sWyJpUGhvbmUiLCJpUGFkIiwiaVBvZCJdKT4tMX0sZS5nZXRDaHJvbWVSdW50aW1lUG9ydF89ZnVuY3Rpb24odCl7dmFyIGk9Y2hyb21lLnJ1bnRpbWUuY29ubmVjdChlLkVYVEVOU0lPTl9JRCx7aW5jbHVkZVRsc0NoYW5uZWxJZDohMH0pO3NldFRpbWVvdXQoZnVuY3Rpb24oKXt0KG5ldyBlLldyYXBwZWRDaHJvbWVSdW50aW1lUG9ydF8oaSkpfSwwKX0sZS5nZXRBdXRoZW50aWNhdG9yUG9ydF89ZnVuY3Rpb24odCl7c2V0VGltZW91dChmdW5jdGlvbigpe3QobmV3IGUuV3JhcHBlZEF1dGhlbnRpY2F0b3JQb3J0Xyl9LDApfSxlLmdldElvc1BvcnRfPWZ1bmN0aW9uKHQpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXt0KG5ldyBlLldyYXBwZWRJb3NQb3J0Xyl9LDApfSxlLldyYXBwZWRDaHJvbWVSdW50aW1lUG9ydF89ZnVuY3Rpb24odCl7dGhpcy5wb3J0Xz10fSxlLmZvcm1hdFNpZ25SZXF1ZXN0Xz1mdW5jdGlvbihpLG4scixzLG8pe2lmKHZvaWQgMD09PXR8fHQ8MS4xKXtmb3IodmFyIGE9W10sbD0wO2w8ci5sZW5ndGg7bCsrKWFbbF09e3ZlcnNpb246cltsXS52ZXJzaW9uLGNoYWxsZW5nZTpuLGtleUhhbmRsZTpyW2xdLmtleUhhbmRsZSxhcHBJZDppfTtyZXR1cm57dHlwZTplLk1lc3NhZ2VUeXBlcy5VMkZfU0lHTl9SRVFVRVNULHNpZ25SZXF1ZXN0czphLHRpbWVvdXRTZWNvbmRzOnMscmVxdWVzdElkOm99fXJldHVybnt0eXBlOmUuTWVzc2FnZVR5cGVzLlUyRl9TSUdOX1JFUVVFU1QsYXBwSWQ6aSxjaGFsbGVuZ2U6bixyZWdpc3RlcmVkS2V5czpyLHRpbWVvdXRTZWNvbmRzOnMscmVxdWVzdElkOm99fSxlLmZvcm1hdFJlZ2lzdGVyUmVxdWVzdF89ZnVuY3Rpb24oaSxuLHIscyxvKXtpZih2b2lkIDA9PT10fHx0PDEuMSl7Zm9yKHZhciBhPTA7YTxyLmxlbmd0aDthKyspclthXS5hcHBJZD1pO2Zvcih2YXIgbD1bXSxhPTA7YTxuLmxlbmd0aDthKyspbFthXT17dmVyc2lvbjpuW2FdLnZlcnNpb24sY2hhbGxlbmdlOnJbMF0sa2V5SGFuZGxlOm5bYV0ua2V5SGFuZGxlLGFwcElkOml9O3JldHVybnt0eXBlOmUuTWVzc2FnZVR5cGVzLlUyRl9SRUdJU1RFUl9SRVFVRVNULHNpZ25SZXF1ZXN0czpsLHJlZ2lzdGVyUmVxdWVzdHM6cix0aW1lb3V0U2Vjb25kczpzLHJlcXVlc3RJZDpvfX1yZXR1cm57dHlwZTplLk1lc3NhZ2VUeXBlcy5VMkZfUkVHSVNURVJfUkVRVUVTVCxhcHBJZDppLHJlZ2lzdGVyUmVxdWVzdHM6cixyZWdpc3RlcmVkS2V5czpuLHRpbWVvdXRTZWNvbmRzOnMscmVxdWVzdElkOm99fSxlLldyYXBwZWRDaHJvbWVSdW50aW1lUG9ydF8ucHJvdG90eXBlLnBvc3RNZXNzYWdlPWZ1bmN0aW9uKHQpe3RoaXMucG9ydF8ucG9zdE1lc3NhZ2UodCl9LGUuV3JhcHBlZENocm9tZVJ1bnRpbWVQb3J0Xy5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbih0LGUpe3ZhciBpPXQudG9Mb3dlckNhc2UoKTsibWVzc2FnZSI9PWl8fCJvbm1lc3NhZ2UiPT1pP3RoaXMucG9ydF8ub25NZXNzYWdlLmFkZExpc3RlbmVyKGZ1bmN0aW9uKHQpe2Uoe2RhdGE6dH0pfSk6Y29uc29sZS5lcnJvcigiV3JhcHBlZENocm9tZVJ1bnRpbWVQb3J0IG9ubHkgc3VwcG9ydHMgb25NZXNzYWdlIil9LGUuV3JhcHBlZEF1dGhlbnRpY2F0b3JQb3J0Xz1mdW5jdGlvbigpe3RoaXMucmVxdWVzdElkXz0tMSx0aGlzLnJlcXVlc3RPYmplY3RfPW51bGx9LGUuV3JhcHBlZEF1dGhlbnRpY2F0b3JQb3J0Xy5wcm90b3R5cGUucG9zdE1lc3NhZ2U9ZnVuY3Rpb24odCl7dmFyIGk9ZS5XcmFwcGVkQXV0aGVudGljYXRvclBvcnRfLklOVEVOVF9VUkxfQkFTRV8rIjtTLnJlcXVlc3Q9IitlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkodCkpKyI7ZW5kIjtkb2N1bWVudC5sb2NhdGlvbj1pfSxlLldyYXBwZWRBdXRoZW50aWNhdG9yUG9ydF8ucHJvdG90eXBlLmdldFBvcnRUeXBlPWZ1bmN0aW9uKCl7cmV0dXJuIldyYXBwZWRBdXRoZW50aWNhdG9yUG9ydF8ifSxlLldyYXBwZWRBdXRoZW50aWNhdG9yUG9ydF8ucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24odCxlKXt2YXIgaT10LnRvTG93ZXJDYXNlKCk7aWYoIm1lc3NhZ2UiPT1pKXt2YXIgbj10aGlzO3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIixuLm9uUmVxdWVzdFVwZGF0ZV8uYmluZChuLGUpLCExKX1lbHNlIGNvbnNvbGUuZXJyb3IoIldyYXBwZWRBdXRoZW50aWNhdG9yUG9ydCBvbmx5IHN1cHBvcnRzIG1lc3NhZ2UiKX0sZS5XcmFwcGVkQXV0aGVudGljYXRvclBvcnRfLnByb3RvdHlwZS5vblJlcXVlc3RVcGRhdGVfPWZ1bmN0aW9uKHQsZSl7dmFyIGk9SlNPTi5wYXJzZShlLmRhdGEpLG49KGkuaW50ZW50VVJMLGkuZXJyb3JDb2RlLG51bGwpO2kuaGFzT3duUHJvcGVydHkoImRhdGEiKSYmKG49SlNPTi5wYXJzZShpLmRhdGEpKSx0KHtkYXRhOm59KX0sZS5XcmFwcGVkQXV0aGVudGljYXRvclBvcnRfLklOVEVOVF9VUkxfQkFTRV89ImludGVudDojSW50ZW50O2FjdGlvbj1jb20uZ29vZ2xlLmFuZHJvaWQuYXBwcy5hdXRoZW50aWNhdG9yLkFVVEhFTlRJQ0FURSIsZS5XcmFwcGVkSW9zUG9ydF89ZnVuY3Rpb24oKXt9LGUuV3JhcHBlZElvc1BvcnRfLnByb3RvdHlwZS5wb3N0TWVzc2FnZT1mdW5jdGlvbih0KXt2YXIgZT1KU09OLnN0cmluZ2lmeSh0KSxpPSJ1MmY6Ly9hdXRoPyIrZW5jb2RlVVJJKGUpO2xvY2F0aW9uLnJlcGxhY2UoaSl9LGUuV3JhcHBlZElvc1BvcnRfLnByb3RvdHlwZS5nZXRQb3J0VHlwZT1mdW5jdGlvbigpe3JldHVybiJXcmFwcGVkSW9zUG9ydF8ifSxlLldyYXBwZWRJb3NQb3J0Xy5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbih0LGUpe3ZhciBpPXQudG9Mb3dlckNhc2UoKTsibWVzc2FnZSIhPT1pJiZjb25zb2xlLmVycm9yKCJXcmFwcGVkSW9zUG9ydCBvbmx5IHN1cHBvcnRzIG1lc3NhZ2UiKX0sZS5nZXRJZnJhbWVQb3J0Xz1mdW5jdGlvbih0KXt2YXIgaT0iY2hyb21lLWV4dGVuc2lvbjovLyIrZS5FWFRFTlNJT05fSUQsbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKTtuLnNyYz1pKyIvdTJmLWNvbW1zLmh0bWwiLG4uc2V0QXR0cmlidXRlKCJzdHlsZSIsImRpc3BsYXk6bm9uZSIpLGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobik7dmFyIHI9bmV3IE1lc3NhZ2VDaGFubmVsLHM9ZnVuY3Rpb24oZSl7InJlYWR5Ij09ZS5kYXRhPyhyLnBvcnQxLnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLHMpLHQoci5wb3J0MSkpOmNvbnNvbGUuZXJyb3IoJ0ZpcnN0IGV2ZW50IG9uIGlmcmFtZSBwb3J0IHdhcyBub3QgInJlYWR5IicpfTtyLnBvcnQxLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLHMpLHIucG9ydDEuc3RhcnQoKSxuLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLGZ1bmN0aW9uKCl7bi5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKCJpbml0IixpLFtyLnBvcnQyXSl9KX0sZS5FWFRFTlNJT05fVElNRU9VVF9TRUM9MzAsZS5wb3J0Xz1udWxsLGUud2FpdGluZ0ZvclBvcnRfPVtdLGUucmVxQ291bnRlcl89MCxlLmNhbGxiYWNrTWFwXz17fSxlLmdldFBvcnRTaW5nbGV0b25fPWZ1bmN0aW9uKHQpe2UucG9ydF8/dChlLnBvcnRfKTooMD09ZS53YWl0aW5nRm9yUG9ydF8ubGVuZ3RoJiZlLmdldE1lc3NhZ2VQb3J0KGZ1bmN0aW9uKHQpe2ZvcihlLnBvcnRfPXQsZS5wb3J0Xy5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIixlLnJlc3BvbnNlSGFuZGxlcl8pO2Uud2FpdGluZ0ZvclBvcnRfLmxlbmd0aDspZS53YWl0aW5nRm9yUG9ydF8uc2hpZnQoKShlLnBvcnRfKX0pLGUud2FpdGluZ0ZvclBvcnRfLnB1c2godCkpfSxlLnJlc3BvbnNlSGFuZGxlcl89ZnVuY3Rpb24odCl7dmFyIGk9dC5kYXRhLG49aS5yZXF1ZXN0SWQ7aWYoIW58fCFlLmNhbGxiYWNrTWFwX1tuXSlyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKCJVbmtub3duIG9yIG1pc3NpbmcgcmVxdWVzdElkIGluIHJlc3BvbnNlLiIpO3ZhciByPWUuY2FsbGJhY2tNYXBfW25dO2RlbGV0ZSBlLmNhbGxiYWNrTWFwX1tuXSxyKGkucmVzcG9uc2VEYXRhKX0sZS5zaWduPWZ1bmN0aW9uKGksbixyLHMsbyl7dm9pZCAwPT09dD9lLmdldEFwaVZlcnNpb24oZnVuY3Rpb24oYSl7dD12b2lkIDA9PT1hLmpzX2FwaV92ZXJzaW9uPzA6YS5qc19hcGlfdmVyc2lvbixjb25zb2xlLmxvZygiRXh0ZW5zaW9uIEpTIEFQSSBWZXJzaW9uOiAiLHQpLGUuc2VuZFNpZ25SZXF1ZXN0KGksbixyLHMsbyl9KTplLnNlbmRTaWduUmVxdWVzdChpLG4scixzLG8pfSxlLnNlbmRTaWduUmVxdWVzdD1mdW5jdGlvbih0LGksbixyLHMpe2UuZ2V0UG9ydFNpbmdsZXRvbl8oZnVuY3Rpb24obyl7dmFyIGE9KytlLnJlcUNvdW50ZXJfO2UuY2FsbGJhY2tNYXBfW2FdPXI7dmFyIGw9InVuZGVmaW5lZCIhPXR5cGVvZiBzP3M6ZS5FWFRFTlNJT05fVElNRU9VVF9TRUMsYz1lLmZvcm1hdFNpZ25SZXF1ZXN0Xyh0LGksbixsLGEpO28ucG9zdE1lc3NhZ2UoYyl9KX0sZS5yZWdpc3Rlcj1mdW5jdGlvbihpLG4scixzLG8pe3ZvaWQgMD09PXQ/ZS5nZXRBcGlWZXJzaW9uKGZ1bmN0aW9uKGEpe3Q9dm9pZCAwPT09YS5qc19hcGlfdmVyc2lvbj8wOmEuanNfYXBpX3ZlcnNpb24sY29uc29sZS5sb2coIkV4dGVuc2lvbiBKUyBBUEkgVmVyc2lvbjogIix0KSxlLnNlbmRSZWdpc3RlclJlcXVlc3QoaSxuLHIscyxvKX0pOmUuc2VuZFJlZ2lzdGVyUmVxdWVzdChpLG4scixzLG8pfSxlLnNlbmRSZWdpc3RlclJlcXVlc3Q9ZnVuY3Rpb24odCxpLG4scixzKXtlLmdldFBvcnRTaW5nbGV0b25fKGZ1bmN0aW9uKG8pe3ZhciBhPSsrZS5yZXFDb3VudGVyXztlLmNhbGxiYWNrTWFwX1thXT1yO3ZhciBsPSJ1bmRlZmluZWQiIT10eXBlb2Ygcz9zOmUuRVhURU5TSU9OX1RJTUVPVVRfU0VDLGM9ZS5mb3JtYXRSZWdpc3RlclJlcXVlc3RfKHQsbixpLGwsYSk7by5wb3N0TWVzc2FnZShjKX0pfSxlLmdldEFwaVZlcnNpb249ZnVuY3Rpb24odCxpKXtlLmdldFBvcnRTaW5nbGV0b25fKGZ1bmN0aW9uKG4pe2lmKG4uZ2V0UG9ydFR5cGUpe3ZhciByO3N3aXRjaChuLmdldFBvcnRUeXBlKCkpe2Nhc2UiV3JhcHBlZElvc1BvcnRfIjpjYXNlIldyYXBwZWRBdXRoZW50aWNhdG9yUG9ydF8iOnI9MS4xO2JyZWFrO2RlZmF1bHQ6cj0wfXJldHVybiB2b2lkIHQoe2pzX2FwaV92ZXJzaW9uOnJ9KX12YXIgcz0rK2UucmVxQ291bnRlcl87ZS5jYWxsYmFja01hcF9bc109dDt2YXIgbz17dHlwZTplLk1lc3NhZ2VUeXBlcy5VMkZfR0VUX0FQSV9WRVJTSU9OX1JFUVVFU1QsdGltZW91dFNlY29uZHM6InVuZGVmaW5lZCIhPXR5cGVvZiBpP2k6ZS5FWFRFTlNJT05fVElNRU9VVF9TRUMscmVxdWVzdElkOnN9O24ucG9zdE1lc3NhZ2Uobyl9KX19fSgpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NSksaSgzMDEpLGkoMjk5KSxpKDIzNiksaSgzMzkpLGkoMzQwKV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvKXt2YXIgYT10Ll87cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6ImVucm9sbC1jaG9pY2VzIixzdGF0ZTp7cGFnZVR5cGU6bnVsbH0sTW9kZWw6e30sRm9ybTp7bm9DYW5jZWxCdXR0b246ITAsdGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJlbnJvbGwuY2hvaWNlcy50aXRsZSIsImxvZ2luIiksbm9CdXR0b25CYXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGF0ZS5nZXQoInBhZ2VUeXBlIik9PT1pLkFMTF9PUFRJT05BTF9OT05FX0VOUk9MTEVEfSxzdWJ0aXRsZTpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLnN0YXRlLmdldCgicGFnZVR5cGUiKSl7Y2FzZSBpLkFMTF9PUFRJT05BTF9TT01FX0VOUk9MTEVEOmNhc2UgaS5IQVNfUkVRVUlSRURfQUxMX1JFUVVJUkVEX0VOUk9MTEVEOnJldHVybiB0LmxvYygiZW5yb2xsLmNob2ljZXMub3B0aW9uYWwiLCJsb2dpbiIpO2RlZmF1bHQ6cmV0dXJuIHQubG9jKCJlbnJvbGwuY2hvaWNlcy5kZXNjcmlwdGlvbiIsImxvZ2luIil9fSxzYXZlOmZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuc3RhdGUuZ2V0KCJwYWdlVHlwZSIpKXtjYXNlIGkuQUxMX09QVElPTkFMX1NPTUVfRU5ST0xMRUQ6Y2FzZSBpLkhBU19SRVFVSVJFRF9BTExfUkVRVUlSRURfRU5ST0xMRUQ6cmV0dXJuIHQubG9jKCJlbnJvbGwuY2hvaWNlcy5zdWJtaXQuZmluaXNoIiwibG9naW4iKTtjYXNlIGkuSEFTX1JFUVVJUkVEX05PTkVfRU5ST0xMRUQ6cmV0dXJuIHQubG9jKCJlbnJvbGwuY2hvaWNlcy5zdWJtaXQuY29uZmlndXJlIiwibG9naW4iKTtjYXNlIGkuSEFTX1JFUVVJUkVEX1NPTUVfUkVRVUlSRURfRU5ST0xMRUQ6cmV0dXJuIHQubG9jKCJlbnJvbGwuY2hvaWNlcy5zdWJtaXQubmV4dCIsImxvZ2luIik7ZGVmYXVsdDpyZXR1cm4iIn19LGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dGhpcy5saXN0ZW5Ubyh0aGlzLCJzYXZlIixmdW5jdGlvbigpe3ZhciBlO3N3aXRjaCh0aGlzLnN0YXRlLmdldCgicGFnZVR5cGUiKSl7Y2FzZSBpLkhBU19SRVFVSVJFRF9OT05FX0VOUk9MTEVEOmNhc2UgaS5IQVNfUkVRVUlSRURfU09NRV9SRVFVSVJFRF9FTlJPTExFRDplPXQuYXBwU3RhdGUuZ2V0KCJmYWN0b3JzIikuZ2V0Rmlyc3RVbmVucm9sbGVkUmVxdWlyZWRGYWN0b3IoKSx0LmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIixuLmNyZWF0ZUVucm9sbEZhY3RvclVybChlLmdldCgicHJvdmlkZXIiKSxlLmdldCgiZmFjdG9yVHlwZSIpKSk7YnJlYWs7ZGVmYXVsdDpyZXR1cm4gdGhpcy5tb2RlbC5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnNraXAoKX0pfX0pfSxwcmVSZW5kZXI6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJmYWN0b3JzIik7c3dpdGNoKHRoaXMuc3RhdGUuZ2V0KCJwYWdlVHlwZSIpKXtjYXNlIGkuSEFTX1JFUVVJUkVEX05PTkVfRU5ST0xMRUQ6Y2FzZSBpLkhBU19SRVFVSVJFRF9TT01FX1JFUVVJUkVEX0VOUk9MTEVEOnRoaXMuYWRkKG5ldyBvKHttaW5pbWl6ZTohMCxjb2xsZWN0aW9uOm5ldyB0LkNvbGxlY3Rpb24oZS53aGVyZSh7cmVxdWlyZWQ6ITB9KSksYXBwU3RhdGU6dGhpcy5vcHRpb25zLmFwcFN0YXRlfSkpO2JyZWFrO2Nhc2UgaS5IQVNfUkVRVUlSRURfQUxMX1JFUVVJUkVEX0VOUk9MTEVEOmNhc2UgaS5BTExfT1BUSU9OQUxfU09NRV9FTlJPTExFRDpjYXNlIGkuQUxMX09QVElPTkFMX05PTkVfRU5ST0xMRUQ6dmFyIG4scj1lLndoZXJlKHtlbnJvbGxlZDohMH0pLGE9ZS53aGVyZSh7ZW5yb2xsZWQ6ITF9KTtyLmxlbmd0aD4wJiYobj10LmxvYygiZW5yb2xsLmNob2ljZXMubGlzdC5vcHRpb25hbCIsImxvZ2luIiksdGhpcy5hZGQobmV3IHMoe2xpc3RUaXRsZTp0LmxvYygiZW5yb2xsLmNob2ljZXMubGlzdC5lbnJvbGxlZCIsImxvZ2luIiksbWluaW1pemU6ITAsY29sbGVjdGlvbjpuZXcgdC5Db2xsZWN0aW9uKHIpLGFwcFN0YXRlOnRoaXMub3B0aW9ucy5hcHBTdGF0ZX0pKSksdGhpcy5hZGQobmV3IHMoe2xpc3RUaXRsZTpuLGNvbGxlY3Rpb246bmV3IHQuQ29sbGVjdGlvbihhKSxhcHBTdGF0ZTp0aGlzLm9wdGlvbnMuYXBwU3RhdGV9KSl9fX0saW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt2YXIgZSxuLHI9MCxzPTAsbz0wLGE9MDt0LmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpLmVhY2goZnVuY3Rpb24odCl7dmFyIGU9dC5nZXQoInJlcXVpcmVkIiksaT10LmdldCgiZW5yb2xsZWQiKTtlJiZpP3IrKzplJiYhaT9zKys6IWUmJmk/bysrOmV8fGl8fGErK30pLGU9cj4wfHxzPjAsZSYmMD09PXI/bj1pLkhBU19SRVFVSVJFRF9OT05FX0VOUk9MTEVEOmUmJnM+MD9uPWkuSEFTX1JFUVVJUkVEX1NPTUVfUkVRVUlSRURfRU5ST0xMRUQ6ZSYmYT4wP249aS5IQVNfUkVRVUlSRURfQUxMX1JFUVVJUkVEX0VOUk9MTEVEOjA9PT1vJiZhPjA/bj1pLkFMTF9PUFRJT05BTF9OT05FX0VOUk9MTEVEOmE+MD9uPWkuQUxMX09QVElPTkFMX1NPTUVfRU5ST0xMRUQ6dGhpcy5tb2RlbC5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnNraXAoKX0pLHRoaXMuc3RhdGUuc2V0KCJwYWdlVHlwZSIsbil9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTkpXSxyPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5fLG49dC5WaWV3LmV4dGVuZCh7Y2xhc3NOYW1lOiJlbnJvbGwtZmFjdG9yLXJvdyBjbGVhcmZpeCIsdGVtcGxhdGU6J1x0ICAgICAgPGRpdiBjbGFzcz0iZW5yb2xsLWZhY3Rvci1pY29uLWNvbnRhaW5lciI+XHQgICAgICAgIDxkaXYgY2xhc3M9ImZhY3Rvci1pY29uIGVucm9sbC1mYWN0b3ItaWNvbiB7e2ljb25DbGFzc05hbWV9fSI+XHQgICAgICAgIDwvZGl2Plx0ICAgICAgPC9kaXY+XHQgICAgICA8ZGl2IGNsYXNzPSJlbnJvbGwtZmFjdG9yLWRlc2NyaXB0aW9uIj5cdCAgICAgICAgPGgzIGNsYXNzPSJlbnJvbGwtZmFjdG9yLWxhYmVsIj57e2ZhY3RvckxhYmVsfX08L2gzPlx0ICAgICAgICB7eyNpZiBmYWN0b3JEZXNjcmlwdGlvbn19XHQgICAgICAgICAgPHA+e3tmYWN0b3JEZXNjcmlwdGlvbn19PC9wPlx0ICAgICAgICB7ey9pZn19XHQgICAgICAgIDxkaXYgY2xhc3M9ImVucm9sbC1mYWN0b3ItYnV0dG9uIj48L2Rpdj5cdCAgICAgIDwvZGl2Plx0ICAgICcsYXR0cmlidXRlczpmdW5jdGlvbigpe3JldHVybnsiZGF0YS1zZSI6dGhpcy5tb2RlbC5nZXQoImZhY3Rvck5hbWUiKX19LGNoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJlbnJvbGxlZCIpP1tbJzxzcGFuIGNsYXNzPSJpY29uIHN1Y2Nlc3MtMTYtZ3JlZW4iPjwvc3Bhbj4nLCIuZW5yb2xsLWZhY3Rvci1sYWJlbCJdXToiUkVRVUlSRUQiPT09dGhpcy5tb2RlbC5nZXQoImVucm9sbG1lbnQiKT9bWyc8c3BhbiBjbGFzcz0iaWNvbiBzdWNjZXNzLTE2LWdyYXkiPjwvc3Bhbj4nLCIuZW5yb2xsLWZhY3Rvci1sYWJlbCJdXTpbW3QuY3JlYXRlQnV0dG9uKHtjbGFzc05hbWU6ImJ1dHRvbiIsdGl0bGU6dC5sb2MoImVucm9sbC5jaG9pY2VzLnNldHVwIiwibG9naW4iKSxjbGljazpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsZS5jcmVhdGVFbnJvbGxGYWN0b3JVcmwodGhpcy5tb2RlbC5nZXQoInByb3ZpZGVyIiksdGhpcy5tb2RlbC5nZXQoImZhY3RvclR5cGUiKSkpfX0pLCIuZW5yb2xsLWZhY3Rvci1idXR0b24iXV19LG1pbmltaXplOmZ1bmN0aW9uKCl7dGhpcy4kZWwuYWRkQ2xhc3MoImVucm9sbC1mYWN0b3Itcm93LW1pbiIpfSxtYXhpbWl6ZTpmdW5jdGlvbigpe3RoaXMuJGVsLnJlbW92ZUNsYXNzKCJlbnJvbGwtZmFjdG9yLXJvdy1taW4iKX19KTtyZXR1cm4gdC5MaXN0Vmlldy5leHRlbmQoe2NsYXNzTmFtZToiZW5yb2xsLWZhY3Rvci1saXN0IixpdGVtOm4saXRlbVNlbGVjdG9yOiIubGlzdC1jb250ZW50Iix0ZW1wbGF0ZTonXHQgICAgICB7eyNpZiBsaXN0U3VidGl0bGV9fVx0ICAgICAgICA8ZGl2IGNsYXNzPSJsaXN0LXN1YnRpdGxlIj57e2xpc3RTdWJ0aXRsZX19PC9kaXY+XHQgICAgICB7ey9pZn19XHQgICAgICB7eyNpZiBsaXN0VGl0bGV9fVx0ICAgICAgICA8ZGl2IGNsYXNzPSJsaXN0LXRpdGxlIj57e2xpc3RUaXRsZX19PC9kaXY+XHQgICAgICB7ey9pZn19XHQgICAgICA8ZGl2IGNsYXNzPSJsaXN0LWNvbnRlbnQiPjwvZGl2Plx0ICAgICcsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7dmFyIGU9dC5MaXN0Vmlldy5wcm90b3R5cGUuZ2V0VGVtcGxhdGVEYXRhLmNhbGwodGhpcyk7cmV0dXJuIGkuZXh0ZW5kKGUsdGhpcyksZX0scG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5taW5pbWl6ZSYmdGhpcy5pbnZva2UoIm1pbmltaXplIil9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgzMzkpXSxyPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5fO3JldHVybiBlLmV4dGVuZCh7bGlzdFRpdGxlOmkucGFydGlhbCh0LmxvYywiZW5yb2xsLmNob2ljZXMubGlzdC5zZXR1cCIsImxvZ2luIiksY2xhc3NOYW1lOmZ1bmN0aW9uKCl7cmV0dXJuIGUucHJvdG90eXBlLmNsYXNzTmFtZSsiIGVucm9sbC1yZXF1aXJlZC1mYWN0b3ItbGlzdCJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmNvbGxlY3Rpb24ubGVuZ3RoLGk9dGhpcy5jb2xsZWN0aW9uLndoZXJlKHtlbnJvbGxlZDohMH0pLmxlbmd0aCxuPWkrMTt0aGlzLmxpc3RTdWJ0aXRsZT10LmxvYygiZW5yb2xsLmNob2ljZXMuc3RlcCIsImxvZ2luIixbbixlXSl9LHBvc3RSZW5kZXI6ZnVuY3Rpb24oKXt2YXIgdCxpO2UucHJvdG90eXBlLnBvc3RSZW5kZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLHQ9dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpLmdldEZpcnN0VW5lbnJvbGxlZFJlcXVpcmVkRmFjdG9yKCksaT10aGlzLmZpbmQoZnVuY3Rpb24oZSl7cmV0dXJuIGUubW9kZWw9PT10fSksaS5tYXhpbWl6ZSgpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzE5KSxpKDIxKSxpKDI5NSksaSgzNDIpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9dC4kLG89dC5fO3JldHVybiBuLmV4dGVuZCh7Y2xhc3NOYW1lOiJlbnJvbGwtZHVvIGR1by1mb3JtIixNb2RlbDp7cHJvcHM6e2hvc3Q6InN0cmluZyIsc2lnbmF0dXJlOiJzdHJpbmciLHBvc3RBY3Rpb246InN0cmluZyIsZmFjdG9ySWQ6InN0cmluZyIsc3RhdGVUb2tlbjoic3RyaW5nIn0sZ2V0SW5pdE9wdGlvbnM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3ZhciBlPW8uZmluZFdoZXJlKHQuZmFjdG9ycyx7ZmFjdG9yVHlwZToid2ViIixwcm92aWRlcjoiRFVPIn0pO3JldHVybiBlLmVucm9sbCgpfSl9LGFjdGl2YXRlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0KCJwb3N0QWN0aW9uIiksbj10aGlzLmdldCgiZmFjdG9ySWQiKSxyPXRoaXMsbz17aWQ6bixzdGF0ZVRva2VuOnRoaXMuZ2V0KCJzdGF0ZVRva2VuIiksc2lnX3Jlc3BvbnNlOnR9O3JldHVybiBpKHMucG9zdChlLG8pKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIHIuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdC5wb2xsKCl9KX0pLmZhaWwoZnVuY3Rpb24odCl7ci50cmlnZ2VyKCJlcnJvciIscix0Lnhocil9KX19LEZvcm06e2F1dG9TYXZlOiEwLG5vQnV0dG9uQmFyOiEwLHRpdGxlOm8ucGFydGlhbCh0LmxvYywiZW5yb2xsLmR1by50aXRsZSIsImxvZ2luIikscG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMuYWRkKCc8aWZyYW1lIGZyYW1lYm9yZGVyPSIwIiB0aXRsZT0iJyt0aGlzLnRpdGxlKCkrJyI+PC9pZnJhbWU+JyksZS5pbml0KHtob3N0OnRoaXMubW9kZWwuZ2V0KCJob3N0Iiksc2lnX3JlcXVlc3Q6dGhpcy5tb2RlbC5nZXQoInNpZ25hdHVyZSIpLGlmcmFtZTp0aGlzLiQoImlmcmFtZSIpLmdldCgwKSxwb3N0X2FjdGlvbjpvLmJpbmQodGhpcy5tb2RlbC5hY3RpdmF0ZSx0aGlzLm1vZGVsKX0pfX0sRm9vdGVyOnIsZmV0Y2hJbml0aWFsRGF0YTpmdW5jdGlvbigpe3ZhciB0PXRoaXM7cmV0dXJuIHRoaXMubW9kZWwuZ2V0SW5pdE9wdGlvbnModGhpcy5vcHRpb25zLmFwcFN0YXRlKS50aGVuKGZ1bmN0aW9uKGUpe3ZhciBpPWUuZGF0YTtpZighKGkmJmkuX2VtYmVkZGVkJiZpLl9lbWJlZGRlZC5mYWN0b3ImJmkuX2VtYmVkZGVkLmZhY3Rvci5fZW1iZWRkZWQmJmkuX2VtYmVkZGVkLmZhY3Rvci5fZW1iZWRkZWQuYWN0aXZhdGlvbikpdGhyb3cgbmV3IEVycm9yKCJSZXNwb25zZSBkb2VzIG5vdCBoYXZlIGR1byBhY3RpdmF0aW9uIG9wdGlvbnMiKTt2YXIgbj1pLl9lbWJlZGRlZC5mYWN0b3Iscj1uLl9lbWJlZGRlZC5hY3RpdmF0aW9uO3QubW9kZWwuc2V0KHtob3N0OnIuaG9zdCxzaWduYXR1cmU6ci5zaWduYXR1cmUscG9zdEFjdGlvbjpyLl9saW5rcy5jb21wbGV0ZS5ocmVmLGZhY3RvcklkOm4uaWQsc3RhdGVUb2tlbjppLnN0YXRlVG9rZW59KX0pfSx0cmFwQXV0aFJlc3BvbnNlOmZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFFbnJvbGxBY3RpdmF0ZSIpKXJldHVybiEwfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzAxKV0scj1mdW5jdGlvbih0LGUpe3JldHVybiB0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICA8YSBocmVmPSIjIiBjbGFzcz0ibGluayBoZWxwIGpzLWJhY2siIGRhdGEtc2U9ImJhY2stbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJtZmEuYmFja1RvRmFjdG9ycyIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICcsY2xhc3NOYW1lOiJhdXRoLWZvb3RlciIsZXZlbnRzOnsiY2xpY2sgLmpzLWJhY2siOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLmJhY2soKX19LGJhY2s6ZnVuY3Rpb24oKXt0aGlzLnN0YXRlLnNldCgibmF2aWdhdGVEaXIiLGUuRElSRUNUSU9OX0JBQ0spLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInByZXZMaW5rIik/dGhpcy5tb2RlbC5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnByZXYoKX0pOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsInNpZ25pbi9lbnJvbGwiKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NSksaSgyOTQpLGkoMzQyKSxpKDMwNildLHI9ZnVuY3Rpb24odCxlLGksbixyKXt2YXIgcz10Ll87cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6ImVucm9sbC1xdWVzdGlvbiIsTW9kZWw6e3Byb3BzOntxdWVzdGlvbjoic3RyaW5nIixhbnN3ZXI6WyJzdHJpbmciLCEwXX0sbG9jYWw6e3NlY3VyaXR5UXVlc3Rpb25zOiJvYmplY3QifSxzYXZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXt2YXIgZT1zLmZpbmRXaGVyZSh0LmZhY3RvcnMse2ZhY3RvclR5cGU6InF1ZXN0aW9uIixwcm92aWRlcjoiT0tUQSJ9KTtyZXR1cm4gZS5lbnJvbGwoe3Byb2ZpbGU6e3F1ZXN0aW9uOnRoaXMuZ2V0KCJxdWVzdGlvbiIpLGFuc3dlcjp0aGlzLmdldCgiYW5zd2VyIil9fSl9KX19LEZvcm06e2F1dG9TYXZlOiEwLHRpdGxlOnMucGFydGlhbCh0LmxvYywiZW5yb2xsLnNlY3VyaXR5UXVlc3Rpb24uc2V0dXAiLCJsb2dpbiIpLGlucHV0czpmdW5jdGlvbigpe3JldHVyblt7bGFiZWw6ITEsImxhYmVsLXRvcCI6ITAsbmFtZToicXVlc3Rpb24iLHR5cGU6InNlbGVjdCIsd2lkZTohMCxvcHRpb25zOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJzZWN1cml0eVF1ZXN0aW9ucyIpfSxwYXJhbXM6e3NlYXJjaFRocmVzaG9sZDoyNX19LHtsYWJlbDohMSwibGFiZWwtdG9wIjohMCxwbGFjZWhvbGRlcjp0LmxvYygibWZhLmNoYWxsZW5nZS5hbnN3ZXIucGxhY2Vob2xkZXIiLCJsb2dpbiIpLGNsYXNzTmFtZToiby1mb3JtLWZpZWxkc2V0IG8tZm9ybS1sYWJlbC10b3AgYXV0aC1wYXNzY29kZSIsbmFtZToiYW5zd2VyIixpbnB1dDpyLHR5cGU6InRleHQiLHBhcmFtczp7aW5uZXJUb29sdGlwOnQubG9jKCJtZmEuY2hhbGxlbmdlLmFuc3dlci50b29sdGlwIiwibG9naW4iKX19XX19LEZvb3RlcjpuLGZldGNoSW5pdGlhbERhdGE6ZnVuY3Rpb24oKXt2YXIgdD10aGlzO3JldHVybiB0aGlzLm1vZGVsLm1hbmFnZVRyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3ZhciBlPXMuZmluZFdoZXJlKHQuZmFjdG9ycyx7ZmFjdG9yVHlwZToicXVlc3Rpb24iLHByb3ZpZGVyOiJPS1RBIn0pO3JldHVybiBlLnF1ZXN0aW9ucygpfSkudGhlbihmdW5jdGlvbihlKXt2YXIgbj17fTtzLmVhY2goZSxmdW5jdGlvbih0KXtuW3QucXVlc3Rpb25dPWkuZ2V0U2VjdXJpdHlRdWVzdGlvbkxhYmVsKHQpfSksdC5tb2RlbC5zZXQoInNlY3VyaXR5UXVlc3Rpb25zIixuKX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KSxpKDI5NiksaSgzMzMpLGkoMzM0KSxpKDM0MiksaSgzMzUpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe3ZhciBhPXQuXztyZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZToiZW5yb2xsLXdpbmRvd3MtaGVsbG8iLE1vZGVsOntsb2NhbDp7X19pc0Vucm9sbGVkX186ImJvb2xlYW4ifSxzYXZlOmZ1bmN0aW9uKCl7aWYobi5pc0F2YWlsYWJsZSgpKXJldHVybiB0aGlzLnRyaWdnZXIoInJlcXVlc3QiKSx0aGlzLmdldCgiX19pc0Vucm9sbGVkX18iKT90aGlzLmFjdGl2YXRlKCk6dGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9lbnJvbGwodCl9KX0sX2Vucm9sbDpmdW5jdGlvbih0KXt2YXIgZT1hLmZpbmRXaGVyZSh0LmZhY3RvcnMse2ZhY3RvclR5cGU6IndlYmF1dGhuIixwcm92aWRlcjoiRklETyJ9KTtyZXR1cm4gZS5lbnJvbGwoKX0sYWN0aXZhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZXQoIl9faXNFbnJvbGxlZF9fIiwhMCksdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3ZhciBlPXQuZmFjdG9yLmFjdGl2YXRpb24saT10LnVzZXIscj10aGlzLHM9e3JwRGlzcGxheU5hbWU6ZS5ycERpc3BsYXlOYW1lLHVzZXJEaXNwbGF5TmFtZTppLnByb2ZpbGUuZGlzcGxheU5hbWUsYWNjb3VudE5hbWU6aS5wcm9maWxlLmxvZ2luLHVzZXJJZDppLmlkfSxvPVt7YWxnb3JpdGhtOmUuYWxnb3JpdGhtfV0sYT1lLm5vbmNlO3JldHVybiBuLm1ha2VDcmVkZW50aWFsKHMsbyxhKS50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiB0LmFjdGl2YXRlKHtjcmVkZW50aWFsSWQ6ZS5jcmVkZW50aWFsLmlkLHB1YmxpY0tleTplLnB1YmxpY0tleSxhdHRlc3RhdGlvbjpudWxsfSl9KS5mYWlsKGZ1bmN0aW9uKGUpe3N3aXRjaChlLm1lc3NhZ2Upe2Nhc2UiQWJvcnRFcnJvciI6Y2FzZSJOb3RGb3VuZEVycm9yIjpjYXNlIk5vdFN1cHBvcnRlZEVycm9yIjpyZXR1cm4gci50cmlnZ2VyKCJhYm9ydCIsZS5tZXNzYWdlKSx0fXRocm93IGV9KX0pfX0sRm9ybTp7YXV0b1NhdmU6ITAsaGFzU2F2aW5nU3RhdGU6ITEsdGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJlbnJvbGwud2luZG93c0hlbGxvLnRpdGxlIiwibG9naW4iKSxzdWJ0aXRsZTpmdW5jdGlvbigpe3JldHVybiBuLmlzQXZhaWxhYmxlKCk/dC5sb2MoImVucm9sbC53aW5kb3dzSGVsbG8uc3VidGl0bGUiLCJsb2dpbiIpOiIifSxzYXZlOmEucGFydGlhbCh0LmxvYywiZW5yb2xsLndpbmRvd3NIZWxsby5zYXZlIiwibG9naW4iKSxjdXN0b21TYXZpbmdTdGF0ZTp7c3RvcDoiYWJvcnQifSxtb2RlbEV2ZW50czpmdW5jdGlvbigpe3JldHVybiBuLmlzQXZhaWxhYmxlKCk/e3JlcXVlc3Q6Il9zdGFydEVucm9sbG1lbnQiLGVycm9yOiJfc3RvcEVucm9sbG1lbnQiLGFib3J0OiJfc3RvcEVucm9sbG1lbnQifTp7fX0sbm9CdXR0b25CYXI6ZnVuY3Rpb24oKXtyZXR1cm4hbi5pc0F2YWlsYWJsZSgpfSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXt2YXIgZT1bXTtyZXR1cm4gbi5pc0F2YWlsYWJsZSgpfHxlLnB1c2goaS5WaWV3KHtWaWV3Om5ldyBvKHttZXNzYWdlOnQubG9jKCJlbnJvbGwud2luZG93c0hlbGxvLmVycm9yLm5vdFdpbmRvd3MiLCJsb2dpbiIpfSl9LHtzZWxlY3RvcjoiLm8tZm9ybS1lcnJvci1jb250YWluZXIifSkpLGUucHVzaChpLlZpZXcoe1ZpZXc6bmV3IHIoe21vZGVsOnRoaXMubW9kZWwsdmlzaWJsZTohMX0pfSkpLGV9LF9zdGFydEVucm9sbG1lbnQ6ZnVuY3Rpb24oKXt0aGlzLnN1YnRpdGxlPXQubG9jKCJlbnJvbGwud2luZG93c0hlbGxvLnN1YnRpdGxlLmxvYWRpbmciLCJsb2dpbiIpLHRoaXMubW9kZWwudHJpZ2dlcigic3Bpbm5lcjpzaG93IiksdGhpcy5fcmVzZXRFcnJvck1lc3NhZ2UoKSx0aGlzLnJlbmRlcigpLHRoaXMuJCgiLm8tZm9ybS1idXR0b24tYmFyIikuYWRkQ2xhc3MoImhpZGUiKX0sX3N0b3BFbnJvbGxtZW50OmZ1bmN0aW9uKGUpe3RoaXMuc3VidGl0bGU9dC5sb2MoImVucm9sbC53aW5kb3dzSGVsbG8uc3VidGl0bGUiLCJsb2dpbiIpLHRoaXMubW9kZWwudHJpZ2dlcigic3Bpbm5lcjpoaWRlIiksdGhpcy4kKCIuby1mb3JtLWJ1dHRvbi1iYXIiKS5yZW1vdmVDbGFzcygiaGlkZSIpO3ZhciBpO3N3aXRjaChlKXtjYXNlIk5vdFN1cHBvcnRlZEVycm9yIjppPXQubG9jKCJlbnJvbGwud2luZG93c0hlbGxvLmVycm9yLm5vdENvbmZpZ3VyZWRIdG1sIiwibG9naW4iKX1pZih0aGlzLl9yZXNldEVycm9yTWVzc2FnZSgpLGkpe3ZhciBuPW5ldyBvKHttZXNzYWdlOml9KTt0aGlzLiQoIi5vLWZvcm0tZXJyb3ItY29udGFpbmVyIikuYWRkQ2xhc3MoIm8tZm9ybS1oYXMtZXJyb3JzIiksdGhpcy5hZGQobix7c2VsZWN0b3I6Ii5vLWZvcm0tZXJyb3ItY29udGFpbmVyIn0pLHRoaXMuX2Vycm9yTWVzc2FnZVZpZXc9dGhpcy5sYXN0KCl9dGhpcy5yZW5kZXIoKX0sX3Jlc2V0RXJyb3JNZXNzYWdlOmZ1bmN0aW9uKCl7dGhpcy5fZXJyb3JNZXNzYWdlVmlldyYmdGhpcy5fZXJyb3JNZXNzYWdlVmlldy5yZW1vdmUoKSx0aGlzLl9lcnJvck1lc3NhZ2VWaWV3PXZvaWQgMCx0aGlzLmNsZWFyRXJyb3JzKCl9fSxGb290ZXI6cyx0cmFwQXV0aFJlc3BvbnNlOmZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFFbnJvbGxBY3RpdmF0ZSIpKXJldHVybiB0aGlzLm1vZGVsLmFjdGl2YXRlKCksITB9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTUpLGkoMzQyKSxpKDMwNSksaSgzMDYpLGkoMjkyKSxpKDI5NiksaSgxNzMpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSl7ZnVuY3Rpb24gbCh0KXtyZXR1cm4iY2FsbCI9PT10fWZ1bmN0aW9uIGModCl7cmV0dXJuIGwodCk/ImVucm9sbC1jYWxsIjoiZW5yb2xsLXNtcyJ9ZnVuY3Rpb24gdSh0KXthLmlzRW50ZXIodCkmJih0LnN0b3BQcm9wYWdhdGlvbigpLHQucHJldmVudERlZmF1bHQoKSwia2V5dXAiPT09dC50eXBlJiZ0LmRhdGEmJnQuZGF0YS5tb2RlbCYmdC5kYXRhLm1vZGVsLnNlbmRDb2RlKCkpfXZhciBkPXQuXyxoPTNlNCxwPXtmYWN0b3JJZDpmdW5jdGlvbih0KXtyZXR1cm4hZC5pc1VuZGVmaW5lZCh0KX19O3JldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOmZ1bmN0aW9uKCl7cmV0dXJuIGModGhpcy5vcHRpb25zLmZhY3RvclR5cGUpfSxNb2RlbDp7cHJvcHM6e2NvdW50cnlDb2RlOlsic3RyaW5nIiwhMCwiVVMiXSxwaG9uZU51bWJlcjpbInN0cmluZyIsITBdLHBob25lRXh0ZW5zaW9uOlsic3RyaW5nIiwhMV0sbGFzdEVucm9sbGVkUGhvbmVOdW1iZXI6InN0cmluZyIscGFzc0NvZGU6WyJzdHJpbmciLCEwXSxmYWN0b3JJZDoic3RyaW5nIn0sbG9jYWw6e2hhc0V4aXN0aW5nUGhvbmVzOiJib29sZWFuIix0cmFwRW5yb2xsbWVudDoiYm9vbGVhbiIsYWJsZVRvUmVzZW5kOiJib29sZWFuIixmYWN0b3JUeXBlOiJzdHJpbmciLHNraXBQaG9uZVZhbGlkYXRpb246ImJvb2xlYW4ifSxkZXJpdmVkOntjb3VudHJ5Q2FsbGluZ0NvZGU6e2RlcHM6WyJjb3VudHJ5Q29kZSJdLGZuOmZ1bmN0aW9uKHQpe3JldHVybiIrIitzLmdldENhbGxpbmdDb2RlRm9yQ291bnRyeSh0KX19LGZ1bGxQaG9uZU51bWJlcjp7ZGVwczpbImNvdW50cnlDYWxsaW5nQ29kZSIsInBob25lTnVtYmVyIl0sZm46ZnVuY3Rpb24odCxlKXtyZXR1cm4gZT90K2U6IiJ9fSxlbnJvbGxlZDp7ZGVwczpbImxhc3RFbnJvbGxlZFBob25lTnVtYmVyIiwiZnVsbFBob25lTnVtYmVyIl0sZm46ZnVuY3Rpb24odCxlKXtyZXR1cm4gdD09PWV9fX0sbGltaXRSZXNlbmRpbmc6ZnVuY3Rpb24oKXt0aGlzLnNldCh7YWJsZVRvUmVzZW5kOiExfSksZC5kZWxheShkLmJpbmQodGhpcy5zZXQsdGhpcyksaCx7YWJsZVRvUmVzZW5kOiEwfSl9LHNlbmRDb2RlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyxpPXRoaXMuZ2V0KCJmdWxsUGhvbmVOdW1iZXIiKSxuPXRoaXMuZ2V0KCJwaG9uZUV4dGVuc2lvbiIpO3JldHVybiBlLnRyaWdnZXIoImVycm9yczpjbGVhciIpLGkubGVuZ3RoP3RoaXMuZG9UcmFuc2FjdGlvbihmdW5jdGlvbihyKXt2YXIgcz0iTUZBX0VOUk9MTCI9PT1yLnN0YXR1cyxvPXtwaG9uZU51bWJlcjppLHVwZGF0ZVBob25lOiFzfHxlLmdldCgiaGFzRXhpc3RpbmdQaG9uZXMiKX07bChlLmdldCgiZmFjdG9yVHlwZSIpKSYmKG8ucGhvbmVFeHRlbnNpb249biksZS5nZXQoInNraXBQaG9uZVZhbGlkYXRpb24iKSYmKG8udmFsaWRhdGVQaG9uZT0hMSk7dmFyIGE9ZnVuY3Rpb24oaSl7dmFyIG49ZC5maW5kV2hlcmUoaS5mYWN0b3JzLHtmYWN0b3JUeXBlOmUuZ2V0KCJmYWN0b3JUeXBlIikscHJvdmlkZXI6Ik9LVEEifSk7cmV0dXJuIG4uZW5yb2xsKHtwcm9maWxlOm99KS5mYWlsKGZ1bmN0aW9uKGkpe3Rocm93IkUwMDAwMDk4Ij09PWkuZXJyb3JDb2RlJiYoZS5zZXQoInNraXBQaG9uZVZhbGlkYXRpb24iLCEwKSxpLnhoci5yZXNwb25zZUpTT04uZXJyb3JTdW1tYXJ5PXQubG9jKCJlbnJvbGwuc21zLnRyeV9hZ2FpbiIsImxvZ2luIikpLGl9KX07cmV0dXJuIHM/YShyKTooZS5zZXQoInRyYXBFbnJvbGxtZW50IiwhMCksci5wcmV2KCkudGhlbihhKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiBlLnNldCgidHJhcEVucm9sbG1lbnQiLCExKSx0fSkpfSwhMCkudGhlbihmdW5jdGlvbigpe2Uuc2V0KCJsYXN0RW5yb2xsZWRQaG9uZU51bWJlciIsaSksZS5saW1pdFJlc2VuZGluZygpfSkuZmFpbChmdW5jdGlvbigpe2Uuc2V0KCJhYmxlVG9SZXNlbmQiLCEwKSxlLnNldCgidHJhcEVucm9sbG1lbnQiLCExKX0pOnZvaWQgZS50cmlnZ2VyKCJpbnZhbGlkIixlLHtwaG9uZU51bWJlcjoibW9kZWwudmFsaWRhdGlvbi5maWVsZC5ibGFuayJ9KX0scmVzZW5kQ29kZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRyaWdnZXIoImVycm9yczpjbGVhciIpLHRoaXMubGltaXRSZXNlbmRpbmcoKSx0aGlzLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQucmVzZW5kKHRoaXMuZ2V0KCJmYWN0b3JUeXBlIikpfSl9LHNhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LmFjdGl2YXRlKHtwYXNzQ29kZTp0aGlzLmdldCgicGFzc0NvZGUiKX0pfSl9fSxGb3JtOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcHRpb25zLmZhY3RvclR5cGUsaT1sKGUpLGE9dC5sb2MoaT8iZW5yb2xsLmNhbGwuc2V0dXAiOiJlbnJvbGwuc21zLnNldHVwIiwibG9naW4iKSxkPXQubG9jKGk/Im1mYS5jYWxsIjoibWZhLnNlbmRDb2RlIiwibG9naW4iKSxoPXQubG9jKGk/Im1mYS5yZWRpYWwiOiJtZmEucmVzZW5kQ29kZSIsImxvZ2luIiksZj10LmxvYyhpPyJtZmEuY2FsbGluZyI6Im1mYS5zZW50IiwibG9naW4iKSxtPWk/ImVucm9sbC1jYWxsLXBob25lIjoiZW5yb2xsLXNtcy1waG9uZSIsXz1pPyJjYWxsLXJlcXVlc3QtYnV0dG9uIjoic21zLXJlcXVlc3QtYnV0dG9uIixnPVtvLklucHV0KHtuYW1lOiJjb3VudHJ5Q29kZSIsdHlwZToic2VsZWN0Iix3aWRlOiEwLG9wdGlvbnM6cy5nZXRDb3VudHJpZXMoKX0pLG8uSW5wdXQoe3BsYWNlaG9sZGVyOnQubG9jKCJtZmEucGhvbmVOdW1iZXIucGxhY2Vob2xkZXIiLCJsb2dpbiIpLGNsYXNzTmFtZTptLG5hbWU6InBob25lTnVtYmVyIixpbnB1dDpuLHR5cGU6InRleHQiLHJlbmRlcjpmdW5jdGlvbigpe3RoaXMuJCgnaW5wdXRbbmFtZT0icGhvbmVOdW1iZXIiXScpLm9mZigia2V5ZG93biBrZXl1cCIsdSkua2V5ZG93bih1KS5rZXl1cCh7bW9kZWw6dGhpcy5tb2RlbH0sdSl9fSldO3JldHVybiBpJiZnLnB1c2goby5JbnB1dCh7cGxhY2Vob2xkZXI6dC5sb2MoIm1mYS5waG9uZU51bWJlci5leHQucGxhY2Vob2xkZXIiLCJsb2dpbiIpLGNsYXNzTmFtZToiZW5yb2xsLWNhbGwtZXh0ZW5zaW9uIixuYW1lOiJwaG9uZUV4dGVuc2lvbiIsaW5wdXQ6cix0eXBlOiJ0ZXh0In0pKSxnLnB1c2goby5CdXR0b24oe3RpdGxlOmQsYXR0cmlidXRlczp7ImRhdGEtc2UiOl99LGNsYXNzTmFtZToiYnV0dG9uIGJ1dHRvbi1wcmltYXJ5IGpzLWVucm9sbC1waG9uZSAiK18sY2xpY2s6ZnVuY3Rpb24oKXt0aGlzLm1vZGVsLnNlbmRDb2RlKCl9fSksby5CdXR0b24oe3RpdGxlOmgsYXR0cmlidXRlczp7ImRhdGEtc2UiOl99LGNsYXNzTmFtZToiYnV0dG9uIGpzLWVucm9sbC1waG9uZSAiK18sY2xpY2s6ZnVuY3Rpb24oKXt0aGlzLm1vZGVsLnJlc2VuZENvZGUoKX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMuJGVsLmNzcyh7ZGlzcGxheToibm9uZSJ9KSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImNoYW5nZTphYmxlVG9SZXNlbmQiLGZ1bmN0aW9uKHQsZSl7ZT8odGhpcy5vcHRpb25zLnRpdGxlPWgsdGhpcy5lbmFibGUoKSk6KHRoaXMub3B0aW9ucy50aXRsZT1mLHRoaXMuZGlzYWJsZSgpKSx0aGlzLnJlbmRlcigpfSl9fSksby5EaXZpZGVyKHtzaG93V2hlbjpwfSksby5JbnB1dCh7cGxhY2Vob2xkZXI6dC5sb2MoIm1mYS5jaGFsbGVuZ2UuZW50ZXJDb2RlLnBsYWNlaG9sZGVyIiwibG9naW4iKSxuYW1lOiJwYXNzQ29kZSIsaW5wdXQ6cix0eXBlOiJudW1iZXIiLHBhcmFtczp7aW5uZXJUb29sdGlwOnQubG9jKCJtZmEuY2hhbGxlbmdlLmVudGVyQ29kZS50b29sdGlwIiwibG9naW4iKX0sc2hvd1doZW46cH0pLG8uVG9vbGJhcih7bm9DYW5jZWxCdXR0b246ITAsc2F2ZTp0LmxvYygibWZhLmNoYWxsZW5nZS52ZXJpZnkiLCJsb2dpbiIpLHNob3dXaGVuOnB9KSkse3RpdGxlOmEsbm9CdXR0b25CYXI6ITAsYXV0b1NhdmU6ITAsY2xhc3NOYW1lOmMoZSksaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZXJyb3IgZXJyb3JzOmNsZWFyIixmdW5jdGlvbigpe3RoaXMuY2xlYXJFcnJvcnMoKX0pLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiY2hhbmdlOmVucm9sbGVkIixmdW5jdGlvbigpe3RoaXMuJCgiLmpzLWVucm9sbC1waG9uZSIpLnRvZ2dsZSgpfSl9LGZvcm1DaGlsZHJlbjpnfX0sRm9vdGVyOmksdHJhcEF1dGhSZXNwb25zZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc01mYUVucm9sbEFjdGl2YXRlIik/KHRoaXMubW9kZWwuc2V0KCJmYWN0b3JJZCIsdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiYWN0aXZhdGVkRmFjdG9ySWQiKSksITApOiEoIXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImlzTWZhRW5yb2xsIil8fCF0aGlzLm1vZGVsLmdldCgidHJhcEVucm9sbG1lbnQiKSl8fHZvaWQgMH0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe2wodGhpcy5vcHRpb25zLmZhY3RvclR5cGUpP3RoaXMubW9kZWwuc2V0KCJoYXNFeGlzdGluZ1Bob25lcyIsdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaGFzRXhpc3RpbmdQaG9uZXNGb3JDYWxsIikpOnRoaXMubW9kZWwuc2V0KCJoYXNFeGlzdGluZ1Bob25lcyIsdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaGFzRXhpc3RpbmdQaG9uZXMiKSksdGhpcy5tb2RlbC5zZXQoImZhY3RvclR5cGUiLHRoaXMub3B0aW9ucy5mYWN0b3JUeXBlKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NiksaSgyOTUpLGkoMzQyKSxpKDMwNildLHI9ZnVuY3Rpb24odCxlLGksbixyKXtmdW5jdGlvbiBzKHQpe3JldHVybiJSU0EiPT09dH1mdW5jdGlvbiBvKHQpe3JldHVybiBzKHQpPyJlbnJvbGwtcnNhIjoiZW5yb2xsLW9ucHJlbSJ9dmFyIGE9dC5fO3JldHVybiBpLmV4dGVuZCh7Y2xhc3NOYW1lOmZ1bmN0aW9uKCl7cmV0dXJuIG8odGhpcy5vcHRpb25zLnByb3ZpZGVyKX0sTW9kZWw6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMucHJvdmlkZXIsZT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJmYWN0b3JzIiksaT1lLmZpbmRXaGVyZShhLnBpY2sodGhpcy5vcHRpb25zLCJwcm92aWRlciIsImZhY3RvclR5cGUiKSksbj1pLmdldCgicHJvZmlsZSIpLHI9biYmbi5jcmVkZW50aWFsSWQ/bi5jcmVkZW50aWFsSWQ6IiI7cmV0dXJue3Byb3BzOntjcmVkZW50aWFsSWQ6WyJzdHJpbmciLCEwLHJdLHBhc3NDb2RlOlsic3RyaW5nIiwhMF0sZmFjdG9ySWQ6InN0cmluZyJ9LHNhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpe3ZhciBpPWEuZmluZFdoZXJlKGUuZmFjdG9ycyx7ZmFjdG9yVHlwZToidG9rZW4iLHByb3ZpZGVyOnR9KTtyZXR1cm4gaS5lbnJvbGwoe3Bhc3NDb2RlOnRoaXMuZ2V0KCJwYXNzQ29kZSIpLHByb2ZpbGU6e2NyZWRlbnRpYWxJZDp0aGlzLmdldCgiY3JlZGVudGlhbElkIil9fSl9KX19fSxGb3JtOmZ1bmN0aW9uKCl7dmFyIGk9dGhpcy5vcHRpb25zLnByb3ZpZGVyLG49dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpLGw9bi5maW5kV2hlcmUoYS5waWNrKHRoaXMub3B0aW9ucywicHJvdmlkZXIiLCJmYWN0b3JUeXBlIikpLGM9bC5nZXQoInZlbmRvck5hbWUiKSx1PXMoaSk/dC5sb2MoImZhY3Rvci50b3RwSGFyZC5yc2FTZWN1cklkIiwibG9naW4iKTpjO3JldHVybnt0aXRsZTp1LG5vQnV0dG9uQmFyOiEwLGF1dG9TYXZlOiEwLGNsYXNzTmFtZTpvKGkpLGZvcm1DaGlsZHJlbjpbZS5JbnB1dCh7bmFtZToiY3JlZGVudGlhbElkIixpbnB1dDpyLHR5cGU6InRleHQiLHBsYWNlaG9sZGVyOnQubG9jKCJlbnJvbGwub25wcmVtLnVzZXJuYW1lLnBsYWNlaG9sZGVyIiwibG9naW4iLFtjXSkscGFyYW1zOntpbm5lclRvb2x0aXA6dC5sb2MoImVucm9sbC5vbnByZW0udXNlcm5hbWUudG9vbHRpcCIsImxvZ2luIixbY10pfX0pLGUuSW5wdXQoe25hbWU6InBhc3NDb2RlIixpbnB1dDpyLHR5cGU6InBhc3N3b3JkIixwbGFjZWhvbGRlcjp0LmxvYygiZW5yb2xsLm9ucHJlbS5wYXNzY29kZS5wbGFjZWhvbGRlciIsImxvZ2luIixbY10pLHBhcmFtczp7aW5uZXJUb29sdGlwOnQubG9jKCJlbnJvbGwub25wcmVtLnBhc3Njb2RlLnRvb2x0aXAiLCJsb2dpbiIsW2NdKX19KSxlLlRvb2xiYXIoe25vQ2FuY2VsQnV0dG9uOiEwLHNhdmU6dC5sb2MoIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKX0pXX19LEZvb3RlcjpufSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTYpLGkoMjk1KSxpKDM0MiksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9dC5fO3JldHVybiBpLmV4dGVuZCh7Y2xhc3NOYW1lOiJlbnJvbGwtc3ltYW50ZWMiLE1vZGVsOntwcm9wczp7Y3JlZGVudGlhbElkOlsic3RyaW5nIiwhMF0scGFzc0NvZGU6WyJzdHJpbmciLCEwXSxuZXh0UGFzc0NvZGU6WyJzdHJpbmciLCEwXSxmYWN0b3JJZDoic3RyaW5nIn0sc2F2ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7dmFyIGU9cy5maW5kV2hlcmUodC5mYWN0b3JzLHtmYWN0b3JUeXBlOiJ0b2tlbiIscHJvdmlkZXI6IlNZTUFOVEVDIn0pO3JldHVybiBlLmVucm9sbCh7cGFzc0NvZGU6dGhpcy5nZXQoInBhc3NDb2RlIiksbmV4dFBhc3NDb2RlOnRoaXMuZ2V0KCJuZXh0UGFzc0NvZGUiKSxwcm9maWxlOntjcmVkZW50aWFsSWQ6dGhpcy5nZXQoImNyZWRlbnRpYWxJZCIpfX0pfSl9fSxGb3JtOnt0aXRsZTpzLnBhcnRpYWwodC5sb2MsImZhY3Rvci50b3RwSGFyZC5zeW1hbnRlY1ZpcCIsImxvZ2luIiksc3VidGl0bGU6cy5wYXJ0aWFsKHQubG9jLCJlbnJvbGwuc3ltYW50ZWNWaXAuc3VidGl0bGUiLCJsb2dpbiIpLG5vQnV0dG9uQmFyOiEwLGF1dG9TYXZlOiEwLGNsYXNzTmFtZToiZW5yb2xsLXN5bWFudGVjIixmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXtyZXR1cm5bZS5JbnB1dCh7bmFtZToiY3JlZGVudGlhbElkIixpbnB1dDpyLHR5cGU6InRleHQiLHBsYWNlaG9sZGVyOnQubG9jKCJlbnJvbGwuc3ltYW50ZWNWaXAuY3JlZGVudGlhbElkLnBsYWNlaG9sZGVyIiwibG9naW4iKSxwYXJhbXM6e2lubmVyVG9vbHRpcDp0LmxvYygiZW5yb2xsLnN5bWFudGVjVmlwLmNyZWRlbnRpYWxJZC50b29sdGlwIiwibG9naW4iKX19KSxlLklucHV0KHtuYW1lOiJwYXNzQ29kZSIsaW5wdXQ6cix0eXBlOiJ0ZXh0IixwbGFjZWhvbGRlcjp0LmxvYygiZW5yb2xsLnN5bWFudGVjVmlwLnBhc3Njb2RlMS5wbGFjZWhvbGRlciIsImxvZ2luIikscGFyYW1zOntpbm5lclRvb2x0aXA6dC5sb2MoImVucm9sbC5zeW1hbnRlY1ZpcC5wYXNzY29kZTEudG9vbHRpcCIsImxvZ2luIil9fSksZS5JbnB1dCh7bmFtZToibmV4dFBhc3NDb2RlIixpbnB1dDpyLHR5cGU6InRleHQiLHBsYWNlaG9sZGVyOnQubG9jKCJlbnJvbGwuc3ltYW50ZWNWaXAucGFzc2NvZGUyLnBsYWNlaG9sZGVyIiwibG9naW4iKSxwYXJhbXM6e2lubmVyVG9vbHRpcDp0LmxvYygiZW5yb2xsLnN5bWFudGVjVmlwLnBhc3Njb2RlMi50b29sdGlwIiwibG9naW4iKX19KSxlLlRvb2xiYXIoe25vQ2FuY2VsQnV0dG9uOiEwLHNhdmU6dC5sb2MoIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKX0pXX19LEZvb3RlcjpufSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTYpLGkoMjk1KSxpKDM0MiksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9dC5fO3JldHVybiBpLmV4dGVuZCh7Y2xhc3NOYW1lOiJlbnJvbGwteXViaWtleSIsTW9kZWw6e3Byb3BzOntwYXNzQ29kZTpbInN0cmluZyIsITBdLGZhY3RvcklkOiJzdHJpbmcifSxzYXZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXt2YXIgZT1zLmZpbmRXaGVyZSh0LmZhY3RvcnMse2ZhY3RvclR5cGU6InRva2VuOmhhcmR3YXJlIixwcm92aWRlcjoiWVVCSUNPIn0pO3JldHVybiBlLmVucm9sbCh7cGFzc0NvZGU6dGhpcy5nZXQoInBhc3NDb2RlIil9KX0pfX0sRm9ybTp7dGl0bGU6cy5wYXJ0aWFsKHQubG9jLCJlbnJvbGwueXViaWtleS50aXRsZSIsImxvZ2luIiksc3VidGl0bGU6cy5wYXJ0aWFsKHQubG9jLCJlbnJvbGwueXViaWtleS5zdWJ0aXRsZSIsImxvZ2luIiksbm9DYW5jZWxCdXR0b246ITAsc2F2ZTpzLnBhcnRpYWwodC5sb2MsIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKSxhdXRvU2F2ZTohMCxjbGFzc05hbWU6ImVucm9sbC15dWJpa2V5Iixmb3JtQ2hpbGRyZW46W2UuVmlldyh7VmlldzonPGRpdiBjbGFzcz0ieXViaWtleS1kZW1vIiBkYXRhLXR5cGU9Inl1YmlrZXktZXhhbXBsZSI+PC9kaXY+J30pLGUuSW5wdXQoe25hbWU6InBhc3NDb2RlIixpbnB1dDpyLHR5cGU6InBhc3N3b3JkIn0pXX0sRm9vdGVyOm59KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NCksaSgyOTUpLGkoMjk2KSxpKDI5OSksaSgzNTApLGkoMzUxKSxpKDM0MildLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhKXt2YXIgbD10Ll8sYz17X19kZXZpY2VUeXBlX186ZnVuY3Rpb24odCl7cmV0dXJuIHZvaWQgMCE9PXR9fSx1PXQuVmlldy5leHRlbmQoe2F0dHJpYnV0ZXM6eyJkYXRhLXNlIjoiYXBwLWRvd25sb2FkLWluc3RydWN0aW9ucyJ9LGNsYXNzTmFtZToiYXBwLWRvd25sb2FkLWluc3RydWN0aW9ucyIsdGVtcGxhdGU6J1x0ICAgICAgPHAgY2xhc3M9Imluc3RydWN0aW9ucy10aXRsZSI+e3t0aXRsZX19PC9wPlx0ICAgICAgPHNwYW4gY2xhc3M9ImFwcC1sb2dvIHt7YXBwSWNvbn19Ij48L3NwYW4+XHQgICAgICA8cCBjbGFzcz0iaW5zdHJ1Y3Rpb25zIj57e3thcHBTdG9yZUxpbmtUZXh0fX19PC9wPlx0ICAgICcsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiY2hhbmdlOl9fZGV2aWNlVHlwZV9fIix0aGlzLnJlbmRlcil9LGdldFRlbXBsYXRlRGF0YTpmdW5jdGlvbigpe3ZhciBpLG4scixvPWUuZ2V0RmFjdG9yTGFiZWwodGhpcy5tb2RlbC5nZXQoIl9fcHJvdmlkZXJfXyIpLHRoaXMubW9kZWwuZ2V0KCJfX2ZhY3RvclR5cGVfXyIpKTtyZXR1cm4gcj1zLlNUT1JFW3RoaXMubW9kZWwuZ2V0KCJfX2RldmljZVR5cGVfXyIpXSwiR09PR0xFIj09PXRoaXMubW9kZWwuZ2V0KCJfX3Byb3ZpZGVyX18iKT8oaT1zLkdPT0dMRVt0aGlzLm1vZGVsLmdldCgiX19kZXZpY2VUeXBlX18iKV0sbj0iZ29vZ2xlLWF1dGgtMzgiKTooaT1zLk9LVEFbdGhpcy5tb2RlbC5nZXQoIl9fZGV2aWNlVHlwZV9fIildLG49Im9rdGEtdmVyaWZ5LTM4Iikse3RpdGxlOnQubG9jKCJlbnJvbGwudG90cC5pbnN0YWxsQXBwIiwibG9naW4iLFtvXSksYXBwU3RvcmVMaW5rVGV4dDp0LmxvYygiZW5yb2xsLnRvdHAuZG93bmxvYWRBcHAiLCJsb2dpbiIsW2ksbyxyXSksYXBwSWNvbjpufX19KSxkPWkuZXh0ZW5kKHtjbGFzc05hbWU6ImVucm9sbC10b3RwIixNb2RlbDpmdW5jdGlvbigpe3JldHVybntsb2NhbDp7X19kZXZpY2VUeXBlX186InN0cmluZyIsX19mYWN0b3JUeXBlX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5mYWN0b3JUeXBlXSxfX3Byb3ZpZGVyX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5wcm92aWRlcl19LHNhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3ZhciBlPWwuZmluZFdoZXJlKHQuZmFjdG9ycyx7ZmFjdG9yVHlwZTp0aGlzLmdldCgiX19mYWN0b3JUeXBlX18iKSxwcm92aWRlcjp0aGlzLmdldCgiX19wcm92aWRlcl9fIil9KTtyZXR1cm4gZS5lbnJvbGwoKX0pfX19LEZvcm06e3RpdGxlOmZ1bmN0aW9uKCl7dmFyIGk9ZS5nZXRGYWN0b3JMYWJlbCh0aGlzLm1vZGVsLmdldCgiX19wcm92aWRlcl9fIiksdGhpcy5tb2RlbC5nZXQoIl9fZmFjdG9yVHlwZV9fIikpO3JldHVybiB0LmxvYygiZW5yb2xsLnRvdHAudGl0bGUiLCJsb2dpbiIsW2ldKX0sc3VidGl0bGU6bC5wYXJ0aWFsKHQubG9jLCJlbnJvbGwudG90cC5zZWxlY3REZXZpY2UiLCJsb2dpbiIpLGF1dG9TYXZlOiEwLG5vQnV0dG9uQmFyOiEwLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoic3RlcC1kZXZpY2UtdHlwZSJ9LGZvcm1DaGlsZHJlbjpmdW5jdGlvbigpe3ZhciBlPXtBUFBMRToiIixBTkRST0lEOiIifTt0aGlzLnNldHRpbmdzLmdldCgiZmVhdHVyZXMud2luZG93c1ZlcmlmeSIpJiYiT0tUQSI9PT10aGlzLm1vZGVsLmdldCgiX19wcm92aWRlcl9fIik/ZS5XSU5ET1dTPSIiOiJHT09HTEUiPT09dGhpcy5tb2RlbC5nZXQoIl9fcHJvdmlkZXJfXyIpJiYoZS5CTEFDS0JFUlJZPSIiKTt2YXIgaT1bbi5JbnB1dCh7bmFtZToiX19kZXZpY2VUeXBlX18iLHR5cGU6InJhZGlvIixvcHRpb25zOmUsY2xhc3NOYW1lOiJkZXZpY2UtdHlwZS1pbnB1dCJ9KSxuLkRpdmlkZXIoe3Nob3dXaGVuOmN9KSxuLlZpZXcoe1ZpZXc6dSxzaG93V2hlbjpjfSksbi5Ub29sYmFyKHtub0NhbmNlbEJ1dHRvbjohMCxzYXZlOnQubG9jKCJvZm9ybS5uZXh0IiwibG9naW4iKSxzaG93V2hlbjpjfSldO3JldHVybiBpfX0sRm9vdGVyOmF9KTtyZXR1cm4gZH0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7ISh0LmV4cG9ydHM9e09LVEE6e0FQUExFOiJodHRwczovL2l0dW5lcy5hcHBsZS5jb20vdXMvYXBwL29rdGEtdmVyaWZ5L2lkNDkwMTc5NDA1IixBTkRST0lEOiJodHRwczovL3BsYXkuZ29vZ2xlLmNvbS9zdG9yZS9hcHBzL2RldGFpbHM/aWQ9Y29tLm9rdGEuYW5kcm9pZC5hdXRoIixXSU5ET1dTOiJodHRwOi8vd3d3LndpbmRvd3NwaG9uZS5jb20vZW4tdXMvc3RvcmUvYXBwL29rdGEtdmVyaWZ5LzlkZjBlMmM0LTczMDEtNDExZi04MGU1LTYyZmNmNjY3OTY2NiJ9LEdPT0dMRTp7QVBQTEU6Imh0dHBzOi8vaXR1bmVzLmFwcGxlLmNvbS91cy9hcHAvZ29vZ2xlLWF1dGhlbnRpY2F0b3IvaWQzODg0OTc2MDUiLEFORFJPSUQ6Imh0dHBzOi8vcGxheS5nb29nbGUuY29tL3N0b3JlL2FwcHMvZGV0YWlscz9pZD1jb20uZ29vZ2xlLmFuZHJvaWQuYXBwcy5hdXRoZW50aWNhdG9yMiIsQkxBQ0tCRVJSWToiaHR0cHM6Ly9zdXBwb3J0Lmdvb2dsZS5jb20vYWNjb3VudHMvYW5zd2VyLzEwNjY0NDcifSxTVE9SRTp7QVBQTEU6IkFwcCBTdG9yZSIsQU5EUk9JRDoiR29vZ2xlIFBsYXkgU3RvcmUiLFdJTkRPV1M6IldpbmRvd3MgU3RvcmUiLEJMQUNLQkVSUlk6IkJsYWNrYmVycnkgV29ybGQgU3RvcmUifX0pfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NCksaSgyOTkpXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Ll87cmV0dXJuIHQuVmlldy5leHRlbmQoe2NsYXNzTmFtZToic2Nhbi1pbnN0cnVjdGlvbnMgY2xlYXJmaXgiLHRlbXBsYXRlOidcdCAgICAgIDxkaXYgY2xhc3M9InNjYW4taW5zdHJ1Y3Rpb25zLWRldGFpbHMtd3JhcHBlciI+XHQgICAgICAgICAgPGRpdiBjbGFzcz0ic2Nhbi1pbnN0cnVjdGlvbnMtZGV0YWlscyI+XHQgICAgICAgICAgICAgIDxwPnt7aW5zdHJ1Y3Rpb25zfX08L3A+XHQgICAgICAgICAgPC9kaXY+XHQgICAgICA8L2Rpdj5cdCAgICAgIDxkaXYgY2xhc3M9InNjYW4taW5zdHJ1Y3Rpb25zLXFyY29kZS13cmFwcGVyIj5cdCAgICAgICAgICA8ZGl2IGNsYXNzPSJxcmNvZGUtd3JhcCI+XHQgICAgICAgICAgICAgIDxpbWcgZGF0YS1zZT0icXJjb2RlIiBjbGFzcz0icXJjb2RlLWltYWdlIiBzcmM9Int7cXJjb2RlfX0iPlx0ICAgICAgICAgICAgICA8ZGl2IGRhdGEtc2U9InFyY29kZS1zdWNjZXNzIiBjbGFzcz0icXJjb2RlLXN1Y2Nlc3MiPjwvZGl2Plx0ICAgICAgICAgICAgICA8ZGl2IGRhdGEtc2U9InFyY29kZS1lcnJvciIgY2xhc3M9InFyY29kZS1lcnJvciI+PC9kaXY+XHQgICAgICAgICAgPC9kaXY+XHQgICAgICAgICAgPGEgaHJlZj0iIyIgZGF0YS10eXBlPSJtYW51YWwtc2V0dXAiIGRhdGEtc2U9Im1hbnVhbC1zZXR1cCIgY2xhc3M9ImxpbmsgbWFudWFsLXNldHVwIj5cdCAgICAgICAgICAgIHt7aTE4biBjb2RlPSJlbnJvbGwudG90cC5jYW5ub3RTY2FuIiBidW5kbGU9ImxvZ2luIn19XHQgICAgICAgICAgPC9hPlx0ICAgICAgICAgIDxhIGhyZWY9IiMiIGRhdGEtdHlwZT0icmVmcmVzaC1xcmNvZGUiIGRhdGEtc2U9InJlZnJlc2gtcXJjb2RlIiBjbGFzcz0ibGluayByZWZyZXNoLXFyY29kZSI+XHQgICAgICAgICAgICB7e2kxOG4gY29kZT0iZW5yb2xsLnRvdHAucmVmcmVzaEJhcmNvZGUiIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgICAgICA8L2E+XHQgICAgICA8L2Rpdj5cdCAgICAnLGV2ZW50czp7J2NsaWNrIFtkYXRhLXR5cGU9Im1hbnVhbC1zZXR1cCJdJzpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCk7dmFyIGU9aS5jcmVhdGVBY3RpdmF0ZUZhY3RvclVybCh0aGlzLm1vZGVsLmdldCgiX19wcm92aWRlcl9fIiksdGhpcy5tb2RlbC5nZXQoIl9fZmFjdG9yVHlwZV9fIiksIm1hbnVhbCIpO3RoaXMub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsZSl9LCdjbGljayBbZGF0YS10eXBlPSJyZWZyZXNoLXFyY29kZSJdJzpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5tb2RlbC50cmlnZ2VyKCJlcnJvcnM6Y2xlYXIiKTt2YXIgZT10aGlzO3RoaXMubW9kZWwuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5hcHBTdGF0ZS5nZXQoImlzV2FpdGluZ0ZvckFjdGl2YXRpb24iKT90LnBvbGwoKTp0LmFjdGl2YXRlKCl9KS50aGVuKGZ1bmN0aW9uKHQpe3ZhciBpPXQuZGF0YTsiTUZBX0VOUk9MTF9BQ1RJVkFURSI9PT1pLnN0YXR1cyYmIldBSVRJTkciPT09aS5mYWN0b3JSZXN1bHQmJm4uZGVmZXIobi5iaW5kKGUucmVuZGVyLGUpKX0pfX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5vcHRpb25zLmFwcFN0YXRlLCJjaGFuZ2U6bGFzdEF1dGhSZXNwb25zZSIsZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc01mYUVucm9sbEFjdGl2YXRlIik/dGhpcy4kZWwudG9nZ2xlQ2xhc3MoInFyY29kZS1leHBpcmVkIiwhdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNXYWl0aW5nRm9yQWN0aXZhdGlvbiIpKTp0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc1N1Y2Nlc3NSZXNwb25zZSIpJiZ0aGlzLiRlbC5hZGRDbGFzcygicXJjb2RlLXN1Y2Nlc3MiKX0pLHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZXJyb3IiLGZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFFbnJvbGxBY3RpdmF0ZSIpJiZ0aGlzLiRlbC50b2dnbGVDbGFzcygicXJjb2RlLWV4cGlyZWQiLCEwKX0pfSxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXt2YXIgaSxuPWUuZ2V0RmFjdG9yTGFiZWwodGhpcy5tb2RlbC5nZXQoIl9fcHJvdmlkZXJfXyIpLHRoaXMubW9kZWwuZ2V0KCJfX2ZhY3RvclR5cGVfXyIpKTtyZXR1cm4gaT0iR09PR0xFIj09PXRoaXMubW9kZWwuZ2V0KCJfX3Byb3ZpZGVyX18iKT90LmxvYygiZW5yb2xsLnRvdHAuc2V0dXBHb29nbGVBdXRoQXBwIiwibG9naW4iLFtuXSk6dC5sb2MoImVucm9sbC50b3RwLnNldHVwQXBwIiwibG9naW4iLFtuXSkse2luc3RydWN0aW9uczppLHFyY29kZTp0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJxcmNvZGUiKX19fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7CgluPVtpKDMyKSxpKDI5NiksaSgyOTUpLGkoMzQyKSxpKDIxKSxpKDMzNSksaSgxODIpLGkoMzM3KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvKXtmdW5jdGlvbiBhKHQpe3N3aXRjaCh0KXtkZWZhdWx0OmNhc2UgMTpyZXR1cm4idTJmLmVycm9yLm90aGVyIjtjYXNlIDI6Y2FzZSAzOnJldHVybiJ1MmYuZXJyb3IuYmFkUmVxdWVzdCI7Y2FzZSA0OnJldHVybiJ1MmYuZXJyb3IudW5zdXBwb3J0ZWQiO2Nhc2UgNTpyZXR1cm4idTJmLmVycm9yLnRpbWVvdXQifX12YXIgbD10Ll87cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6ImVucm9sbC11MmYiLE1vZGVsOntsb2NhbDp7X19lbnJvbGxlZF9fOiJib29sZWFuIn0sc2F2ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRyaWdnZXIoInJlcXVlc3QiKSx0aGlzLmdldCgiX19lbnJvbGxlZF9fIik/dGhpcy5hY3RpdmF0ZSgpOnRoaXMuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXt2YXIgZT1sLmZpbmRXaGVyZSh0LmZhY3RvcnMse2ZhY3RvclR5cGU6InUyZiIscHJvdmlkZXI6IkZJRE8ifSk7cmV0dXJuIGUuZW5yb2xsKCl9KX0sYWN0aXZhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZXQoIl9fZW5yb2xsZWRfXyIsITApLHRoaXMudHJpZ2dlcigiZXJyb3JzOmNsZWFyIiksdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpew==", "base64"));
  res.write(new Buffer("dmFyIGk9ZS5mYWN0b3IuYWN0aXZhdGlvbixuPWkuYXBwSWQscz1be3ZlcnNpb246aS52ZXJzaW9uLGNoYWxsZW5nZTppLm5vbmNlfV0sbz10aGlzLGw9ci5kZWZlcigpO3JldHVybiB1MmYucmVnaXN0ZXIobixzLFtdLGZ1bmN0aW9uKGkpe28udHJpZ2dlcigiZXJyb3JzOmNsZWFyIiksaS5lcnJvckNvZGUmJjAhPT1pLmVycm9yQ29kZT9sLnJlamVjdCh7eGhyOntyZXNwb25zZUpTT046e2Vycm9yU3VtbWFyeTp0LmxvYyhhKGkuZXJyb3JDb2RlKSwibG9naW4iKX19fSk6bC5yZXNvbHZlKGUuYWN0aXZhdGUoe3JlZ2lzdHJhdGlvbkRhdGE6aS5yZWdpc3RyYXRpb25EYXRhLHZlcnNpb246aS52ZXJzaW9uLGNoYWxsZW5nZTppLmNoYWxsZW5nZSxjbGllbnREYXRhOmkuY2xpZW50RGF0YX0pKX0pLGwucHJvbWlzZX0pfX0sRm9ybTp7dGl0bGU6bC5wYXJ0aWFsKHQubG9jLCJlbnJvbGwudTJmLnRpdGxlIiwibG9naW4iKSxzYXZlOmwucGFydGlhbCh0LmxvYywiZW5yb2xsLnUyZi5zYXZlIiwibG9naW4iKSxub0NhbmNlbEJ1dHRvbjohMCxoYXNTYXZpbmdTdGF0ZTohMSxhdXRvU2F2ZTohMCxjbGFzc05hbWU6ImVucm9sbC11MmYtZm9ybSIsbm9CdXR0b25CYXI6ZnVuY3Rpb24oKXtyZXR1cm4hd2luZG93Lmhhc093blByb3BlcnR5KCJ1MmYiKX0sbW9kZWxFdmVudHM6e3JlcXVlc3Q6Il9zdGFydEVucm9sbG1lbnQiLGVycm9yOiJfc3RvcEVucm9sbG1lbnQifSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXt2YXIgaT1bXTtpZih3aW5kb3cuaGFzT3duUHJvcGVydHkoInUyZiIpKWkucHVzaChlLlZpZXcoe1ZpZXc6JzxkaXYgY2xhc3M9InUyZi1pbnN0cnVjdGlvbnMiPjxvbD5cdCAgICAgICAgICA8bGk+e3tpMThuIGNvZGU9ImVucm9sbC51MmYuZ2VuZXJhbDEiIGJ1bmRsZT0ibG9naW4ifX08L2xpPlx0ICAgICAgICAgIDxsaT57e3tpMThuIGNvZGU9ImVucm9sbC51MmYuZ2VuZXJhbDIiIGJ1bmRsZT0ibG9naW4ifX19PC9saT5cdCAgICAgICAgICA8bGk+e3tpMThuIGNvZGU9ImVucm9sbC51MmYuZ2VuZXJhbDMiIGJ1bmRsZT0ibG9naW4ifX08L2xpPlx0ICAgICAgICAgIDwvb2w+PC9kaXY+J30pKSxpLnB1c2goZS5WaWV3KHtWaWV3OidcdCAgICAgICAgICA8ZGl2IGNsYXNzPSJ1MmYtZW5yb2xsLXRleHQgaGlkZSI+XHQgICAgICAgICAgICA8cD57e2kxOG4gY29kZT0iZW5yb2xsLnUyZi5pbnN0cnVjdGlvbnMiIGJ1bmRsZT0ibG9naW4ifX08L3A+XHQgICAgICAgICAgICA8cD57e2kxOG4gY29kZT0iZW5yb2xsLnUyZi5pbnN0cnVjdGlvbnNCbHVldG9vdGgiIGJ1bmRsZT0ibG9naW4ifX08L3A+XHQgICAgICAgICAgICA8ZGl2IGRhdGEtc2U9InUyZi1kZXZpY2VzIiBjbGFzcz0idTJmLWRldmljZXMtaW1hZ2VzIj5cdCAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idTJmLXVzYiI+PC9kaXY+XHQgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InUyZi1ibHVldG9vdGgiPjwvZGl2Plx0ICAgICAgICAgICAgPC9kaXY+XHQgICAgICAgICAgICA8ZGl2IGRhdGEtc2U9InUyZi13YWl0aW5nIiBjbGFzcz0ib2t0YS13YWl0aW5nLXNwaW5uZXIiPjwvZGl2Plx0ICAgICAgICAgIDwvZGl2Pid9KSk7ZWxzZXt2YXIgbj0idTJmLmVycm9yLm5vdFN1cHBvcnRlZEJyb3dzZXIiO28uaXNGaXJlZm94KCkmJihuPSJ1MmYuZXJyb3Iubm9GaXJlZm94RXh0ZW5zaW9uIiksaS5wdXNoKGUuVmlldyh7VmlldzpuZXcgcyh7bWVzc2FnZTp0LmxvYyhuLCJsb2dpbiIpfSl9LHtzZWxlY3RvcjoiLm8tZm9ybS1lcnJvci1jb250YWluZXIifSkpfXJldHVybiBpfSxfc3RhcnRFbnJvbGxtZW50OmZ1bmN0aW9uKCl7dGhpcy4kKCIudTJmLWluc3RydWN0aW9ucyIpLmFkZENsYXNzKCJoaWRlIiksdGhpcy4kKCIudTJmLWVucm9sbC10ZXh0IikucmVtb3ZlQ2xhc3MoImhpZGUiKSx0aGlzLiQoIi5vLWZvcm0tYnV0dG9uLWJhciIpLmhpZGUoKX0sX3N0b3BFbnJvbGxtZW50OmZ1bmN0aW9uKCl7dGhpcy4kKCIudTJmLWluc3RydWN0aW9ucyIpLnJlbW92ZUNsYXNzKCJoaWRlIiksdGhpcy4kKCIudTJmLWVucm9sbC10ZXh0IikuYWRkQ2xhc3MoImhpZGUiKSx0aGlzLiQoIi5vLWZvcm0tYnV0dG9uLWJhciIpLnNob3coKX19LEZvb3RlcjpuLHRyYXBBdXRoUmVzcG9uc2U6ZnVuY3Rpb24oKXtpZih0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc01mYUVucm9sbEFjdGl2YXRlIikpcmV0dXJuIHRoaXMubW9kZWwuYWN0aXZhdGUoKSwhMH19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NCksaSgyOTUpLGkoMjk2KSxpKDI5OSksaSgzNTEpLGkoMzQyKV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvKXt2YXIgYT10Ll87cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6ImJhcmNvZGUtdG90cCIsTW9kZWw6ZnVuY3Rpb24oKXtyZXR1cm57bG9jYWw6e19fZmFjdG9yVHlwZV9fOlsic3RyaW5nIiwhMSx0aGlzLm9wdGlvbnMuZmFjdG9yVHlwZV0sX19wcm92aWRlcl9fOlsic3RyaW5nIiwhMSx0aGlzLm9wdGlvbnMucHJvdmlkZXJdfX19LEZvcm06e3RpdGxlOmZ1bmN0aW9uKCl7dmFyIGk9ZS5nZXRGYWN0b3JMYWJlbCh0aGlzLm1vZGVsLmdldCgiX19wcm92aWRlcl9fIiksdGhpcy5tb2RlbC5nZXQoIl9fZmFjdG9yVHlwZV9fIikpO3JldHVybiB0LmxvYygiZW5yb2xsLnRvdHAudGl0bGUiLCJsb2dpbiIsW2ldKX0sc3VidGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJtZmEuc2NhbkJhcmNvZGUiLCJsb2dpbiIpLHNhdmU6YS5wYXJ0aWFsKHQubG9jLCJvZm9ybS5uZXh0IiwibG9naW4iKSxub0NhbmNlbEJ1dHRvbjohMCxhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6InN0ZXAtc2NhbiJ9LGNsYXNzTmFtZToiYmFyY29kZS1zY2FuIixmb3JtQ2hpbGRyZW46W24uVmlldyh7VmlldzpzfSldfSxGb290ZXI6byxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5saXN0ZW5Ubyh0aGlzLmZvcm0sInNhdmUiLGZ1bmN0aW9uKCl7dmFyIHQ9ci5jcmVhdGVBY3RpdmF0ZUZhY3RvclVybCh0aGlzLm1vZGVsLmdldCgiX19wcm92aWRlcl9fIiksdGhpcy5tb2RlbC5nZXQoIl9fZmFjdG9yVHlwZV9fIiksImFjdGl2YXRlIik7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIix0KX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk0KSxpKDI5NSksaSgyOTYpLGkoMjk5KSxpKDM1MSksaSgzNDIpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe3ZhciBhPXQuXyxsPTZlMztyZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToiYmFyY29kZS1wdXNoIixNb2RlbDpmdW5jdGlvbigpe3JldHVybntsb2NhbDp7X19mYWN0b3JUeXBlX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5mYWN0b3JUeXBlXSxfX3Byb3ZpZGVyX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5wcm92aWRlcl19fX0sRm9ybTp7dGl0bGU6ZnVuY3Rpb24oKXt2YXIgaT1lLmdldEZhY3RvckxhYmVsKHRoaXMubW9kZWwuZ2V0KCJfX3Byb3ZpZGVyX18iKSx0aGlzLm1vZGVsLmdldCgiX19mYWN0b3JUeXBlX18iKSk7cmV0dXJuIHQubG9jKCJlbnJvbGwudG90cC50aXRsZSIsImxvZ2luIixbaV0pfSxzdWJ0aXRsZTphLnBhcnRpYWwodC5sb2MsIm1mYS5zY2FuQmFyY29kZSIsImxvZ2luIiksbm9CdXR0b25CYXI6ITAsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJzdGVwLXNjYW4ifSxjbGFzc05hbWU6ImJhcmNvZGUtc2NhbiIsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZXJyb3IgZXJyb3JzOmNsZWFyIixmdW5jdGlvbigpe3RoaXMuY2xlYXJFcnJvcnMoKX0pfSxmb3JtQ2hpbGRyZW46W24uVmlldyh7VmlldzpzfSldfSxGb290ZXI6byxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5wb2xsRm9yRW5yb2xsbWVudCgpfSxwb2xsRm9yRW5yb2xsbWVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1vZGVsLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQucG9sbChsKX0pfSx0cmFwQXV0aFJlc3BvbnNlOmZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNNZmFFbnJvbGxBY3RpdmF0ZSIpKXJldHVybiEwfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KSxpKDM1NiksaSgzNDIpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3JldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOiJhY3RpdmF0ZS10b3RwIixNb2RlbDpmdW5jdGlvbigpe3JldHVybntwcm9wczp7ZmFjdG9ySWQ6WyJzdHJpbmciLCEwLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImFjdGl2YXRlZEZhY3RvcklkIildLHBhc3NDb2RlOlsic3RyaW5nIiwhMF19LGxvY2FsOntfX2ZhY3RvclR5cGVfXzpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLmZhY3RvclR5cGVdLF9fcHJvdmlkZXJfXzpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLnByb3ZpZGVyXX0sc2F2ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQuYWN0aXZhdGUoe3Bhc3NDb2RlOnRoaXMuZ2V0KCJwYXNzQ29kZSIpfSl9KX19fSxGb3JtOmksRm9vdGVyOm59KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NCksaSgyOTYpLGkoMzA2KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj10Ll8scz17dGl0bGU6ZnVuY3Rpb24oKXt2YXIgaT1lLmdldEZhY3RvckxhYmVsKHRoaXMubW9kZWwuZ2V0KCJfX3Byb3ZpZGVyX18iKSx0aGlzLm1vZGVsLmdldCgiX19mYWN0b3JUeXBlX18iKSk7cmV0dXJuIHQubG9jKCJlbnJvbGwudG90cC50aXRsZSIsImxvZ2luIixbaV0pfSxzdWJ0aXRsZTpyLnBhcnRpYWwodC5sb2MsImVucm9sbC50b3RwLmVudGVyQ29kZSIsImxvZ2luIiksYXV0b1NhdmU6ITAsbm9CdXR0b25CYXI6ITAsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJzdGVwLXNlbmRjb2RlIn0sZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuW2kuSW5wdXQoe25hbWU6InBhc3NDb2RlIixpbnB1dDpuLHR5cGU6Im51bWJlciIscGxhY2Vob2xkZXI6dC5sb2MoIm1mYS5jaGFsbGVuZ2UuZW50ZXJDb2RlLnBsYWNlaG9sZGVyIiwibG9naW4iKSxwYXJhbXM6e2lubmVyVG9vbHRpcDp0LmxvYygibWZhLmNoYWxsZW5nZS5lbnRlckNvZGUudG9vbHRpcCIsImxvZ2luIil9fSksaS5Ub29sYmFyKHtub0NhbmNlbEJ1dHRvbjohMCxzYXZlOnQubG9jKCJvZm9ybS52ZXJpZnkiLCJsb2dpbiIpfSldfX07cmV0dXJuIHN9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTQpLGkoMjk1KSxpKDI5NiksaSgyOTkpLGkoMzU4KSxpKDMwNildLHI9ZnVuY3Rpb24odCxlLGksbixyLHMsbyl7dmFyIGE9dC5fO3JldHVybiBpLmV4dGVuZCh7Y2xhc3NOYW1lOiJlbnJvbGwtbWFudWFsLXRvdHAiLE1vZGVsOmZ1bmN0aW9uKCl7cmV0dXJue2xvY2FsOntzaGFyZWRTZWNyZXQ6WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInNoYXJlZFNlY3JldCIpXSxfX2ZhY3RvclR5cGVfXzpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLmZhY3RvclR5cGVdLF9fcHJvdmlkZXJfXzpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLnByb3ZpZGVyXX19fSxGb3JtOnt0aXRsZTpmdW5jdGlvbigpe3ZhciBpPWUuZ2V0RmFjdG9yTGFiZWwodGhpcy5tb2RlbC5nZXQoIl9fcHJvdmlkZXJfXyIpLHRoaXMubW9kZWwuZ2V0KCJfX2ZhY3RvclR5cGVfXyIpKTtyZXR1cm4gdC5sb2MoImVucm9sbC50b3RwLnRpdGxlIiwibG9naW4iLFtpXSl9LHN1YnRpdGxlOmEucGFydGlhbCh0LmxvYywiZW5yb2xsLnRvdHAuY2Fubm90U2NhbkJhcmNvZGUiLCJsb2dpbiIpLG5vQnV0dG9uQmFyOiEwLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoic3RlcC1tYW51YWwtc2V0dXAifSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXtyZXR1cm5bbi5WaWV3KHtWaWV3OidcdCAgICAgICAgICAgIDxwIGNsYXNzPSJva3RhLWZvcm0tc3VidGl0bGUgby1mb3JtLWV4cGxhaW4gdGV4dC1hbGlnbi1jIj5cdCAgICAgICAgICAgICAge3tpMThuIGNvZGU9ImVucm9sbC50b3RwLm1hbnVhbFNldHVwSW5zdHJ1Y3Rpb25zIiBidW5kbGU9ImxvZ2luIn19XHQgICAgICAgICAgICA8L3A+XHQgICAgICAgICAgJ30pLG4uSW5wdXQoe25hbWU6InNoYXJlZFNlY3JldCIsaW5wdXQ6byx0eXBlOiJ0ZXh0IixkaXNhYmxlZDohMH0pLG4uVG9vbGJhcih7bm9DYW5jZWxCdXR0b246ITAsc2F2ZTp0LmxvYygib2Zvcm0ubmV4dCIsImxvZ2luIil9KV19fSxGb290ZXI6cyxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5saXN0ZW5Ubyh0aGlzLmZvcm0sInNhdmUiLGZ1bmN0aW9uKCl7dmFyIHQ9ci5jcmVhdGVBY3RpdmF0ZUZhY3RvclVybCh0aGlzLm1vZGVsLmdldCgiX19wcm92aWRlcl9fIiksdGhpcy5tb2RlbC5nZXQoIl9fZmFjdG9yVHlwZV9fIiksImFjdGl2YXRlIik7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIix0KX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk5KSxpKDMwMSldLHI9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICA8YSBocmVmPSIjIiBjbGFzcz0ibGluayBoZWxwIGpzLWJhY2siIGRhdGEtc2U9ImJhY2stbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJtZmEuYmFja1RvRmFjdG9ycyIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9ImxpbmsgaGVscCBnb3RvIGpzLWdvdG8iIGRhdGEtc2U9ImdvdG8tbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJtZmEuc2NhbkJhcmNvZGUiIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgIDwvYT5cdCAgICAnLGNsYXNzTmFtZToiYXV0aC1mb290ZXIiLGV2ZW50czp7ImNsaWNrIC5qcy1iYWNrIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5iYWNrKCl9LCJjbGljayAuanMtZ290byI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMubW9kZWwuc3RhcnRUcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdC50eC5yZXN1bWUoKX0pfX0sYmFjazpmdW5jdGlvbigpe3RoaXMuc3RhdGUuc2V0KCJuYXZpZ2F0ZURpciIsaS5ESVJFQ1RJT05fQkFDSyksdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgicHJldkxpbmsiKT90aGlzLm1vZGVsLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQucHJldigpfSk6dGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIiwic2lnbmluL2Vucm9sbCIpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzYwKSxpKDM2MiksaSgzNjMpLGkoMzY0KSxpKDE5MCksaSgyOTcpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe3ZhciBhPXQuSGFuZGxlYmFycy5jb21waWxlLGw9dC5fLGM9dC4kLHU9dC5WaWV3LmV4dGVuZCh7dGVtcGxhdGU6J1x0ICAgICAgPGEgaHJlZj0iIyIgZGF0YS1zZT0ibmVlZGhlbHAiIGNsYXNzPSJsaW5rIGhlbHAganMtaGVscCI+XHQgICAgICB7e2kxOG4gY29kZT0ibmVlZGhlbHAiIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgIDwvYT5cdCAgICAgIDx1bCBjbGFzcz0iaGVscC1saW5rcyBqcy1oZWxwLWxpbmtzIj5cdCAgICAgICAgPGxpPlx0ICAgICAgICA8YSBocmVmPSIjIiBkYXRhLXNlPSJmb3Jnb3QtcGFzc3dvcmQiIGNsYXNzPSJsaW5rIGpzLWZvcmdvdC1wYXNzd29yZCI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJmb3Jnb3RwYXNzd29yZCIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgICA8L2E+XHQgICAgICAgIDwvbGk+XHQgICAgICAgIHt7I2lmIGZlYXR1cmVzLnNlbGZTZXJ2aWNlVW5sb2NrfX1cdCAgICAgICAgICA8bGk+XHQgICAgICAgICAgPGEgaHJlZj0iIyIgZGF0YS1zZT0idW5sb2NrIiBjbGFzcz0ibGluayBqcy11bmxvY2siPlx0ICAgICAgICAgIHt7aTE4biBjb2RlPSJ1bmxvY2thY2NvdW50IiBidW5kbGU9ImxvZ2luIn19XHQgICAgICAgICAgPC9hPlx0ICAgICAgICAgIDwvbGk+XHQgICAgICAgIHt7L2lmfX1cdCAgICAgICAge3sjZWFjaCBoZWxwTGlua3MuY3VzdG9tfX1cdCAgICAgICAgICA8bGk+XHQgICAgICAgICAgPGEgaHJlZj0ie3tocmVmfX0iIGNsYXNzPSJsaW5rIGpzLWN1c3RvbSI+e3t0ZXh0fX08L2E+PC9saT5cdCAgICAgICAge3svZWFjaH19XHQgICAgICAgIDxsaT5cdCAgICAgICAgPGEgaHJlZj0ie3toZWxwTGlua1VybH19IiBkYXRhLXNlPSJoZWxwLWxpbmsiIGNsYXNzPSJsaW5rIGpzLWhlbHAtbGluayIgdGFyZ2V0PSJfYmxhbmsiPlx0ICAgICAgICB7e2kxOG4gY29kZT0iaGVscCIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgICA8L2E+XHQgICAgICAgIDwvbGk+XHQgICAgICA8L3VsPlx0ICAgICcsY2xhc3NOYW1lOiJhdXRoLWZvb3RlciIsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5zdGF0ZSwiY2hhbmdlOmVuYWJsZWQiLGZ1bmN0aW9uKHQsZSl7dGhpcy4kKCI6bGluayIpLnRvZ2dsZUNsYXNzKCJvLWZvcm0tZGlzYWJsZWQiLCFlKX0pfSxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXt2YXIgdCxlPXRoaXMuc2V0dGluZ3MuZ2V0KCJoZWxwTGlua3MuaGVscCIpO3JldHVybiB0PWU/ZTphKCJ7e2Jhc2VVcmx9fS9oZWxwL2xvZ2luIikoe2Jhc2VVcmw6dGhpcy5zZXR0aW5ncy5nZXQoImJhc2VVcmwiKX0pLGwuZXh0ZW5kKHRoaXMuc2V0dGluZ3MudG9KU09OKHt2ZXJib3NlOiEwfSkse2hlbHBMaW5rVXJsOnR9KX0scG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMuJCgiLmpzLWhlbHAtbGlua3MiKS5oaWRlKCl9LHRvZ2dsZUxpbmtzOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLiQoIi5qcy1oZWxwLWxpbmtzIikuc2xpZGVUb2dnbGUoMjAwKX0sZXZlbnRzOnsiY2xpY2sgLmpzLWhlbHAiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLnN0YXRlLmdldCgiZW5hYmxlZCIpJiZ0aGlzLnRvZ2dsZUxpbmtzKHQpfSwiY2xpY2sgLmpzLWZvcmdvdC1wYXNzd29yZCI6ZnVuY3Rpb24odCl7aWYodC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuc3RhdGUuZ2V0KCJlbmFibGVkIikpe3ZhciBlPXRoaXMuc2V0dGluZ3MuZ2V0KCJoZWxwTGlua3MuZm9yZ290UGFzc3dvcmQiKTtlP3MucmVkaXJlY3QoZSk6dGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIiwic2lnbmluL2ZvcmdvdC1wYXNzd29yZCIpfX0sImNsaWNrIC5qcy11bmxvY2siOmZ1bmN0aW9uKHQpe2lmKHQucHJldmVudERlZmF1bHQoKSx0aGlzLnN0YXRlLmdldCgiZW5hYmxlZCIpKXt2YXIgZT10aGlzLnNldHRpbmdzLmdldCgiaGVscExpbmtzLnVubG9jayIpO2U/cy5yZWRpcmVjdChlKTp0aGlzLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCJzaWduaW4vdW5sb2NrIil9fX19KTtyZXR1cm4gby5leHRlbmQoe2NsYXNzTmFtZToicHJpbWFyeS1hdXRoIixzdGF0ZTp7ZW5hYmxlZDohMH0sVmlldzplLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKHQpe3ZhciBlO3QuYXBwU3RhdGUudW5zZXQoInVzZXJuYW1lIiksdGhpcy5tb2RlbD1uZXcgcih7bXVsdGlPcHRpb25hbEZhY3RvckVucm9sbDp0LnNldHRpbmdzLmdldCgiZmVhdHVyZXMubXVsdGlPcHRpb25hbEZhY3RvckVucm9sbCIpLHNldHRpbmdzOnQuc2V0dGluZ3MsYXBwU3RhdGU6dC5hcHBTdGF0ZX0se3BhcnNlOiEwfSksby5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5hZGRMaXN0ZW5lcnMoKSx0LnNldHRpbmdzLmdldCgiaGFzQ29uZmlndXJlZEJ1dHRvbnMiKSYmdGhpcy5hZGQoaSx7cHJlcGVuZDp0LnNldHRpbmdzLmdldCgic29jaWFsQXV0aFBvc2l0aW9uVG9wIil9KSx0aGlzLmFkZChuZXcgdSh0aGlzLnRvSlNPTih7YXBwU3RhdGU6dC5hcHBTdGF0ZX0pKSksdC5zZXR0aW5ncy5nZXQoImZlYXR1cmVzLnJlZ2lzdHJhdGlvbiIpJiZ0aGlzLmFkZChuZXcgbih7c2V0dGluZ3M6dGhpcy5zZXR0aW5ncyxhcHBTdGF0ZTp0LmFwcFN0YXRlfSkpLGU9dGhpcy5tb2RlbC5nZXQoInVzZXJuYW1lIiksZSYmdGhpcy5vcHRpb25zLmFwcFN0YXRlLnNldCgidXNlcm5hbWUiLGUpfSxldmVudHM6eyJmb2N1c291dCBpbnB1dFtuYW1lPXVzZXJuYW1lXSI6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuYXBwU3RhdGUuc2V0KCJ1c2VybmFtZSIsdGhpcy5tb2RlbC5nZXQoInVzZXJuYW1lIikpfSwiZm9jdXNpbiBpbnB1dCI6ZnVuY3Rpb24odCl7Yyh0LnRhcmdldC5wYXJlbnRFbGVtZW50KS5hZGRDbGFzcygiZm9jdXNlZC1pbnB1dCIpfSwiZm9jdXNvdXQgaW5wdXQiOmZ1bmN0aW9uKHQpe2ModC50YXJnZXQucGFyZW50RWxlbWVudCkucmVtb3ZlQ2xhc3MoImZvY3VzZWQtaW5wdXQiKX19LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImNoYW5nZTp1c2VybmFtZSIsZnVuY3Rpb24odCxlKXtlfHx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuc2V0KCJ1c2VybmFtZSIsIiIpfSksdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJzYXZlIixmdW5jdGlvbigpe3RoaXMuc3RhdGUuc2V0KCJlbmFibGVkIiwhMSl9KSx0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImVycm9yIixmdW5jdGlvbigpe3RoaXMuc3RhdGUuc2V0KCJlbmFibGVkIiwhMCl9KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDMwNiksaSgzNjEpXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Ll87cmV0dXJuIHQuRm9ybS5leHRlbmQoe2NsYXNzTmFtZToicHJpbWFyeS1hdXRoLWZvcm0iLG5vQ2FuY2VsQnV0dG9uOiEwLHNhdmU6bi5wYXJ0aWFsKHQubG9jLCJwcmltYXJ5YXV0aC5zdWJtaXQiLCJsb2dpbiIpLHNhdmVJZDoib2t0YS1zaWduaW4tc3VibWl0IixsYXlvdXQ6Im8tZm9ybS10aGVtZSIsdGl0bGU6ZnVuY3Rpb24oKXt2YXIgZT10LmxvYygicHJpbWFyeWF1dGgudGl0bGUiLCJsb2dpbiIpO3JldHVybiB0aGlzLnNldHRpbmdzLmdldCgic29jaWFsQXV0aFBvc2l0aW9uVG9wIikmJihlPSIiKSxlfSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5saXN0ZW5Ubyh0aGlzLCJzYXZlIixmdW5jdGlvbigpe3ZhciB0PXRoaXMsZT17dXNlcm5hbWU6dGhpcy5tb2RlbC5nZXQoInVzZXJuYW1lIikscGFzc3dvcmQ6dGhpcy5tb2RlbC5nZXQoInBhc3N3b3JkIil9O3RoaXMuc2V0dGluZ3MucHJvY2Vzc0NyZWRzKGUpLnRoZW4oZnVuY3Rpb24oKXtpZih0LnNldHRpbmdzLmdldCgiZmVhdHVyZXMuZGV2aWNlRmluZ2VycHJpbnRpbmciKSlyZXR1cm4gaS5nZW5lcmF0ZURldmljZUZpbmdlcnByaW50KHQuc2V0dGluZ3MuZ2V0KCJiYXNlVXJsIiksdC4kZWwpLnRoZW4oZnVuY3Rpb24oZSl7dC5tb2RlbC5zZXQoImRldmljZUZpbmdlcnByaW50IixlKX0pLmZhaWwoZnVuY3Rpb24oKXt9KX0pLnRoZW4obi5iaW5kKHRoaXMubW9kZWwuc2F2ZSx0aGlzLm1vZGVsKSl9KSx0aGlzLmxpc3RlblRvKHRoaXMuc3RhdGUsImNoYW5nZTplbmFibGVkIixmdW5jdGlvbih0LGUpe2U/dGhpcy5lbmFibGUoKTp0aGlzLmRpc2FibGUoKX0pfSxpbnB1dHM6ZnVuY3Rpb24oKXt2YXIgaT1be2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnQubG9jKCJwcmltYXJ5YXV0aC51c2VybmFtZS5wbGFjZWhvbGRlciIsImxvZ2luIiksbmFtZToidXNlcm5hbWUiLGlucHV0OmUsaW5wdXRJZDoib2t0YS1zaWduaW4tdXNlcm5hbWUiLHR5cGU6InRleHQiLHBhcmFtczp7aW5uZXJUb29sdGlwOnt0aXRsZTp0LmxvYygicHJpbWFyeWF1dGgudXNlcm5hbWUucGxhY2Vob2xkZXIiLCJsb2dpbiIpLHRleHQ6dC5sb2MoInByaW1hcnlhdXRoLnVzZXJuYW1lLnRvb2x0aXAiLCJsb2dpbiIpfSxpY29uOiJwZXJzb24tMTYtZ3JheSJ9fSx7bGFiZWw6ITEsImxhYmVsLXRvcCI6ITAscGxhY2Vob2xkZXI6dC5sb2MoInByaW1hcnlhdXRoLnBhc3N3b3JkLnBsYWNlaG9sZGVyIiwibG9naW4iKSxuYW1lOiJwYXNzd29yZCIsaW5wdXQ6ZSxpbnB1dElkOiJva3RhLXNpZ25pbi1wYXNzd29yZCIsdHlwZToicGFzc3dvcmQiLHBhcmFtczp7aW5uZXJUb29sdGlwOnt0aXRsZTp0LmxvYygicHJpbWFyeWF1dGgucGFzc3dvcmQucGxhY2Vob2xkZXIiLCJsb2dpbiIpLHRleHQ6dC5sb2MoInByaW1hcnlhdXRoLnBhc3N3b3JkLnRvb2x0aXAiLCJsb2dpbiIpfSxpY29uOiJyZW1vdGUtbG9jay0xNiJ9fV07cmV0dXJuIHRoaXMuc2V0dGluZ3MuZ2V0KCJmZWF0dXJlcy5yZW1lbWJlck1lIikmJmkucHVzaCh7bGFiZWw6ITEscGxhY2Vob2xkZXI6dC5sb2MoInJlbWVtYmVyIiwibG9naW4iKSxuYW1lOiJyZW1lbWJlciIsdHlwZToiY2hlY2tib3giLCJsYWJlbC10b3AiOiEwLGNsYXNzTmFtZToibWFyZ2luLWJ0bS0wIixpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCJjaGFuZ2U6cmVtZW1iZXIiLGZ1bmN0aW9uKHQsZSl7dGhpcy4kKCI6Y2hlY2tib3giKS5wcm9wKCJjaGVja2VkIixlKS50cmlnZ2VyKCJ1cGRhdGVTdGF0ZSIpfSl9fSksaX0sZm9jdXM6ZnVuY3Rpb24oKXt0aGlzLm1vZGVsLmdldCgidXNlcm5hbWUiKT90aGlzLmdldElucHV0cygpLnRvQXJyYXkoKVsxXS5mb2N1cygpOnRoaXMuZ2V0SW5wdXRzKCkuZmlyc3QoKS5mb2N1cygpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMjEpLGkoNSldLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm57Z2VuZXJhdGVEZXZpY2VGaW5nZXJwcmludDpmdW5jdGlvbihpLG4pe2Z1bmN0aW9uIHIoKXtjLm9mZigpLGMucmVtb3ZlKCksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLG8sITEpfWZ1bmN0aW9uIHModCl7cigpLGwucmVqZWN0KHQpfWZ1bmN0aW9uIG8odCl7aWYoIXR8fCF0LmRhdGF8fHQub3JpZ2luIT1pKXJldHVybiB2b2lkIHMoIm5vIGRhdGEiKTt0cnl7dmFyIGU9SlNPTi5wYXJzZSh0LmRhdGEpO2UmJiJGaW5nZXJwcmludFNlcnZpY2VSZWFkeSI9PT1lLnR5cGU/YSh7dHlwZToiR2V0RmluZ2VycHJpbnQifSk6ZSYmIkZpbmdlcnByaW50QXZhaWxhYmxlIj09PWUudHlwZT8ocigpLGwucmVzb2x2ZShlLmZpbmdlcnByaW50KSk6cygibm8gZGF0YSIpfWNhdGNoKG4pe319ZnVuY3Rpb24gYSh0KXt2YXIgZT1jWzBdLmNvbnRlbnRXaW5kb3c7ZSYmZS5wb3N0TWVzc2FnZShKU09OLnN0cmluZ2lmeSh0KSxpKX12YXIgbD10LmRlZmVyKCksYz1lKCI8aWZyYW1lPiIse3N0eWxlOiJkaXNwbGF5OiBub25lOyJ9KTtyZXR1cm4gYy5hcHBlbmRUbyhuKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsbywhMSksYy5hdHRyKCJzcmMiLGkrIi9hdXRoL3NlcnZpY2VzL2RldmljZWZpbmdlcnByaW50IiksbC5wcm9taXNlfX19LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMildLHI9ZnVuY3Rpb24odCl7dmFyIGU9dC5fLGk9dC50cGwoJzxkaXYgY2xhc3M9ImF1dGgtZGl2aWRlciI+XHQgICAgICA8c3BhbiBjbGFzcz0iYXV0aC1kaXZpZGVyLXRleHQiPnt7dGV4dH19PC9zcGFuPlx0ICAgIDwvZGl2PicpLG49dC50cGwoJzxoMiBkYXRhLXNlPSJvLWZvcm0taGVhZCIgY2xhc3M9Im9rdGEtZm9ybS10aXRsZSBvLWZvcm0taGVhZCI+e3t0aXRsZX19PC9oMj4nKTtyZXR1cm4gdC5WaWV3LmV4dGVuZCh7Y2xhc3NOYW1lOiJwcmltYXJ5LWF1dGgtY29udGFpbmVyIixjaGlsZHJlbjpmdW5jdGlvbigpe3ZhciByPVtdLHM9dGhpcy5zZXR0aW5ncy5nZXQoImNvbmZpZ3VyZWRCdXR0b25zIiksbz1pKHt0ZXh0OnQubG9jKCJzb2NpYWxhdXRoLmRpdmlkZXIudGV4dCIsImxvZ2luIil9KTtyZXR1cm4gZS5lYWNoKHMsZnVuY3Rpb24odCl7ci5wdXNoKHRoaXMuX2NyZWF0ZUJ1dHRvbih0KSl9LHRoaXMpLHRoaXMuc2V0dGluZ3MuZ2V0KCJzb2NpYWxBdXRoUG9zaXRpb25Ub3AiKT8oci51bnNoaWZ0KG4oe3RpdGxlOnQubG9jKCJwcmltYXJ5YXV0aC50aXRsZSIsImxvZ2luIil9KSksci5wdXNoKG8pKTpyLnVuc2hpZnQobykscn0sX2NyZWF0ZUJ1dHRvbjpmdW5jdGlvbihlKXtyZXR1cm4gdC5jcmVhdGVCdXR0b24oe2F0dHJpYnV0ZXM6eyJkYXRhLXNlIjplLmRhdGFBdHRyfSxjbGFzc05hbWU6ZS5jbGFzc05hbWUsdGl0bGU6ZS50aXRsZSxjbGljazplLmNsaWNrfSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMildLHI9ZnVuY3Rpb24odCl7cmV0dXJuIHQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgICAgPGRpdiBjbGFzcz0iY29udGVudCI+XHQgICAgICAgICAgPHNwYW4gY2xhc3M9InJlZ2lzdHJhdGlvbi1sYWJlbCI+e3tsYWJlbH19PC9zcGFuPlx0ICAgICAgICAgIDxhIHRpdGxlPSJ7e3RleHR9fSIgYXJpYS1sYWJlbD0ie3t0ZXh0fX0iIGNsYXNzPSJyZWdpc3RyYXRpb24tbGluayIgaHJlZj0iIyI+e3t0ZXh0fX08L2E+XHQgICAgICAgIDwvZGl2Plx0ICAgICAgICAnLGNsYXNzTmFtZToicmVnaXN0cmF0aW9uLWNvbnRhaW5lciIsZXZlbnRzOnsiY2xpY2sgYS5yZWdpc3RyYXRpb24tbGluayI6ImhhbmRsZUNsaWNrRXZlbnQifSxoYW5kbGVDbGlja0V2ZW50OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5zZXR0aW5ncy5nZXQoInJlZ2lzdHJhdGlvbi5jbGljayIpO3JldHVybiB0JiZ0KCksITF9LGdldFRlbXBsYXRlRGF0YTpmdW5jdGlvbigpe3ZhciBlPXtsYWJlbDp0LmxvYygicmVnaXN0cmF0aW9uLnNpZ251cC5sYWJlbCIsImxvZ2luIiksdGV4dDp0LmxvYygicmVnaXN0cmF0aW9uLnNpZ251cC50ZXh0IiwibG9naW4iKX07cmV0dXJuIGV9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTgpLGkoMzI0KSxpKDMwMSldLHI9ZnVuY3Rpb24odCxlLGksbil7dmFyIHI9dC5fO3JldHVybiBlLmV4dGVuZCh7cHJvcHM6ZnVuY3Rpb24oKXt2YXIgZSxuPXRoaXMuc2V0dGluZ3MmJnRoaXMuc2V0dGluZ3MuZ2V0KCJ1c2VybmFtZSIpLHM9aS5nZXRDb29raWVVc2VybmFtZSgpLG89ITE7cmV0dXJuIG4/KGU9bixvPWU9PT1zKTpzJiYoZT1zLG89ITApLHt1c2VybmFtZTp7dHlwZToic3RyaW5nIix2YWxpZGF0ZTpmdW5jdGlvbihlKXtpZihyLmlzRW1wdHkoZSkpcmV0dXJuIHQubG9jKCJlcnJvci51c2VybmFtZS5yZXF1aXJlZCIsImxvZ2luIil9LHZhbHVlOmV9LGxhc3RVc2VybmFtZTpbInN0cmluZyIsITEsc10scGFzc3dvcmQ6e3R5cGU6InN0cmluZyIsdmFsaWRhdGU6ZnVuY3Rpb24oZSl7aWYoci5pc0VtcHR5KGUpKXJldHVybiB0LmxvYygiZXJyb3IucGFzc3dvcmQucmVxdWlyZWQiLCJsb2dpbiIpfX0sY29udGV4dDpbIm9iamVjdCIsITFdLHJlbWVtYmVyOlsiYm9vbGVhbiIsITAsb10sbXVsdGlPcHRpb25hbEZhY3RvckVucm9sbDpbImJvb2xlYW4iLCEwXX19LGxvY2FsOntkZXZpY2VGaW5nZXJwcmludDpbInN0cmluZyIsITFdfSxjb25zdHJ1Y3RvcjpmdW5jdGlvbihlKXt0aGlzLnNldHRpbmdzPWUmJmUuc2V0dGluZ3MsdGhpcy5hcHBTdGF0ZT1lJiZlLmFwcFN0YXRlLHQuTW9kZWwuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMubGlzdGVuVG8odGhpcywiY2hhbmdlOnVzZXJuYW1lIixmdW5jdGlvbih0LGUpe3RoaXMuc2V0KHtyZW1lbWJlcjplPT09dGhpcy5nZXQoImxhc3RVc2VybmFtZSIpfSl9KX0scGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuIHIub21pdCh0LFsic2V0dGluZ3MiLCJhcHBTdGF0ZSJdKX0sc2F2ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuc2V0dGluZ3MudHJhbnNmb3JtVXNlcm5hbWUodGhpcy5nZXQoInVzZXJuYW1lIiksbi5QUklNQVJZX0FVVEgpLGU9dGhpcy5nZXQoInBhc3N3b3JkIikscz10aGlzLmdldCgicmVtZW1iZXIiKSxvPXRoaXMuZ2V0KCJsYXN0VXNlcm5hbWUiKSxhPXRoaXMuZ2V0KCJtdWx0aU9wdGlvbmFsRmFjdG9yRW5yb2xsIiksbD10aGlzLnNldHRpbmdzLmdldCgiZmVhdHVyZXMuZGV2aWNlRmluZ2VycHJpbnRpbmciKTtzfHxvIT09dD9zJiZpLnNldFVzZXJuYW1lQ29va2llKHQpOmkucmVtb3ZlVXNlcm5hbWVDb29raWUoKSx0aGlzLnRyaWdnZXIoInNhdmUiKSx0aGlzLmFwcFN0YXRlLnRyaWdnZXIoImxvYWRpbmciLCEwKTt2YXIgYyx1PXt1c2VybmFtZTp0LHBhc3N3b3JkOmUsb3B0aW9uczp7d2FybkJlZm9yZVBhc3N3b3JkRXhwaXJlZDohMCxtdWx0aU9wdGlvbmFsRmFjdG9yRW5yb2xsOmF9fTtyZXR1cm4gYz10aGlzLmFwcFN0YXRlLmdldCgiaXNVbmF1dGhlbnRpY2F0ZWQiKT90aGlzLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5hcHBTdGF0ZS5zZXR0aW5ncy5hdXRoQ2xpZW50O3JldHVybiB0aGlzLmRvUHJpbWFyeUF1dGgoZSxsLHUsdC5hdXRoZW50aWNhdGUpfSk6dGhpcy5zdGFydFRyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRvUHJpbWFyeUF1dGgodCxsLHUsci5iaW5kKHQuc2lnbkluLHQpKX0pLGMuZmFpbChyLmJpbmQoZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXIoImVycm9yIiksdGhpcy5hcHBTdGF0ZS50cmlnZ2VyKCJyZW1vdmVMb2FkaW5nIiksaS5yZW1vdmVVc2VybmFtZUNvb2tpZSgpfSx0aGlzKSkuZmluKHIuYmluZChmdW5jdGlvbigpe3RoaXMuYXBwU3RhdGUudHJpZ2dlcigibG9hZGluZyIsITEpfSx0aGlzKSl9LGRvUHJpbWFyeUF1dGg6ZnVuY3Rpb24odCxlLGksbil7cmV0dXJuIGUmJih0Lm9wdGlvbnMuaGVhZGVyc1siWC1EZXZpY2UtRmluZ2VycHJpbnQiXT10aGlzLmdldCgiZGV2aWNlRmluZ2VycHJpbnQiKSksbihpKS5maW4oZnVuY3Rpb24oKXtlJiZkZWxldGUgdC5vcHRpb25zLmhlYWRlcnNbIlgtRGV2aWNlLUZpbmdlcnByaW50Il19KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5MiksaSgyOTUpLGkoMjk2KSxpKDI5OSldLHI9ZnVuY3Rpb24odCxlLGksbixyKXt2YXIgcz10Ll8sbz02ZTMsYT10LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICA8YSBocmVmPSIjIiBjbGFzcz0ibGluayBoZWxwIGpzLWJhY2siIGRhdGEtc2U9ImJhY2stbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJvZm9ybS5iYWNrIiBidW5kbGU9ImxvZ2luIn19XHQgICAgICA8L2E+XHQgICAgJyxjbGFzc05hbWU6ImF1dGgtZm9vdGVyIixldmVudHM6eyJjbGljayAuanMtYmFjayI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuYmFjaygpfX0sYmFjazpmdW5jdGlvbigpe3ZhciB0PXIuY3JlYXRlQWN0aXZhdGVGYWN0b3JVcmwodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiYWN0aXZhdGVkRmFjdG9yUHJvdmlkZXIiKSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhY3RpdmF0ZWRGYWN0b3JUeXBlIiksIm1hbnVhbCIpO3RoaXMub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsdCl9fSksbD17dGl0bGU6cy5wYXJ0aWFsKHQubG9jLCJlbnJvbGwudG90cC5lbnJvbGxWaWFFbWFpbC50aXRsZSIsImxvZ2luIiksbm9CdXR0b25CYXI6ITAsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJzZW50LWVtYWlsLWFjdGl2YXRpb24tbGluayJ9LGZvcm1DaGlsZHJlbjpbbi5WaWV3KHtWaWV3OnQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgICAgICAgIDxwPnt7aTE4biBjb2RlPSJlbnJvbGwudG90cC5lbnJvbGxWaWFFbWFpbC5tc2ciIGJ1bmRsZT0ibG9naW4ifX08L3A+XHQgICAgICAgICAgICA8cCBjbGFzcz0iZW1haWwtYWRkcmVzcyI+e3tlbWFpbH19PC9wPlx0ICAgICAgICAgICcsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJue2VtYWlsOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInVzZXJFbWFpbCIpfX19KX0pXX0sYz17dGl0bGU6cy5wYXJ0aWFsKHQubG9jLCJlbnJvbGwudG90cC5lbnJvbGxWaWFTbXMudGl0bGUiLCJsb2dpbiIpLG5vQnV0dG9uQmFyOiEwLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoic2VudC1zbXMtYWN0aXZhdGlvbi1saW5rIn0sZm9ybUNoaWxkcmVuOltuLlZpZXcoe1ZpZXc6dC5WaWV3LmV4dGVuZCh7dGVtcGxhdGU6J1x0ICAgICAgICAgICAgPHA+e3tpMThuIGNvZGU9ImVucm9sbC50b3RwLmVucm9sbFZpYVNtcy5tc2ciIGJ1bmRsZT0ibG9naW4ifX08L3A+XHQgICAgICAgICAgICA8cCBjbGFzcz0icGhvbmUtbnVtYmVyIj57e3Bob25lTnVtYmVyfX08L3A+XHQgICAgICAgICAgJyxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXtyZXR1cm57cGhvbmVOdW1iZXI6dGhpcy5tb2RlbC5nZXQoImZ1bGxQaG9uZU51bWJlciIpfX19KX0pXX07cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6ImVucm9sbC1hY3RpdmF0aW9uLWxpbmstc2VudCIsTW9kZWw6ZnVuY3Rpb24oKXtyZXR1cm57bG9jYWw6e2NvdW50cnlDb2RlOlsic3RyaW5nIiwhMSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJ1c2VyQ291bnRyeUNvZGUiKV0scGhvbmVOdW1iZXI6WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInVzZXJQaG9uZU51bWJlciIpXSxfX2ZhY3RvclR5cGVfXzpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLmZhY3RvclR5cGVdLF9fcHJvdmlkZXJfXzpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLnByb3ZpZGVyXX0sZGVyaXZlZDp7Y291bnRyeUNhbGxpbmdDb2RlOntkZXBzOlsiY291bnRyeUNvZGUiXSxmbjpmdW5jdGlvbih0KXtyZXR1cm4iKyIrZS5nZXRDYWxsaW5nQ29kZUZvckNvdW50cnkodCl9fSxmdWxsUGhvbmVOdW1iZXI6e2RlcHM6WyJjb3VudHJ5Q2FsbGluZ0NvZGUiLCJwaG9uZU51bWJlciJdLGZuOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrZX19fX19LEZvcm06ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJmYWN0b3JBY3RpdmF0aW9uVHlwZSIpO3N3aXRjaCh0KXtjYXNlIlNNUyI6cmV0dXJuIGM7Y2FzZSJFTUFJTCI6cmV0dXJuIGw7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoIlVua25vd24gYWN0aXZhdGlvbiBvcHRpb246ICIrdCl9fSxGb290ZXI6YSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5wb2xsRm9yRW5yb2xsbWVudCgpfSxyZW1vdmU6ZnVuY3Rpb24oKXtyZXR1cm4gaS5wcm90b3R5cGUucmVtb3ZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0scG9sbEZvckVucm9sbG1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnBvbGwobyl9KX0sdHJhcEF1dGhSZXNwb25zZTpmdW5jdGlvbigpe2lmKHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImlzV2FpdGluZ0ZvckFjdGl2YXRpb24iKSlyZXR1cm4gdGhpcy5wb2xsRm9yRW5yb2xsbWVudCgpLCEwfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KSxpKDI5OSksaSgzNTYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPXQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIGhlbHAganMtYmFjayIgZGF0YS1zZT0iYmFjay1saW5rIj5cdCAgICAgICAge3tpMThuIGNvZGU9Im9mb3JtLmJhY2siIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgIDwvYT5cdCAgICAnLGNsYXNzTmFtZToiYXV0aC1mb290ZXIiLGV2ZW50czp7ImNsaWNrIC5qcy1iYWNrIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5iYWNrKCl9fSxiYWNrOmZ1bmN0aW9uKCl7dmFyIHQ9aS5jcmVhdGVBY3RpdmF0ZUZhY3RvclVybCh0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhY3RpdmF0ZWRGYWN0b3JQcm92aWRlciIpLCJwdXNoIiwibWFudWFsIik7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIix0KX19KTtyZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZToiYWN0aXZhdGUtcHVzaCIsTW9kZWw6ZnVuY3Rpb24oKXtyZXR1cm57cHJvcHM6e2ZhY3RvcklkOlsic3RyaW5nIiwhMCx0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJhY3RpdmF0ZWRGYWN0b3JJZCIpXSxwYXNzQ29kZTpbInN0cmluZyIsITBdfSxsb2NhbDp7X19mYWN0b3JUeXBlX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5mYWN0b3JUeXBlXSxfX3Byb3ZpZGVyX186WyJzdHJpbmciLCExLHRoaXMub3B0aW9ucy5wcm92aWRlcl19LHNhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LmFjdGl2YXRlKHtwYXNzQ29kZTp0aGlzLmdldCgicGFzc0NvZGUiKX0pfSl9fX0sRm9ybTpuLEZvb3RlcjpyfSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTUpLGkoMzAxKSxpKDI5NiksaSgzNjgpLGkoMjk0KSxpKDM2OSksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSl7dmFyIGw9dC5fO3JldHVybiBlLmV4dGVuZCh7Y2xhc3NOYW1lOiJwYXNzd29yZC1leHBpcmVkIixNb2RlbDp7cHJvcHM6e29sZFBhc3N3b3JkOlsic3RyaW5nIiwhMF0sbmV3UGFzc3dvcmQ6WyJzdHJpbmciLCEwXSxjb25maXJtUGFzc3dvcmQ6WyJzdHJpbmciLCEwXX0sdmFsaWRhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gci52YWxpZGF0ZVBhc3N3b3JkTWF0Y2godGhpcyl9LHNhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LmNoYW5nZVBhc3N3b3JkKHtvbGRQYXNzd29yZDp0aGlzLmdldCgib2xkUGFzc3dvcmQiKSxuZXdQYXNzd29yZDp0aGlzLmdldCgibmV3UGFzc3dvcmQiKX0pfSl9fSxGb3JtOntzYXZlOmwucGFydGlhbCh0LmxvYywicGFzc3dvcmQuZXhwaXJlZC5zdWJtaXQiLCJsb2dpbiIpLHRpdGxlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNQd2RFeHBpcmluZ1Nvb24iKSxpPXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInBhc3N3b3JkRXhwaXJlRGF5cyIpO3JldHVybiBlJiZpPjA/dC5sb2MoInBhc3N3b3JkLmV4cGlyaW5nLnRpdGxlIiwibG9naW4iLFtpXSk6ZSYmMD09PWk/dC5sb2MoInBhc3N3b3JkLmV4cGlyaW5nLnRvZGF5IiwibG9naW4iKTp0LmxvYygicGFzc3dvcmQuZXhwaXJlZC50aXRsZSIsImxvZ2luIil9LHN1YnRpdGxlOmZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiaXNQd2RFeHBpcmluZ1Nvb24iKSlyZXR1cm4gdC5sb2MoInBhc3N3b3JkLmV4cGlyaW5nLnN1YnRpdGxlIiwibG9naW4iKTt2YXIgZT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJwb2xpY3kiKTtpZihlKXJldHVybiBzLmdldFBhc3N3b3JkQ29tcGxleGl0eURlc2NyaXB0aW9uKGUpfSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXtyZXR1cm5bbi5JbnB1dCh7ImxhYmVsLXRvcCI6ITAsbGFiZWw6ITEscGxhY2Vob2xkZXI6dC5sb2MoInBhc3N3b3JkLm9sZFBhc3N3b3JkLnBsYWNlaG9sZGVyIiwibG9naW4iKSxuYW1lOiJvbGRQYXNzd29yZCIsaW5wdXQ6YSx0eXBlOiJwYXNzd29yZCIscGFyYW1zOntpbm5lclRvb2x0aXA6dC5sb2MoInBhc3N3b3JkLm9sZFBhc3N3b3JkLnRvb2x0aXAiLCJsb2dpbiIpLGljb246ImNyZWRlbnRpYWxzLTE2In19KSxuLkRpdmlkZXIoKSxuLklucHV0KHsibGFiZWwtdG9wIjohMCxsYWJlbDohMSxwbGFjZWhvbGRlcjp0LmxvYygicGFzc3dvcmQubmV3UGFzc3dvcmQucGxhY2Vob2xkZXIiLCJsb2dpbiIpLG5hbWU6Im5ld1Bhc3N3b3JkIixpbnB1dDphLHR5cGU6InBhc3N3b3JkIixwYXJhbXM6e2lubmVyVG9vbHRpcDp0LmxvYygicGFzc3dvcmQubmV3UGFzc3dvcmQudG9vbHRpcCIsImxvZ2luIiksaWNvbjoiY3JlZGVudGlhbHMtMTYifX0pLG4uSW5wdXQoeyJsYWJlbC10b3AiOiEwLGxhYmVsOiExLHBsYWNlaG9sZGVyOnQubG9jKCJwYXNzd29yZC5jb25maXJtUGFzc3dvcmQucGxhY2Vob2xkZXIiLCJsb2dpbiIpLG5hbWU6ImNvbmZpcm1QYXNzd29yZCIsaW5wdXQ6YSx0eXBlOiJwYXNzd29yZCIscGFyYW1zOntpbm5lclRvb2x0aXA6dC5sb2MoInBhc3N3b3JkLmNvbmZpcm1QYXNzd29yZC50b29sdGlwIiwibG9naW4iKSxpY29uOiJjcmVkZW50aWFscy0xNiJ9fSldfX0sRm9vdGVyOm8saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5mb3JtLCJzYXZlIixmdW5jdGlvbigpe3ZhciB0PXt1c2VybmFtZTp0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJ1c2VyRW1haWwiKSxwYXNzd29yZDp0aGlzLm1vZGVsLmdldCgibmV3UGFzc3dvcmQiKX07dGhpcy5zZXR0aW5ncy5wcm9jZXNzQ3JlZHModCkudGhlbihsLmJpbmQodGhpcy5tb2RlbC5zYXZlLHRoaXMubW9kZWwpKX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpXSxyPWZ1bmN0aW9uKHQpe3ZhciBlPXt9O3JldHVybiBlLnZhbGlkYXRlVXNlcm5hbWU9ZnVuY3Rpb24oZSl7dmFyIGk9ZS5nZXQoInVzZXJuYW1lIik7aWYoaSYmaS5sZW5ndGg+MjU2KXJldHVybnt1c2VybmFtZTp0LmxvYygibW9kZWwudmFsaWRhdGlvbi5maWVsZC51c2VybmFtZSIsImxvZ2luIil9fSxlLnZhbGlkYXRlUGFzc3dvcmRNYXRjaD1mdW5jdGlvbihlKXtpZihlLmdldCgibmV3UGFzc3dvcmQiKSE9PWUuZ2V0KCJjb25maXJtUGFzc3dvcmQiKSlyZXR1cm57Y29uZmlybVBhc3N3b3JkOnQubG9jKCJwYXNzd29yZC5lcnJvci5tYXRjaCIsImxvZ2luIil9fSxlfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzAxKSxpKDE5MCldLHI9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICB7eyNpZiBwYXNzd29yZFdhcm59fVx0ICAgICAgICA8YSBocmVmPSIjIiBjbGFzcz0ibGluayBoZWxwIGpzLXNraXAiIGRhdGEtc2U9InNraXAtbGluayI+XHQgICAgICAgICAge3tpMThuIGNvZGU9InBhc3N3b3JkLmV4cGlyaW5nLmxhdGVyIiBidW5kbGU9ImxvZ2luIn19XHQgICAgICAgIDwvYT5cdCAgICAgIHt7L2lmfX1cdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIGhlbHAgZ290byBqcy1zaWdub3V0IiBkYXRhLXNlPSJzaWdub3V0LWxpbmsiPnt7aTE4biBjb2RlPSJzaWdub3V0IiBidW5kbGU9ImxvZ2luIn19PC9hPlx0ICAgICcsY2xhc3NOYW1lOiJhdXRoLWZvb3RlciBjbGVhcmZpeCIsZXZlbnRzOnsiY2xpY2sgLmpzLXNpZ25vdXQiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKTt2YXIgbj10aGlzO3RoaXMubW9kZWwuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdC5jYW5jZWwoKX0pLnRoZW4oZnVuY3Rpb24oKXtuLnNldHRpbmdzLmdldCgic2lnbk91dExpbmsiKT9pLnJlZGlyZWN0KG4uc2V0dGluZ3MuZ2V0KCJzaWduT3V0TGluayIpKToobi5zdGF0ZS5zZXQoIm5hdmlnYXRlRGlyIixlLkRJUkVDVElPTl9CQUNLKSxuLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCIiKSl9KX0sImNsaWNrIC5qcy1za2lwIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5tb2RlbC5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnNraXAoKX0pfX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJue3Bhc3N3b3JkV2Fybjp0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc1B3ZEV4cGlyaW5nU29vbiIpfX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NSksaSgyOTYpLGkoMzY5KSxpKDE5MCldLHI9ZnVuY3Rpb24odCxlLGksbixyKXt2YXIgcz10Ll87cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6ImN1c3RvbS1wYXNzd29yZC1leHBpcmVkIixNb2RlbDp7fSxGb3JtOntub0J1dHRvbkJhcjohMCx0aXRsZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImlzUHdkRXhwaXJpbmdTb29uIiksaT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJwYXNzd29yZEV4cGlyZURheXMiKTtyZXR1cm4gZSYmaT4wP3QubG9jKCJwYXNzd29yZC5leHBpcmluZy50aXRsZSIsImxvZ2luIixbaV0pOmUmJjA9PT1pP3QubG9jKCJwYXNzd29yZC5leHBpcmluZy50b2RheSIsImxvZ2luIik6dC5sb2MoInBhc3N3b3JkLmV4cGlyZWQudGl0bGUiLCJsb2dpbiIpfSxzdWJ0aXRsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJpc1B3ZEV4cGlyaW5nU29vbiIpP3QubG9jKCJwYXNzd29yZC5leHBpcmluZy5zdWJ0aXRsZSIsImxvZ2luIikrIiAiK3QubG9jKCJwYXNzd29yZC5leHBpcmVkLmN1c3RvbS5zdWJ0aXRsZSIsImxvZ2luIik6dC5sb2MoInBhc3N3b3JkLmV4cGlyZWQuY3VzdG9tLnN1YnRpdGxlIiwibG9naW4iKX0sZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuW2kuQnV0dG9uKHt0aXRsZTpzLnBhcnRpYWwodC5sb2MsInBhc3N3b3JkLmV4cGlyZWQuY3VzdG9tLnN1Ym1pdCIsImxvZ2luIixbdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgicGFzc3dvcmRFeHBpcmVkV2Vic2l0ZU5hbWUiKV0pLGNsYXNzTmFtZToiYnV0dG9uIGJ1dHRvbi1wcmltYXJ5IGJ1dHRvbi13aWRlIixhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ImN1c3RvbS1idXR0b24ifSxjbGljazpmdW5jdGlvbigpe3IucmVkaXJlY3QodGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgicGFzc3dvcmRFeHBpcmVkTGlua1VybCIpKX19KV19fSxGb290ZXI6bn0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KSxpKDMwMSksaSgyOTYpLGkoMzY4KSxpKDM3MiksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe3ZhciBhPXQuXyxsPXQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIGhlbHAganMtYmFjayIgZGF0YS1zZT0iYmFjay1saW5rIj5cdCAgICAgICAge3tpMThuIGNvZGU9ImdvYmFjayIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICAge3sjaWYgaGVscFN1cHBvcnROdW1iZXJ9fVx0ICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9ImxpbmsgZ290byBqcy1jb250YWN0LXN1cHBvcnQiPlx0ICAgICAgICB7e2kxOG4gY29kZT0ibWZhLm5vQWNjZXNzVG9FbWFpbCIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICAge3svaWZ9fVx0ICAgICcsY2xhc3NOYW1lOiJhdXRoLWZvb3RlciIsZXZlbnRzOnsiY2xpY2sgLmpzLWJhY2siOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLmJhY2soKX0sImNsaWNrIC5qcy1jb250YWN0LXN1cHBvcnQiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLnN0YXRlLnRyaWdnZXIoImNvbnRhY3RTdXBwb3J0IiksdGhpcy4kKCIuanMtY29udGFjdC1zdXBwb3J0IikuaGlkZSgpfX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2V0dGluZ3MucGljaygiaGVscFN1cHBvcnROdW1iZXIiKX0sYmFjazpmdW5jdGlvbigpe3RoaXMuc3RhdGUuc2V0KCJuYXZpZ2F0ZURpciIsaS5ESVJFQ1RJT05fQkFDSyksdGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIiwiIil9fSk7cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6ImZvcmdvdC1wYXNzd29yZCIsTW9kZWw6e3Byb3BzOnt1c2VybmFtZTpbInN0cmluZyIsITBdLGZhY3RvclR5cGU6WyJzdHJpbmciLCEwLGkuUkVDT1ZFUllfRkFDVE9SX1RZUEVfRU1BSUxdfSx2YWxpZGF0ZTpmdW5jdGlvbigpe3JldHVybiByLnZhbGlkYXRlVXNlcm5hbWUodGhpcyl9LHNhdmU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzO3RoaXMuc3RhcnRUcmFuc2FjdGlvbihmdW5jdGlvbihlKXtyZXR1cm4gZS5mb3Jnb3RQYXNzd29yZCh7dXNlcm5hbWU6dC5zZXR0aW5ncy50cmFuc2Zvcm1Vc2VybmFtZSh0LmdldCgidXNlcm5hbWUiKSxpLkZPUkdPVF9QQVNTV09SRCksZmFjdG9yVHlwZTp0LmdldCgiZmFjdG9yVHlwZSIpfSl9KS5mYWlsKGZ1bmN0aW9uKCl7dC5zZXQoImZhY3RvclR5cGUiLGkuUkVDT1ZFUllfRkFDVE9SX1RZUEVfRU1BSUwpfSl9fSxGb3JtOnthdXRvU2F2ZTohMCxzYXZlOmEucGFydGlhbCh0LmxvYywicGFzc3dvcmQuZm9yZ290LnNlbmRFbWFpbCIsImxvZ2luIiksdGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJwYXNzd29yZC5yZXNldCIsImxvZ2luIiksZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7dmFyIGU9W24uSW5wdXQoe3BsYWNlaG9sZGVyOnQubG9jKCJwYXNzd29yZC5mb3Jnb3QuZW1haWwub3IudXNlcm5hbWUucGxhY2Vob2xkZXIiLCJsb2dpbiIpLG5hbWU6InVzZXJuYW1lIixpbnB1dDpvLHR5cGU6InRleHQiLHBhcmFtczp7aW5uZXJUb29sdGlwOnQubG9jKCJwYXNzd29yZC5mb3Jnb3QuZW1haWwub3IudXNlcm5hbWUudG9vbHRpcCIsImxvZ2luIiksaWNvbjoicGVyc29uLTE2LWdyYXkifX0pXSxpPXRoaXMuc2V0dGluZ3MuZ2V0KCJmZWF0dXJlcy5zbXNSZWNvdmVyeSIpLHI9dGhpcy5zZXR0aW5ncy5nZXQoImZlYXR1cmVzLmNhbGxSZWNvdmVyeSIpO3JldHVybihpfHxyKSYmZS5wdXNoKG4uVmlldyh7Vmlldzp0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICAgICAgICAgICAgPHAgY2xhc3M9Im1vYmlsZS1yZWNvdmVyeS1oaW50Ij5cdCAgICAgICAgICAgICAgICAgIHt7aTE4biBjb2RlPSJyZWNvdmVyeS5tb2JpbGUuaGludCIgYnVuZGxlPSJsb2dpbiIgYXJndW1lbnRzPSJtb2JpbGVGYWN0b3JzIn19XHQgICAgICAgICAgICAgICAgPC9wPicsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7dmFyIGU7cmV0dXJuIGU9aSYmcj90LmxvYygicmVjb3Zlcnkuc21zT3JDYWxsIik6cj90LmxvYygicmVjb3ZlcnkuY2FsbCIpOnQubG9jKCJyZWNvdmVyeS5zbXMiKSx7bW9iaWxlRmFjdG9yczplfX19KX0pKSxlfSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpczt0aGlzLnNldHRpbmdzLmdldCgiZmVhdHVyZXMuY2FsbFJlY292ZXJ5IikmJih0aGlzLiRlbC5hZGRDbGFzcygiZm9yZ290LXBhc3N3b3JkLWNhbGwtZW5hYmxlZCIpLHRoaXMuYWRkUmVjb3ZlcnlGYWN0b3JCdXR0b24oImNhbGwtYnV0dG9uIiwicGFzc3dvcmQuZm9yZ290LmNhbGwiLGkuUkVDT1ZFUllfRkFDVE9SX1RZUEVfQ0FMTCx0KSksdGhpcy5zZXR0aW5ncy5nZXQoImZlYXR1cmVzLnNtc1JlY292ZXJ5IikmJih0aGlzLiRlbC5hZGRDbGFzcygiZm9yZ290LXBhc3N3b3JkLXNtcy1lbmFibGVkIiksdGhpcy5hZGRSZWNvdmVyeUZhY3RvckJ1dHRvbigic21zLWJ1dHRvbiIsInBhc3N3b3JkLmZvcmdvdC5zZW5kVGV4dCIsaS5SRUNPVkVSWV9GQUNUT1JfVFlQRV9TTVMsdCkpLHRoaXMubGlzdGVuVG8odGhpcy5zdGF0ZSwiY29udGFjdFN1cHBvcnQiLGZ1bmN0aW9uKCl7dGhpcy5hZGQocywiLm8tZm9ybS1lcnJvci1jb250YWluZXIiKX0pLHRoaXMubGlzdGVuVG8odGhpcywic2F2ZSIsZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuYXBwU3RhdGUuc2V0KCJ1c2VybmFtZSIsdGhpcy5tb2RlbC5nZXQoInVzZXJuYW1lIikpfSl9LGFkZFJlY292ZXJ5RmFjdG9yQnV0dG9uOmZ1bmN0aW9uKGUsaSxuLHIpe3RoaXMuYWRkQnV0dG9uKHthdHRyaWJ1dGVzOnsiZGF0YS1zZSI6ZX0sdHlwZToiYnV0dG9uIixjbGFzc05hbWU6ImJ1dHRvbi1wcmltYXJ5ICIrZSx0ZXh0OnQubG9jKGksImxvZ2luIiksYWN0aW9uOmZ1bmN0aW9uKCl7ci5jbGVhckVycm9ycygpLHRoaXMubW9kZWwuaXNWYWxpZCgpJiYodGhpcy5tb2RlbC5zZXQoImZhY3RvclR5cGUiLG4pLHIudHJpZ2dlcigic2F2ZSIsdGhpcy5tb2RlbCkpfX0se3ByZXBlbmQ6ITB9KX19LEZvb3RlcjpsLGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuYXBwU3RhdGUudW5zZXQoInVzZXJuYW1lIil9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMildLHI9ZnVuY3Rpb24odCl7cmV0dXJuIHQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxkaXYgY2xhc3M9ImluZm9ib3giPlx0ICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbiBpbmZvLTE2Ij48L3NwYW4+XHQgICAgICAgIDxwPnt7aTE4biBjb2RlPSJjb250YWN0LnN1cHBvcnQiIGJ1bmRsZT0ibG9naW4iIGFyZ3VtZW50cz0iaGVscFN1cHBvcnROdW1iZXIifX08L3A+XHQgICAgICA8L2Rpdj4nLGNsYXNzTmFtZToiY29udGFjdC1zdXBwb3J0IixnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZXR0aW5ncy5waWNrKCJoZWxwU3VwcG9ydE51bWJlciIpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KSxpKDI5NiksaSgzMDEpLGkoMzIwKSxpKDMwNildLHI9ZnVuY3Rpb24odCxlLGksbixyLHMpe3ZhciBvPXQuXyxhPTNlNDtyZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZToicmVjb3ZlcnktY2hhbGxlbmdlIixNb2RlbDp7cHJvcHM6e3Bhc3NDb2RlOlsic3RyaW5nIiwhMF19LGxvY2FsOnthYmxlVG9SZXNlbmQ6ImJvb2xlYW4ifSxyZXNlbmRDb2RlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGltaXRSZXNlbmRpbmcoKSx0aGlzLmRvVHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7cmV0dXJuIHQucmVzZW5kKCl9KX0sbGltaXRSZXNlbmRpbmc6ZnVuY3Rpb24oKXt0aGlzLnNldCh7YWJsZVRvUmVzZW5kOiExfSksby5kZWxheShvLmJpbmQodGhpcy5zZXQsdGhpcyksYSx7YWJsZVRvUmVzZW5kOiEwfSl9LHNhdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKHQpe3JldHVybiB0LnZlcmlmeSh7cGFzc0NvZGU6dGhpcy5nZXQoInBhc3NDb2RlIil9KX0pfX0sRm9ybTp7YXV0b1NhdmU6ITAsc2F2ZTpvLnBhcnRpYWwodC5sb2MsIm1mYS5jaGFsbGVuZ2UudmVyaWZ5IiwibG9naW4iKSx0aXRsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJmYWN0b3JUeXBlIik9PT1uLlJFQ09WRVJZX0ZBQ1RPUl9UWVBFX0NBTEw/dC5sb2MoInJlY292ZXJ5Q2hhbGxlbmdlLmNhbGwudGl0bGUiLCJsb2dpbiIpOnQubG9jKCJyZWNvdmVyeUNoYWxsZW5nZS5zbXMudGl0bGUiLCJsb2dpbiIpfSxjbGFzc05hbWU6InJlY292ZXJ5LWNoYWxsZW5nZSIsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiZXJyb3IiLGZ1bmN0aW9uKCl7dGhpcy5jbGVhckVycm9ycygpfSl9LGZvcm1DaGlsZHJlbjpmdW5jdGlvbigpe3JldHVybltpLkJ1dHRvbih7dGl0bGU6dC5sb2MoIm1mYS5yZXNlbmRDb2RlIiwibG9naW4iKSxhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6InJlc2VuZC1idXR0b24ifSxjbGFzc05hbWU6ImJ1dHRvbiBzbXMtcmVxdWVzdC1idXR0b24iLGNsaWNrOmZ1bmN0aW9uKCl7dGhpcy5tb2RlbC5yZXNlbmRDb2RlKCl9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsImNoYW5nZTphYmxlVG9SZXNlbmQiLGZ1bmN0aW9uKGUsaSl7aT8odGhpcy5vcHRpb25zLnRpdGxlPXQubG9jKCJtZmEucmVzZW5kQ29kZSIsImxvZ2luIiksdGhpcy5lbmFibGUoKSx0aGlzLnJlbmRlcigpKToodGhpcy5vcHRpb25zLnRpdGxlPXQubG9jKCJtZmEuc2VudCIsImxvZ2luIiksdGhpcy5kaXNhYmxlKCksdGhpcy5yZW5kZXIoKSl9KX19KSxpLklucHV0KHtwbGFjZWhvbGRlcjp0LmxvYygibWZhLmNoYWxsZW5nZS5lbnRlckNvZGUucGxhY2Vob2xkZXIiLCJsb2dpbiIpLGNsYXNzTmFtZToiZW5yb2xsLXNtcy1waG9uZSIsbmFtZToicGFzc0NvZGUiLGlucHV0OnMsdHlwZToidGV4dCJ9KV19fSxldmVudHM6eyJjbGljayAuc2VuZC1lbWFpbC1saW5rIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCk7dmFyIGU9dGhpcy5tb2RlbC5zZXR0aW5ncyxpPXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInVzZXJuYW1lIikscj10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJyZWNvdmVyeVR5cGUiKTt0aGlzLm1vZGVsLnN0YXJ0VHJhbnNhY3Rpb24oZnVuY3Rpb24odCl7c3dpdGNoKHIpe2Nhc2Ugbi5SRUNPVkVSWV9UWVBFX1BBU1NXT1JEOnJldHVybiB0LmZvcmdvdFBhc3N3b3JkKHt1c2VybmFtZTplLnRyYW5zZm9ybVVzZXJuYW1lKGksbi5GT1JHT1RfUEFTU1dPUkQpLGZhY3RvclR5cGU6bi5SRUNPVkVSWV9GQUNUT1JfVFlQRV9FTUFJTH0pO2Nhc2Ugbi5SRUNPVkVSWV9UWVBFX1VOTE9DSzpyZXR1cm4gdC51bmxvY2tBY2NvdW50KHt1c2VybmFtZTplLnRyYW5zZm9ybVVzZXJuYW1lKGksbi5VTkxPQ0tfQUNDT1VOVCksZmFjdG9yVHlwZTpuLlJFQ09WRVJZX0ZBQ1RPUl9UWVBFX0VNQUlMfSk7ZGVmYXVsdDpyZXR1cm59fSl9fSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dmFyIGUsaT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJyZWNvdmVyeVR5cGUiKTtzd2l0Y2goaSl7Y2FzZSBuLlJFQ09WRVJZX1RZUEVfUEFTU1dPUkQ6ZT0nXHQgICAgICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9Imxpbmsgc2VuZC1lbWFpbC1saW5rIiBkYXRhLXNlPSJzZW5kLWVtYWlsLWxpbmsiPlx0ICAgICAgICAgICAge3tpMThuIGNvZGU9InBhc3N3b3JkLmZvcmdvdC5jb2RlLm5vdFJlY2VpdmVkIiBidW5kbGU9ImxvZ2luIn19XHQgICAgICAgICAgPC9hPic7YnJlYWs7Y2FzZSBuLlJFQ09WRVJZX1RZUEVfVU5MT0NLOmU9J1x0ICAgICAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIHNlbmQtZW1haWwtbGluayIgZGF0YS1zZT0ic2VuZC1lbWFpbC1saW5rIj5cdCAgICAgICAgICAgIHt7aTE4biBjb2RlPSJhY2NvdW50LnVubG9jay5zbXMubm90UmVjZWl2ZWQiIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgICAgICA8L2E+J31lJiZ0aGlzLmFkZChlKSwKCXRoaXMuYWRkKG5ldyByKG8uZXh0ZW5kKHRoaXMudG9KU09OKCkse2xpbmtUZXh0OnQubG9jKCJnb2JhY2siLCJsb2dpbiIpLGxpbmtDbGFzc05hbWU6IiJ9KSkpfSxwb3N0UmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5tb2RlbC5saW1pdFJlc2VuZGluZygpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzAxKSxpKDI5NSksaSgyOTYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPXQuXztyZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToicGFzc3dvcmQtcmVzZXQtZW1haWwtc2VudCIsTW9kZWw6ZnVuY3Rpb24oKXtyZXR1cm57bG9jYWw6e3VzZXJGdWxsTmFtZTpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlckZ1bGxOYW1lIildfX19LEZvcm06e3RpdGxlOnIucGFydGlhbCh0LmxvYywicGFzc3dvcmQuZm9yZ290LmVtYWlsU2VudC50aXRsZSIsImxvZ2luIiksc3VidGl0bGU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJ1c2VybmFtZSIpO3JldHVybiB0LmxvYygicGFzc3dvcmQuZm9yZ290LmVtYWlsU2VudC5kZXNjIiwibG9naW4iLFtlXSl9LG5vQnV0dG9uQmFyOiEwLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoicHdkLXJlc2V0LWVtYWlsLXNlbnQifSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXtyZXR1cm5bbi5WaWV3KHtWaWV3OnQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9ImFjY2Vzc2liaWxpdHktdGV4dCIgcm9sZT0ic3RhdHVzIj57e2FsZXJ0fX08L3NwYW4+XHQgICAgICAgICAgICAgICcsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJue2FsZXJ0OnQubG9jKCJwYXNzd29yZC5mb3Jnb3QuZW1haWxTZW50LnRpdGxlIiwibG9naW4iKX19fSl9KSxuLkJ1dHRvbih7dGl0bGU6dC5sb2MoImdvYmFjayIsImxvZ2luIiksY2xhc3NOYW1lOiJidXR0b24gYnV0dG9uLXByaW1hcnkgYnV0dG9uLXdpZGUiLGF0dHJpYnV0ZXM6eyJkYXRhLXNlIjoiYmFjay1idXR0b24ifSxjbGljazpmdW5jdGlvbigpe3ZhciB0PXRoaXM7cmV0dXJuIHRoaXMubW9kZWwuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdC5jYW5jZWwoKX0pLnRoZW4oZnVuY3Rpb24oKXt0LnN0YXRlLnNldCgibmF2aWdhdGVEaXIiLGUuRElSRUNUSU9OX0JBQ0spLHQub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsIiIpfSl9fSldfX0saW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0aGlzLnNldHRpbmdzLmNhbGxHbG9iYWxTdWNjZXNzKGUuRk9SR09UX1BBU1NXT1JEX0VNQUlMX1NFTlQse3VzZXJuYW1lOnQuYXBwU3RhdGUuZ2V0KCJ1c2VybmFtZSIpfSl9fSl9LmFwcGx5KGUsbiksISh2b2lkIDAhPT1yJiYodC5leHBvcnRzPXIpKX0sZnVuY3Rpb24odCxlLGkpe3ZhciBuLHI7bj1baSgzMiksaSgyOTUpLGkoMjk2KSxpKDMyMCksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6InJlY292ZXJ5LXF1ZXN0aW9uIixNb2RlbDp7cHJvcHM6e2Fuc3dlcjpbInN0cmluZyIsITBdLHNob3dBbnN3ZXI6ImJvb2xlYW4ifSxzYXZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9UcmFuc2FjdGlvbihmdW5jdGlvbih0KXtyZXR1cm4gdC5hbnN3ZXIoe2Fuc3dlcjp0aGlzLmdldCgiYW5zd2VyIil9KX0pfX0sRm9ybTp7YXV0b1NhdmU6ITAsc2F2ZTpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJyZWNvdmVyeVR5cGUiKSl7Y2FzZSJQQVNTV09SRCI6cmV0dXJuIHQubG9jKCJwYXNzd29yZC5mb3Jnb3QucXVlc3Rpb24uc3VibWl0IiwibG9naW4iKTtjYXNlIlVOTE9DSyI6cmV0dXJuIHQubG9jKCJhY2NvdW50LnVubG9jay5xdWVzdGlvbi5zdWJtaXQiLCJsb2dpbiIpO2RlZmF1bHQ6cmV0dXJuIHQubG9jKCJtZmEuY2hhbGxlbmdlLnZlcmlmeSIsImxvZ2luIil9fSx0aXRsZTpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJyZWNvdmVyeVR5cGUiKSl7Y2FzZSJQQVNTV09SRCI6cmV0dXJuIHQubG9jKCJwYXNzd29yZC5mb3Jnb3QucXVlc3Rpb24udGl0bGUiLCJsb2dpbiIpO2Nhc2UiVU5MT0NLIjpyZXR1cm4gdC5sb2MoImFjY291bnQudW5sb2NrLnF1ZXN0aW9uLnRpdGxlIiwibG9naW4iKTtkZWZhdWx0OnJldHVybiIifX0sZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuW2kuSW5wdXQoe2xhYmVsOnRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInJlY292ZXJ5UXVlc3Rpb24iKSxwbGFjZWhvbGRlcjp0LmxvYygibWZhLmNoYWxsZW5nZS5hbnN3ZXIucGxhY2Vob2xkZXIiLCJsb2dpbiIpLG5hbWU6ImFuc3dlciIsaW5wdXQ6cix0eXBlOiJwYXNzd29yZCIsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwiY2hhbmdlOnNob3dBbnN3ZXIiLGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5tb2RlbC5nZXQoInNob3dBbnN3ZXIiKT8idGV4dCI6InBhc3N3b3JkIjt0aGlzLmdldElucHV0cygpWzBdLmNoYW5nZVR5cGUodCl9KX19KSxpLklucHV0KHtsYWJlbDohMSwibGFiZWwtdG9wIjohMCxwbGFjZWhvbGRlcjp0LmxvYygibWZhLmNoYWxsZW5nZS5hbnN3ZXIuc2hvd0Fuc3dlciIsImxvZ2luIiksY2xhc3NOYW1lOiJyZWNvdmVyeS1xdWVzdGlvbi1zaG93IG1hcmdpbi1idG0tMCIsbmFtZToic2hvd0Fuc3dlciIsdHlwZToiY2hlY2tib3gifSldfX0sRm9vdGVyOm59KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NSksaSgyOTYpLGkoMzY4KSxpKDI5NCksaSgzMjApLGkoMzA2KV0scj1mdW5jdGlvbih0LGUsaSxuLHIscyxvKXt2YXIgYT10Ll87cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6InBhc3N3b3JkLXJlc2V0IixNb2RlbDp7cHJvcHM6e25ld1Bhc3N3b3JkOlsic3RyaW5nIiwhMF0sY29uZmlybVBhc3N3b3JkOlsic3RyaW5nIiwhMF19LHZhbGlkYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIG4udmFsaWRhdGVQYXNzd29yZE1hdGNoKHRoaXMpfSxzYXZlOmZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyKCJzYXZlIik7dmFyIHQ9dGhpcztyZXR1cm4gdGhpcy5kb1RyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpe3JldHVybiBlLnJlc2V0UGFzc3dvcmQoe25ld1Bhc3N3b3JkOnQuZ2V0KCJuZXdQYXNzd29yZCIpfSl9KX19LEZvcm06e3NhdmU6YS5wYXJ0aWFsKHQubG9jLCJwYXNzd29yZC5yZXNldCIsImxvZ2luIiksdGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJwYXNzd29yZC5yZXNldC50aXRsZSIsImxvZ2luIiksc3VidGl0bGU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMuYXBwU3RhdGUuZ2V0KCJwb2xpY3kiKTtpZih0KXJldHVybiByLmdldFBhc3N3b3JkQ29tcGxleGl0eURlc2NyaXB0aW9uKHQpfSxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXtyZXR1cm5baS5JbnB1dCh7cGxhY2Vob2xkZXI6dC5sb2MoInBhc3N3b3JkLm5ld1Bhc3N3b3JkLnBsYWNlaG9sZGVyIiwibG9naW4iKSxuYW1lOiJuZXdQYXNzd29yZCIsaW5wdXQ6byx0eXBlOiJwYXNzd29yZCIscGFyYW1zOntpbm5lclRvb2x0aXA6dC5sb2MoInBhc3N3b3JkLm5ld1Bhc3N3b3JkLnRvb2x0aXAiLCJsb2dpbiIpLGljb246ImNyZWRlbnRpYWxzLTE2In19KSxpLklucHV0KHtwbGFjZWhvbGRlcjp0LmxvYygicGFzc3dvcmQuY29uZmlybVBhc3N3b3JkLnBsYWNlaG9sZGVyIiwibG9naW4iKSxuYW1lOiJjb25maXJtUGFzc3dvcmQiLGlucHV0Om8sdHlwZToicGFzc3dvcmQiLHBhcmFtczp7aW5uZXJUb29sdGlwOnQubG9jKCJwYXNzd29yZC5jb25maXJtUGFzc3dvcmQudG9vbHRpcCIsImxvZ2luIiksaWNvbjoiY3JlZGVudGlhbHMtMTYifX0pXX19LEZvb3RlcjpzLGluaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLmxpc3RlblRvKHRoaXMuZm9ybSwic2F2ZSIsZnVuY3Rpb24oKXt2YXIgdD17dXNlcm5hbWU6dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlckVtYWlsIikscGFzc3dvcmQ6dGhpcy5tb2RlbC5nZXQoIm5ld1Bhc3N3b3JkIil9O3RoaXMuc2V0dGluZ3MucHJvY2Vzc0NyZWRzKHQpLnRoZW4oYS5iaW5kKHRoaXMubW9kZWwuc2F2ZSx0aGlzLm1vZGVsKSl9KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI5NSldLHI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5leHRlbmQoe2NsYXNzTmFtZToicmVjb3ZlcnktbG9hZGluZyIsTW9kZWw6e30sRm9ybTp7bm9CdXR0b25CYXI6ITB9LGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcztyZXR1cm4gdGhpcy5tb2RlbC5zdGFydFRyYW5zYWN0aW9uKGZ1bmN0aW9uKGUpe3JldHVybiBlLnZlcmlmeVJlY292ZXJ5VG9rZW4oe3JlY292ZXJ5VG9rZW46dC50b2tlbn0pfSkuZmFpbChmdW5jdGlvbigpe2Uub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJsb2FkaW5nIiwhMSl9KX0scHJlUmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoImxvYWRpbmciLCEwKX0sdHJhcEF1dGhSZXNwb25zZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibG9hZGluZyIsITEpLCExfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk1KSxpKDMwMSksaSgyOTYpLGkoMzY4KSxpKDM3MiksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe3ZhciBhPXQuXyxsPXQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIGhlbHAganMtYmFjayIgZGF0YS1zZT0iYmFjay1saW5rIj5cdCAgICAgICAge3tpMThuIGNvZGU9ImdvYmFjayIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICAge3sjaWYgaGVscFN1cHBvcnROdW1iZXJ9fVx0ICAgICAgPGEgaHJlZj0iIyIgY2xhc3M9ImxpbmsgZ290byBqcy1jb250YWN0LXN1cHBvcnQiPlx0ICAgICAgICB7e2kxOG4gY29kZT0ibWZhLm5vQWNjZXNzVG9FbWFpbCIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgPC9hPlx0ICAgICAge3svaWZ9fVx0ICAgICcsY2xhc3NOYW1lOiJhdXRoLWZvb3RlciIsZXZlbnRzOnsiY2xpY2sgLmpzLWJhY2siOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLmJhY2soKX0sImNsaWNrIC5qcy1jb250YWN0LXN1cHBvcnQiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLnN0YXRlLnRyaWdnZXIoImNvbnRhY3RTdXBwb3J0IiksdGhpcy4kKCIuanMtY29udGFjdC1zdXBwb3J0IikuaGlkZSgpfX0sZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2V0dGluZ3MucGljaygiaGVscFN1cHBvcnROdW1iZXIiKX0sYmFjazpmdW5jdGlvbigpe3RoaXMuc3RhdGUuc2V0KCJuYXZpZ2F0ZURpciIsaS5ESVJFQ1RJT05fQkFDSyksdGhpcy5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIiwiIil9fSk7cmV0dXJuIGUuZXh0ZW5kKHtjbGFzc05hbWU6ImFjY291bnQtdW5sb2NrIixNb2RlbDp7cHJvcHM6e3VzZXJuYW1lOlsic3RyaW5nIiwhMF0sZmFjdG9yVHlwZTpbInN0cmluZyIsITAsaS5SRUNPVkVSWV9GQUNUT1JfVFlQRV9FTUFJTF19LHZhbGlkYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHIudmFsaWRhdGVVc2VybmFtZSh0aGlzKX0sc2F2ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXM7cmV0dXJuIHRoaXMuc3RhcnRUcmFuc2FjdGlvbihmdW5jdGlvbihlKXtyZXR1cm4gZS51bmxvY2tBY2NvdW50KHt1c2VybmFtZTp0LnNldHRpbmdzLnRyYW5zZm9ybVVzZXJuYW1lKHQuZ2V0KCJ1c2VybmFtZSIpLGkuVU5MT0NLX0FDQ09VTlQpLGZhY3RvclR5cGU6dC5nZXQoImZhY3RvclR5cGUiKX0pfSkuZmFpbChmdW5jdGlvbigpe3Quc2V0KCJmYWN0b3JUeXBlIixpLlJFQ09WRVJZX0ZBQ1RPUl9UWVBFX0VNQUlMKX0pfX0sRm9ybTp7YXV0b1NhdmU6ITAsc2F2ZTphLnBhcnRpYWwodC5sb2MsImFjY291bnQudW5sb2NrLnNlbmRFbWFpbCIsImxvZ2luIiksdGl0bGU6YS5wYXJ0aWFsKHQubG9jLCJhY2NvdW50LnVubG9jay50aXRsZSIsImxvZ2luIiksZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7dmFyIGU9W24uSW5wdXQoe3BsYWNlaG9sZGVyOnQubG9jKCJhY2NvdW50LnVubG9jay5lbWFpbC5vci51c2VybmFtZS5wbGFjZWhvbGRlciIsImxvZ2luIiksbmFtZToidXNlcm5hbWUiLGlucHV0Om8sdHlwZToidGV4dCIscGFyYW1zOntpbm5lclRvb2x0aXA6dC5sb2MoImFjY291bnQudW5sb2NrLmVtYWlsLm9yLnVzZXJuYW1lLnRvb2x0aXAiLCJsb2dpbiIpLGljb246InBlcnNvbi0xNi1ncmF5In19KV07cmV0dXJuIHRoaXMuc2V0dGluZ3MuZ2V0KCJmZWF0dXJlcy5zbXNSZWNvdmVyeSIpJiZlLnB1c2gobi5WaWV3KHtWaWV3OidcdCAgICAgICAgICAgIDxwIGNsYXNzPSJzbXMtaGludCI+XHQgICAgICAgICAgICAgIHt7aTE4biBjb2RlPSJyZWNvdmVyeS5zbXMuaGludCIgYnVuZGxlPSJsb2dpbiJ9fVx0ICAgICAgICAgICAgPC9wPlx0ICAgICAgICAgICd9KSksZX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5saXN0ZW5Ubyh0aGlzLCJzYXZlIixmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5hcHBTdGF0ZS5zZXQoInVzZXJuYW1lIix0aGlzLm1vZGVsLmdldCgidXNlcm5hbWUiKSl9KSx0aGlzLnNldHRpbmdzLmdldCgiZmVhdHVyZXMuc21zUmVjb3ZlcnkiKSYmKHRoaXMuJGVsLmFkZENsYXNzKCJmb3Jnb3QtcGFzc3dvcmQtc21zLWVuYWJsZWQiKSx0aGlzLmFkZEJ1dHRvbih7YXR0cmlidXRlczp7ImRhdGEtc2UiOiJzbXMtYnV0dG9uIn0sdHlwZToiYnV0dG9uIixjbGFzc05hbWU6ImJ1dHRvbi1wcmltYXJ5IHNtcy1idXR0b24iLHRleHQ6dC5sb2MoImFjY291bnQudW5sb2NrLnNlbmRUZXh0IiwibG9naW4iKSxhY3Rpb246ZnVuY3Rpb24oKXtlLmNsZWFyRXJyb3JzKCksdGhpcy5tb2RlbC5pc1ZhbGlkKCkmJih0aGlzLm1vZGVsLnNldCgiZmFjdG9yVHlwZSIsaS5SRUNPVkVSWV9GQUNUT1JfVFlQRV9TTVMpLGUudHJpZ2dlcigic2F2ZSIsdGhpcy5tb2RlbCkpfX0se3ByZXBlbmQ6ITB9KSksdGhpcy5saXN0ZW5Ubyh0aGlzLnN0YXRlLCJjb250YWN0U3VwcG9ydCIsZnVuY3Rpb24oKXt0aGlzLmFkZChzLCIuby1mb3JtLWVycm9yLWNvbnRhaW5lciIpfSl9fSxGb290ZXI6bH0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzAxKSxpKDI5NSksaSgyOTYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPXQuXztyZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToiYWNjb3VudC11bmxvY2tlZCIsTW9kZWw6ZnVuY3Rpb24oKXtyZXR1cm57bG9jYWw6e3VzZXJGdWxsTmFtZTpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlckZ1bGxOYW1lIildfX19LEZvcm06e3RpdGxlOnIucGFydGlhbCh0LmxvYywiYWNjb3VudC51bmxvY2sudW5sb2NrZWQudGl0bGUiLCJsb2dpbiIpLHN1YnRpdGxlOnIucGFydGlhbCh0LmxvYywiYWNjb3VudC51bmxvY2sudW5sb2NrZWQuZGVzYyIsImxvZ2luIiksbm9CdXR0b25CYXI6ITAsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJhY2NvdW50LXVubG9ja2VkIn0sZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuW24uQnV0dG9uKHt0aXRsZTp0LmxvYygiZ29iYWNrIiwibG9naW4iKSxjbGFzc05hbWU6ImJ1dHRvbiBidXR0b24tcHJpbWFyeSBidXR0b24td2lkZSIsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJiYWNrLWJ1dHRvbiJ9LGNsaWNrOmZ1bmN0aW9uKCl7dGhpcy5zdGF0ZS5zZXQoIm5hdmlnYXRlRGlyIixlLkRJUkVDVElPTl9CQUNLKSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCIiKX19KV19fX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzAxKSxpKDI5NSksaSgyOTYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPXQuXztyZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToiYWNjb3VudC11bmxvY2stZW1haWwtc2VudCIsTW9kZWw6ZnVuY3Rpb24oKXtyZXR1cm57bG9jYWw6e3VzZXJGdWxsTmFtZTpbInN0cmluZyIsITEsdGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlckZ1bGxOYW1lIildfX19LEZvcm06e3RpdGxlOnIucGFydGlhbCh0LmxvYywiYWNjb3VudC51bmxvY2suZW1haWxTZW50LnRpdGxlIiwibG9naW4iKSxzdWJ0aXRsZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoInVzZXJuYW1lIik7cmV0dXJuIHQubG9jKCJhY2NvdW50LnVubG9jay5lbWFpbFNlbnQuZGVzYyIsImxvZ2luIixbZV0pfSxub0J1dHRvbkJhcjohMCxhdHRyaWJ1dGVzOnsiZGF0YS1zZSI6InVubG9jay1lbWFpbC1zZW50In0sZm9ybUNoaWxkcmVuOmZ1bmN0aW9uKCl7cmV0dXJuW24uQnV0dG9uKHt0aXRsZTp0LmxvYygiZ29iYWNrIiwibG9naW4iKSxjbGFzc05hbWU6ImJ1dHRvbiBidXR0b24tcHJpbWFyeSBidXR0b24td2lkZSIsYXR0cmlidXRlczp7ImRhdGEtc2UiOiJiYWNrLWJ1dHRvbiJ9LGNsaWNrOmZ1bmN0aW9uKCl7dGhpcy5zdGF0ZS5zZXQoIm5hdmlnYXRlRGlyIixlLkRJUkVDVElPTl9CQUNLKSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCIiKX19KV19fSxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuc2V0dGluZ3MuY2FsbEdsb2JhbFN1Y2Nlc3MoZS5VTkxPQ0tfQUNDT1VOVF9FTUFJTF9TRU5ULHt1c2VybmFtZTp0LmFwcFN0YXRlLmdldCgidXNlcm5hbWUiKX0pfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMzgyKSxpKDI5NyksaSgzMDEpLGkoMzgzKSxpKDM4NiksaSgzODcpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe3ZhciBhPXQuXyxsPXQuVmlldy5leHRlbmQoe3RlbXBsYXRlOidcdCAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJsaW5rIGhlbHAiIGRhdGEtc2U9ImJhY2stbGluayI+XHQgICAgICAgIHt7aTE4biBjb2RlPSJnb2JhY2siIGJ1bmRsZT0ibG9naW4ifX1cdCAgICAgIDwvYT5cdCAgICAnLGNsYXNzTmFtZToiYXV0aC1mb290ZXIiLGV2ZW50czp7ImNsaWNrIC5oZWxwIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5iYWNrKCl9fSxiYWNrOmZ1bmN0aW9uKCl7dGhpcy5zdGF0ZS5zZXQoIm5hdmlnYXRlRGlyIixuLkRJUkVDVElPTl9CQUNLKSx0aGlzLm9wdGlvbnMuYXBwU3RhdGUudHJpZ2dlcigibmF2aWdhdGUiLCIiKX19KSxjPXQuRm9ybS5leHRlbmQoe2xheW91dDoiby1mb3JtLXRoZW1lIixhdXRvU2F2ZTohMCxub0NhbmNlbEJ1dHRvbjohMCx0aXRsZTp0LmxvYygicmVnaXN0cmF0aW9uLmZvcm0udGl0bGUiLCJsb2dpbiIpLHNhdmU6dC5sb2MoInJlZ2lzdHJhdGlvbi5mb3JtLnN1Ym1pdCIsImxvZ2luIil9KTtyZXR1cm4gaS5leHRlbmQoe2NsYXNzTmFtZToicmVnaXN0cmF0aW9uIixpbml0aWFsaXplOmZ1bmN0aW9uKCl7dmFyIGk9ZS5leHRlbmQoe3VybDoiYXBpL3YxL3NjaGVtYSJ9KSxuPW5ldyBpKHtzY2hlbWE6e3Byb3BlcnRpZXM6e2ZpcnN0TmFtZTp7dHlwZToic3RyaW5nIixkZXNjcmlwdGlvbjoiRmlyc3QgTmFtZSIsImRlZmF1bHQiOiJFbnRlciB5b3VyIGZpcnN0IG5hbWUiLG1heExlbmd0aDoyNTV9LGxhc3ROYW1lOnt0eXBlOiJzdHJpbmciLGRlc2NyaXB0aW9uOiJMYXN0IE5hbWUiLCJkZWZhdWx0IjoiRW50ZXIgeW91ciBsYXN0IG5hbWUiLG1heExlbmd0aDoyNTV9LGxvZ2luOnt0eXBlOiJzdHJpbmciLGRlc2NyaXB0aW9uOiJFbWFpbCBBZGRyZXNzIixmb3JtYXQ6ImVtYWlsIiwiZGVmYXVsdCI6IkVudGVyIHlvdXIgZW1haWwiLG1heExlbmd0aDoyNTV9LGFjY291bnRMZXZlbDp7dHlwZToic3RyaW5nIixkZXNjcmlwdGlvbjoiQWNjb3VudCBMZXZlbCIsImVudW0iOlsiRnJlZSIsIlByZW1pdW0iLCJQbGF0aW51bSJdfSxyZWZlcnJlcjp7dHlwZToic3RyaW5nIixkZXNjcmlwdGlvbjoiSG93IGRpZCB5b3UgaGVhciBhYm91dCB1cz8iLG1heExlbmd0aDoxMDI0fSxwYXNzd29yZDp7dHlwZToic3RyaW5nIixkZXNjcmlwdGlvbjoiUGFzc3dvcmQifX0scmVxdWlyZWQ6WyJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsImxvZ2luIiwicGFzc3dvcmQiLCJhY2NvdW50TGV2ZWwiXSxmaWVsZE9yZGVyOlsibG9naW4iLCJwYXNzd29yZCIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwiYWNjb3VudExldmVsIiwicmVmZXJyZXIiXX0scGFzc3dvcmRDb21wbGV4aXR5OnttaW5MZW5ndGg6OCxtaW5Mb3dlckNhc2U6MSxtaW5VcHBlckNhc2U6MSxtaW5OdW1iZXI6MSxtaW5TeW1ib2w6MCxleGNsdWRlVXNlcm5hbWU6ITB9fSx7cGFyc2U6ITB9KSxsPW4ucHJvcGVydGllcyx1PWwuY3JlYXRlTW9kZWxQcm9wZXJ0aWVzKCksZD10Lk1vZGVsLmV4dGVuZCh7c2V0dGluZ3M6dGhpcy5zZXR0aW5ncyxhcHBTdGF0ZTp0aGlzLm9wdGlvbnMuYXBwU3RhdGUscHJvcHM6dSxzYXZlOmZ1bmN0aW9uKCl7dGhpcy5hcHBTdGF0ZS5zZXQoInVzZXJuYW1lIix0aGlzLmdldCgiZW1haWwiKSksdGhpcy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsInNpZ25pbi9yZWdpc3Rlci1jb21wbGV0ZSIpfX0pO3RoaXMubW9kZWw9bmV3IGQ7dmFyIGg9ZnVuY3Rpb24oZSxpKXt2YXIgcz1lLmdldCgicGFzc3dvcmQiKXx8IiI7YS5lYWNoKG4ucGFzc3dvcmRDb21wbGV4aXR5LmVuYWJsZWRDb21wbGV4aXRpZXMsZnVuY3Rpb24obil7dmFyIG89dC4kKCIjcGFzc3dvcmQtY29tcGxleGl0eS0iK24pLGE9dGhpcy5nZXQobik7by5yZW1vdmVDbGFzcygicGFzc3dvcmQtY29tcGxleGl0eS1zYXRpc2ZpZWQgcGFzc3dvcmQtY29tcGxleGl0eS11bnNhdGlzZmllZCBwYXNzd29yZC1jb21wbGV4aXR5LWVycm9yIiksci5jb21wbGV4aXRpZXNbbl0uZG9lc0NvbXBsZXhpdHlNZWV0KGEscyxlKT9vLmFkZENsYXNzKCJwYXNzd29yZC1jb21wbGV4aXR5LXNhdGlzZmllZCIpOmk/by5hZGRDbGFzcygicGFzc3dvcmQtY29tcGxleGl0eS1lcnJvciIpOm8uYWRkQ2xhc3MoInBhc3N3b3JkLWNvbXBsZXhpdHktdW5zYXRpc2ZpZWQiKX0sbi5wYXNzd29yZENvbXBsZXhpdHkpfSxwPW5ldyBjKHRoaXMudG9KU09OKCkpO2wuZWFjaChmdW5jdGlvbih0KXt2YXIgZT1zLmNyZWF0ZUlucHV0T3B0aW9ucyh0KSxpPXQuZ2V0KCJuYW1lIik7InBhc3N3b3JkIiE9PWkmJiJsb2dpbiIhPT1pfHwoZS5ldmVudHM9e2lucHV0OmZ1bmN0aW9uKCl7aCh0aGlzLm1vZGVsKX19KSwicGFzc3dvcmQiPT09aSYmKGUuZXZlbnRzLmZvY3Vzb3V0PWZ1bmN0aW9uKCl7aCh0aGlzLm1vZGVsLCEwKX0pLHAuYWRkSW5wdXQoZSl9KSxwLmFkZChvLmV4dGVuZCh7cGFzc3dvcmRDb21wbGV4aXR5Om4ucGFzc3dvcmRDb21wbGV4aXR5fSkpLHRoaXMuYWRkKHApLHRoaXMuZm9vdGVyPW5ldyB0aGlzLkZvb3Rlcih0aGlzLnRvSlNPTigpKSx0aGlzLmFkZCh0aGlzLmZvb3RlciksdGhpcy5hZGRMaXN0ZW5lcnMoKX0sRm9vdGVyOmx9KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDM4MyksaSgzODQpLGkoMzg1KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj10Ll8scz10Lk1vZGVsLmV4dGVuZCh7cHJvcHM6ZS5tb2RlbFByb3BzLHBhcnNlOmZ1bmN0aW9uKGkpe3ZhciBuPXQuTW9kZWwucHJvdG90eXBlLnBhcnNlLmFwcGx5KHRoaXMsW2ldKTtyZXR1cm4gdGhpcy5lbmFibGVkQ29tcGxleGl0aWVzPVtdLHIubWFwKG4sZnVuY3Rpb24odCxpKXtlLmNvbXBsZXhpdGllc1tpXS5pc0VuYWJsZWQodCkmJnRoaXMuZW5hYmxlZENvbXBsZXhpdGllcy5wdXNoKGkpfSx0aGlzKSxufX0pLG89bi5Db2xsZWN0aW9uLmV4dGVuZCh7Y3JlYXRlTW9kZWxQcm9wZXJ0aWVzOmZ1bmN0aW9uKCl7dmFyIHQ9bi5Db2xsZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVNb2RlbFByb3BlcnRpZXMuYXBwbHkodGhpcyk7cmV0dXJuIHIuZWFjaCh0LGZ1bmN0aW9uKHQsZSl7dC5yZXF1aXJlZD0hIXRoaXMuZ2V0KGUpLmdldCgicmVxdWlyZWQiKX0sdGhpcyksdH19KTtyZXR1cm4gaS5Nb2RlbC5leHRlbmQoe2V4cGFuZDpbInNjaGVtYSJdLGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dGhpcy5wcm9wZXJ0aWVzPW5ldyBvLHQuQmFzZU1vZGVsLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0scGFyc2U6ZnVuY3Rpb24odCl7dmFyIGU9aS5Nb2RlbC5wcm90b3R5cGUucGFyc2UuYXBwbHkodGhpcyxbdF0pLG49dC5zY2hlbWEucmVxdWlyZWQ7ci5pc0FycmF5KG4pJiZyLmVhY2gobixmdW5jdGlvbih0KXt2YXIgZT10aGlzLnByb3BlcnRpZXMuZ2V0KHQpO2UmJmUuc2V0KCJyZXF1aXJlZCIsITApfSx0aGlzKTt2YXIgbz10LnNjaGVtYS5maWVsZE9yZGVyO3JldHVybiByLmlzQXJyYXkobykmJihyLmVhY2gobyxmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMucHJvcGVydGllcy5nZXQodCk7aSYmaS5zZXQoInNvcnRPcmRlciIsZSl9LHRoaXMpLHRoaXMucHJvcGVydGllcy5jb21wYXJhdG9yPSJzb3J0T3JkZXIiLHRoaXMucHJvcGVydGllcy5zb3J0KCkpLHIuaXNPYmplY3QodC5wYXNzd29yZENvbXBsZXhpdHkpPyh0aGlzLnBhc3N3b3JkQ29tcGxleGl0eT1uZXcgcyh0LnBhc3N3b3JkQ29tcGxleGl0eSx7cGFyc2U6ITB9KSxlPXIub21pdChlLCJwYXNzd29yZENvbXBsZXhpdHkiKSk6dGhpcy5wYXNzd29yZENvbXBsZXhpdHk9bmV3IHMoe30se3BhcnNlOiEwfSksZX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKV0scj1mdW5jdGlvbih0KXt2YXIgZT10Ll8saT1mdW5jdGlvbih0KXtyZXR1cm4gdD4wfSxuPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1pLm1hdGNoKHQpO3JldHVybiBuPW51bGwhPW4/bi5sZW5ndGg6MCxuPj1lfSxyPXttaW5MZW5ndGg6e21vZGVsUHJvcDpbIm51bWJlciIsITEsOF0saXNFbmFibGVkOmksZG9lc0NvbXBsZXhpdHlNZWV0OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUubGVuZ3RoPj10fSxnZXRJMThuTWVzc2FnZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5sb2MoInJlZ2lzdHJhdGlvbi5wYXNzd29yZENvbXBsZXhpdHkubWluTGVuZ3RoIiwibG9naW4iLFtlXSl9fSxtaW5Mb3dlckNhc2U6e21vZGVsUHJvcDpbIm51bWJlciIsITEsMV0saXNFbmFibGVkOmksZG9lc0NvbXBsZXhpdHlNZWV0OmUucGFydGlhbChuLC9bYS16XS9nKSxnZXRJMThuTWVzc2FnZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5sb2MoInJlZ2lzdHJhdGlvbi5wYXNzd29yZENvbXBsZXhpdHkubWluTG93ZXJDYXNlIiwibG9naW4iLFtlXSl9fSxtaW5VcHBlckNhc2U6e21vZGVsUHJvcDpbIm51bWJlciIsITEsMV0saXNFbmFibGVkOmksZG9lc0NvbXBsZXhpdHlNZWV0OmUucGFydGlhbChuLC9bQS1aXS9nKSxnZXRJMThuTWVzc2FnZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5sb2MoInJlZ2lzdHJhdGlvbi5wYXNzd29yZENvbXBsZXhpdHkubWluVXBwZXJDYXNlIiwibG9naW4iLFtlXSl9fSxtaW5OdW1iZXI6e21vZGVsUHJvcDpbIm51bWJlciIsITEsMV0saXNFbmFibGVkOmksZG9lc0NvbXBsZXhpdHlNZWV0OmUucGFydGlhbChuLC9cZC9nKSxnZXRJMThuTWVzc2FnZTpmdW5jdGlvbihlKXtyZXR1cm4gdC5sb2MoInJlZ2lzdHJhdGlvbi5wYXNzd29yZENvbXBsZXhpdHkubWluTnVtYmVyIiwibG9naW4iLFtlXSl9fSxtaW5TeW1ib2w6e21vZGVsUHJvcDpbIm51bWJlciIsITEsMV0saXNFbmFibGVkOmksZG9lc0NvbXBsZXhpdHlNZWV0OmUucGFydGlhbChuLC9bXmEtelx1MDBFMC1cdTAwRkNcZF0vZ2kpLGdldEkxOG5NZXNzYWdlOmZ1bmN0aW9uKGUpe3JldHVybiB0LmxvYygicmVnaXN0cmF0aW9uLnBhc3N3b3JkQ29tcGxleGl0eS5taW5TeW1ib2wiLCJsb2dpbiIsW2VdKX19LGV4Y2x1ZGVVc2VybmFtZTp7bW9kZWxQcm9wOlsiYm9vbGVhbiIsITEsITBdLGlzRW5hYmxlZDpmdW5jdGlvbih0KXtyZXR1cm4hIXR9LGRvZXNDb21wbGV4aXR5TWVldDpmdW5jdGlvbih0LGksbil7aWYoZS5pc0VtcHR5KGkpKXJldHVybiExO3ZhciByPW4uZ2V0KCJsb2dpbiIpO3JldHVybiFlLmlzRW1wdHkocikmJmkuaW5kZXhPZihyKT09PS0xfSxnZXRJMThuTWVzc2FnZTpmdW5jdGlvbigpe3JldHVybiB0LmxvYygicmVnaXN0cmF0aW9uLnBhc3N3b3JkQ29tcGxleGl0eS5leGNsdWRlVXNlcm5hbWUiLCJsb2dpbiIpfX19O3JldHVybnttb2RlbFByb3BzOmUubWFwT2JqZWN0KHIsZnVuY3Rpb24odCl7cmV0dXJuIHQubW9kZWxQcm9wfSksY29tcGxleGl0aWVzOnJ9fS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMiksaSgxMzgpLGkoMzMpLGkoMzg1KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj1mdW5jdGlvbihlKXt2YXIgaT10LnBpY2soZSwiaWQiLCJuYW1lIiwiZGlzcGxheU5hbWUiKSxuPXQubWFwKGUuc2NoZW1hLnByb3BlcnRpZXMsZnVuY3Rpb24oZSxpKXtyZXR1cm4gdCh7bmFtZTppfSkuY2hhaW4oKS5leHRlbmQoZSkub21pdCgiX19tZXRhZGF0YSIpLnZhbHVlKCl9KTtyZXR1cm4gdC5lYWNoKG4sZnVuY3Rpb24odCl7dC5fX3NjaGVtYU1ldGFfXz1pfSksbn0scz1lLmV4dGVuZCh7ZGVmYXVsdHM6e2lkOnZvaWQgMCxkaXNwbGF5TmFtZTp2b2lkIDAsbmFtZTp2b2lkIDB9LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dGhpcy5wcm9wZXJ0aWVzPW5ldyBuLkNvbGxlY3Rpb24sZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGdldFByb3BlcnRpZXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcm9wZXJ0aWVzfSxjbG9uZTpmdW5jdGlvbigpe3ZhciB0PWUucHJvdG90eXBlLmNsb25lLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gdC5nZXRQcm9wZXJ0aWVzKCkuc2V0KHRoaXMuZ2V0UHJvcGVydGllcygpLnRvSlNPTih7dmVyYm9zZTohMH0pKSx0fSxwYXJzZTpmdW5jdGlvbihlKXt2YXIgaT1yKGUpO3JldHVybiB0aGlzLnByb3BlcnRpZXMuc2V0KGkse3BhcnNlOiEwfSksdC5vbWl0KGUsInNjaGVtYSIpfSx0cmltUHJvcGVydHk6ZnVuY3Rpb24oZSl7cmV0dXJuIHQub21pdChlLCJuYW1lIil9LHRvSlNPTjpmdW5jdGlvbigpe3ZhciB0PWUucHJvdG90eXBlLnRvSlNPTi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHQuc2NoZW1hPXtwcm9wZXJ0aWVzOnt9fSx0aGlzLmdldFByb3BlcnRpZXMoKS5lYWNoKGZ1bmN0aW9uKGUpe3ZhciBpPWUudG9KU09OKCk7dC5zY2hlbWEucHJvcGVydGllc1tpLm5hbWVdPXRoaXMudHJpbVByb3BlcnR5KGkpfSx0aGlzKSx0fSxzYXZlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0UHJvcGVydGllcygpLmVhY2goZnVuY3Rpb24odCl7dC5jbGVhbnVwKCl9KSxlLnByb3RvdHlwZS5zYXZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KSxvPWkuZXh0ZW5kKHttb2RlbDpzfSk7cmV0dXJue3BhcnNlUHJvcGVydGllczpyLE1vZGVsOnMsQ29sbGVjdGlvbjpvfX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDIpLGkoMzQpLGkoMTM4KSxpKDE0NCksaSgxNzYpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9ci5TVFJJTkcsbz1yLk5VTUJFUixhPXIuSU5URUdFUixsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrIm9mIitlfSxjPWkuZXh0ZW5kKHtjb25zdHJhaW50SGFuZGxlcnM6e2JldHdlZW46Il9jaGVja0JldHdlZW5Db25zdHJhaW50cyIsZ3JlYXRlclRoYW46Il9jaGVja0dyZWF0ZXJUaGFuQ29uc3RyYWludCIsbGVzc1RoYW46Il9jaGVja0xlc3NUaGFuQ29uc3RyYWludCIsZXF1YWxzOiJfY2hlY2tFcXVhbHNDb25zdHJhaW50In0saWRBdHRyaWJ1dGU6Im5hbWUiLGRlZmF1bHRzOntuYW1lOiIiLHRpdGxlOnZvaWQgMCx0eXBlOnZvaWQgMCxkZXNjcmlwdGlvbjp2b2lkIDAscmVxdWlyZWQ6ITEsZm9ybWF0OnZvaWQgMCx1bmlvbjp2b2lkIDAsc2V0dGluZ3M6e3Blcm1pc3Npb25zOntTRUxGOnIuUEVSTUlTU0lPTi5SRUFEX09OTFl9fSxfX2lzU2Vuc2l0aXZlX186aS5Db21wdXRlZFByb3BlcnR5KFsic2V0dGluZ3MiXSxmdW5jdGlvbih0KXtyZXR1cm4hKCF0fHwhdC5zZW5zaXRpdmUpfSksX191c2VyUGVybWlzc2lvbl9fOnIuUEVSTUlTU0lPTi5SRUFEX09OTFksX19kaXNwbGF5VHlwZV9fOnZvaWQgMCxfX2Rpc3BsYXlUeXBlTGFiZWxfXzppLkNvbXB1dGVkUHJvcGVydHkoWyJfX2Rpc3BsYXlUeXBlX18iXSxmdW5jdGlvbih0KXtyZXR1cm4gci5EQVRBVFlQRVt0XXx8dH0pLF9fc3VwcG9ydHNNaW5NYXhfXzohMSxfX2lzUmVhZE9ubHlfXzppLkNvbXB1dGVkUHJvcGVydHkoWyJtdXRhYmlsaXR5Il0sZnVuY3Rpb24odCl7cmV0dXJuIHQ9PT1yLk1VVEFCSUxJVFkuUkVBRE9OTFl9KSxfX2lzV3JpdGVPbmx5X186aS5Db21wdXRlZFByb3BlcnR5KFsibXV0YWJpbGl0eSJdLGZ1bmN0aW9uKHQpe3JldHVybiB0PT09ci5NVVRBQklMSVRZLldSSVRFT05MWX0pLF9fZGlzcGxheVNjb3BlX186dm9pZCAwLF9faXNTY29wZVNlbGZfXzppLkNvbXB1dGVkUHJvcGVydHkoWyJzY29wZSJdLGZ1bmN0aW9uKHQpe3JldHVybiB0PT09ci5TQ09QRS5TRUxGfSksX19pc05vbmVTY29wZUFycmF5VHlwZV9fOmkuQ29tcHV0ZWRQcm9wZXJ0eShbIl9faXNTY29wZVNlbGZfXyIsIl9fZGlzcGxheVR5cGVfXyJdLGZ1bmN0aW9uKHQsZSl7cmV0dXJuIXQmJnIuaXNBcnJheURhdGFUeXBlKGUpfSksX19pc0ltcG9ydGVkX186aS5Db21wdXRlZFByb3BlcnR5KFsiZXh0ZXJuYWxOYW1lIl0sZnVuY3Rpb24odCl7cmV0dXJuISF0fSksX19pc0Zyb21CYXNlU2NoZW1hX186aS5Db21wdXRlZFByb3BlcnR5KFsiX19zY2hlbWFNZXRhX18iXSxmdW5jdGlvbih0KXtyZXR1cm4gdCYmImJhc2UiPT09dC5uYW1lfSl9LGluaXRpYWxpemU6ZnVuY3Rpb24oKXtpLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmxpc3RlblRvKHRoaXMsImNoYW5nZTpfX2Rpc3BsYXlUeXBlX18iLHRoaXMuX3VwZGF0ZVR5cGVGb3JtYXRDb25zdHJhaW50cyksdGhpcy5saXN0ZW5Ubyh0aGlzLCJjaGFuZ2U6dHlwZSBjaGFuZ2U6Zm9ybWF0IGNoYW5nZTppdGVtcyIsdGhpcy5fdXBkYXRlRGlzcGxheVR5cGUpLHRoaXMubGlzdGVuVG8odGhpcywiY2hhbmdlOl9fbWluVmFsX18gY2hhbmdlOl9fbWF4VmFsX18iLHRoaXMuX3VwZGF0ZU1pbk1heCksdGhpcy5saXN0ZW5Ubyh0aGlzLCJjaGFuZ2U6X19lcXVhbHNfXyIsdGhpcy5fY29udmVydEVxdWFsc1RvTWluTWF4KSx0aGlzLmxpc3RlblRvKHRoaXMsImNoYW5nZTpfX2NvbnN0cmFpbnRfXyIsdGhpcy5fc2V0Q29uc3RyYWludFRleHQpLHRoaXMuX3NldENvbnN0cmFpbnRUZXh0KCl9LHBhcnNlOmZ1bmN0aW9uKGUpe3JldHVybiBlPXQuY2xvbmUoZSksIm9iamVjdCI9PT1lLnR5cGUmJiJpbWFnZSI9PT1lLmV4dGVuZGVkVHlwZSYmKGUudHlwZT0iaW1hZ2UiKSxlLl9fZGlzcGxheVR5cGVfXz1yLmdldERpc3BsYXlUeXBlKGUudHlwZSxlLmZvcm1hdCxlLml0ZW1zP2UuaXRlbXMudHlwZTp2b2lkIDApLHRoaXMuX3NldFJhbmdlQ29uc3RyYWludHMoZSksZS5fX3N1cHBvcnRzTWluTWF4X189ci5TVVBQT1JUU01JTk1BWC5pbmRleE9mKGUuX19kaXNwbGF5VHlwZV9fKSE9LTEsZS5fX2Rpc3BsYXlTY29wZV9fPXIuRElTUExBWVNDT1BFW2Uuc2NvcGVdfHxyLkRJU1BMQVlTQ09QRS5OQSxlLnNldHRpbmdzJiZlLnNldHRpbmdzLnBlcm1pc3Npb25zJiZlLnNldHRpbmdzLnBlcm1pc3Npb25zLlNFTEYmJihlLl9fdXNlclBlcm1pc3Npb25fXz1lLnNldHRpbmdzLnBlcm1pc3Npb25zLlNFTEYpLHRoaXMuX3NldE1hc3Rlck92ZXJyaWRlKGUpLGV9LHZhbGlkYXRlOmZ1bmN0aW9uKCl7aWYodGhpcy5nZXQoIl9fc3VwcG9ydHNNaW5NYXhfXyIpJiZ0aGlzLmdldCgiX19jb25zdHJhaW50X18iKSl7dmFyIGU9dGhpcy5nZXQoIl9fY29uc3RyYWludF9fIiksaT10aGlzW3RoaXMuY29uc3RyYWludEhhbmRsZXJzW2VdXTtyZXR1cm4gdC5pc0Z1bmN0aW9uKGkpP2kuY2FsbCh0aGlzKTp2b2lkIG4ud2FybigiTm8gY29uc3RyYWludCBoYW5kbGVyIGZvdW5kIGZvcjogIitlKX19LF9jaGVja0JldHdlZW5Db25zdHJhaW50czpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0KCJfX21pblZhbF9fIiksZT10aGlzLmdldCgiX19tYXhWYWxfXyIpO2lmKHR8fGUpe2lmKCF0KXJldHVybntfX21pblZhbF9fOiJNaW4gdmFsdWUgaXMgcmVxdWlyZWQifTtpZighZSlyZXR1cm57X19tYXhWYWxfXzoiTWF4IHZhbHVlIGlzIHJlcXVpcmVkIn07dmFyIGk9dGhpcy5fY2hlY2tJbnRlZ2VyQ29uc3RyYWludHMoIl9fbWluVmFsX18iLCJNaW4gdmFsdWUiKTtyZXR1cm4gaT9pOihpPXRoaXMuX2NoZWNrSW50ZWdlckNvbnN0cmFpbnRzKCJfX21heFZhbF9fIiwiTWF4IHZhbHVlIiksaT9pOit0Pj0rZT97X19tYXhWYWxfXzoiTWF4IHZhbCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBtaW4gdmFsIn06dm9pZCAwKX19LF9jaGVja0dyZWF0ZXJUaGFuQ29uc3RyYWludDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0KCJfX21pblZhbF9fIik7aWYodCl7dmFyIGU9dGhpcy5fY2hlY2tJbnRlZ2VyQ29uc3RyYWludHMoIl9fbWluVmFsX18iLCJNaW4gdmFsdWUiKTtyZXR1cm4gZT9lOnZvaWQgMH19LF9jaGVja0xlc3NUaGFuQ29uc3RyYWludDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0KCJfX21heFZhbF9fIik7aWYodCl7dmFyIGU9dGhpcy5fY2hlY2tJbnRlZ2VyQ29uc3RyYWludHMoIl9fbWF4VmFsX18iLCJNYXggdmFsdWUiKTtyZXR1cm4gZT9lOnZvaWQgMH19LF9jaGVja0VxdWFsc0NvbnN0cmFpbnQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldCgiX19lcXVhbHNfXyIpO2lmKHQpe3ZhciBlPXRoaXMuX2NoZWNrSW50ZWdlckNvbnN0cmFpbnRzKCJfX2VxdWFsc19fIiwiQ29uc3RyYWludCIpO3JldHVybiBlP2U6dm9pZCAwfX0sX2NoZWNrSW50ZWdlckNvbnN0cmFpbnRzOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXQodCksbj17fTtyZXR1cm4gaXNOYU4oaSk/KG5bdF09ZSsiIG11c3QgYmUgYSBudW1iZXIiLG4pOitpPDA/KG5bdF09ZSsiIG11c3QgYmUgZ3JlYXRlciB0aGFuIDAiLG4pOnZvaWQgMH0sX3NldE1hc3Rlck92ZXJyaWRlOmZ1bmN0aW9uKGUpe2lmKGUuc2V0dGluZ3MmJmUuc2V0dGluZ3MubWFzdGVyT3ZlcnJpZGUmJmUuc2V0dGluZ3MubWFzdGVyT3ZlcnJpZGUpe3ZhciBpPWUuc2V0dGluZ3MubWFzdGVyT3ZlcnJpZGUudmFsdWU7dC5pc0FycmF5KGkpJiYhdC5pc0VtcHR5KGkpPyhlLl9fbWFzdGVyT3ZlcnJpZGVUeXBlX189Ik9WRVJSSURFIixlLl9fbWFzdGVyT3ZlcnJpZGVWYWx1ZV9fPWl8fFtdKTplLl9fbWFzdGVyT3ZlcnJpZGVUeXBlX189ZS5zZXR0aW5ncy5tYXN0ZXJPdmVycmlkZS50eXBlfWVsc2UgZS5fX21hc3Rlck92ZXJyaWRlVHlwZV9fPSJJTkhFUklUIn0sX3NldFJhbmdlQ29uc3RyYWludHM6ZnVuY3Rpb24odCl7dC5fX2Rpc3BsYXlUeXBlX189PXM/KHQuX19taW5WYWxfXz10Lm1pbkxlbmd0aCx0Ll9fbWF4VmFsX189dC5tYXhMZW5ndGgpOnQuX19kaXNwbGF5VHlwZV9fIT1hJiZ0Ll9fZGlzcGxheVR5cGVfXyE9b3x8KHQuX19taW5WYWxfXz10Lm1pbmltdW0sdC5fX21heFZhbF9fPXQubWF4aW11bSksdC5fX21pblZhbF9fJiZ0Ll9fbWF4VmFsX18/dC5fX21pblZhbF9fPT09dC5fX21heFZhbF9fPyh0Ll9fY29uc3RyYWludF9fPSJlcXVhbHMiLHQuX19lcXVhbHNfXz10Ll9fbWluVmFsX18pOnQuX19jb25zdHJhaW50X189ImJldHdlZW4iOiF0Ll9fbWluVmFsX18mJnQuX19tYXhWYWxfXz90Ll9fY29uc3RyYWludF9fPSJsZXNzVGhhbiI6IXQuX19tYXhWYWxfXyYmdC5fX21pblZhbF9fJiYodC5fX2NvbnN0cmFpbnRfXz0iZ3JlYXRlclRoYW4iKX0sX3VwZGF0ZURpc3BsYXlUeXBlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXQoInR5cGUiKTtpZih0PT09cyYmdGhpcy5nZXQoImZvcm1hdCIpKXRoaXMuc2V0KCJfX2Rpc3BsYXlUeXBlX18iLHIuRk9STUFURElTUExBWVRZUEVbdGhpcy5nZXQoImZvcm1hdCIpXSk7ZWxzZXt2YXIgZT10aGlzLmdldCgiaXRlbXMiKT90aGlzLmdldCgiaXRlbXMiKS50eXBlOnZvaWQgMDt0JiZlP3RoaXMuc2V0KCJfX2Rpc3BsYXlUeXBlX18iLHIuQVJSQVlESVNQTEFZVFlQRVtsKHQsZSldKTp0aGlzLnNldCgiX19kaXNwbGF5VHlwZV9fIix0KX19LHRvSlNPTjpmdW5jdGlvbigpe3ZhciB0PWkucHJvdG90eXBlLnRvSlNPTi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHQuc2V0dGluZ3M9e3Blcm1pc3Npb25zOnt9fSx0LnNldHRpbmdzLnBlcm1pc3Npb25zLlNFTEY9dGhpcy5nZXQoIl9fdXNlclBlcm1pc3Npb25fXyIpLHRoaXMuZ2V0KCJfX2lzU2Vuc2l0aXZlX18iKSYmKHQuc2V0dGluZ3Muc2Vuc2l0aXZlPXRoaXMuZ2V0KCJfX2lzU2Vuc2l0aXZlX18iKSksImltYWdlIj09PXRoaXMuZ2V0KCJ0eXBlIikmJih0LnR5cGU9Im9iamVjdCIsdC5leHRlbmRlZFR5cGU9ImltYWdlIiksdD10aGlzLl9hdHRyaWJ1dGVPdmVycmlkZVRvSnNvbih0KSx0PXRoaXMuX25vcm1hbGl6ZVVuaW9uVmFsdWUodCl9LF9hdHRyaWJ1dGVPdmVycmlkZVRvSnNvbjpmdW5jdGlvbihpKXt2YXIgbj10aGlzLmdldCgiX19tYXN0ZXJPdmVycmlkZVR5cGVfXyIpLHI9dGhpcy5nZXQoIl9fbWFzdGVyT3ZlcnJpZGVWYWx1ZV9fIik7cmV0dXJuIk9LVEFfTUFTVEVSRUQiPT09bj9pLnNldHRpbmdzLm1hc3Rlck92ZXJyaWRlPXt0eXBlOiJPS1RBX01BU1RFUkVEIn06Ik9WRVJSSURFIj09PW4mJihpLnNldHRpbmdzLm1hc3Rlck92ZXJyaWRlPXt0eXBlOiJPUkRFUkVEX0xJU1QiLHZhbHVlOltdfSxyIGluc3RhbmNlb2YgZT90LmVhY2goci50b0pTT04oKSxmdW5jdGlvbih0KXtpLnNldHRpbmdzLm1hc3Rlck92ZXJyaWRlLnZhbHVlLnB1c2godC5pZCl9KTpyIGluc3RhbmNlb2YgQXJyYXkmJihpLnNldHRpbmdzLm1hc3Rlck92ZXJyaWRlLnZhbHVlPXIpLHQuaXNFbXB0eShpLnNldHRpbmdzLm1hc3Rlck92ZXJyaWRlLnZhbHVlKSYmZGVsZXRlIGkuc2V0dGluZ3MubWFzdGVyT3ZlcnJpZGUpLCJJTkhFUklUIj09PW4mJmRlbGV0ZSBpLnNldHRpbmdzLm1hc3Rlck92ZXJyaWRlLGl9LF9ub3JtYWxpemVVbmlvblZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdldCgiX19pc05vbmVTY29wZUFycmF5VHlwZV9fIil8fCh0LnVuaW9uPXZvaWQgMCksdH0sX3VwZGF0ZVR5cGVGb3JtYXRDb25zdHJhaW50czpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0KCJfX2Rpc3BsYXlUeXBlX18iKTt0aGlzLnVuc2V0KCJmb3JtYXQiLHtzaWxlbnQ6ITB9KSx0aGlzLnVuc2V0KCJpdGVtcyIse3NpbGVudDohMH0pLHRoaXMuc2V0KHIuRElTUExBWVRZUEVTW3RdKSx0IT1vJiZ0IT1hJiYodGhpcy51bnNldCgibWluaW11bSIpLHRoaXMudW5zZXQoIm1heGltdW0iKSksdCE9cyYmKHRoaXMudW5zZXQoIm1pbkxlbmd0aCIpLHRoaXMudW5zZXQoIm1heExlbmd0aCIpKSx0aGlzLnVuc2V0KCJfX21pblZhbF9fIiksdGhpcy51bnNldCgiX19tYXhWYWxfXyIpLHRoaXMudW5zZXQoIl9fZXF1YWxzX18iKSx0aGlzLnNldCgiX19zdXBwb3J0c01pbk1heF9fIixyLlNVUFBPUlRTTUlOTUFYLmluZGV4T2YodGhpcy5nZXQoIl9fZGlzcGxheVR5cGVfXyIpKSE9LTEpfSxfdXBkYXRlTWluTWF4OmZ1bmN0aW9uKCl7dmFyIHQsZSxpPXRoaXMuZ2V0KCJfX2Rpc3BsYXlUeXBlX18iKTtpPT09cz8odD0ibWluTGVuZ3RoIixlPSJtYXhMZW5ndGgiKTppIT1hJiZpIT1vfHwodD0ibWluaW11bSIsZT0ibWF4aW11bSIpLHRoaXMuZ2V0KCJfX21pblZhbF9fIik/dGhpcy5zZXQodCxwYXJzZUludCh0aGlzLmdldCgiX19taW5WYWxfXyIpLDEwKSk6dGhpcy51bnNldCh0KSx0aGlzLmdldCgiX19tYXhWYWxfXyIpP3RoaXMuc2V0KGUscGFyc2VJbnQodGhpcy5nZXQoIl9fbWF4VmFsX18iKSwxMCkpOnRoaXMudW5zZXQoZSl9LF9jb252ZXJ0RXF1YWxzVG9NaW5NYXg6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldCgiX19lcXVhbHNfXyIpO3QmJih0aGlzLnNldCgiX19taW5WYWxfXyIsdCksdGhpcy5zZXQoIl9fbWF4VmFsX18iLHQpKX0sX3NldENvbnN0cmFpbnRUZXh0OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXQoIl9fY29uc3RyYWludF9fIiksZT10aGlzLmdldCgiX19taW5WYWxfXyIpLGk9dGhpcy5nZXQoIl9fbWF4VmFsX18iKSxuPXRoaXMuZ2V0KCJfX2VxdWFsc19fIik7c3dpdGNoKHQpe2Nhc2UiYmV0d2VlbiI6dGhpcy5zZXQoIl9fY29uc3RyYWludFRleHRfXyIsIkJldHdlZW4gIitlKyIgYW5kICIraSk7YnJlYWs7Y2FzZSJncmVhdGVyVGhhbiI6dGhpcy5zZXQoIl9fY29uc3RyYWludFRleHRfXyIsIkdyZWF0ZXIgdGhhbiAiK2UpO2JyZWFrO2Nhc2UibGVzc1RoYW4iOnRoaXMuc2V0KCJfX2NvbnN0cmFpbnRUZXh0X18iLCJMZXNzIHRoYW4gIitpKTticmVhaztjYXNlImVxdWFscyI6dGhpcy5zZXQoIl9fY29uc3RyYWludFRleHRfXyIsIkVxdWFscyAiK24pO2JyZWFrO2RlZmF1bHQ6dGhpcy5zZXQoIl9fY29uc3RyYWludFRleHRfXyIsIiIpfX0sY2xlYW51cDpmdW5jdGlvbigpeyJsZXNzVGhhbiI9PT10aGlzLmdldCgiX19jb25zdHJhaW50X18iKT90aGlzLnVuc2V0KCJfX21pblZhbF9fIik6ImdyZWF0ZXJUaGFuIj09PXRoaXMuZ2V0KCJfX2NvbnN0cmFpbnRfXyIpJiZ0aGlzLnVuc2V0KCJfX21heFZhbF9fIiksdGhpcy5nZXQoInNjb3BlIikhPT1yLlNDT1BFLlNZU1RFTSYmKHRoaXMuZ2V0KCJfX2lzU2NvcGVTZWxmX18iKT09PSEwP3RoaXMuc2V0KHtzY29wZTpyLlNDT1BFLlNFTEZ9LHtzaWxlbnQ6ITB9KTp0aGlzLnVuc2V0KCJzY29wZSIpKX0saXNFbnVtVHlwZTpmdW5jdGlvbigpe3JldHVybiEhdGhpcy5nZXRFbnVtVmFsdWVzKCl9LGdldEVudW1WYWx1ZXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXQoImVudW0iKXx8dGhpcy5nZXQoIml0ZW1zIikmJnRoaXMuZ2V0KCJpdGVtcyIpWyJlbnVtIl19fSksdT1lLmV4dGVuZCh7bW9kZWw6YyxjbG9uZTpmdW5jdGlvbigpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLnRvSlNPTih7dmVyYm9zZTohMH0pLHtwYXJzZTohMH0pfSxhcmVBbGxSZWFkT25seTpmdW5jdGlvbigpe3JldHVybiB0LmFsbCh0aGlzLnBsdWNrKCJfX2lzUmVhZE9ubHlfXyIpKX0sY3JlYXRlTW9kZWxQcm9wZXJ0aWVzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVkdWNlKGZ1bmN0aW9uKGUsaSl7dmFyIG49aS5nZXQoInR5cGUiKTtyZXR1cm4gZVtpLmlkXT10LmNsb25lKHIuRElTUExBWVRZUEVTW25dKSxyLlNVUFBPUlRTTUlOTUFYLmluZGV4T2YobikhPS0xJiYoZVtpLmlkXS5taW5MZW5ndGg9aS5nZXQoIm1pbkxlbmd0aCIpLGVbaS5pZF0ubWF4TGVuZ3RoPWkuZ2V0KCJtYXhMZW5ndGgiKSksInN0cmluZyI9PT1uJiYoZVtpLmlkXS5mb3JtYXQ9aS5nZXQoImZvcm1hdCIpKSxlfSx7fSl9fSk7cmV0dXJue01vZGVsOmMsQ29sbGVjdGlvbjp1fX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDI3MSksaSgzMDYpXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Ll8scj1mdW5jdGlvbih0KXt2YXIgcj1lLmNyZWF0ZUlucHV0T3B0aW9ucyh0KTtzd2l0Y2gocj0ic2VsZWN0Ij09PXIudHlwZT9uLmV4dGVuZChyLHtsYWJlbDp0LmdldCgiZGVzY3JpcHRpb24iKX0pOm4uZXh0ZW5kKHIse2xhYmVsOiExLCJsYWJlbC10b3AiOiEwLHBsYWNlaG9sZGVyOnQuZ2V0KCJkZXNjcmlwdGlvbiIpfSksdC5nZXQoIm5hbWUiKSl7Y2FzZSJsb2dpbiI6ci5pbnB1dD1pLHIucGFyYW1zPXtpY29uOiJwZXJzb24tMTYtZ3JheSJ9O2JyZWFrO2Nhc2UicGFzc3dvcmQiOnIudHlwZT0icGFzc3dvcmQiLHIuaW5wdXQ9aSxyLnBhcmFtcz17aWNvbjoicmVtb3RlLWxvY2stMTYifX1yZXR1cm4gcn07cmV0dXJue2NyZWF0ZUlucHV0T3B0aW9uczpyfX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDM4MyldLHI9ZnVuY3Rpb24odCxlKXt2YXIgaT10Ll8sbj10LlZpZXcuZXh0ZW5kKHtuYW1lOiIiLG1lc3NhZ2U6IiIsaWQ6ZnVuY3Rpb24oKXtyZXR1cm4icGFzc3dvcmQtY29tcGxleGl0eS0iK3RoaXMubmFtZX0sY2xhc3NOYW1lOiJwYXNzd29yZC1jb21wbGV4aXR5LXVuc2F0aXNmaWVkIix0ZW1wbGF0ZTonXHQgICAgICA8cD5cdCAgICAgICAgPHNwYW4gY2xhc3M9Imljb24gaWNvbi0xNiBlcnJvci0xNi1zbWFsbCIvPlx0ICAgICAgICB7e21lc3NhZ2V9fVx0ICAgICAgPC9wPlx0ICAgICcsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7cmV0dXJue21lc3NhZ2U6dGhpcy5tZXNzYWdlfX19KTtyZXR1cm4gdC5WaWV3LmV4dGVuZCh7Y2xhc3NOYW1lOiJwYXNzd29yZC1jb21wbGV4aXR5IixjaGlsZHJlbjpmdW5jdGlvbigpe3JldHVybiBpLm1hcCh0aGlzLnBhc3N3b3JkQ29tcGxleGl0eS5lbmFibGVkQ29tcGxleGl0aWVzLGZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMuZ2V0KHQpLHI9ZS5jb21wbGV4aXRpZXNbdF0uZ2V0STE4bk1lc3NhZ2UoaSk7cmV0dXJuIG4uZXh0ZW5kKHtuYW1lOnQsbWVzc2FnZTpyfSl9LHRoaXMucGFzc3dvcmRDb21wbGV4aXR5KX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDMwMSksaSgyOTUpLGkoMjk2KV0scj1mdW5jdGlvbih0LGUsaSxuKXt2YXIgcj10Ll87cmV0dXJuIGkuZXh0ZW5kKHtjbGFzc05hbWU6InJlZ2lzdHJhdGlvbi1jb21wbGV0ZSIsTW9kZWw6ZnVuY3Rpb24oKXt9LEZvcm06e3RpdGxlOnIucGFydGlhbCh0LmxvYywicmVnaXN0cmF0aW9uLmNvbXBsZXRlLnRpdGxlIiwibG9naW4iKSxub0J1dHRvbkJhcjohMCxmb3JtQ2hpbGRyZW46ZnVuY3Rpb24oKXtyZXR1cm5bbi5WaWV3KHtWaWV3OnQuVmlldy5leHRlbmQoe3RlbXBsYXRlOiJcdCAgICAgICAgICAgICAgPHNwYW4+e3tkZXNjfX08L3NwYW4+XHQgICAgICAgICAgICAgICIsZ2V0VGVtcGxhdGVEYXRhOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgidXNlcm5hbWUiKTtyZXR1cm57ZGVzYzp0LmxvYygicmVnaXN0cmF0aW9uLmNvbXBsZXRlLmRlc2MiLCJsb2dpbiIsW2VdKX19fSl9KV19fX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjEpLGkoMjk0KSxpKDM5MCksaSgzMTcpXSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHM9dC5fO3JldHVybiB0LlZpZXcuZXh0ZW5kKHt0ZW1wbGF0ZTonXHQgICAgICA8ZGl2IGNsYXNzPSJiZWFjb24tYmxhbmsgYXV0aC1iZWFjb24iPlx0ICAgICAgICA8ZGl2IGNsYXNzPSJiZWFjb24tYmxhbmsganMtYmxhbmstYmVhY29uLWJvcmRlciBhdXRoLWJlYWNvbi1ib3JkZXIiPjwvZGl2Plx0ICAgICAgPC9kaXY+XHQgICAgICA8ZGl2IGNsYXNzPSJiZy1oZWxwZXIgYXV0aC1iZWFjb24gYXV0aC1iZWFjb24tZmFjdG9yIHt7Y2xhc3NOYW1lfX0iIGRhdGEtc2U9ImZhY3Rvci1iZWFjb24iPlx0ICAgICAgICA8ZGl2IGNsYXNzPSJva3RhLXNpZ24taW4tYmVhY29uLWJvcmRlciBhdXRoLWJlYWNvbi1ib3JkZXIiPjwvZGl2Plx0ICAgICAgPC9kaXY+XHQgICAgICA8ZGl2IGRhdGEtdHlwZT0iZmFjdG9yLXR5cGVzLWRyb3Bkb3duIiBjbGFzcz0iZmFjdG9ycy1kcm9wZG93bi13cmFwIj48L2Rpdj5cdCAgICAnLGV2ZW50czp7ImNsaWNrIC5hdXRoLWJlYWNvbi1mYWN0b3IiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpLHRoaXMuJCgiLmRyb3Bkb3duIC5vcHRpb25zIikudG9nZ2xlKCl9fSxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLmFwcFN0YXRlLnNldCgiYmVhY29uVHlwZSIsImZhY3RvciIpfSxnZXRUZW1wbGF0ZURhdGE6ZnVuY3Rpb24oKXt2YXIgdCxlLGk9dGhpcy5vcHRpb25zLmFwcFN0YXRlLmdldCgiZmFjdG9ycyIpO3JldHVybiB0PWk/aS5maW5kV2hlcmUocy5waWNrKHRoaXMub3B0aW9ucywicHJvdmlkZXIiLCJmYWN0b3JUeXBlIikpOm5ldyByLk1vZGVsKHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImZhY3RvciIpLHRoaXMudG9KU09OKCkpLGU9dC5nZXQoImljb25DbGFzc05hbWUiKSx7Y2xhc3NOYW1lOmV8fCIifX0scG9zdFJlbmRlcjpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5hbmltYXRlJiZ0aGlzLiQoIi5hdXRoLWJlYWNvbi1mYWN0b3IiKS5mYWRlSW4oMjAwKTt2YXIgdD10aGlzLm9wdGlvbnMuYXBwU3RhdGU7dC5nZXQoImhhc01mYVJlcXVpcmVkT3B0aW9ucyIpJiZ0aGlzLmFkZChuLCdbZGF0YS10eXBlPSJmYWN0b3ItdHlwZXMtZHJvcGRvd24iXScpfSxmYWRlT3V0OmZ1bmN0aW9uKCl7dmFyIHQ9ZS5kZWZlcigpO3JldHVybiB0aGlzLiQoIi5hdXRoLWJlYWNvbi1mYWN0b3IiKS5mYWRlT3V0KDIwMCxmdW5jdGlvbigpe3QucmVzb2x2ZSgpfSksdC5wcm9taXNlfSxlcXVhbHM6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdCYmdGhpcyBpbnN0YW5jZW9mIHQmJmUucHJvdmlkZXI9PT10aGlzLm9wdGlvbnMucHJvdmlkZXImJihlLmZhY3RvclR5cGU9PT10aGlzLm9wdGlvbnMuZmFjdG9yVHlwZXx8aS5pc09rdGFWZXJpZnkoZS5wcm92aWRlcixlLmZhY3RvclR5cGUpJiZpLmlzT2t0YVZlcmlmeSh0aGlzLm9wdGlvbnMucHJvdmlkZXIsdGhpcy5vcHRpb25zLmZhY3RvclR5cGUpKX19KX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfSxmdW5jdGlvbih0LGUsaSl7dmFyIG4scjtuPVtpKDMyKSxpKDM5MSksaSgxOTYpXSxyPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10Ll8scj10LiQ7cmV0dXJuIHIoZG9jdW1lbnQpLmNsaWNrKGZ1bmN0aW9uKHQpe3ZhciBlPXIodC50YXJnZXQpLGk9ZS5jbG9zZXN0KCIub3B0aW9uLXNlbGVjdGVkIikubGVuZ3RoPjAmJmUuY2xvc2VzdCgiLmRyb3Bkb3duIikubGVuZ3RoPjA7aXx8cigiLmRyb3Bkb3duIC5vcHRpb25zIikuaGlkZSgpfSksaS5leHRlbmQoe2NsYXNzTmFtZToiYmctaGVscGVyIGljb24tYnV0dG9uIixldmVudHM6eyJjbGljayBhLm9wdGlvbi1zZWxlY3RlZCI6ZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLG4ucmVzdWx0KHRoaXMsImRpc2FibGVkIik/dC5zdG9wUHJvcGFnYXRpb24oKTp0aGlzLiQoIi5vcHRpb25zIikudG9nZ2xlKCl9LCJjbGljayAuZHJvcGRvd24tZGlzYWJsZWQiOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpfX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3RoaXMuYWRkT3B0aW9uKGUuZ2V0RHJvcGRvd25PcHRpb24oIlRJVExFIikpLHRoaXMub3B0aW9ucy5hcHBTdGF0ZS5nZXQoImZhY3RvcnMiKS5lYWNoKGZ1bmN0aW9uKHQpe3RoaXMuYWRkT3B0aW9uKGUuZ2V0RHJvcGRvd25PcHRpb24odC5nZXQoImZhY3Rvck5hbWUiKSkse21vZGVsOnR9KSx0aGlzLmxpc3RlblRvKHRoaXMubGFzdCgpLCJvcHRpb25zOnRvZ2dsZSIsZnVuY3Rpb24oKXt0aGlzLiQoIi5vcHRpb25zIikuaGlkZSgpfSl9LHRoaXMpfX0pfS5hcHBseShlLG4pLCEodm9pZCAwIT09ciYmKHQuZXhwb3J0cz1yKSl9LGZ1bmN0aW9uKHQsZSxpKXt2YXIgbixyO249W2koMzIpLGkoMjk5KV0scj1mdW5jdGlvbih0LGUpe3ZhciBpPXQuXyxuPWZ1bmN0aW9uKHQpe3ZhciBpPWUuY3JlYXRlVmVyaWZ5VXJsKHQuZ2V0KCJwcm92aWRlciIpLHQuZ2V0KCJmYWN0b3JUeXBlIikpLG49dGhpczt0aGlzLm1vZGVsLm1hbmFnZVRyYW5zYWN0aW9uKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIk1GQV9DSEFMTEVOR0UiPT09dC5zdGF0dXMmJnQucHJldj90LnByZXYoKS50aGVuKGZ1bmN0aW9uKHQpe24udHJpZ2dlcigib3B0aW9uczp0b2dnbGUiKSxlKHQpLG4ub3B0aW9ucy5hcHBTdGF0ZS50cmlnZ2VyKCJuYXZpZ2F0ZSIsaSl9KToobi50cmlnZ2VyKCJvcHRpb25zOnRvZ2dsZSIpLHZvaWQgbi5vcHRpb25zLmFwcFN0YXRlLnRyaWdnZXIoIm5hdmlnYXRlIixpKSl9KX0scj17VElUTEU6e3RpdGxlOmkucGFydGlhbCh0LmxvYywibWZhLmZhY3RvcnMuZHJvcGRvd24udGl0bGUiLCJsb2dpbiIpLGNsYXNzTmFtZToiZHJvcGRvd24tbGlzdC10aXRsZSJ9LE9LVEFfVkVSSUZZOntpY29uOiJmYWN0b3ItaWNvbiBtZmEtb2t0YS12ZXJpZnktMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LE9LVEFfVkVSSUZZX1BVU0g6e2ljb246ImZhY3Rvci1pY29uIG1mYS1va3RhLXZlcmlmeS0zMCIsdGl0bGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5nZXQoImZhY3RvckxhYmVsIil9LGFjdGlvbjpmdW5jdGlvbigpe24uY2FsbCh0aGlzLHRoaXMubW9kZWwpfX0sR09PR0xFX0FVVEg6e2ljb246ImZhY3Rvci1pY29uIG1mYS1nb29nbGUtYXV0aC0zMCIsdGl0bGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5nZXQoImZhY3RvckxhYmVsIil9LGFjdGlvbjpmdW5jdGlvbigpe24uY2FsbCh0aGlzLHRoaXMubW9kZWwpfX0sU1lNQU5URUNfVklQOntpY29uOiJmYWN0b3ItaWNvbiBtZmEtc3ltYW50ZWMtMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LFJTQV9TRUNVUklEOntpY29uOiJmYWN0b3ItaWNvbiBtZmEtcnNhLTMwIix0aXRsZTppLnBhcnRpYWwodC5sb2MsImZhY3Rvci50b3RwSGFyZC5yc2FTZWN1cklkIiwibG9naW4iKSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LE9OX1BSRU06e2ljb246ImZhY3Rvci1pY29uIG1mYS1vbnByZW0tMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LERVTzp7aWNvbjoiZmFjdG9yLWljb24gbWZhLWR1by0zMCIsdGl0bGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5nZXQoImZhY3RvckxhYmVsIil9LGFjdGlvbjpmdW5jdGlvbigpe24uY2FsbCh0aGlzLHRoaXMubW9kZWwpfX0sRFVPX1BVU0g6e2ljb246ImR1by1wdXNoLTE2IixjbGFzc05hbWU6InN1Ym9wdGlvbiIsdGl0bGU6aS5wYXJ0aWFsKHQubG9jLCJtZmEuZHVvU2VjdXJpdHkucHVzaCIsImxvZ2luIixbIlhYWC1YWFgtNzg5MCJdKX0sRFVPX1NNUzp7aWNvbjoiZHVvLXNtcy0xNiIsY2xhc3NOYW1lOiJzdWJvcHRpb24iLHRpdGxlOmkucGFydGlhbCh0LmxvYywibWZhLmR1b1NlY3VyaXR5LnNtcyIsImxvZ2luIixbIlhYWC1YWFgtNzg5MCJdKX0sRFVPX0NBTEw6e2ljb246ImR1by1jYWxsLTE2IixjbGFzc05hbWU6InN1Ym9wdGlvbiIsdGl0bGU6aS5wYXJ0aWFsKHQubG9jLCJtZmEuZHVvU2VjdXJpdHkuY2FsbCIsImxvZ2luIixbIlhYWC1YWFgtNzg5MCJdKX0sWVVCSUtFWTp7aWNvbjoiZmFjdG9yLWljb24gbWZhLXl1YmlrZXktMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LFNNUzp7aWNvbjoiZmFjdG9yLWljb24gbWZhLXNtcy0zMCIsdGl0bGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbC5nZXQoImZhY3RvckxhYmVsIil9LGFjdGlvbjpmdW5jdGlvbigpe24uY2FsbCh0aGlzLHRoaXMubW9kZWwpfX0sQ0FMTDp7aWNvbjoiZmFjdG9yLWljb24gbWZhLWNhbGwtMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LFFVRVNUSU9OOntpY29uOiJmYWN0b3ItaWNvbiBtZmEtcXVlc3Rpb24tMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LFdJTkRPV1NfSEVMTE86e2ljb246ImZhY3Rvci1pY29uIG1mYS13aW5kb3dzLWhlbGxvLTMwIix0aXRsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1vZGVsLmdldCgiZmFjdG9yTGFiZWwiKX0sYWN0aW9uOmZ1bmN0aW9uKCl7bi5jYWxsKHRoaXMsdGhpcy5tb2RlbCl9fSxVMkY6e2ljb246ImZhY3Rvci1pY29uIG1mYS11MmYtMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19LEVNQUlMOntpY29uOiJmYWN0b3ItaWNvbiBtZmEtZW1haWwtMzAiLHRpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWwuZ2V0KCJmYWN0b3JMYWJlbCIpfSxhY3Rpb246ZnVuY3Rpb24oKXtuLmNhbGwodGhpcyx0aGlzLm1vZGVsKX19fTtyZXR1cm57Z2V0RHJvcGRvd25PcHRpb246ZnVuY3Rpb24odCl7cmV0dXJuIHJbdF19fX0uYXBwbHkoZSxuKSwhKHZvaWQgMCE9PXImJih0LmV4cG9ydHM9cikpfV0pfSk7CgovKioqLyB9LAovKiAyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsvKiEKCSAqIGpRdWVyeSBKYXZhU2NyaXB0IExpYnJhcnkgdjEuMTIuMQoJICogaHR0cDovL2pxdWVyeS5jb20vCgkgKgoJICogSW5jbHVkZXMgU2l6emxlLmpzCgkgKiBodHRwOi8vc2l6emxlanMuY29tLwoJICoKCSAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzCgkgKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UKCSAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UKCSAqCgkgKiBEYXRlOiAyMDE2LTAyLTIyVDE5OjA3WgoJICovCgoJKGZ1bmN0aW9uKCBnbG9iYWwsIGZhY3RvcnkgKSB7CgoJCWlmICggdHlwZW9mIG1vZHVsZSA9PT0gIm9iamVjdCIgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzID09PSAib2JqZWN0IiApIHsKCQkJLy8gRm9yIENvbW1vbkpTIGFuZCBDb21tb25KUy1saWtlIGVudmlyb25tZW50cyB3aGVyZSBhIHByb3BlciBgd2luZG93YAoJCQkvLyBpcyBwcmVzZW50LCBleGVjdXRlIHRoZSBmYWN0b3J5IGFuZCBnZXQgalF1ZXJ5LgoJCQkvLyBGb3IgZW52aXJvbm1lbnRzIHRoYXQgZG8gbm90IGhhdmUgYSBgd2luZG93YCB3aXRoIGEgYGRvY3VtZW50YAoJCQkvLyAoc3VjaCBhcyBOb2RlLmpzKSwgZXhwb3NlIGEgZmFjdG9yeSBhcyBtb2R1bGUuZXhwb3J0cy4KCQkJLy8gVGhpcyBhY2NlbnR1YXRlcyB0aGUgbmVlZCBmb3IgdGhlIGNyZWF0aW9uIG9mIGEgcmVhbCBgd2luZG93YC4KCQkJLy8gZS5nLiB2YXIgalF1ZXJ5ID0gcmVxdWlyZSgianF1ZXJ5Iikod2luZG93KTsKCQkJLy8gU2VlIHRpY2tldCAjMTQ1NDkgZm9yIG1vcmUgaW5mby4KCQkJbW9kdWxlLmV4cG9ydHMgPSBnbG9iYWwuZG9jdW1lbnQgPwoJCQkJZmFjdG9yeSggZ2xvYmFsLCB0cnVlICkgOgoJCQkJZnVuY3Rpb24oIHcgKSB7CgkJCQkJaWYgKCAhdy5kb2N1bWVudCApIHsKCQkJCQkJdGhyb3cgbmV3IEVycm9yKCAialF1ZXJ5IHJlcXVpcmVzIGEgd2luZG93IHdpdGggYSBkb2N1bWVudCIgKTsKCQkJCQl9CgkJCQkJcmV0dXJuIGZhY3RvcnkoIHcgKTsKCQkJCX07CgkJfSBlbHNlIHsKCQkJZmFjdG9yeSggZ2xvYmFsICk7CgkJfQoKCS8vIFBhc3MgdGhpcyBpZiB3aW5kb3cgaXMgbm90IGRlZmluZWQgeWV0Cgl9KHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiID8gd2luZG93IDogdGhpcywgZnVuY3Rpb24oIHdpbmRvdywgbm9HbG9iYWwgKSB7CgoJLy8gU3VwcG9ydDogRmlyZWZveCAxOCsKCS8vIENhbid0IGJlIGluIHN0cmljdCBtb2RlLCBzZXZlcmFsIGxpYnMgaW5jbHVkaW5nIEFTUC5ORVQgdHJhY2UKCS8vIHRoZSBzdGFjayB2aWEgYXJndW1lbnRzLmNhbGxlci5jYWxsZWUgYW5kIEZpcmVmb3ggZGllcyBpZgoJLy8geW91IHRyeSB0byB0cmFjZSB0aHJvdWdoICJ1c2Ugc3RyaWN0IiBjYWxsIGNoYWlucy4gKCMxMzMzNSkKCS8vInVzZSBzdHJpY3QiOwoJdmFyIGRlbGV0ZWRJZHMgPSBbXTsKCgl2YXIgZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQ7CgoJdmFyIHNsaWNlID0gZGVsZXRlZElkcy5zbGljZTsKCgl2YXIgY29uY2F0ID0gZGVsZXRlZElkcy5jb25jYXQ7CgoJdmFyIHB1c2ggPSBkZWxldGVkSWRzLnB1c2g7CgoJdmFyIGluZGV4T2YgPSBkZWxldGVkSWRzLmluZGV4T2Y7CgoJdmFyIGNsYXNzMnR5cGUgPSB7fTsKCgl2YXIgdG9TdHJpbmcgPSBjbGFzczJ0eXBlLnRvU3RyaW5nOwoKCXZhciBoYXNPd24gPSBjbGFzczJ0eXBlLmhhc093blByb3BlcnR5OwoKCXZhciBzdXBwb3J0ID0ge307CgoKCgl2YXIKCQl2ZXJzaW9uID0gIjEuMTIuMSIsCgoJCS8vIERlZmluZSBhIGxvY2FsIGNvcHkgb2YgalF1ZXJ5CgkJalF1ZXJ5ID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBjb250ZXh0ICkgewoKCQkJLy8gVGhlIGpRdWVyeSBvYmplY3QgaXMgYWN0dWFsbHkganVzdCB0aGUgaW5pdCBjb25zdHJ1Y3RvciAnZW5oYW5jZWQnCgkJCS8vIE5lZWQgaW5pdCBpZiBqUXVlcnkgaXMgY2FsbGVkIChqdXN0IGFsbG93IGVycm9yIHRvIGJlIHRocm93biBpZiBub3QgaW5jbHVkZWQpCgkJCXJldHVybiBuZXcgalF1ZXJ5LmZuLmluaXQoIHNlbGVjdG9yLCBjb250ZXh0ICk7CgkJfSwKCgkJLy8gU3VwcG9ydDogQW5kcm9pZDw0LjEsIElFPDkKCQkvLyBNYWtlIHN1cmUgd2UgdHJpbSBCT00gYW5kIE5CU1AKCQlydHJpbSA9IC9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZywKCgkJLy8gTWF0Y2hlcyBkYXNoZWQgc3RyaW5nIGZvciBjYW1lbGl6aW5nCgkJcm1zUHJlZml4ID0gL14tbXMtLywKCQlyZGFzaEFscGhhID0gLy0oW1xkYS16XSkvZ2ksCgoJCS8vIFVzZWQgYnkgalF1ZXJ5LmNhbWVsQ2FzZSBhcyBjYWxsYmFjayB0byByZXBsYWNlKCkKCQlmY2FtZWxDYXNlID0gZnVuY3Rpb24oIGFsbCwgbGV0dGVyICkgewoJCQlyZXR1cm4gbGV0dGVyLnRvVXBwZXJDYXNlKCk7CgkJfTsKCglqUXVlcnkuZm4gPSBqUXVlcnkucHJvdG90eXBlID0gewoKCQkvLyBUaGUgY3VycmVudCB2ZXJzaW9uIG9mIGpRdWVyeSBiZWluZyB1c2VkCgkJanF1ZXJ5OiB2ZXJzaW9uLAoKCQljb25zdHJ1Y3RvcjogalF1ZXJ5LAoKCQkvLyBTdGFydCB3aXRoIGFuIGVtcHR5IHNlbGVjdG9yCgkJc2VsZWN0b3I6ICIiLAoKCQkvLyBUaGUgZGVmYXVsdCBsZW5ndGggb2YgYSBqUXVlcnkgb2JqZWN0IGlzIDAKCQlsZW5ndGg6IDAsCgoJCXRvQXJyYXk6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gc2xpY2UuY2FsbCggdGhpcyApOwoJCX0sCgoJCS8vIEdldCB0aGUgTnRoIGVsZW1lbnQgaW4gdGhlIG1hdGNoZWQgZWxlbWVudCBzZXQgT1IKCQkvLyBHZXQgdGhlIHdob2xlIG1hdGNoZWQgZWxlbWVudCBzZXQgYXMgYSBjbGVhbiBhcnJheQoJCWdldDogZnVuY3Rpb24oIG51bSApIHsKCQkJcmV0dXJuIG51bSAhPSBudWxsID8KCgkJCQkvLyBSZXR1cm4ganVzdCB0aGUgb25lIGVsZW1lbnQgZnJvbSB0aGUgc2V0CgkJCQkoIG51bSA8IDAgPyB0aGlzWyBudW0gKyB0aGlzLmxlbmd0aCBdIDogdGhpc1sgbnVtIF0gKSA6CgoJCQkJLy8gUmV0dXJuIGFsbCB0aGUgZWxlbWVudHMgaW4gYSBjbGVhbiBhcnJheQoJCQkJc2xpY2UuY2FsbCggdGhpcyApOwoJCX0sCgoJCS8vIFRha2UgYW4gYXJyYXkgb2YgZWxlbWVudHMgYW5kIHB1c2ggaXQgb250byB0aGUgc3RhY2sKCQkvLyAocmV0dXJuaW5nIHRoZQ==", "base64"));
  res.write(new Buffer("IG5ldyBtYXRjaGVkIGVsZW1lbnQgc2V0KQoJCXB1c2hTdGFjazogZnVuY3Rpb24oIGVsZW1zICkgewoKCQkJLy8gQnVpbGQgYSBuZXcgalF1ZXJ5IG1hdGNoZWQgZWxlbWVudCBzZXQKCQkJdmFyIHJldCA9IGpRdWVyeS5tZXJnZSggdGhpcy5jb25zdHJ1Y3RvcigpLCBlbGVtcyApOwoKCQkJLy8gQWRkIHRoZSBvbGQgb2JqZWN0IG9udG8gdGhlIHN0YWNrIChhcyBhIHJlZmVyZW5jZSkKCQkJcmV0LnByZXZPYmplY3QgPSB0aGlzOwoJCQlyZXQuY29udGV4dCA9IHRoaXMuY29udGV4dDsKCgkJCS8vIFJldHVybiB0aGUgbmV3bHktZm9ybWVkIGVsZW1lbnQgc2V0CgkJCXJldHVybiByZXQ7CgkJfSwKCgkJLy8gRXhlY3V0ZSBhIGNhbGxiYWNrIGZvciBldmVyeSBlbGVtZW50IGluIHRoZSBtYXRjaGVkIHNldC4KCQllYWNoOiBmdW5jdGlvbiggY2FsbGJhY2sgKSB7CgkJCXJldHVybiBqUXVlcnkuZWFjaCggdGhpcywgY2FsbGJhY2sgKTsKCQl9LAoKCQltYXA6IGZ1bmN0aW9uKCBjYWxsYmFjayApIHsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqUXVlcnkubWFwKCB0aGlzLCBmdW5jdGlvbiggZWxlbSwgaSApIHsKCQkJCXJldHVybiBjYWxsYmFjay5jYWxsKCBlbGVtLCBpLCBlbGVtICk7CgkJCX0gKSApOwoJCX0sCgoJCXNsaWNlOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBzbGljZS5hcHBseSggdGhpcywgYXJndW1lbnRzICkgKTsKCQl9LAoKCQlmaXJzdDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLmVxKCAwICk7CgkJfSwKCgkJbGFzdDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLmVxKCAtMSApOwoJCX0sCgoJCWVxOiBmdW5jdGlvbiggaSApIHsKCQkJdmFyIGxlbiA9IHRoaXMubGVuZ3RoLAoJCQkJaiA9ICtpICsgKCBpIDwgMCA/IGxlbiA6IDAgKTsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqID49IDAgJiYgaiA8IGxlbiA/IFsgdGhpc1sgaiBdIF0gOiBbXSApOwoJCX0sCgoJCWVuZDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLnByZXZPYmplY3QgfHwgdGhpcy5jb25zdHJ1Y3RvcigpOwoJCX0sCgoJCS8vIEZvciBpbnRlcm5hbCB1c2Ugb25seS4KCQkvLyBCZWhhdmVzIGxpa2UgYW4gQXJyYXkncyBtZXRob2QsIG5vdCBsaWtlIGEgalF1ZXJ5IG1ldGhvZC4KCQlwdXNoOiBwdXNoLAoJCXNvcnQ6IGRlbGV0ZWRJZHMuc29ydCwKCQlzcGxpY2U6IGRlbGV0ZWRJZHMuc3BsaWNlCgl9OwoKCWpRdWVyeS5leHRlbmQgPSBqUXVlcnkuZm4uZXh0ZW5kID0gZnVuY3Rpb24oKSB7CgkJdmFyIHNyYywgY29weUlzQXJyYXksIGNvcHksIG5hbWUsIG9wdGlvbnMsIGNsb25lLAoJCQl0YXJnZXQgPSBhcmd1bWVudHNbIDAgXSB8fCB7fSwKCQkJaSA9IDEsCgkJCWxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsCgkJCWRlZXAgPSBmYWxzZTsKCgkJLy8gSGFuZGxlIGEgZGVlcCBjb3B5IHNpdHVhdGlvbgoJCWlmICggdHlwZW9mIHRhcmdldCA9PT0gImJvb2xlYW4iICkgewoJCQlkZWVwID0gdGFyZ2V0OwoKCQkJLy8gc2tpcCB0aGUgYm9vbGVhbiBhbmQgdGhlIHRhcmdldAoJCQl0YXJnZXQgPSBhcmd1bWVudHNbIGkgXSB8fCB7fTsKCQkJaSsrOwoJCX0KCgkJLy8gSGFuZGxlIGNhc2Ugd2hlbiB0YXJnZXQgaXMgYSBzdHJpbmcgb3Igc29tZXRoaW5nIChwb3NzaWJsZSBpbiBkZWVwIGNvcHkpCgkJaWYgKCB0eXBlb2YgdGFyZ2V0ICE9PSAib2JqZWN0IiAmJiAhalF1ZXJ5LmlzRnVuY3Rpb24oIHRhcmdldCApICkgewoJCQl0YXJnZXQgPSB7fTsKCQl9CgoJCS8vIGV4dGVuZCBqUXVlcnkgaXRzZWxmIGlmIG9ubHkgb25lIGFyZ3VtZW50IGlzIHBhc3NlZAoJCWlmICggaSA9PT0gbGVuZ3RoICkgewoJCQl0YXJnZXQgPSB0aGlzOwoJCQlpLS07CgkJfQoKCQlmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHsKCgkJCS8vIE9ubHkgZGVhbCB3aXRoIG5vbi1udWxsL3VuZGVmaW5lZCB2YWx1ZXMKCQkJaWYgKCAoIG9wdGlvbnMgPSBhcmd1bWVudHNbIGkgXSApICE9IG51bGwgKSB7CgoJCQkJLy8gRXh0ZW5kIHRoZSBiYXNlIG9iamVjdAoJCQkJZm9yICggbmFtZSBpbiBvcHRpb25zICkgewoJCQkJCXNyYyA9IHRhcmdldFsgbmFtZSBdOwoJCQkJCWNvcHkgPSBvcHRpb25zWyBuYW1lIF07CgoJCQkJCS8vIFByZXZlbnQgbmV2ZXItZW5kaW5nIGxvb3AKCQkJCQlpZiAoIHRhcmdldCA9PT0gY29weSApIHsKCQkJCQkJY29udGludWU7CgkJCQkJfQoKCQkJCQkvLyBSZWN1cnNlIGlmIHdlJ3JlIG1lcmdpbmcgcGxhaW4gb2JqZWN0cyBvciBhcnJheXMKCQkJCQlpZiAoIGRlZXAgJiYgY29weSAmJiAoIGpRdWVyeS5pc1BsYWluT2JqZWN0KCBjb3B5ICkgfHwKCQkJCQkJKCBjb3B5SXNBcnJheSA9IGpRdWVyeS5pc0FycmF5KCBjb3B5ICkgKSApICkgewoKCQkJCQkJaWYgKCBjb3B5SXNBcnJheSApIHsKCQkJCQkJCWNvcHlJc0FycmF5ID0gZmFsc2U7CgkJCQkJCQljbG9uZSA9IHNyYyAmJiBqUXVlcnkuaXNBcnJheSggc3JjICkgPyBzcmMgOiBbXTsKCgkJCQkJCX0gZWxzZSB7CgkJCQkJCQljbG9uZSA9IHNyYyAmJiBqUXVlcnkuaXNQbGFpbk9iamVjdCggc3JjICkgPyBzcmMgOiB7fTsKCQkJCQkJfQoKCQkJCQkJLy8gTmV2ZXIgbW92ZSBvcmlnaW5hbCBvYmplY3RzLCBjbG9uZSB0aGVtCgkJCQkJCXRhcmdldFsgbmFtZSBdID0galF1ZXJ5LmV4dGVuZCggZGVlcCwgY2xvbmUsIGNvcHkgKTsKCgkJCQkJLy8gRG9uJ3QgYnJpbmcgaW4gdW5kZWZpbmVkIHZhbHVlcwoJCQkJCX0gZWxzZSBpZiAoIGNvcHkgIT09IHVuZGVmaW5lZCApIHsKCQkJCQkJdGFyZ2V0WyBuYW1lIF0gPSBjb3B5OwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgkJLy8gUmV0dXJuIHRoZSBtb2RpZmllZCBvYmplY3QKCQlyZXR1cm4gdGFyZ2V0OwoJfTsKCglqUXVlcnkuZXh0ZW5kKCB7CgoJCS8vIFVuaXF1ZSBmb3IgZWFjaCBjb3B5IG9mIGpRdWVyeSBvbiB0aGUgcGFnZQoJCWV4cGFuZG86ICJqUXVlcnkiICsgKCB2ZXJzaW9uICsgTWF0aC5yYW5kb20oKSApLnJlcGxhY2UoIC9cRC9nLCAiIiApLAoKCQkvLyBBc3N1bWUgalF1ZXJ5IGlzIHJlYWR5IHdpdGhvdXQgdGhlIHJlYWR5IG1vZHVsZQoJCWlzUmVhZHk6IHRydWUsCgoJCWVycm9yOiBmdW5jdGlvbiggbXNnICkgewoJCQl0aHJvdyBuZXcgRXJyb3IoIG1zZyApOwoJCX0sCgoJCW5vb3A6IGZ1bmN0aW9uKCkge30sCgoJCS8vIFNlZSB0ZXN0L3VuaXQvY29yZS5qcyBmb3IgZGV0YWlscyBjb25jZXJuaW5nIGlzRnVuY3Rpb24uCgkJLy8gU2luY2UgdmVyc2lvbiAxLjMsIERPTSBtZXRob2RzIGFuZCBmdW5jdGlvbnMgbGlrZSBhbGVydAoJCS8vIGFyZW4ndCBzdXBwb3J0ZWQuIFRoZXkgcmV0dXJuIGZhbHNlIG9uIElFICgjMjk2OCkuCgkJaXNGdW5jdGlvbjogZnVuY3Rpb24oIG9iaiApIHsKCQkJcmV0dXJuIGpRdWVyeS50eXBlKCBvYmogKSA9PT0gImZ1bmN0aW9uIjsKCQl9LAoKCQlpc0FycmF5OiBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uKCBvYmogKSB7CgkJCXJldHVybiBqUXVlcnkudHlwZSggb2JqICkgPT09ICJhcnJheSI7CgkJfSwKCgkJaXNXaW5kb3c6IGZ1bmN0aW9uKCBvYmogKSB7CgkJCS8qIGpzaGludCBlcWVxZXE6IGZhbHNlICovCgkJCXJldHVybiBvYmogIT0gbnVsbCAmJiBvYmogPT0gb2JqLndpbmRvdzsKCQl9LAoKCQlpc051bWVyaWM6IGZ1bmN0aW9uKCBvYmogKSB7CgoJCQkvLyBwYXJzZUZsb2F0IE5hTnMgbnVtZXJpYy1jYXN0IGZhbHNlIHBvc2l0aXZlcyAobnVsbHx0cnVlfGZhbHNlfCIiKQoJCQkvLyAuLi5idXQgbWlzaW50ZXJwcmV0cyBsZWFkaW5nLW51bWJlciBzdHJpbmdzLCBwYXJ0aWN1bGFybHkgaGV4IGxpdGVyYWxzICgiMHguLi4iKQoJCQkvLyBzdWJ0cmFjdGlvbiBmb3JjZXMgaW5maW5pdGllcyB0byBOYU4KCQkJLy8gYWRkaW5nIDEgY29ycmVjdHMgbG9zcyBvZiBwcmVjaXNpb24gZnJvbSBwYXJzZUZsb2F0ICgjMTUxMDApCgkJCXZhciByZWFsU3RyaW5nT2JqID0gb2JqICYmIG9iai50b1N0cmluZygpOwoJCQlyZXR1cm4gIWpRdWVyeS5pc0FycmF5KCBvYmogKSAmJiAoIHJlYWxTdHJpbmdPYmogLSBwYXJzZUZsb2F0KCByZWFsU3RyaW5nT2JqICkgKyAxICkgPj0gMDsKCQl9LAoKCQlpc0VtcHR5T2JqZWN0OiBmdW5jdGlvbiggb2JqICkgewoJCQl2YXIgbmFtZTsKCQkJZm9yICggbmFtZSBpbiBvYmogKSB7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQkJcmV0dXJuIHRydWU7CgkJfSwKCgkJaXNQbGFpbk9iamVjdDogZnVuY3Rpb24oIG9iaiApIHsKCQkJdmFyIGtleTsKCgkJCS8vIE11c3QgYmUgYW4gT2JqZWN0LgoJCQkvLyBCZWNhdXNlIG9mIElFLCB3ZSBhbHNvIGhhdmUgdG8gY2hlY2sgdGhlIHByZXNlbmNlIG9mIHRoZSBjb25zdHJ1Y3RvciBwcm9wZXJ0eS4KCQkJLy8gTWFrZSBzdXJlIHRoYXQgRE9NIG5vZGVzIGFuZCB3aW5kb3cgb2JqZWN0cyBkb24ndCBwYXNzIHRocm91Z2gsIGFzIHdlbGwKCQkJaWYgKCAhb2JqIHx8IGpRdWVyeS50eXBlKCBvYmogKSAhPT0gIm9iamVjdCIgfHwgb2JqLm5vZGVUeXBlIHx8IGpRdWVyeS5pc1dpbmRvdyggb2JqICkgKSB7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCgkJCXRyeSB7CgoJCQkJLy8gTm90IG93biBjb25zdHJ1Y3RvciBwcm9wZXJ0eSBtdXN0IGJlIE9iamVjdAoJCQkJaWYgKCBvYmouY29uc3RydWN0b3IgJiYKCQkJCQkhaGFzT3duLmNhbGwoIG9iaiwgImNvbnN0cnVjdG9yIiApICYmCgkJCQkJIWhhc093bi5jYWxsKCBvYmouY29uc3RydWN0b3IucHJvdG90eXBlLCAiaXNQcm90b3R5cGVPZiIgKSApIHsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCX0gY2F0Y2ggKCBlICkgewoKCQkJCS8vIElFOCw5IFdpbGwgdGhyb3cgZXhjZXB0aW9ucyBvbiBjZXJ0YWluIGhvc3Qgb2JqZWN0cyAjOTg5NwoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCS8vIEhhbmRsZSBpdGVyYXRpb24gb3ZlciBpbmhlcml0ZWQgcHJvcGVydGllcyBiZWZvcmUgb3duIHByb3BlcnRpZXMuCgkJCWlmICggIXN1cHBvcnQub3duRmlyc3QgKSB7CgkJCQlmb3IgKCBrZXkgaW4gb2JqICkgewoJCQkJCXJldHVybiBoYXNPd24uY2FsbCggb2JqLCBrZXkgKTsKCQkJCX0KCQkJfQoKCQkJLy8gT3duIHByb3BlcnRpZXMgYXJlIGVudW1lcmF0ZWQgZmlyc3RseSwgc28gdG8gc3BlZWQgdXAsCgkJCS8vIGlmIGxhc3Qgb25lIGlzIG93biwgdGhlbiBhbGwgcHJvcGVydGllcyBhcmUgb3duLgoJCQlmb3IgKCBrZXkgaW4gb2JqICkge30KCgkJCXJldHVybiBrZXkgPT09IHVuZGVmaW5lZCB8fCBoYXNPd24uY2FsbCggb2JqLCBrZXkgKTsKCQl9LAoKCQl0eXBlOiBmdW5jdGlvbiggb2JqICkgewoJCQlpZiAoIG9iaiA9PSBudWxsICkgewoJCQkJcmV0dXJuIG9iaiArICIiOwoJCQl9CgkJCXJldHVybiB0eXBlb2Ygb2JqID09PSAib2JqZWN0IiB8fCB0eXBlb2Ygb2JqID09PSAiZnVuY3Rpb24iID8KCQkJCWNsYXNzMnR5cGVbIHRvU3RyaW5nLmNhbGwoIG9iaiApIF0gfHwgIm9iamVjdCIgOgoJCQkJdHlwZW9mIG9iajsKCQl9LAoKCQkvLyBXb3JrYXJvdW5kcyBiYXNlZCBvbiBmaW5kaW5ncyBieSBKaW0gRHJpc2NvbGwKCQkvLyBodHRwOi8vd2VibG9ncy5qYXZhLm5ldC9ibG9nL2RyaXNjb2xsL2FyY2hpdmUvMjAwOS8wOS8wOC9ldmFsLWphdmFzY3JpcHQtZ2xvYmFsLWNvbnRleHQKCQlnbG9iYWxFdmFsOiBmdW5jdGlvbiggZGF0YSApIHsKCQkJaWYgKCBkYXRhICYmIGpRdWVyeS50cmltKCBkYXRhICkgKSB7CgoJCQkJLy8gV2UgdXNlIGV4ZWNTY3JpcHQgb24gSW50ZXJuZXQgRXhwbG9yZXIKCQkJCS8vIFdlIHVzZSBhbiBhbm9ueW1vdXMgZnVuY3Rpb24gc28gdGhhdCBjb250ZXh0IGlzIHdpbmRvdwoJCQkJLy8gcmF0aGVyIHRoYW4galF1ZXJ5IGluIEZpcmVmb3gKCQkJCSggd2luZG93LmV4ZWNTY3JpcHQgfHwgZnVuY3Rpb24oIGRhdGEgKSB7CgkJCQkJd2luZG93WyAiZXZhbCIgXS5jYWxsKCB3aW5kb3csIGRhdGEgKTsgLy8ganNjczppZ25vcmUgcmVxdWlyZURvdE5vdGF0aW9uCgkJCQl9ICkoIGRhdGEgKTsKCQkJfQoJCX0sCgoJCS8vIENvbnZlcnQgZGFzaGVkIHRvIGNhbWVsQ2FzZTsgdXNlZCBieSB0aGUgY3NzIGFuZCBkYXRhIG1vZHVsZXMKCQkvLyBNaWNyb3NvZnQgZm9yZ290IHRvIGh1bXAgdGhlaXIgdmVuZG9yIHByZWZpeCAoIzk1NzIpCgkJY2FtZWxDYXNlOiBmdW5jdGlvbiggc3RyaW5nICkgewoJCQlyZXR1cm4gc3RyaW5nLnJlcGxhY2UoIHJtc1ByZWZpeCwgIm1zLSIgKS5yZXBsYWNlKCByZGFzaEFscGhhLCBmY2FtZWxDYXNlICk7CgkJfSwKCgkJbm9kZU5hbWU6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkgewoJCQlyZXR1cm4gZWxlbS5ub2RlTmFtZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5hbWUudG9Mb3dlckNhc2UoKTsKCQl9LAoKCQllYWNoOiBmdW5jdGlvbiggb2JqLCBjYWxsYmFjayApIHsKCQkJdmFyIGxlbmd0aCwgaSA9IDA7CgoJCQlpZiAoIGlzQXJyYXlMaWtlKCBvYmogKSApIHsKCQkJCWxlbmd0aCA9IG9iai5sZW5ndGg7CgkJCQlmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHsKCQkJCQlpZiAoIGNhbGxiYWNrLmNhbGwoIG9ialsgaSBdLCBpLCBvYmpbIGkgXSApID09PSBmYWxzZSApIHsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJfQoJCQl9IGVsc2UgewoJCQkJZm9yICggaSBpbiBvYmogKSB7CgkJCQkJaWYgKCBjYWxsYmFjay5jYWxsKCBvYmpbIGkgXSwgaSwgb2JqWyBpIF0gKSA9PT0gZmFsc2UgKSB7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIG9iajsKCQl9LAoKCQkvLyBTdXBwb3J0OiBBbmRyb2lkPDQuMSwgSUU8OQoJCXRyaW06IGZ1bmN0aW9uKCB0ZXh0ICkgewoJCQlyZXR1cm4gdGV4dCA9PSBudWxsID8KCQkJCSIiIDoKCQkJCSggdGV4dCArICIiICkucmVwbGFjZSggcnRyaW0sICIiICk7CgkJfSwKCgkJLy8gcmVzdWx0cyBpcyBmb3IgaW50ZXJuYWwgdXNhZ2Ugb25seQoJCW1ha2VBcnJheTogZnVuY3Rpb24oIGFyciwgcmVzdWx0cyApIHsKCQkJdmFyIHJldCA9IHJlc3VsdHMgfHwgW107CgoJCQlpZiAoIGFyciAhPSBudWxsICkgewoJCQkJaWYgKCBpc0FycmF5TGlrZSggT2JqZWN0KCBhcnIgKSApICkgewoJCQkJCWpRdWVyeS5tZXJnZSggcmV0LAoJCQkJCQl0eXBlb2YgYXJyID09PSAic3RyaW5nIiA/CgkJCQkJCVsgYXJyIF0gOiBhcnIKCQkJCQkpOwoJCQkJfSBlbHNlIHsKCQkJCQlwdXNoLmNhbGwoIHJldCwgYXJyICk7CgkJCQl9CgkJCX0KCgkJCXJldHVybiByZXQ7CgkJfSwKCgkJaW5BcnJheTogZnVuY3Rpb24oIGVsZW0sIGFyciwgaSApIHsKCQkJdmFyIGxlbjsKCgkJCWlmICggYXJyICkgewoJCQkJaWYgKCBpbmRleE9mICkgewoJCQkJCXJldHVybiBpbmRleE9mLmNhbGwoIGFyciwgZWxlbSwgaSApOwoJCQkJfQoKCQkJCWxlbiA9IGFyci5sZW5ndGg7CgkJCQlpID0gaSA/IGkgPCAwID8gTWF0aC5tYXgoIDAsIGxlbiArIGkgKSA6IGkgOiAwOwoKCQkJCWZvciAoIDsgaSA8IGxlbjsgaSsrICkgewoKCQkJCQkvLyBTa2lwIGFjY2Vzc2luZyBpbiBzcGFyc2UgYXJyYXlzCgkJCQkJaWYgKCBpIGluIGFyciAmJiBhcnJbIGkgXSA9PT0gZWxlbSApIHsKCQkJCQkJcmV0dXJuIGk7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gLTE7CgkJfSwKCgkJbWVyZ2U6IGZ1bmN0aW9uKCBmaXJzdCwgc2Vjb25kICkgewoJCQl2YXIgbGVuID0gK3NlY29uZC5sZW5ndGgsCgkJCQlqID0gMCwKCQkJCWkgPSBmaXJzdC5sZW5ndGg7CgoJCQl3aGlsZSAoIGogPCBsZW4gKSB7CgkJCQlmaXJzdFsgaSsrIF0gPSBzZWNvbmRbIGorKyBdOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCS8vIFdvcmthcm91bmQgY2FzdGluZyBvZiAubGVuZ3RoIHRvIE5hTiBvbiBvdGhlcndpc2UgYXJyYXlsaWtlIG9iamVjdHMgKGUuZy4sIE5vZGVMaXN0cykKCQkJaWYgKCBsZW4gIT09IGxlbiApIHsKCQkJCXdoaWxlICggc2Vjb25kWyBqIF0gIT09IHVuZGVmaW5lZCApIHsKCQkJCQlmaXJzdFsgaSsrIF0gPSBzZWNvbmRbIGorKyBdOwoJCQkJfQoJCQl9CgoJCQlmaXJzdC5sZW5ndGggPSBpOwoKCQkJcmV0dXJuIGZpcnN0OwoJCX0sCgoJCWdyZXA6IGZ1bmN0aW9uKCBlbGVtcywgY2FsbGJhY2ssIGludmVydCApIHsKCQkJdmFyIGNhbGxiYWNrSW52ZXJzZSwKCQkJCW1hdGNoZXMgPSBbXSwKCQkJCWkgPSAwLAoJCQkJbGVuZ3RoID0gZWxlbXMubGVuZ3RoLAoJCQkJY2FsbGJhY2tFeHBlY3QgPSAhaW52ZXJ0OwoKCQkJLy8gR28gdGhyb3VnaCB0aGUgYXJyYXksIG9ubHkgc2F2aW5nIHRoZSBpdGVtcwoJCQkvLyB0aGF0IHBhc3MgdGhlIHZhbGlkYXRvciBmdW5jdGlvbgoJCQlmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHsKCQkJCWNhbGxiYWNrSW52ZXJzZSA9ICFjYWxsYmFjayggZWxlbXNbIGkgXSwgaSApOwoJCQkJaWYgKCBjYWxsYmFja0ludmVyc2UgIT09IGNhbGxiYWNrRXhwZWN0ICkgewoJCQkJCW1hdGNoZXMucHVzaCggZWxlbXNbIGkgXSApOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gbWF0Y2hlczsKCQl9LAoKCQkvLyBhcmcgaXMgZm9yIGludGVybmFsIHVzYWdlIG9ubHkKCQltYXA6IGZ1bmN0aW9uKCBlbGVtcywgY2FsbGJhY2ssIGFyZyApIHsKCQkJdmFyIGxlbmd0aCwgdmFsdWUsCgkJCQlpID0gMCwKCQkJCXJldCA9IFtdOwoKCQkJLy8gR28gdGhyb3VnaCB0aGUgYXJyYXksIHRyYW5zbGF0aW5nIGVhY2ggb2YgdGhlIGl0ZW1zIHRvIHRoZWlyIG5ldyB2YWx1ZXMKCQkJaWYgKCBpc0FycmF5TGlrZSggZWxlbXMgKSApIHsKCQkJCWxlbmd0aCA9IGVsZW1zLmxlbmd0aDsKCQkJCWZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkgewoJCQkJCXZhbHVlID0gY2FsbGJhY2soIGVsZW1zWyBpIF0sIGksIGFyZyApOwoKCQkJCQlpZiAoIHZhbHVlICE9IG51bGwgKSB7CgkJCQkJCXJldC5wdXNoKCB2YWx1ZSApOwoJCQkJCX0KCQkJCX0KCgkJCS8vIEdvIHRocm91Z2ggZXZlcnkga2V5IG9uIHRoZSBvYmplY3QsCgkJCX0gZWxzZSB7CgkJCQlmb3IgKCBpIGluIGVsZW1zICkgewoJCQkJCXZhbHVlID0gY2FsbGJhY2soIGVsZW1zWyBpIF0sIGksIGFyZyApOwoKCQkJCQlpZiAoIHZhbHVlICE9IG51bGwgKSB7CgkJCQkJCXJldC5wdXNoKCB2YWx1ZSApOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJLy8gRmxhdHRlbiBhbnkgbmVzdGVkIGFycmF5cwoJCQlyZXR1cm4gY29uY2F0LmFwcGx5KCBbXSwgcmV0ICk7CgkJfSwKCgkJLy8gQSBnbG9iYWwgR1VJRCBjb3VudGVyIGZvciBvYmplY3RzCgkJZ3VpZDogMSwKCgkJLy8gQmluZCBhIGZ1bmN0aW9uIHRvIGEgY29udGV4dCwgb3B0aW9uYWxseSBwYXJ0aWFsbHkgYXBwbHlpbmcgYW55CgkJLy8gYXJndW1lbnRzLgoJCXByb3h5OiBmdW5jdGlvbiggZm4sIGNvbnRleHQgKSB7CgkJCXZhciBhcmdzLCBwcm94eSwgdG1wOwoKCQkJaWYgKCB0eXBlb2YgY29udGV4dCA9PT0gInN0cmluZyIgKSB7CgkJCQl0bXAgPSBmblsgY29udGV4dCBdOwoJCQkJY29udGV4dCA9IGZuOwoJCQkJZm4gPSB0bXA7CgkJCX0KCgkJCS8vIFF1aWNrIGNoZWNrIHRvIGRldGVybWluZSBpZiB0YXJnZXQgaXMgY2FsbGFibGUsIGluIHRoZSBzcGVjCgkJCS8vIHRoaXMgdGhyb3dzIGEgVHlwZUVycm9yLCBidXQgd2Ugd2lsbCBqdXN0IHJldHVybiB1bmRlZmluZWQuCgkJCWlmICggIWpRdWVyeS5pc0Z1bmN0aW9uKCBmbiApICkgewoJCQkJcmV0dXJuIHVuZGVmaW5lZDsKCQkJfQoKCQkJLy8gU2ltdWxhdGVkIGJpbmQKCQkJYXJncyA9IHNsaWNlLmNhbGwoIGFyZ3VtZW50cywgMiApOwoJCQlwcm94eSA9IGZ1bmN0aW9uKCkgewoJCQkJcmV0dXJuIGZuLmFwcGx5KCBjb250ZXh0IHx8IHRoaXMsIGFyZ3MuY29uY2F0KCBzbGljZS5jYWxsKCBhcmd1bWVudHMgKSApICk7CgkJCX07CgoJCQkvLyBTZXQgdGhlIGd1aWQgb2YgdW5pcXVlIGhhbmRsZXIgdG8gdGhlIHNhbWUgb2Ygb3JpZ2luYWwgaGFuZGxlciwgc28gaXQgY2FuIGJlIHJlbW92ZWQKCQkJcHJveHkuZ3VpZCA9IGZuLmd1aWQgPSBmbi5ndWlkIHx8IGpRdWVyeS5ndWlkKys7CgoJCQlyZXR1cm4gcHJveHk7CgkJfSwKCgkJbm93OiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuICsoIG5ldyBEYXRlKCkgKTsKCQl9LAoKCQkvLyBqUXVlcnkuc3VwcG9ydCBpcyBub3QgdXNlZCBpbiBDb3JlIGJ1dCBvdGhlciBwcm9qZWN0cyBhdHRhY2ggdGhlaXIKCQkvLyBwcm9wZXJ0aWVzIHRvIGl0IHNvIGl0IG5lZWRzIHRvIGV4aXN0LgoJCXN1cHBvcnQ6IHN1cHBvcnQKCX0gKTsKCgkvLyBKU0hpbnQgd291bGQgZXJyb3Igb24gdGhpcyBjb2RlIGR1ZSB0byB0aGUgU3ltYm9sIG5vdCBiZWluZyBkZWZpbmVkIGluIEVTNS4KCS8vIERlZmluaW5nIHRoaXMgZ2xvYmFsIGluIC5qc2hpbnRyYyB3b3VsZCBjcmVhdGUgYSBkYW5nZXIgb2YgdXNpbmcgdGhlIGdsb2JhbAoJLy8gdW5ndWFyZGVkIGluIGFub3RoZXIgcGxhY2UsIGl0IHNlZW1zIHNhZmVyIHRvIGp1c3QgZGlzYWJsZSBKU0hpbnQgZm9yIHRoZXNlCgkvLyB0aHJlZSBsaW5lcy4KCS8qIGpzaGludCBpZ25vcmU6IHN0YXJ0ICovCglpZiAoIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgKSB7CgkJalF1ZXJ5LmZuWyBTeW1ib2wuaXRlcmF0b3IgXSA9IGRlbGV0ZWRJZHNbIFN5bWJvbC5pdGVyYXRvciBdOwoJfQoJLyoganNoaW50IGlnbm9yZTogZW5kICovCgoJLy8gUG9wdWxhdGUgdGhlIGNsYXNzMnR5cGUgbWFwCglqUXVlcnkuZWFjaCggIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QgRXJyb3IgU3ltYm9sIi5zcGxpdCggIiAiICksCglmdW5jdGlvbiggaSwgbmFtZSApIHsKCQljbGFzczJ0eXBlWyAiW29iamVjdCAiICsgbmFtZSArICJdIiBdID0gbmFtZS50b0xvd2VyQ2FzZSgpOwoJfSApOwoKCWZ1bmN0aW9uIGlzQXJyYXlMaWtlKCBvYmogKSB7CgoJCS8vIFN1cHBvcnQ6IGlPUyA4LjIgKG5vdCByZXByb2R1Y2libGUgaW4gc2ltdWxhdG9yKQoJCS8vIGBpbmAgY2hlY2sgdXNlZCB0byBwcmV2ZW50IEpJVCBlcnJvciAoZ2gtMjE0NSkKCQkvLyBoYXNPd24gaXNuJ3QgdXNlZCBoZXJlIGR1ZSB0byBmYWxzZSBuZWdhdGl2ZXMKCQkvLyByZWdhcmRpbmcgTm9kZWxpc3QgbGVuZ3RoIGluIElFCgkJdmFyIGxlbmd0aCA9ICEhb2JqICYmICJsZW5ndGgiIGluIG9iaiAmJiBvYmoubGVuZ3RoLAoJCQl0eXBlID0galF1ZXJ5LnR5cGUoIG9iaiApOwoKCQlpZiAoIHR5cGUgPT09ICJmdW5jdGlvbiIgfHwgalF1ZXJ5LmlzV2luZG93KCBvYmogKSApIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJcmV0dXJuIHR5cGUgPT09ICJhcnJheSIgfHwgbGVuZ3RoID09PSAwIHx8CgkJCXR5cGVvZiBsZW5ndGggPT09ICJudW1iZXIiICYmIGxlbmd0aCA+IDAgJiYgKCBsZW5ndGggLSAxICkgaW4gb2JqOwoJfQoJdmFyIFNpenpsZSA9CgkvKiEKCSAqIFNpenpsZSBDU1MgU2VsZWN0b3IgRW5naW5lIHYyLjIuMQoJICogaHR0cDovL3NpenpsZWpzLmNvbS8KCSAqCgkgKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycwoJICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlCgkgKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlCgkgKgoJICogRGF0ZTogMjAxNS0xMC0xNwoJICovCgkoZnVuY3Rpb24oIHdpbmRvdyApIHsKCgl2YXIgaSwKCQlzdXBwb3J0LAoJCUV4cHIsCgkJZ2V0VGV4dCwKCQlpc1hNTCwKCQl0b2tlbml6ZSwKCQljb21waWxlLAoJCXNlbGVjdCwKCQlvdXRlcm1vc3RDb250ZXh0LAoJCXNvcnRJbnB1dCwKCQloYXNEdXBsaWNhdGUsCgoJCS8vIExvY2FsIGRvY3VtZW50IHZhcnMKCQlzZXREb2N1bWVudCwKCQlkb2N1bWVudCwKCQlkb2NFbGVtLAoJCWRvY3VtZW50SXNIVE1MLAoJCXJidWdneVFTQSwKCQlyYnVnZ3lNYXRjaGVzLAoJCW1hdGNoZXMsCgkJY29udGFpbnMsCgoJCS8vIEluc3RhbmNlLXNwZWNpZmljIGRhdGEKCQlleHBhbmRvID0gInNpenpsZSIgKyAxICogbmV3IERhdGUoKSwKCQlwcmVmZXJyZWREb2MgPSB3aW5kb3cuZG9jdW1lbnQsCgkJZGlycnVucyA9IDAsCgkJZG9uZSA9IDAsCgkJY2xhc3NDYWNoZSA9IGNyZWF0ZUNhY2hlKCksCgkJdG9rZW5DYWNoZSA9IGNyZWF0ZUNhY2hlKCksCgkJY29tcGlsZXJDYWNoZSA9IGNyZWF0ZUNhY2hlKCksCgkJc29ydE9yZGVyID0gZnVuY3Rpb24oIGEsIGIgKSB7CgkJCWlmICggYSA9PT0gYiApIHsKCQkJCWhhc0R1cGxpY2F0ZSA9IHRydWU7CgkJCX0KCQkJcmV0dXJuIDA7CgkJfSwKCgkJLy8gR2VuZXJhbC1wdXJwb3NlIGNvbnN0YW50cwoJCU1BWF9ORUdBVElWRSA9IDEgPDwgMzEsCgoJCS8vIEluc3RhbmNlIG1ldGhvZHMKCQloYXNPd24gPSAoe30pLmhhc093blByb3BlcnR5LAoJCWFyciA9IFtdLAoJCXBvcCA9IGFyci5wb3AsCgkJcHVzaF9uYXRpdmUgPSBhcnIucHVzaCwKCQlwdXNoID0gYXJyLnB1c2gsCgkJc2xpY2UgPSBhcnIuc2xpY2UsCgkJLy8gVXNlIGEgc3RyaXBwZWQtZG93biBpbmRleE9mIGFzIGl0J3MgZmFzdGVyIHRoYW4gbmF0aXZlCgkJLy8gaHR0cDovL2pzcGVyZi5jb20vdGhvci1pbmRleG9mLXZzLWZvci81CgkJaW5kZXhPZiA9IGZ1bmN0aW9uKCBsaXN0LCBlbGVtICkgewoJCQl2YXIgaSA9IDAsCgkJCQlsZW4gPSBsaXN0Lmxlbmd0aDsKCQkJZm9yICggOyBpIDwgbGVuOyBpKysgKSB7CgkJCQlpZiAoIGxpc3RbaV0gPT09IGVsZW0gKSB7CgkJCQkJcmV0dXJuIGk7CgkJCQl9CgkJCX0KCQkJcmV0dXJuIC0xOwoJCX0sCgoJCWJvb2xlYW5zID0gImNoZWNrZWR8c2VsZWN0ZWR8YXN5bmN8YXV0b2ZvY3VzfGF1dG9wbGF5fGNvbnRyb2xzfGRlZmVyfGRpc2FibGVkfGhpZGRlbnxpc21hcHxsb29wfG11bHRpcGxlfG9wZW58cmVhZG9ubHl8cmVxdWlyZWR8c2NvcGVkIiwKCgkJLy8gUmVndWxhciBleHByZXNzaW9ucwoKCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXNlbGVjdG9ycy8jd2hpdGVzcGFjZQoJCXdoaXRlc3BhY2UgPSAiW1xceDIwXFx0XFxyXFxuXFxmXSIsCgoJCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIxL3N5bmRhdGEuaHRtbCN2YWx1ZS1kZWYtaWRlbnRpZmllcgoJCWlkZW50aWZpZXIgPSAiKD86XFxcXC58W1xcdy1dfFteXFx4MDAtXFx4YTBdKSsiLAoKCQkvLyBBdHRyaWJ1dGUgc2VsZWN0b3JzOiBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI2F0dHJpYnV0ZS1zZWxlY3RvcnMKCQlhdHRyaWJ1dGVzID0gIlxcWyIgKyB3aGl0ZXNwYWNlICsgIiooIiArIGlkZW50aWZpZXIgKyAiKSg/OiIgKyB3aGl0ZXNwYWNlICsKCQkJLy8gT3BlcmF0b3IgKGNhcHR1cmUgMikKCQkJIiooWypeJHwhfl0/PSkiICsgd2hpdGVzcGFjZSArCgkJCS8vICJBdHRyaWJ1dGUgdmFsdWVzIG11c3QgYmUgQ1NTIGlkZW50aWZpZXJzIFtjYXB0dXJlIDVdIG9yIHN0cmluZ3MgW2NhcHR1cmUgMyBvciBjYXB0dXJlIDRdIgoJCQkiKig/OicoKD86XFxcXC58W15cXFxcJ10pKiknfFwiKCg/OlxcXFwufFteXFxcXFwiXSkqKVwifCgiICsgaWRlbnRpZmllciArICIpKXwpIiArIHdoaXRlc3BhY2UgKwoJCQkiKlxcXSIsCgoJCXBzZXVkb3MgPSAiOigiICsgaWRlbnRpZmllciArICIpKD86XFwoKCIgKwoJCQkvLyBUbyByZWR1Y2UgdGhlIG51bWJlciBvZiBzZWxlY3RvcnMgbmVlZGluZyB0b2tlbml6ZSBpbiB0aGUgcHJlRmlsdGVyLCBwcmVmZXIgYXJndW1lbnRzOgoJCQkvLyAxLiBxdW90ZWQgKGNhcHR1cmUgMzsgY2FwdHVyZSA0IG9yIGNhcHR1cmUgNSkKCQkJIignKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcIil8IiArCgkJCS8vIDIuIHNpbXBsZSAoY2FwdHVyZSA2KQoJCQkiKCg/OlxcXFwufFteXFxcXCgpW1xcXV18IiArIGF0dHJpYnV0ZXMgKyAiKSopfCIgKwoJCQkvLyAzLiBhbnl0aGluZyBlbHNlIChjYXB0dXJlIDIpCgkJCSIuKiIgKwoJCQkiKVxcKXwpIiwKCgkJLy8gTGVhZGluZyBhbmQgbm9uLWVzY2FwZWQgdHJhaWxpbmcgd2hpdGVzcGFjZSwgY2FwdHVyaW5nIHNvbWUgbm9uLXdoaXRlc3BhY2UgY2hhcmFjdGVycyBwcmVjZWRpbmcgdGhlIGxhdHRlcgoJCXJ3aGl0ZXNwYWNlID0gbmV3IFJlZ0V4cCggd2hpdGVzcGFjZSArICIrIiwgImciICksCgkJcnRyaW0gPSBuZXcgUmVnRXhwKCAiXiIgKyB3aGl0ZXNwYWNlICsgIit8KCg/Ol58W15cXFxcXSkoPzpcXFxcLikqKSIgKyB3aGl0ZXNwYWNlICsgIiskIiwgImciICksCgoJCXJjb21tYSA9IG5ldyBSZWdFeHAoICJeIiArIHdoaXRlc3BhY2UgKyAiKiwiICsgd2hpdGVzcGFjZSArICIqIiApLAoJCXJjb21iaW5hdG9ycyA9IG5ldyBSZWdFeHAoICJeIiArIHdoaXRlc3BhY2UgKyAiKihbPit+XXwiICsgd2hpdGVzcGFjZSArICIpIiArIHdoaXRlc3BhY2UgKyAiKiIgKSwKCgkJcmF0dHJpYnV0ZVF1b3RlcyA9IG5ldyBSZWdFeHAoICI9IiArIHdoaXRlc3BhY2UgKyAiKihbXlxcXSdcIl0qPykiICsgd2hpdGVzcGFjZSArICIqXFxdIiwgImciICksCgoJCXJwc2V1ZG8gPSBuZXcgUmVnRXhwKCBwc2V1ZG9zICksCgkJcmlkZW50aWZpZXIgPSBuZXcgUmVnRXhwKCAiXiIgKyBpZGVudGlmaWVyICsgIiQiICksCgoJCW1hdGNoRXhwciA9IHsKCQkJIklEIjogbmV3IFJlZ0V4cCggIl4jKCIgKyBpZGVudGlmaWVyICsgIikiICksCgkJCSJDTEFTUyI6IG5ldyBSZWdFeHAoICJeXFwuKCIgKyBpZGVudGlmaWVyICsgIikiICksCgkJCSJUQUciOiBuZXcgUmVnRXhwKCAiXigiICsgaWRlbnRpZmllciArICJ8WypdKSIgKSwKCQkJIkFUVFIiOiBuZXcgUmVnRXhwKCAiXiIgKyBhdHRyaWJ1dGVzICksCgkJCSJQU0VVRE8iOiBuZXcgUmVnRXhwKCAiXiIgKyBwc2V1ZG9zICksCgkJCSJDSElMRCI6IG5ldyBSZWdFeHAoICJeOihvbmx5fGZpcnN0fGxhc3R8bnRofG50aC1sYXN0KS0oY2hpbGR8b2YtdHlwZSkoPzpcXCgiICsgd2hpdGVzcGFjZSArCgkJCQkiKihldmVufG9kZHwoKFsrLV18KShcXGQqKW58KSIgKyB3aGl0ZXNwYWNlICsgIiooPzooWystXXwpIiArIHdoaXRlc3BhY2UgKwoJCQkJIiooXFxkKyl8KSkiICsgd2hpdGVzcGFjZSArICIqXFwpfCkiLCAiaSIgKSwKCQkJImJvb2wiOiBuZXcgUmVnRXhwKCAiXig/OiIgKyBib29sZWFucyArICIpJCIsICJpIiApLAoJCQkvLyBGb3IgdXNlIGluIGxpYnJhcmllcyBpbXBsZW1lbnRpbmcgLmlzKCkKCQkJLy8gV2UgdXNlIHRoaXMgZm9yIFBPUyBtYXRjaGluZyBpbiBgc2VsZWN0YAoJCQkibmVlZHNDb250ZXh0IjogbmV3IFJlZ0V4cCggIl4iICsgd2hpdGVzcGFjZSArICIqWz4rfl18OihldmVufG9kZHxlcXxndHxsdHxudGh8Zmlyc3R8bGFzdCkoPzpcXCgiICsKCQkJCXdoaXRlc3BhY2UgKyAiKigoPzotXFxkKT9cXGQqKSIgKyB3aGl0ZXNwYWNlICsgIipcXCl8KSg/PVteLV18JCkiLCAiaSIgKQoJCX0sCgoJCXJpbnB1dHMgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLAoJCXJoZWFkZXIgPSAvXmhcZCQvaSwKCgkJcm5hdGl2ZSA9IC9eW157XStce1xzKlxbbmF0aXZlIFx3LywKCgkJLy8gRWFzaWx5LXBhcnNlYWJsZS9yZXRyaWV2YWJsZSBJRCBvciBUQUcgb3IgQ0xBU1Mgc2VsZWN0b3JzCgkJcnF1aWNrRXhwciA9IC9eKD86IyhbXHctXSspfChcdyspfFwuKFtcdy1dKykpJC8sCgoJCXJzaWJsaW5nID0gL1srfl0vLAoJCXJlc2NhcGUgPSAvJ3xcXC9nLAoKCQkvLyBDU1MgZXNjYXBlcyBodHRwOi8vd3d3LnczLm9yZy9UUi9DU1MyMS9zeW5kYXRhLmh0bWwjZXNjYXBlZC1jaGFyYWN0ZXJzCgkJcnVuZXNjYXBlID0gbmV3IFJlZ0V4cCggIlxcXFwoW1xcZGEtZl17MSw2fSIgKyB3aGl0ZXNwYWNlICsgIj98KCIgKyB3aGl0ZXNwYWNlICsgIil8LikiLCAiaWciICksCgkJZnVuZXNjYXBlID0gZnVuY3Rpb24oIF8sIGVzY2FwZWQsIGVzY2FwZWRXaGl0ZXNwYWNlICkgewoJCQl2YXIgaGlnaCA9ICIweCIgKyBlc2NhcGVkIC0gMHgxMDAwMDsKCQkJLy8gTmFOIG1lYW5zIG5vbi1jb2RlcG9pbnQKCQkJLy8gU3VwcG9ydDogRmlyZWZveDwyNAoJCQkvLyBXb3JrYXJvdW5kIGVycm9uZW91cyBudW1lcmljIGludGVycHJldGF0aW9uIG9mICsiMHgiCgkJCXJldHVybiBoaWdoICE9PSBoaWdoIHx8IGVzY2FwZWRXaGl0ZXNwYWNlID8KCQkJCWVzY2FwZWQgOgoJCQkJaGlnaCA8IDAgPwoJCQkJCS8vIEJNUCBjb2RlcG9pbnQKCQkJCQlTdHJpbmcuZnJvbUNoYXJDb2RlKCBoaWdoICsgMHgxMDAwMCApIDoKCQkJCQkvLyBTdXBwbGVtZW50YWwgUGxhbmUgY29kZXBvaW50IChzdXJyb2dhdGUgcGFpcikKCQkJCQlTdHJpbmcuZnJvbUNoYXJDb2RlKCBoaWdoID4+IDEwIHwgMHhEODAwLCBoaWdoICYgMHgzRkYgfCAweERDMDAgKTsKCQl9LAoKCQkvLyBVc2VkIGZvciBpZnJhbWVzCgkJLy8gU2VlIHNldERvY3VtZW50KCkKCQkvLyBSZW1vdmluZyB0aGUgZnVuY3Rpb24gd3JhcHBlciBjYXVzZXMgYSAiUGVybWlzc2lvbiBEZW5pZWQiCgkJLy8gZXJyb3IgaW4gSUUKCQl1bmxvYWRIYW5kbGVyID0gZnVuY3Rpb24oKSB7CgkJCXNldERvY3VtZW50KCk7CgkJfTsKCgkvLyBPcHRpbWl6ZSBmb3IgcHVzaC5hcHBseSggXywgTm9kZUxpc3QgKQoJdHJ5IHsKCQlwdXNoLmFwcGx5KAoJCQkoYXJyID0gc2xpY2UuY2FsbCggcHJlZmVycmVkRG9jLmNoaWxkTm9kZXMgKSksCgkJCXByZWZlcnJlZERvYy5jaGlsZE5vZGVzCgkJKTsKCQkvLyBTdXBwb3J0OiBBbmRyb2lkPDQuMAoJCS8vIERldGVjdCBzaWxlbnRseSBmYWlsaW5nIHB1c2guYXBwbHkKCQlhcnJbIHByZWZlcnJlZERvYy5jaGlsZE5vZGVzLmxlbmd0aCBdLm5vZGVUeXBlOwoJfSBjYXRjaCAoIGUgKSB7CgkJcHVzaCA9IHsgYXBwbHk6IGFyci5sZW5ndGggPwoKCQkJLy8gTGV2ZXJhZ2Ugc2xpY2UgaWYgcG9zc2libGUKCQkJZnVuY3Rpb24oIHRhcmdldCwgZWxzICkgewoJCQkJcHVzaF9uYXRpdmUuYXBwbHkoIHRhcmdldCwgc2xpY2UuY2FsbChlbHMpICk7CgkJCX0gOgoKCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkvLyBPdGhlcndpc2UgYXBwZW5kIGRpcmVjdGx5CgkJCWZ1bmN0aW9uKCB0YXJnZXQsIGVscyApIHsKCQkJCXZhciBqID0gdGFyZ2V0Lmxlbmd0aCwKCQkJCQlpID0gMDsKCQkJCS8vIENhbid0IHRydXN0IE5vZGVMaXN0Lmxlbmd0aAoJCQkJd2hpbGUgKCAodGFyZ2V0W2orK10gPSBlbHNbaSsrXSkgKSB7fQoJCQkJdGFyZ2V0Lmxlbmd0aCA9IGogLSAxOwoJCQl9CgkJfTsKCX0KCglmdW5jdGlvbiBTaXp6bGUoIHNlbGVjdG9yLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkICkgewoJCXZhciBtLCBpLCBlbGVtLCBuaWQsIG5pZHNlbGVjdCwgbWF0Y2gsIGdyb3VwcywgbmV3U2VsZWN0b3IsCgkJCW5ld0NvbnRleHQgPSBjb250ZXh0ICYmIGNvbnRleHQub3duZXJEb2N1bWVudCwKCgkJCS8vIG5vZGVUeXBlIGRlZmF1bHRzIHRvIDksIHNpbmNlIGNvbnRleHQgZGVmYXVsdHMgdG8gZG9jdW1lbnQKCQkJbm9kZVR5cGUgPSBjb250ZXh0ID8gY29udGV4dC5ub2RlVHlwZSA6IDk7CgoJCXJlc3VsdHMgPSByZXN1bHRzIHx8IFtdOwoKCQkvLyBSZXR1cm4gZWFybHkgZnJvbSBjYWxscyB3aXRoIGludmFsaWQgc2VsZWN0b3Igb3IgY29udGV4dAoJCWlmICggdHlwZW9mIHNlbGVjdG9yICE9PSAic3RyaW5nIiB8fCAhc2VsZWN0b3IgfHwKCQkJbm9kZVR5cGUgIT09IDEgJiYgbm9kZVR5cGUgIT09IDkgJiYgbm9kZVR5cGUgIT09IDExICkgewoKCQkJcmV0dXJuIHJlc3VsdHM7CgkJfQoKCQkvLyBUcnkgdG8gc2hvcnRjdXQgZmluZCBvcGVyYXRpb25zIChhcyBvcHBvc2VkIHRvIGZpbHRlcnMpIGluIEhUTUwgZG9jdW1lbnRzCgkJaWYgKCAhc2VlZCApIHsKCgkJCWlmICggKCBjb250ZXh0ID8gY29udGV4dC5vd25lckRvY3VtZW50IHx8IGNvbnRleHQgOiBwcmVmZXJyZWREb2MgKSAhPT0gZG9jdW1lbnQgKSB7CgkJCQlzZXREb2N1bWVudCggY29udGV4dCApOwoJCQl9CgkJCWNvbnRleHQgPSBjb250ZXh0IHx8IGRvY3VtZW50OwoKCQkJaWYgKCBkb2N1bWVudElzSFRNTCApIHsKCgkJCQkvLyBJZiB0aGUgc2VsZWN0b3IgaXMgc3VmZmljaWVudGx5IHNpbXBsZSwgdHJ5IHVzaW5nIGEgImdldCpCeSoiIERPTSBtZXRob2QKCQkJCS8vIChleGNlcHRpbmcgRG9jdW1lbnRGcmFnbWVudCBjb250ZXh0LCB3aGVyZSB0aGUgbWV0aG9kcyBkb24ndCBleGlzdCkKCQkJCWlmICggbm9kZVR5cGUgIT09IDExICYmIChtYXRjaCA9IHJxdWlja0V4cHIuZXhlYyggc2VsZWN0b3IgKSkgKSB7CgoJCQkJCS8vIElEIHNlbGVjdG9yCgkJCQkJaWYgKCAobSA9IG1hdGNoWzFdKSApIHsKCgkJCQkJCS8vIERvY3VtZW50IGNvbnRleHQKCQkJCQkJaWYgKCBub2RlVHlwZSA9PT0gOSApIHsKCQkJCQkJCWlmICggKGVsZW0gPSBjb250ZXh0LmdldEVsZW1lbnRCeUlkKCBtICkpICkgewoKCQkJCQkJCQkvLyBTdXBwb3J0OiBJRSwgT3BlcmEsIFdlYmtpdAoJCQkJCQkJCS8vIFRPRE86IGlkZW50aWZ5IHZlcnNpb25zCgkJCQkJCQkJLy8gZ2V0RWxlbWVudEJ5SWQgY2FuIG1hdGNoIGVsZW1lbnRzIGJ5IG5hbWUgaW5zdGVhZCBvZiBJRAoJCQkJCQkJCWlmICggZWxlbS5pZCA9PT0gbSApIHsKCQkJCQkJCQkJcmVzdWx0cy5wdXNoKCBlbGVtICk7CgkJCQkJCQkJCXJldHVybiByZXN1bHRzOwoJCQkJCQkJCX0KCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJcmV0dXJuIHJlc3VsdHM7CgkJCQkJCQl9CgoJCQkJCQkvLyBFbGVtZW50IGNvbnRleHQKCQkJCQkJfSBlbHNlIHsKCgkJCQkJCQkvLyBTdXBwb3J0OiBJRSwgT3BlcmEsIFdlYmtpdAoJCQkJCQkJLy8gVE9ETzogaWRlbnRpZnkgdmVyc2lvbnMKCQkJCQkJCS8vIGdldEVsZW1lbnRCeUlkIGNhbiBtYXRjaCBlbGVtZW50cyBieSBuYW1lIGluc3RlYWQgb2YgSUQKCQkJCQkJCWlmICggbmV3Q29udGV4dCAmJiAoZWxlbSA9IG5ld0NvbnRleHQuZ2V0RWxlbWVudEJ5SWQoIG0gKSkgJiYKCQkJCQkJCQljb250YWlucyggY29udGV4dCwgZWxlbSApICYmCgkJCQkJCQkJZWxlbS5pZCA9PT0gbSApIHsKCgkJCQkJCQkJcmVzdWx0cy5wdXNoKCBlbGVtICk7CgkJCQkJCQkJcmV0dXJuIHJlc3VsdHM7CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJLy8gVHlwZSBzZWxlY3RvcgoJCQkJCX0gZWxzZSBpZiAoIG1hdGNoWzJdICkgewoJCQkJCQlwdXNoLmFwcGx5KCByZXN1bHRzLCBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCBzZWxlY3RvciApICk7CgkJCQkJCXJldHVybiByZXN1bHRzOwoKCQkJCQkvLyBDbGFzcyBzZWxlY3RvcgoJCQkJCX0gZWxzZSBpZiAoIChtID0gbWF0Y2hbM10pICYmIHN1cHBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSAmJgoJCQkJCQljb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgKSB7CgoJCQkJCQlwdXNoLmFwcGx5KCByZXN1bHRzLCBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoIG0gKSApOwoJCQkJCQlyZXR1cm4gcmVzdWx0czsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gVGFrZSBhZHZhbnRhZ2Ugb2YgcXVlcnlTZWxlY3RvckFsbAoJCQkJaWYgKCBzdXBwb3J0LnFzYSAmJgoJCQkJCSFjb21waWxlckNhY2hlWyBzZWxlY3RvciArICIgIiBdICYmCgkJCQkJKCFyYnVnZ3lRU0EgfHwgIXJidWdneVFTQS50ZXN0KCBzZWxlY3RvciApKSApIHsKCgkJCQkJaWYgKCBub2RlVHlwZSAhPT0gMSApIHsKCQkJCQkJbmV3Q29udGV4dCA9IGNvbnRleHQ7CgkJCQkJCW5ld1NlbGVjdG9yID0gc2VsZWN0b3I7CgoJCQkJCS8vIHFTQSBsb29rcyBvdXRzaWRlIEVsZW1lbnQgY29udGV4dCwgd2hpY2ggaXMgbm90IHdoYXQgd2Ugd2FudAoJCQkJCS8vIFRoYW5rcyB0byBBbmRyZXcgRHVwb250IGZvciB0aGlzIHdvcmthcm91bmQgdGVjaG5pcXVlCgkJCQkJLy8gU3VwcG9ydDogSUUgPD04CgkJCQkJLy8gRXhjbHVkZSBvYmplY3QgZWxlbWVudHMKCQkJCQl9IGVsc2UgaWYgKCBjb250ZXh0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICJvYmplY3QiICkgewoKCQkJCQkJLy8gQ2FwdHVyZSB0aGUgY29udGV4dCBJRCwgc2V0dGluZyBpdCBmaXJzdCBpZiBuZWNlc3NhcnkKCQkJCQkJaWYgKCAobmlkID0gY29udGV4dC5nZXRBdHRyaWJ1dGUoICJpZCIgKSkgKSB7CgkJCQkJCQluaWQgPSBuaWQucmVwbGFjZSggcmVzY2FwZSwgIlxcJCYiICk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQljb250ZXh0LnNldEF0dHJpYnV0ZSggImlkIiwgKG5pZCA9IGV4cGFuZG8pICk7CgkJCQkJCX0KCgkJCQkJCS8vIFByZWZpeCBldmVyeSBzZWxlY3RvciBpbiB0aGUgbGlzdAoJCQkJCQlncm91cHMgPSB0b2tlbml6ZSggc2VsZWN0b3IgKTsKCQkJCQkJaSA9IGdyb3Vwcy5sZW5ndGg7CgkJCQkJCW5pZHNlbGVjdCA9IHJpZGVudGlmaWVyLnRlc3QoIG5pZCApID8gIiMiICsgbmlkIDogIltpZD0nIiArIG5pZCArICInXSI7CgkJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQkJZ3JvdXBzW2ldID0gbmlkc2VsZWN0ICsgIiAiICsgdG9TZWxlY3RvciggZ3JvdXBzW2ldICk7CgkJCQkJCX0KCQkJCQkJbmV3U2VsZWN0b3IgPSBncm91cHMuam9pbiggIiwiICk7CgoJCQkJCQkvLyBFeHBhbmQgY29udGV4dCBmb3Igc2libGluZyBzZWxlY3RvcnMKCQkJCQkJbmV3Q29udGV4dCA9IHJzaWJsaW5nLnRlc3QoIHNlbGVjdG9yICkgJiYgdGVzdENvbnRleHQoIGNvbnRleHQucGFyZW50Tm9kZSApIHx8CgkJCQkJCQljb250ZXh0OwoJCQkJCX0KCgkJCQkJaWYgKCBuZXdTZWxlY3RvciApIHsKCQkJCQkJdHJ5IHsKCQkJCQkJCXB1c2guYXBwbHkoIHJlc3VsdHMsCgkJCQkJCQkJbmV3Q29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKCBuZXdTZWxlY3RvciApCgkJCQkJCQkpOwoJCQkJCQkJcmV0dXJuIHJlc3VsdHM7CgkJCQkJCX0gY2F0Y2ggKCBxc2FFcnJvciApIHsKCQkJCQkJfSBmaW5hbGx5IHsKCQkJCQkJCWlmICggbmlkID09PSBleHBhbmRvICkgewoJCQkJCQkJCWNvbnRleHQucmVtb3ZlQXR0cmlidXRlKCAiaWQiICk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCS8vIEFsbCBvdGhlcnMKCQlyZXR1cm4gc2VsZWN0KCBzZWxlY3Rvci5yZXBsYWNlKCBydHJpbSwgIiQxIiApLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkICk7Cgl9CgoJLyoqCgkgKiBDcmVhdGUga2V5LXZhbHVlIGNhY2hlcyBvZiBsaW1pdGVkIHNpemUKCSAqIEByZXR1cm5zIHtmdW5jdGlvbihzdHJpbmcsIG9iamVjdCl9IFJldHVybnMgdGhlIE9iamVjdCBkYXRhIGFmdGVyIHN0b3JpbmcgaXQgb24gaXRzZWxmIHdpdGgKCSAqCXByb3BlcnR5IG5hbWUgdGhlIChzcGFjZS1zdWZmaXhlZCkgc3RyaW5nIGFuZCAoaWYgdGhlIGNhY2hlIGlzIGxhcmdlciB0aGFuIEV4cHIuY2FjaGVMZW5ndGgpCgkgKglkZWxldGluZyB0aGUgb2xkZXN0IGVudHJ5CgkgKi8KCWZ1bmN0aW9uIGNyZWF0ZUNhY2hlKCkgewoJCXZhciBrZXlzID0gW107CgoJCWZ1bmN0aW9uIGNhY2hlKCBrZXksIHZhbHVlICkgewoJCQkvLyBVc2UgKGtleSArICIgIikgdG8gYXZvaWQgY29sbGlzaW9uIHdpdGggbmF0aXZlIHByb3RvdHlwZSBwcm9wZXJ0aWVzIChzZWUgSXNzdWUgIzE1NykKCQkJaWYgKCBrZXlzLnB1c2goIGtleSArICIgIiApID4gRXhwci5jYWNoZUxlbmd0aCApIHsKCQkJCS8vIE9ubHkga2VlcCB0aGUgbW9zdCByZWNlbnQgZW50cmllcwoJCQkJZGVsZXRlIGNhY2hlWyBrZXlzLnNoaWZ0KCkgXTsKCQkJfQoJCQlyZXR1cm4gKGNhY2hlWyBrZXkgKyAiICIgXSA9IHZhbHVlKTsKCQl9CgkJcmV0dXJuIGNhY2hlOwoJfQoKCS8qKgoJICogTWFyayBhIGZ1bmN0aW9uIGZvciBzcGVjaWFsIHVzZSBieSBTaXp6bGUKCSAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBtYXJrCgkgKi8KCWZ1bmN0aW9uIG1hcmtGdW5jdGlvbiggZm4gKSB7CgkJZm5bIGV4cGFuZG8gXSA9IHRydWU7CgkJcmV0dXJuIGZuOwoJfQoKCS8qKgoJICogU3VwcG9ydCB0ZXN0aW5nIHVzaW5nIGFuIGVsZW1lbnQKCSAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFBhc3NlZCB0aGUgY3JlYXRlZCBkaXYgYW5kIGV4cGVjdHMgYSBib29sZWFuIHJlc3VsdAoJICovCglmdW5jdGlvbiBhc3NlcnQoIGZuICkgewoJCXZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKCgkJdHJ5IHsKCQkJcmV0dXJuICEhZm4oIGRpdiApOwoJCX0gY2F0Y2ggKGUpIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0gZmluYWxseSB7CgkJCS8vIFJlbW92ZSBmcm9tIGl0cyBwYXJlbnQgYnkgZGVmYXVsdAoJCQlpZiAoIGRpdi5wYXJlbnROb2RlICkgewoJCQkJZGl2LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIGRpdiApOwoJCQl9CgkJCS8vIHJlbGVhc2UgbWVtb3J5IGluIElFCgkJCWRpdiA9IG51bGw7CgkJfQoJfQoKCS8qKgoJICogQWRkcyB0aGUgc2FtZSBoYW5kbGVyIGZvciBhbGwgb2YgdGhlIHNwZWNpZmllZCBhdHRycwoJICogQHBhcmFtIHtTdHJpbmd9IGF0dHJzIFBpcGUtc2VwYXJhdGVkIGxpc3Qgb2YgYXR0cmlidXRlcwoJICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlciBUaGUgbWV0aG9kIHRoYXQgd2lsbCBiZSBhcHBsaWVkCgkgKi8KCWZ1bmN0aW9uIGFkZEhhbmRsZSggYXR0cnMsIGhhbmRsZXIgKSB7CgkJdmFyIGFyciA9IGF0dHJzLnNwbGl0KCJ8IiksCgkJCWkgPSBhcnIubGVuZ3RoOwoKCQl3aGlsZSAoIGktLSApIHsKCQkJRXhwci5hdHRySGFuZGxlWyBhcnJbaV0gXSA9IGhhbmRsZXI7CgkJfQoJfQoKCS8qKgoJICogQ2hlY2tzIGRvY3VtZW50IG9yZGVyIG9mIHR3byBzaWJsaW5ncwoJICogQHBhcmFtIHtFbGVtZW50fSBhCgkgKiBAcGFyYW0ge0VsZW1lbnR9IGIKCSAqIEByZXR1cm5zIHtOdW1iZXJ9IFJldHVybnMgbGVzcyB0aGFuIDAgaWYgYSBwcmVjZWRlcyBiLCBncmVhdGVyIHRoYW4gMCBpZiBhIGZvbGxvd3MgYgoJICovCglmdW5jdGlvbiBzaWJsaW5nQ2hlY2soIGEsIGIgKSB7CgkJdmFyIGN1ciA9IGIgJiYgYSwKCQkJZGlmZiA9IGN1ciAmJiBhLm5vZGVUeXBlID09PSAxICYmIGIubm9kZVR5cGUgPT09IDEgJiYKCQkJCSggfmIuc291cmNlSW5kZXggfHwgTUFYX05FR0FUSVZFICkgLQoJCQkJKCB+YS5zb3VyY2VJbmRleCB8fCBNQVhfTkVHQVRJVkUgKTsKCgkJLy8gVXNlIElFIHNvdXJjZUluZGV4IGlmIGF2YWlsYWJsZSBvbiBib3RoIG5vZGVzCgkJaWYgKCBkaWZmICkgewoJCQlyZXR1cm4gZGlmZjsKCQl9CgoJCS8vIENoZWNrIGlmIGIgZm9sbG93cyBhCgkJaWYgKCBjdXIgKSB7CgkJCXdoaWxlICggKGN1ciA9IGN1ci5uZXh0U2libGluZykgKSB7CgkJCQlpZiAoIGN1ciA9PT0gYiApIHsKCQkJCQlyZXR1cm4gLTE7CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiBhID8gMSA6IC0xOwoJfQoKCS8qKgoJICogUmV0dXJucyBhIGZ1bmN0aW9uIHRvIHVzZSBpbiBwc2V1ZG9zIGZvciBpbnB1dCB0eXBlcwoJICogQHBhcmFtIHtTdHJpbmd9IHR5cGUKCSAqLwoJZnVuY3Rpb24gY3JlYXRlSW5wdXRQc2V1ZG8oIHR5cGUgKSB7CgkJcmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkgewoJCQl2YXIgbmFtZSA9IGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCQkJcmV0dXJuIG5hbWUgPT09ICJpbnB1dCIgJiYgZWxlbS50eXBlID09PSB0eXBlOwoJCX07Cgl9CgoJLyoqCgkgKiBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gdXNlIGluIHBzZXVkb3MgZm9yIGJ1dHRvbnMKCSAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlCgkgKi8KCWZ1bmN0aW9uIGNyZWF0ZUJ1dHRvblBzZXVkbyggdHlwZSApIHsKCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwoJCQlyZXR1cm4gKG5hbWUgPT09ICJpbnB1dCIgfHwgbmFtZSA9PT0gImJ1dHRvbiIpICYmIGVsZW0udHlwZSA9PT0gdHlwZTsKCQl9OwoJfQoKCS8qKgoJICogUmV0dXJucyBhIGZ1bmN0aW9uIHRvIHVzZSBpbiBwc2V1ZG9zIGZvciBwb3NpdGlvbmFscwoJICogQHBhcmFtIHtGdW5jdGlvbn0gZm4KCSAqLwoJZnVuY3Rpb24gY3JlYXRlUG9zaXRpb25hbFBzZXVkbyggZm4gKSB7CgkJcmV0dXJuIG1hcmtGdW5jdGlvbihmdW5jdGlvbiggYXJndW1lbnQgKSB7CgkJCWFyZ3VtZW50ID0gK2FyZ3VtZW50OwoJCQlyZXR1cm4gbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWVkLCBtYXRjaGVzICkgewoJCQkJdmFyIGosCgkJCQkJbWF0Y2hJbmRleGVzID0gZm4oIFtdLCBzZWVkLmxlbmd0aCwgYXJndW1lbnQgKSwKCQkJCQlpID0gbWF0Y2hJbmRleGVzLmxlbmd0aDsKCgkJCQkvLyBNYXRjaCBlbGVtZW50cyBmb3VuZCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4ZXMKCQkJCXdoaWxlICggaS0tICkgewoJCQkJCWlmICggc2VlZFsgKGogPSBtYXRjaEluZGV4ZXNbaV0pIF0gKSB7CgkJCQkJCXNlZWRbal0gPSAhKG1hdGNoZXNbal0gPSBzZWVkW2pdKTsKCQkJCQl9CgkJCQl9CgkJCX0pOwoJCX0pOwoJfQoKCS8qKgoJICogQ2hlY2tzIGEgbm9kZSBmb3IgdmFsaWRpdHkgYXMgYSBTaXp6bGUgY29udGV4dAoJICogQHBhcmFtIHtFbGVtZW50fE9iamVjdD19IGNvbnRleHQKCSAqIEByZXR1cm5zIHtFbGVtZW50fE9iamVjdHxCb29sZWFufSBUaGUgaW5wdXQgbm9kZSBpZiBhY2NlcHRhYmxlLCBvdGhlcndpc2UgYSBmYWxzeSB2YWx1ZQoJICovCglmdW5jdGlvbiB0ZXN0Q29udGV4dCggY29udGV4dCApIHsKCQlyZXR1cm4gY29udGV4dCAmJiB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gInVuZGVmaW5lZCIgJiYgY29udGV4dDsKCX0KCgkvLyBFeHBvc2Ugc3VwcG9ydCB2YXJzIGZvciBjb252ZW5pZW5jZQoJc3VwcG9ydCA9IFNpenpsZS5zdXBwb3J0ID0ge307CgoJLyoqCgkgKiBEZXRlY3RzIFhNTCBub2RlcwoJICogQHBhcmFtIHtFbGVtZW50fE9iamVjdH0gZWxlbSBBbiBlbGVtZW50IG9yIGEgZG9jdW1lbnQKCSAqIEByZXR1cm5zIHtCb29sZWFufSBUcnVlIGlmZiBlbGVtIGlzIGEgbm9uLUhUTUwgWE1MIG5vZGUKCSAqLwoJaXNYTUwgPSBTaXp6bGUuaXNYTUwgPSBmdW5jdGlvbiggZWxlbSApIHsKCQkvLyBkb2N1bWVudEVsZW1lbnQgaXMgdmVyaWZpZWQgZm9yIGNhc2VzIHdoZXJlIGl0IGRvZXNuJ3QgeWV0IGV4aXN0CgkJLy8gKHN1Y2ggYXMgbG9hZGluZyBpZnJhbWVzIGluIElFIC0gIzQ4MzMpCgkJdmFyIGRvY3VtZW50RWxlbWVudCA9IGVsZW0gJiYgKGVsZW0ub3duZXJEb2N1bWVudCB8fCBlbGVtKS5kb2N1bWVudEVsZW1lbnQ7CgkJcmV0dXJuIGRvY3VtZW50RWxlbWVudCA/IGRvY3VtZW50RWxlbWVudC5ub2RlTmFtZSAhPT0gIkhUTUwiIDogZmFsc2U7Cgl9OwoKCS8qKgoJICogU2V0cyBkb2N1bWVudC1yZWxhdGVkIHZhcmlhYmxlcyBvbmNlIGJhc2VkIG9uIHRoZSBjdXJyZW50IGRvY3VtZW50CgkgKiBAcGFyYW0ge0VsZW1lbnR8T2JqZWN0fSBbZG9jXSBBbiBlbGVtZW50IG9yIGRvY3VtZW50IG9iamVjdCB0byB1c2UgdG8gc2V0IHRoZSBkb2N1bWVudAoJICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgY3VycmVudCBkb2N1bWVudAoJICovCglzZXREb2N1bWVudCA9IFNpenpsZS5zZXREb2N1bWVudCA9IGZ1bmN0aW9uKCBub2RlICkgewoJCXZhciBoYXNDb21wYXJlLCBwYXJlbnQsCgkJCWRvYyA9IG5vZGUgPyBub2RlLm93bmVyRG9jdW1lbnQgfHwgbm9kZSA6IHByZWZlcnJlZERvYzsKCgkJLy8gUmV0dXJuIGVhcmx5IGlmIGRvYyBpcyBpbnZhbGlkIG9yIGFscmVhZHkgc2VsZWN0ZWQKCQlpZiAoIGRvYyA9PT0gZG9jdW1lbnQgfHwgZG9jLm5vZGVUeXBlICE9PSA5IHx8ICFkb2MuZG9jdW1lbnRFbGVtZW50ICkgewoJCQlyZXR1cm4gZG9jdW1lbnQ7CgkJfQoKCQkvLyBVcGRhdGUgZ2xvYmFsIHZhcmlhYmxlcwoJCWRvY3VtZW50ID0gZG9jOwoJCWRvY0VsZW0gPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CgkJZG9jdW1lbnRJc0hUTUwgPSAhaXNYTUwoIGRvY3VtZW50ICk7CgoJCS8vIFN1cHBvcnQ6IElFIDktMTEsIEVkZ2UKCQkvLyBBY2Nlc3NpbmcgaWZyYW1lIGRvY3VtZW50cyBhZnRlciB1bmxvYWQgdGhyb3dzICJwZXJtaXNzaW9uIGRlbmllZCIgZXJyb3JzIChqUXVlcnkgIzEzOTM2KQoJCWlmICggKHBhcmVudCA9IGRvY3VtZW50LmRlZmF1bHRWaWV3KSAmJiBwYXJlbnQudG9wICE9PSBwYXJlbnQgKSB7CgkJCS8vIFN1cHBvcnQ6IElFIDExCgkJCWlmICggcGFyZW50LmFkZEV2ZW50TGlzdGVuZXIgKSB7CgkJCQlwYXJlbnQuYWRkRXZlbnRMaXN0ZW5lciggInVubG9hZCIsIHVubG9hZEhhbmRsZXIsIGZhbHNlICk7CgoJCQkvLyBTdXBwb3J0OiBJRSA5IC0gMTAgb25seQoJCQl9IGVsc2UgaWYgKCBwYXJlbnQuYXR0YWNoRXZlbnQgKSB7CgkJCQlwYXJlbnQuYXR0YWNoRXZlbnQoICJvbnVubG9hZCIsIHVubG9hZEhhbmRsZXIgKTsKCQkJfQoJCX0KCgkJLyogQXR0cmlidXRlcwoJCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCgkJLy8gU3VwcG9ydDogSUU8OAoJCS8vIFZlcmlmeSB0aGF0IGdldEF0dHJpYnV0ZSByZWFsbHkgcmV0dXJucyBhdHRyaWJ1dGVzIGFuZCBub3QgcHJvcGVydGllcwoJCS8vIChleGNlcHRpbmcgSUU4IGJvb2xlYW5zKQoJCXN1cHBvcnQuYXR0cmlidXRlcyA9IGFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCQlkaXYuY2xhc3NOYW1lID0gImkiOwoJCQlyZXR1cm4gIWRpdi5nZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIpOwoJCX0pOwoKCQkvKiBnZXRFbGVtZW50KHMpQnkqCgkJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKCQkvLyBDaGVjayBpZiBnZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpIHJldHVybnMgb25seSBlbGVtZW50cwoJCXN1cHBvcnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgPSBhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHsKCQkJZGl2LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVDb21tZW50KCIiKSApOwoJCQlyZXR1cm4gIWRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLmxlbmd0aDsKCQl9KTsKCgkJLy8gU3VwcG9ydDogSUU8OQoJCXN1cHBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSA9IHJuYXRpdmUudGVzdCggZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSApOwoKCQkvLyBTdXBwb3J0OiBJRTwxMAoJCS8vIENoZWNrIGlmIGdldEVsZW1lbnRCeUlkIHJldHVybnMgZWxlbWVudHMgYnkgbmFtZQoJCS8vIFRoZSBicm9rZW4gZ2V0RWxlbWVudEJ5SWQgbWV0aG9kcyBkb24ndCBwaWNrIHVwIHByb2dyYW1hdGljYWxseS1zZXQgbmFtZXMsCgkJLy8gc28gdXNlIGEgcm91bmRhYm91dCBnZXRFbGVtZW50c0J5TmFtZSB0ZXN0CgkJc3VwcG9ydC5nZXRCeUlkID0gYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJCWRvY0VsZW0uYXBwZW5kQ2hpbGQoIGRpdiApLmlkID0gZXhwYW5kbzsKCQkJcmV0dXJuICFkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSB8fCAhZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIGV4cGFuZG8gKS5sZW5ndGg7CgkJfSk7CgoJCS8vIElEIGZpbmQgYW5kIGZpbHRlcgoJCWlmICggc3VwcG9ydC5nZXRCeUlkICkgewoJCQlFeHByLmZpbmRbIklEIl0gPSBmdW5jdGlvbiggaWQsIGNvbnRleHQgKSB7CgkJCQlpZiAoIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRCeUlkICE9PSAidW5kZWZpbmVkIiAmJiBkb2N1bWVudElzSFRNTCApIHsKCQkJCQl2YXIgbSA9IGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQoIGlkICk7CgkJCQkJcmV0dXJuIG0gPyBbIG0gXSA6IFtdOwoJCQkJfQoJCQl9OwoJCQlFeHByLmZpbHRlclsiSUQiXSA9IGZ1bmN0aW9uKCBpZCApIHsKCQkJCXZhciBhdHRySWQgPSBpZC5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApOwoJCQkJcmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCXJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSgiaWQiKSA9PT0gYXR0cklkOwoJCQkJfTsKCQkJfTsKCQl9IGVsc2UgewoJCQkvLyBTdXBwb3J0OiBJRTYvNwoJCQkvLyBnZXRFbGVtZW50QnlJZCBpcyBub3QgcmVsaWFibGUgYXMgYSBmaW5kIHNob3J0Y3V0CgkJCWRlbGV0ZSBFeHByLmZpbmRbIklEIl07CgoJCQlFeHByLmZpbHRlclsiSUQiXSA9ICBmdW5jdGlvbiggaWQgKSB7CgkJCQl2YXIgYXR0cklkID0gaWQucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKTsKCQkJCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCQl2YXIgbm9kZSA9IHR5cGVvZiBlbGVtLmdldEF0dHJpYnV0ZU5vZGUgIT09ICJ1bmRlZmluZWQiICYmCgkJCQkJCWVsZW0uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKTsKCQkJCQlyZXR1cm4gbm9kZSAmJiBub2RlLnZhbHVlID09PSBhdHRySWQ7CgkJCQl9OwoJCQl9OwoJCX0KCgkJLy8gVGFnCgkJRXhwci5maW5kWyJUQUciXSA9IHN1cHBvcnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgPwoJCQlmdW5jdGlvbiggdGFnLCBjb250ZXh0ICkgewoJCQkJaWYgKCB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gInVuZGVmaW5lZCIgKSB7CgkJCQkJcmV0dXJuIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIHRhZyApOwoKCQkJCS8vIERvY3VtZW50RnJhZ21lbnQgbm9kZXMgZG9uJ3QgaGF2ZSBnRUJUTgoJCQkJfSBlbHNlIGlmICggc3VwcG9ydC5xc2EgKSB7CgkJCQkJcmV0dXJuIGNvbnRleHQucXVlcnlTZWxlY3RvckFsbCggdGFnICk7CgkJCQl9CgkJCX0gOgoKCQkJZnVuY3Rpb24oIHRhZywgY29udGV4dCApIHsKCQkJCXZhciBlbGVtLAoJCQkJCXRtcCA9IFtdLAoJCQkJCWkgPSAwLAoJCQkJCS8vIEJ5IGhhcHB5IGNvaW5jaWRlbmNlLCBhIChicm9rZW4pIGdFQlROIGFwcGVhcnMgb24gRG9jdW1lbnRGcmFnbWVudCBub2RlcyB0b28KCQkJCQlyZXN1bHRzID0gY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSggdGFnICk7CgoJCQkJLy8gRmlsdGVyIG91dCBwb3NzaWJsZSBjb21tZW50cwoJCQkJaWYgKCB0YWcgPT09ICIqIiApIHsKCQkJCQl3aGlsZSAoIChlbGVtID0gcmVzdWx0c1tpKytdKSApIHsKCQkJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICkgewoJCQkJCQkJdG1wLnB1c2goIGVsZW0gKTsKCQkJCQkJfQoJCQkJCX0KCgkJCQkJcmV0dXJuIHRtcDsKCQkJCX0KCQkJCXJldHVybiByZXN1bHRzOwoJCQl9OwoKCQkvLyBDbGFzcwoJCUV4cHIuZmluZFsiQ0xBU1MiXSA9IHN1cHBvcnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSAmJiBmdW5jdGlvbiggY2xhc3NOYW1lLCBjb250ZXh0ICkgewoJCQlpZiAoIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgIT09ICJ1bmRlZmluZWQiICYmIGRvY3VtZW50SXNIVE1MICkgewoJCQkJcmV0dXJuIGNvbnRleHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSggY2xhc3NOYW1lICk7CgkJCX0KCQl9OwoKCQkvKiBRU0EvbWF0Y2hlc1NlbGVjdG9yCgkJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKCQkvLyBRU0EgYW5kIG1hdGNoZXNTZWxlY3RvciBzdXBwb3J0CgoJCS8vIG1hdGNoZXNTZWxlY3Rvcig6YWN0aXZlKSByZXBvcnRzIGZhbHNlIHdoZW4gdHJ1ZSAoSUU5L09wZXJhIDExLjUpCgkJcmJ1Z2d5TWF0Y2hlcyA9IFtdOwoKCQkvLyBxU2EoOmZvY3VzKSByZXBvcnRzIGZhbHNlIHdoZW4gdHJ1ZSAoQ2hyb21lIDIxKQoJCS8vIFdlIGFsbG93IHRoaXMgYmVjYXVzZSBvZiBhIGJ1ZyBpbiBJRTgvOSB0aGF0IHRocm93cyBhbiBlcnJvcgoJCS8vIHdoZW5ldmVyIGBkb2N1bWVudC5hY3RpdmVFbGVtZW50YCBpcyBhY2Nlc3NlZCBvbiBhbiBpZnJhbWUKCQkvLyBTbywgd2UgYWxsb3cgOmZvY3VzIHRvIHBhc3MgdGhyb3VnaCBRU0EgYWxsIHRoZSB0aW1lIHRvIGF2b2lkIHRoZSBJRSBlcnJvcgoJCS8vIFNlZSBodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC8xMzM3OAoJCXJidWdneVFTQSA9IFtdOwoKCQlpZiAoIChzdXBwb3J0LnFzYSA9IHJuYXRpdmUudGVzdCggZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCApKSApIHsKCQkJLy8gQnVpbGQgUVNBIHJlZ2V4CgkJCS8vIFJlZ2V4IHN0cmF0ZWd5IGFkb3B0ZWQgZnJvbSBEaWVnbyBQZXJpbmkKCQkJYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJCQkvLyBTZWxlY3QgaXMgc2V0IHRvIGVtcHR5IHN0cmluZyBvbiBwdXJwb3NlCgkJCQkvLyBUaGlzIGlzIHRvIHRlc3QgSUUncyB0cmVhdG1lbnQgb2Ygbm90IGV4cGxpY2l0bHkKCQkJCS8vIHNldHRpbmcgYSBib29sZWFuIGNvbnRlbnQgYXR0cmlidXRlLAoJCQkJLy8gc2luY2UgaXRzIHByZXNlbmNlIHNob3VsZCBiZSBlbm91Z2gKCQkJCS8vIGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzEyMzU5CgkJCQlkb2NFbGVtLmFwcGVuZENoaWxkKCBkaXYgKS5pbm5lckhUTUwgPSAiPGEgaWQ9JyIgKyBleHBhbmRvICsgIic+PC9hPiIgKwoJCQkJCSI8c2VsZWN0IGlkPSciICsgZXhwYW5kbyArICItXHJcXCcgbXNhbGxvd2NhcHR1cmU9Jyc+IiArCgkJCQkJIjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+IjsKCgkJCQkvLyBTdXBwb3J0OiBJRTgsIE9wZXJhIDExLTEyLjE2CgkJCQkvLyBOb3RoaW5nIHNob3VsZCBiZSBzZWxlY3RlZCB3aGVuIGVtcHR5IHN0cmluZ3MgZm9sbG93IF49IG9yICQ9IG9yICo9CgkJCQkvLyBUaGUgdGVzdCBhdHRyaWJ1dGUgbXVzdCBiZSB1bmtub3duIGluIE9wZXJhIGJ1dCAic2FmZSIgZm9yIFdpblJUCgkJCQkvLyBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvaWUvaGg0NjUzODguYXNweCNhdHRyaWJ1dGVfc2VjdGlvbgoJCQkJaWYgKCBkaXYucXVlcnlTZWxlY3RvckFsbCgiW21zYWxsb3djYXB0dXJlXj0nJ10iKS5sZW5ndGggKSB7CgkJCQkJcmJ1Z2d5UVNBLnB1c2goICJbKl4kXT0iICsgd2hpdGVzcGFjZSArICIqKD86Jyd8XCJcIikiICk7CgkJCQl9CgoJCQkJLy8gU3VwcG9ydDogSUU4CgkJCQkvLyBCb29sZWFuIGF0dHJpYnV0ZXMgYW5kICJ2YWx1ZSIgYXJlIG5vdCB0cmVhdGVkIGNvcnJlY3RseQoJCQkJaWYgKCAhZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIltzZWxlY3RlZF0iKS5sZW5ndGggKSB7CgkJCQkJcmJ1Z2d5UVNBLnB1c2goICJcXFsiICsgd2hpdGVzcGFjZSArICIqKD86dmFsdWV8IiArIGJvb2xlYW5zICsgIikiICk7CgkJCQl9CgoJCQkJLy8gU3VwcG9ydDogQ2hyb21lPDI5LCBBbmRyb2lkPDQuNCwgU2FmYXJpPDcuMCssIGlPUzw3LjArLCBQaGFudG9tSlM8MS45LjgrCgkJCQlpZiAoICFkaXYucXVlcnlTZWxlY3RvckFsbCggIltpZH49IiArIGV4cGFuZG8gKyAiLV0iICkubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCJ+PSIpOwoJCQkJfQoKCQkJCS8vIFdlYmtpdC9PcGVyYSAtIDpjaGVja2VkIHNob3VsZCByZXR1cm4gc2VsZWN0ZWQgb3B0aW9uIGVsZW1lbnRzCgkJCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi8yMDExL1JFQy1jc3MzLXNlbGVjdG9ycy0yMDExMDkyOS8jY2hlY2tlZAoJCQkJLy8gSUU4IHRocm93cyBlcnJvciBoZXJlIGFuZCB3aWxsIG5vdCBzZWUgbGF0ZXIgdGVzdHMKCQkJCWlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0aCApIHsKCQkJCQlyYnVnZ3lRU0EucHVzaCgiOmNoZWNrZWQiKTsKCQkJCX0KCgkJCQkvLyBTdXBwb3J0OiBTYWZhcmkgOCssIGlPUyA4KwoJCQkJLy8gaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTEzNjg1MQoJCQkJLy8gSW4tcGFnZSBgc2VsZWN0b3IjaWQgc2liaW5nLWNvbWJpbmF0b3Igc2VsZWN0b3JgIGZhaWxzCgkJCQlpZiAoICFkaXYucXVlcnlTZWxlY3RvckFsbCggImEjIiArIGV4cGFuZG8gKyAiKyoiICkubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCIuIy4rWyt+XSIpOwoJCQkJfQoJCQl9KTsKCgkJCWFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCQkJLy8gU3VwcG9ydDogV2luZG93cyA4IE5hdGl2ZSBBcHBzCgkJCQkvLyBUaGUgdHlwZSBhbmQgbmFtZSBhdHRyaWJ1dGVzIGFyZSByZXN0cmljdGVkIGR1cmluZyAuaW5uZXJIVE1MIGFzc2lnbm1lbnQKCQkJCXZhciBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7CgkJCQlpbnB1dC5zZXRBdHRyaWJ1dGUoICJ0eXBlIiwgImhpZGRlbiIgKTsKCQkJCWRpdi5hcHBlbmRDaGlsZCggaW5wdXQgKS5zZXRBdHRyaWJ1dGUoICJuYW1lIiwgIkQiICk7CgoJCQkJLy8gU3VwcG9ydDogSUU4CgkJCQkvLyBFbmZvcmNlIGNhc2Utc2Vuc2l0aXZpdHkgb2YgbmFtZSBhdHRyaWJ1dGUKCQkJCWlmICggZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIltuYW1lPWRdIikubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCAibmFtZSIgKyB3aGl0ZXNwYWNlICsgIipbKl4kfCF+XT89IiApOwoJCQkJfQoKCQkJCS8vIEZGIDMuNSAtIDplbmFibGVkLzpkaXNhYmxlZCBhbmQgaGlkZGVuIGVsZW1lbnRzIChoaWRkZW4gZWxlbWVudHMgYXJlIHN0aWxsIGVuYWJsZWQpCgkJCQkvLyBJRTggdGhyb3dzIGVycm9yIGhlcmUgYW5kIHdpbGwgbm90IHNlZSBsYXRlciB0ZXN0cwoJCQkJaWYgKCAhZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIjplbmFibGVkIikubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCAiOmVuYWJsZWQiLCAiOmRpc2FibGVkIiApOwoJCQkJfQoKCQkJCS8vIE9wZXJhIDEwLTExIGRvZXMgbm90IHRocm93IG9uIHBvc3QtY29tbWEgaW52YWxpZCBwc2V1ZG9zCgkJCQlkaXYucXVlcnlTZWxlY3RvckFsbCgiKiw6eCIpOwoJCQkJcmJ1Z2d5UVNBLnB1c2goIiwuKjoiKTsKCQkJfSk7CgkJfQoKCQlpZiAoIChzdXBwb3J0Lm1hdGNoZXNTZWxlY3RvciA9IHJuYXRpdmUudGVzdCggKG1hdGNoZXMgPSBkb2NFbGVtLm1hdGNoZXMgfHwKCQkJZG9jRWxlbS53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHwKCQkJZG9jRWxlbS5tb3pNYXRjaGVzU2VsZWN0b3IgfHwKCQkJZG9jRWxlbS5vTWF0Y2hlc1NlbGVjdG9yIHx8CgkJCWRvY0VsZW0ubXNNYXRjaGVzU2VsZWN0b3IpICkpICkgewoKCQkJYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJCQkvLyBDaGVjayB0byBzZWUgaWYgaXQncyBwb3NzaWJsZSB0byBkbyBtYXRjaGVzU2VsZWN0b3IKCQkJCS8vIG9uIGEgZGlzY29ubmVjdGVkIG5vZGUgKElFIDkpCgkJCQlzdXBwb3J0LmRpc2Nvbm5lY3RlZE1hdGNoID0gbWF0Y2hlcy5jYWxsKCBkaXYsICJkaXYiICk7CgoJCQkJLy8gVGhpcyBzaG91bGQgZmFpbCB3aXRoIGFuIGV4Y2VwdGlvbgoJCQkJLy8gR2Vja28gZG9lcyBub3QgZXJyb3IsIHJldHVybnMgZmFsc2UgaW5zdGVhZAoJCQkJbWF0Y2hlcy5jYWxsKCBkaXYsICJbcyE9JyddOngiICk7CgkJCQlyYnVnZ3lNYXRjaGVzLnB1c2goICIhPSIsIHBzZXVkb3MgKTsKCQkJfSk7CgkJfQoKCQlyYnVnZ3lRU0EgPSByYnVnZ3lRU0EubGVuZ3RoICYmIG5ldyBSZWdFeHAoIHJidWdneVFTQS5qb2luKCJ8IikgKTsKCQlyYnVnZ3lNYXRjaGVzID0gcmJ1Z2d5TWF0Y2hlcy5sZW5ndGggJiYgbmV3IFJlZ0V4cCggcmJ1Z2d5TWF0Y2hlcy5qb2luKCJ8IikgKTsKCgkJLyogQ29udGFpbnMKCQktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCgkJaGFzQ29tcGFyZSA9IHJuYXRpdmUudGVzdCggZG9jRWxlbS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiApOwoKCQkvLyBFbGVtZW50IGNvbnRhaW5zIGFub3RoZXIKCQkvLyBQdXJwb3NlZnVsbHkgc2VsZi1leGNsdXNpdmUKCQkvLyBBcyBpbiwgYW4gZWxlbWVudCBkb2VzIG5vdCBjb250YWluIGl0c2VsZgoJCWNvbnRhaW5zID0gaGFzQ29tcGFyZSB8fCBybmF0aXZlLnRlc3QoIGRvY0VsZW0uY29udGFpbnMgKSA/CgkJCWZ1bmN0aW9uKCBhLCBiICkgewoJCQkJdmFyIGFkb3duID0gYS5ub2RlVHlwZSA9PT0gOSA/IGEuZG9jdW1lbnRFbGVtZW50IDogYSwKCQkJCQlidXAgPSBiICYmIGIucGFyZW50Tm9kZTsKCQkJCXJldHVybiBhID09PSBidXAgfHwgISEoIGJ1cCAmJiBidXAubm9kZVR5cGUgPT09IDEgJiYgKAoJCQkJCWFkb3duLmNvbnRhaW5zID8KCQkJCQkJYWRvd24uY29udGFpbnMoIGJ1cCApIDoKCQkJCQkJYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiAmJiBhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKCBidXAgKSAmIDE2CgkJCQkpKTsKCQkJfSA6CgkJCWZ1bmN0aW9uKCBhLCBiICkgewoJCQkJaWYgKCBiICkgewoJCQkJCXdoaWxlICggKGIgPSBiLnBhcmVudE5vZGUpICkgewoJCQkJCQlpZiAoIGIgPT09IGEgKSB7CgkJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJCXJldHVybiBmYWxzZTsKCQkJfTsKCgkJLyogU29ydGluZwoJCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCgkJLy8gRG9jdW1lbnQgb3JkZXIgc29ydGluZwoJCXNvcnRPcmRlciA9IGhhc0NvbXBhcmUgPwoJCWZ1bmN0aW9uKCBhLCBiICkgewoKCQkJLy8gRmxhZyBmb3IgZHVwbGljYXRlIHJlbW92YWwKCQkJaWYgKCBhID09PSBiICkgewoJCQkJaGFzRHVwbGljYXRlID0gdHJ1ZTsKCQkJCXJldHVybiAwOwoJCQl9CgoJCQkvLyBTb3J0IG9uIG1ldGhvZCBleGlzdGVuY2UgaWYgb25seSBvbmUgaW5wdXQgaGFzIGNvbXBhcmVEb2N1bWVudFBvc2l0aW9uCgkJCXZhciBjb21wYXJlID0gIWEuY29tcGFyZURvY3VtZW50UG9zaXRpb24gLSAhYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbjsKCQkJaWYgKCBjb21wYXJlICkgewoJCQkJcmV0dXJuIGNvbXBhcmU7CgkJCX0KCgkJCS8vIENhbGN1bGF0ZSBwb3NpdGlvbiBpZiBib3RoIGlucHV0cyBiZWxvbmcgdG8gdGhlIHNhbWUgZG9jdW1lbnQKCQkJY29tcGFyZSA9ICggYS5vd25lckRvY3VtZW50IHx8IGEgKSA9PT0gKCBiLm93bmVyRG9jdW1lbnQgfHwgYiApID8KCQkJCWEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oIGIgKSA6CgoJCQkJLy8gT3RoZXJ3aXNlIHdlIGtub3cgdGhleSBhcmUgZGlzY29ubmVjdGVkCgkJCQkxOwoKCQkJLy8gRGlzY29ubmVjdGVkIG5vZGVzCgkJCWlmICggY29tcGFyZSAmIDEgfHwKCQkJCSghc3VwcG9ydC5zb3J0RGV0YWNoZWQgJiYgYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggYSApID09PSBjb21wYXJlKSApIHsKCgkJCQkvLyBDaG9vc2UgdGhlIGZpcnN0IGVsZW1lbnQgdGhhdCBpcyByZWxhdGVkIHRvIG91ciBwcmVmZXJyZWQgZG9jdW1lbnQKCQkJCWlmICggYSA9PT0gZG9jdW1lbnQgfHwgYS5vd25lckRvY3VtZW50ID09PSBwcmVmZXJyZWREb2MgJiYgY29udGFpbnMocHJlZmVycmVkRG9jLCBhKSApIHsKCQkJCQlyZXR1cm4gLTE7CgkJCQl9CgkJCQlpZiAoIGIgPT09IGRvY3VtZW50IHx8IGIub3duZXJEb2N1bWVudCA9PT0gcHJlZmVycmVkRG9jICYmIGNvbnRhaW5zKHByZWZlcnJlZERvYywgYikgKSB7CgkJCQkJcmV0dXJuIDE7CgkJCQl9CgoJCQkJLy8gTWFpbnRhaW4gb3JpZ2luYWwgb3JkZXIKCQkJCXJldHVybiBzb3J0SW5wdXQgPwoJCQkJCSggaW5kZXhPZiggc29ydElucHV0LCBhICkgLSBpbmRleE9mKCBzb3J0SW5wdXQsIGIgKSApIDoKCQkJCQkwOwoJCQl9CgoJCQlyZXR1cm4gY29tcGFyZSAmIDQgPyAtMSA6IDE7CgkJfSA6CgkJZnVuY3Rpb24oIGEsIGIgKSB7CgkJCS8vIEV4aXQgZWFybHkgaWYgdGhlIG5vZGVzIGFyZSBpZGVudGljYWwKCQkJaWYgKCBhID09PSBiICkgewoJCQkJaGFzRHVwbGljYXRlID0gdHJ1ZTsKCQkJCXJldHVybiAwOwoJCQl9CgoJCQl2YXIgY3VyLAoJCQkJaSA9IDAsCgkJCQlhdXAgPSBhLnBhcmVudE5vZGUsCgkJCQlidXAgPSBiLnBhcmVudE5vZGUsCgkJCQlhcCA9IFsgYSBdLAoJCQkJYnAgPSBbIGIgXTsKCgkJCS8vIFBhcmVudGxlc3Mgbm9kZXMgYXJlIGVpdGhlciBkb2N1bWVudHMgb3IgZGlzY29ubmVjdGVkCgkJCWlmICggIWF1cCB8fCAhYnVwICkgewoJCQkJcmV0dXJuIGEgPT09IGRvY3VtZW50ID8gLTEgOgoJCQkJCWIgPT09IGRvY3VtZW50ID8gMSA6CgkJCQkJYXVwID8gLTEgOgoJCQkJCWJ1cCA/IDEgOgoJCQkJCXNvcnRJbnB1dCA/CgkJCQkJKCBpbmRleE9mKCBzb3J0SW5wdXQsIGEgKSAtIGluZGV4T2YoIHNvcnRJbnB1dCwgYiApICkgOgoJCQkJCTA7CgoJCQkvLyBJZiB0aGUgbm9kZXMgYXJlIHNpYmxpbmdzLCB3ZSBjYW4gZG8gYSBxdWljayBjaGVjawoJCQl9IGVsc2UgaWYgKCBhdXAgPT09IGJ1cCApIHsKCQkJCXJldHVybiBzaWJsaW5nQ2hlY2soIGEsIGIgKTsKCQkJfQoKCQkJLy8gT3RoZXJ3aXNlIHdlIG5lZWQgZnVsbCBsaXN0cyBvZiB0aGVpciBhbmNlc3RvcnMgZm9yIGNvbXBhcmlzb24KCQkJY3VyID0gYTsKCQkJd2hpbGUgKCAoY3VyID0gY3VyLnBhcmVudE5vZGUpICkgewoJCQkJYXAudW5zaGlmdCggY3VyICk7CgkJCX0KCQkJY3VyID0gYjsKCQkJd2hpbGUgKCAoY3VyID0gY3VyLnBhcmVudE5vZGUpICkgewoJCQkJYnAudW5zaGlmdCggY3VyICk7CgkJCX0KCgkJCS8vIFdhbGsgZG93biB0aGUgdHJlZSBsb29raW5nIGZvciBhIGRpc2NyZXBhbmN5CgkJCXdoaWxlICggYXBbaV0gPT09IGJwW2ldICkgewoJCQkJaSsrOwoJCQl9CgoJCQlyZXR1cm4gaSA/CgkJCQkvLyBEbyBhIHNpYmxpbmcgY2hlY2sgaWYgdGhlIG5vZGVzIGhhdmUgYSBjb21tb24gYW5jZXN0b3IKCQkJCXNpYmxpbmdDaGVjayggYXBbaV0sIGJwW2ldICkgOgoKCQkJCS8vIE90aGVyd2lzZSBub2RlcyBpbiBvdXIgZG9jdW1lbnQgc29ydCBmaXJzdAoJCQkJYXBbaV0gPT09IHByZWZlcnJlZERvYyA/IC0xIDoKCQkJCWJwW2ldID09PSBwcmVmZXJyZWREb2MgPyAxIDoKCQkJCTA7CgkJfTsKCgkJcmV0dXJuIGRvY3VtZW50OwoJfTsKCglTaXp6bGUubWF0Y2hlcyA9IGZ1bmN0aW9uKCBleHByLCBlbGVtZW50cyApIHsKCQlyZXR1cm4gU2l6emxlKCBleHByLCBudWxsLCBudWxsLCBlbGVtZW50cyApOwoJfTsKCglTaXp6bGUubWF0Y2hlc1NlbGVjdG9yID0gZnVuY3Rpb24oIGVsZW0sIGV4cHIgKSB7CgkJLy8gU2V0IGRvY3VtZW50IHZhcnMgaWYgbmVlZGVkCgkJaWYgKCAoIGVsZW0ub3duZXJEb2N1bWVudCB8fCBlbGVtICkgIT09IGRvY3VtZW50ICkgewoJCQlzZXREb2N1bWVudCggZWxlbSApOwoJCX0KCgkJLy8gTWFrZSBzdXJlIHRoYXQgYXR0cmlidXRlIHNlbGVjdG9ycyBhcmUgcXVvdGVkCgkJZXhwciA9IGV4cHIucmVwbGFjZSggcmF0dHJpYnV0ZVF1b3RlcywgIj0nJDEnXSIgKTsKCgkJaWYgKCBzdXBwb3J0Lm1hdGNoZXNTZWxlY3RvciAmJiBkb2N1bWVudElzSFRNTCAmJgoJCQkhY29tcGlsZXJDYWNoZVsgZXhwciArICIgIiBdICYmCgkJCSggIXJidWdneU1hdGNoZXMgfHwgIXJidWdneU1hdGNoZXMudGVzdCggZXhwciApICkgJiYKCQkJKCAhcmJ1Z2d5UVNBICAgICB8fCAhcmJ1Z2d5UVNBLnRlc3QoIGV4cHIgKSApICkgewoKCQkJdHJ5IHsKCQkJCXZhciByZXQgPSBtYXRjaGVzLmNhbGwoIGVsZW0sIGV4cHIgKTsKCgkJCQkvLyBJRSA5J3MgbWF0Y2hlc1NlbGVjdG9yIHJldHVybnMgZmFsc2Ugb24gZGlzY29ubmVjdGVkIG5vZGVzCgkJCQlpZiAoIHJldCB8fCBzdXBwb3J0LmRpc2Nvbm5lY3RlZE1hdGNoIHx8CgkJCQkJCS8vIEFzIHdlbGwsIGRpc2Nvbm5lY3RlZCBub2RlcyBhcmUgc2FpZCB0byBiZSBpbiBhIGRvY3VtZW50CgkJCQkJCS8vIGZyYWdtZW50IGluIElFIDkKCQkJCQkJZWxlbS5kb2N1bWVudCAmJiBlbGVtLmRvY3VtZW50Lm5vZGVUeXBlICE9PSAxMSApIHsKCQkJCQlyZXR1cm4gcmV0OwoJCQkJfQoJCQl9IGNhdGNoIChlKSB7fQoJCX0KCgkJcmV0dXJuIFNpenpsZSggZXhwciwgZG9jdW1lbnQsIG51bGwsIFsgZWxlbSBdICkubGVuZ3RoID4gMDsKCX07CgoJU2l6emxlLmNvbnRhaW5zID0gZnVuY3Rpb24oIGNvbnRleHQsIGVsZW0gKSB7CgkJLy8gU2V0IGRvY3VtZW50IHZhcnMgaWYgbmVlZGVkCgkJaWYgKCAoIGNvbnRleHQub3duZXJEb2N1bWVudCB8fCBjb250ZXh0ICkgIT09IGRvY3VtZW50ICkgewoJCQlzZXREb2N1bWVudCggY29udGV4dCApOwoJCX0KCQlyZXR1cm4gY29udGFpbnMoIGNvbnRleHQsIGVsZW0gKTsKCX07CgoJU2l6emxlLmF0dHIgPSBmdW5jdGlvbiggZWxlbSwgbmFtZSApIHsKCQkvLyBTZXQgZG9jdW1lbnQgdmFycyBpZiBuZWVkZWQKCQlpZiAoICggZWxlbS5vd25lckRvY3VtZW50IHx8IGVsZW0gKSAhPT0gZG9jdW1lbnQgKSB7CgkJCXNldERvY3VtZW50KCBlbGVtICk7CgkJfQoKCQl2YXIgZm4gPSBFeHByLmF0dHJIYW5kbGVbIG5hbWUudG9Mb3dlckNhc2UoKSBdLAoJCQkvLyBEb24ndCBnZXQgZm9vbGVkIGJ5IE9iamVjdC5wcm90b3R5cGUgcHJvcGVydGllcyAoalF1ZXJ5ICMxMzgwNykKCQkJdmFsID0gZm4gJiYgaGFzT3duLmNhbGwoIEV4cHIuYXR0ckhhbmRsZSwgbmFtZS50b0xvd2VyQ2FzZSgpICkgPwoJCQkJZm4oIGVsZW0sIG5hbWUsICFkb2N1bWVudElzSFRNTCApIDoKCQkJCXVuZGVmaW5lZDsKCgkJcmV0dXJuIHZhbCAhPT0gdW5kZWZpbmVkID8KCQkJdmFsIDoKCQkJc3VwcG9ydC5hdHRyaWJ1dGVzIHx8ICFkb2N1bWVudElzSFRNTCA/CgkJCQllbGVtLmdldEF0dHJpYnV0ZSggbmFtZSApIDoKCQkJCSh2YWwgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUobmFtZSkpICYmIHZhbC5zcGVjaWZpZWQgPwoJCQkJCXZhbC52YWx1ZSA6CgkJCQkJbnVsbDsKCX07CgoJU2l6emxlLmVycm9yID0gZnVuY3Rpb24oIG1zZyApIHsKCQl0aHJvdyBuZXcgRXJyb3IoICJTeW50YXggZXJyb3IsIHVucmVjb2duaXplZCBleHByZXNzaW9uOiAiICsgbXNnICk7Cgl9OwoKCS8qKgoJICogRG9jdW1lbnQgc29ydGluZyBhbmQgcmVtb3ZpbmcgZHVwbGljYXRlcwoJICogQHBhcmFtIHtBcnJheUxpa2V9IHJlc3VsdHMKCSAqLwoJU2l6emxlLnVuaXF1ZVNvcnQgPSBmdW5jdGlvbiggcmVzdWx0cyApIHsKCQl2YXIgZWxlbSwKCQkJZHVwbGljYXRlcyA9IFtdLAoJCQlqID0gMCwKCQkJaSA9IDA7CgoJCS8vIFVubGVzcyB3ZSAqa25vdyogd2UgY2FuIGRldGVjdCBkdXBsaWNhdGVzLCBhc3N1bWUgdGhlaXIgcHJlc2VuY2UKCQloYXNEdXBsaWNhdGUgPSAhc3VwcG9ydC5kZXRlY3REdXBsaWNhdGVzOwoJCXNvcnRJbnB1dCA9ICFzdXBwb3J0LnNvcnRTdGFibGUgJiYgcmVzdWx0cy5zbGljZSggMCApOwoJCXJlc3VsdHMuc29ydCggc29ydE9yZGVyICk7CgoJCWlmICggaGFzRHVwbGljYXRlICkgewoJCQl3aGlsZSAoIChlbGVtID0gcmVzdWx0c1tpKytdKSApIHsKCQkJCWlmICggZWxlbSA9PT0gcmVzdWx0c1sgaSBdICkgewoJCQkJCWogPSBkdXBsaWNhdGVzLnB1c2goIGkgKTsKCQkJCX0KCQkJfQoJCQl3aGlsZSAoIGotLSApIHsKCQkJCXJlc3VsdHMuc3BsaWNlKCBkdXBsaWNhdGVzWyBqIF0sIDEgKTsKCQkJfQoJCX0KCgkJLy8gQ2xlYXIgaW5wdXQgYWZ0ZXIgc29ydGluZyB0byByZWxlYXNlIG9iamVjdHMKCQkvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9zaXp6bGUvcHVsbC8yMjUKCQlzb3J0SW5wdXQgPSBudWxsOwoKCQlyZXR1cm4gcmVzdWx0czsKCX07CgoJLyoqCgkgKiBVdGlsaXR5IGZ1bmN0aW9uIGZvciByZXRyaWV2aW5nIHRoZSB0ZXh0IHZhbHVlIG9mIGFuIGFycmF5IG9mIERPTSBub2RlcwoJICogQHBhcmFtIHtBcnJheXxFbGVtZW50fSBlbGVtCgkgKi8KCWdldFRleHQgPSBTaXp6bGUuZ2V0VGV4dCA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCXZhciBub2RlLAoJCQlyZXQgPSAiIiwKCQkJaSA9IDAsCgkJCW5vZGVUeXBlID0gZWxlbS5ub2RlVHlwZTsKCgkJaWYgKCAhbm9kZVR5cGUgKSB7CgkJCS8vIElmIG5vIG5vZGVUeXBlLCB0aGlzIGlzIGV4cGVjdGVkIHRvIGJlIGFuIGFycmF5CgkJCXdoaWxlICggKG5vZGUgPSBlbGVtW2krK10pICkgewoJCQkJLy8gRG8gbm90IHRyYXZlcnNlIGNvbW1lbnQgbm9kZXMKCQkJCXJldCArPSBnZXRUZXh0KCBub2RlICk7CgkJCX0KCQl9IGVsc2UgaWYgKCBub2RlVHlwZSA9PT0gMSB8fCBub2RlVHlwZSA9PT0gOSB8fCBub2RlVHlwZSA9PT0gMTEgKSB7CgkJCS8vIFVzZSB0ZXh0Q29udGVudCBmb3IgZWxlbWVudHMKCQkJLy8gaW5uZXJUZXh0IHVzYWdlIHJlbW92ZWQgZm9yIGNvbnNpc3RlbmN5IG9mIG5ldyBsaW5lcyAoalF1ZXJ5ICMxMTE1MykKCQkJaWYgKCB0eXBlb2YgZWxlbS50ZXh0Q29udGVudCA9PT0gInN0cmluZyIgKSB7CgkJCQlyZXR1cm4gZWxlbS50ZXh0Q29udGVudDsKCQkJfSBlbHNlIHsKCQkJCS8vIFRyYXZlcnNlIGl0cyBjaGlsZHJlbgoJCQkJZm9yICggZWxlbSA9IGVsZW0uZmlyc3RDaGlsZDsgZWxlbTsgZWxlbSA9IGVsZW0ubmV4dFNpYmxpbmcgKSB7CgkJCQkJcmV0ICs9IGdldFRleHQoIGVsZW0gKTsKCQkJCX0KCQkJfQoJCX0gZWxzZSBpZiAoIG5vZGVUeXBlID09PSAzIHx8IG5vZGVUeXBlID09PSA0ICkgewoJCQlyZXR1cm4gZWxlbS5ub2RlVmFsdWU7CgkJfQoJCS8vIERvIG5vdCBpbmNsdWRlIGNvbW1lbnQgb3IgcHJvY2Vzc2luZyBpbnN0cnVjdGlvbiBub2RlcwoKCQlyZXR1cm4gcmV0OwoJfTsKCglFeHByID0gU2l6emxlLnNlbGVjdG9ycyA9IHsKCgkJLy8gQ2FuIGJlIGFkanVzdGVkIGJ5IHRoZSB1c2VyCgkJY2FjaGVMZW5ndGg6IDUwLAoKCQljcmVhdGVQc2V1ZG86IG1hcmtGdW5jdGlvbiwKCgkJbWF0Y2g6IG1hdGNoRXhwciwKCgkJYXR0ckhhbmRsZToge30sCgoJCWZpbmQ6IHt9LAoKCQlyZWxhdGl2ZTogewoJCQkiPiI6IHsgZGlyOiAicGFyZW50Tm9kZSIsIGZpcnN0OiB0cnVlIH0sCgkJCSIgIjogeyBkaXI6ICJwYXJlbnROb2RlIiB9LAoJCQkiKyI6IHsgZGlyOiAicHJldmlvdXNTaWJsaW5nIiwgZmlyc3Q6IHRydWUgfSwKCQkJIn4iOiB7IGRpcjogInByZXZpb3VzU2libGluZyIgfQoJCX0sCgoJCXByZUZpbHRlcjogewoJCQkiQVRUUiI6IGZ1bmN0aW9uKCBtYXRjaCApIHsKCQkJCW1hdGNoWzFdID0gbWF0Y2hbMV0ucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKTsKCgkJCQkvLyBNb3ZlIHRoZSBnaXZlbiB2YWx1ZSB0byBtYXRjaFszXSB3aGV0aGVyIHF1b3RlZCBvciB1bnF1b3RlZAoJCQkJbWF0Y2hbM10gPSAoIG1hdGNoWzNdIHx8IG1hdGNoWzRdIHx8IG1hdGNoWzVdIHx8ICIiICkucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKTsKCgkJCQlpZiAoIG1hdGNoWzJdID09PSAifj0iICkgewoJCQkJCW1hdGNoWzNdID0gIiAiICsgbWF0Y2hbM10gKyAiICI7CgkJCQl9CgoJCQkJcmV0dXJuIG1hdGNoLnNsaWNlKCAwLCA0ICk7CgkJCX0sCgoJCQkiQ0hJTEQiOiBmdW5jdGlvbiggbWF0Y2ggKSB7CgkJCQkvKiBtYXRjaGVzIGZyb20gbWF0Y2hFeHByWyJDSElMRCJdCgkJCQkJMSB0eXBlIChvbmx5fG50aHwuLi4pCgkJCQkJMiB3aGF0IChjaGlsZHxvZi10eXBlKQoJCQkJCTMgYXJndW1lbnQgKGV2ZW58b2RkfFxkKnxcZCpuKFsrLV1cZCspP3wuLi4pCgkJCQkJNCB4bi1jb21wb25lbnQgb2YgeG4reSBhcmd1bWVudCAoWystXT9cZCpufCkKCQkJCQk1IHNpZ24gb2YgeG4tY29tcG9uZW50CgkJCQkJNiB4IG9mIHhuLWNvbXBvbmVudAoJCQkJCTcgc2lnbiBvZiB5LWNvbXBvbmVudAoJCQkJCTggeSBvZiB5LWNvbXBvbmVudAoJCQkJKi8KCQkJCW1hdGNoWzFdID0gbWF0Y2hbMV0udG9Mb3dlckNhc2UoKTsKCgkJCQlpZiAoIG1hdGNoWzFdLnNsaWNlKCAwLCAzICkgPT09ICJudGgiICkgewoJCQkJCS8vIG50aC0qIHJlcXVpcmVzIGFyZ3VtZW50CgkJCQkJaWYgKCAhbWF0Y2hbM10gKSB7CgkJCQkJCVNpenpsZS5lcnJvciggbWF0Y2hbMF0gKTsKCQkJCQl9CgoJCQkJCS8vIG51bWVyaWMgeCBhbmQgeSBwYXJhbWV0ZXJzIGZvciBFeHByLmZpbHRlci5DSElMRAoJCQkJCS8vIHJlbWVtYmVyIHRoYXQgZmFsc2UvdHJ1ZSBjYXN0IHJlc3BlY3RpdmVseSB0byAwLzEKCQkJCQltYXRjaFs0XSA9ICsoIG1hdGNoWzRdID8gbWF0Y2hbNV0gKyAobWF0Y2hbNl0gfHwgMSkgOiAyICogKCBtYXRjaFszXSA9PT0gImV2ZW4iIHx8IG1hdGNoWzNdID09PSAib2RkIiApICk7CgkJCQkJbWF0Y2hbNV0gPSArKCAoIG1hdGNoWzddICsgbWF0Y2hbOF0gKSB8fCBtYXRjaFszXSA9PT0gIm9kZCIgKTsKCgkJCQkvLyBvdGhlciB0eXBlcyBwcm9oaWJpdCBhcmd1bWVudHMKCQkJCX0gZWxzZSBpZiAoIG1hdGNoWzNdICkgewoJCQkJCVNpenpsZS5lcnJvciggbWF0Y2hbMF0gKTsKCQkJCX0KCgkJCQlyZXR1cm4gbWF0Y2g7CgkJCX0sCgoJCQkiUFNFVURPIjogZnVuY3Rpb24oIG1hdGNoICkgewoJCQkJdmFyIGV4Y2VzcywKCQkJCQl1bnF1b3RlZCA9ICFtYXRjaFs2XSAmJiBtYXRjaFsyXTsKCgkJCQlpZiAoIG1hdGNoRXhwclsiQ0hJTEQiXS50ZXN0KCBtYXRjaFswXSApICkgewoJCQkJCXJldHVybiBudWxsOwoJCQkJfQoKCQkJCS8vIEFjY2VwdCBxdW90ZWQgYXJndW1lbnRzIGFzLWlzCgkJCQlpZiAoIG1hdGNoWzNdICkgewoJCQkJCW1hdGNoWzJdID0gbWF0Y2hbNF0gfHwgbWF0Y2hbNV0gfHwgIiI7CgoJCQkJLy8gU3RyaXAgZXhjZXNzIGNoYXJhY3RlcnMgZnJvbSB1bnF1b3RlZCBhcmd1bWVudHMKCQkJCX0gZWxzZSBpZiAoIHVucXVvdGVkICYmIHJwc2V1ZG8udGVzdCggdW5xdW90ZWQgKSAmJgoJCQkJCS8vIEdldCBleGNlc3MgZnJvbSB0b2tlbml6ZSAocmVjdXJzaXZlbHkpCgkJCQkJKGV4Y2VzcyA9IHRva2VuaXplKCB1bnF1b3RlZCwgdHJ1ZSApKSAmJgoJCQkJCS8vIGFkdmFuY2UgdG8gdGhlIG5leHQgY2xvc2luZyBwYXJlbnRoZXNpcwoJCQkJCShleGNlc3MgPSB1bnF1b3RlZC5pbmRleE9mKCAiKSIsIHVucXVvdGVkLmxlbmd0aCAtIGV4Y2VzcyApIC0gdW5xdW90ZWQubGVuZ3RoKSApIHsKCgkJCQkJLy8gZXhjZXNzIGlzIGEgbmVnYXRpdmUgaW5kZXgKCQkJCQltYXRjaFswXSA9IG1hdGNoWzBdLnNsaWNlKCAwLCBleGNlc3MgKTsKCQkJCQltYXRjaFsyXSA9IHVucXVvdGVkLnNsaWNlKCAwLCBleGNlc3MgKTsKCQkJCX0KCgkJCQkvLyBSZXR1cm4gb25seSBjYXB0dXJlcyBuZWVkZWQgYnkgdGhlIHBzZXVkbyBmaWx0ZXIgbWV0aG9kICh0eXBlIGFuZCBhcmd1bWVudCkKCQkJCXJldHVybiBtYXRjaC5zbGljZSggMCwgMyApOwoJCQl9CgkJfSwKCgkJZmlsdGVyOiB7CgoJCQkiVEFHIjogZnVuY3Rpb24oIG5vZGVOYW1lU2VsZWN0b3IgKSB7CgkJCQl2YXIgbm9kZU5hbWUgPSBub2RlTmFtZVNlbGVjdG9yLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICkudG9Mb3dlckNhc2UoKTsKCQkJCXJldHVybiBub2RlTmFtZVNlbGVjdG9yID09PSAiKiIgPwoJCQkJCWZ1bmN0aW9uKCkgeyByZXR1cm4gdHJ1ZTsgfSA6CgkJCQkJZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJCXJldHVybiBlbGVtLm5vZGVOYW1lICYmIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbm9kZU5hbWU7CgkJCQkJfTsKCQkJfSwKCgkJCSJDTEFTUyI6IGZ1bmN0aW9uKCBjbGFzc05hbWUgKSB7CgkJCQl2YXIgcGF0dGVybiA9IGNsYXNzQ2FjaGVbIGNsYXNzTmFtZSArICIgIiBdOwoKCQkJCXJldHVybiBwYXR0ZXJuIHx8CgkJCQkJKHBhdHRlcm4gPSBuZXcgUmVnRXhwKCAiKF58IiArIHdoaXRlc3BhY2UgKyAiKSIgKyBjbGFzc05hbWUgKyAiKCIgKyB3aGl0ZXNwYWNlICsgInwkKSIgKSkgJiYKCQkJCQljbGFzc0NhY2hlKCBjbGFzc05hbWUsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCQlyZXR1cm4gcGF0dGVybi50ZXN0KCB0eXBlb2YgZWxlbS5jbGFzc05hbWUgPT09ICJzdHJpbmciICYmIGVsZW0uY2xhc3NOYW1lIHx8IHR5cGVvZiBlbGVtLmdldEF0dHJpYnV0ZSAhPT0gInVuZGVmaW5lZCIgJiYgZWxlbS5nZXRBdHRyaWJ1dGUoImNsYXNzIikgfHwgIiIgKTsKCQkJCQl9KTsKCQkJfSwKCgkJCSJBVFRSIjogZnVuY3Rpb24oIG5hbWUsIG9wZXJhdG9yLCBjaGVjayApIHsKCQkJCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCQl2YXIgcmVzdWx0ID0gU2l6emxlLmF0dHIoIGVsZW0sIG5hbWUgKTsKCgkJCQkJaWYgKCByZXN1bHQgPT0gbnVsbCApIHsKCQkJCQkJcmV0dXJuIG9wZXJhdG9yID09PSAiIT0iOwoJCQkJCX0KCQkJCQlpZiAoICFvcGVyYXRvciApIHsKCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJfQoKCQkJCQlyZXN1bHQgKz0gIiI7CgoJCQkJCXJldHVybiBvcGVyYXRvciA9PT0gIj0iID8gcmVzdWx0ID09PSBjaGVjayA6CgkJCQkJCW9wZXJhdG9yID09PSAiIT0iID8gcmVzdWx0ICE9PSBjaGVjayA6CgkJCQkJCW9wZXJhdG9yID09PSAiXj0iID8gY2hlY2sgJiYgcmVzdWx0LmluZGV4T2YoIGNoZWNrICkgPT09IDAgOgoJCQkJCQlvcGVyYXRvciA9PT0gIio9IiA/IGNoZWNrICYmIHJlc3VsdC5pbmRleE9mKCBjaGVjayApID4gLTEgOgoJCQkJCQlvcGVyYXRvciA9PT0gIiQ9IiA/IGNoZWNrICYmIHJlc3VsdC5zbGljZSggLWNoZWNrLmxlbmd0aCApID09PSBjaGVjayA6CgkJCQkJCW9wZXJhdG9yID09PSAifj0iID8gKCAiICIgKyByZXN1bHQucmVwbGFjZSggcndoaXRlc3BhY2UsICIgIiApICsgIiAiICkuaW5kZXhPZiggY2hlY2sgKSA+IC0xIDoKCQkJCQkJb3BlcmF0b3IgPT09ICJ8PSIgPyByZXN1bHQgPT09IGNoZWNrIHx8IHJlc3VsdC5zbGljZSggMCwgY2hlY2subGVuZ3RoICsgMSApID09PSBjaGVjayArICItIiA6CgkJCQkJCWZhbHNlOwoJCQkJfTsKCQkJfSwKCgkJCSJDSElMRCI6IGZ1bmN0aW9uKCB0eXBlLCB3aGF0LCBhcmd1bWVudCwgZmlyc3QsIGxhc3QgKSB7CgkJCQl2YXIgc2ltcGxlID0gdHlwZS5zbGljZSggMCwgMyApICE9PSAibnRoIiwKCQkJCQlmb3J3YXJkID0gdHlwZS5zbGljZSggLTQgKSAhPT0gImxhc3QiLAoJCQkJCW9mVHlwZSA9IHdoYXQgPT09ICJvZi10eXBlIjsKCgkJCQlyZXR1cm4gZmlyc3QgPT09IDEgJiYgbGFzdCA9PT0gMCA/CgoJCQkJCS8vIFNob3J0Y3V0IGZvciA6bnRoLSoobikKCQkJCQlmdW5jdGlvbiggZWxlbSApIHsKCQkJCQkJcmV0dXJuICEhZWxlbS5wYXJlbnROb2RlOwoJCQkJCX0gOgoKCQkJCQlmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkgewoJCQkJCQl2YXIgY2FjaGUsIHVuaXF1ZUNhY2hlLCBvdXRlckNhY2hlLCBub2RlLCBub2RlSW5kZXgsIHN0YXJ0LAoJCQkJCQkJZGlyID0gc2ltcGxlICE9PSBmb3J3YXJkID8gIm5leHRTaWJsaW5nIiA6ICJwcmV2aW91c1NpYmxpbmciLAoJCQkJCQkJcGFyZW50ID0gZWxlbS5wYXJlbnROb2RlLAoJCQkJCQkJbmFtZSA9IG9mVHlwZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksCgkJCQkJCQl1c2VDYWNoZSA9ICF4bWwgJiYgIW9mVHlwZSwKCQkJCQkJCWRpZmYgPSBmYWxzZTsKCgkJCQkJCWlmICggcGFyZW50ICkgewoKCQkJCQkJCS8vIDooZmlyc3R8bGFzdHxvbmx5KS0oY2hpbGR8b2YtdHlwZSkKCQkJCQkJCWlmICggc2ltcGxlICkgewoJCQkJCQkJCXdoaWxlICggZGlyICkgewoJCQkJCQkJCQlub2RlID0gZWxlbTsKCQkJCQkJCQkJd2hpbGUgKCAobm9kZSA9IG5vZGVbIGRpciBdKSApIHsKCQkJCQkJCQkJCWlmICggb2ZUeXBlID8KCQkJCQkJCQkJCQlub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5hbWUgOgoJCQkJCQkJCQkJCW5vZGUubm9kZVR5cGUgPT09IDEgKSB7CgoJCQkJCQkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQkJCQkJCX0KCQkJCQkJCQkJfQoJCQkJCQkJCQkvLyBSZXZlcnNlIGRpcmVjdGlvbiBmb3IgOm9ubHktKiAoaWYgd2UgaGF2ZW4ndCB5ZXQgZG9uZSBzbykKCQkJCQkJCQkJc3RhcnQgPSBkaXIgPSB0eXBlID09PSAib25seSIgJiYgIXN0YXJ0ICYmICJuZXh0U2libGluZyI7CgkJCQkJCQkJfQoJCQkJCQkJCXJldHVybiB0cnVlOwoJCQkJCQkJfQoKCQkJCQkJCXN0YXJ0ID0gWyBmb3J3YXJkID8gcGFyZW50LmZpcnN0Q2hpbGQgOiBwYXJlbnQubGFzdENoaWxkIF07CgoJCQkJCQkJLy8gbm9uLXhtbCA6bnRoLWNoaWxkKC4uLikgc3RvcmVzIGNhY2hlIGRhdGEgb24gYHBhcmVudGAKCQkJCQkJCWlmICggZm9yd2FyZCAmJiB1c2VDYWNoZSApIHsKCgkJCQkJCQkJLy8gU2VlayBgZWxlbWAgZnJvbSBhIHByZXZpb3VzbHktY2FjaGVkIGluZGV4CgoJCQkJCQkJCS8vIC4uLmluIGEgZ3ppcC1mcmllbmRseSB3YXkKCQkJCQkJCQlub2RlID0gcGFyZW50OwoJCQkJCQkJCW91dGVyQ2FjaGUgPSBub2RlWyBleHBhbmRvIF0gfHwgKG5vZGVbIGV4cGFuZG8gXSA9IHt9KTsKCgkJCQkJCQkJLy8gU3VwcG9ydDogSUUgPDkgb25seQoJCQkJCQkJCS8vIERlZmVuZCBhZ2FpbnN0IGNsb25lZCBhdHRyb3BlcnRpZXMgKGpRdWVyeSBnaC0xNzA5KQoJCQkJCQkJCXVuaXF1ZUNhY2hlID0gb3V0ZXJDYWNoZVsgbm9kZS51bmlxdWVJRCBdIHx8CgkJCQkJCQkJCShvdXRlckNhY2hlWyBub2RlLnVuaXF1ZUlEIF0gPSB7fSk7CgoJCQkJCQkJCWNhY2hlID0gdW5pcXVlQ2FjaGVbIHR5cGUgXSB8fCBbXTsKCQkJCQkJCQlub2RlSW5kZXggPSBjYWNoZVsgMCBdID09PSBkaXJydW5zICYmIGNhY2hlWyAxIF07CgkJCQkJCQkJZGlmZiA9IG5vZGVJbmRleCAmJiBjYWNoZVsgMiBdOwoJCQkJCQkJCW5vZGUgPSBub2RlSW5kZXggJiYgcGFyZW50LmNoaWxkTm9kZXNbIG5vZGVJbmRleCBdOwoKCQkJCQkJCQl3aGlsZSAoIChub2RlID0gKytub2RlSW5kZXggJiYgbm9kZSAmJiBub2RlWyBkaXIgXSB8fAoKCQkJCQkJCQkJLy8gRmFsbGJhY2sgdG8gc2Vla2luZyBgZWxlbWAgZnJvbSB0aGUgc3RhcnQKCQkJCQkJCQkJKGRpZmYgPSBub2RlSW5kZXggPSAwKSB8fCBzdGFydC5wb3AoKSkgKSB7CgoJCQkJCQkJCQkvLyBXaGVuIGZvdW5kLCBjYWNoZSBpbmRleGVzIG9uIGBwYXJlbnRgIGFuZCBicmVhawoJCQkJCQkJCQlpZiAoIG5vZGUubm9kZVR5cGUgPT09IDEgJiYgKytkaWZmICYmIG5vZGUgPT09IGVsZW0gKSB7CgkJCQkJCQkJCQl1bmlxdWVDYWNoZVsgdHlwZSBdID0gWyBkaXJydW5zLCBub2RlSW5kZXgsIGRpZmYgXTsKCQkJCQkJCQkJCWJyZWFrOwoJCQkJCQkJCQl9CgkJCQkJCQkJfQoKCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJLy8gVXNlIHByZXZpb3VzbHktY2FjaGVkIGVsZW1lbnQgaW5kZXggaWYgYXZhaWxhYmxlCgkJCQkJCQkJaWYgKCB1c2VDYWNoZSApIHsKCQkJCQkJCQkJLy8gLi4uaW4gYSBnemlwLWZyaWVuZGx5IHdheQoJCQkJCQkJCQlub2RlID0gZWxlbTsKCQkJCQkJCQkJb3V0ZXJDYWNoZSA9IG5vZGVbIGV4cGFuZG8gXSB8fCAobm9kZVsgZXhwYW5kbyBdID0ge30pOwoKCQkJCQkJCQkJLy8gU3VwcG9ydDogSUUgPDkgb25seQoJCQkJCQkJCQkvLyBEZWZlbmQgYWdhaW5zdCBjbG9uZWQgYXR0cm9wZXJ0aWVzIChqUXVlcnkgZ2gtMTcwOSkKCQkJCQkJCQkJdW5pcXVlQ2FjaGUgPSBvdXRlckNhY2hlWyBub2RlLnVuaXF1ZUlEIF0gfHwKCQkJCQkJCQkJCShvdXRlckNhY2hlWyBub2RlLnVuaXF1ZUlEIF0gPSB7fSk7CgoJCQkJCQkJCQljYWNoZSA9IHVuaXF1ZUNhY2hlWyB0eXBlIF0gfHwgW107CgkJCQkJCQkJCW5vZGVJbmRleCA9IGNhY2hlWyAwIF0gPT09IGRpcnJ1bnMgJiYgY2FjaGVbIDEgXTsKCQkJCQkJCQkJZGlmZiA9IG5vZGVJbmRleDsKCQkJCQkJCQl9CgoJCQkJCQkJCS8vIHhtbCA6bnRoLWNoaWxkKC4uLikKCQkJCQkJCQkvLyBvciA6bnRoLWxhc3QtY2hpbGQoLi4uKSBvciA6bnRoKC1sYXN0KT8tb2YtdHlwZSguLi4pCgkJCQkJCQkJaWYgKCBkaWZmID09PSBmYWxzZSApIHsKCQkJCQkJCQkJLy8gVXNlIHRoZSBzYW1lIGxvb3AgYXMgYWJvdmUgdG8gc2VlayBgZWxlbWAgZnJvbSB0aGUgc3RhcnQKCQkJCQkJCQkJd2hpbGUgKCAobm9kZSA9ICsrbm9kZUluZGV4ICYmIG5vZGUgJiYgbm9kZVsgZGlyIF0gfHwKCQkJCQkJCQkJCShkaWZmID0gbm9kZUluZGV4ID0gMCkgfHwgc3RhcnQucG9wKCkpICkgewoKCQkJCQkJCQkJCWlmICggKCBvZlR5cGUgPwoJCQkJCQkJCQkJCW5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbmFtZSA6CgkJCQkJCQkJCQkJbm9kZS5ub2RlVHlwZSA9PT0gMSApICYmCgkJCQkJCQkJCQkJKytkaWZmICkgewoKCQkJCQkJCQkJCQkvLyBDYWNoZSB0aGUgaW5kZXggb2YgZWFjaCBlbmNvdW50ZXJlZCBlbGVtZW50CgkJCQkJCQkJCQkJaWYgKCB1c2VDYWNoZSApIHsKCQkJCQkJCQkJCQkJb3V0ZXJDYWNoZSA9IG5vZGVbIGV4cGFuZG8gXSB8fCAobm9kZVsgZXhwYW5kbyBdID0ge30pOwoKCQkJCQkJCQkJCQkJLy8gU3VwcG9ydDogSUUgPDkgb25seQoJCQkJCQkJCQkJCQkvLyBEZWZlbmQgYWdhaW5zdCBjbG9uZWQgYXR0cm9wZXJ0aWVzIChqUXVlcnkgZ2gtMTcwOSkKCQkJCQkJCQkJCQkJdW5pcXVlQ2FjaGUgPSBvdXRlckNhY2hlWyBub2RlLnVuaXF1ZUlEIF0gfHwKCQkJCQkJCQkJCQkJCShvdXRlckNhY2hlWyBub2RlLnVuaXF1ZUlEIF0gPSB7fSk7CgoJCQkJCQkJCQkJCQl1bmlxdWVDYWNoZVsgdHlwZSBdID0gWyBkaXJydW5zLCBkaWZmIF07CgkJCQkJCQkJCQkJfQoKCQkJCQkJCQkJCQlpZiAoIG5vZGUgPT09IGVsZW0gKSB7CgkJCQkJCQkJCQkJCWJyZWFrOwoJCQkJCQkJCQkJCX0KCQkJCQkJCQkJCX0KCQkJCQkJCQkJfQoJCQkJCQkJCX0KCQkJCQkJCX0KCgkJCQkJCQkvLyBJbmNvcnBvcmF0ZSB0aGUgb2Zmc2V0LCB0aGVuIGNoZWNrIGFnYWluc3QgY3ljbGUgc2l6ZQoJCQkJCQkJZGlmZiAtPSBsYXN0OwoJCQkJCQkJcmV0dXJuIGRpZmYgPT09IGZpcnN0IHx8ICggZGlmZiAlIGZpcnN0ID09PSAwICYmIGRpZmYgLyBmaXJzdCA+PSAwICk7CgkJCQkJCX0KCQkJCQl9OwoJCQl9LAoKCQkJIlBTRVVETyI6IGZ1bmN0aW9uKCBwc2V1ZG8sIGFyZ3VtZW50ICkgewoJCQkJLy8gcHNldWRvLWNsYXNzIG5hbWVzIGFyZSBjYXNlLWluc2Vuc2l0aXZlCgkJCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI3BzZXVkby1jbGFzc2VzCgkJCQkvLyBQcmlvcml0aXplIGJ5IGNhc2Ugc2Vuc2l0aXZpdHkgaW4gY2FzZSBjdXN0b20gcHNldWRvcyBhcmUgYWRkZWQgd2l0aCB1cHBlcmNhc2UgbGV0dGVycwoJCQkJLy8gUmVtZW1iZXIgdGhhdCBzZXRGaWx0ZXJzIGluaGVyaXRzIGZyb20gcHNldWRvcwoJCQkJdmFyIGFyZ3MsCgkJCQkJZm4gPSBFeHByLnBzZXVkb3NbIHBzZXVkbyBdIHx8IEV4cHIuc2V0RmlsdGVyc1sgcHNldWRvLnRvTG93ZXJDYXNlKCkgXSB8fAoJCQkJCQlTaXp6bGUuZXJyb3IoICJ1bnN1cHBvcnRlZCBwc2V1ZG86ICIgKyBwc2V1ZG8gKTsKCgkJCQkvLyBUaGUgdXNlciBtYXkgdXNlIGNyZWF0ZVBzZXVkbyB0byBpbmRpY2F0ZSB0aGF0CgkJCQkvLyBhcmd1bWVudHMgYXJlIG5lZWRlZCB0byBjcmVhdGUgdGhlIGZpbHRlciBmdW5jdGlvbgoJCQkJLy8ganVzdCBhcyBTaXp6bGUgZG9lcwoJCQkJaWYgKCBmblsgZXhwYW5kbyBdICkgewoJCQkJCXJldHVybiBmbiggYXJndW1lbnQgKTsKCQkJCX0KCgkJCQkvLyBCdXQgbWFpbnRhaW4gc3VwcG9ydCBmb3Igb2xkIHNpZ25hdHVyZXMKCQkJCWlmICggZm4ubGVuZ3RoID4gMSApIHsKCQkJCQlhcmdzID0gWyBwc2V1ZG8sIHBzZXVkbywgIiIsIGFyZ3VtZW50IF07CgkJCQkJcmV0dXJuIEV4cHIuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eSggcHNldWRvLnRvTG93ZXJDYXNlKCkgKSA/CgkJCQkJCW1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VlZCwgbWF0Y2hlcyApIHsKCQkJCQkJCXZhciBpZHgsCgkJCQkJCQkJbWF0Y2hlZCA9IGZuKCBzZWVkLCBhcmd1bWVudCApLAoJCQkJCQkJCWkgPSBtYXRjaGVkLmxlbmd0aDsKCQkJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQkJCWlkeCA9IGluZGV4T2YoIHNlZWQsIG1hdGNoZWRbaV0gKTsKCQkJCQkJCQlzZWVkWyBpZHggXSA9ICEoIG1hdGNoZXNbIGlkeCBdID0gbWF0Y2hlZFtpXSApOwoJCQkJCQkJfQoJCQkJCQl9KSA6CgkJCQkJCWZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCQkJcmV0dXJuIGZuKCBlbGVtLCAwLCBhcmdzICk7CgkJCQkJCX07CgkJCQl9CgoJCQkJcmV0dXJuIGZuOwoJCQl9CgkJfSwKCgkJcHNldWRvczogewoJCQkvLyBQb3RlbnRpYWxseSBjb21wbGV4IHBzZXVkb3MKCQkJIm5vdCI6IG1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCQkvLyBUcmltIHRoZSBzZWxlY3RvciBwYXNzZWQgdG8gY29tcGlsZQoJCQkJLy8gdG8gYXZvaWQgdHJlYXRpbmcgbGVhZGluZyBhbmQgdHJhaWxpbmcKCQkJCS8vIHNwYWNlcyBhcyBjb21iaW5hdG9ycwoJCQkJdmFyIGlucHV0ID0gW10sCgkJCQkJcmVzdWx0cyA9IFtdLAoJCQkJCW1hdGNoZXIgPSBjb21waWxlKCBzZWxlY3Rvci5yZXBsYWNlKCBydHJpbSwgIiQxIiApICk7CgoJCQkJcmV0dXJuIG1hdGNoZXJbIGV4cGFuZG8gXSA/CgkJCQkJbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWVkLCBtYXRjaGVzLCBjb250ZXh0LCB4bWwgKSB7CgkJCQkJCXZhciBlbGVtLAoJCQkJCQkJdW5tYXRjaGVkID0gbWF0Y2hlciggc2VlZCwgbnVsbCwgeG1sLCBbXSApLAoJCQkJCQkJaSA9IHNlZWQubGVuZ3RoOwoKCQkJCQkJLy8gTWF0Y2ggZWxlbWVudHMgdW5tYXRjaGVkIGJ5IGBtYXRjaGVyYAoJCQkJCQl3aGlsZSAoIGktLSApIHsKCQkJCQkJCWlmICggKGVsZW0gPSB1bm1hdGNoZWRbaV0pICkgewoJCQkJCQkJCXNlZWRbaV0gPSAhKG1hdGNoZXNbaV0gPSBlbGVtKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0pIDoKCQkJCQlmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkgewoJCQkJCQlpbnB1dFswXSA9IGVsZW07CgkJCQkJCW1hdGNoZXIoIGlucHV0LCBudWxsLCB4bWwsIHJlc3VsdHMgKTsKCQkJCQkJLy8gRG9uJ3Qga2VlcCB0aGUgZWxlbWVudCAoaXNzdWUgIzI5OSkKCQkJCQkJaW5wdXRbMF0gPSBudWxsOwoJCQkJCQlyZXR1cm4gIXJlc3VsdHMucG9wKCk7CgkJCQkJfTsKCQkJfSksCgoJCQkiaGFzIjogbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQkJCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCQlyZXR1cm4gU2l6emxlKCBzZWxlY3RvciwgZWxlbSApLmxlbmd0aCA+IDA7CgkJCQl9OwoJCQl9KSwKCgkJCSJjb250YWlucyI6IG1hcmtGdW5jdGlvbihmdW5jdGlvbiggdGV4dCApIHsKCQkJCXRleHQgPSB0ZXh0LnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7CgkJCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJcmV0dXJuICggZWxlbS50ZXh0Q29udGVudCB8fCBlbGVtLmlubmVyVGV4dCB8fCBnZXRUZXh0KCBlbGVtICkgKS5pbmRleE9mKCB0ZXh0ICkgPiAtMTsKCQkJCX07CgkJCX0pLAoKCQkJLy8gIldoZXRoZXIgYW4gZWxlbWVudCBpcyByZXByZXNlbnRlZCBieSBhIDpsYW5nKCkgc2VsZWN0b3IKCQkJLy8gaXMgYmFzZWQgc29sZWx5IG9uIHRoZSBlbGVtZW50J3MgbGFuZ3VhZ2UgdmFsdWUKCQkJLy8gYmVpbmcgZXF1YWwgdG8gdGhlIGlkZW50aWZpZXIgQywKCQkJLy8gb3IgYmVnaW5uaW5nIHdpdGggdGhlIGlkZW50aWZpZXIgQyBpbW1lZGlhdGVseSBmb2xsb3dlZCBieSAiLSIuCgkJCS8vIFRoZSBtYXRjaGluZyBvZiBDIGFnYWluc3QgdGhlIGVsZW1lbnQncyBsYW5ndWFnZSB2YWx1ZSBpcyBwZXJmb3JtZWQgY2FzZS1pbnNlbnNpdGl2ZWx5LgoJCQkvLyBUaGUgaWRlbnRpZmllciBDIGRvZXMgbm90IGhhdmUgdG8gYmUgYSB2YWxpZCBsYW5ndWFnZSBuYW1lLiIKCQkJLy8gaHR0cDovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLyNsYW5nLXBzZXVkbwoJCQkibGFuZyI6IG1hcmtGdW5jdGlvbiggZnVuY3Rpb24oIGxhbmcgKSB7CgkJCQkvLyBsYW5nIHZhbHVlIG11c3QgYmUgYSB2YWxpZCBpZGVudGlmaWVyCgkJCQlpZiAoICFyaWRlbnRpZmllci50ZXN0KGxhbmcgfHwgIiIpICkgewoJCQkJCVNpenpsZS5lcnJvciggInVuc3VwcG9ydGVkIGxhbmc6ICIgKyBsYW5nICk7CgkJCQl9CgkJCQlsYW5nID0gbGFuZy5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLnRvTG93ZXJDYXNlKCk7CgkJCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJdmFyIGVsZW1MYW5nOwoJCQkJCWRvIHsKCQkJCQkJaWYgKCAoZWxlbUxhbmcgPSBkb2N1bWVudElzSFRNTCA/CgkJCQkJCQllbGVtLmxhbmcgOgoJCQkJCQkJZWxlbS5nZXRBdHRyaWJ1dGUoInhtbDpsYW5nIikgfHwgZWxlbS5nZXRBdHRyaWJ1dGUoImxhbmciKSkgKSB7CgoJCQkJCQkJZWxlbUxhbmcgPSBlbGVtTGFuZy50b0xvd2VyQ2FzZSgpOwoJCQkJCQkJcmV0dXJuIGVsZW1MYW5nID09PSBsYW5nIHx8IGVsZW1MYW5nLmluZGV4T2YoIGxhbmcgKyAiLSIgKSA9PT0gMDsKCQkJCQkJfQoJCQkJCX0gd2hpbGUgKCAoZWxlbSA9IGVsZW0ucGFyZW50Tm9kZSkgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSApOwoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX07CgkJCX0pLAoKCQkJLy8gTWlzY2VsbGFuZW91cwoJCQkidGFyZ2V0IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQl2YXIgaGFzaCA9IHdpbmRvdy5sb2NhdGlvbiAmJiB3aW5kb3cubG9jYXRpb24uaGFzaDsKCQkJCXJldHVybiBoYXNoICYmIGhhc2guc2xpY2UoIDEgKSA9PT0gZWxlbS5pZDsKCQkJfSwKCgkJCSJyb290IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gZWxlbSA9PT0gZG9jRWxlbTsKCQkJfSwKCgkJCSJmb2N1cyI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGVsZW0gPT09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgJiYgKCFkb2N1bWVudC5oYXNGb2N1cyB8fCBkb2N1bWVudC5oYXNGb2N1cygpKSAmJiAhIShlbGVtLnR5cGUgfHwgZWxlbS5ocmVmIHx8IH5lbGVtLnRhYkluZGV4KTsKCQkJfSwKCgkJCS8vIEJvb2xlYW4gcHJvcGVydGllcwoJCQkiZW5hYmxlZCI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGVsZW0uZGlzYWJsZWQgPT09IGZhbHNlOwoJCQl9LAoKCQkJImRpc2FibGVkIjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gZWxlbS5kaXNhYmxlZCA9PT0gdHJ1ZTsKCQkJfSwKCgkJCSJjaGVja2VkIjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkvLyBJbiBDU1MzLCA6Y2hlY2tlZCBzaG91bGQgcmV0dXJuIGJvdGggY2hlY2tlZCBhbmQgc2VsZWN0ZWQgZWxlbWVudHMKCQkJCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMTEvUkVDLWNzczMtc2VsZWN0b3JzLTIwMTEwOTI5LyNjaGVja2VkCgkJCQl2YXIgbm9kZU5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CgkJCQlyZXR1cm4gKG5vZGVOYW1lID09PSAiaW5wdXQiICYmICEhZWxlbS5jaGVja2VkKSB8fCAobm9kZU5hbWUgPT09ICJvcHRpb24iICYmICEhZWxlbS5zZWxlY3RlZCk7CgkJCX0sCgoJCQkic2VsZWN0ZWQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCS8vIEFjY2Vzc2luZyB0aGlzIHByb3BlcnR5IG1ha2VzIHNlbGVjdGVkLWJ5LWRlZmF1bHQKCQkJCS8vIG9wdGlvbnMgaW4gU2FmYXJpIHdvcmsgcHJvcGVybHkKCQkJCWlmICggZWxlbS5wYXJlbnROb2RlICkgewoJCQkJCWVsZW0ucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4OwoJCQkJfQoKCQkJCXJldHVybiBlbGVtLnNlbGVjdGVkID09PSB0cnVlOwoJCQl9LAoKCQkJLy8gQ29udGVudHMKCQkJImVtcHR5IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI2VtcHR5LXBzZXVkbwoJCQkJLy8gOmVtcHR5IGlzIG5lZ2F0ZWQgYnkgZWxlbWVudCAoMSkgb3IgY29udGVudCBub2RlcyAodGV4dDogMzsgY2RhdGE6IDQ7IGVudGl0eSByZWY6IDUpLAoJCQkJLy8gICBidXQgbm90IGJ5IG90aGVycyAoY29tbWVudDogODsgcHJvY2Vzc2luZyBpbnN0cnVjdGlvbjogNzsgZXRjLikKCQkJCS8vIG5vZGVUeXBlIDwgNiB3b3JrcyBiZWNhdXNlIGF0dHJpYnV0ZXMgKDIpIGRvIG5vdCBhcHBlYXIgYXMgY2hpbGRyZW4KCQkJCWZvciAoIGVsZW0gPSBlbGVtLmZpcnN0Q2hpbGQ7IGVsZW07IGVsZW0gPSBlbGVtLm5leHRTaWJsaW5nICkgewoJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA8IDYgKSB7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gdHJ1ZTsKCQkJfSwKCgkJCSJwYXJlbnQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiAhRXhwci5wc2V1ZG9zWyJlbXB0eSJdKCBlbGVtICk7CgkJCX0sCgoJCQkvLyBFbGVtZW50L2lucHV0IHR5cGVzCgkJCSJoZWFkZXIiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiByaGVhZGVyLnRlc3QoIGVsZW0ubm9kZU5hbWUgKTsKCQkJfSwKCgkJCSJpbnB1dCI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIHJpbnB1dHMudGVzdCggZWxlbS5ub2RlTmFtZSApOwoJCQl9LAoKCQkJImJ1dHRvbiI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJdmFyIG5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CgkJCQlyZXR1cm4gbmFtZSA9PT0gImlucHV0IiAmJiBlbGVtLnR5cGUgPT09ICJidXR0b24iIHx8IG5hbWUgPT09ICJidXR0b24iOwoJCQl9LAoKCQkJInRleHQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXZhciBhdHRyOwoJCQkJcmV0dXJuIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gImlucHV0IiAmJgoJCQkJCWVsZW0udHlwZSA9PT0gInRleHQiICYmCgoJCQkJCS8vIFN1cHBvcnQ6IElFPDgKCQkJCQkvLyBOZXcgSFRNTDUgYXR0cmlidXRlIHZhbHVlcyAoZS5nLiwgInNlYXJjaCIpIGFwcGVhciB3aXRoIGVsZW0udHlwZSA9PT0gInRleHQiCgkJCQkJKCAoYXR0ciA9IGVsZW0uZ2V0QXR0cmlidXRlKCJ0eXBlIikpID09IG51bGwgfHwgYXR0ci50b0xvd2VyQ2FzZSgpID09PSAidGV4dCIgKTsKCQkJfSwKCgkJCS8vIFBvc2l0aW9uLWluLWNvbGxlY3Rpb24KCQkJImZpcnN0IjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbigpIHsKCQkJCXJldHVybiBbIDAgXTsKCQkJfSksCgoJCQkibGFzdCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoICkgewoJCQkJcmV0dXJuIFsgbGVuZ3RoIC0gMSBdOwoJCQl9KSwKCgkJCSJlcSI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoLCBhcmd1bWVudCApIHsKCQkJCXJldHVybiBbIGFyZ3VtZW50IDwgMCA/IGFyZ3VtZW50ICsgbGVuZ3RoIDogYXJndW1lbnQgXTsKCQkJfSksCgoJCQkiZXZlbiI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoICkgewoJCQkJdmFyIGkgPSAwOwoJCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpICs9IDIgKSB7CgkJCQkJbWF0Y2hJbmRleGVzLnB1c2goIGkgKTsKCQkJCX0KCQkJCXJldHVybiBtYXRjaEluZGV4ZXM7CgkJCX0pLAoKCQkJIm9kZCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoICkgewoJCQkJdmFyIGkgPSAxOwoJCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpICs9IDIgKSB7CgkJCQkJbWF0Y2hJbmRleGVzLnB1c2goIGkgKTsKCQkJCX0KCQkJCXJldHVybiBtYXRjaEluZGV4ZXM7CgkJCX0pLAoKCQkJImx0IjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbiggbWF0Y2hJbmRleGVzLCBsZW5ndGgsIGFyZ3VtZW50ICkgewoJCQkJdmFyIGkgPSBhcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50OwoJCQkJZm9yICggOyAtLWkgPj0gMDsgKSB7CgkJCQkJbWF0Y2hJbmRleGVzLnB1c2goIGkgKTsKCQkJCX0KCQkJCXJldHVybiBtYXRjaEluZGV4ZXM7CgkJCX0pLAoKCQkJImd0IjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbiggbWF0Y2hJbmRleGVzLCBsZW5ndGgsIGFyZ3VtZW50ICkgewoJCQkJdmFyIGkgPSBhcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50OwoJCQkJZm9yICggOyArK2kgPCBsZW5ndGg7ICkgewoJCQkJCW1hdGNoSW5kZXhlcy5wdXNoKCBpICk7CgkJCQl9CgkJCQlyZXR1cm4gbWF0Y2hJbmRleGVzOwoJCQl9KQoJCX0KCX07CgoJRXhwci5wc2V1ZG9zWyJudGgiXSA9IEV4cHIucHNldWRvc1siZXEiXTsKCgkvLyBBZGQgYnV0dG9uL2lucHV0IHR5cGUgcHNldWRvcwoJZm9yICggaSBpbiB7IHJhZGlvOiB0cnVlLCBjaGVja2JveDogdHJ1ZSwgZmlsZTogdHJ1ZSwgcGFzc3dvcmQ6IHRydWUsIGltYWdlOiB0cnVlIH0gKSB7CgkJRXhwci5wc2V1ZG9zWyBpIF0gPSBjcmVhdGVJbnB1dFBzZXVkbyggaSApOwoJfQoJZm9yICggaSBpbiB7IHN1Ym1pdDogdHJ1ZSwgcmVzZXQ6IHRydWUgfSApIHsKCQlFeHByLnBzZXVkb3NbIGkgXSA9IGNyZWF0ZUJ1dHRvblBzZXVkbyggaSApOwoJfQoKCS8vIEVhc3kgQVBJIGZvciBjcmVhdGluZyBuZXcgc2V0RmlsdGVycwoJZnVuY3Rpb24gc2V0RmlsdGVycygpIHt9CglzZXRGaWx0ZXJzLnByb3RvdHlwZSA9IEV4cHIuZmlsdGVycyA9IEV4cHIucHNldWRvczsKCUV4cHIuc2V0RmlsdGVycyA9IG5ldyBzZXRGaWx0ZXJzKCk7CgoJdG9rZW5pemUgPSBTaXp6bGUudG9rZW5pemUgPSBmdW5jdGlvbiggc2VsZWN0b3IsIHBhcnNlT25seSApIHsKCQl2YXIgbWF0Y2hlZCwgbWF0Y2gsIHRva2VucywgdHlwZSwKCQkJc29GYXIsIGdyb3VwcywgcHJlRmlsdGVycywKCQkJY2FjaGVkID0gdG9rZW5DYWNoZVsgc2VsZWN0b3IgKyAiICIgXTsKCgkJaWYgKCBjYWNoZWQgKSB7CgkJCXJldHVybiBwYXJzZU9ubHkgPyAwIDogY2FjaGVkLnNsaWNlKCAwICk7CgkJfQoKCQlzb0ZhciA9IHNlbGVjdG9yOwoJCWdyb3VwcyA9IFtdOwoJCXByZUZpbHRlcnMgPSBFeHByLnByZUZpbHRlcjsKCgkJd2hpbGUgKCBzb0ZhciApIHsKCgkJCS8vIENvbW1hIGFuZCBmaXJzdCBydW4KCQkJaWYgKCAhbWF0Y2hlZCB8fCAobWF0Y2ggPSByY29tbWEuZXhlYyggc29GYXIgKSkgKSB7CgkJCQlpZiAoIG1hdGNoICkgewoJCQkJCS8vIERvbid0IGNvbnN1bWUgdHJhaWxpbmcgY29tbWFzIGFzIHZhbGlkCgkJCQkJc29GYXIgPSBzb0Zhci5zbGljZSggbWF0Y2hbMF0ubGVuZ3RoICkgfHwgc29GYXI7CgkJCQl9CgkJCQlncm91cHMucHVzaCggKHRva2VucyA9IFtdKSApOwoJCQl9CgoJCQltYXRjaGVkID0gZmFsc2U7CgoJCQkvLyBDb21iaW5hdG9ycwoJCQlpZiAoIChtYXRjaCA9IHJjb21iaW5hdG9ycy5leGVjKCBzb0ZhciApKSApIHsKCQkJCW1hdGNoZWQgPSBtYXRjaC5zaGlmdCgpOwoJCQkJdG9rZW5zLnB1c2goewoJCQkJCXZhbHVlOiBtYXRjaGVkLAoJCQkJCS8vIENhc3QgZGVzY2VuZGFudCBjb21iaW5hdG9ycyB0byBzcGFjZQoJCQkJCXR5cGU6IG1hdGNoWzBdLnJlcGxhY2UoIHJ0cmltLCAiICIgKQoJCQkJfSk7CgkJCQlzb0ZhciA9IHNvRmFyLnNsaWNlKCBtYXRjaGVkLmxlbmd0aCApOwoJCQl9CgoJCQkvLyBGaWx0ZXJzCgkJCWZvciAoIHR5cGUgaW4gRXhwci5maWx0ZXIgKSB7CgkJCQlpZiAoIChtYXRjaCA9IG1hdGNoRXhwclsgdHlwZSBdLmV4ZWMoIHNvRmFyICkpICYmICghcHJlRmlsdGVyc1sgdHlwZSBdIHx8CgkJCQkJKG1hdGNoID0gcHJlRmlsdGVyc1sgdHlwZSBdKCBtYXRjaCApKSkgKSB7CgkJCQkJbWF0Y2hlZCA9IG1hdGNoLnNoaWZ0KCk7CgkJCQkJdG9rZW5zLnB1c2goewoJCQkJCQl2YWx1ZTogbWF0Y2hlZCwKCQkJCQkJdHlwZTogdHlwZSwKCQkJCQkJbWF0Y2hlczogbWF0Y2gKCQkJCQl9KTsKCQkJCQlzb0ZhciA9IHNvRmFyLnNsaWNlKCBtYXRjaGVkLmxlbmd0aCApOwoJCQkJfQoJCQl9CgoJCQlpZiAoICFtYXRjaGVkICkgewoJCQkJYnJlYWs7CgkJCX0KCQl9CgoJCS8vIFJldHVybiB0aGUgbGVuZ3RoIG9mIHRoZSBpbnZhbGlkIGV4Y2VzcwoJCS8vIGlmIHdlJ3JlIGp1c3QgcGFyc2luZwoJCS8vIE90aGVyd2lzZSwgdGhyb3cgYW4gZXJyb3Igb3IgcmV0dXJuIHRva2VucwoJCXJldHVybiBwYXJzZU9ubHkgPwoJCQlzb0Zhci5sZW5ndGggOgoJCQlzb0ZhciA/CgkJCQlTaXp6bGUuZXJyb3IoIHNlbGVjdG9yICkgOgoJCQkJLy8gQ2FjaGUgdGhlIHRva2VucwoJCQkJdG9rZW5DYWNoZSggc2VsZWN0b3IsIGdyb3VwcyApLnNsaWNlKCAwICk7Cgl9OwoKCWZ1bmN0aW9uIHRvU2VsZWN0b3IoIHRva2VucyApIHsKCQl2YXIgaSA9IDAsCgkJCWxlbiA9IHRva2Vucy5sZW5ndGgsCgkJCXNlbGVjdG9yID0gIiI7CgkJZm9yICggOyBpIDwgbGVuOyBpKysgKSB7CgkJCXNlbGVjdG9yICs9IHRva2Vuc1tpXS52YWx1ZTsKCQl9CgkJcmV0dXJuIHNlbGVjdG9yOwoJfQoKCWZ1bmN0aW9uIGFkZENvbWJpbmF0b3IoIG1hdGNoZXIsIGNvbWJpbmF0b3IsIGJhc2UgKSB7CgkJdmFyIGRpciA9IGNvbWJpbmF0b3IuZGlyLAoJCQljaGVja05vbkVsZW1lbnRzID0gYmFzZSAmJiBkaXIgPT09ICJwYXJlbnROb2RlIiwKCQkJZG9uZU5hbWUgPSBkb25lKys7CgoJCXJldHVybiBjb21iaW5hdG9yLmZpcnN0ID8KCQkJLy8gQ2hlY2sgYWdhaW5zdCBjbG9zZXN0IGFuY2VzdG9yL3ByZWNlZGluZyBlbGVtZW50CgkJCWZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7CgkJCQl3aGlsZSAoIChlbGVtID0gZWxlbVsgZGlyIF0pICkgewoJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBjaGVja05vbkVsZW1lbnRzICkgewoJCQkJCQlyZXR1cm4gbWF0Y2hlciggZWxlbSwgY29udGV4dCwgeG1sICk7CgkJCQkJfQoJCQkJfQoJCQl9IDoKCgkJCS8vIENoZWNrIGFnYWluc3QgYWxsIGFuY2VzdG9yL3ByZWNlZGluZyBlbGVtZW50cwoJCQlmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkgewoJCQkJdmFyIG9sZENhY2hlLCB1bmlxdWVDYWNoZSwgb3V0ZXJDYWNoZSwKCQkJCQluZXdDYWNoZSA9IFsgZGlycnVucywgZG9uZU5hbWUgXTsKCgkJCQkvLyBXZSBjYW4ndCBzZXQgYXJiaXRyYXJ5IGRhdGEgb24gWE1MIG5vZGVzLCBzbyB0aGV5IGRvbid0IGJlbmVmaXQgZnJvbSBjb21iaW5hdG9yIGNhY2hpbmcKCQkJCWlmICggeG1sICkgewoJCQkJCXdoaWxlICggKGVsZW0gPSBlbGVtWyBkaXIgXSkgKSB7CgkJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBjaGVja05vbkVsZW1lbnRzICkgewoJCQkJCQkJaWYgKCBtYXRjaGVyKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHsKCQkJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJd2hpbGUgKCAoZWxlbSA9IGVsZW1bIGRpciBdKSApIHsKCQkJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGNoZWNrTm9uRWxlbWVudHMgKSB7CgkJCQkJCQlvdXRlckNhY2hlID0gZWxlbVsgZXhwYW5kbyBdIHx8IChlbGVtWyBleHBhbmRvIF0gPSB7fSk7CgoJCQkJCQkJLy8gU3VwcG9ydDogSUUgPDkgb25seQoJCQkJCQkJLy8gRGVmZW5kIGFnYWluc3QgY2xvbmVkIGF0dHJvcGVydGllcyAoalF1ZXJ5IGdoLTE3MDkpCgkJCQkJCQl1bmlxdWVDYWNoZSA9IG91dGVyQ2FjaGVbIGVsZW0udW5pcXVlSUQgXSB8fCAob3V0ZXJDYWNoZVsgZWxlbS51bmlxdWVJRCBdID0ge30pOwoKCQkJCQkJCWlmICggKG9sZENhY2hlID0gdW5pcXVlQ2FjaGVbIGRpciBdKSAmJgoJCQkJCQkJCW9sZENhY2hlWyAwIF0gPT09IGRpcnJ1bnMgJiYgb2xkQ2FjaGVbIDEgXSA9PT0gZG9uZU5hbWUgKSB7CgoJCQkJCQkJCS8vIEFzc2lnbiB0byBuZXdDYWNoZSBzbyByZXN1bHRzIGJhY2stcHJvcGFnYXRlIHRvIHByZXZpb3VzIGVsZW1lbnRzCgkJCQkJCQkJcmV0dXJuIChuZXdDYWNoZVsgMiBdID0gb2xkQ2FjaGVbIDIgXSk7CgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCS8vIFJldXNlIG5ld2NhY2hlIHNvIHJlc3VsdHMgYmFjay1wcm9wYWdhdGUgdG8gcHJldmlvdXMgZWxlbWVudHMKCQkJCQkJCQl1bmlxdWVDYWNoZVsgZGlyIF0gPSBuZXdDYWNoZTsKCgkJCQkJCQkJLy8gQSBtYXRjaCBtZWFucyB3ZSdyZSBkb25lOyBhIGZhaWwgbWVhbnMgd2UgaGF2ZSB0byBrZWVwIGNoZWNraW5nCgkJCQkJCQkJaWYgKCAobmV3Q2FjaGVbIDIgXSA9IG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApKSApIHsKCQkJCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9OwoJfQoKCWZ1bmN0aW9uIGVsZW1lbnRNYXRjaGVyKCBtYXRjaGVycyApIHsKCQlyZXR1cm4gbWF0Y2hlcnMubGVuZ3RoID4gMSA/CgkJCWZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7CgkJCQl2YXIgaSA9IG1hdGNoZXJzLmxlbmd0aDsKCQkJCXdoaWxlICggaS0tICkgewoJCQkJCWlmICggIW1hdGNoZXJzW2ldKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHsKCQkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJCX0KCQkJCX0KCQkJCXJldHVybiB0cnVlOwoJCQl9IDoKCQkJbWF0Y2hlcnNbMF07Cgl9CgoJZnVuY3Rpb24gbXVsdGlwbGVDb250ZXh0cyggc2VsZWN0b3IsIGNvbnRleHRzLCByZXN1bHRzICkgewoJCXZhciBpID0gMCwKCQkJbGVuID0gY29udGV4dHMubGVuZ3RoOwoJCWZvciAoIDsgaSA8IGxlbjsgaSsrICkgewoJCQlTaXp6bGUoIHNlbGVjdG9yLCBjb250ZXh0c1tpXSwgcmVzdWx0cyApOwoJCX0KCQlyZXR1cm4gcmVzdWx0czsKCX0KCglmdW5jdGlvbiBjb25kZW5zZSggdW5tYXRjaGVkLCBtYXAsIGZpbHRlciwgY29udGV4dCwgeG1sICkgewoJCXZhciBlbGVtLAoJCQluZXdVbm1hdGNoZWQgPSBbXSwKCQkJaSA9IDAsCgkJCWxlbiA9IHVubWF0Y2hlZC5sZW5ndGgsCgkJCW1hcHBlZCA9IG1hcCAhPSBudWxsOwoKCQlmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQkJaWYgKCAoZWxlbSA9IHVubWF0Y2hlZFtpXSkgKSB7CgkJCQlpZiAoICFmaWx0ZXIgfHwgZmlsdGVyKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHsKCQkJCQluZXdVbm1hdGNoZWQucHVzaCggZWxlbSApOwoJCQkJCWlmICggbWFwcGVkICkgewoJCQkJCQltYXAucHVzaCggaSApOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIG5ld1VubWF0Y2hlZDsKCX0KCglmdW5jdGlvbiBzZXRNYXRjaGVyKCBwcmVGaWx0ZXIsIHNlbGVjdG9yLCBtYXRjaGVyLCBwb3N0RmlsdGVyLCBwb3N0RmluZGVyLCBwb3N0U2VsZWN0b3IgKSB7CgkJaWYgKCBwb3N0RmlsdGVyICYmICFwb3N0RmlsdGVyWyBleHBhbmRvIF0gKSB7CgkJCXBvc3RGaWx0ZXIgPSBzZXRNYXRjaGVyKCBwb3N0RmlsdGVyICk7CgkJfQoJCWlmICggcG9zdEZpbmRlciAmJiAhcG9zdEZpbmRlclsgZXhwYW5kbyBdICkgewoJCQlwb3N0RmluZGVyID0gc2V0TWF0Y2hlciggcG9zdEZpbmRlciwgcG9zdFNlbGVjdG9yICk7CgkJfQoJCXJldHVybiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlZWQsIHJlc3VsdHMsIGNvbnRleHQsIHhtbCApIHsKCQkJdmFyIHRlbXAsIGksIGVsZW0sCgkJCQlwcmVNYXAgPSBbXSwKCQkJCXBvc3RNYXAgPSBbXSwKCQkJCXByZWV4aXN0aW5nID0gcmVzdWx0cy5sZW5ndGgsCgoJCQkJLy8gR2V0IGluaXRpYWwgZWxlbWVudHMgZnJvbSBzZWVkIG9yIGNvbnRleHQKCQkJCWVsZW1zID0gc2VlZCB8fCBtdWx0aXBsZUNvbnRleHRzKCBzZWxlY3RvciB8fCAiKiIsIGNvbnRleHQubm9kZVR5cGUgPyBbIGNvbnRleHQgXSA6IGNvbnRleHQsIFtdICksCgoJCQkJLy8gUHJlZmlsdGVyIHRvIGdldCBtYXRjaGVyIGlucHV0LCBwcmVzZXJ2aW5nIGEgbWFwIGZvciBzZWVkLXJlc3VsdHMgc3luY2hyb25pemF0aW9uCgkJCQltYXRjaGVySW4gPSBwcmVGaWx0ZXIgJiYgKCBzZWVkIHx8ICFzZWxlY3RvciApID8KCQkJCQljb25kZW5zZSggZWxlbXMsIHByZU1hcCwgcHJlRmlsdGVyLCBjb250ZXh0LCB4bWwgKSA6CgkJCQkJZWxlbXMsCgoJCQkJbWF0Y2hlck91dCA9IG1hdGNoZXIgPwoJCQkJCS8vIElmIHdlIGhhdmUgYSBwb3N0RmluZGVyLCBvciBmaWx0ZXJlZCBzZWVkLCBvciBub24tc2VlZCBwb3N0RmlsdGVyIG9yIHByZWV4aXN0aW5nIHJlc3VsdHMsCgkJCQkJcG9zdEZpbmRlciB8fCAoIHNlZWQgPyBwcmVGaWx0ZXIgOiBwcmVleGlzdGluZyB8fCBwb3N0RmlsdGVyICkgPwoKCQkJCQkJLy8gLi4uaW50ZXJtZWRpYXRlIHByb2Nlc3NpbmcgaXMgbmVjZXNzYXJ5CgkJCQkJCVtdIDoKCgkJCQkJCS8vIC4uLm90aGVyd2lzZSB1c2UgcmVzdWx0cyBkaXJlY3RseQoJCQkJCQlyZXN1bHRzIDoKCQkJCQltYXRjaGVySW47CgoJCQkvLyBGaW5kIHByaW1hcnkgbWF0Y2hlcwoJCQlpZiAoIG1hdGNoZXIgKSB7CgkJCQltYXRjaGVyKCBtYXRjaGVySW4sIG1hdGNoZXJPdXQsIGNvbnRleHQsIHhtbCApOwoJCQl9CgoJCQkvLyBBcHBseSBwb3N0RmlsdGVyCgkJCWlmICggcG9zdEZpbHRlciApIHsKCQkJCXRlbXAgPSBjb25kZW5zZSggbWF0Y2hlck91dCwgcG9zdE1hcCApOwoJCQkJcG9zdEZpbHRlciggdGVtcCwgW10sIGNvbnRleHQsIHhtbCApOwoKCQkJCS8vIFVuLW1hdGNoIGZhaWxpbmcgZWxlbWVudHMgYnkgbW92aW5nIHRoZW0gYmFjayB0byBtYXRjaGVySW4KCQkJCWkgPSB0ZW1wLmxlbmd0aDsKCQkJCXdoaWxlICggaS0tICkgewoJCQkJCWlmICggKGVsZW0gPSB0ZW1wW2ldKSApIHsKCQkJCQkJbWF0Y2hlck91dFsgcG9zdE1hcFtpXSBdID0gIShtYXRjaGVySW5bIHBvc3RNYXBbaV0gXSA9IGVsZW0pOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJaWYgKCBzZWVkICkgewoJCQkJaWYgKCBwb3N0RmluZGVyIHx8IHByZUZpbHRlciApIHsKCQkJCQlpZiAoIHBvc3RGaW5kZXIgKSB7CgkJCQkJCS8vIEdldCB0aGUgZmluYWwgbWF0Y2hlck91dCBieSBjb25kZW5zaW5nIHRoaXMgaW50ZXJtZWRpYXRlIGludG8gcG9zdEZpbmRlciBjb250ZXh0cwoJCQkJCQl0ZW1wID0gW107CgkJCQkJCWkgPSBtYXRjaGVyT3V0Lmxlbmd0aDsKCQkJCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQkJCQlpZiAoIChlbGVtID0gbWF0Y2hlck91dFtpXSkgKSB7CgkJCQkJCQkJLy8gUmVzdG9yZSBtYXRjaGVySW4gc2luY2UgZWxlbSBpcyBub3QgeWV0IGEgZmluYWwgbWF0Y2gKCQkJCQkJCQl0ZW1wLnB1c2goIChtYXRjaGVySW5baV0gPSBlbGVtKSApOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCXBvc3RGaW5kZXIoIG51bGwsIChtYXRjaGVyT3V0ID0gW10pLCB0ZW1wLCB4bWwgKTsKCQkJCQl9CgoJCQkJCS8vIE1vdmUgbWF0Y2hlZCBlbGVtZW50cyBmcm9tIHNlZWQgdG8gcmVzdWx0cyB0byBrZWVwIHRoZW0gc3luY2hyb25pemVkCgkJCQkJaSA9IG1hdGNoZXJPdXQubGVuZ3RoOwoJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQlpZiAoIChlbGVtID0gbWF0Y2hlck91dFtpXSkgJiYKCQkJCQkJCSh0ZW1wID0gcG9zdEZpbmRlciA/IGluZGV4T2YoIHNlZWQsIGVsZW0gKSA6IHByZU1hcFtpXSkgPiAtMSApIHsKCgkJCQkJCQlzZWVkW3RlbXBdID0gIShyZXN1bHRzW3RlbXBdID0gZWxlbSk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkvLyBBZGQgZWxlbWVudHMgdG8gcmVzdWx0cywgdGhyb3VnaCBwb3N0RmluZGVyIGlmIGRlZmluZWQKCQkJfSBlbHNlIHsKCQkJCW1hdGNoZXJPdXQgPSBjb25kZW5zZSgKCQkJCQltYXRjaGVyT3V0ID09PSByZXN1bHRzID8KCQkJCQkJbWF0Y2hlck91dC5zcGxpY2UoIHByZWV4aXN0aW5nLCBtYXRjaGVyT3V0Lmxlbmd0aCApIDoKCQkJCQkJbWF0Y2hlck91dAoJCQkJKTsKCQkJCWlmICggcG9zdEZpbmRlciApIHsKCQkJCQlwb3N0RmluZGVyKCBudWxsLCByZXN1bHRzLCBtYXRjaGVyT3V0LCB4bWwgKTsKCQkJCX0gZWxzZSB7CgkJCQkJcHVzaC5hcHBseSggcmVzdWx0cywgbWF0Y2hlck91dCApOwoJCQkJfQoJCQl9CgkJfSk7Cgl9CgoJZnVuY3Rpb24gbWF0Y2hlckZyb21Ub2tlbnMoIHRva2VucyApIHsKCQl2YXIgY2hlY2tDb250ZXh0LCBtYXRjaGVyLCBqLAoJCQlsZW4gPSB0b2tlbnMubGVuZ3RoLAoJCQlsZWFkaW5nUmVsYXRpdmUgPSBFeHByLnJlbGF0aXZlWyB0b2tlbnNbMF0udHlwZSBdLAoJCQlpbXBsaWNpdFJlbGF0aXZlID0gbGVhZGluZ1JlbGF0aXZlIHx8IEV4cHIucmVsYXRpdmVbIiAiXSwKCQkJaSA9IGxlYWRpbmdSZWxhdGl2ZSA/IDEgOiAwLAoKCQkJLy8gVGhlIGZvdW5kYXRpb25hbCBtYXRjaGVyIGVuc3VyZXMgdGhhdCBlbGVtZW50cyBhcmUgcmVhY2hhYmxlIGZyb20gdG9wLWxldmVsIGNvbnRleHQocykKCQkJbWF0Y2hDb250ZXh0ID0gYWRkQ29tYmluYXRvciggZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gZWxlbSA9PT0gY2hlY2tDb250ZXh0OwoJCQl9LCBpbXBsaWNpdFJlbGF0aXZlLCB0cnVlICksCgkJCW1hdGNoQW55Q29udGV4dCA9IGFkZENvbWJpbmF0b3IoIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGluZGV4T2YoIGNoZWNrQ29udGV4dCwgZWxlbSApID4gLTE7CgkJCX0sIGltcGxpY2l0UmVsYXRpdmUsIHRydWUgKSwKCQkJbWF0Y2hlcnMgPSBbIGZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7CgkJCQl2YXIgcmV0ID0gKCAhbGVhZGluZ1JlbGF0aXZlICYmICggeG1sIHx8IGNvbnRleHQgIT09IG91dGVybW9zdENvbnRleHQgKSApIHx8ICgKCQkJCQkoY2hlY2tDb250ZXh0ID0gY29udGV4dCkubm9kZVR5cGUgPwoJCQkJCQltYXRjaENvbnRleHQoIGVsZW0sIGNvbnRleHQsIHhtbCApIDoKCQkJCQkJbWF0Y2hBbnlDb250ZXh0KCBlbGVtLCBjb250ZXh0LCB4bWwgKSApOwoJCQkJLy8gQXZvaWQgaGFuZ2luZyBvbnRvIGVsZW1lbnQgKGlzc3VlICMyOTkpCgkJCQljaGVja0NvbnRleHQgPSBudWxsOwoJCQkJcmV0dXJuIHJldDsKCQkJfSBdOwoKCQlmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQkJaWYgKCAobWF0Y2hlciA9IEV4cHIucmVsYXRpdmVbIHRva2Vuc1tpXS50eXBlIF0pICkgewoJCQkJbWF0Y2hlcnMgPSBbIGFkZENvbWJpbmF0b3IoZWxlbWVudE1hdGNoZXIoIG1hdGNoZXJzICksIG1hdGNoZXIpIF07CgkJCX0gZWxzZSB7CgkJCQltYXRjaGVyID0gRXhwci5maWx0ZXJbIHRva2Vuc1tpXS50eXBlIF0uYXBwbHkoIG51bGwsIHRva2Vuc1tpXS5tYXRjaGVzICk7CgoJCQkJLy8gUmV0dXJuIHNwZWNpYWwgdXBvbiBzZWVpbmcgYSBwb3NpdGlvbmFsIG1hdGNoZXIKCQkJCWlmICggbWF0Y2hlclsgZXhwYW5kbyBdICkgewoJCQkJCS8vIEZpbmQgdGhlIG5leHQgcmVsYXRpdmUgb3BlcmF0b3IgKGlmIGFueSkgZm9yIHByb3BlciBoYW5kbGluZwoJCQkJCWogPSArK2k7CgkJCQkJZm9yICggOyBqIDwgbGVuOyBqKysgKSB7CgkJCQkJCWlmICggRXhwci5yZWxhdGl2ZVsgdG9rZW5zW2pdLnR5cGUgXSApIHsKCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgkJCQkJfQoJCQkJCXJldHVybiBzZXRNYXRjaGVyKAoJCQkJCQlpID4gMSAmJiBlbGVtZW50TWF0Y2hlciggbWF0Y2hlcnMgKSwKCQkJCQkJaSA+IDEgJiYgdG9TZWxlY3RvcigKCQkJCQkJCS8vIElmIHRoZSBwcmVjZWRpbmcgdG9rZW4gd2FzIGEgZGVzY2VuZGFudCBjb21iaW5hdG9yLCBpbnNlcnQgYW4gaW1wbGljaXQgYW55LWVsZW1lbnQgYCpgCgkJCQkJCQl0b2tlbnMuc2xpY2UoIDAsIGkgLSAxICkuY29uY2F0KHsgdmFsdWU6IHRva2Vuc1sgaSAtIDIgXS50eXBlID09PSAiICIgPyAiKiIgOiAiIiB9KQoJCQkJCQkpLnJlcGxhY2UoIHJ0cmltLCAiJDEiICksCgkJCQkJCW1hdGNoZXIsCgkJCQkJCWkgPCBqICYmIG1hdGNoZXJGcm9tVG9rZW5zKCB0b2tlbnMuc2xpY2UoIGksIGogKSApLAoJCQkJCQlqIDwgbGVuICYmIG1hdGNoZXJGcm9tVG9rZW5zKCAodG9rZW5zID0gdG9rZW5zLnNsaWNlKCBqICkpICksCgkJCQkJCWogPCBsZW4gJiYgdG9TZWxlY3RvciggdG9rZW5zICkKCQkJCQkpOwoJCQkJfQoJCQkJbWF0Y2hlcnMucHVzaCggbWF0Y2hlciApOwoJCQl9CgkJfQoKCQlyZXR1cm4gZWxlbWVudE1hdGNoZXIoIG1hdGNoZXJzICk7Cgl9CgoJZnVuY3Rpb24gbWF0Y2hlckZyb21Hcm91cE1hdGNoZXJzKCBlbGVtZW50TWF0Y2hlcnMsIHNldE1hdGNoZXJzICkgewoJCXZhciBieVNldCA9IHNldE1hdGNoZXJzLmxlbmd0aCA+IDAsCgkJCWJ5RWxlbWVudCA9IGVsZW1lbnRNYXRjaGVycy5sZW5ndGggPiAwLAoJCQlzdXBlck1hdGNoZXIgPSBmdW5jdGlvbiggc2VlZCwgY29udGV4dCwgeG1sLCByZXN1bHRzLCBvdXRlcm1vc3QgKSB7CgkJCQl2YXIgZWxlbSwgaiwgbWF0Y2hlciwKCQkJCQltYXRjaGVkQ291bnQgPSAwLAoJCQ==", "base64"));
  res.write(new Buffer("CQkJaSA9ICIwIiwKCQkJCQl1bm1hdGNoZWQgPSBzZWVkICYmIFtdLAoJCQkJCXNldE1hdGNoZWQgPSBbXSwKCQkJCQljb250ZXh0QmFja3VwID0gb3V0ZXJtb3N0Q29udGV4dCwKCQkJCQkvLyBXZSBtdXN0IGFsd2F5cyBoYXZlIGVpdGhlciBzZWVkIGVsZW1lbnRzIG9yIG91dGVybW9zdCBjb250ZXh0CgkJCQkJZWxlbXMgPSBzZWVkIHx8IGJ5RWxlbWVudCAmJiBFeHByLmZpbmRbIlRBRyJdKCAiKiIsIG91dGVybW9zdCApLAoJCQkJCS8vIFVzZSBpbnRlZ2VyIGRpcnJ1bnMgaWZmIHRoaXMgaXMgdGhlIG91dGVybW9zdCBtYXRjaGVyCgkJCQkJZGlycnVuc1VuaXF1ZSA9IChkaXJydW5zICs9IGNvbnRleHRCYWNrdXAgPT0gbnVsbCA/IDEgOiBNYXRoLnJhbmRvbSgpIHx8IDAuMSksCgkJCQkJbGVuID0gZWxlbXMubGVuZ3RoOwoKCQkJCWlmICggb3V0ZXJtb3N0ICkgewoJCQkJCW91dGVybW9zdENvbnRleHQgPSBjb250ZXh0ID09PSBkb2N1bWVudCB8fCBjb250ZXh0IHx8IG91dGVybW9zdDsKCQkJCX0KCgkJCQkvLyBBZGQgZWxlbWVudHMgcGFzc2luZyBlbGVtZW50TWF0Y2hlcnMgZGlyZWN0bHkgdG8gcmVzdWx0cwoJCQkJLy8gU3VwcG9ydDogSUU8OSwgU2FmYXJpCgkJCQkvLyBUb2xlcmF0ZSBOb2RlTGlzdCBwcm9wZXJ0aWVzIChJRTogImxlbmd0aCI7IFNhZmFyaTogPG51bWJlcj4pIG1hdGNoaW5nIGVsZW1lbnRzIGJ5IGlkCgkJCQlmb3IgKCA7IGkgIT09IGxlbiAmJiAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKysgKSB7CgkJCQkJaWYgKCBieUVsZW1lbnQgJiYgZWxlbSApIHsKCQkJCQkJaiA9IDA7CgkJCQkJCWlmICggIWNvbnRleHQgJiYgZWxlbS5vd25lckRvY3VtZW50ICE9PSBkb2N1bWVudCApIHsKCQkJCQkJCXNldERvY3VtZW50KCBlbGVtICk7CgkJCQkJCQl4bWwgPSAhZG9jdW1lbnRJc0hUTUw7CgkJCQkJCX0KCQkJCQkJd2hpbGUgKCAobWF0Y2hlciA9IGVsZW1lbnRNYXRjaGVyc1tqKytdKSApIHsKCQkJCQkJCWlmICggbWF0Y2hlciggZWxlbSwgY29udGV4dCB8fCBkb2N1bWVudCwgeG1sKSApIHsKCQkJCQkJCQlyZXN1bHRzLnB1c2goIGVsZW0gKTsKCQkJCQkJCQlicmVhazsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQlpZiAoIG91dGVybW9zdCApIHsKCQkJCQkJCWRpcnJ1bnMgPSBkaXJydW5zVW5pcXVlOwoJCQkJCQl9CgkJCQkJfQoKCQkJCQkvLyBUcmFjayB1bm1hdGNoZWQgZWxlbWVudHMgZm9yIHNldCBmaWx0ZXJzCgkJCQkJaWYgKCBieVNldCApIHsKCQkJCQkJLy8gVGhleSB3aWxsIGhhdmUgZ29uZSB0aHJvdWdoIGFsbCBwb3NzaWJsZSBtYXRjaGVycwoJCQkJCQlpZiAoIChlbGVtID0gIW1hdGNoZXIgJiYgZWxlbSkgKSB7CgkJCQkJCQltYXRjaGVkQ291bnQtLTsKCQkJCQkJfQoKCQkJCQkJLy8gTGVuZ3RoZW4gdGhlIGFycmF5IGZvciBldmVyeSBlbGVtZW50LCBtYXRjaGVkIG9yIG5vdAoJCQkJCQlpZiAoIHNlZWQgKSB7CgkJCQkJCQl1bm1hdGNoZWQucHVzaCggZWxlbSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCS8vIGBpYCBpcyBub3cgdGhlIGNvdW50IG9mIGVsZW1lbnRzIHZpc2l0ZWQgYWJvdmUsIGFuZCBhZGRpbmcgaXQgdG8gYG1hdGNoZWRDb3VudGAKCQkJCS8vIG1ha2VzIHRoZSBsYXR0ZXIgbm9ubmVnYXRpdmUuCgkJCQltYXRjaGVkQ291bnQgKz0gaTsKCgkJCQkvLyBBcHBseSBzZXQgZmlsdGVycyB0byB1bm1hdGNoZWQgZWxlbWVudHMKCQkJCS8vIE5PVEU6IFRoaXMgY2FuIGJlIHNraXBwZWQgaWYgdGhlcmUgYXJlIG5vIHVubWF0Y2hlZCBlbGVtZW50cyAoaS5lLiwgYG1hdGNoZWRDb3VudGAKCQkJCS8vIGVxdWFscyBgaWApLCB1bmxlc3Mgd2UgZGlkbid0IHZpc2l0IF9hbnlfIGVsZW1lbnRzIGluIHRoZSBhYm92ZSBsb29wIGJlY2F1c2Ugd2UgaGF2ZQoJCQkJLy8gbm8gZWxlbWVudCBtYXRjaGVycyBhbmQgbm8gc2VlZC4KCQkJCS8vIEluY3JlbWVudGluZyBhbiBpbml0aWFsbHktc3RyaW5nICIwIiBgaWAgYWxsb3dzIGBpYCB0byByZW1haW4gYSBzdHJpbmcgb25seSBpbiB0aGF0CgkJCQkvLyBjYXNlLCB3aGljaCB3aWxsIHJlc3VsdCBpbiBhICIwMCIgYG1hdGNoZWRDb3VudGAgdGhhdCBkaWZmZXJzIGZyb20gYGlgIGJ1dCBpcyBhbHNvCgkJCQkvLyBudW1lcmljYWxseSB6ZXJvLgoJCQkJaWYgKCBieVNldCAmJiBpICE9PSBtYXRjaGVkQ291bnQgKSB7CgkJCQkJaiA9IDA7CgkJCQkJd2hpbGUgKCAobWF0Y2hlciA9IHNldE1hdGNoZXJzW2orK10pICkgewoJCQkJCQltYXRjaGVyKCB1bm1hdGNoZWQsIHNldE1hdGNoZWQsIGNvbnRleHQsIHhtbCApOwoJCQkJCX0KCgkJCQkJaWYgKCBzZWVkICkgewoJCQkJCQkvLyBSZWludGVncmF0ZSBlbGVtZW50IG1hdGNoZXMgdG8gZWxpbWluYXRlIHRoZSBuZWVkIGZvciBzb3J0aW5nCgkJCQkJCWlmICggbWF0Y2hlZENvdW50ID4gMCApIHsKCQkJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQkJCWlmICggISh1bm1hdGNoZWRbaV0gfHwgc2V0TWF0Y2hlZFtpXSkgKSB7CgkJCQkJCQkJCXNldE1hdGNoZWRbaV0gPSBwb3AuY2FsbCggcmVzdWx0cyApOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJLy8gRGlzY2FyZCBpbmRleCBwbGFjZWhvbGRlciB2YWx1ZXMgdG8gZ2V0IG9ubHkgYWN0dWFsIG1hdGNoZXMKCQkJCQkJc2V0TWF0Y2hlZCA9IGNvbmRlbnNlKCBzZXRNYXRjaGVkICk7CgkJCQkJfQoKCQkJCQkvLyBBZGQgbWF0Y2hlcyB0byByZXN1bHRzCgkJCQkJcHVzaC5hcHBseSggcmVzdWx0cywgc2V0TWF0Y2hlZCApOwoKCQkJCQkvLyBTZWVkbGVzcyBzZXQgbWF0Y2hlcyBzdWNjZWVkaW5nIG11bHRpcGxlIHN1Y2Nlc3NmdWwgbWF0Y2hlcnMgc3RpcHVsYXRlIHNvcnRpbmcKCQkJCQlpZiAoIG91dGVybW9zdCAmJiAhc2VlZCAmJiBzZXRNYXRjaGVkLmxlbmd0aCA+IDAgJiYKCQkJCQkJKCBtYXRjaGVkQ291bnQgKyBzZXRNYXRjaGVycy5sZW5ndGggKSA+IDEgKSB7CgoJCQkJCQlTaXp6bGUudW5pcXVlU29ydCggcmVzdWx0cyApOwoJCQkJCX0KCQkJCX0KCgkJCQkvLyBPdmVycmlkZSBtYW5pcHVsYXRpb24gb2YgZ2xvYmFscyBieSBuZXN0ZWQgbWF0Y2hlcnMKCQkJCWlmICggb3V0ZXJtb3N0ICkgewoJCQkJCWRpcnJ1bnMgPSBkaXJydW5zVW5pcXVlOwoJCQkJCW91dGVybW9zdENvbnRleHQgPSBjb250ZXh0QmFja3VwOwoJCQkJfQoKCQkJCXJldHVybiB1bm1hdGNoZWQ7CgkJCX07CgoJCXJldHVybiBieVNldCA/CgkJCW1hcmtGdW5jdGlvbiggc3VwZXJNYXRjaGVyICkgOgoJCQlzdXBlck1hdGNoZXI7Cgl9CgoJY29tcGlsZSA9IFNpenpsZS5jb21waWxlID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBtYXRjaCAvKiBJbnRlcm5hbCBVc2UgT25seSAqLyApIHsKCQl2YXIgaSwKCQkJc2V0TWF0Y2hlcnMgPSBbXSwKCQkJZWxlbWVudE1hdGNoZXJzID0gW10sCgkJCWNhY2hlZCA9IGNvbXBpbGVyQ2FjaGVbIHNlbGVjdG9yICsgIiAiIF07CgoJCWlmICggIWNhY2hlZCApIHsKCQkJLy8gR2VuZXJhdGUgYSBmdW5jdGlvbiBvZiByZWN1cnNpdmUgZnVuY3Rpb25zIHRoYXQgY2FuIGJlIHVzZWQgdG8gY2hlY2sgZWFjaCBlbGVtZW50CgkJCWlmICggIW1hdGNoICkgewoJCQkJbWF0Y2ggPSB0b2tlbml6ZSggc2VsZWN0b3IgKTsKCQkJfQoJCQlpID0gbWF0Y2gubGVuZ3RoOwoJCQl3aGlsZSAoIGktLSApIHsKCQkJCWNhY2hlZCA9IG1hdGNoZXJGcm9tVG9rZW5zKCBtYXRjaFtpXSApOwoJCQkJaWYgKCBjYWNoZWRbIGV4cGFuZG8gXSApIHsKCQkJCQlzZXRNYXRjaGVycy5wdXNoKCBjYWNoZWQgKTsKCQkJCX0gZWxzZSB7CgkJCQkJZWxlbWVudE1hdGNoZXJzLnB1c2goIGNhY2hlZCApOwoJCQkJfQoJCQl9CgoJCQkvLyBDYWNoZSB0aGUgY29tcGlsZWQgZnVuY3Rpb24KCQkJY2FjaGVkID0gY29tcGlsZXJDYWNoZSggc2VsZWN0b3IsIG1hdGNoZXJGcm9tR3JvdXBNYXRjaGVycyggZWxlbWVudE1hdGNoZXJzLCBzZXRNYXRjaGVycyApICk7CgoJCQkvLyBTYXZlIHNlbGVjdG9yIGFuZCB0b2tlbml6YXRpb24KCQkJY2FjaGVkLnNlbGVjdG9yID0gc2VsZWN0b3I7CgkJfQoJCXJldHVybiBjYWNoZWQ7Cgl9OwoKCS8qKgoJICogQSBsb3ctbGV2ZWwgc2VsZWN0aW9uIGZ1bmN0aW9uIHRoYXQgd29ya3Mgd2l0aCBTaXp6bGUncyBjb21waWxlZAoJICogIHNlbGVjdG9yIGZ1bmN0aW9ucwoJICogQHBhcmFtIHtTdHJpbmd8RnVuY3Rpb259IHNlbGVjdG9yIEEgc2VsZWN0b3Igb3IgYSBwcmUtY29tcGlsZWQKCSAqICBzZWxlY3RvciBmdW5jdGlvbiBidWlsdCB3aXRoIFNpenpsZS5jb21waWxlCgkgKiBAcGFyYW0ge0VsZW1lbnR9IGNvbnRleHQKCSAqIEBwYXJhbSB7QXJyYXl9IFtyZXN1bHRzXQoJICogQHBhcmFtIHtBcnJheX0gW3NlZWRdIEEgc2V0IG9mIGVsZW1lbnRzIHRvIG1hdGNoIGFnYWluc3QKCSAqLwoJc2VsZWN0ID0gU2l6emxlLnNlbGVjdCA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCwgcmVzdWx0cywgc2VlZCApIHsKCQl2YXIgaSwgdG9rZW5zLCB0b2tlbiwgdHlwZSwgZmluZCwKCQkJY29tcGlsZWQgPSB0eXBlb2Ygc2VsZWN0b3IgPT09ICJmdW5jdGlvbiIgJiYgc2VsZWN0b3IsCgkJCW1hdGNoID0gIXNlZWQgJiYgdG9rZW5pemUoIChzZWxlY3RvciA9IGNvbXBpbGVkLnNlbGVjdG9yIHx8IHNlbGVjdG9yKSApOwoKCQlyZXN1bHRzID0gcmVzdWx0cyB8fCBbXTsKCgkJLy8gVHJ5IHRvIG1pbmltaXplIG9wZXJhdGlvbnMgaWYgdGhlcmUgaXMgb25seSBvbmUgc2VsZWN0b3IgaW4gdGhlIGxpc3QgYW5kIG5vIHNlZWQKCQkvLyAodGhlIGxhdHRlciBvZiB3aGljaCBndWFyYW50ZWVzIHVzIGNvbnRleHQpCgkJaWYgKCBtYXRjaC5sZW5ndGggPT09IDEgKSB7CgoJCQkvLyBSZWR1Y2UgY29udGV4dCBpZiB0aGUgbGVhZGluZyBjb21wb3VuZCBzZWxlY3RvciBpcyBhbiBJRAoJCQl0b2tlbnMgPSBtYXRjaFswXSA9IG1hdGNoWzBdLnNsaWNlKCAwICk7CgkJCWlmICggdG9rZW5zLmxlbmd0aCA+IDIgJiYgKHRva2VuID0gdG9rZW5zWzBdKS50eXBlID09PSAiSUQiICYmCgkJCQkJc3VwcG9ydC5nZXRCeUlkICYmIGNvbnRleHQubm9kZVR5cGUgPT09IDkgJiYgZG9jdW1lbnRJc0hUTUwgJiYKCQkJCQlFeHByLnJlbGF0aXZlWyB0b2tlbnNbMV0udHlwZSBdICkgewoKCQkJCWNvbnRleHQgPSAoIEV4cHIuZmluZFsiSUQiXSggdG9rZW4ubWF0Y2hlc1swXS5yZXBsYWNlKHJ1bmVzY2FwZSwgZnVuZXNjYXBlKSwgY29udGV4dCApIHx8IFtdIClbMF07CgkJCQlpZiAoICFjb250ZXh0ICkgewoJCQkJCXJldHVybiByZXN1bHRzOwoKCQkJCS8vIFByZWNvbXBpbGVkIG1hdGNoZXJzIHdpbGwgc3RpbGwgdmVyaWZ5IGFuY2VzdHJ5LCBzbyBzdGVwIHVwIGEgbGV2ZWwKCQkJCX0gZWxzZSBpZiAoIGNvbXBpbGVkICkgewoJCQkJCWNvbnRleHQgPSBjb250ZXh0LnBhcmVudE5vZGU7CgkJCQl9CgoJCQkJc2VsZWN0b3IgPSBzZWxlY3Rvci5zbGljZSggdG9rZW5zLnNoaWZ0KCkudmFsdWUubGVuZ3RoICk7CgkJCX0KCgkJCS8vIEZldGNoIGEgc2VlZCBzZXQgZm9yIHJpZ2h0LXRvLWxlZnQgbWF0Y2hpbmcKCQkJaSA9IG1hdGNoRXhwclsibmVlZHNDb250ZXh0Il0udGVzdCggc2VsZWN0b3IgKSA/IDAgOiB0b2tlbnMubGVuZ3RoOwoJCQl3aGlsZSAoIGktLSApIHsKCQkJCXRva2VuID0gdG9rZW5zW2ldOwoKCQkJCS8vIEFib3J0IGlmIHdlIGhpdCBhIGNvbWJpbmF0b3IKCQkJCWlmICggRXhwci5yZWxhdGl2ZVsgKHR5cGUgPSB0b2tlbi50eXBlKSBdICkgewoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJaWYgKCAoZmluZCA9IEV4cHIuZmluZFsgdHlwZSBdKSApIHsKCQkJCQkvLyBTZWFyY2gsIGV4cGFuZGluZyBjb250ZXh0IGZvciBsZWFkaW5nIHNpYmxpbmcgY29tYmluYXRvcnMKCQkJCQlpZiAoIChzZWVkID0gZmluZCgKCQkJCQkJdG9rZW4ubWF0Y2hlc1swXS5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLAoJCQkJCQlyc2libGluZy50ZXN0KCB0b2tlbnNbMF0udHlwZSApICYmIHRlc3RDb250ZXh0KCBjb250ZXh0LnBhcmVudE5vZGUgKSB8fCBjb250ZXh0CgkJCQkJKSkgKSB7CgoJCQkJCQkvLyBJZiBzZWVkIGlzIGVtcHR5IG9yIG5vIHRva2VucyByZW1haW4sIHdlIGNhbiByZXR1cm4gZWFybHkKCQkJCQkJdG9rZW5zLnNwbGljZSggaSwgMSApOwoJCQkJCQlzZWxlY3RvciA9IHNlZWQubGVuZ3RoICYmIHRvU2VsZWN0b3IoIHRva2VucyApOwoJCQkJCQlpZiAoICFzZWxlY3RvciApIHsKCQkJCQkJCXB1c2guYXBwbHkoIHJlc3VsdHMsIHNlZWQgKTsKCQkJCQkJCXJldHVybiByZXN1bHRzOwoJCQkJCQl9CgoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCS8vIENvbXBpbGUgYW5kIGV4ZWN1dGUgYSBmaWx0ZXJpbmcgZnVuY3Rpb24gaWYgb25lIGlzIG5vdCBwcm92aWRlZAoJCS8vIFByb3ZpZGUgYG1hdGNoYCB0byBhdm9pZCByZXRva2VuaXphdGlvbiBpZiB3ZSBtb2RpZmllZCB0aGUgc2VsZWN0b3IgYWJvdmUKCQkoIGNvbXBpbGVkIHx8IGNvbXBpbGUoIHNlbGVjdG9yLCBtYXRjaCApICkoCgkJCXNlZWQsCgkJCWNvbnRleHQsCgkJCSFkb2N1bWVudElzSFRNTCwKCQkJcmVzdWx0cywKCQkJIWNvbnRleHQgfHwgcnNpYmxpbmcudGVzdCggc2VsZWN0b3IgKSAmJiB0ZXN0Q29udGV4dCggY29udGV4dC5wYXJlbnROb2RlICkgfHwgY29udGV4dAoJCSk7CgkJcmV0dXJuIHJlc3VsdHM7Cgl9OwoKCS8vIE9uZS10aW1lIGFzc2lnbm1lbnRzCgoJLy8gU29ydCBzdGFiaWxpdHkKCXN1cHBvcnQuc29ydFN0YWJsZSA9IGV4cGFuZG8uc3BsaXQoIiIpLnNvcnQoIHNvcnRPcmRlciApLmpvaW4oIiIpID09PSBleHBhbmRvOwoKCS8vIFN1cHBvcnQ6IENocm9tZSAxNC0zNSsKCS8vIEFsd2F5cyBhc3N1bWUgZHVwbGljYXRlcyBpZiB0aGV5IGFyZW4ndCBwYXNzZWQgdG8gdGhlIGNvbXBhcmlzb24gZnVuY3Rpb24KCXN1cHBvcnQuZGV0ZWN0RHVwbGljYXRlcyA9ICEhaGFzRHVwbGljYXRlOwoKCS8vIEluaXRpYWxpemUgYWdhaW5zdCB0aGUgZGVmYXVsdCBkb2N1bWVudAoJc2V0RG9jdW1lbnQoKTsKCgkvLyBTdXBwb3J0OiBXZWJraXQ8NTM3LjMyIC0gU2FmYXJpIDYuMC4zL0Nocm9tZSAyNSAoZml4ZWQgaW4gQ2hyb21lIDI3KQoJLy8gRGV0YWNoZWQgbm9kZXMgY29uZm91bmRpbmdseSBmb2xsb3cgKmVhY2ggb3RoZXIqCglzdXBwb3J0LnNvcnREZXRhY2hlZCA9IGFzc2VydChmdW5jdGlvbiggZGl2MSApIHsKCQkvLyBTaG91bGQgcmV0dXJuIDEsIGJ1dCByZXR1cm5zIDQgKGZvbGxvd2luZykKCQlyZXR1cm4gZGl2MS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikgKSAmIDE7Cgl9KTsKCgkvLyBTdXBwb3J0OiBJRTw4CgkvLyBQcmV2ZW50IGF0dHJpYnV0ZS9wcm9wZXJ0eSAiaW50ZXJwb2xhdGlvbiIKCS8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9tczUzNjQyOSUyOFZTLjg1JTI5LmFzcHgKCWlmICggIWFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCWRpdi5pbm5lckhUTUwgPSAiPGEgaHJlZj0nIyc+PC9hPiI7CgkJcmV0dXJuIGRpdi5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgiaHJlZiIpID09PSAiIyIgOwoJfSkgKSB7CgkJYWRkSGFuZGxlKCAidHlwZXxocmVmfGhlaWdodHx3aWR0aCIsIGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCBpc1hNTCApIHsKCQkJaWYgKCAhaXNYTUwgKSB7CgkJCQlyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUsIG5hbWUudG9Mb3dlckNhc2UoKSA9PT0gInR5cGUiID8gMSA6IDIgKTsKCQkJfQoJCX0pOwoJfQoKCS8vIFN1cHBvcnQ6IElFPDkKCS8vIFVzZSBkZWZhdWx0VmFsdWUgaW4gcGxhY2Ugb2YgZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpCglpZiAoICFzdXBwb3J0LmF0dHJpYnV0ZXMgfHwgIWFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCWRpdi5pbm5lckhUTUwgPSAiPGlucHV0Lz4iOwoJCWRpdi5maXJzdENoaWxkLnNldEF0dHJpYnV0ZSggInZhbHVlIiwgIiIgKTsKCQlyZXR1cm4gZGl2LmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCAidmFsdWUiICkgPT09ICIiOwoJfSkgKSB7CgkJYWRkSGFuZGxlKCAidmFsdWUiLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7CgkJCWlmICggIWlzWE1MICYmIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gImlucHV0IiApIHsKCQkJCXJldHVybiBlbGVtLmRlZmF1bHRWYWx1ZTsKCQkJfQoJCX0pOwoJfQoKCS8vIFN1cHBvcnQ6IElFPDkKCS8vIFVzZSBnZXRBdHRyaWJ1dGVOb2RlIHRvIGZldGNoIGJvb2xlYW5zIHdoZW4gZ2V0QXR0cmlidXRlIGxpZXMKCWlmICggIWFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCXJldHVybiBkaXYuZ2V0QXR0cmlidXRlKCJkaXNhYmxlZCIpID09IG51bGw7Cgl9KSApIHsKCQlhZGRIYW5kbGUoIGJvb2xlYW5zLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7CgkJCXZhciB2YWw7CgkJCWlmICggIWlzWE1MICkgewoJCQkJcmV0dXJuIGVsZW1bIG5hbWUgXSA9PT0gdHJ1ZSA/IG5hbWUudG9Mb3dlckNhc2UoKSA6CgkJCQkJCSh2YWwgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoIG5hbWUgKSkgJiYgdmFsLnNwZWNpZmllZCA/CgkJCQkJCXZhbC52YWx1ZSA6CgkJCQkJbnVsbDsKCQkJfQoJCX0pOwoJfQoKCXJldHVybiBTaXp6bGU7CgoJfSkoIHdpbmRvdyApOwoKCgoJalF1ZXJ5LmZpbmQgPSBTaXp6bGU7CglqUXVlcnkuZXhwciA9IFNpenpsZS5zZWxlY3RvcnM7CglqUXVlcnkuZXhwclsgIjoiIF0gPSBqUXVlcnkuZXhwci5wc2V1ZG9zOwoJalF1ZXJ5LnVuaXF1ZVNvcnQgPSBqUXVlcnkudW5pcXVlID0gU2l6emxlLnVuaXF1ZVNvcnQ7CglqUXVlcnkudGV4dCA9IFNpenpsZS5nZXRUZXh0OwoJalF1ZXJ5LmlzWE1MRG9jID0gU2l6emxlLmlzWE1MOwoJalF1ZXJ5LmNvbnRhaW5zID0gU2l6emxlLmNvbnRhaW5zOwoKCgoJdmFyIGRpciA9IGZ1bmN0aW9uKCBlbGVtLCBkaXIsIHVudGlsICkgewoJCXZhciBtYXRjaGVkID0gW10sCgkJCXRydW5jYXRlID0gdW50aWwgIT09IHVuZGVmaW5lZDsKCgkJd2hpbGUgKCAoIGVsZW0gPSBlbGVtWyBkaXIgXSApICYmIGVsZW0ubm9kZVR5cGUgIT09IDkgKSB7CgkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSApIHsKCQkJCWlmICggdHJ1bmNhdGUgJiYgalF1ZXJ5KCBlbGVtICkuaXMoIHVudGlsICkgKSB7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQltYXRjaGVkLnB1c2goIGVsZW0gKTsKCQkJfQoJCX0KCQlyZXR1cm4gbWF0Y2hlZDsKCX07CgoKCXZhciBzaWJsaW5ncyA9IGZ1bmN0aW9uKCBuLCBlbGVtICkgewoJCXZhciBtYXRjaGVkID0gW107CgoJCWZvciAoIDsgbjsgbiA9IG4ubmV4dFNpYmxpbmcgKSB7CgkJCWlmICggbi5ub2RlVHlwZSA9PT0gMSAmJiBuICE9PSBlbGVtICkgewoJCQkJbWF0Y2hlZC5wdXNoKCBuICk7CgkJCX0KCQl9CgoJCXJldHVybiBtYXRjaGVkOwoJfTsKCgoJdmFyIHJuZWVkc0NvbnRleHQgPSBqUXVlcnkuZXhwci5tYXRjaC5uZWVkc0NvbnRleHQ7CgoJdmFyIHJzaW5nbGVUYWcgPSAoIC9ePChbXHctXSspXHMqXC8/Pig/OjxcL1wxPnwpJC8gKTsKCgoKCXZhciByaXNTaW1wbGUgPSAvXi5bXjojXFtcLixdKiQvOwoKCS8vIEltcGxlbWVudCB0aGUgaWRlbnRpY2FsIGZ1bmN0aW9uYWxpdHkgZm9yIGZpbHRlciBhbmQgbm90CglmdW5jdGlvbiB3aW5ub3coIGVsZW1lbnRzLCBxdWFsaWZpZXIsIG5vdCApIHsKCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBxdWFsaWZpZXIgKSApIHsKCQkJcmV0dXJuIGpRdWVyeS5ncmVwKCBlbGVtZW50cywgZnVuY3Rpb24oIGVsZW0sIGkgKSB7CgkJCQkvKiBqc2hpbnQgLVcwMTggKi8KCQkJCXJldHVybiAhIXF1YWxpZmllci5jYWxsKCBlbGVtLCBpLCBlbGVtICkgIT09IG5vdDsKCQkJfSApOwoKCQl9CgoJCWlmICggcXVhbGlmaWVyLm5vZGVUeXBlICkgewoJCQlyZXR1cm4galF1ZXJ5LmdyZXAoIGVsZW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiAoIGVsZW0gPT09IHF1YWxpZmllciApICE9PSBub3Q7CgkJCX0gKTsKCgkJfQoKCQlpZiAoIHR5cGVvZiBxdWFsaWZpZXIgPT09ICJzdHJpbmciICkgewoJCQlpZiAoIHJpc1NpbXBsZS50ZXN0KCBxdWFsaWZpZXIgKSApIHsKCQkJCXJldHVybiBqUXVlcnkuZmlsdGVyKCBxdWFsaWZpZXIsIGVsZW1lbnRzLCBub3QgKTsKCQkJfQoKCQkJcXVhbGlmaWVyID0galF1ZXJ5LmZpbHRlciggcXVhbGlmaWVyLCBlbGVtZW50cyApOwoJCX0KCgkJcmV0dXJuIGpRdWVyeS5ncmVwKCBlbGVtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXJldHVybiAoIGpRdWVyeS5pbkFycmF5KCBlbGVtLCBxdWFsaWZpZXIgKSA+IC0xICkgIT09IG5vdDsKCQl9ICk7Cgl9CgoJalF1ZXJ5LmZpbHRlciA9IGZ1bmN0aW9uKCBleHByLCBlbGVtcywgbm90ICkgewoJCXZhciBlbGVtID0gZWxlbXNbIDAgXTsKCgkJaWYgKCBub3QgKSB7CgkJCWV4cHIgPSAiOm5vdCgiICsgZXhwciArICIpIjsKCQl9CgoJCXJldHVybiBlbGVtcy5sZW5ndGggPT09IDEgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSA/CgkJCWpRdWVyeS5maW5kLm1hdGNoZXNTZWxlY3RvciggZWxlbSwgZXhwciApID8gWyBlbGVtIF0gOiBbXSA6CgkJCWpRdWVyeS5maW5kLm1hdGNoZXMoIGV4cHIsIGpRdWVyeS5ncmVwKCBlbGVtcywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gZWxlbS5ub2RlVHlwZSA9PT0gMTsKCQkJfSApICk7Cgl9OwoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCQlmaW5kOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXZhciBpLAoJCQkJcmV0ID0gW10sCgkJCQlzZWxmID0gdGhpcywKCQkJCWxlbiA9IHNlbGYubGVuZ3RoOwoKCQkJaWYgKCB0eXBlb2Ygc2VsZWN0b3IgIT09ICJzdHJpbmciICkgewoJCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqUXVlcnkoIHNlbGVjdG9yICkuZmlsdGVyKCBmdW5jdGlvbigpIHsKCQkJCQlmb3IgKCBpID0gMDsgaSA8IGxlbjsgaSsrICkgewoJCQkJCQlpZiAoIGpRdWVyeS5jb250YWlucyggc2VsZlsgaSBdLCB0aGlzICkgKSB7CgkJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0gKSApOwoJCQl9CgoJCQlmb3IgKCBpID0gMDsgaSA8IGxlbjsgaSsrICkgewoJCQkJalF1ZXJ5LmZpbmQoIHNlbGVjdG9yLCBzZWxmWyBpIF0sIHJldCApOwoJCQl9CgoJCQkvLyBOZWVkZWQgYmVjYXVzZSAkKCBzZWxlY3RvciwgY29udGV4dCApIGJlY29tZXMgJCggY29udGV4dCApLmZpbmQoIHNlbGVjdG9yICkKCQkJcmV0ID0gdGhpcy5wdXNoU3RhY2soIGxlbiA+IDEgPyBqUXVlcnkudW5pcXVlKCByZXQgKSA6IHJldCApOwoJCQlyZXQuc2VsZWN0b3IgPSB0aGlzLnNlbGVjdG9yID8gdGhpcy5zZWxlY3RvciArICIgIiArIHNlbGVjdG9yIDogc2VsZWN0b3I7CgkJCXJldHVybiByZXQ7CgkJfSwKCQlmaWx0ZXI6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCB3aW5ub3coIHRoaXMsIHNlbGVjdG9yIHx8IFtdLCBmYWxzZSApICk7CgkJfSwKCQlub3Q6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCB3aW5ub3coIHRoaXMsIHNlbGVjdG9yIHx8IFtdLCB0cnVlICkgKTsKCQl9LAoJCWlzOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXJldHVybiAhIXdpbm5vdygKCQkJCXRoaXMsCgoJCQkJLy8gSWYgdGhpcyBpcyBhIHBvc2l0aW9uYWwvcmVsYXRpdmUgc2VsZWN0b3IsIGNoZWNrIG1lbWJlcnNoaXAgaW4gdGhlIHJldHVybmVkIHNldAoJCQkJLy8gc28gJCgicDpmaXJzdCIpLmlzKCJwOmxhc3QiKSB3b24ndCByZXR1cm4gdHJ1ZSBmb3IgYSBkb2Mgd2l0aCB0d28gInAiLgoJCQkJdHlwZW9mIHNlbGVjdG9yID09PSAic3RyaW5nIiAmJiBybmVlZHNDb250ZXh0LnRlc3QoIHNlbGVjdG9yICkgPwoJCQkJCWpRdWVyeSggc2VsZWN0b3IgKSA6CgkJCQkJc2VsZWN0b3IgfHwgW10sCgkJCQlmYWxzZQoJCQkpLmxlbmd0aDsKCQl9Cgl9ICk7CgoKCS8vIEluaXRpYWxpemUgYSBqUXVlcnkgb2JqZWN0CgoKCS8vIEEgY2VudHJhbCByZWZlcmVuY2UgdG8gdGhlIHJvb3QgalF1ZXJ5KGRvY3VtZW50KQoJdmFyIHJvb3RqUXVlcnksCgoJCS8vIEEgc2ltcGxlIHdheSB0byBjaGVjayBmb3IgSFRNTCBzdHJpbmdzCgkJLy8gUHJpb3JpdGl6ZSAjaWQgb3ZlciA8dGFnPiB0byBhdm9pZCBYU1MgdmlhIGxvY2F0aW9uLmhhc2ggKCM5NTIxKQoJCS8vIFN0cmljdCBIVE1MIHJlY29nbml0aW9uICgjMTEyOTA6IG11c3Qgc3RhcnQgd2l0aCA8KQoJCXJxdWlja0V4cHIgPSAvXig/OlxzKig8W1x3XFddKz4pW14+XSp8IyhbXHctXSopKSQvLAoKCQlpbml0ID0galF1ZXJ5LmZuLmluaXQgPSBmdW5jdGlvbiggc2VsZWN0b3IsIGNvbnRleHQsIHJvb3QgKSB7CgkJCXZhciBtYXRjaCwgZWxlbTsKCgkJCS8vIEhBTkRMRTogJCgiIiksICQobnVsbCksICQodW5kZWZpbmVkKSwgJChmYWxzZSkKCQkJaWYgKCAhc2VsZWN0b3IgKSB7CgkJCQlyZXR1cm4gdGhpczsKCQkJfQoKCQkJLy8gaW5pdCBhY2NlcHRzIGFuIGFsdGVybmF0ZSByb290alF1ZXJ5CgkJCS8vIHNvIG1pZ3JhdGUgY2FuIHN1cHBvcnQgalF1ZXJ5LnN1YiAoZ2gtMjEwMSkKCQkJcm9vdCA9IHJvb3QgfHwgcm9vdGpRdWVyeTsKCgkJCS8vIEhhbmRsZSBIVE1MIHN0cmluZ3MKCQkJaWYgKCB0eXBlb2Ygc2VsZWN0b3IgPT09ICJzdHJpbmciICkgewoJCQkJaWYgKCBzZWxlY3Rvci5jaGFyQXQoIDAgKSA9PT0gIjwiICYmCgkJCQkJc2VsZWN0b3IuY2hhckF0KCBzZWxlY3Rvci5sZW5ndGggLSAxICkgPT09ICI+IiAmJgoJCQkJCXNlbGVjdG9yLmxlbmd0aCA+PSAzICkgewoKCQkJCQkvLyBBc3N1bWUgdGhhdCBzdHJpbmdzIHRoYXQgc3RhcnQgYW5kIGVuZCB3aXRoIDw+IGFyZSBIVE1MIGFuZCBza2lwIHRoZSByZWdleCBjaGVjawoJCQkJCW1hdGNoID0gWyBudWxsLCBzZWxlY3RvciwgbnVsbCBdOwoKCQkJCX0gZWxzZSB7CgkJCQkJbWF0Y2ggPSBycXVpY2tFeHByLmV4ZWMoIHNlbGVjdG9yICk7CgkJCQl9CgoJCQkJLy8gTWF0Y2ggaHRtbCBvciBtYWtlIHN1cmUgbm8gY29udGV4dCBpcyBzcGVjaWZpZWQgZm9yICNpZAoJCQkJaWYgKCBtYXRjaCAmJiAoIG1hdGNoWyAxIF0gfHwgIWNvbnRleHQgKSApIHsKCgkJCQkJLy8gSEFORExFOiAkKGh0bWwpIC0+ICQoYXJyYXkpCgkJCQkJaWYgKCBtYXRjaFsgMSBdICkgewoJCQkJCQljb250ZXh0ID0gY29udGV4dCBpbnN0YW5jZW9mIGpRdWVyeSA/IGNvbnRleHRbIDAgXSA6IGNvbnRleHQ7CgoJCQkJCQkvLyBzY3JpcHRzIGlzIHRydWUgZm9yIGJhY2stY29tcGF0CgkJCQkJCS8vIEludGVudGlvbmFsbHkgbGV0IHRoZSBlcnJvciBiZSB0aHJvd24gaWYgcGFyc2VIVE1MIGlzIG5vdCBwcmVzZW50CgkJCQkJCWpRdWVyeS5tZXJnZSggdGhpcywgalF1ZXJ5LnBhcnNlSFRNTCgKCQkJCQkJCW1hdGNoWyAxIF0sCgkJCQkJCQljb250ZXh0ICYmIGNvbnRleHQubm9kZVR5cGUgPyBjb250ZXh0Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dCA6IGRvY3VtZW50LAoJCQkJCQkJdHJ1ZQoJCQkJCQkpICk7CgoJCQkJCQkvLyBIQU5ETEU6ICQoaHRtbCwgcHJvcHMpCgkJCQkJCWlmICggcnNpbmdsZVRhZy50ZXN0KCBtYXRjaFsgMSBdICkgJiYgalF1ZXJ5LmlzUGxhaW5PYmplY3QoIGNvbnRleHQgKSApIHsKCQkJCQkJCWZvciAoIG1hdGNoIGluIGNvbnRleHQgKSB7CgoJCQkJCQkJCS8vIFByb3BlcnRpZXMgb2YgY29udGV4dCBhcmUgY2FsbGVkIGFzIG1ldGhvZHMgaWYgcG9zc2libGUKCQkJCQkJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB0aGlzWyBtYXRjaCBdICkgKSB7CgkJCQkJCQkJCXRoaXNbIG1hdGNoIF0oIGNvbnRleHRbIG1hdGNoIF0gKTsKCgkJCQkJCQkJLy8gLi4uYW5kIG90aGVyd2lzZSBzZXQgYXMgYXR0cmlidXRlcwoJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCXRoaXMuYXR0ciggbWF0Y2gsIGNvbnRleHRbIG1hdGNoIF0gKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCXJldHVybiB0aGlzOwoKCQkJCQkvLyBIQU5ETEU6ICQoI2lkKQoJCQkJCX0gZWxzZSB7CgkJCQkJCWVsZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggbWF0Y2hbIDIgXSApOwoKCQkJCQkJLy8gQ2hlY2sgcGFyZW50Tm9kZSB0byBjYXRjaCB3aGVuIEJsYWNrYmVycnkgNC42IHJldHVybnMKCQkJCQkJLy8gbm9kZXMgdGhhdCBhcmUgbm8gbG9uZ2VyIGluIHRoZSBkb2N1bWVudCAjNjk2MwoJCQkJCQlpZiAoIGVsZW0gJiYgZWxlbS5wYXJlbnROb2RlICkgewoKCQkJCQkJCS8vIEhhbmRsZSB0aGUgY2FzZSB3aGVyZSBJRSBhbmQgT3BlcmEgcmV0dXJuIGl0ZW1zCgkJCQkJCQkvLyBieSBuYW1lIGluc3RlYWQgb2YgSUQKCQkJCQkJCWlmICggZWxlbS5pZCAhPT0gbWF0Y2hbIDIgXSApIHsKCQkJCQkJCQlyZXR1cm4gcm9vdGpRdWVyeS5maW5kKCBzZWxlY3RvciApOwoJCQkJCQkJfQoKCQkJCQkJCS8vIE90aGVyd2lzZSwgd2UgaW5qZWN0IHRoZSBlbGVtZW50IGRpcmVjdGx5IGludG8gdGhlIGpRdWVyeSBvYmplY3QKCQkJCQkJCXRoaXMubGVuZ3RoID0gMTsKCQkJCQkJCXRoaXNbIDAgXSA9IGVsZW07CgkJCQkJCX0KCgkJCQkJCXRoaXMuY29udGV4dCA9IGRvY3VtZW50OwoJCQkJCQl0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7CgkJCQkJCXJldHVybiB0aGlzOwoJCQkJCX0KCgkJCQkvLyBIQU5ETEU6ICQoZXhwciwgJCguLi4pKQoJCQkJfSBlbHNlIGlmICggIWNvbnRleHQgfHwgY29udGV4dC5qcXVlcnkgKSB7CgkJCQkJcmV0dXJuICggY29udGV4dCB8fCByb290ICkuZmluZCggc2VsZWN0b3IgKTsKCgkJCQkvLyBIQU5ETEU6ICQoZXhwciwgY29udGV4dCkKCQkJCS8vICh3aGljaCBpcyBqdXN0IGVxdWl2YWxlbnQgdG86ICQoY29udGV4dCkuZmluZChleHByKQoJCQkJfSBlbHNlIHsKCQkJCQlyZXR1cm4gdGhpcy5jb25zdHJ1Y3RvciggY29udGV4dCApLmZpbmQoIHNlbGVjdG9yICk7CgkJCQl9CgoJCQkvLyBIQU5ETEU6ICQoRE9NRWxlbWVudCkKCQkJfSBlbHNlIGlmICggc2VsZWN0b3Iubm9kZVR5cGUgKSB7CgkJCQl0aGlzLmNvbnRleHQgPSB0aGlzWyAwIF0gPSBzZWxlY3RvcjsKCQkJCXRoaXMubGVuZ3RoID0gMTsKCQkJCXJldHVybiB0aGlzOwoKCQkJLy8gSEFORExFOiAkKGZ1bmN0aW9uKQoJCQkvLyBTaG9ydGN1dCBmb3IgZG9jdW1lbnQgcmVhZHkKCQkJfSBlbHNlIGlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHNlbGVjdG9yICkgKSB7CgkJCQlyZXR1cm4gdHlwZW9mIHJvb3QucmVhZHkgIT09ICJ1bmRlZmluZWQiID8KCQkJCQlyb290LnJlYWR5KCBzZWxlY3RvciApIDoKCgkJCQkJLy8gRXhlY3V0ZSBpbW1lZGlhdGVseSBpZiByZWFkeSBpcyBub3QgcHJlc2VudAoJCQkJCXNlbGVjdG9yKCBqUXVlcnkgKTsKCQkJfQoKCQkJaWYgKCBzZWxlY3Rvci5zZWxlY3RvciAhPT0gdW5kZWZpbmVkICkgewoJCQkJdGhpcy5zZWxlY3RvciA9IHNlbGVjdG9yLnNlbGVjdG9yOwoJCQkJdGhpcy5jb250ZXh0ID0gc2VsZWN0b3IuY29udGV4dDsKCQkJfQoKCQkJcmV0dXJuIGpRdWVyeS5tYWtlQXJyYXkoIHNlbGVjdG9yLCB0aGlzICk7CgkJfTsKCgkvLyBHaXZlIHRoZSBpbml0IGZ1bmN0aW9uIHRoZSBqUXVlcnkgcHJvdG90eXBlIGZvciBsYXRlciBpbnN0YW50aWF0aW9uCglpbml0LnByb3RvdHlwZSA9IGpRdWVyeS5mbjsKCgkvLyBJbml0aWFsaXplIGNlbnRyYWwgcmVmZXJlbmNlCglyb290alF1ZXJ5ID0galF1ZXJ5KCBkb2N1bWVudCApOwoKCgl2YXIgcnBhcmVudHNwcmV2ID0gL14oPzpwYXJlbnRzfHByZXYoPzpVbnRpbHxBbGwpKS8sCgoJCS8vIG1ldGhvZHMgZ3VhcmFudGVlZCB0byBwcm9kdWNlIGEgdW5pcXVlIHNldCB3aGVuIHN0YXJ0aW5nIGZyb20gYSB1bmlxdWUgc2V0CgkJZ3VhcmFudGVlZFVuaXF1ZSA9IHsKCQkJY2hpbGRyZW46IHRydWUsCgkJCWNvbnRlbnRzOiB0cnVlLAoJCQluZXh0OiB0cnVlLAoJCQlwcmV2OiB0cnVlCgkJfTsKCglqUXVlcnkuZm4uZXh0ZW5kKCB7CgkJaGFzOiBmdW5jdGlvbiggdGFyZ2V0ICkgewoJCQl2YXIgaSwKCQkJCXRhcmdldHMgPSBqUXVlcnkoIHRhcmdldCwgdGhpcyApLAoJCQkJbGVuID0gdGFyZ2V0cy5sZW5ndGg7CgoJCQlyZXR1cm4gdGhpcy5maWx0ZXIoIGZ1bmN0aW9uKCkgewoJCQkJZm9yICggaSA9IDA7IGkgPCBsZW47IGkrKyApIHsKCQkJCQlpZiAoIGpRdWVyeS5jb250YWlucyggdGhpcywgdGFyZ2V0c1sgaSBdICkgKSB7CgkJCQkJCXJldHVybiB0cnVlOwoJCQkJCX0KCQkJCX0KCQkJfSApOwoJCX0sCgoJCWNsb3Nlc3Q6IGZ1bmN0aW9uKCBzZWxlY3RvcnMsIGNvbnRleHQgKSB7CgkJCXZhciBjdXIsCgkJCQlpID0gMCwKCQkJCWwgPSB0aGlzLmxlbmd0aCwKCQkJCW1hdGNoZWQgPSBbXSwKCQkJCXBvcyA9IHJuZWVkc0NvbnRleHQudGVzdCggc2VsZWN0b3JzICkgfHwgdHlwZW9mIHNlbGVjdG9ycyAhPT0gInN0cmluZyIgPwoJCQkJCWpRdWVyeSggc2VsZWN0b3JzLCBjb250ZXh0IHx8IHRoaXMuY29udGV4dCApIDoKCQkJCQkwOwoKCQkJZm9yICggOyBpIDwgbDsgaSsrICkgewoJCQkJZm9yICggY3VyID0gdGhpc1sgaSBdOyBjdXIgJiYgY3VyICE9PSBjb250ZXh0OyBjdXIgPSBjdXIucGFyZW50Tm9kZSApIHsKCgkJCQkJLy8gQWx3YXlzIHNraXAgZG9jdW1lbnQgZnJhZ21lbnRzCgkJCQkJaWYgKCBjdXIubm9kZVR5cGUgPCAxMSAmJiAoIHBvcyA/CgkJCQkJCXBvcy5pbmRleCggY3VyICkgPiAtMSA6CgoJCQkJCQkvLyBEb24ndCBwYXNzIG5vbi1lbGVtZW50cyB0byBTaXp6bGUKCQkJCQkJY3VyLm5vZGVUeXBlID09PSAxICYmCgkJCQkJCQlqUXVlcnkuZmluZC5tYXRjaGVzU2VsZWN0b3IoIGN1ciwgc2VsZWN0b3JzICkgKSApIHsKCgkJCQkJCW1hdGNoZWQucHVzaCggY3VyICk7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBtYXRjaGVkLmxlbmd0aCA+IDEgPyBqUXVlcnkudW5pcXVlU29ydCggbWF0Y2hlZCApIDogbWF0Y2hlZCApOwoJCX0sCgoJCS8vIERldGVybWluZSB0aGUgcG9zaXRpb24gb2YgYW4gZWxlbWVudCB3aXRoaW4KCQkvLyB0aGUgbWF0Y2hlZCBzZXQgb2YgZWxlbWVudHMKCQlpbmRleDogZnVuY3Rpb24oIGVsZW0gKSB7CgoJCQkvLyBObyBhcmd1bWVudCwgcmV0dXJuIGluZGV4IGluIHBhcmVudAoJCQlpZiAoICFlbGVtICkgewoJCQkJcmV0dXJuICggdGhpc1sgMCBdICYmIHRoaXNbIDAgXS5wYXJlbnROb2RlICkgPyB0aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aCA6IC0xOwoJCQl9CgoJCQkvLyBpbmRleCBpbiBzZWxlY3RvcgoJCQlpZiAoIHR5cGVvZiBlbGVtID09PSAic3RyaW5nIiApIHsKCQkJCXJldHVybiBqUXVlcnkuaW5BcnJheSggdGhpc1sgMCBdLCBqUXVlcnkoIGVsZW0gKSApOwoJCQl9CgoJCQkvLyBMb2NhdGUgdGhlIHBvc2l0aW9uIG9mIHRoZSBkZXNpcmVkIGVsZW1lbnQKCQkJcmV0dXJuIGpRdWVyeS5pbkFycmF5KAoKCQkJCS8vIElmIGl0IHJlY2VpdmVzIGEgalF1ZXJ5IG9iamVjdCwgdGhlIGZpcnN0IGVsZW1lbnQgaXMgdXNlZAoJCQkJZWxlbS5qcXVlcnkgPyBlbGVtWyAwIF0gOiBlbGVtLCB0aGlzICk7CgkJfSwKCgkJYWRkOiBmdW5jdGlvbiggc2VsZWN0b3IsIGNvbnRleHQgKSB7CgkJCXJldHVybiB0aGlzLnB1c2hTdGFjaygKCQkJCWpRdWVyeS51bmlxdWVTb3J0KAoJCQkJCWpRdWVyeS5tZXJnZSggdGhpcy5nZXQoKSwgalF1ZXJ5KCBzZWxlY3RvciwgY29udGV4dCApICkKCQkJCSkKCQkJKTsKCQl9LAoKCQlhZGRCYWNrOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXJldHVybiB0aGlzLmFkZCggc2VsZWN0b3IgPT0gbnVsbCA/CgkJCQl0aGlzLnByZXZPYmplY3QgOiB0aGlzLnByZXZPYmplY3QuZmlsdGVyKCBzZWxlY3RvciApCgkJCSk7CgkJfQoJfSApOwoKCWZ1bmN0aW9uIHNpYmxpbmcoIGN1ciwgZGlyICkgewoJCWRvIHsKCQkJY3VyID0gY3VyWyBkaXIgXTsKCQl9IHdoaWxlICggY3VyICYmIGN1ci5ub2RlVHlwZSAhPT0gMSApOwoKCQlyZXR1cm4gY3VyOwoJfQoKCWpRdWVyeS5lYWNoKCB7CgkJcGFyZW50OiBmdW5jdGlvbiggZWxlbSApIHsKCQkJdmFyIHBhcmVudCA9IGVsZW0ucGFyZW50Tm9kZTsKCQkJcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQubm9kZVR5cGUgIT09IDExID8gcGFyZW50IDogbnVsbDsKCQl9LAoJCXBhcmVudHM6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gZGlyKCBlbGVtLCAicGFyZW50Tm9kZSIgKTsKCQl9LAoJCXBhcmVudHNVbnRpbDogZnVuY3Rpb24oIGVsZW0sIGksIHVudGlsICkgewoJCQlyZXR1cm4gZGlyKCBlbGVtLCAicGFyZW50Tm9kZSIsIHVudGlsICk7CgkJfSwKCQluZXh0OiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIHNpYmxpbmcoIGVsZW0sICJuZXh0U2libGluZyIgKTsKCQl9LAoJCXByZXY6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gc2libGluZyggZWxlbSwgInByZXZpb3VzU2libGluZyIgKTsKCQl9LAoJCW5leHRBbGw6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gZGlyKCBlbGVtLCAibmV4dFNpYmxpbmciICk7CgkJfSwKCQlwcmV2QWxsOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIGRpciggZWxlbSwgInByZXZpb3VzU2libGluZyIgKTsKCQl9LAoJCW5leHRVbnRpbDogZnVuY3Rpb24oIGVsZW0sIGksIHVudGlsICkgewoJCQlyZXR1cm4gZGlyKCBlbGVtLCAibmV4dFNpYmxpbmciLCB1bnRpbCApOwoJCX0sCgkJcHJldlVudGlsOiBmdW5jdGlvbiggZWxlbSwgaSwgdW50aWwgKSB7CgkJCXJldHVybiBkaXIoIGVsZW0sICJwcmV2aW91c1NpYmxpbmciLCB1bnRpbCApOwoJCX0sCgkJc2libGluZ3M6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gc2libGluZ3MoICggZWxlbS5wYXJlbnROb2RlIHx8IHt9ICkuZmlyc3RDaGlsZCwgZWxlbSApOwoJCX0sCgkJY2hpbGRyZW46IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gc2libGluZ3MoIGVsZW0uZmlyc3RDaGlsZCApOwoJCX0sCgkJY29udGVudHM6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCAiaWZyYW1lIiApID8KCQkJCWVsZW0uY29udGVudERvY3VtZW50IHx8IGVsZW0uY29udGVudFdpbmRvdy5kb2N1bWVudCA6CgkJCQlqUXVlcnkubWVyZ2UoIFtdLCBlbGVtLmNoaWxkTm9kZXMgKTsKCQl9Cgl9LCBmdW5jdGlvbiggbmFtZSwgZm4gKSB7CgkJalF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggdW50aWwsIHNlbGVjdG9yICkgewoJCQl2YXIgcmV0ID0galF1ZXJ5Lm1hcCggdGhpcywgZm4sIHVudGlsICk7CgoJCQlpZiAoIG5hbWUuc2xpY2UoIC01ICkgIT09ICJVbnRpbCIgKSB7CgkJCQlzZWxlY3RvciA9IHVudGlsOwoJCQl9CgoJCQlpZiAoIHNlbGVjdG9yICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gInN0cmluZyIgKSB7CgkJCQlyZXQgPSBqUXVlcnkuZmlsdGVyKCBzZWxlY3RvciwgcmV0ICk7CgkJCX0KCgkJCWlmICggdGhpcy5sZW5ndGggPiAxICkgewoKCQkJCS8vIFJlbW92ZSBkdXBsaWNhdGVzCgkJCQlpZiAoICFndWFyYW50ZWVkVW5pcXVlWyBuYW1lIF0gKSB7CgkJCQkJcmV0ID0galF1ZXJ5LnVuaXF1ZVNvcnQoIHJldCApOwoJCQkJfQoKCQkJCS8vIFJldmVyc2Ugb3JkZXIgZm9yIHBhcmVudHMqIGFuZCBwcmV2LWRlcml2YXRpdmVzCgkJCQlpZiAoIHJwYXJlbnRzcHJldi50ZXN0KCBuYW1lICkgKSB7CgkJCQkJcmV0ID0gcmV0LnJldmVyc2UoKTsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCByZXQgKTsKCQl9OwoJfSApOwoJdmFyIHJub3R3aGl0ZSA9ICggL1xTKy9nICk7CgoKCgkvLyBDb252ZXJ0IFN0cmluZy1mb3JtYXR0ZWQgb3B0aW9ucyBpbnRvIE9iamVjdC1mb3JtYXR0ZWQgb25lcwoJZnVuY3Rpb24gY3JlYXRlT3B0aW9ucyggb3B0aW9ucyApIHsKCQl2YXIgb2JqZWN0ID0ge307CgkJalF1ZXJ5LmVhY2goIG9wdGlvbnMubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdLCBmdW5jdGlvbiggXywgZmxhZyApIHsKCQkJb2JqZWN0WyBmbGFnIF0gPSB0cnVlOwoJCX0gKTsKCQlyZXR1cm4gb2JqZWN0OwoJfQoKCS8qCgkgKiBDcmVhdGUgYSBjYWxsYmFjayBsaXN0IHVzaW5nIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVyczoKCSAqCgkgKglvcHRpb25zOiBhbiBvcHRpb25hbCBsaXN0IG9mIHNwYWNlLXNlcGFyYXRlZCBvcHRpb25zIHRoYXQgd2lsbCBjaGFuZ2UgaG93CgkgKgkJCXRoZSBjYWxsYmFjayBsaXN0IGJlaGF2ZXMgb3IgYSBtb3JlIHRyYWRpdGlvbmFsIG9wdGlvbiBvYmplY3QKCSAqCgkgKiBCeSBkZWZhdWx0IGEgY2FsbGJhY2sgbGlzdCB3aWxsIGFjdCBsaWtlIGFuIGV2ZW50IGNhbGxiYWNrIGxpc3QgYW5kIGNhbiBiZQoJICogImZpcmVkIiBtdWx0aXBsZSB0aW1lcy4KCSAqCgkgKiBQb3NzaWJsZSBvcHRpb25zOgoJICoKCSAqCW9uY2U6CQkJd2lsbCBlbnN1cmUgdGhlIGNhbGxiYWNrIGxpc3QgY2FuIG9ubHkgYmUgZmlyZWQgb25jZSAobGlrZSBhIERlZmVycmVkKQoJICoKCSAqCW1lbW9yeToJCQl3aWxsIGtlZXAgdHJhY2sgb2YgcHJldmlvdXMgdmFsdWVzIGFuZCB3aWxsIGNhbGwgYW55IGNhbGxiYWNrIGFkZGVkCgkgKgkJCQkJYWZ0ZXIgdGhlIGxpc3QgaGFzIGJlZW4gZmlyZWQgcmlnaHQgYXdheSB3aXRoIHRoZSBsYXRlc3QgIm1lbW9yaXplZCIKCSAqCQkJCQl2YWx1ZXMgKGxpa2UgYSBEZWZlcnJlZCkKCSAqCgkgKgl1bmlxdWU6CQkJd2lsbCBlbnN1cmUgYSBjYWxsYmFjayBjYW4gb25seSBiZSBhZGRlZCBvbmNlIChubyBkdXBsaWNhdGUgaW4gdGhlIGxpc3QpCgkgKgoJICoJc3RvcE9uRmFsc2U6CWludGVycnVwdCBjYWxsaW5ncyB3aGVuIGEgY2FsbGJhY2sgcmV0dXJucyBmYWxzZQoJICoKCSAqLwoJalF1ZXJ5LkNhbGxiYWNrcyA9IGZ1bmN0aW9uKCBvcHRpb25zICkgewoKCQkvLyBDb252ZXJ0IG9wdGlvbnMgZnJvbSBTdHJpbmctZm9ybWF0dGVkIHRvIE9iamVjdC1mb3JtYXR0ZWQgaWYgbmVlZGVkCgkJLy8gKHdlIGNoZWNrIGluIGNhY2hlIGZpcnN0KQoJCW9wdGlvbnMgPSB0eXBlb2Ygb3B0aW9ucyA9PT0gInN0cmluZyIgPwoJCQljcmVhdGVPcHRpb25zKCBvcHRpb25zICkgOgoJCQlqUXVlcnkuZXh0ZW5kKCB7fSwgb3B0aW9ucyApOwoKCQl2YXIgLy8gRmxhZyB0byBrbm93IGlmIGxpc3QgaXMgY3VycmVudGx5IGZpcmluZwoJCQlmaXJpbmcsCgoJCQkvLyBMYXN0IGZpcmUgdmFsdWUgZm9yIG5vbi1mb3JnZXR0YWJsZSBsaXN0cwoJCQltZW1vcnksCgoJCQkvLyBGbGFnIHRvIGtub3cgaWYgbGlzdCB3YXMgYWxyZWFkeSBmaXJlZAoJCQlmaXJlZCwKCgkJCS8vIEZsYWcgdG8gcHJldmVudCBmaXJpbmcKCQkJbG9ja2VkLAoKCQkJLy8gQWN0dWFsIGNhbGxiYWNrIGxpc3QKCQkJbGlzdCA9IFtdLAoKCQkJLy8gUXVldWUgb2YgZXhlY3V0aW9uIGRhdGEgZm9yIHJlcGVhdGFibGUgbGlzdHMKCQkJcXVldWUgPSBbXSwKCgkJCS8vIEluZGV4IG9mIGN1cnJlbnRseSBmaXJpbmcgY2FsbGJhY2sgKG1vZGlmaWVkIGJ5IGFkZC9yZW1vdmUgYXMgbmVlZGVkKQoJCQlmaXJpbmdJbmRleCA9IC0xLAoKCQkJLy8gRmlyZSBjYWxsYmFja3MKCQkJZmlyZSA9IGZ1bmN0aW9uKCkgewoKCQkJCS8vIEVuZm9yY2Ugc2luZ2xlLWZpcmluZwoJCQkJbG9ja2VkID0gb3B0aW9ucy5vbmNlOwoKCQkJCS8vIEV4ZWN1dGUgY2FsbGJhY2tzIGZvciBhbGwgcGVuZGluZyBleGVjdXRpb25zLAoJCQkJLy8gcmVzcGVjdGluZyBmaXJpbmdJbmRleCBvdmVycmlkZXMgYW5kIHJ1bnRpbWUgY2hhbmdlcwoJCQkJZmlyZWQgPSBmaXJpbmcgPSB0cnVlOwoJCQkJZm9yICggOyBxdWV1ZS5sZW5ndGg7IGZpcmluZ0luZGV4ID0gLTEgKSB7CgkJCQkJbWVtb3J5ID0gcXVldWUuc2hpZnQoKTsKCQkJCQl3aGlsZSAoICsrZmlyaW5nSW5kZXggPCBsaXN0Lmxlbmd0aCApIHsKCgkJCQkJCS8vIFJ1biBjYWxsYmFjayBhbmQgY2hlY2sgZm9yIGVhcmx5IHRlcm1pbmF0aW9uCgkJCQkJCWlmICggbGlzdFsgZmlyaW5nSW5kZXggXS5hcHBseSggbWVtb3J5WyAwIF0sIG1lbW9yeVsgMSBdICkgPT09IGZhbHNlICYmCgkJCQkJCQlvcHRpb25zLnN0b3BPbkZhbHNlICkgewoKCQkJCQkJCS8vIEp1bXAgdG8gZW5kIGFuZCBmb3JnZXQgdGhlIGRhdGEgc28gLmFkZCBkb2Vzbid0IHJlLWZpcmUKCQkJCQkJCWZpcmluZ0luZGV4ID0gbGlzdC5sZW5ndGg7CgkJCQkJCQltZW1vcnkgPSBmYWxzZTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCgkJCQkvLyBGb3JnZXQgdGhlIGRhdGEgaWYgd2UncmUgZG9uZSB3aXRoIGl0CgkJCQlpZiAoICFvcHRpb25zLm1lbW9yeSApIHsKCQkJCQltZW1vcnkgPSBmYWxzZTsKCQkJCX0KCgkJCQlmaXJpbmcgPSBmYWxzZTsKCgkJCQkvLyBDbGVhbiB1cCBpZiB3ZSdyZSBkb25lIGZpcmluZyBmb3IgZ29vZAoJCQkJaWYgKCBsb2NrZWQgKSB7CgoJCQkJCS8vIEtlZXAgYW4gZW1wdHkgbGlzdCBpZiB3ZSBoYXZlIGRhdGEgZm9yIGZ1dHVyZSBhZGQgY2FsbHMKCQkJCQlpZiAoIG1lbW9yeSApIHsKCQkJCQkJbGlzdCA9IFtdOwoKCQkJCQkvLyBPdGhlcndpc2UsIHRoaXMgb2JqZWN0IGlzIHNwZW50CgkJCQkJfSBlbHNlIHsKCQkJCQkJbGlzdCA9ICIiOwoJCQkJCX0KCQkJCX0KCQkJfSwKCgkJCS8vIEFjdHVhbCBDYWxsYmFja3Mgb2JqZWN0CgkJCXNlbGYgPSB7CgoJCQkJLy8gQWRkIGEgY2FsbGJhY2sgb3IgYSBjb2xsZWN0aW9uIG9mIGNhbGxiYWNrcyB0byB0aGUgbGlzdAoJCQkJYWRkOiBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIGxpc3QgKSB7CgoJCQkJCQkvLyBJZiB3ZSBoYXZlIG1lbW9yeSBmcm9tIGEgcGFzdCBydW4sIHdlIHNob3VsZCBmaXJlIGFmdGVyIGFkZGluZwoJCQkJCQlpZiAoIG1lbW9yeSAmJiAhZmlyaW5nICkgewoJCQkJCQkJZmlyaW5nSW5kZXggPSBsaXN0Lmxlbmd0aCAtIDE7CgkJCQkJCQlxdWV1ZS5wdXNoKCBtZW1vcnkgKTsKCQkJCQkJfQoKCQkJCQkJKCBmdW5jdGlvbiBhZGQoIGFyZ3MgKSB7CgkJCQkJCQlqUXVlcnkuZWFjaCggYXJncywgZnVuY3Rpb24oIF8sIGFyZyApIHsKCQkJCQkJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBhcmcgKSApIHsKCQkJCQkJCQkJaWYgKCAhb3B0aW9ucy51bmlxdWUgfHwgIXNlbGYuaGFzKCBhcmcgKSApIHsKCQkJCQkJCQkJCWxpc3QucHVzaCggYXJnICk7CgkJCQkJCQkJCX0KCQkJCQkJCQl9IGVsc2UgaWYgKCBhcmcgJiYgYXJnLmxlbmd0aCAmJiBqUXVlcnkudHlwZSggYXJnICkgIT09ICJzdHJpbmciICkgewoKCQkJCQkJCQkJLy8gSW5zcGVjdCByZWN1cnNpdmVseQoJCQkJCQkJCQlhZGQoIGFyZyApOwoJCQkJCQkJCX0KCQkJCQkJCX0gKTsKCQkJCQkJfSApKCBhcmd1bWVudHMgKTsKCgkJCQkJCWlmICggbWVtb3J5ICYmICFmaXJpbmcgKSB7CgkJCQkJCQlmaXJlKCk7CgkJCQkJCX0KCQkJCQl9CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9LAoKCQkJCS8vIFJlbW92ZSBhIGNhbGxiYWNrIGZyb20gdGhlIGxpc3QKCQkJCXJlbW92ZTogZnVuY3Rpb24oKSB7CgkJCQkJalF1ZXJ5LmVhY2goIGFyZ3VtZW50cywgZnVuY3Rpb24oIF8sIGFyZyApIHsKCQkJCQkJdmFyIGluZGV4OwoJCQkJCQl3aGlsZSAoICggaW5kZXggPSBqUXVlcnkuaW5BcnJheSggYXJnLCBsaXN0LCBpbmRleCApICkgPiAtMSApIHsKCQkJCQkJCWxpc3Quc3BsaWNlKCBpbmRleCwgMSApOwoKCQkJCQkJCS8vIEhhbmRsZSBmaXJpbmcgaW5kZXhlcwoJCQkJCQkJaWYgKCBpbmRleCA8PSBmaXJpbmdJbmRleCApIHsKCQkJCQkJCQlmaXJpbmdJbmRleC0tOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfSApOwoJCQkJCXJldHVybiB0aGlzOwoJCQkJfSwKCgkJCQkvLyBDaGVjayBpZiBhIGdpdmVuIGNhbGxiYWNrIGlzIGluIHRoZSBsaXN0LgoJCQkJLy8gSWYgbm8gYXJndW1lbnQgaXMgZ2l2ZW4sIHJldHVybiB3aGV0aGVyIG9yIG5vdCBsaXN0IGhhcyBjYWxsYmFja3MgYXR0YWNoZWQuCgkJCQloYXM6IGZ1bmN0aW9uKCBmbiApIHsKCQkJCQlyZXR1cm4gZm4gPwoJCQkJCQlqUXVlcnkuaW5BcnJheSggZm4sIGxpc3QgKSA+IC0xIDoKCQkJCQkJbGlzdC5sZW5ndGggPiAwOwoJCQkJfSwKCgkJCQkvLyBSZW1vdmUgYWxsIGNhbGxiYWNrcyBmcm9tIHRoZSBsaXN0CgkJCQllbXB0eTogZnVuY3Rpb24oKSB7CgkJCQkJaWYgKCBsaXN0ICkgewoJCQkJCQlsaXN0ID0gW107CgkJCQkJfQoJCQkJCXJldHVybiB0aGlzOwoJCQkJfSwKCgkJCQkvLyBEaXNhYmxlIC5maXJlIGFuZCAuYWRkCgkJCQkvLyBBYm9ydCBhbnkgY3VycmVudC9wZW5kaW5nIGV4ZWN1dGlvbnMKCQkJCS8vIENsZWFyIGFsbCBjYWxsYmFja3MgYW5kIHZhbHVlcwoJCQkJZGlzYWJsZTogZnVuY3Rpb24oKSB7CgkJCQkJbG9ja2VkID0gcXVldWUgPSBbXTsKCQkJCQlsaXN0ID0gbWVtb3J5ID0gIiI7CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9LAoJCQkJZGlzYWJsZWQ6IGZ1bmN0aW9uKCkgewoJCQkJCXJldHVybiAhbGlzdDsKCQkJCX0sCgoJCQkJLy8gRGlzYWJsZSAuZmlyZQoJCQkJLy8gQWxzbyBkaXNhYmxlIC5hZGQgdW5sZXNzIHdlIGhhdmUgbWVtb3J5IChzaW5jZSBpdCB3b3VsZCBoYXZlIG5vIGVmZmVjdCkKCQkJCS8vIEFib3J0IGFueSBwZW5kaW5nIGV4ZWN1dGlvbnMKCQkJCWxvY2s6IGZ1bmN0aW9uKCkgewoJCQkJCWxvY2tlZCA9IHRydWU7CgkJCQkJaWYgKCAhbWVtb3J5ICkgewoJCQkJCQlzZWxmLmRpc2FibGUoKTsKCQkJCQl9CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9LAoJCQkJbG9ja2VkOiBmdW5jdGlvbigpIHsKCQkJCQlyZXR1cm4gISFsb2NrZWQ7CgkJCQl9LAoKCQkJCS8vIENhbGwgYWxsIGNhbGxiYWNrcyB3aXRoIHRoZSBnaXZlbiBjb250ZXh0IGFuZCBhcmd1bWVudHMKCQkJCWZpcmVXaXRoOiBmdW5jdGlvbiggY29udGV4dCwgYXJncyApIHsKCQkJCQlpZiAoICFsb2NrZWQgKSB7CgkJCQkJCWFyZ3MgPSBhcmdzIHx8IFtdOwoJCQkJCQlhcmdzID0gWyBjb250ZXh0LCBhcmdzLnNsaWNlID8gYXJncy5zbGljZSgpIDogYXJncyBdOwoJCQkJCQlxdWV1ZS5wdXNoKCBhcmdzICk7CgkJCQkJCWlmICggIWZpcmluZyApIHsKCQkJCQkJCWZpcmUoKTsKCQkJCQkJfQoJCQkJCX0KCQkJCQlyZXR1cm4gdGhpczsKCQkJCX0sCgoJCQkJLy8gQ2FsbCBhbGwgdGhlIGNhbGxiYWNrcyB3aXRoIHRoZSBnaXZlbiBhcmd1bWVudHMKCQkJCWZpcmU6IGZ1bmN0aW9uKCkgewoJCQkJCXNlbGYuZmlyZVdpdGgoIHRoaXMsIGFyZ3VtZW50cyApOwoJCQkJCXJldHVybiB0aGlzOwoJCQkJfSwKCgkJCQkvLyBUbyBrbm93IGlmIHRoZSBjYWxsYmFja3MgaGF2ZSBhbHJlYWR5IGJlZW4gY2FsbGVkIGF0IGxlYXN0IG9uY2UKCQkJCWZpcmVkOiBmdW5jdGlvbigpIHsKCQkJCQlyZXR1cm4gISFmaXJlZDsKCQkJCX0KCQkJfTsKCgkJcmV0dXJuIHNlbGY7Cgl9OwoKCglqUXVlcnkuZXh0ZW5kKCB7CgoJCURlZmVycmVkOiBmdW5jdGlvbiggZnVuYyApIHsKCQkJdmFyIHR1cGxlcyA9IFsKCgkJCQkJLy8gYWN0aW9uLCBhZGQgbGlzdGVuZXIsIGxpc3RlbmVyIGxpc3QsIGZpbmFsIHN0YXRlCgkJCQkJWyAicmVzb2x2ZSIsICJkb25lIiwgalF1ZXJ5LkNhbGxiYWNrcyggIm9uY2UgbWVtb3J5IiApLCAicmVzb2x2ZWQiIF0sCgkJCQkJWyAicmVqZWN0IiwgImZhaWwiLCBqUXVlcnkuQ2FsbGJhY2tzKCAib25jZSBtZW1vcnkiICksICJyZWplY3RlZCIgXSwKCQkJCQlbICJub3RpZnkiLCAicHJvZ3Jlc3MiLCBqUXVlcnkuQ2FsbGJhY2tzKCAibWVtb3J5IiApIF0KCQkJCV0sCgkJCQlzdGF0ZSA9ICJwZW5kaW5nIiwKCQkJCXByb21pc2UgPSB7CgkJCQkJc3RhdGU6IGZ1bmN0aW9uKCkgewoJCQkJCQlyZXR1cm4gc3RhdGU7CgkJCQkJfSwKCQkJCQlhbHdheXM6IGZ1bmN0aW9uKCkgewoJCQkJCQlkZWZlcnJlZC5kb25lKCBhcmd1bWVudHMgKS5mYWlsKCBhcmd1bWVudHMgKTsKCQkJCQkJcmV0dXJuIHRoaXM7CgkJCQkJfSwKCQkJCQl0aGVuOiBmdW5jdGlvbiggLyogZm5Eb25lLCBmbkZhaWwsIGZuUHJvZ3Jlc3MgKi8gKSB7CgkJCQkJCXZhciBmbnMgPSBhcmd1bWVudHM7CgkJCQkJCXJldHVybiBqUXVlcnkuRGVmZXJyZWQoIGZ1bmN0aW9uKCBuZXdEZWZlciApIHsKCQkJCQkJCWpRdWVyeS5lYWNoKCB0dXBsZXMsIGZ1bmN0aW9uKCBpLCB0dXBsZSApIHsKCQkJCQkJCQl2YXIgZm4gPSBqUXVlcnkuaXNGdW5jdGlvbiggZm5zWyBpIF0gKSAmJiBmbnNbIGkgXTsKCgkJCQkJCQkJLy8gZGVmZXJyZWRbIGRvbmUgfCBmYWlsIHwgcHJvZ3Jlc3MgXSBmb3IgZm9yd2FyZGluZyBhY3Rpb25zIHRvIG5ld0RlZmVyCgkJCQkJCQkJZGVmZXJyZWRbIHR1cGxlWyAxIF0gXSggZnVuY3Rpb24oKSB7CgkJCQkJCQkJCXZhciByZXR1cm5lZCA9IGZuICYmIGZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKCQkJCQkJCQkJaWYgKCByZXR1cm5lZCAmJiBqUXVlcnkuaXNGdW5jdGlvbiggcmV0dXJuZWQucHJvbWlzZSApICkgewoJCQkJCQkJCQkJcmV0dXJuZWQucHJvbWlzZSgpCgkJCQkJCQkJCQkJLnByb2dyZXNzKCBuZXdEZWZlci5ub3RpZnkgKQoJCQkJCQkJCQkJCS5kb25lKCBuZXdEZWZlci5yZXNvbHZlICkKCQkJCQkJCQkJCQkuZmFpbCggbmV3RGVmZXIucmVqZWN0ICk7CgkJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCQluZXdEZWZlclsgdHVwbGVbIDAgXSArICJXaXRoIiBdKAoJCQkJCQkJCQkJCXRoaXMgPT09IHByb21pc2UgPyBuZXdEZWZlci5wcm9taXNlKCkgOiB0aGlzLAoJCQkJCQkJCQkJCWZuID8gWyByZXR1cm5lZCBdIDogYXJndW1lbnRzCgkJCQkJCQkJCQkpOwoJCQkJCQkJCQl9CgkJCQkJCQkJfSApOwoJCQkJCQkJfSApOwoJCQkJCQkJZm5zID0gbnVsbDsKCQkJCQkJfSApLnByb21pc2UoKTsKCQkJCQl9LAoKCQkJCQkvLyBHZXQgYSBwcm9taXNlIGZvciB0aGlzIGRlZmVycmVkCgkJCQkJLy8gSWYgb2JqIGlzIHByb3ZpZGVkLCB0aGUgcHJvbWlzZSBhc3BlY3QgaXMgYWRkZWQgdG8gdGhlIG9iamVjdAoJCQkJCXByb21pc2U6IGZ1bmN0aW9uKCBvYmogKSB7CgkJCQkJCXJldHVybiBvYmogIT0gbnVsbCA/IGpRdWVyeS5leHRlbmQoIG9iaiwgcHJvbWlzZSApIDogcHJvbWlzZTsKCQkJCQl9CgkJCQl9LAoJCQkJZGVmZXJyZWQgPSB7fTsKCgkJCS8vIEtlZXAgcGlwZSBmb3IgYmFjay1jb21wYXQKCQkJcHJvbWlzZS5waXBlID0gcHJvbWlzZS50aGVuOwoKCQkJLy8gQWRkIGxpc3Qtc3BlY2lmaWMgbWV0aG9kcwoJCQlqUXVlcnkuZWFjaCggdHVwbGVzLCBmdW5jdGlvbiggaSwgdHVwbGUgKSB7CgkJCQl2YXIgbGlzdCA9IHR1cGxlWyAyIF0sCgkJCQkJc3RhdGVTdHJpbmcgPSB0dXBsZVsgMyBdOwoKCQkJCS8vIHByb21pc2VbIGRvbmUgfCBmYWlsIHwgcHJvZ3Jlc3MgXSA9IGxpc3QuYWRkCgkJCQlwcm9taXNlWyB0dXBsZVsgMSBdIF0gPSBsaXN0LmFkZDsKCgkJCQkvLyBIYW5kbGUgc3RhdGUKCQkJCWlmICggc3RhdGVTdHJpbmcgKSB7CgkJCQkJbGlzdC5hZGQoIGZ1bmN0aW9uKCkgewoKCQkJCQkJLy8gc3RhdGUgPSBbIHJlc29sdmVkIHwgcmVqZWN0ZWQgXQoJCQkJCQlzdGF0ZSA9IHN0YXRlU3RyaW5nOwoKCQkJCQkvLyBbIHJlamVjdF9saXN0IHwgcmVzb2x2ZV9saXN0IF0uZGlzYWJsZTsgcHJvZ3Jlc3NfbGlzdC5sb2NrCgkJCQkJfSwgdHVwbGVzWyBpIF4gMSBdWyAyIF0uZGlzYWJsZSwgdHVwbGVzWyAyIF1bIDIgXS5sb2NrICk7CgkJCQl9CgoJCQkJLy8gZGVmZXJyZWRbIHJlc29sdmUgfCByZWplY3QgfCBub3RpZnkgXQoJCQkJZGVmZXJyZWRbIHR1cGxlWyAwIF0gXSA9IGZ1bmN0aW9uKCkgewoJCQkJCWRlZmVycmVkWyB0dXBsZVsgMCBdICsgIldpdGgiIF0oIHRoaXMgPT09IGRlZmVycmVkID8gcHJvbWlzZSA6IHRoaXMsIGFyZ3VtZW50cyApOwoJCQkJCXJldHVybiB0aGlzOwoJCQkJfTsKCQkJCWRlZmVycmVkWyB0dXBsZVsgMCBdICsgIldpdGgiIF0gPSBsaXN0LmZpcmVXaXRoOwoJCQl9ICk7CgoJCQkvLyBNYWtlIHRoZSBkZWZlcnJlZCBhIHByb21pc2UKCQkJcHJvbWlzZS5wcm9taXNlKCBkZWZlcnJlZCApOwoKCQkJLy8gQ2FsbCBnaXZlbiBmdW5jIGlmIGFueQoJCQlpZiAoIGZ1bmMgKSB7CgkJCQlmdW5jLmNhbGwoIGRlZmVycmVkLCBkZWZlcnJlZCApOwoJCQl9CgoJCQkvLyBBbGwgZG9uZSEKCQkJcmV0dXJuIGRlZmVycmVkOwoJCX0sCgoJCS8vIERlZmVycmVkIGhlbHBlcgoJCXdoZW46IGZ1bmN0aW9uKCBzdWJvcmRpbmF0ZSAvKiAsIC4uLiwgc3Vib3JkaW5hdGVOICovICkgewoJCQl2YXIgaSA9IDAsCgkJCQlyZXNvbHZlVmFsdWVzID0gc2xpY2UuY2FsbCggYXJndW1lbnRzICksCgkJCQlsZW5ndGggPSByZXNvbHZlVmFsdWVzLmxlbmd0aCwKCgkJCQkvLyB0aGUgY291bnQgb2YgdW5jb21wbGV0ZWQgc3Vib3JkaW5hdGVzCgkJCQlyZW1haW5pbmcgPSBsZW5ndGggIT09IDEgfHwKCQkJCQkoIHN1Ym9yZGluYXRlICYmIGpRdWVyeS5pc0Z1bmN0aW9uKCBzdWJvcmRpbmF0ZS5wcm9taXNlICkgKSA/IGxlbmd0aCA6IDAsCgoJCQkJLy8gdGhlIG1hc3RlciBEZWZlcnJlZC4KCQkJCS8vIElmIHJlc29sdmVWYWx1ZXMgY29uc2lzdCBvZiBvbmx5IGEgc2luZ2xlIERlZmVycmVkLCBqdXN0IHVzZSB0aGF0LgoJCQkJZGVmZXJyZWQgPSByZW1haW5pbmcgPT09IDEgPyBzdWJvcmRpbmF0ZSA6IGpRdWVyeS5EZWZlcnJlZCgpLAoKCQkJCS8vIFVwZGF0ZSBmdW5jdGlvbiBmb3IgYm90aCByZXNvbHZlIGFuZCBwcm9ncmVzcyB2YWx1ZXMKCQkJCXVwZGF0ZUZ1bmMgPSBmdW5jdGlvbiggaSwgY29udGV4dHMsIHZhbHVlcyApIHsKCQkJCQlyZXR1cm4gZnVuY3Rpb24oIHZhbHVlICkgewoJCQkJCQljb250ZXh0c1sgaSBdID0gdGhpczsKCQkJCQkJdmFsdWVzWyBpIF0gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IHNsaWNlLmNhbGwoIGFyZ3VtZW50cyApIDogdmFsdWU7CgkJCQkJCWlmICggdmFsdWVzID09PSBwcm9ncmVzc1ZhbHVlcyApIHsKCQkJCQkJCWRlZmVycmVkLm5vdGlmeVdpdGgoIGNvbnRleHRzLCB2YWx1ZXMgKTsKCgkJCQkJCX0gZWxzZSBpZiAoICEoIC0tcmVtYWluaW5nICkgKSB7CgkJCQkJCQlkZWZlcnJlZC5yZXNvbHZlV2l0aCggY29udGV4dHMsIHZhbHVlcyApOwoJCQkJCQl9CgkJCQkJfTsKCQkJCX0sCgoJCQkJcHJvZ3Jlc3NWYWx1ZXMsIHByb2dyZXNzQ29udGV4dHMsIHJlc29sdmVDb250ZXh0czsKCgkJCS8vIGFkZCBsaXN0ZW5lcnMgdG8gRGVmZXJyZWQgc3Vib3JkaW5hdGVzOyB0cmVhdCBvdGhlcnMgYXMgcmVzb2x2ZWQKCQkJaWYgKCBsZW5ndGggPiAxICkgewoJCQkJcHJvZ3Jlc3NWYWx1ZXMgPSBuZXcgQXJyYXkoIGxlbmd0aCApOwoJCQkJcHJvZ3Jlc3NDb250ZXh0cyA9IG5ldyBBcnJheSggbGVuZ3RoICk7CgkJCQlyZXNvbHZlQ29udGV4dHMgPSBuZXcgQXJyYXkoIGxlbmd0aCApOwoJCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCQkJaWYgKCByZXNvbHZlVmFsdWVzWyBpIF0gJiYgalF1ZXJ5LmlzRnVuY3Rpb24oIHJlc29sdmVWYWx1ZXNbIGkgXS5wcm9taXNlICkgKSB7CgkJCQkJCXJlc29sdmVWYWx1ZXNbIGkgXS5wcm9taXNlKCkKCQkJCQkJCS5wcm9ncmVzcyggdXBkYXRlRnVuYyggaSwgcHJvZ3Jlc3NDb250ZXh0cywgcHJvZ3Jlc3NWYWx1ZXMgKSApCgkJCQkJCQkuZG9uZSggdXBkYXRlRnVuYyggaSwgcmVzb2x2ZUNvbnRleHRzLCByZXNvbHZlVmFsdWVzICkgKQoJCQkJCQkJLmZhaWwoIGRlZmVycmVkLnJlamVjdCApOwoJCQkJCX0gZWxzZSB7CgkJCQkJCS0tcmVtYWluaW5nOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJLy8gaWYgd2UncmUgbm90IHdhaXRpbmcgb24gYW55dGhpbmcsIHJlc29sdmUgdGhlIG1hc3RlcgoJCQlpZiAoICFyZW1haW5pbmcgKSB7CgkJCQlkZWZlcnJlZC5yZXNvbHZlV2l0aCggcmVzb2x2ZUNvbnRleHRzLCByZXNvbHZlVmFsdWVzICk7CgkJCX0KCgkJCXJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7CgkJfQoJfSApOwoKCgkvLyBUaGUgZGVmZXJyZWQgdXNlZCBvbiBET00gcmVhZHkKCXZhciByZWFkeUxpc3Q7CgoJalF1ZXJ5LmZuLnJlYWR5ID0gZnVuY3Rpb24oIGZuICkgewoKCQkvLyBBZGQgdGhlIGNhbGxiYWNrCgkJalF1ZXJ5LnJlYWR5LnByb21pc2UoKS5kb25lKCBmbiApOwoKCQlyZXR1cm4gdGhpczsKCX07CgoJalF1ZXJ5LmV4dGVuZCggewoKCQkvLyBJcyB0aGUgRE9NIHJlYWR5IHRvIGJlIHVzZWQ/IFNldCB0byB0cnVlIG9uY2UgaXQgb2NjdXJzLgoJCWlzUmVhZHk6IGZhbHNlLAoKCQkvLyBBIGNvdW50ZXIgdG8gdHJhY2sgaG93IG1hbnkgaXRlbXMgdG8gd2FpdCBmb3IgYmVmb3JlCgkJLy8gdGhlIHJlYWR5IGV2ZW50IGZpcmVzLiBTZWUgIzY3ODEKCQlyZWFkeVdhaXQ6IDEsCgoJCS8vIEhvbGQgKG9yIHJlbGVhc2UpIHRoZSByZWFkeSBldmVudAoJCWhvbGRSZWFkeTogZnVuY3Rpb24oIGhvbGQgKSB7CgkJCWlmICggaG9sZCApIHsKCQkJCWpRdWVyeS5yZWFkeVdhaXQrKzsKCQkJfSBlbHNlIHsKCQkJCWpRdWVyeS5yZWFkeSggdHJ1ZSApOwoJCQl9CgkJfSwKCgkJLy8gSGFuZGxlIHdoZW4gdGhlIERPTSBpcyByZWFkeQoJCXJlYWR5OiBmdW5jdGlvbiggd2FpdCApIHsKCgkJCS8vIEFib3J0IGlmIHRoZXJlIGFyZSBwZW5kaW5nIGhvbGRzIG9yIHdlJ3JlIGFscmVhZHkgcmVhZHkKCQkJaWYgKCB3YWl0ID09PSB0cnVlID8gLS1qUXVlcnkucmVhZHlXYWl0IDogalF1ZXJ5LmlzUmVhZHkgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIFJlbWVtYmVyIHRoYXQgdGhlIERPTSBpcyByZWFkeQoJCQlqUXVlcnkuaXNSZWFkeSA9IHRydWU7CgoJCQkvLyBJZiBhIG5vcm1hbCBET00gUmVhZHkgZXZlbnQgZmlyZWQsIGRlY3JlbWVudCwgYW5kIHdhaXQgaWYgbmVlZCBiZQoJCQlpZiAoIHdhaXQgIT09IHRydWUgJiYgLS1qUXVlcnkucmVhZHlXYWl0ID4gMCApIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gSWYgdGhlcmUgYXJlIGZ1bmN0aW9ucyBib3VuZCwgdG8gZXhlY3V0ZQoJCQlyZWFkeUxpc3QucmVzb2x2ZVdpdGgoIGRvY3VtZW50LCBbIGpRdWVyeSBdICk7CgoJCQkvLyBUcmlnZ2VyIGFueSBib3VuZCByZWFkeSBldmVudHMKCQkJaWYgKCBqUXVlcnkuZm4udHJpZ2dlckhhbmRsZXIgKSB7CgkJCQlqUXVlcnkoIGRvY3VtZW50ICkudHJpZ2dlckhhbmRsZXIoICJyZWFkeSIgKTsKCQkJCWpRdWVyeSggZG9jdW1lbnQgKS5vZmYoICJyZWFkeSIgKTsKCQkJfQoJCX0KCX0gKTsKCgkvKioKCSAqIENsZWFuLXVwIG1ldGhvZCBmb3IgZG9tIHJlYWR5IGV2ZW50cwoJICovCglmdW5jdGlvbiBkZXRhY2goKSB7CgkJaWYgKCBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyICkgewoJCQlkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAiRE9NQ29udGVudExvYWRlZCIsIGNvbXBsZXRlZCApOwoJCQl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciggImxvYWQiLCBjb21wbGV0ZWQgKTsKCgkJfSBlbHNlIHsKCQkJZG9jdW1lbnQuZGV0YWNoRXZlbnQoICJvbnJlYWR5c3RhdGVjaGFuZ2UiLCBjb21wbGV0ZWQgKTsKCQkJd2luZG93LmRldGFjaEV2ZW50KCAib25sb2FkIiwgY29tcGxldGVkICk7CgkJfQoJfQoKCS8qKgoJICogVGhlIHJlYWR5IGV2ZW50IGhhbmRsZXIgYW5kIHNlbGYgY2xlYW51cCBtZXRob2QKCSAqLwoJZnVuY3Rpb24gY29tcGxldGVkKCkgewoKCQkvLyByZWFkeVN0YXRlID09PSAiY29tcGxldGUiIGlzIGdvb2QgZW5vdWdoIGZvciB1cyB0byBjYWxsIHRoZSBkb20gcmVhZHkgaW4gb2xkSUUKCQlpZiAoIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIgfHwKCQkJd2luZG93LmV2ZW50LnR5cGUgPT09ICJsb2FkIiB8fAoJCQlkb2N1bWVudC5yZWFkeVN0YXRlID09PSAiY29tcGxldGUiICkgewoKCQkJZGV0YWNoKCk7CgkJCWpRdWVyeS5yZWFkeSgpOwoJCX0KCX0KCglqUXVlcnkucmVhZHkucHJvbWlzZSA9IGZ1bmN0aW9uKCBvYmogKSB7CgkJaWYgKCAhcmVhZHlMaXN0ICkgewoKCQkJcmVhZHlMaXN0ID0galF1ZXJ5LkRlZmVycmVkKCk7CgoJCQkvLyBDYXRjaCBjYXNlcyB3aGVyZSAkKGRvY3VtZW50KS5yZWFkeSgpIGlzIGNhbGxlZAoJCQkvLyBhZnRlciB0aGUgYnJvd3NlciBldmVudCBoYXMgYWxyZWFkeSBvY2N1cnJlZC4KCQkJLy8gU3VwcG9ydDogSUU2LTEwCgkJCS8vIE9sZGVyIElFIHNvbWV0aW1lcyBzaWduYWxzICJpbnRlcmFjdGl2ZSIgdG9vIHNvb24KCQkJaWYgKCBkb2N1bWVudC5yZWFkeVN0YXRlID09PSAiY29tcGxldGUiIHx8CgkJCQkoIGRvY3VtZW50LnJlYWR5U3RhdGUgIT09ICJsb2FkaW5nIiAmJiAhZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsICkgKSB7CgoJCQkJLy8gSGFuZGxlIGl0IGFzeW5jaHJvbm91c2x5IHRvIGFsbG93IHNjcmlwdHMgdGhlIG9wcG9ydHVuaXR5IHRvIGRlbGF5IHJlYWR5CgkJCQl3aW5kb3cuc2V0VGltZW91dCggalF1ZXJ5LnJlYWR5ICk7CgoJCQkvLyBTdGFuZGFyZHMtYmFzZWQgYnJvd3NlcnMgc3VwcG9ydCBET01Db250ZW50TG9hZGVkCgkJCX0gZWxzZSBpZiAoIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIgKSB7CgoJCQkJLy8gVXNlIHRoZSBoYW5keSBldmVudCBjYWxsYmFjawoJCQkJZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggIkRPTUNvbnRlbnRMb2FkZWQiLCBjb21wbGV0ZWQgKTsKCgkJCQkvLyBBIGZhbGxiYWNrIHRvIHdpbmRvdy5vbmxvYWQsIHRoYXQgd2lsbCBhbHdheXMgd29yawoJCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICJsb2FkIiwgY29tcGxldGVkICk7CgoJCQkvLyBJZiBJRSBldmVudCBtb2RlbCBpcyB1c2VkCgkJCX0gZWxzZSB7CgoJCQkJLy8gRW5zdXJlIGZpcmluZyBiZWZvcmUgb25sb2FkLCBtYXliZSBsYXRlIGJ1dCBzYWZlIGFsc28gZm9yIGlmcmFtZXMKCQkJCWRvY3VtZW50LmF0dGFjaEV2ZW50KCAib25yZWFkeXN0YXRlY2hhbmdlIiwgY29tcGxldGVkICk7CgoJCQkJLy8gQSBmYWxsYmFjayB0byB3aW5kb3cub25sb2FkLCB0aGF0IHdpbGwgYWx3YXlzIHdvcmsKCQkJCXdpbmRvdy5hdHRhY2hFdmVudCggIm9ubG9hZCIsIGNvbXBsZXRlZCApOwoKCQkJCS8vIElmIElFIGFuZCBub3QgYSBmcmFtZQoJCQkJLy8gY29udGludWFsbHkgY2hlY2sgdG8gc2VlIGlmIHRoZSBkb2N1bWVudCBpcyByZWFkeQoJCQkJdmFyIHRvcCA9IGZhbHNlOwoKCQkJCXRyeSB7CgkJCQkJdG9wID0gd2luZG93LmZyYW1lRWxlbWVudCA9PSBudWxsICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCQkJCX0gY2F0Y2ggKCBlICkge30KCgkJCQlpZiAoIHRvcCAmJiB0b3AuZG9TY3JvbGwgKSB7CgkJCQkJKCBmdW5jdGlvbiBkb1Njcm9sbENoZWNrKCkgewoJCQkJCQlpZiAoICFqUXVlcnkuaXNSZWFkeSApIHsKCgkJCQkJCQl0cnkgewoKCQkJCQkJCQkvLyBVc2UgdGhlIHRyaWNrIGJ5IERpZWdvIFBlcmluaQoJCQkJCQkJCS8vIGh0dHA6Ly9qYXZhc2NyaXB0Lm53Ym94LmNvbS9JRUNvbnRlbnRMb2FkZWQvCgkJCQkJCQkJdG9wLmRvU2Nyb2xsKCAibGVmdCIgKTsKCQkJCQkJCX0gY2F0Y2ggKCBlICkgewoJCQkJCQkJCXJldHVybiB3aW5kb3cuc2V0VGltZW91dCggZG9TY3JvbGxDaGVjaywgNTAgKTsKCQkJCQkJCX0KCgkJCQkJCQkvLyBkZXRhY2ggYWxsIGRvbSByZWFkeSBldmVudHMKCQkJCQkJCWRldGFjaCgpOwoKCQkJCQkJCS8vIGFuZCBleGVjdXRlIGFueSB3YWl0aW5nIGZ1bmN0aW9ucwoJCQkJCQkJalF1ZXJ5LnJlYWR5KCk7CgkJCQkJCX0KCQkJCQl9ICkoKTsKCQkJCX0KCQkJfQoJCX0KCQlyZXR1cm4gcmVhZHlMaXN0LnByb21pc2UoIG9iaiApOwoJfTsKCgkvLyBLaWNrIG9mZiB0aGUgRE9NIHJlYWR5IGNoZWNrIGV2ZW4gaWYgdGhlIHVzZXIgZG9lcyBub3QKCWpRdWVyeS5yZWFkeS5wcm9taXNlKCk7CgoKCgoJLy8gU3VwcG9ydDogSUU8OQoJLy8gSXRlcmF0aW9uIG92ZXIgb2JqZWN0J3MgaW5oZXJpdGVkIHByb3BlcnRpZXMgYmVmb3JlIGl0cyBvd24KCXZhciBpOwoJZm9yICggaSBpbiBqUXVlcnkoIHN1cHBvcnQgKSApIHsKCQlicmVhazsKCX0KCXN1cHBvcnQub3duRmlyc3QgPSBpID09PSAiMCI7CgoJLy8gTm90ZTogbW9zdCBzdXBwb3J0IHRlc3RzIGFyZSBkZWZpbmVkIGluIHRoZWlyIHJlc3BlY3RpdmUgbW9kdWxlcy4KCS8vIGZhbHNlIHVudGlsIHRoZSB0ZXN0IGlzIHJ1bgoJc3VwcG9ydC5pbmxpbmVCbG9ja05lZWRzTGF5b3V0ID0gZmFsc2U7CgoJLy8gRXhlY3V0ZSBBU0FQIGluIGNhc2Ugd2UgbmVlZCB0byBzZXQgYm9keS5zdHlsZS56b29tCglqUXVlcnkoIGZ1bmN0aW9uKCkgewoKCQkvLyBNaW5pZmllZDogdmFyIGEsYixjLGQKCQl2YXIgdmFsLCBkaXYsIGJvZHksIGNvbnRhaW5lcjsKCgkJYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAiYm9keSIgKVsgMCBdOwoJCWlmICggIWJvZHkgfHwgIWJvZHkuc3R5bGUgKSB7CgoJCQkvLyBSZXR1cm4gZm9yIGZyYW1lc2V0IGRvY3MgdGhhdCBkb24ndCBoYXZlIGEgYm9keQoJCQlyZXR1cm47CgkJfQoKCQkvLyBTZXR1cAoJCWRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICk7CgkJY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCQljb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICJwb3NpdGlvbjphYnNvbHV0ZTtib3JkZXI6MDt3aWR0aDowO2hlaWdodDowO3RvcDowO2xlZnQ6LTk5OTlweCI7CgkJYm9keS5hcHBlbmRDaGlsZCggY29udGFpbmVyICkuYXBwZW5kQ2hpbGQoIGRpdiApOwoKCQlpZiAoIHR5cGVvZiBkaXYuc3R5bGUuem9vbSAhPT0gInVuZGVmaW5lZCIgKSB7CgoJCQkvLyBTdXBwb3J0OiBJRTw4CgkJCS8vIENoZWNrIGlmIG5hdGl2ZWx5IGJsb2NrLWxldmVsIGVsZW1lbnRzIGFjdCBsaWtlIGlubGluZS1ibG9jawoJCQkvLyBlbGVtZW50cyB3aGVuIHNldHRpbmcgdGhlaXIgZGlzcGxheSB0byAnaW5saW5lJyBhbmQgZ2l2aW5nCgkJCS8vIHRoZW0gbGF5b3V0CgkJCWRpdi5zdHlsZS5jc3NUZXh0ID0gImRpc3BsYXk6aW5saW5lO21hcmdpbjowO2JvcmRlcjowO3BhZGRpbmc6MXB4O3dpZHRoOjFweDt6b29tOjEiOwoKCQkJc3VwcG9ydC5pbmxpbmVCbG9ja05lZWRzTGF5b3V0ID0gdmFsID0gZGl2Lm9mZnNldFdpZHRoID09PSAzOwoJCQlpZiAoIHZhbCApIHsKCgkJCQkvLyBQcmV2ZW50IElFIDYgZnJvbSBhZmZlY3RpbmcgbGF5b3V0IGZvciBwb3NpdGlvbmVkIGVsZW1lbnRzICMxMTA0OAoJCQkJLy8gUHJldmVudCBJRSBmcm9tIHNocmlua2luZyB0aGUgYm9keSBpbiBJRSA3IG1vZGUgIzEyODY5CgkJCQkvLyBTdXBwb3J0OiBJRTw4CgkJCQlib2R5LnN0eWxlLnpvb20gPSAxOwoJCQl9CgkJfQoKCQlib2R5LnJlbW92ZUNoaWxkKCBjb250YWluZXIgKTsKCX0gKTsKCgoJKCBmdW5jdGlvbigpIHsKCQl2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCgkJLy8gU3VwcG9ydDogSUU8OQoJCXN1cHBvcnQuZGVsZXRlRXhwYW5kbyA9IHRydWU7CgkJdHJ5IHsKCQkJZGVsZXRlIGRpdi50ZXN0OwoJCX0gY2F0Y2ggKCBlICkgewoJCQlzdXBwb3J0LmRlbGV0ZUV4cGFuZG8gPSBmYWxzZTsKCQl9CgoJCS8vIE51bGwgZWxlbWVudHMgdG8gYXZvaWQgbGVha3MgaW4gSUUuCgkJZGl2ID0gbnVsbDsKCX0gKSgpOwoJdmFyIGFjY2VwdERhdGEgPSBmdW5jdGlvbiggZWxlbSApIHsKCQl2YXIgbm9EYXRhID0galF1ZXJ5Lm5vRGF0YVsgKCBlbGVtLm5vZGVOYW1lICsgIiAiICkudG9Mb3dlckNhc2UoKSBdLAoJCQlub2RlVHlwZSA9ICtlbGVtLm5vZGVUeXBlIHx8IDE7CgoJCS8vIERvIG5vdCBzZXQgZGF0YSBvbiBub24tZWxlbWVudCBET00gbm9kZXMgYmVjYXVzZSBpdCB3aWxsIG5vdCBiZSBjbGVhcmVkICgjODMzNSkuCgkJcmV0dXJuIG5vZGVUeXBlICE9PSAxICYmIG5vZGVUeXBlICE9PSA5ID8KCQkJZmFsc2UgOgoKCQkJLy8gTm9kZXMgYWNjZXB0IGRhdGEgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQ7IHJlamVjdGlvbiBjYW4gYmUgY29uZGl0aW9uYWwKCQkJIW5vRGF0YSB8fCBub0RhdGEgIT09IHRydWUgJiYgZWxlbS5nZXRBdHRyaWJ1dGUoICJjbGFzc2lkIiApID09PSBub0RhdGE7Cgl9OwoKCgoKCXZhciByYnJhY2UgPSAvXig/Olx7W1x3XFddKlx9fFxbW1x3XFddKlxdKSQvLAoJCXJtdWx0aURhc2ggPSAvKFtBLVpdKS9nOwoKCWZ1bmN0aW9uIGRhdGFBdHRyKCBlbGVtLCBrZXksIGRhdGEgKSB7CgoJCS8vIElmIG5vdGhpbmcgd2FzIGZvdW5kIGludGVybmFsbHksIHRyeSB0byBmZXRjaCBhbnkKCQkvLyBkYXRhIGZyb20gdGhlIEhUTUw1IGRhdGEtKiBhdHRyaWJ1dGUKCQlpZiAoIGRhdGEgPT09IHVuZGVmaW5lZCAmJiBlbGVtLm5vZGVUeXBlID09PSAxICkgewoKCQkJdmFyIG5hbWUgPSAiZGF0YS0iICsga2V5LnJlcGxhY2UoIHJtdWx0aURhc2gsICItJDEiICkudG9Mb3dlckNhc2UoKTsKCgkJCWRhdGEgPSBlbGVtLmdldEF0dHJpYnV0ZSggbmFtZSApOwoKCQkJaWYgKCB0eXBlb2YgZGF0YSA9PT0gInN0cmluZyIgKSB7CgkJCQl0cnkgewoJCQkJCWRhdGEgPSBkYXRhID09PSAidHJ1ZSIgPyB0cnVlIDoKCQkJCQkJZGF0YSA9PT0gImZhbHNlIiA/IGZhbHNlIDoKCQkJCQkJZGF0YSA9PT0gIm51bGwiID8gbnVsbCA6CgoJCQkJCQkvLyBPbmx5IGNvbnZlcnQgdG8gYSBudW1iZXIgaWYgaXQgZG9lc24ndCBjaGFuZ2UgdGhlIHN0cmluZwoJCQkJCQkrZGF0YSArICIiID09PSBkYXRhID8gK2RhdGEgOgoJCQkJCQlyYnJhY2UudGVzdCggZGF0YSApID8galF1ZXJ5LnBhcnNlSlNPTiggZGF0YSApIDoKCQkJCQkJZGF0YTsKCQkJCX0gY2F0Y2ggKCBlICkge30KCgkJCQkvLyBNYWtlIHN1cmUgd2Ugc2V0IHRoZSBkYXRhIHNvIGl0IGlzbid0IGNoYW5nZWQgbGF0ZXIKCQkJCWpRdWVyeS5kYXRhKCBlbGVtLCBrZXksIGRhdGEgKTsKCgkJCX0gZWxzZSB7CgkJCQlkYXRhID0gdW5kZWZpbmVkOwoJCQl9CgkJfQoKCQlyZXR1cm4gZGF0YTsKCX0KCgkvLyBjaGVja3MgYSBjYWNoZSBvYmplY3QgZm9yIGVtcHRpbmVzcwoJZnVuY3Rpb24gaXNFbXB0eURhdGFPYmplY3QoIG9iaiApIHsKCQl2YXIgbmFtZTsKCQlmb3IgKCBuYW1lIGluIG9iaiApIHsKCgkJCS8vIGlmIHRoZSBwdWJsaWMgZGF0YSBvYmplY3QgaXMgZW1wdHksIHRoZSBwcml2YXRlIGlzIHN0aWxsIGVtcHR5CgkJCWlmICggbmFtZSA9PT0gImRhdGEiICYmIGpRdWVyeS5pc0VtcHR5T2JqZWN0KCBvYmpbIG5hbWUgXSApICkgewoJCQkJY29udGludWU7CgkJCX0KCQkJaWYgKCBuYW1lICE9PSAidG9KU09OIiApIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCX0KCgkJcmV0dXJuIHRydWU7Cgl9CgoJZnVuY3Rpb24gaW50ZXJuYWxEYXRhKCBlbGVtLCBuYW1lLCBkYXRhLCBwdnQgLyogSW50ZXJuYWwgVXNlIE9ubHkgKi8gKSB7CgkJaWYgKCAhYWNjZXB0RGF0YSggZWxlbSApICkgewoJCQlyZXR1cm47CgkJfQoKCQl2YXIgcmV0LCB0aGlzQ2FjaGUsCgkJCWludGVybmFsS2V5ID0galF1ZXJ5LmV4cGFuZG8sCgoJCQkvLyBXZSBoYXZlIHRvIGhhbmRsZSBET00gbm9kZXMgYW5kIEpTIG9iamVjdHMgZGlmZmVyZW50bHkgYmVjYXVzZSBJRTYtNwoJCQkvLyBjYW4ndCBHQyBvYmplY3QgcmVmZXJlbmNlcyBwcm9wZXJseSBhY3Jvc3MgdGhlIERPTS1KUyBib3VuZGFyeQoJCQlpc05vZGUgPSBlbGVtLm5vZGVUeXBlLAoKCQkJLy8gT25seSBET00gbm9kZXMgbmVlZCB0aGUgZ2xvYmFsIGpRdWVyeSBjYWNoZTsgSlMgb2JqZWN0IGRhdGEgaXMKCQkJLy8gYXR0YWNoZWQgZGlyZWN0bHkgdG8gdGhlIG9iamVjdCBzbyBHQyBjYW4gb2NjdXIgYXV0b21hdGljYWxseQoJCQljYWNoZSA9IGlzTm9kZSA/IGpRdWVyeS5jYWNoZSA6IGVsZW0sCgoJCQkvLyBPbmx5IGRlZmluaW5nIGFuIElEIGZvciBKUyBvYmplY3RzIGlmIGl0cyBjYWNoZSBhbHJlYWR5IGV4aXN0cyBhbGxvd3MKCQkJLy8gdGhlIGNvZGUgdG8gc2hvcnRjdXQgb24gdGhlIHNhbWUgcGF0aCBhcyBhIERPTSBub2RlIHdpdGggbm8gY2FjaGUKCQkJaWQgPSBpc05vZGUgPyBlbGVtWyBpbnRlcm5hbEtleSBdIDogZWxlbVsgaW50ZXJuYWxLZXkgXSAmJiBpbnRlcm5hbEtleTsKCgkJLy8gQXZvaWQgZG9pbmcgYW55IG1vcmUgd29yayB0aGFuIHdlIG5lZWQgdG8gd2hlbiB0cnlpbmcgdG8gZ2V0IGRhdGEgb24gYW4KCQkvLyBvYmplY3QgdGhhdCBoYXMgbm8gZGF0YSBhdCBhbGwKCQlpZiAoICggIWlkIHx8ICFjYWNoZVsgaWQgXSB8fCAoICFwdnQgJiYgIWNhY2hlWyBpZCBdLmRhdGEgKSApICYmCgkJCWRhdGEgPT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgbmFtZSA9PT0gInN0cmluZyIgKSB7CgkJCXJldHVybjsKCQl9CgoJCWlmICggIWlkICkgewoKCQkJLy8gT25seSBET00gbm9kZXMgbmVlZCBhIG5ldyB1bmlxdWUgSUQgZm9yIGVhY2ggZWxlbWVudCBzaW5jZSB0aGVpciBkYXRhCgkJCS8vIGVuZHMgdXAgaW4gdGhlIGdsb2JhbCBjYWNoZQoJCQlpZiAoIGlzTm9kZSApIHsKCQkJCWlkID0gZWxlbVsgaW50ZXJuYWxLZXkgXSA9IGRlbGV0ZWRJZHMucG9wKCkgfHwgalF1ZXJ5Lmd1aWQrKzsKCQkJfSBlbHNlIHsKCQkJCWlkID0gaW50ZXJuYWxLZXk7CgkJCX0KCQl9CgoJCWlmICggIWNhY2hlWyBpZCBdICkgewoKCQkJLy8gQXZvaWQgZXhwb3NpbmcgalF1ZXJ5IG1ldGFkYXRhIG9uIHBsYWluIEpTIG9iamVjdHMgd2hlbiB0aGUgb2JqZWN0CgkJCS8vIGlzIHNlcmlhbGl6ZWQgdXNpbmcgSlNPTi5zdHJpbmdpZnkKCQkJY2FjaGVbIGlkIF0gPSBpc05vZGUgPyB7fSA6IHsgdG9KU09OOiBqUXVlcnkubm9vcCB9OwoJCX0KCgkJLy8gQW4gb2JqZWN0IGNhbiBiZSBwYXNzZWQgdG8galF1ZXJ5LmRhdGEgaW5zdGVhZCBvZiBhIGtleS92YWx1ZSBwYWlyOyB0aGlzIGdldHMKCQkvLyBzaGFsbG93IGNvcGllZCBvdmVyIG9udG8gdGhlIGV4aXN0aW5nIGNhY2hlCgkJaWYgKCB0eXBlb2YgbmFtZSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIG5hbWUgPT09ICJmdW5jdGlvbiIgKSB7CgkJCWlmICggcHZ0ICkgewoJCQkJY2FjaGVbIGlkIF0gPSBqUXVlcnkuZXh0ZW5kKCBjYWNoZVsgaWQgXSwgbmFtZSApOwoJCQl9IGVsc2UgewoJCQkJY2FjaGVbIGlkIF0uZGF0YSA9IGpRdWVyeS5leHRlbmQoIGNhY2hlWyBpZCBdLmRhdGEsIG5hbWUgKTsKCQkJfQoJCX0KCgkJdGhpc0NhY2hlID0gY2FjaGVbIGlkIF07CgoJCS8vIGpRdWVyeSBkYXRhKCkgaXMgc3RvcmVkIGluIGEgc2VwYXJhdGUgb2JqZWN0IGluc2lkZSB0aGUgb2JqZWN0J3MgaW50ZXJuYWwgZGF0YQoJCS8vIGNhY2hlIGluIG9yZGVyIHRvIGF2b2lkIGtleSBjb2xsaXNpb25zIGJldHdlZW4gaW50ZXJuYWwgZGF0YSBhbmQgdXNlci1kZWZpbmVkCgkJLy8gZGF0YS4KCQlpZiAoICFwdnQgKSB7CgkJCWlmICggIXRoaXNDYWNoZS5kYXRhICkgewoJCQkJdGhpc0NhY2hlLmRhdGEgPSB7fTsKCQkJfQoKCQkJdGhpc0NhY2hlID0gdGhpc0NhY2hlLmRhdGE7CgkJfQoKCQlpZiAoIGRhdGEgIT09IHVuZGVmaW5lZCApIHsKCQkJdGhpc0NhY2hlWyBqUXVlcnkuY2FtZWxDYXNlKCBuYW1lICkgXSA9IGRhdGE7CgkJfQoKCQkvLyBDaGVjayBmb3IgYm90aCBjb252ZXJ0ZWQtdG8tY2FtZWwgYW5kIG5vbi1jb252ZXJ0ZWQgZGF0YSBwcm9wZXJ0eSBuYW1lcwoJCS8vIElmIGEgZGF0YSBwcm9wZXJ0eSB3YXMgc3BlY2lmaWVkCgkJaWYgKCB0eXBlb2YgbmFtZSA9PT0gInN0cmluZyIgKSB7CgoJCQkvLyBGaXJzdCBUcnkgdG8gZmluZCBhcy1pcyBwcm9wZXJ0eSBkYXRhCgkJCXJldCA9IHRoaXNDYWNoZVsgbmFtZSBdOwoKCQkJLy8gVGVzdCBmb3IgbnVsbHx1bmRlZmluZWQgcHJvcGVydHkgZGF0YQoJCQlpZiAoIHJldCA9PSBudWxsICkgewoKCQkJCS8vIFRyeSB0byBmaW5kIHRoZSBjYW1lbENhc2VkIHByb3BlcnR5CgkJCQlyZXQgPSB0aGlzQ2FjaGVbIGpRdWVyeS5jYW1lbENhc2UoIG5hbWUgKSBdOwoJCQl9CgkJfSBlbHNlIHsKCQkJcmV0ID0gdGhpc0NhY2hlOwoJCX0KCgkJcmV0dXJuIHJldDsKCX0KCglmdW5jdGlvbiBpbnRlcm5hbFJlbW92ZURhdGEoIGVsZW0sIG5hbWUsIHB2dCApIHsKCQlpZiAoICFhY2NlcHREYXRhKCBlbGVtICkgKSB7CgkJCXJldHVybjsKCQl9CgoJCXZhciB0aGlzQ2FjaGUsIGksCgkJCWlzTm9kZSA9IGVsZW0ubm9kZVR5cGUsCgoJCQkvLyBTZWUgalF1ZXJ5LmRhdGEgZm9yIG1vcmUgaW5mb3JtYXRpb24KCQkJY2FjaGUgPSBpc05vZGUgPyBqUXVlcnkuY2FjaGUgOiBlbGVtLAoJCQlpZCA9IGlzTm9kZSA/IGVsZW1bIGpRdWVyeS5leHBhbmRvIF0gOiBqUXVlcnkuZXhwYW5kbzsKCgkJLy8gSWYgdGhlcmUgaXMgYWxyZWFkeSBubyBjYWNoZSBlbnRyeSBmb3IgdGhpcyBvYmplY3QsIHRoZXJlIGlzIG5vCgkJLy8gcHVycG9zZSBpbiBjb250aW51aW5nCgkJaWYgKCAhY2FjaGVbIGlkIF0gKSB7CgkJCXJldHVybjsKCQl9CgoJCWlmICggbmFtZSApIHsKCgkJCXRoaXNDYWNoZSA9IHB2dCA/IGNhY2hlWyBpZCBdIDogY2FjaGVbIGlkIF0uZGF0YTsKCgkJCWlmICggdGhpc0NhY2hlICkgewoKCQkJCS8vIFN1cHBvcnQgYXJyYXkgb3Igc3BhY2Ugc2VwYXJhdGVkIHN0cmluZyBuYW1lcyBmb3IgZGF0YSBrZXlzCgkJCQlpZiAoICFqUXVlcnkuaXNBcnJheSggbmFtZSApICkgewoKCQkJCQkvLyB0cnkgdGhlIHN0cmluZyBhcyBhIGtleSBiZWZvcmUgYW55IG1hbmlwdWxhdGlvbgoJCQkJCWlmICggbmFtZSBpbiB0aGlzQ2FjaGUgKSB7CgkJCQkJCW5hbWUgPSBbIG5hbWUgXTsKCQkJCQl9IGVsc2UgewoKCQkJCQkJLy8gc3BsaXQgdGhlIGNhbWVsIGNhc2VkIHZlcnNpb24gYnkgc3BhY2VzIHVubGVzcyBhIGtleSB3aXRoIHRoZSBzcGFjZXMgZXhpc3RzCgkJCQkJCW5hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKCBuYW1lICk7CgkJCQkJCWlmICggbmFtZSBpbiB0aGlzQ2FjaGUgKSB7CgkJCQkJCQluYW1lID0gWyBuYW1lIF07CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQluYW1lID0gbmFtZS5zcGxpdCggIiAiICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9IGVsc2UgewoKCQkJCQkvLyBJZiAibmFtZSIgaXMgYW4gYXJyYXkgb2Yga2V5cy4uLgoJCQkJCS8vIFdoZW4gZGF0YSBpcyBpbml0aWFsbHkgY3JlYXRlZCwgdmlhICgia2V5IiwgInZhbCIpIHNpZ25hdHVyZSwKCQkJCQkvLyBrZXlzIHdpbGwgYmUgY29udmVydGVkIHRvIGNhbWVsQ2FzZS4KCQkJCQkvLyBTaW5jZSB0aGVyZSBpcyBubyB3YXkgdG8gdGVsbCBfaG93XyBhIGtleSB3YXMgYWRkZWQsIHJlbW92ZQoJCQkJCS8vIGJvdGggcGxhaW4ga2V5IGFuZCBjYW1lbENhc2Uga2V5LiAjMTI3ODYKCQkJCQkvLyBUaGlzIHdpbGwgb25seSBwZW5hbGl6ZSB0aGUgYXJyYXkgYXJndW1lbnQgcGF0aC4KCQkJCQluYW1lID0gbmFtZS5jb25jYXQoIGpRdWVyeS5tYXAoIG5hbWUsIGpRdWVyeS5jYW1lbENhc2UgKSApOwoJCQkJfQoKCQkJCWkgPSBuYW1lLmxlbmd0aDsKCQkJCXdoaWxlICggaS0tICkgewoJCQkJCWRlbGV0ZSB0aGlzQ2FjaGVbIG5hbWVbIGkgXSBdOwoJCQkJfQoKCQkJCS8vIElmIHRoZXJlIGlzIG5vIGRhdGEgbGVmdCBpbiB0aGUgY2FjaGUsIHdlIHdhbnQgdG8gY29udGludWUKCQkJCS8vIGFuZCBsZXQgdGhlIGNhY2hlIG9iamVjdCBpdHNlbGYgZ2V0IGRlc3Ryb3llZAoJCQkJaWYgKCBwdnQgPyAhaXNFbXB0eURhdGFPYmplY3QoIHRoaXNDYWNoZSApIDogIWpRdWVyeS5pc0VtcHR5T2JqZWN0KCB0aGlzQ2FjaGUgKSApIHsKCQkJCQlyZXR1cm47CgkJCQl9CgkJCX0KCQl9CgoJCS8vIFNlZSBqUXVlcnkuZGF0YSBmb3IgbW9yZSBpbmZvcm1hdGlvbgoJCWlmICggIXB2dCApIHsKCQkJZGVsZXRlIGNhY2hlWyBpZCBdLmRhdGE7CgoJCQkvLyBEb24ndCBkZXN0cm95IHRoZSBwYXJlbnQgY2FjaGUgdW5sZXNzIHRoZSBpbnRlcm5hbCBkYXRhIG9iamVjdAoJCQkvLyBoYWQgYmVlbiB0aGUgb25seSB0aGluZyBsZWZ0IGluIGl0CgkJCWlmICggIWlzRW1wdHlEYXRhT2JqZWN0KCBjYWNoZVsgaWQgXSApICkgewoJCQkJcmV0dXJuOwoJCQl9CgkJfQoKCQkvLyBEZXN0cm95IHRoZSBjYWNoZQoJCWlmICggaXNOb2RlICkgewoJCQlqUXVlcnkuY2xlYW5EYXRhKCBbIGVsZW0gXSwgdHJ1ZSApOwoKCQkvLyBVc2UgZGVsZXRlIHdoZW4gc3VwcG9ydGVkIGZvciBleHBhbmRvcyBvciBgY2FjaGVgIGlzIG5vdCBhIHdpbmRvdyBwZXIgaXNXaW5kb3cgKCMxMDA4MCkKCQkvKiBqc2hpbnQgZXFlcWVxOiBmYWxzZSAqLwoJCX0gZWxzZSBpZiAoIHN1cHBvcnQuZGVsZXRlRXhwYW5kbyB8fCBjYWNoZSAhPSBjYWNoZS53aW5kb3cgKSB7CgkJCS8qIGpzaGludCBlcWVxZXE6IHRydWUgKi8KCQkJZGVsZXRlIGNhY2hlWyBpZCBdOwoKCQkvLyBXaGVuIGFsbCBlbHNlIGZhaWxzLCB1bmRlZmluZWQKCQl9IGVsc2UgewoJCQljYWNoZVsgaWQgXSA9IHVuZGVmaW5lZDsKCQl9Cgl9CgoJalF1ZXJ5LmV4dGVuZCggewoJCWNhY2hlOiB7fSwKCgkJLy8gVGhlIGZvbGxvd2luZyBlbGVtZW50cyAoc3BhY2Utc3VmZml4ZWQgdG8gYXZvaWQgT2JqZWN0LnByb3RvdHlwZSBjb2xsaXNpb25zKQoJCS8vIHRocm93IHVuY2F0Y2hhYmxlIGV4Y2VwdGlvbnMgaWYgeW91IGF0dGVtcHQgdG8gc2V0IGV4cGFuZG8gcHJvcGVydGllcwoJCW5vRGF0YTogewoJCQkiYXBwbGV0ICI6IHRydWUsCgkJCSJlbWJlZCAiOiB0cnVlLAoKCQkJLy8gLi4uYnV0IEZsYXNoIG9iamVjdHMgKHdoaWNoIGhhdmUgdGhpcyBjbGFzc2lkKSAqY2FuKiBoYW5kbGUgZXhwYW5kb3MKCQkJIm9iamVjdCAiOiAiY2xzaWQ6RDI3Q0RCNkUtQUU2RC0xMWNmLTk2QjgtNDQ0NTUzNTQwMDAwIgoJCX0sCgoJCWhhc0RhdGE6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQllbGVtID0gZWxlbS5ub2RlVHlwZSA/IGpRdWVyeS5jYWNoZVsgZWxlbVsgalF1ZXJ5LmV4cGFuZG8gXSBdIDogZWxlbVsgalF1ZXJ5LmV4cGFuZG8gXTsKCQkJcmV0dXJuICEhZWxlbSAmJiAhaXNFbXB0eURhdGFPYmplY3QoIGVsZW0gKTsKCQl9LAoKCQlkYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZGF0YSApIHsKCQkJcmV0dXJuIGludGVybmFsRGF0YSggZWxlbSwgbmFtZSwgZGF0YSApOwoJCX0sCgoJCXJlbW92ZURhdGE6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkgewoJCQlyZXR1cm4gaW50ZXJuYWxSZW1vdmVEYXRhKCBlbGVtLCBuYW1lICk7CgkJfSwKCgkJLy8gRm9yIGludGVybmFsIHVzZSBvbmx5LgoJCV9kYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZGF0YSApIHsKCQkJcmV0dXJuIGludGVybmFsRGF0YSggZWxlbSwgbmFtZSwgZGF0YSwgdHJ1ZSApOwoJCX0sCgoJCV9yZW1vdmVEYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSApIHsKCQkJcmV0dXJuIGludGVybmFsUmVtb3ZlRGF0YSggZWxlbSwgbmFtZSwgdHJ1ZSApOwoJCX0KCX0gKTsKCglqUXVlcnkuZm4uZXh0ZW5kKCB7CgkJZGF0YTogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7CgkJCXZhciBpLCBuYW1lLCBkYXRhLAoJCQkJZWxlbSA9IHRoaXNbIDAgXSwKCQkJCWF0dHJzID0gZWxlbSAmJiBlbGVtLmF0dHJpYnV0ZXM7CgoJCQkvLyBTcGVjaWFsIGV4cGVjdGlvbnMgb2YgLmRhdGEgYmFzaWNhbGx5IHRod2FydCBqUXVlcnkuYWNjZXNzLAoJCQkvLyBzbyBpbXBsZW1lbnQgdGhlIHJlbGV2YW50IGJlaGF2aW9yIG91cnNlbHZlcwoKCQkJLy8gR2V0cyBhbGwgdmFsdWVzCgkJCWlmICgga2V5ID09PSB1bmRlZmluZWQgKSB7CgkJCQlpZiAoIHRoaXMubGVuZ3RoICkgewoJCQkJCWRhdGEgPSBqUXVlcnkuZGF0YSggZWxlbSApOwoKCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgJiYgIWpRdWVyeS5fZGF0YSggZWxlbSwgInBhcnNlZEF0dHJzIiApICkgewoJCQkJCQlpID0gYXR0cnMubGVuZ3RoOwoJCQkJCQl3aGlsZSAoIGktLSApIHsKCgkJCQkJCQkvLyBTdXBwb3J0OiBJRTExKwoJCQkJCQkJLy8gVGhlIGF0dHJzIGVsZW1lbnRzIGNhbiBiZSBudWxsICgjMTQ4OTQpCgkJCQkJCQlpZiAoIGF0dHJzWyBpIF0gKSB7CgkJCQkJCQkJbmFtZSA9IGF0dHJzWyBpIF0ubmFtZTsKCQkJCQkJCQlpZiAoIG5hbWUuaW5kZXhPZiggImRhdGEtIiApID09PSAwICkgewoJCQkJCQkJCQluYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggbmFtZS5zbGljZSggNSApICk7CgkJCQkJCQkJCWRhdGFBdHRyKCBlbGVtLCBuYW1lLCBkYXRhWyBuYW1lIF0gKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJalF1ZXJ5Ll9kYXRhKCBlbGVtLCAicGFyc2VkQXR0cnMiLCB0cnVlICk7CgkJCQkJfQoJCQkJfQoKCQkJCXJldHVybiBkYXRhOwoJCQl9CgoJCQkvLyBTZXRzIG11bHRpcGxlIHZhbHVlcwoJCQlpZiAoIHR5cGVvZiBrZXkgPT09ICJvYmplY3QiICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgkJCQkJalF1ZXJ5LmRhdGEoIHRoaXMsIGtleSApOwoJCQkJfSApOwoJCQl9CgoJCQlyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDEgPwoKCQkJCS8vIFNldHMgb25lIHZhbHVlCgkJCQl0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJCWpRdWVyeS5kYXRhKCB0aGlzLCBrZXksIHZhbHVlICk7CgkJCQl9ICkgOgoKCQkJCS8vIEdldHMgb25lIHZhbHVlCgkJCQkvLyBUcnkgdG8gZmV0Y2ggYW55IGludGVybmFsbHkgc3RvcmVkIGRhdGEgZmlyc3QKCQkJCWVsZW0gPyBkYXRhQXR0ciggZWxlbSwga2V5LCBqUXVlcnkuZGF0YSggZWxlbSwga2V5ICkgKSA6IHVuZGVmaW5lZDsKCQl9LAoKCQlyZW1vdmVEYXRhOiBmdW5jdGlvbigga2V5ICkgewoJCQlyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsKCQkJCWpRdWVyeS5yZW1vdmVEYXRhKCB0aGlzLCBrZXkgKTsKCQkJfSApOwoJCX0KCX0gKTsKCgoJalF1ZXJ5LmV4dGVuZCggewoJCXF1ZXVlOiBmdW5jdGlvbiggZWxlbSwgdHlwZSwgZGF0YSApIHsKCQkJdmFyIHF1ZXVlOwoKCQkJaWYgKCBlbGVtICkgewoJCQkJdHlwZSA9ICggdHlwZSB8fCAiZngiICkgKyAicXVldWUiOwoJCQkJcXVldWUgPSBqUXVlcnkuX2RhdGEoIGVsZW0sIHR5cGUgKTsKCgkJCQkvLyBTcGVlZCB1cCBkZXF1ZXVlIGJ5IGdldHRpbmcgb3V0IHF1aWNrbHkgaWYgdGhpcyBpcyBqdXN0IGEgbG9va3VwCgkJCQlpZiAoIGRhdGEgKSB7CgkJCQkJaWYgKCAhcXVldWUgfHwgalF1ZXJ5LmlzQXJyYXkoIGRhdGEgKSApIHsKCQkJCQkJcXVldWUgPSBqUXVlcnkuX2RhdGEoIGVsZW0sIHR5cGUsIGpRdWVyeS5tYWtlQXJyYXkoIGRhdGEgKSApOwoJCQkJCX0gZWxzZSB7CgkJCQkJCXF1ZXVlLnB1c2goIGRhdGEgKTsKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gcXVldWUgfHwgW107CgkJCX0KCQl9LAoKCQlkZXF1ZXVlOiBmdW5jdGlvbiggZWxlbSwgdHlwZSApIHsKCQkJdHlwZSA9IHR5cGUgfHwgImZ4IjsKCgkJCXZhciBxdWV1ZSA9IGpRdWVyeS5xdWV1ZSggZWxlbSwgdHlwZSApLAoJCQkJc3RhcnRMZW5ndGggPSBxdWV1ZS5sZW5ndGgsCgkJCQlmbiA9IHF1ZXVlLnNoaWZ0KCksCgkJCQlob29rcyA9IGpRdWVyeS5fcXVldWVIb29rcyggZWxlbSwgdHlwZSApLAoJCQkJbmV4dCA9IGZ1bmN0aW9uKCkgewoJCQkJCWpRdWVyeS5kZXF1ZXVlKCBlbGVtLCB0eXBlICk7CgkJCQl9OwoKCQkJLy8gSWYgdGhlIGZ4IHF1ZXVlIGlzIGRlcXVldWVkLCBhbHdheXMgcmVtb3ZlIHRoZSBwcm9ncmVzcyBzZW50aW5lbAoJCQlpZiAoIGZuID09PSAiaW5wcm9ncmVzcyIgKSB7CgkJCQlmbiA9IHF1ZXVlLnNoaWZ0KCk7CgkJCQlzdGFydExlbmd0aC0tOwoJCQl9CgoJCQlpZiAoIGZuICkgewoKCQkJCS8vIEFkZCBhIHByb2dyZXNzIHNlbnRpbmVsIHRvIHByZXZlbnQgdGhlIGZ4IHF1ZXVlIGZyb20gYmVpbmcKCQkJCS8vIGF1dG9tYXRpY2FsbHkgZGVxdWV1ZWQKCQkJCWlmICggdHlwZSA9PT0gImZ4IiApIHsKCQkJCQlxdWV1ZS51bnNoaWZ0KCAiaW5wcm9ncmVzcyIgKTsKCQkJCX0KCgkJCQkvLyBjbGVhciB1cCB0aGUgbGFzdCBxdWV1ZSBzdG9wIGZ1bmN0aW9uCgkJCQlkZWxldGUgaG9va3Muc3RvcDsKCQkJCWZuLmNhbGwoIGVsZW0sIG5leHQsIGhvb2tzICk7CgkJCX0KCgkJCWlmICggIXN0YXJ0TGVuZ3RoICYmIGhvb2tzICkgewoJCQkJaG9va3MuZW1wdHkuZmlyZSgpOwoJCQl9CgkJfSwKCgkJLy8gbm90IGludGVuZGVkIGZvciBwdWJsaWMgY29uc3VtcHRpb24gLSBnZW5lcmF0ZXMgYSBxdWV1ZUhvb2tzIG9iamVjdCwKCQkvLyBvciByZXR1cm5zIHRoZSBjdXJyZW50IG9uZQoJCV9xdWV1ZUhvb2tzOiBmdW5jdGlvbiggZWxlbSwgdHlwZSApIHsKCQkJdmFyIGtleSA9IHR5cGUgKyAicXVldWVIb29rcyI7CgkJCXJldHVybiBqUXVlcnkuX2RhdGEoIGVsZW0sIGtleSApIHx8IGpRdWVyeS5fZGF0YSggZWxlbSwga2V5LCB7CgkJCQllbXB0eTogalF1ZXJ5LkNhbGxiYWNrcyggIm9uY2UgbWVtb3J5IiApLmFkZCggZnVuY3Rpb24oKSB7CgkJCQkJalF1ZXJ5Ll9yZW1vdmVEYXRhKCBlbGVtLCB0eXBlICsgInF1ZXVlIiApOwoJCQkJCWpRdWVyeS5fcmVtb3ZlRGF0YSggZWxlbSwga2V5ICk7CgkJCQl9ICkKCQkJfSApOwoJCX0KCX0gKTsKCglqUXVlcnkuZm4uZXh0ZW5kKCB7CgkJcXVldWU6IGZ1bmN0aW9uKCB0eXBlLCBkYXRhICkgewoJCQl2YXIgc2V0dGVyID0gMjsKCgkJCWlmICggdHlwZW9mIHR5cGUgIT09ICJzdHJpbmciICkgewoJCQkJZGF0YSA9IHR5cGU7CgkJCQl0eXBlID0gImZ4IjsKCQkJCXNldHRlci0tOwoJCQl9CgoJCQlpZiAoIGFyZ3VtZW50cy5sZW5ndGggPCBzZXR0ZXIgKSB7CgkJCQlyZXR1cm4galF1ZXJ5LnF1ZXVlKCB0aGlzWyAwIF0sIHR5cGUgKTsKCQkJfQoKCQkJcmV0dXJuIGRhdGEgPT09IHVuZGVmaW5lZCA/CgkJCQl0aGlzIDoKCQkJCXRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgkJCQkJdmFyIHF1ZXVlID0galF1ZXJ5LnF1ZXVlKCB0aGlzLCB0eXBlLCBkYXRhICk7CgoJCQkJCS8vIGVuc3VyZSBhIGhvb2tzIGZvciB0aGlzIHF1ZXVlCgkJCQkJalF1ZXJ5Ll9xdWV1ZUhvb2tzKCB0aGlzLCB0eXBlICk7CgoJCQkJCWlmICggdHlwZSA9PT0gImZ4IiAmJiBxdWV1ZVsgMCBdICE9PSAiaW5wcm9ncmVzcyIgKSB7CgkJCQkJCWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCB0eXBlICk7CgkJCQkJfQoJCQkJfSApOwoJCX0sCgkJZGVxdWV1ZTogZnVuY3Rpb24oIHR5cGUgKSB7CgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJalF1ZXJ5LmRlcXVldWUoIHRoaXMsIHR5cGUgKTsKCQkJfSApOwoJCX0sCgkJY2xlYXJRdWV1ZTogZnVuY3Rpb24oIHR5cGUgKSB7CgkJCXJldHVybiB0aGlzLnF1ZXVlKCB0eXBlIHx8ICJmeCIsIFtdICk7CgkJfSwKCgkJLy8gR2V0IGEgcHJvbWlzZSByZXNvbHZlZCB3aGVuIHF1ZXVlcyBvZiBhIGNlcnRhaW4gdHlwZQoJCS8vIGFyZSBlbXB0aWVkIChmeCBpcyB0aGUgdHlwZSBieSBkZWZhdWx0KQoJCXByb21pc2U6IGZ1bmN0aW9uKCB0eXBlLCBvYmogKSB7CgkJCXZhciB0bXAsCgkJCQljb3VudCA9IDEsCgkJCQlkZWZlciA9IGpRdWVyeS5EZWZlcnJlZCgpLAoJCQkJZWxlbWVudHMgPSB0aGlzLAoJCQkJaSA9IHRoaXMubGVuZ3RoLAoJCQkJcmVzb2x2ZSA9IGZ1bmN0aW9uKCkgewoJCQkJCWlmICggISggLS1jb3VudCApICkgewoJCQkJCQlkZWZlci5yZXNvbHZlV2l0aCggZWxlbWVudHMsIFsgZWxlbWVudHMgXSApOwoJCQkJCX0KCQkJCX07CgoJCQlpZiAoIHR5cGVvZiB0eXBlICE9PSAic3RyaW5nIiApIHsKCQkJCW9iaiA9IHR5cGU7CgkJCQl0eXBlID0gdW5kZWZpbmVkOwoJCQl9CgkJCXR5cGUgPSB0eXBlIHx8ICJmeCI7CgoJCQl3aGlsZSAoIGktLSApIHsKCQkJCXRtcCA9IGpRdWVyeS5fZGF0YSggZWxlbWVudHNbIGkgXSwgdHlwZSArICJxdWV1ZUhvb2tzIiApOwoJCQkJaWYgKCB0bXAgJiYgdG1wLmVtcHR5ICkgewoJCQkJCWNvdW50Kys7CgkJCQkJdG1wLmVtcHR5LmFkZCggcmVzb2x2ZSApOwoJCQkJfQoJCQl9CgkJCXJlc29sdmUoKTsKCQkJcmV0dXJuIGRlZmVyLnByb21pc2UoIG9iaiApOwoJCX0KCX0gKTsKCgoJKCBmdW5jdGlvbigpIHsKCQl2YXIgc2hyaW5rV3JhcEJsb2Nrc1ZhbDsKCgkJc3VwcG9ydC5zaHJpbmtXcmFwQmxvY2tzID0gZnVuY3Rpb24oKSB7CgkJCWlmICggc2hyaW5rV3JhcEJsb2Nrc1ZhbCAhPSBudWxsICkgewoJCQkJcmV0dXJuIHNocmlua1dyYXBCbG9ja3NWYWw7CgkJCX0KCgkJCS8vIFdpbGwgYmUgY2hhbmdlZCBsYXRlciBpZiBuZWVkZWQuCgkJCXNocmlua1dyYXBCbG9ja3NWYWwgPSBmYWxzZTsKCgkJCS8vIE1pbmlmaWVkOiB2YXIgYixjLGQKCQkJdmFyIGRpdiwgYm9keSwgY29udGFpbmVyOwoKCQkJYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAiYm9keSIgKVsgMCBdOwoJCQlpZiAoICFib2R5IHx8ICFib2R5LnN0eWxlICkgewoKCQkJCS8vIFRlc3QgZmlyZWQgdG9vIGVhcmx5IG9yIGluIGFuIHVuc3VwcG9ydGVkIGVudmlyb25tZW50LCBleGl0LgoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBTZXR1cAoJCQlkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApOwoJCQljb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApOwoJCQljb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICJwb3NpdGlvbjphYnNvbHV0ZTtib3JkZXI6MDt3aWR0aDowO2hlaWdodDowO3RvcDowO2xlZnQ6LTk5OTlweCI7CgkJCWJvZHkuYXBwZW5kQ2hpbGQoIGNvbnRhaW5lciApLmFwcGVuZENoaWxkKCBkaXYgKTsKCgkJCS8vIFN1cHBvcnQ6IElFNgoJCQkvLyBDaGVjayBpZiBlbGVtZW50cyB3aXRoIGxheW91dCBzaHJpbmstd3JhcCB0aGVpciBjaGlsZHJlbgoJCQlpZiAoIHR5cGVvZiBkaXYuc3R5bGUuem9vbSAhPT0gInVuZGVmaW5lZCIgKSB7CgoJCQkJLy8gUmVzZXQgQ1NTOiBib3gtc2l6aW5nOyBkaXNwbGF5OyBtYXJnaW47IGJvcmRlcgoJCQkJZGl2LnN0eWxlLmNzc1RleHQgPQoKCQkJCQkvLyBTdXBwb3J0OiBGaXJlZm94PDI5LCBBbmRyb2lkIDIuMwoJCQkJCS8vIFZlbmRvci1wcmVmaXggYm94LXNpemluZwoJCQkJCSItd2Via2l0LWJveC1zaXppbmc6Y29udGVudC1ib3g7LW1vei1ib3gtc2l6aW5nOmNvbnRlbnQtYm94OyIgKwoJCQkJCSJib3gtc2l6aW5nOmNvbnRlbnQtYm94O2Rpc3BsYXk6YmxvY2s7bWFyZ2luOjA7Ym9yZGVyOjA7IiArCgkJCQkJInBhZGRpbmc6MXB4O3dpZHRoOjFweDt6b29tOjEiOwoJCQkJZGl2LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApICkuc3R5bGUud2lkdGggPSAiNXB4IjsKCQkJCXNocmlua1dyYXBCbG9ja3NWYWwgPSBkaXYub2Zmc2V0V2lkdGggIT09IDM7CgkJCX0KCgkJCWJvZHkucmVtb3ZlQ2hpbGQoIGNvbnRhaW5lciApOwoKCQkJcmV0dXJuIHNocmlua1dyYXBCbG9ja3NWYWw7CgkJfTsKCgl9ICkoKTsKCXZhciBwbnVtID0gKCAvWystXT8oPzpcZCpcLnwpXGQrKD86W2VFXVsrLV0/XGQrfCkvICkuc291cmNlOwoKCXZhciByY3NzTnVtID0gbmV3IFJlZ0V4cCggIl4oPzooWystXSk9fCkoIiArIHBudW0gKyAiKShbYS16JV0qKSQiLCAiaSIgKTsKCgoJdmFyIGNzc0V4cGFuZCA9IFsgIlRvcCIsICJSaWdodCIsICJCb3R0b20iLCAiTGVmdCIgXTsKCgl2YXIgaXNIaWRkZW4gPSBmdW5jdGlvbiggZWxlbSwgZWwgKSB7CgoJCQkvLyBpc0hpZGRlbiBtaWdodCBiZSBjYWxsZWQgZnJvbSBqUXVlcnkjZmlsdGVyIGZ1bmN0aW9uOwoJCQkvLyBpbiB0aGF0IGNhc2UsIGVsZW1lbnQgd2lsbCBiZSBzZWNvbmQgYXJndW1lbnQKCQkJZWxlbSA9IGVsIHx8IGVsZW07CgkJCXJldHVybiBqUXVlcnkuY3NzKCBlbGVtLCAiZGlzcGxheSIgKSA9PT0gIm5vbmUiIHx8CgkJCQkhalF1ZXJ5LmNvbnRhaW5zKCBlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0gKTsKCQl9OwoKCgoJZnVuY3Rpb24gYWRqdXN0Q1NTKCBlbGVtLCBwcm9wLCB2YWx1ZVBhcnRzLCB0d2VlbiApIHsKCQl2YXIgYWRqdXN0ZWQsCgkJCXNjYWxlID0gMSwKCQkJbWF4SXRlcmF0aW9ucyA9IDIwLAoJCQljdXJyZW50VmFsdWUgPSB0d2VlbiA/CgkJCQlmdW5jdGlvbigpIHsgcmV0dXJuIHR3ZWVuLmN1cigpOyB9IDoKCQkJCWZ1bmN0aW9uKCkgeyByZXR1cm4galF1ZXJ5LmNzcyggZWxlbSwgcHJvcCwgIiIgKTsgfSwKCQkJaW5pdGlhbCA9IGN1cnJlbnRWYWx1ZSgpLAoJCQl1bml0ID0gdmFsdWVQYXJ0cyAmJiB2YWx1ZVBhcnRzWyAzIF0gfHwgKCBqUXVlcnkuY3NzTnVtYmVyWyBwcm9wIF0gPyAiIiA6ICJweCIgKSwKCgkJCS8vIFN0YXJ0aW5nIHZhbHVlIGNvbXB1dGF0aW9uIGlzIHJlcXVpcmVkIGZvciBwb3RlbnRpYWwgdW5pdCBtaXNtYXRjaGVzCgkJCWluaXRpYWxJblVuaXQgPSAoIGpRdWVyeS5jc3NOdW1iZXJbIHByb3AgXSB8fCB1bml0ICE9PSAicHgiICYmICtpbml0aWFsICkgJiYKCQkJCXJjc3NOdW0uZXhlYyggalF1ZXJ5LmNzcyggZWxlbSwgcHJvcCApICk7CgoJCWlmICggaW5pdGlhbEluVW5pdCAmJiBpbml0aWFsSW5Vbml0WyAzIF0gIT09IHVuaXQgKSB7CgoJCQkvLyBUcnVzdCB1bml0cyByZXBvcnRlZCBieSBqUXVlcnkuY3NzCgkJCXVuaXQgPSB1bml0IHx8IGluaXRpYWxJblVuaXRbIDMgXTsKCgkJCS8vIE1ha2Ugc3VyZSB3ZSB1cGRhdGUgdGhlIHR3ZWVuIHByb3BlcnRpZXMgbGF0ZXIgb24KCQkJdmFsdWVQYXJ0cyA9IHZhbHVlUGFydHMgfHwgW107CgoJCQkvLyBJdGVyYXRpdmVseSBhcHByb3hpbWF0ZSBmcm9tIGEgbm9uemVybyBzdGFydGluZyBwb2ludAoJCQlpbml0aWFsSW5Vbml0ID0gK2luaXRpYWwgfHwgMTsKCgkJCWRvIHsKCgkJCQkvLyBJZiBwcmV2aW91cyBpdGVyYXRpb24gemVyb2VkIG91dCwgZG91YmxlIHVudGlsIHdlIGdldCAqc29tZXRoaW5nKi4KCQkJCS8vIFVzZSBzdHJpbmcgZm9yIGRvdWJsaW5nIHNvIHdlIGRvbid0IGFjY2lkZW50YWxseSBzZWUgc2NhbGUgYXMgdW5jaGFuZ2VkIGJlbG93CgkJCQlzY2FsZSA9IHNjYWxlIHx8ICIuNSI7CgoJCQkJLy8gQWRqdXN0IGFuZCBhcHBseQoJCQkJaW5pdGlhbEluVW5pdCA9IGluaXRpYWxJblVuaXQgLyBzY2FsZTsKCQkJCWpRdWVyeS5zdHlsZSggZWxlbSwgcHJvcCwgaW5pdGlhbEluVW5pdCArIHVuaXQgKTsKCgkJCS8vIFVwZGF0ZSBzY2FsZSwgdG9sZXJhdGluZyB6ZXJvIG9yIE5hTiBmcm9tIHR3ZWVuLmN1cigpCgkJCS8vIEJyZWFrIHRoZSBsb29wIGlmIHNjYWxlIGlzIHVuY2hhbmdlZCBvciBwZXJmZWN0LCBvciBpZiB3ZSd2ZSBqdXN0IGhhZCBlbm91Z2guCgkJCX0gd2hpbGUgKAoJCQkJc2NhbGUgIT09ICggc2NhbGUgPSBjdXJyZW50VmFsdWUoKSAvIGluaXRpYWwgKSAmJiBzY2FsZSAhPT0gMSAmJiAtLW1heEl0ZXJhdGlvbnMKCQkJKTsKCQl9CgoJCWlmICggdmFsdWVQYXJ0cyApIHsKCQkJaW5pdGlhbEluVW5pdCA9ICtpbml0aWFsSW5Vbml0IHx8ICtpbml0aWFsIHx8IDA7CgoJCQkvLyBBcHBseSByZWxhdGl2ZSBvZmZzZXQgKCs9Ly09KSBpZiBzcGVjaWZpZWQKCQkJYWRqdXN0ZWQgPSB2YWx1ZVBhcnRzWyAxIF0gPwoJCQkJaW5pdGlhbEluVW5pdCArICggdmFsdWVQYXJ0c1sgMSBdICsgMSApICogdmFsdWVQYXJ0c1sgMiBdIDoKCQkJCSt2YWx1ZVBhcnRzWyAyIF07CgkJCWlmICggdHdlZW4gKSB7CgkJCQl0d2Vlbi51bml0ID0gdW5pdDsKCQkJCXR3ZWVuLnN0YXJ0ID0gaW5pdGlhbEluVW5pdDsKCQkJCXR3ZWVuLmVuZCA9IGFkanVzdGVkOwoJCQl9CgkJfQoJCXJldHVybiBhZGp1c3RlZDsKCX0KCgoJLy8gTXVsdGlmdW5jdGlvbmFsIG1ldGhvZCB0byBnZXQgYW5kIHNldCB2YWx1ZXMgb2YgYSBjb2xsZWN0aW9uCgkvLyBUaGUgdmFsdWUvcyBjYW4gb3B0aW9uYWxseSBiZSBleGVjdXRlZCBpZiBpdCdzIGEgZnVuY3Rpb24KCXZhciBhY2Nlc3MgPSBmdW5jdGlvbiggZWxlbXMsIGZuLCBrZXksIHZhbHVlLCBjaGFpbmFibGUsIGVtcHR5R2V0LCByYXcgKSB7CgkJdmFyIGkgPSAwLAoJCQlsZW5ndGggPSBlbGVtcy5sZW5ndGgsCgkJCWJ1bGsgPSBrZXkgPT0gbnVsbDsKCgkJLy8gU2V0cyBtYW55IHZhbHVlcwoJCWlmICggalF1ZXJ5LnR5cGUoIGtleSApID09PSAib2JqZWN0IiApIHsKCQkJY2hhaW5hYmxlID0gdHJ1ZTsKCQkJZm9yICggaSBpbiBrZXkgKSB7CgkJCQlhY2Nlc3MoIGVsZW1zLCBmbiwgaSwga2V5WyBpIF0sIHRydWUsIGVtcHR5R2V0LCByYXcgKTsKCQkJfQoKCQkvLyBTZXRzIG9uZSB2YWx1ZQoJCX0gZWxzZSBpZiAoIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7CgkJCWNoYWluYWJsZSA9IHRydWU7CgoJCQlpZiAoICFqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHsKCQkJCXJhdyA9IHRydWU7CgkJCX0KCgkJCWlmICggYnVsayApIHsKCgkJCQkvLyBCdWxrIG9wZXJhdGlvbnMgcnVuIGFnYWluc3QgdGhlIGVudGlyZSBzZXQKCQkJCWlmICggcmF3ICkgewoJCQkJCWZuLmNhbGwoIGVsZW1zLCB2YWx1ZSApOwoJCQkJCWZuID0gbnVsbDsKCgkJCQkvLyAuLi5leGNlcHQgd2hlbiBleGVjdXRpbmcgZnVuY3Rpb24gdmFsdWVzCgkJCQl9IGVsc2UgewoJCQkJCWJ1bGsgPSBmbjsKCQkJCQlmbiA9IGZ1bmN0aW9uKCBlbGVtLCBrZXksIHZhbHVlICkgewoJCQkJCQlyZXR1cm4gYnVsay5jYWxsKCBqUXVlcnkoIGVsZW0gKSwgdmFsdWUgKTsKCQkJCQl9OwoJCQkJfQoJCQl9CgoJCQlpZiAoIGZuICkgewoJCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCQkJZm4oCgkJCQkJCWVsZW1zWyBpIF0sCgkJCQkJCWtleSwKCQkJCQkJcmF3ID8gdmFsdWUgOiB2YWx1ZS5jYWxsKCBlbGVtc1sgaSBdLCBpLCBmbiggZWxlbXNbIGkgXSwga2V5ICkgKQoJCQkJCSk7CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiBjaGFpbmFibGUgPwoJCQllbGVtcyA6CgoJCQkvLyBHZXRzCgkJCWJ1bGsgPwoJCQkJZm4uY2FsbCggZWxlbXMgKSA6CgkJCQlsZW5ndGggPyBmbiggZWxlbXNbIDAgXSwga2V5ICkgOiBlbXB0eUdldDsKCX07Cgl2YXIgcmNoZWNrYWJsZVR5cGUgPSAoIC9eKD86Y2hlY2tib3h8cmFkaW8pJC9pICk7CgoJdmFyIHJ0YWdOYW1lID0gKCAvPChbXHc6LV0rKS8gKTsKCgl2YXIgcnNjcmlwdFR5cGUgPSAoIC9eJHxcLyg/OmphdmF8ZWNtYSlzY3JpcHQvaSApOwoKCXZhciBybGVhZGluZ1doaXRlc3BhY2UgPSAoIC9eXHMrLyApOwoKCXZhciBub2RlTmFtZXMgPSAiYWJicnxhcnRpY2xlfGFzaWRlfGF1ZGlvfGJkaXxjYW52YXN8ZGF0YXxkYXRhbGlzdHwiICsKCQkJImRldGFpbHN8ZGlhbG9nfGZpZ2NhcHRpb258ZmlndXJlfGZvb3RlcnxoZWFkZXJ8aGdyb3VwfG1haW58IiArCgkJCSJtYXJrfG1ldGVyfG5hdnxvdXRwdXR8cGljdHVyZXxwcm9ncmVzc3xzZWN0aW9ufHN1bW1hcnl8dGVtcGxhdGV8dGltZXx2aWRlbyI7CgoKCglmdW5jdGlvbiBjcmVhdGVTYWZlRnJhZ21lbnQoIGRvY3VtZW50ICkgewoJCXZhciBsaXN0ID0gbm9kZU5hbWVzLnNwbGl0KCAifCIgKSwKCQkJc2FmZUZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CgoJCWlmICggc2FmZUZyYWcuY3JlYXRlRWxlbWVudCApIHsKCQkJd2hpbGUgKCBsaXN0Lmxlbmd0aCApIHsKCQkJCXNhZmVGcmFnLmNyZWF0ZUVsZW1lbnQoCgkJCQkJbGlzdC5wb3AoKQoJCQkJKTsKCQkJfQoJCX0KCQlyZXR1cm4gc2FmZUZyYWc7Cgl9CgoKCSggZnVuY3Rpb24oKSB7CgkJdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICksCgkJCWZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLAoJCQlpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJpbnB1dCIgKTsKCgkJLy8gU2V0dXAKCQlkaXYuaW5uZXJIVE1MID0gIiAgPGxpbmsvPjx0YWJsZT48L3RhYmxlPjxhIGhyZWY9Jy9hJz5hPC9hPjxpbnB1dCB0eXBlPSdjaGVja2JveCcvPiI7CgoJCS8vIElFIHN0cmlwcyBsZWFkaW5nIHdoaXRlc3BhY2Ugd2hlbiAuaW5uZXJIVE1MIGlzIHVzZWQKCQlzdXBwb3J0LmxlYWRpbmdXaGl0ZXNwYWNlID0gZGl2LmZpcnN0Q2hpbGQubm9kZVR5cGUgPT09IDM7CgoJCS8vIE1ha2Ugc3VyZSB0aGF0IHRib2R5IGVsZW1lbnRzIGFyZW4ndCBhdXRvbWF0aWNhbGx5IGluc2VydGVkCgkJLy8gSUUgd2lsbCBpbnNlcnQgdGhlbSBpbnRvIGVtcHR5IHRhYmxlcwoJCXN1cHBvcnQudGJvZHkgPSAhZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAidGJvZHkiICkubGVuZ3RoOwoKCQkvLyBNYWtlIHN1cmUgdGhhdCBsaW5rIGVsZW1lbnRzIGdldCBzZXJpYWxpemVkIGNvcnJlY3RseSBieSBpbm5lckhUTUwKCQkvLyBUaGlzIHJlcXVpcmVzIGEgd3JhcHBlciBlbGVtZW50IGluIElFCgkJc3VwcG9ydC5odG1sU2VyaWFsaXplID0gISFkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJsaW5rIiApLmxlbmd0aDsKCgkJLy8gTWFrZXMgc3VyZSBjbG9uaW5nIGFuIGh0bWw1IGVsZW1lbnQgZG9lcyBub3QgY2F1c2UgcHJvYmxlbXMKCQkvLyBXaGVyZSBvdXRlckhUTUwgaXMgdW5kZWZpbmVkLCB0aGlzIHN0aWxsIHdvcmtzCgkJc3VwcG9ydC5odG1sNUNsb25lID0KCQkJZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggIm5hdiIgKS5jbG9uZU5vZGUoIHRydWUgKS5vdXRlckhUTUwgIT09ICI8Om5hdj48LzpuYXY+IjsKCgkJLy8gQ2hlY2sgaWYgYSBkaXNjb25uZWN0ZWQgY2hlY2tib3ggd2lsbCByZXRhaW4gaXRzIGNoZWNrZWQKCQkvLyB2YWx1ZSBvZiB0cnVlIGFmdGVyIGFwcGVuZGVkIHRvIHRoZSBET00gKElFNi83KQoJCWlucHV0LnR5cGUgPSAiY2hlY2tib3giOwoJCWlucHV0LmNoZWNrZWQgPSB0cnVlOwoJCWZyYWdtZW50LmFwcGVuZENoaWxkKCBpbnB1dCApOwoJCXN1cHBvcnQuYXBwZW5kQ2hlY2tlZCA9IGlucHV0LmNoZWNrZWQ7CgoJCS8vIE1ha2Ugc3VyZSB0ZXh0YXJlYSAoYW5kIGNoZWNrYm94KSBkZWZhdWx0VmFsdWUgaXMgcHJvcGVybHkgY2xvbmVkCgkJLy8gU3VwcG9ydDogSUU2LUlFMTErCgkJZGl2LmlubmVySFRNTCA9ICI8dGV4dGFyZWE+eDwvdGV4dGFyZWE+IjsKCQlzdXBwb3J0Lm5vQ2xvbmVDaGVja2VkID0gISFkaXYuY2xvbmVOb2RlKCB0cnVlICkubGFzdENoaWxkLmRlZmF1bHRWYWx1ZTsKCgkJLy8gIzExMjE3IC0gV2ViS2l0IGxvc2VzIGNoZWNrIHdoZW4gdGhlIG5hbWUgaXMgYWZ0ZXIgdGhlIGNoZWNrZWQgYXR0cmlidXRlCgkJZnJhZ21lbnQuYXBwZW5kQ2hpbGQoIGRpdiApOwoKCQkvLyBTdXBwb3J0OiBXaW5kb3dzIFdlYiBBcHBzIChXV0EpCgkJLy8gYG5hbWVgIGFuZCBgdHlwZWAgbXVzdCB1c2UgLnNldEF0dHJpYnV0ZSBmb3IgV1dBICgjMTQ5MDEpCgkJaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiaW5wdXQiICk7CgkJaW5wdXQuc2V0QXR0cmlidXRlKCAidHlwZSIsICJyYWRpbyIgKTsKCQlpbnB1dC5zZXRBdHRyaWJ1dGUoICJjaGVja2VkIiwgImNoZWNrZWQiICk7CgkJaW5wdXQuc2V0QXR0cmlidXRlKCAibmFtZSIsICJ0IiApOwoKCQlkaXYuYXBwZW5kQ2hpbGQoIGlucHV0ICk7CgoJCS8vIFN1cHBvcnQ6IFNhZmFyaSA1LjEsIGlPUyA1LjEsIEFuZHJvaWQgNC54LCBBbmRyb2lkIDIuMwoJCS8vIG9sZCBXZWJLaXQgZG9lc24ndCBjbG9uZSBjaGVja2VkIHN0YXRlIGNvcnJlY3RseSBpbiBmcmFnbWVudHMKCQlzdXBwb3J0LmNoZWNrQ2xvbmUgPSBkaXYuY2xvbmVOb2RlKCB0cnVlICkuY2xvbmVOb2RlKCB0cnVlICkubGFzdENoaWxkLmNoZWNrZWQ7CgoJCS8vIFN1cHBvcnQ6IElFPDkKCQkvLyBDbG9uZWQgZWxlbWVudHMga2VlcCBhdHRhY2hFdmVudCBoYW5kbGVycywgd2UgdXNlIGFkZEV2ZW50TGlzdGVuZXIgb24gSUU5KwoJCXN1cHBvcnQubm9DbG9uZUV2ZW50ID0gISFkaXYuYWRkRXZlbnRMaXN0ZW5lcjsKCgkJLy8gU3VwcG9ydDogSUU8OQoJCS8vIFNpbmNlIGF0dHJpYnV0ZXMgYW5kIHByb3BlcnRpZXMgYXJlIHRoZSBzYW1lIGluIElFLAoJCS8vIGNsZWFuRGF0YSBtdXN0IHNldCBwcm9wZXJ0aWVzIHRvIHVuZGVmaW5lZCByYXRoZXIgdGhhbiB1c2UgcmVtb3ZlQXR0cmlidXRlCgkJZGl2WyBqUXVlcnkuZXhwYW5kbyBdID0gMTsKCQlzdXBwb3J0LmF0dHJpYnV0ZXMgPSAhZGl2LmdldEF0dHJpYnV0ZSggalF1ZXJ5LmV4cGFuZG8gKTsKCX0gKSgpOwoKCgkvLyBXZSBoYXZlIHRvIGNsb3NlIHRoZXNlIHRhZ3MgdG8gc3VwcG9ydCBYSFRNTCAoIzEzMjAwKQoJdmFyIHdyYXBNYXAgPSB7CgkJb3B0aW9uOiBbIDEsICI8c2VsZWN0IG11bHRpcGxlPSdtdWx0aXBsZSc+IiwgIjwvc2VsZWN0PiIgXSwKCQlsZWdlbmQ6IFsgMSwgIjxmaWVsZHNldD4iLCAiPC9maWVsZHNldD4iIF0sCgkJYXJlYTogWyAxLCAiPG1hcD4iLCAiPC9tYXA+IiBdLAoKCQkvLyBTdXBwb3J0OiBJRTgKCQlwYXJhbTogWyAxLCAiPG9iamVjdD4iLCAiPC9vYmplY3Q+IiBdLAoJCXRoZWFkOiBbIDEsICI8dGFibGU+IiwgIjwvdGFibGU+IiBdLAoJCXRyOiBbIDIsICI8dGFibGU+PHRib2R5PiIsICI8L3Rib2R5PjwvdGFibGU+IiBdLAoJCWNvbDogWyAyLCAiPHRhYmxlPjx0Ym9keT48L3Rib2R5Pjxjb2xncm91cD4iLCAiPC9jb2xncm91cD48L3RhYmxlPiIgXSwKCQl0ZDogWyAzLCAiPHRhYmxlPjx0Ym9keT48dHI+IiwgIjwvdHI+PC90Ym9keT48L3RhYmxlPiIgXSwKCgkJLy8gSUU2LTggY2FuJ3Qgc2VyaWFsaXplIGxpbmssIHNjcmlwdCwgc3R5bGUsIG9yIGFueSBodG1sNSAoTm9TY29wZSkgdGFncywKCQkvLyB1bmxlc3Mgd3JhcHBlZCBpbiBhIGRpdiB3aXRoIG5vbi1icmVha2luZyBjaGFyYWN0ZXJzIGluIGZyb250IG9mIGl0LgoJCV9kZWZhdWx0OiBzdXBwb3J0Lmh0bWxTZXJpYWxpemUgPyBbIDAsICIiLCAiIiBdIDogWyAxLCAiWDxkaXY+IiwgIjwvZGl2PiIgXQoJfTsKCgkvLyBTdXBwb3J0OiBJRTgtSUU5Cgl3cmFwTWFwLm9wdGdyb3VwID0gd3JhcE1hcC5vcHRpb247CgoJd3JhcE1hcC50Ym9keSA9IHdyYXBNYXAudGZvb3QgPSB3cmFwTWFwLmNvbGdyb3VwID0gd3JhcE1hcC5jYXB0aW9uID0gd3JhcE1hcC50aGVhZDsKCXdyYXBNYXAudGggPSB3cmFwTWFwLnRkOwoKCglmdW5jdGlvbiBnZXRBbGwoIGNvbnRleHQsIHRhZyApIHsKCQl2YXIgZWxlbXMsIGVsZW0sCgkJCWkgPSAwLAoJCQlmb3VuZCA9IHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lICE9PSAidW5kZWZpbmVkIiA/CgkJCQljb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCB0YWcgfHwgIioiICkgOgoJCQkJdHlwZW9mIGNvbnRleHQucXVlcnlTZWxlY3RvckFsbCAhPT0gInVuZGVmaW5lZCIgPwoJCQkJCWNvbnRleHQucXVlcnlTZWxlY3RvckFsbCggdGFnIHx8ICIqIiApIDoKCQkJCQl1bmRlZmluZWQ7CgoJCWlmICggIWZvdW5kICkgewoJCQlmb3IgKCBmb3VuZCA9IFtdLCBlbGVtcyA9IGNvbnRleHQuY2hpbGROb2RlcyB8fCBjb250ZXh0OwoJCQkJKCBlbGVtID0gZWxlbXNbIGkgXSApICE9IG51bGw7CgkJCQlpKysKCQkJKSB7CgkJCQlpZiAoICF0YWcgfHwgalF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCB0YWcgKSApIHsKCQkJCQlmb3VuZC5wdXNoKCBlbGVtICk7CgkJCQl9IGVsc2UgewoJCQkJCWpRdWVyeS5tZXJnZSggZm91bmQsIGdldEFsbCggZWxlbSwgdGFnICkgKTsKCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIHRhZyA9PT0gdW5kZWZpbmVkIHx8IHRhZyAmJiBqUXVlcnkubm9kZU5hbWUoIGNvbnRleHQsIHRhZyApID8KCQkJalF1ZXJ5Lm1lcmdlKCBbIGNvbnRleHQgXSwgZm91bmQgKSA6CgkJCWZvdW5kOwoJfQoKCgkvLyBNYXJrIHNjcmlwdHMgYXMgaGF2aW5nIGFscmVhZHkgYmVlbiBldmFsdWF0ZWQKCWZ1bmN0aW9uIHNldEdsb2JhbEV2YWwoIGVsZW1zLCByZWZFbGVtZW50cyApIHsKCQl2YXIgZWxlbSwKCQkJaSA9IDA7CgkJZm9yICggOyAoIGVsZW0gPSBlbGVtc1sgaSBdICkgIT0gbnVsbDsgaSsrICkgewoJCQlqUXVlcnkuX2RhdGEoCgkJCQllbGVtLAoJCQkJImdsb2JhbEV2YWwiLAoJCQkJIXJlZkVsZW1lbnRzIHx8IGpRdWVyeS5fZGF0YSggcmVmRWxlbWVudHNbIGkgXSwgImdsb2JhbEV2YWwiICkKCQkJKTsKCQl9Cgl9CgoKCXZhciByaHRtbCA9IC88fCYjP1x3KzsvLAoJCXJ0Ym9keSA9IC88dGJvZHkvaTsKCglmdW5jdGlvbiBmaXhEZWZhdWx0Q2hlY2tlZCggZWxlbSApIHsKCQlpZiAoIHJjaGVja2FibGVUeXBlLnRlc3QoIGVsZW0udHlwZSApICkgewoJCQllbGVtLmRlZmF1bHRDaGVja2VkID0gZWxlbS5jaGVja2VkOwoJCX0KCX0KCglmdW5jdGlvbiBidWlsZEZyYWdtZW50KCBlbGVtcywgY29udGV4dCwgc2NyaXB0cywgc2VsZWN0aW9uLCBpZ25vcmVkICkgewoJCXZhciBqLCBlbGVtLCBjb250YWlucywKCQkJdG1wLCB0YWcsIHRib2R5LCB3cmFwLAoJCQlsID0gZWxlbXMubGVuZ3RoLAoKCQkJLy8gRW5zdXJlIGEgc2FmZSBmcmFnbWVudAoJCQlzYWZlID0gY3JlYXRlU2FmZUZyYWdtZW50KCBjb250ZXh0ICksCgoJCQlub2RlcyA9IFtdLAoJCQlpID0gMDsKCgkJZm9yICggOyBpIDwgbDsgaSsrICkgewoJCQllbGVtID0gZWxlbXNbIGkgXTsKCgkJCWlmICggZWxlbSB8fCBlbGVtID09PSAwICkgewoKCQkJCS8vIEFkZCBub2RlcyBkaXJlY3RseQoJCQkJaWYgKCBqUXVlcnkudHlwZSggZWxlbSApID09PSAib2JqZWN0IiApIHsKCQkJCQlqUXVlcnkubWVyZ2UoIG5vZGVzLCBlbGVtLm5vZGVUeXBlID8gWyBlbGVtIF0gOiBlbGVtICk7CgoJCQkJLy8gQ29udmVydCBub24taHRtbCBpbnRvIGEgdGV4dCBub2RlCgkJCQl9IGVsc2UgaWYgKCAhcmh0bWwudGVzdCggZWxlbSApICkgewoJCQkJCW5vZGVzLnB1c2goIGNvbnRleHQuY3JlYXRlVGV4dE5vZGUoIGVsZW0gKSApOwoKCQkJCS8vIENvbnZlcnQgaHRtbCBpbnRvIERPTSBub2RlcwoJCQkJfSBlbHNlIHsKCQkJCQl0bXAgPSB0bXAgfHwgc2FmZS5hcHBlbmRDaGlsZCggY29udGV4dC5jcmVhdGVFbGVtZW50KCAiZGl2IiApICk7CgoJCQkJCS8vIERlc2VyaWFsaXplIGEgc3RhbmRhcmQgcmVwcmVzZW50YXRpb24KCQkJCQl0YWcgPSAoIHJ0YWdOYW1lLmV4ZWMoIGVsZW0gKSB8fCBbICIiLCAiIiBdIClbIDEgXS50b0xvd2VyQ2FzZSgpOwoJCQkJCXdyYXAgPSB3cmFwTWFwWyB0YWcgXSB8fCB3cmFwTWFwLl9kZWZhdWx0OwoKCQkJCQl0bXAuaW5uZXJIVE1MID0gd3JhcFsgMSBdICsgalF1ZXJ5Lmh0bWxQcmVmaWx0ZXIoIGVsZW0gKSArIHdyYXBbIDIgXTsKCgkJCQkJLy8gRGVzY2VuZCB0aHJvdWdoIHdyYXBwZXJzIHRvIHRoZSByaWdodCBjb250ZW50CgkJCQkJaiA9IHdyYXBbIDAgXTsKCQkJCQl3aGlsZSAoIGotLSApIHsKCQkJCQkJdG1wID0gdG1wLmxhc3RDaGlsZDsKCQkJCQl9CgoJCQkJCS8vIE1hbnVhbGx5IGFkZCBsZWFkaW5nIHdoaXRlc3BhY2UgcmVtb3ZlZCBieSBJRQoJCQkJCWlmICggIXN1cHBvcnQubGVhZGluZ1doaXRlc3BhY2UgJiYgcmxlYWRpbmdXaGl0ZXNwYWNlLnRlc3QoIGVsZW0gKSApIHsKCQkJCQkJbm9kZXMucHVzaCggY29udGV4dC5jcmVhdGVUZXh0Tm9kZSggcmxlYWRpbmdXaGl0ZXNwYWNlLmV4ZWMoIGVsZW0gKVsgMCBdICkgKTsKCQkJCQl9CgoJCQkJCS8vIFJlbW92ZSBJRSdzIGF1dG9pbnNlcnRlZCA8dGJvZHk+IGZyb20gdGFibGUgZnJhZ21lbnRzCgkJCQkJaWYgKCAhc3VwcG9ydC50Ym9keSApIHsKCgkJCQkJCS8vIFN0cmluZyB3YXMgYSA8dGFibGU+LCAqbWF5KiBoYXZlIHNwdXJpb3VzIDx0Ym9keT4KCQkJCQkJZWxlbSA9IHRhZyA9PT0gInRhYmxlIiAmJiAhcnRib2R5LnRlc3QoIGVsZW0gKSA/CgkJCQkJCQl0bXAuZmlyc3RDaGlsZCA6CgoJCQkJCQkJLy8gU3RyaW5nIHdhcyBhIGJhcmUgPHRoZWFkPiBvciA8dGZvb3Q+CgkJCQkJCQl3cmFwWyAxIF0gPT09ICI8dGFibGU+IiAmJiAhcnRib2R5LnRlc3QoIGVsZW0gKSA/CgkJCQkJCQkJdG1wIDoKCQkJCQkJCQkwOwoKCQkJCQkJaiA9IGVsZW0gJiYgZWxlbS5jaGlsZE5vZGVzLmxlbmd0aDsKCQkJCQkJd2hpbGUgKCBqLS0gKSB7CgkJCQkJCQlpZiAoIGpRdWVyeS5ub2RlTmFtZSggKCB0Ym9keSA9IGVsZW0uY2hpbGROb2Rlc1sgaiBdICksICJ0Ym9keSIgKSAmJgoJCQkJCQkJCSF0Ym9keS5jaGlsZE5vZGVzLmxlbmd0aCApIHsKCgkJCQkJCQkJZWxlbS5yZW1vdmVDaGlsZCggdGJvZHkgKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCgkJCQkJalF1ZXJ5Lm1lcmdlKCBub2RlcywgdG1wLmNoaWxkTm9kZXMgKTsKCgkJCQkJLy8gRml4ICMxMjM5MiBmb3IgV2ViS2l0IGFuZCBJRSA+IDkKCQkJCQl0bXAudGV4dENvbnRlbnQgPSAiIjsKCgkJCQkJLy8gRml4ICMxMjM5MiBmb3Igb2xkSUUKCQkJCQl3aGlsZSAoIHRtcC5maXJzdENoaWxkICkgewoJCQkJCQl0bXAucmVtb3ZlQ2hpbGQoIHRtcC5maXJzdENoaWxkICk7CgkJCQkJfQoKCQkJCQkvLyBSZW1lbWJlciB0aGUgdG9wLWxldmVsIGNvbnRhaW5lciBmb3IgcHJvcGVyIGNsZWFudXAKCQkJCQl0bXAgPSBzYWZlLmxhc3RDaGlsZDsKCQkJCX0KCQkJfQoJCX0KCgkJLy8gRml4ICMxMTM1NjogQ2xlYXIgZWxlbWVudHMgZnJvbSBmcmFnbWVudAoJCWlmICggdG1wICkgewoJCQlzYWZlLnJlbW92ZUNoaWxkKCB0bXAgKTsKCQl9CgoJCS8vIFJlc2V0IGRlZmF1bHRDaGVja2VkIGZvciBhbnkgcmFkaW9zIGFuZCBjaGVja2JveGVzCgkJLy8gYWJvdXQgdG8gYmUgYXBwZW5kZWQgdG8gdGhlIERPTSBpbiBJRSA2LzcgKCM4MDYwKQoJCWlmICggIXN1cHBvcnQuYXBwZW5kQ2hlY2tlZCApIHsKCQkJalF1ZXJ5LmdyZXAoIGdldEFsbCggbm9kZXMsICJpbnB1dCIgKSwgZml4RGVmYXVsdENoZWNrZWQgKTsKCQl9CgoJCWkgPSAwOwoJCXdoaWxlICggKCBlbGVtID0gbm9kZXNbIGkrKyBdICkgKSB7CgoJCQkvLyBTa2lwIGVsZW1lbnRzIGFscmVhZHkgaW4gdGhlIGNvbnRleHQgY29sbGVjdGlvbiAodHJhYy00MDg3KQoJCQlpZiAoIHNlbGVjdGlvbiAmJiBqUXVlcnkuaW5BcnJheSggZWxlbSwgc2VsZWN0aW9uICkgPiAtMSApIHsKCQkJCWlmICggaWdub3JlZCApIHsKCQkJCQlpZ25vcmVkLnB1c2goIGVsZW0gKTsKCQkJCX0KCgkJCQljb250aW51ZTsKCQkJfQoKCQkJY29udGFpbnMgPSBqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSApOwoKCQkJLy8gQXBwZW5kIHRvIGZyYWdtZW50CgkJCXRtcCA9IGdldEFsbCggc2FmZS5hcHBlbmRDaGlsZCggZWxlbSApLCAic2NyaXB0IiApOwoKCQkJLy8gUHJlc2VydmUgc2NyaXB0IGV2YWx1YXRpb24gaGlzdG9yeQoJCQlpZiAoIGNvbnRhaW5zICkgewoJCQkJc2V0R2xvYmFsRXZhbCggdG1wICk7CgkJCX0KCgkJCS8vIENhcHR1cmUgZXhlY3V0YWJsZXMKCQkJaWYgKCBzY3JpcHRzICkgewoJCQkJaiA9IDA7CgkJCQl3aGlsZSAoICggZWxlbSA9IHRtcFsgaisrIF0gKSApIHsKCQkJCQlpZiAoIHJzY3JpcHRUeXBlLnRlc3QoIGVsZW0udHlwZSB8fCAiIiApICkgewoJCQkJCQlzY3JpcHRzLnB1c2goIGVsZW0gKTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCXRtcCA9IG51bGw7CgoJCXJldHVybiBzYWZlOwoJfQoKCgkoIGZ1bmN0aW9uKCkgewoJCXZhciBpLCBldmVudE5hbWUsCgkJCWRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICk7CgoJCS8vIFN1cHBvcnQ6IElFPDkgKGxhY2sgc3VibWl0L2NoYW5nZSBidWJibGUpLCBGaXJlZm94IChsYWNrIGZvY3VzKGluIHwgb3V0KSBldmVudHMpCgkJZm9yICggaSBpbiB7IHN1Ym1pdDogdHJ1ZSwgY2hhbmdlOiB0cnVlLCBmb2N1c2luOiB0cnVlIH0gKSB7CgkJCWV2ZW50TmFtZSA9ICJvbiIgKyBpOwoKCQkJaWYgKCAhKCBzdXBwb3J0WyBpIF0gPSBldmVudE5hbWUgaW4gd2luZG93ICkgKSB7CgoJCQkJLy8gQmV3YXJlIG9mIENTUCByZXN0cmljdGlvbnMgKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL1NlY3VyaXR5L0NTUCkKCQkJCWRpdi5zZXRBdHRyaWJ1dGUoIGV2ZW50TmFtZSwgInQiICk7CgkJCQlzdXBwb3J0WyBpIF0gPSBkaXYuYXR0cmlidXRlc1sgZXZlbnROYW1lIF0uZXhwYW5kbyA9PT0gZmFsc2U7CgkJCX0KCQl9CgoJCS8vIE51bGwgZWxlbWVudHMgdG8gYXZvaWQgbGVha3MgaW4gSUUuCgkJZGl2ID0gbnVsbDsKCX0gKSgpOwoKCgl2YXIgcmZvcm1FbGVtcyA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhKSQvaSwKCQlya2V5RXZlbnQgPSAvXmtleS8sCgkJcm1vdXNlRXZlbnQgPSAvXig/Om1vdXNlfHBvaW50ZXJ8Y29udGV4dG1lbnV8ZHJhZ3xkcm9wKXxjbGljay8sCgkJcmZvY3VzTW9ycGggPSAvXig/OmZvY3VzaW5mb2N1c3xmb2N1c291dGJsdXIpJC8sCgkJcnR5cGVuYW1lc3BhY2UgPSAvXihbXi5dKikoPzpcLiguKyl8KS87CgoJZnVuY3Rpb24gcmV0dXJuVHJ1ZSgpIHsKCQlyZXR1cm4gdHJ1ZTsKCX0KCglmdW5jdGlvbiByZXR1cm5GYWxzZSgpIHsKCQlyZXR1cm4gZmFsc2U7Cgl9CgoJLy8gU3VwcG9ydDogSUU5CgkvLyBTZWUgIzEzMzkzIGZvciBtb3JlIGluZm8KCWZ1bmN0aW9uIHNhZmVBY3RpdmVFbGVtZW50KCkgewoJCXRyeSB7CgkJCXJldHVybiBkb2N1bWVudC5hY3RpdmVFbGVtZW50OwoJCX0gY2F0Y2ggKCBlcnIgKSB7IH0KCX0KCglmdW5jdGlvbiBvbiggZWxlbSwgdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiwgb25lICkgewoJCXZhciBvcmlnRm4sIHR5cGU7CgoJCS8vIFR5cGVzIGNhbiBiZSBhIG1hcCBvZiB0eXBlcy9oYW5kbGVycwoJCWlmICggdHlwZW9mIHR5cGVzID09PSAib2JqZWN0IiApIHsKCgkJCS8vICggdHlwZXMtT2JqZWN0LCBzZWxlY3RvciwgZGF0YSApCgkJCWlmICggdHlwZW9mIHNlbGVjdG9yICE9PSAic3RyaW5nIiApIHsKCgkJCQkvLyAoIHR5cGVzLU9iamVjdCwgZGF0YSApCgkJCQlkYXRhID0gZGF0YSB8fCBzZWxlY3RvcjsKCQkJCXNlbGVjdG9yID0gdW5kZWZpbmVkOwoJCQl9CgkJCWZvciAoIHR5cGUgaW4gdHlwZXMgKSB7CgkJCQlvbiggZWxlbSwgdHlwZSwgc2VsZWN0b3IsIGRhdGEsIHR5cGVzWyB0eXBlIF0sIG9uZSApOwoJCQl9CgkJCXJldHVybiBlbGVtOwoJCX0KCgkJaWYgKCBkYXRhID09IG51bGwgJiYgZm4gPT0gbnVsbCApIHsKCgkJCS8vICggdHlwZXMsIGZuICkKCQkJZm4gPSBzZWxlY3RvcjsKCQkJZGF0YSA9IHNlbGVjdG9yID0gdW5kZWZpbmVkOwoJCX0gZWxzZSBpZiAoIGZuID09IG51bGwgKSB7CgkJCWlmICggdHlwZW9mIHNlbGVjdG9yID09PSAic3RyaW5nIiApIHsKCgkJCQkvLyAoIHR5cGVzLCBzZWxlY3RvciwgZm4gKQoJCQkJZm4gPSBkYXRhOwoJCQkJZGF0YSA9IHVuZGVmaW5lZDsKCQkJfSBlbHNlIHsKCgkJCQkvLyAoIHR5cGVzLCBkYXRhLCBmbiApCgkJCQlmbiA9IGRhdGE7CgkJCQlkYXRhID0gc2VsZWN0b3I7CgkJCQlzZWxlY3RvciA9IHVuZGVmaW5lZDsKCQkJfQoJCX0KCQlpZiAoIGZuID09PSBmYWxzZSApIHsKCQkJZm4gPSByZXR1cm5GYWxzZTsKCQl9IGVsc2UgaWYgKCAhZm4gKSB7CgkJCXJldHVybiBlbGVtOwoJCX0KCgkJaWYgKCBvbmUgPT09IDEgKSB7CgkJCW9yaWdGbiA9IGZuOwoJCQlmbiA9IGZ1bmN0aW9uKCBldmVudCApIHsKCgkJCQkvLyBDYW4gdXNlIGFuIGVtcHR5IHNldCwgc2luY2UgZXZlbnQgY29udGFpbnMgdGhlIGluZm8KCQkJCWpRdWVyeSgpLm9mZiggZXZlbnQgKTsKCQkJCXJldHVybiBvcmlnRm4uYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOwoJCQl9OwoKCQkJLy8gVXNlIHNhbWUgZ3VpZCBzbyBjYWxsZXIgY2FuIHJlbW92ZSB1c2luZyBvcmlnRm4KCQkJZm4uZ3VpZCA9IG9yaWdGbi5ndWlkIHx8ICggb3JpZ0ZuLmd1aWQgPSBqUXVlcnkuZ3VpZCsrICk7CgkJfQoJCXJldHVybiBlbGVtLmVhY2goIGZ1bmN0aW9uKCkgewoJCQlqUXVlcnkuZXZlbnQuYWRkKCB0aGlzLCB0eXBlcywgZm4sIGRhdGEsIHNlbGVjdG9yICk7CgkJfSApOwoJfQoKCS8qCgkgKiBIZWxwZXIgZnVuY3Rpb25zIGZvciBtYW5hZ2luZyBldmVudHMgLS0gbm90IHBhcnQgb2YgdGhlIHB1YmxpYyBpbnRlcmZhY2UuCgkgKiBQcm9wcyB0byBEZWFuIEVkd2FyZHMnIGFkZEV2ZW50IGxpYnJhcnkgZm9yIG1hbnkgb2YgdGhlIGlkZWFzLgoJICovCglqUXVlcnkuZXZlbnQgPSB7CgoJCWdsb2JhbDoge30sCgoJCWFkZDogZnVuY3Rpb24oIGVsZW0sIHR5cGVzLCBoYW5kbGVyLCBkYXRhLCBzZWxlY3RvciApIHsKCQkJdmFyIHRtcCwgZXZlbnRzLCB0LCBoYW5kbGVPYmpJbiwKCQkJCXNwZWNpYWwsIGV2ZW50SGFuZGxlLCBoYW5kbGVPYmosCgkJCQloYW5kbGVycywgdHlwZSwgbmFtZXNwYWNlcywgb3JpZ1R5cGUsCgkJCQllbGVtRGF0YSA9IGpRdWVyeS5fZGF0YSggZWxlbSApOwoKCQkJLy8gRG9uJ3QgYXR0YWNoIGV2ZW50cyB0byBub0RhdGEgb3IgdGV4dC9jb21tZW50IG5vZGVzIChidXQgYWxsb3cgcGxhaW4gb2JqZWN0cykKCQkJaWYgKCAhZWxlbURhdGEgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIENhbGxlciBjYW4gcGFzcyBpbiBhbiBvYmplY3Qgb2YgY3VzdG9tIGRhdGEgaW4gbGlldSBvZiB0aGUgaGFuZGxlcgoJCQlpZiAoIGhhbmRsZXIuaGFuZGxlciApIHsKCQkJCWhhbmRsZU9iakluID0gaGFuZGxlcjsKCQkJCWhhbmRsZXIgPSBoYW5kbGVPYmpJbi5oYW5kbGVyOwoJCQkJc2VsZWN0b3IgPSBoYW5kbGVPYmpJbi5zZWxlY3RvcjsKCQkJfQoKCQkJLy8gTWFrZSBzdXJlIHRoYXQgdGhlIGhhbmRsZXIgaGFzIGEgdW5pcXVlIElELCB1c2VkIHRvIGZpbmQvcmVtb3ZlIGl0IGxhdGVyCgkJCWlmICggIWhhbmRsZXIuZ3VpZCApIHsKCQkJCWhhbmRsZXIuZ3VpZCA9IGpRdWVyeS5ndWlkKys7CgkJCX0KCgkJCS8vIEluaXQgdGhlIGVsZW1lbnQncyBldmVudCBzdHJ1Y3R1cmUgYW5kIG1haW4gaGFuZGxlciwgaWYgdGhpcyBpcyB0aGUgZmlyc3QKCQkJaWYgKCAhKCBldmVudHMgPSBlbGVtRGF0YS5ldmVudHMgKSApIHsKCQkJCWV2ZW50cyA9IGVsZW1EYXRhLmV2ZW50cyA9IHt9OwoJCQl9CgkJCWlmICggISggZXZlbnRIYW5kbGUgPSBlbGVtRGF0YS5oYW5kbGUgKSApIHsKCQkJCWV2ZW50SGFuZGxlID0gZWxlbURhdGEuaGFuZGxlID0gZnVuY3Rpb24oIGUgKSB7CgoJCQkJCS8vIERpc2NhcmQgdGhlIHNlY29uZCBldmVudCBvZiBhIGpRdWVyeS5ldmVudC50cmlnZ2VyKCkgYW5kCgkJCQkJLy8gd2hlbiBhbiBldmVudCBpcyBjYWxsZWQgYWZ0ZXIgYSBwYWdlIGhhcyB1bmxvYWRlZAoJCQkJCXJldHVybiB0eXBlb2YgalF1ZXJ5ICE9PSAidW5kZWZpbmVkIiAmJgoJCQkJCQkoICFlIHx8IGpRdWVyeS5ldmVudC50cmlnZ2VyZWQgIT09IGUudHlwZSApID8KCQkJCQkJalF1ZXJ5LmV2ZW50LmRpc3BhdGNoLmFwcGx5KCBldmVudEhhbmRsZS5lbGVtLCBhcmd1bWVudHMgKSA6CgkJCQkJCXVuZGVmaW5lZDsKCQkJCX07CgoJCQkJLy8gQWRkIGVsZW0gYXMgYSBwcm9wZXJ0eSBvZiB0aGUgaGFuZGxlIGZuIHRvIHByZXZlbnQgYSBtZW1vcnkgbGVhawoJCQkJLy8gd2l0aCBJRSBub24tbmF0aXZlIGV2ZW50cwoJCQkJZXZlbnRIYW5kbGUuZWxlbSA9IGVsZW07CgkJCX0KCgkJCS8vIEhhbmRsZSBtdWx0aXBsZSBldmVudHMgc2VwYXJhdGVkIGJ5IGEgc3BhY2UKCQkJdHlwZXMgPSAoIHR5cGVzIHx8ICIiICkubWF0Y2goIHJub3R3aGl0ZSApIHx8IFsgIiIgXTsKCQkJdCA9IHR5cGVzLmxlbmd0aDsKCQkJd2hpbGUgKCB0LS0gKSB7CgkJCQl0bXAgPSBydHlwZW5hbWVzcGFjZS5leGVjKCB0eXBlc1sgdCBdICkgfHwgW107CgkJCQl0eXBlID0gb3JpZ1R5cGUgPSB0bXBbIDEgXTsKCQkJCW5hbWVzcGFjZXMgPSAoIHRtcFsgMiBdIHx8ICIiICkuc3BsaXQoICIuIiApLnNvcnQoKTsKCgkJCQkvLyBUaGVyZSAqbXVzdCogYmUgYSB0eXBlLCBubyBhdHRhY2hpbmcgbmFtZXNwYWNlLW9ubHkgaGFuZGxlcnMKCQkJCWlmICggIXR5cGUgKSB7CgkJCQkJY29udGludWU7CgkJCQl9CgoJCQkJLy8gSWYgZXZlbnQgY2hhbmdlcyBpdHMgdHlwZSwgdXNlIHRoZSBzcGVjaWFsIGV2ZW50IGhhbmRsZXJzIGZvciB0aGUgY2hhbmdlZCB0eXBlCgkJCQlzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbIHR5cGUgXSB8fCB7fTsKCgkJCQkvLyBJZiBzZWxlY3RvciBkZWZpbmVkLCBkZXRlcm1pbmUgc3BlY2lhbCBldmVudCBhcGkgdHlwZSwgb3RoZXJ3aXNlIA==", "base64"));
  res.write(new Buffer("Z2l2ZW4gdHlwZQoJCQkJdHlwZSA9ICggc2VsZWN0b3IgPyBzcGVjaWFsLmRlbGVnYXRlVHlwZSA6IHNwZWNpYWwuYmluZFR5cGUgKSB8fCB0eXBlOwoKCQkJCS8vIFVwZGF0ZSBzcGVjaWFsIGJhc2VkIG9uIG5ld2x5IHJlc2V0IHR5cGUKCQkJCXNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFsgdHlwZSBdIHx8IHt9OwoKCQkJCS8vIGhhbmRsZU9iaiBpcyBwYXNzZWQgdG8gYWxsIGV2ZW50IGhhbmRsZXJzCgkJCQloYW5kbGVPYmogPSBqUXVlcnkuZXh0ZW5kKCB7CgkJCQkJdHlwZTogdHlwZSwKCQkJCQlvcmlnVHlwZTogb3JpZ1R5cGUsCgkJCQkJZGF0YTogZGF0YSwKCQkJCQloYW5kbGVyOiBoYW5kbGVyLAoJCQkJCWd1aWQ6IGhhbmRsZXIuZ3VpZCwKCQkJCQlzZWxlY3Rvcjogc2VsZWN0b3IsCgkJCQkJbmVlZHNDb250ZXh0OiBzZWxlY3RvciAmJiBqUXVlcnkuZXhwci5tYXRjaC5uZWVkc0NvbnRleHQudGVzdCggc2VsZWN0b3IgKSwKCQkJCQluYW1lc3BhY2U6IG5hbWVzcGFjZXMuam9pbiggIi4iICkKCQkJCX0sIGhhbmRsZU9iakluICk7CgoJCQkJLy8gSW5pdCB0aGUgZXZlbnQgaGFuZGxlciBxdWV1ZSBpZiB3ZSdyZSB0aGUgZmlyc3QKCQkJCWlmICggISggaGFuZGxlcnMgPSBldmVudHNbIHR5cGUgXSApICkgewoJCQkJCWhhbmRsZXJzID0gZXZlbnRzWyB0eXBlIF0gPSBbXTsKCQkJCQloYW5kbGVycy5kZWxlZ2F0ZUNvdW50ID0gMDsKCgkJCQkJLy8gT25seSB1c2UgYWRkRXZlbnRMaXN0ZW5lci9hdHRhY2hFdmVudCBpZiB0aGUgc3BlY2lhbCBldmVudHMgaGFuZGxlciByZXR1cm5zIGZhbHNlCgkJCQkJaWYgKCAhc3BlY2lhbC5zZXR1cCB8fAoJCQkJCQlzcGVjaWFsLnNldHVwLmNhbGwoIGVsZW0sIGRhdGEsIG5hbWVzcGFjZXMsIGV2ZW50SGFuZGxlICkgPT09IGZhbHNlICkgewoKCQkJCQkJLy8gQmluZCB0aGUgZ2xvYmFsIGV2ZW50IGhhbmRsZXIgdG8gdGhlIGVsZW1lbnQKCQkJCQkJaWYgKCBlbGVtLmFkZEV2ZW50TGlzdGVuZXIgKSB7CgkJCQkJCQllbGVtLmFkZEV2ZW50TGlzdGVuZXIoIHR5cGUsIGV2ZW50SGFuZGxlLCBmYWxzZSApOwoKCQkJCQkJfSBlbHNlIGlmICggZWxlbS5hdHRhY2hFdmVudCApIHsKCQkJCQkJCWVsZW0uYXR0YWNoRXZlbnQoICJvbiIgKyB0eXBlLCBldmVudEhhbmRsZSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCWlmICggc3BlY2lhbC5hZGQgKSB7CgkJCQkJc3BlY2lhbC5hZGQuY2FsbCggZWxlbSwgaGFuZGxlT2JqICk7CgoJCQkJCWlmICggIWhhbmRsZU9iai5oYW5kbGVyLmd1aWQgKSB7CgkJCQkJCWhhbmRsZU9iai5oYW5kbGVyLmd1aWQgPSBoYW5kbGVyLmd1aWQ7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIEFkZCB0byB0aGUgZWxlbWVudCdzIGhhbmRsZXIgbGlzdCwgZGVsZWdhdGVzIGluIGZyb250CgkJCQlpZiAoIHNlbGVjdG9yICkgewoJCQkJCWhhbmRsZXJzLnNwbGljZSggaGFuZGxlcnMuZGVsZWdhdGVDb3VudCsrLCAwLCBoYW5kbGVPYmogKTsKCQkJCX0gZWxzZSB7CgkJCQkJaGFuZGxlcnMucHVzaCggaGFuZGxlT2JqICk7CgkJCQl9CgoJCQkJLy8gS2VlcCB0cmFjayBvZiB3aGljaCBldmVudHMgaGF2ZSBldmVyIGJlZW4gdXNlZCwgZm9yIGV2ZW50IG9wdGltaXphdGlvbgoJCQkJalF1ZXJ5LmV2ZW50Lmdsb2JhbFsgdHlwZSBdID0gdHJ1ZTsKCQkJfQoKCQkJLy8gTnVsbGlmeSBlbGVtIHRvIHByZXZlbnQgbWVtb3J5IGxlYWtzIGluIElFCgkJCWVsZW0gPSBudWxsOwoJCX0sCgoJCS8vIERldGFjaCBhbiBldmVudCBvciBzZXQgb2YgZXZlbnRzIGZyb20gYW4gZWxlbWVudAoJCXJlbW92ZTogZnVuY3Rpb24oIGVsZW0sIHR5cGVzLCBoYW5kbGVyLCBzZWxlY3RvciwgbWFwcGVkVHlwZXMgKSB7CgkJCXZhciBqLCBoYW5kbGVPYmosIHRtcCwKCQkJCW9yaWdDb3VudCwgdCwgZXZlbnRzLAoJCQkJc3BlY2lhbCwgaGFuZGxlcnMsIHR5cGUsCgkJCQluYW1lc3BhY2VzLCBvcmlnVHlwZSwKCQkJCWVsZW1EYXRhID0galF1ZXJ5Lmhhc0RhdGEoIGVsZW0gKSAmJiBqUXVlcnkuX2RhdGEoIGVsZW0gKTsKCgkJCWlmICggIWVsZW1EYXRhIHx8ICEoIGV2ZW50cyA9IGVsZW1EYXRhLmV2ZW50cyApICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBPbmNlIGZvciBlYWNoIHR5cGUubmFtZXNwYWNlIGluIHR5cGVzOyB0eXBlIG1heSBiZSBvbWl0dGVkCgkJCXR5cGVzID0gKCB0eXBlcyB8fCAiIiApLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbICIiIF07CgkJCXQgPSB0eXBlcy5sZW5ndGg7CgkJCXdoaWxlICggdC0tICkgewoJCQkJdG1wID0gcnR5cGVuYW1lc3BhY2UuZXhlYyggdHlwZXNbIHQgXSApIHx8IFtdOwoJCQkJdHlwZSA9IG9yaWdUeXBlID0gdG1wWyAxIF07CgkJCQluYW1lc3BhY2VzID0gKCB0bXBbIDIgXSB8fCAiIiApLnNwbGl0KCAiLiIgKS5zb3J0KCk7CgoJCQkJLy8gVW5iaW5kIGFsbCBldmVudHMgKG9uIHRoaXMgbmFtZXNwYWNlLCBpZiBwcm92aWRlZCkgZm9yIHRoZSBlbGVtZW50CgkJCQlpZiAoICF0eXBlICkgewoJCQkJCWZvciAoIHR5cGUgaW4gZXZlbnRzICkgewoJCQkJCQlqUXVlcnkuZXZlbnQucmVtb3ZlKCBlbGVtLCB0eXBlICsgdHlwZXNbIHQgXSwgaGFuZGxlciwgc2VsZWN0b3IsIHRydWUgKTsKCQkJCQl9CgkJCQkJY29udGludWU7CgkJCQl9CgoJCQkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307CgkJCQl0eXBlID0gKCBzZWxlY3RvciA/IHNwZWNpYWwuZGVsZWdhdGVUeXBlIDogc3BlY2lhbC5iaW5kVHlwZSApIHx8IHR5cGU7CgkJCQloYW5kbGVycyA9IGV2ZW50c1sgdHlwZSBdIHx8IFtdOwoJCQkJdG1wID0gdG1wWyAyIF0gJiYKCQkJCQluZXcgUmVnRXhwKCAiKF58XFwuKSIgKyBuYW1lc3BhY2VzLmpvaW4oICJcXC4oPzouKlxcLnwpIiApICsgIihcXC58JCkiICk7CgoJCQkJLy8gUmVtb3ZlIG1hdGNoaW5nIGV2ZW50cwoJCQkJb3JpZ0NvdW50ID0gaiA9IGhhbmRsZXJzLmxlbmd0aDsKCQkJCXdoaWxlICggai0tICkgewoJCQkJCWhhbmRsZU9iaiA9IGhhbmRsZXJzWyBqIF07CgoJCQkJCWlmICggKCBtYXBwZWRUeXBlcyB8fCBvcmlnVHlwZSA9PT0gaGFuZGxlT2JqLm9yaWdUeXBlICkgJiYKCQkJCQkJKCAhaGFuZGxlciB8fCBoYW5kbGVyLmd1aWQgPT09IGhhbmRsZU9iai5ndWlkICkgJiYKCQkJCQkJKCAhdG1wIHx8IHRtcC50ZXN0KCBoYW5kbGVPYmoubmFtZXNwYWNlICkgKSAmJgoJCQkJCQkoICFzZWxlY3RvciB8fCBzZWxlY3RvciA9PT0gaGFuZGxlT2JqLnNlbGVjdG9yIHx8CgkJCQkJCQlzZWxlY3RvciA9PT0gIioqIiAmJiBoYW5kbGVPYmouc2VsZWN0b3IgKSApIHsKCQkJCQkJaGFuZGxlcnMuc3BsaWNlKCBqLCAxICk7CgoJCQkJCQlpZiAoIGhhbmRsZU9iai5zZWxlY3RvciApIHsKCQkJCQkJCWhhbmRsZXJzLmRlbGVnYXRlQ291bnQtLTsKCQkJCQkJfQoJCQkJCQlpZiAoIHNwZWNpYWwucmVtb3ZlICkgewoJCQkJCQkJc3BlY2lhbC5yZW1vdmUuY2FsbCggZWxlbSwgaGFuZGxlT2JqICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJLy8gUmVtb3ZlIGdlbmVyaWMgZXZlbnQgaGFuZGxlciBpZiB3ZSByZW1vdmVkIHNvbWV0aGluZyBhbmQgbm8gbW9yZSBoYW5kbGVycyBleGlzdAoJCQkJLy8gKGF2b2lkcyBwb3RlbnRpYWwgZm9yIGVuZGxlc3MgcmVjdXJzaW9uIGR1cmluZyByZW1vdmFsIG9mIHNwZWNpYWwgZXZlbnQgaGFuZGxlcnMpCgkJCQlpZiAoIG9yaWdDb3VudCAmJiAhaGFuZGxlcnMubGVuZ3RoICkgewoJCQkJCWlmICggIXNwZWNpYWwudGVhcmRvd24gfHwKCQkJCQkJc3BlY2lhbC50ZWFyZG93bi5jYWxsKCBlbGVtLCBuYW1lc3BhY2VzLCBlbGVtRGF0YS5oYW5kbGUgKSA9PT0gZmFsc2UgKSB7CgoJCQkJCQlqUXVlcnkucmVtb3ZlRXZlbnQoIGVsZW0sIHR5cGUsIGVsZW1EYXRhLmhhbmRsZSApOwoJCQkJCX0KCgkJCQkJZGVsZXRlIGV2ZW50c1sgdHlwZSBdOwoJCQkJfQoJCQl9CgoJCQkvLyBSZW1vdmUgdGhlIGV4cGFuZG8gaWYgaXQncyBubyBsb25nZXIgdXNlZAoJCQlpZiAoIGpRdWVyeS5pc0VtcHR5T2JqZWN0KCBldmVudHMgKSApIHsKCQkJCWRlbGV0ZSBlbGVtRGF0YS5oYW5kbGU7CgoJCQkJLy8gcmVtb3ZlRGF0YSBhbHNvIGNoZWNrcyBmb3IgZW1wdGluZXNzIGFuZCBjbGVhcnMgdGhlIGV4cGFuZG8gaWYgZW1wdHkKCQkJCS8vIHNvIHVzZSBpdCBpbnN0ZWFkIG9mIGRlbGV0ZQoJCQkJalF1ZXJ5Ll9yZW1vdmVEYXRhKCBlbGVtLCAiZXZlbnRzIiApOwoJCQl9CgkJfSwKCgkJdHJpZ2dlcjogZnVuY3Rpb24oIGV2ZW50LCBkYXRhLCBlbGVtLCBvbmx5SGFuZGxlcnMgKSB7CgkJCXZhciBoYW5kbGUsIG9udHlwZSwgY3VyLAoJCQkJYnViYmxlVHlwZSwgc3BlY2lhbCwgdG1wLCBpLAoJCQkJZXZlbnRQYXRoID0gWyBlbGVtIHx8IGRvY3VtZW50IF0sCgkJCQl0eXBlID0gaGFzT3duLmNhbGwoIGV2ZW50LCAidHlwZSIgKSA/IGV2ZW50LnR5cGUgOiBldmVudCwKCQkJCW5hbWVzcGFjZXMgPSBoYXNPd24uY2FsbCggZXZlbnQsICJuYW1lc3BhY2UiICkgPyBldmVudC5uYW1lc3BhY2Uuc3BsaXQoICIuIiApIDogW107CgoJCQljdXIgPSB0bXAgPSBlbGVtID0gZWxlbSB8fCBkb2N1bWVudDsKCgkJCS8vIERvbid0IGRvIGV2ZW50cyBvbiB0ZXh0IGFuZCBjb21tZW50IG5vZGVzCgkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMyB8fCBlbGVtLm5vZGVUeXBlID09PSA4ICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBmb2N1cy9ibHVyIG1vcnBocyB0byBmb2N1c2luL291dDsgZW5zdXJlIHdlJ3JlIG5vdCBmaXJpbmcgdGhlbSByaWdodCBub3cKCQkJaWYgKCByZm9jdXNNb3JwaC50ZXN0KCB0eXBlICsgalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCApICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQlpZiAoIHR5cGUuaW5kZXhPZiggIi4iICkgPiAtMSApIHsKCgkJCQkvLyBOYW1lc3BhY2VkIHRyaWdnZXI7IGNyZWF0ZSBhIHJlZ2V4cCB0byBtYXRjaCBldmVudCB0eXBlIGluIGhhbmRsZSgpCgkJCQluYW1lc3BhY2VzID0gdHlwZS5zcGxpdCggIi4iICk7CgkJCQl0eXBlID0gbmFtZXNwYWNlcy5zaGlmdCgpOwoJCQkJbmFtZXNwYWNlcy5zb3J0KCk7CgkJCX0KCQkJb250eXBlID0gdHlwZS5pbmRleE9mKCAiOiIgKSA8IDAgJiYgIm9uIiArIHR5cGU7CgoJCQkvLyBDYWxsZXIgY2FuIHBhc3MgaW4gYSBqUXVlcnkuRXZlbnQgb2JqZWN0LCBPYmplY3QsIG9yIGp1c3QgYW4gZXZlbnQgdHlwZSBzdHJpbmcKCQkJZXZlbnQgPSBldmVudFsgalF1ZXJ5LmV4cGFuZG8gXSA/CgkJCQlldmVudCA6CgkJCQluZXcgalF1ZXJ5LkV2ZW50KCB0eXBlLCB0eXBlb2YgZXZlbnQgPT09ICJvYmplY3QiICYmIGV2ZW50ICk7CgoJCQkvLyBUcmlnZ2VyIGJpdG1hc2s6ICYgMSBmb3IgbmF0aXZlIGhhbmRsZXJzOyAmIDIgZm9yIGpRdWVyeSAoYWx3YXlzIHRydWUpCgkJCWV2ZW50LmlzVHJpZ2dlciA9IG9ubHlIYW5kbGVycyA/IDIgOiAzOwoJCQlldmVudC5uYW1lc3BhY2UgPSBuYW1lc3BhY2VzLmpvaW4oICIuIiApOwoJCQlldmVudC5ybmFtZXNwYWNlID0gZXZlbnQubmFtZXNwYWNlID8KCQkJCW5ldyBSZWdFeHAoICIoXnxcXC4pIiArIG5hbWVzcGFjZXMuam9pbiggIlxcLig/Oi4qXFwufCkiICkgKyAiKFxcLnwkKSIgKSA6CgkJCQludWxsOwoKCQkJLy8gQ2xlYW4gdXAgdGhlIGV2ZW50IGluIGNhc2UgaXQgaXMgYmVpbmcgcmV1c2VkCgkJCWV2ZW50LnJlc3VsdCA9IHVuZGVmaW5lZDsKCQkJaWYgKCAhZXZlbnQudGFyZ2V0ICkgewoJCQkJZXZlbnQudGFyZ2V0ID0gZWxlbTsKCQkJfQoKCQkJLy8gQ2xvbmUgYW55IGluY29taW5nIGRhdGEgYW5kIHByZXBlbmQgdGhlIGV2ZW50LCBjcmVhdGluZyB0aGUgaGFuZGxlciBhcmcgbGlzdAoJCQlkYXRhID0gZGF0YSA9PSBudWxsID8KCQkJCVsgZXZlbnQgXSA6CgkJCQlqUXVlcnkubWFrZUFycmF5KCBkYXRhLCBbIGV2ZW50IF0gKTsKCgkJCS8vIEFsbG93IHNwZWNpYWwgZXZlbnRzIHRvIGRyYXcgb3V0c2lkZSB0aGUgbGluZXMKCQkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307CgkJCWlmICggIW9ubHlIYW5kbGVycyAmJiBzcGVjaWFsLnRyaWdnZXIgJiYgc3BlY2lhbC50cmlnZ2VyLmFwcGx5KCBlbGVtLCBkYXRhICkgPT09IGZhbHNlICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBEZXRlcm1pbmUgZXZlbnQgcHJvcGFnYXRpb24gcGF0aCBpbiBhZHZhbmNlLCBwZXIgVzNDIGV2ZW50cyBzcGVjICgjOTk1MSkKCQkJLy8gQnViYmxlIHVwIHRvIGRvY3VtZW50LCB0aGVuIHRvIHdpbmRvdzsgd2F0Y2ggZm9yIGEgZ2xvYmFsIG93bmVyRG9jdW1lbnQgdmFyICgjOTcyNCkKCQkJaWYgKCAhb25seUhhbmRsZXJzICYmICFzcGVjaWFsLm5vQnViYmxlICYmICFqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSApIHsKCgkJCQlidWJibGVUeXBlID0gc3BlY2lhbC5kZWxlZ2F0ZVR5cGUgfHwgdHlwZTsKCQkJCWlmICggIXJmb2N1c01vcnBoLnRlc3QoIGJ1YmJsZVR5cGUgKyB0eXBlICkgKSB7CgkJCQkJY3VyID0gY3VyLnBhcmVudE5vZGU7CgkJCQl9CgkJCQlmb3IgKCA7IGN1cjsgY3VyID0gY3VyLnBhcmVudE5vZGUgKSB7CgkJCQkJZXZlbnRQYXRoLnB1c2goIGN1ciApOwoJCQkJCXRtcCA9IGN1cjsKCQkJCX0KCgkJCQkvLyBPbmx5IGFkZCB3aW5kb3cgaWYgd2UgZ290IHRvIGRvY3VtZW50IChlLmcuLCBub3QgcGxhaW4gb2JqIG9yIGRldGFjaGVkIERPTSkKCQkJCWlmICggdG1wID09PSAoIGVsZW0ub3duZXJEb2N1bWVudCB8fCBkb2N1bWVudCApICkgewoJCQkJCWV2ZW50UGF0aC5wdXNoKCB0bXAuZGVmYXVsdFZpZXcgfHwgdG1wLnBhcmVudFdpbmRvdyB8fCB3aW5kb3cgKTsKCQkJCX0KCQkJfQoKCQkJLy8gRmlyZSBoYW5kbGVycyBvbiB0aGUgZXZlbnQgcGF0aAoJCQlpID0gMDsKCQkJd2hpbGUgKCAoIGN1ciA9IGV2ZW50UGF0aFsgaSsrIF0gKSAmJiAhZXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSApIHsKCgkJCQlldmVudC50eXBlID0gaSA+IDEgPwoJCQkJCWJ1YmJsZVR5cGUgOgoJCQkJCXNwZWNpYWwuYmluZFR5cGUgfHwgdHlwZTsKCgkJCQkvLyBqUXVlcnkgaGFuZGxlcgoJCQkJaGFuZGxlID0gKCBqUXVlcnkuX2RhdGEoIGN1ciwgImV2ZW50cyIgKSB8fCB7fSApWyBldmVudC50eXBlIF0gJiYKCQkJCQlqUXVlcnkuX2RhdGEoIGN1ciwgImhhbmRsZSIgKTsKCgkJCQlpZiAoIGhhbmRsZSApIHsKCQkJCQloYW5kbGUuYXBwbHkoIGN1ciwgZGF0YSApOwoJCQkJfQoKCQkJCS8vIE5hdGl2ZSBoYW5kbGVyCgkJCQloYW5kbGUgPSBvbnR5cGUgJiYgY3VyWyBvbnR5cGUgXTsKCQkJCWlmICggaGFuZGxlICYmIGhhbmRsZS5hcHBseSAmJiBhY2NlcHREYXRhKCBjdXIgKSApIHsKCQkJCQlldmVudC5yZXN1bHQgPSBoYW5kbGUuYXBwbHkoIGN1ciwgZGF0YSApOwoJCQkJCWlmICggZXZlbnQucmVzdWx0ID09PSBmYWxzZSApIHsKCQkJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJZXZlbnQudHlwZSA9IHR5cGU7CgoJCQkvLyBJZiBub2JvZHkgcHJldmVudGVkIHRoZSBkZWZhdWx0IGFjdGlvbiwgZG8gaXQgbm93CgkJCWlmICggIW9ubHlIYW5kbGVycyAmJiAhZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkgKSB7CgoJCQkJaWYgKAoJCQkJCSggIXNwZWNpYWwuX2RlZmF1bHQgfHwKCQkJCQkgc3BlY2lhbC5fZGVmYXVsdC5hcHBseSggZXZlbnRQYXRoLnBvcCgpLCBkYXRhICkgPT09IGZhbHNlCgkJCQkJKSAmJiBhY2NlcHREYXRhKCBlbGVtICkKCQkJCSkgewoKCQkJCQkvLyBDYWxsIGEgbmF0aXZlIERPTSBtZXRob2Qgb24gdGhlIHRhcmdldCB3aXRoIHRoZSBzYW1lIG5hbWUgbmFtZSBhcyB0aGUgZXZlbnQuCgkJCQkJLy8gQ2FuJ3QgdXNlIGFuIC5pc0Z1bmN0aW9uKCkgY2hlY2sgaGVyZSBiZWNhdXNlIElFNi83IGZhaWxzIHRoYXQgdGVzdC4KCQkJCQkvLyBEb24ndCBkbyBkZWZhdWx0IGFjdGlvbnMgb24gd2luZG93LCB0aGF0J3Mgd2hlcmUgZ2xvYmFsIHZhcmlhYmxlcyBiZSAoIzYxNzApCgkJCQkJaWYgKCBvbnR5cGUgJiYgZWxlbVsgdHlwZSBdICYmICFqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSApIHsKCgkJCQkJCS8vIERvbid0IHJlLXRyaWdnZXIgYW4gb25GT08gZXZlbnQgd2hlbiB3ZSBjYWxsIGl0cyBGT08oKSBtZXRob2QKCQkJCQkJdG1wID0gZWxlbVsgb250eXBlIF07CgoJCQkJCQlpZiAoIHRtcCApIHsKCQkJCQkJCWVsZW1bIG9udHlwZSBdID0gbnVsbDsKCQkJCQkJfQoKCQkJCQkJLy8gUHJldmVudCByZS10cmlnZ2VyaW5nIG9mIHRoZSBzYW1lIGV2ZW50LCBzaW5jZSB3ZSBhbHJlYWR5IGJ1YmJsZWQgaXQgYWJvdmUKCQkJCQkJalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCA9IHR5cGU7CgkJCQkJCXRyeSB7CgkJCQkJCQllbGVtWyB0eXBlIF0oKTsKCQkJCQkJfSBjYXRjaCAoIGUgKSB7CgoJCQkJCQkJLy8gSUU8OSBkaWVzIG9uIGZvY3VzL2JsdXIgdG8gaGlkZGVuIGVsZW1lbnQgKCMxNDg2LCMxMjUxOCkKCQkJCQkJCS8vIG9ubHkgcmVwcm9kdWNpYmxlIG9uIHdpblhQIElFOCBuYXRpdmUsIG5vdCBJRTkgaW4gSUU4IG1vZGUKCQkJCQkJfQoJCQkJCQlqUXVlcnkuZXZlbnQudHJpZ2dlcmVkID0gdW5kZWZpbmVkOwoKCQkJCQkJaWYgKCB0bXAgKSB7CgkJCQkJCQllbGVtWyBvbnR5cGUgXSA9IHRtcDsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIGV2ZW50LnJlc3VsdDsKCQl9LAoKCQlkaXNwYXRjaDogZnVuY3Rpb24oIGV2ZW50ICkgewoKCQkJLy8gTWFrZSBhIHdyaXRhYmxlIGpRdWVyeS5FdmVudCBmcm9tIHRoZSBuYXRpdmUgZXZlbnQgb2JqZWN0CgkJCWV2ZW50ID0galF1ZXJ5LmV2ZW50LmZpeCggZXZlbnQgKTsKCgkJCXZhciBpLCBqLCByZXQsIG1hdGNoZWQsIGhhbmRsZU9iaiwKCQkJCWhhbmRsZXJRdWV1ZSA9IFtdLAoJCQkJYXJncyA9IHNsaWNlLmNhbGwoIGFyZ3VtZW50cyApLAoJCQkJaGFuZGxlcnMgPSAoIGpRdWVyeS5fZGF0YSggdGhpcywgImV2ZW50cyIgKSB8fCB7fSApWyBldmVudC50eXBlIF0gfHwgW10sCgkJCQlzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbIGV2ZW50LnR5cGUgXSB8fCB7fTsKCgkJCS8vIFVzZSB0aGUgZml4LWVkIGpRdWVyeS5FdmVudCByYXRoZXIgdGhhbiB0aGUgKHJlYWQtb25seSkgbmF0aXZlIGV2ZW50CgkJCWFyZ3NbIDAgXSA9IGV2ZW50OwoJCQlldmVudC5kZWxlZ2F0ZVRhcmdldCA9IHRoaXM7CgoJCQkvLyBDYWxsIHRoZSBwcmVEaXNwYXRjaCBob29rIGZvciB0aGUgbWFwcGVkIHR5cGUsIGFuZCBsZXQgaXQgYmFpbCBpZiBkZXNpcmVkCgkJCWlmICggc3BlY2lhbC5wcmVEaXNwYXRjaCAmJiBzcGVjaWFsLnByZURpc3BhdGNoLmNhbGwoIHRoaXMsIGV2ZW50ICkgPT09IGZhbHNlICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBEZXRlcm1pbmUgaGFuZGxlcnMKCQkJaGFuZGxlclF1ZXVlID0galF1ZXJ5LmV2ZW50LmhhbmRsZXJzLmNhbGwoIHRoaXMsIGV2ZW50LCBoYW5kbGVycyApOwoKCQkJLy8gUnVuIGRlbGVnYXRlcyBmaXJzdDsgdGhleSBtYXkgd2FudCB0byBzdG9wIHByb3BhZ2F0aW9uIGJlbmVhdGggdXMKCQkJaSA9IDA7CgkJCXdoaWxlICggKCBtYXRjaGVkID0gaGFuZGxlclF1ZXVlWyBpKysgXSApICYmICFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpICkgewoJCQkJZXZlbnQuY3VycmVudFRhcmdldCA9IG1hdGNoZWQuZWxlbTsKCgkJCQlqID0gMDsKCQkJCXdoaWxlICggKCBoYW5kbGVPYmogPSBtYXRjaGVkLmhhbmRsZXJzWyBqKysgXSApICYmCgkJCQkJIWV2ZW50LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkgKSB7CgoJCQkJCS8vIFRyaWdnZXJlZCBldmVudCBtdXN0IGVpdGhlciAxKSBoYXZlIG5vIG5hbWVzcGFjZSwgb3IgMikgaGF2ZSBuYW1lc3BhY2UocykKCQkJCQkvLyBhIHN1YnNldCBvciBlcXVhbCB0byB0aG9zZSBpbiB0aGUgYm91bmQgZXZlbnQgKGJvdGggY2FuIGhhdmUgbm8gbmFtZXNwYWNlKS4KCQkJCQlpZiAoICFldmVudC5ybmFtZXNwYWNlIHx8IGV2ZW50LnJuYW1lc3BhY2UudGVzdCggaGFuZGxlT2JqLm5hbWVzcGFjZSApICkgewoKCQkJCQkJZXZlbnQuaGFuZGxlT2JqID0gaGFuZGxlT2JqOwoJCQkJCQlldmVudC5kYXRhID0gaGFuZGxlT2JqLmRhdGE7CgoJCQkJCQlyZXQgPSAoICggalF1ZXJ5LmV2ZW50LnNwZWNpYWxbIGhhbmRsZU9iai5vcmlnVHlwZSBdIHx8IHt9ICkuaGFuZGxlIHx8CgkJCQkJCQloYW5kbGVPYmouaGFuZGxlciApLmFwcGx5KCBtYXRjaGVkLmVsZW0sIGFyZ3MgKTsKCgkJCQkJCWlmICggcmV0ICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJCQlpZiAoICggZXZlbnQucmVzdWx0ID0gcmV0ICkgPT09IGZhbHNlICkgewoJCQkJCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgkJCQkJCQkJZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCgkJCS8vIENhbGwgdGhlIHBvc3REaXNwYXRjaCBob29rIGZvciB0aGUgbWFwcGVkIHR5cGUKCQkJaWYgKCBzcGVjaWFsLnBvc3REaXNwYXRjaCApIHsKCQkJCXNwZWNpYWwucG9zdERpc3BhdGNoLmNhbGwoIHRoaXMsIGV2ZW50ICk7CgkJCX0KCgkJCXJldHVybiBldmVudC5yZXN1bHQ7CgkJfSwKCgkJaGFuZGxlcnM6IGZ1bmN0aW9uKCBldmVudCwgaGFuZGxlcnMgKSB7CgkJCXZhciBpLCBtYXRjaGVzLCBzZWwsIGhhbmRsZU9iaiwKCQkJCWhhbmRsZXJRdWV1ZSA9IFtdLAoJCQkJZGVsZWdhdGVDb3VudCA9IGhhbmRsZXJzLmRlbGVnYXRlQ291bnQsCgkJCQljdXIgPSBldmVudC50YXJnZXQ7CgoJCQkvLyBTdXBwb3J0IChhdCBsZWFzdCk6IENocm9tZSwgSUU5CgkJCS8vIEZpbmQgZGVsZWdhdGUgaGFuZGxlcnMKCQkJLy8gQmxhY2staG9sZSBTVkcgPHVzZT4gaW5zdGFuY2UgdHJlZXMgKCMxMzE4MCkKCQkJLy8KCQkJLy8gU3VwcG9ydDogRmlyZWZveDw9NDIrCgkJCS8vIEF2b2lkIG5vbi1sZWZ0LWNsaWNrIGluIEZGIGJ1dCBkb24ndCBibG9jayBJRSByYWRpbyBldmVudHMgKCMzODYxLCBnaC0yMzQzKQoJCQlpZiAoIGRlbGVnYXRlQ291bnQgJiYgY3VyLm5vZGVUeXBlICYmCgkJCQkoIGV2ZW50LnR5cGUgIT09ICJjbGljayIgfHwgaXNOYU4oIGV2ZW50LmJ1dHRvbiApIHx8IGV2ZW50LmJ1dHRvbiA8IDEgKSApIHsKCgkJCQkvKiBqc2hpbnQgZXFlcWVxOiBmYWxzZSAqLwoJCQkJZm9yICggOyBjdXIgIT0gdGhpczsgY3VyID0gY3VyLnBhcmVudE5vZGUgfHwgdGhpcyApIHsKCQkJCQkvKiBqc2hpbnQgZXFlcWVxOiB0cnVlICovCgoJCQkJCS8vIERvbid0IGNoZWNrIG5vbi1lbGVtZW50cyAoIzEzMjA4KQoJCQkJCS8vIERvbid0IHByb2Nlc3MgY2xpY2tzIG9uIGRpc2FibGVkIGVsZW1lbnRzICgjNjkxMSwgIzgxNjUsICMxMTM4MiwgIzExNzY0KQoJCQkJCWlmICggY3VyLm5vZGVUeXBlID09PSAxICYmICggY3VyLmRpc2FibGVkICE9PSB0cnVlIHx8IGV2ZW50LnR5cGUgIT09ICJjbGljayIgKSApIHsKCQkJCQkJbWF0Y2hlcyA9IFtdOwoJCQkJCQlmb3IgKCBpID0gMDsgaSA8IGRlbGVnYXRlQ291bnQ7IGkrKyApIHsKCQkJCQkJCWhhbmRsZU9iaiA9IGhhbmRsZXJzWyBpIF07CgoJCQkJCQkJLy8gRG9uJ3QgY29uZmxpY3Qgd2l0aCBPYmplY3QucHJvdG90eXBlIHByb3BlcnRpZXMgKCMxMzIwMykKCQkJCQkJCXNlbCA9IGhhbmRsZU9iai5zZWxlY3RvciArICIgIjsKCgkJCQkJCQlpZiAoIG1hdGNoZXNbIHNlbCBdID09PSB1bmRlZmluZWQgKSB7CgkJCQkJCQkJbWF0Y2hlc1sgc2VsIF0gPSBoYW5kbGVPYmoubmVlZHNDb250ZXh0ID8KCQkJCQkJCQkJalF1ZXJ5KCBzZWwsIHRoaXMgKS5pbmRleCggY3VyICkgPiAtMSA6CgkJCQkJCQkJCWpRdWVyeS5maW5kKCBzZWwsIHRoaXMsIG51bGwsIFsgY3VyIF0gKS5sZW5ndGg7CgkJCQkJCQl9CgkJCQkJCQlpZiAoIG1hdGNoZXNbIHNlbCBdICkgewoJCQkJCQkJCW1hdGNoZXMucHVzaCggaGFuZGxlT2JqICk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJaWYgKCBtYXRjaGVzLmxlbmd0aCApIHsKCQkJCQkJCWhhbmRsZXJRdWV1ZS5wdXNoKCB7IGVsZW06IGN1ciwgaGFuZGxlcnM6IG1hdGNoZXMgfSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBBZGQgdGhlIHJlbWFpbmluZyAoZGlyZWN0bHktYm91bmQpIGhhbmRsZXJzCgkJCWlmICggZGVsZWdhdGVDb3VudCA8IGhhbmRsZXJzLmxlbmd0aCApIHsKCQkJCWhhbmRsZXJRdWV1ZS5wdXNoKCB7IGVsZW06IHRoaXMsIGhhbmRsZXJzOiBoYW5kbGVycy5zbGljZSggZGVsZWdhdGVDb3VudCApIH0gKTsKCQkJfQoKCQkJcmV0dXJuIGhhbmRsZXJRdWV1ZTsKCQl9LAoKCQlmaXg6IGZ1bmN0aW9uKCBldmVudCApIHsKCQkJaWYgKCBldmVudFsgalF1ZXJ5LmV4cGFuZG8gXSApIHsKCQkJCXJldHVybiBldmVudDsKCQkJfQoKCQkJLy8gQ3JlYXRlIGEgd3JpdGFibGUgY29weSBvZiB0aGUgZXZlbnQgb2JqZWN0IGFuZCBub3JtYWxpemUgc29tZSBwcm9wZXJ0aWVzCgkJCXZhciBpLCBwcm9wLCBjb3B5LAoJCQkJdHlwZSA9IGV2ZW50LnR5cGUsCgkJCQlvcmlnaW5hbEV2ZW50ID0gZXZlbnQsCgkJCQlmaXhIb29rID0gdGhpcy5maXhIb29rc1sgdHlwZSBdOwoKCQkJaWYgKCAhZml4SG9vayApIHsKCQkJCXRoaXMuZml4SG9va3NbIHR5cGUgXSA9IGZpeEhvb2sgPQoJCQkJCXJtb3VzZUV2ZW50LnRlc3QoIHR5cGUgKSA/IHRoaXMubW91c2VIb29rcyA6CgkJCQkJcmtleUV2ZW50LnRlc3QoIHR5cGUgKSA/IHRoaXMua2V5SG9va3MgOgoJCQkJCXt9OwoJCQl9CgkJCWNvcHkgPSBmaXhIb29rLnByb3BzID8gdGhpcy5wcm9wcy5jb25jYXQoIGZpeEhvb2sucHJvcHMgKSA6IHRoaXMucHJvcHM7CgoJCQlldmVudCA9IG5ldyBqUXVlcnkuRXZlbnQoIG9yaWdpbmFsRXZlbnQgKTsKCgkJCWkgPSBjb3B5Lmxlbmd0aDsKCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQlwcm9wID0gY29weVsgaSBdOwoJCQkJZXZlbnRbIHByb3AgXSA9IG9yaWdpbmFsRXZlbnRbIHByb3AgXTsKCQkJfQoKCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkvLyBGaXggdGFyZ2V0IHByb3BlcnR5ICgjMTkyNSkKCQkJaWYgKCAhZXZlbnQudGFyZ2V0ICkgewoJCQkJZXZlbnQudGFyZ2V0ID0gb3JpZ2luYWxFdmVudC5zcmNFbGVtZW50IHx8IGRvY3VtZW50OwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBTYWZhcmkgNi04KwoJCQkvLyBUYXJnZXQgc2hvdWxkIG5vdCBiZSBhIHRleHQgbm9kZSAoIzUwNCwgIzEzMTQzKQoJCQlpZiAoIGV2ZW50LnRhcmdldC5ub2RlVHlwZSA9PT0gMyApIHsKCQkJCWV2ZW50LnRhcmdldCA9IGV2ZW50LnRhcmdldC5wYXJlbnROb2RlOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCS8vIEZvciBtb3VzZS9rZXkgZXZlbnRzLCBtZXRhS2V5PT1mYWxzZSBpZiBpdCdzIHVuZGVmaW5lZCAoIzMzNjgsICMxMTMyOCkKCQkJZXZlbnQubWV0YUtleSA9ICEhZXZlbnQubWV0YUtleTsKCgkJCXJldHVybiBmaXhIb29rLmZpbHRlciA/IGZpeEhvb2suZmlsdGVyKCBldmVudCwgb3JpZ2luYWxFdmVudCApIDogZXZlbnQ7CgkJfSwKCgkJLy8gSW5jbHVkZXMgc29tZSBldmVudCBwcm9wcyBzaGFyZWQgYnkgS2V5RXZlbnQgYW5kIE1vdXNlRXZlbnQKCQlwcm9wczogKCAiYWx0S2V5IGJ1YmJsZXMgY2FuY2VsYWJsZSBjdHJsS2V5IGN1cnJlbnRUYXJnZXQgZGV0YWlsIGV2ZW50UGhhc2UgIiArCgkJCSJtZXRhS2V5IHJlbGF0ZWRUYXJnZXQgc2hpZnRLZXkgdGFyZ2V0IHRpbWVTdGFtcCB2aWV3IHdoaWNoIiApLnNwbGl0KCAiICIgKSwKCgkJZml4SG9va3M6IHt9LAoKCQlrZXlIb29rczogewoJCQlwcm9wczogImNoYXIgY2hhckNvZGUga2V5IGtleUNvZGUiLnNwbGl0KCAiICIgKSwKCQkJZmlsdGVyOiBmdW5jdGlvbiggZXZlbnQsIG9yaWdpbmFsICkgewoKCQkJCS8vIEFkZCB3aGljaCBmb3Iga2V5IGV2ZW50cwoJCQkJaWYgKCBldmVudC53aGljaCA9PSBudWxsICkgewoJCQkJCWV2ZW50LndoaWNoID0gb3JpZ2luYWwuY2hhckNvZGUgIT0gbnVsbCA/IG9yaWdpbmFsLmNoYXJDb2RlIDogb3JpZ2luYWwua2V5Q29kZTsKCQkJCX0KCgkJCQlyZXR1cm4gZXZlbnQ7CgkJCX0KCQl9LAoKCQltb3VzZUhvb2tzOiB7CgkJCXByb3BzOiAoICJidXR0b24gYnV0dG9ucyBjbGllbnRYIGNsaWVudFkgZnJvbUVsZW1lbnQgb2Zmc2V0WCBvZmZzZXRZICIgKwoJCQkJInBhZ2VYIHBhZ2VZIHNjcmVlblggc2NyZWVuWSB0b0VsZW1lbnQiICkuc3BsaXQoICIgIiApLAoJCQlmaWx0ZXI6IGZ1bmN0aW9uKCBldmVudCwgb3JpZ2luYWwgKSB7CgkJCQl2YXIgYm9keSwgZXZlbnREb2MsIGRvYywKCQkJCQlidXR0b24gPSBvcmlnaW5hbC5idXR0b24sCgkJCQkJZnJvbUVsZW1lbnQgPSBvcmlnaW5hbC5mcm9tRWxlbWVudDsKCgkJCQkvLyBDYWxjdWxhdGUgcGFnZVgvWSBpZiBtaXNzaW5nIGFuZCBjbGllbnRYL1kgYXZhaWxhYmxlCgkJCQlpZiAoIGV2ZW50LnBhZ2VYID09IG51bGwgJiYgb3JpZ2luYWwuY2xpZW50WCAhPSBudWxsICkgewoJCQkJCWV2ZW50RG9jID0gZXZlbnQudGFyZ2V0Lm93bmVyRG9jdW1lbnQgfHwgZG9jdW1lbnQ7CgkJCQkJZG9jID0gZXZlbnREb2MuZG9jdW1lbnRFbGVtZW50OwoJCQkJCWJvZHkgPSBldmVudERvYy5ib2R5OwoKCQkJCQlldmVudC5wYWdlWCA9IG9yaWdpbmFsLmNsaWVudFggKwoJCQkJCQkoIGRvYyAmJiBkb2Muc2Nyb2xsTGVmdCB8fCBib2R5ICYmIGJvZHkuc2Nyb2xsTGVmdCB8fCAwICkgLQoJCQkJCQkoIGRvYyAmJiBkb2MuY2xpZW50TGVmdCB8fCBib2R5ICYmIGJvZHkuY2xpZW50TGVmdCB8fCAwICk7CgkJCQkJZXZlbnQucGFnZVkgPSBvcmlnaW5hbC5jbGllbnRZICsKCQkJCQkJKCBkb2MgJiYgZG9jLnNjcm9sbFRvcCAgfHwgYm9keSAmJiBib2R5LnNjcm9sbFRvcCAgfHwgMCApIC0KCQkJCQkJKCBkb2MgJiYgZG9jLmNsaWVudFRvcCAgfHwgYm9keSAmJiBib2R5LmNsaWVudFRvcCAgfHwgMCApOwoJCQkJfQoKCQkJCS8vIEFkZCByZWxhdGVkVGFyZ2V0LCBpZiBuZWNlc3NhcnkKCQkJCWlmICggIWV2ZW50LnJlbGF0ZWRUYXJnZXQgJiYgZnJvbUVsZW1lbnQgKSB7CgkJCQkJZXZlbnQucmVsYXRlZFRhcmdldCA9IGZyb21FbGVtZW50ID09PSBldmVudC50YXJnZXQgPwoJCQkJCQlvcmlnaW5hbC50b0VsZW1lbnQgOgoJCQkJCQlmcm9tRWxlbWVudDsKCQkJCX0KCgkJCQkvLyBBZGQgd2hpY2ggZm9yIGNsaWNrOiAxID09PSBsZWZ0OyAyID09PSBtaWRkbGU7IDMgPT09IHJpZ2h0CgkJCQkvLyBOb3RlOiBidXR0b24gaXMgbm90IG5vcm1hbGl6ZWQsIHNvIGRvbid0IHVzZSBpdAoJCQkJaWYgKCAhZXZlbnQud2hpY2ggJiYgYnV0dG9uICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJZXZlbnQud2hpY2ggPSAoIGJ1dHRvbiAmIDEgPyAxIDogKCBidXR0b24gJiAyID8gMyA6ICggYnV0dG9uICYgNCA/IDIgOiAwICkgKSApOwoJCQkJfQoKCQkJCXJldHVybiBldmVudDsKCQkJfQoJCX0sCgoJCXNwZWNpYWw6IHsKCQkJbG9hZDogewoKCQkJCS8vIFByZXZlbnQgdHJpZ2dlcmVkIGltYWdlLmxvYWQgZXZlbnRzIGZyb20gYnViYmxpbmcgdG8gd2luZG93LmxvYWQKCQkJCW5vQnViYmxlOiB0cnVlCgkJCX0sCgkJCWZvY3VzOiB7CgoJCQkJLy8gRmlyZSBuYXRpdmUgZXZlbnQgaWYgcG9zc2libGUgc28gYmx1ci9mb2N1cyBzZXF1ZW5jZSBpcyBjb3JyZWN0CgkJCQl0cmlnZ2VyOiBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIHRoaXMgIT09IHNhZmVBY3RpdmVFbGVtZW50KCkgJiYgdGhpcy5mb2N1cyApIHsKCQkJCQkJdHJ5IHsKCQkJCQkJCXRoaXMuZm9jdXMoKTsKCQkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQkJfSBjYXRjaCAoIGUgKSB7CgoJCQkJCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkJCQkJLy8gSWYgd2UgZXJyb3Igb24gZm9jdXMgdG8gaGlkZGVuIGVsZW1lbnQgKCMxNDg2LCAjMTI1MTgpLAoJCQkJCQkJLy8gbGV0IC50cmlnZ2VyKCkgcnVuIHRoZSBoYW5kbGVycwoJCQkJCQl9CgkJCQkJfQoJCQkJfSwKCQkJCWRlbGVnYXRlVHlwZTogImZvY3VzaW4iCgkJCX0sCgkJCWJsdXI6IHsKCQkJCXRyaWdnZXI6IGZ1bmN0aW9uKCkgewoJCQkJCWlmICggdGhpcyA9PT0gc2FmZUFjdGl2ZUVsZW1lbnQoKSAmJiB0aGlzLmJsdXIgKSB7CgkJCQkJCXRoaXMuYmx1cigpOwoJCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQkJfQoJCQkJfSwKCQkJCWRlbGVnYXRlVHlwZTogImZvY3Vzb3V0IgoJCQl9LAoJCQljbGljazogewoKCQkJCS8vIEZvciBjaGVja2JveCwgZmlyZSBuYXRpdmUgZXZlbnQgc28gY2hlY2tlZCBzdGF0ZSB3aWxsIGJlIHJpZ2h0CgkJCQl0cmlnZ2VyOiBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIGpRdWVyeS5ub2RlTmFtZSggdGhpcywgImlucHV0IiApICYmIHRoaXMudHlwZSA9PT0gImNoZWNrYm94IiAmJiB0aGlzLmNsaWNrICkgewoJCQkJCQl0aGlzLmNsaWNrKCk7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9LAoKCQkJCS8vIEZvciBjcm9zcy1icm93c2VyIGNvbnNpc3RlbmN5LCBkb24ndCBmaXJlIG5hdGl2ZSAuY2xpY2soKSBvbiBsaW5rcwoJCQkJX2RlZmF1bHQ6IGZ1bmN0aW9uKCBldmVudCApIHsKCQkJCQlyZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKCBldmVudC50YXJnZXQsICJhIiApOwoJCQkJfQoJCQl9LAoKCQkJYmVmb3JldW5sb2FkOiB7CgkJCQlwb3N0RGlzcGF0Y2g6IGZ1bmN0aW9uKCBldmVudCApIHsKCgkJCQkJLy8gU3VwcG9ydDogRmlyZWZveCAyMCsKCQkJCQkvLyBGaXJlZm94IGRvZXNuJ3QgYWxlcnQgaWYgdGhlIHJldHVyblZhbHVlIGZpZWxkIGlzIG5vdCBzZXQuCgkJCQkJaWYgKCBldmVudC5yZXN1bHQgIT09IHVuZGVmaW5lZCAmJiBldmVudC5vcmlnaW5hbEV2ZW50ICkgewoJCQkJCQlldmVudC5vcmlnaW5hbEV2ZW50LnJldHVyblZhbHVlID0gZXZlbnQucmVzdWx0OwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0sCgoJCS8vIFBpZ2d5YmFjayBvbiBhIGRvbm9yIGV2ZW50IHRvIHNpbXVsYXRlIGEgZGlmZmVyZW50IG9uZQoJCXNpbXVsYXRlOiBmdW5jdGlvbiggdHlwZSwgZWxlbSwgZXZlbnQgKSB7CgkJCXZhciBlID0galF1ZXJ5LmV4dGVuZCgKCQkJCW5ldyBqUXVlcnkuRXZlbnQoKSwKCQkJCWV2ZW50LAoJCQkJewoJCQkJCXR5cGU6IHR5cGUsCgkJCQkJaXNTaW11bGF0ZWQ6IHRydWUKCgkJCQkJLy8gUHJldmlvdXNseSwgYG9yaWdpbmFsRXZlbnQ6IHt9YCB3YXMgc2V0IGhlcmUsIHNvIHN0b3BQcm9wYWdhdGlvbiBjYWxsCgkJCQkJLy8gd291bGQgbm90IGJlIHRyaWdnZXJlZCBvbiBkb25vciBldmVudCwgc2luY2UgaW4gb3VyIG93bgoJCQkJCS8vIGpRdWVyeS5ldmVudC5zdG9wUHJvcGFnYXRpb24gZnVuY3Rpb24gd2UgaGFkIGEgY2hlY2sgZm9yIGV4aXN0ZW5jZSBvZgoJCQkJCS8vIG9yaWdpbmFsRXZlbnQuc3RvcFByb3BhZ2F0aW9uIG1ldGhvZCwgc28sIGNvbnNlcXVlbnRseSBpdCB3b3VsZCBiZSBhIG5vb3AuCgkJCQkJLy8KCQkJCQkvLyBHdWFyZCBmb3Igc2ltdWxhdGVkIGV2ZW50cyB3YXMgbW92ZWQgdG8galF1ZXJ5LmV2ZW50LnN0b3BQcm9wYWdhdGlvbiBmdW5jdGlvbgoJCQkJCS8vIHNpbmNlIGBvcmlnaW5hbEV2ZW50YCBzaG91bGQgcG9pbnQgdG8gdGhlIG9yaWdpbmFsIGV2ZW50IGZvciB0aGUKCQkJCQkvLyBjb25zdGFuY3kgd2l0aCBvdGhlciBldmVudHMgYW5kIGZvciBtb3JlIGZvY3VzZWQgbG9naWMKCQkJCX0KCQkJKTsKCgkJCWpRdWVyeS5ldmVudC50cmlnZ2VyKCBlLCBudWxsLCBlbGVtICk7CgoJCQlpZiAoIGUuaXNEZWZhdWx0UHJldmVudGVkKCkgKSB7CgkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQl9CgkJfQoJfTsKCglqUXVlcnkucmVtb3ZlRXZlbnQgPSBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyID8KCQlmdW5jdGlvbiggZWxlbSwgdHlwZSwgaGFuZGxlICkgewoKCQkJLy8gVGhpcyAiaWYiIGlzIG5lZWRlZCBmb3IgcGxhaW4gb2JqZWN0cwoJCQlpZiAoIGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lciApIHsKCQkJCWVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lciggdHlwZSwgaGFuZGxlICk7CgkJCX0KCQl9IDoKCQlmdW5jdGlvbiggZWxlbSwgdHlwZSwgaGFuZGxlICkgewoJCQl2YXIgbmFtZSA9ICJvbiIgKyB0eXBlOwoKCQkJaWYgKCBlbGVtLmRldGFjaEV2ZW50ICkgewoKCQkJCS8vICM4NTQ1LCAjNzA1NCwgcHJldmVudGluZyBtZW1vcnkgbGVha3MgZm9yIGN1c3RvbSBldmVudHMgaW4gSUU2LTgKCQkJCS8vIGRldGFjaEV2ZW50IG5lZWRlZCBwcm9wZXJ0eSBvbiBlbGVtZW50LCBieSBuYW1lIG9mIHRoYXQgZXZlbnQsCgkJCQkvLyB0byBwcm9wZXJseSBleHBvc2UgaXQgdG8gR0MKCQkJCWlmICggdHlwZW9mIGVsZW1bIG5hbWUgXSA9PT0gInVuZGVmaW5lZCIgKSB7CgkJCQkJZWxlbVsgbmFtZSBdID0gbnVsbDsKCQkJCX0KCgkJCQllbGVtLmRldGFjaEV2ZW50KCBuYW1lLCBoYW5kbGUgKTsKCQkJfQoJCX07CgoJalF1ZXJ5LkV2ZW50ID0gZnVuY3Rpb24oIHNyYywgcHJvcHMgKSB7CgoJCS8vIEFsbG93IGluc3RhbnRpYXRpb24gd2l0aG91dCB0aGUgJ25ldycga2V5d29yZAoJCWlmICggISggdGhpcyBpbnN0YW5jZW9mIGpRdWVyeS5FdmVudCApICkgewoJCQlyZXR1cm4gbmV3IGpRdWVyeS5FdmVudCggc3JjLCBwcm9wcyApOwoJCX0KCgkJLy8gRXZlbnQgb2JqZWN0CgkJaWYgKCBzcmMgJiYgc3JjLnR5cGUgKSB7CgkJCXRoaXMub3JpZ2luYWxFdmVudCA9IHNyYzsKCQkJdGhpcy50eXBlID0gc3JjLnR5cGU7CgoJCQkvLyBFdmVudHMgYnViYmxpbmcgdXAgdGhlIGRvY3VtZW50IG1heSBoYXZlIGJlZW4gbWFya2VkIGFzIHByZXZlbnRlZAoJCQkvLyBieSBhIGhhbmRsZXIgbG93ZXIgZG93biB0aGUgdHJlZTsgcmVmbGVjdCB0aGUgY29ycmVjdCB2YWx1ZS4KCQkJdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQgPSBzcmMuZGVmYXVsdFByZXZlbnRlZCB8fAoJCQkJCXNyYy5kZWZhdWx0UHJldmVudGVkID09PSB1bmRlZmluZWQgJiYKCgkJCQkJLy8gU3VwcG9ydDogSUUgPCA5LCBBbmRyb2lkIDwgNC4wCgkJCQkJc3JjLnJldHVyblZhbHVlID09PSBmYWxzZSA/CgkJCQlyZXR1cm5UcnVlIDoKCQkJCXJldHVybkZhbHNlOwoKCQkvLyBFdmVudCB0eXBlCgkJfSBlbHNlIHsKCQkJdGhpcy50eXBlID0gc3JjOwoJCX0KCgkJLy8gUHV0IGV4cGxpY2l0bHkgcHJvdmlkZWQgcHJvcGVydGllcyBvbnRvIHRoZSBldmVudCBvYmplY3QKCQlpZiAoIHByb3BzICkgewoJCQlqUXVlcnkuZXh0ZW5kKCB0aGlzLCBwcm9wcyApOwoJCX0KCgkJLy8gQ3JlYXRlIGEgdGltZXN0YW1wIGlmIGluY29taW5nIGV2ZW50IGRvZXNuJ3QgaGF2ZSBvbmUKCQl0aGlzLnRpbWVTdGFtcCA9IHNyYyAmJiBzcmMudGltZVN0YW1wIHx8IGpRdWVyeS5ub3coKTsKCgkJLy8gTWFyayBpdCBhcyBmaXhlZAoJCXRoaXNbIGpRdWVyeS5leHBhbmRvIF0gPSB0cnVlOwoJfTsKCgkvLyBqUXVlcnkuRXZlbnQgaXMgYmFzZWQgb24gRE9NMyBFdmVudHMgYXMgc3BlY2lmaWVkIGJ5IHRoZSBFQ01BU2NyaXB0IExhbmd1YWdlIEJpbmRpbmcKCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDMvV0QtRE9NLUxldmVsLTMtRXZlbnRzLTIwMDMwMzMxL2VjbWEtc2NyaXB0LWJpbmRpbmcuaHRtbAoJalF1ZXJ5LkV2ZW50LnByb3RvdHlwZSA9IHsKCQljb25zdHJ1Y3RvcjogalF1ZXJ5LkV2ZW50LAoJCWlzRGVmYXVsdFByZXZlbnRlZDogcmV0dXJuRmFsc2UsCgkJaXNQcm9wYWdhdGlvblN0b3BwZWQ6IHJldHVybkZhbHNlLAoJCWlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOiByZXR1cm5GYWxzZSwKCgkJcHJldmVudERlZmF1bHQ6IGZ1bmN0aW9uKCkgewoJCQl2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsKCgkJCXRoaXMuaXNEZWZhdWx0UHJldmVudGVkID0gcmV0dXJuVHJ1ZTsKCQkJaWYgKCAhZSApIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gSWYgcHJldmVudERlZmF1bHQgZXhpc3RzLCBydW4gaXQgb24gdGhlIG9yaWdpbmFsIGV2ZW50CgkJCWlmICggZS5wcmV2ZW50RGVmYXVsdCApIHsKCQkJCWUucHJldmVudERlZmF1bHQoKTsKCgkJCS8vIFN1cHBvcnQ6IElFCgkJCS8vIE90aGVyd2lzZSBzZXQgdGhlIHJldHVyblZhbHVlIHByb3BlcnR5IG9mIHRoZSBvcmlnaW5hbCBldmVudCB0byBmYWxzZQoJCQl9IGVsc2UgewoJCQkJZS5yZXR1cm5WYWx1ZSA9IGZhbHNlOwoJCQl9CgkJfSwKCQlzdG9wUHJvcGFnYXRpb246IGZ1bmN0aW9uKCkgewoJCQl2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsKCgkJCXRoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQgPSByZXR1cm5UcnVlOwoKCQkJaWYgKCAhZSB8fCB0aGlzLmlzU2ltdWxhdGVkICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBJZiBzdG9wUHJvcGFnYXRpb24gZXhpc3RzLCBydW4gaXQgb24gdGhlIG9yaWdpbmFsIGV2ZW50CgkJCWlmICggZS5zdG9wUHJvcGFnYXRpb24gKSB7CgkJCQllLnN0b3BQcm9wYWdhdGlvbigpOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRQoJCQkvLyBTZXQgdGhlIGNhbmNlbEJ1YmJsZSBwcm9wZXJ0eSBvZiB0aGUgb3JpZ2luYWwgZXZlbnQgdG8gdHJ1ZQoJCQllLmNhbmNlbEJ1YmJsZSA9IHRydWU7CgkJfSwKCQlzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246IGZ1bmN0aW9uKCkgewoJCQl2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsKCgkJCXRoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSByZXR1cm5UcnVlOwoKCQkJaWYgKCBlICYmIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uICkgewoJCQkJZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTsKCQkJfQoKCQkJdGhpcy5zdG9wUHJvcGFnYXRpb24oKTsKCQl9Cgl9OwoKCS8vIENyZWF0ZSBtb3VzZWVudGVyL2xlYXZlIGV2ZW50cyB1c2luZyBtb3VzZW92ZXIvb3V0IGFuZCBldmVudC10aW1lIGNoZWNrcwoJLy8gc28gdGhhdCBldmVudCBkZWxlZ2F0aW9uIHdvcmtzIGluIGpRdWVyeS4KCS8vIERvIHRoZSBzYW1lIGZvciBwb2ludGVyZW50ZXIvcG9pbnRlcmxlYXZlIGFuZCBwb2ludGVyb3Zlci9wb2ludGVyb3V0CgkvLwoJLy8gU3VwcG9ydDogU2FmYXJpIDcgb25seQoJLy8gU2FmYXJpIHNlbmRzIG1vdXNlZW50ZXIgdG9vIG9mdGVuOyBzZWU6CgkvLyBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9NDcwMjU4CgkvLyBmb3IgdGhlIGRlc2NyaXB0aW9uIG9mIHRoZSBidWcgKGl0IGV4aXN0ZWQgaW4gb2xkZXIgQ2hyb21lIHZlcnNpb25zIGFzIHdlbGwpLgoJalF1ZXJ5LmVhY2goIHsKCQltb3VzZWVudGVyOiAibW91c2VvdmVyIiwKCQltb3VzZWxlYXZlOiAibW91c2VvdXQiLAoJCXBvaW50ZXJlbnRlcjogInBvaW50ZXJvdmVyIiwKCQlwb2ludGVybGVhdmU6ICJwb2ludGVyb3V0IgoJfSwgZnVuY3Rpb24oIG9yaWcsIGZpeCApIHsKCQlqUXVlcnkuZXZlbnQuc3BlY2lhbFsgb3JpZyBdID0gewoJCQlkZWxlZ2F0ZVR5cGU6IGZpeCwKCQkJYmluZFR5cGU6IGZpeCwKCgkJCWhhbmRsZTogZnVuY3Rpb24oIGV2ZW50ICkgewoJCQkJdmFyIHJldCwKCQkJCQl0YXJnZXQgPSB0aGlzLAoJCQkJCXJlbGF0ZWQgPSBldmVudC5yZWxhdGVkVGFyZ2V0LAoJCQkJCWhhbmRsZU9iaiA9IGV2ZW50LmhhbmRsZU9iajsKCgkJCQkvLyBGb3IgbW91c2VlbnRlci9sZWF2ZSBjYWxsIHRoZSBoYW5kbGVyIGlmIHJlbGF0ZWQgaXMgb3V0c2lkZSB0aGUgdGFyZ2V0LgoJCQkJLy8gTkI6IE5vIHJlbGF0ZWRUYXJnZXQgaWYgdGhlIG1vdXNlIGxlZnQvZW50ZXJlZCB0aGUgYnJvd3NlciB3aW5kb3cKCQkJCWlmICggIXJlbGF0ZWQgfHwgKCByZWxhdGVkICE9PSB0YXJnZXQgJiYgIWpRdWVyeS5jb250YWlucyggdGFyZ2V0LCByZWxhdGVkICkgKSApIHsKCQkJCQlldmVudC50eXBlID0gaGFuZGxlT2JqLm9yaWdUeXBlOwoJCQkJCXJldCA9IGhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKCQkJCQlldmVudC50eXBlID0gZml4OwoJCQkJfQoJCQkJcmV0dXJuIHJldDsKCQkJfQoJCX07Cgl9ICk7CgoJLy8gSUUgc3VibWl0IGRlbGVnYXRpb24KCWlmICggIXN1cHBvcnQuc3VibWl0ICkgewoKCQlqUXVlcnkuZXZlbnQuc3BlY2lhbC5zdWJtaXQgPSB7CgkJCXNldHVwOiBmdW5jdGlvbigpIHsKCgkJCQkvLyBPbmx5IG5lZWQgdGhpcyBmb3IgZGVsZWdhdGVkIGZvcm0gc3VibWl0IGV2ZW50cwoJCQkJaWYgKCBqUXVlcnkubm9kZU5hbWUoIHRoaXMsICJmb3JtIiApICkgewoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0KCgkJCQkvLyBMYXp5LWFkZCBhIHN1Ym1pdCBoYW5kbGVyIHdoZW4gYSBkZXNjZW5kYW50IGZvcm0gbWF5IHBvdGVudGlhbGx5IGJlIHN1Ym1pdHRlZAoJCQkJalF1ZXJ5LmV2ZW50LmFkZCggdGhpcywgImNsaWNrLl9zdWJtaXQga2V5cHJlc3MuX3N1Ym1pdCIsIGZ1bmN0aW9uKCBlICkgewoKCQkJCQkvLyBOb2RlIG5hbWUgY2hlY2sgYXZvaWRzIGEgVk1MLXJlbGF0ZWQgY3Jhc2ggaW4gSUUgKCM5ODA3KQoJCQkJCXZhciBlbGVtID0gZS50YXJnZXQsCgkJCQkJCWZvcm0gPSBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJpbnB1dCIgKSB8fCBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJidXR0b24iICkgPwoKCQkJCQkJCS8vIFN1cHBvcnQ6IElFIDw9OAoJCQkJCQkJLy8gV2UgdXNlIGpRdWVyeS5wcm9wIGluc3RlYWQgb2YgZWxlbS5mb3JtCgkJCQkJCQkvLyB0byBhbGxvdyBmaXhpbmcgdGhlIElFOCBkZWxlZ2F0ZWQgc3VibWl0IGlzc3VlIChnaC0yMzMyKQoJCQkJCQkJLy8gYnkgM3JkIHBhcnR5IHBvbHlmaWxscy93b3JrYXJvdW5kcy4KCQkJCQkJCWpRdWVyeS5wcm9wKCBlbGVtLCAiZm9ybSIgKSA6CgkJCQkJCQl1bmRlZmluZWQ7CgoJCQkJCWlmICggZm9ybSAmJiAhalF1ZXJ5Ll9kYXRhKCBmb3JtLCAic3VibWl0IiApICkgewoJCQkJCQlqUXVlcnkuZXZlbnQuYWRkKCBmb3JtLCAic3VibWl0Ll9zdWJtaXQiLCBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQkJCQlldmVudC5fc3VibWl0QnViYmxlID0gdHJ1ZTsKCQkJCQkJfSApOwoJCQkJCQlqUXVlcnkuX2RhdGEoIGZvcm0sICJzdWJtaXQiLCB0cnVlICk7CgkJCQkJfQoJCQkJfSApOwoKCQkJCS8vIHJldHVybiB1bmRlZmluZWQgc2luY2Ugd2UgZG9uJ3QgbmVlZCBhbiBldmVudCBsaXN0ZW5lcgoJCQl9LAoKCQkJcG9zdERpc3BhdGNoOiBmdW5jdGlvbiggZXZlbnQgKSB7CgoJCQkJLy8gSWYgZm9ybSB3YXMgc3VibWl0dGVkIGJ5IHRoZSB1c2VyLCBidWJibGUgdGhlIGV2ZW50IHVwIHRoZSB0cmVlCgkJCQlpZiAoIGV2ZW50Ll9zdWJtaXRCdWJibGUgKSB7CgkJCQkJZGVsZXRlIGV2ZW50Ll9zdWJtaXRCdWJibGU7CgkJCQkJaWYgKCB0aGlzLnBhcmVudE5vZGUgJiYgIWV2ZW50LmlzVHJpZ2dlciApIHsKCQkJCQkJalF1ZXJ5LmV2ZW50LnNpbXVsYXRlKCAic3VibWl0IiwgdGhpcy5wYXJlbnROb2RlLCBldmVudCApOwoJCQkJCX0KCQkJCX0KCQkJfSwKCgkJCXRlYXJkb3duOiBmdW5jdGlvbigpIHsKCgkJCQkvLyBPbmx5IG5lZWQgdGhpcyBmb3IgZGVsZWdhdGVkIGZvcm0gc3VibWl0IGV2ZW50cwoJCQkJaWYgKCBqUXVlcnkubm9kZU5hbWUoIHRoaXMsICJmb3JtIiApICkgewoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0KCgkJCQkvLyBSZW1vdmUgZGVsZWdhdGVkIGhhbmRsZXJzOyBjbGVhbkRhdGEgZXZlbnR1YWxseSByZWFwcyBzdWJtaXQgaGFuZGxlcnMgYXR0YWNoZWQgYWJvdmUKCQkJCWpRdWVyeS5ldmVudC5yZW1vdmUoIHRoaXMsICIuX3N1Ym1pdCIgKTsKCQkJfQoJCX07Cgl9CgoJLy8gSUUgY2hhbmdlIGRlbGVnYXRpb24gYW5kIGNoZWNrYm94L3JhZGlvIGZpeAoJaWYgKCAhc3VwcG9ydC5jaGFuZ2UgKSB7CgoJCWpRdWVyeS5ldmVudC5zcGVjaWFsLmNoYW5nZSA9IHsKCgkJCXNldHVwOiBmdW5jdGlvbigpIHsKCgkJCQlpZiAoIHJmb3JtRWxlbXMudGVzdCggdGhpcy5ub2RlTmFtZSApICkgewoKCQkJCQkvLyBJRSBkb2Vzbid0IGZpcmUgY2hhbmdlIG9uIGEgY2hlY2svcmFkaW8gdW50aWwgYmx1cjsgdHJpZ2dlciBpdCBvbiBjbGljawoJCQkJCS8vIGFmdGVyIGEgcHJvcGVydHljaGFuZ2UuIEVhdCB0aGUgYmx1ci1jaGFuZ2UgaW4gc3BlY2lhbC5jaGFuZ2UuaGFuZGxlLgoJCQkJCS8vIFRoaXMgc3RpbGwgZmlyZXMgb25jaGFuZ2UgYSBzZWNvbmQgdGltZSBmb3IgY2hlY2svcmFkaW8gYWZ0ZXIgYmx1ci4KCQkJCQlpZiAoIHRoaXMudHlwZSA9PT0gImNoZWNrYm94IiB8fCB0aGlzLnR5cGUgPT09ICJyYWRpbyIgKSB7CgkJCQkJCWpRdWVyeS5ldmVudC5hZGQoIHRoaXMsICJwcm9wZXJ0eWNoYW5nZS5fY2hhbmdlIiwgZnVuY3Rpb24oIGV2ZW50ICkgewoJCQkJCQkJaWYgKCBldmVudC5vcmlnaW5hbEV2ZW50LnByb3BlcnR5TmFtZSA9PT0gImNoZWNrZWQiICkgewoJCQkJCQkJCXRoaXMuX2p1c3RDaGFuZ2VkID0gdHJ1ZTsKCQkJCQkJCX0KCQkJCQkJfSApOwoJCQkJCQlqUXVlcnkuZXZlbnQuYWRkKCB0aGlzLCAiY2xpY2suX2NoYW5nZSIsIGZ1bmN0aW9uKCBldmVudCApIHsKCQkJCQkJCWlmICggdGhpcy5fanVzdENoYW5nZWQgJiYgIWV2ZW50LmlzVHJpZ2dlciApIHsKCQkJCQkJCQl0aGlzLl9qdXN0Q2hhbmdlZCA9IGZhbHNlOwoJCQkJCQkJfQoKCQkJCQkJCS8vIEFsbG93IHRyaWdnZXJlZCwgc2ltdWxhdGVkIGNoYW5nZSBldmVudHMgKCMxMTUwMCkKCQkJCQkJCWpRdWVyeS5ldmVudC5zaW11bGF0ZSggImNoYW5nZSIsIHRoaXMsIGV2ZW50ICk7CgkJCQkJCX0gKTsKCQkJCQl9CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoKCQkJCS8vIERlbGVnYXRlZCBldmVudDsgbGF6eS1hZGQgYSBjaGFuZ2UgaGFuZGxlciBvbiBkZXNjZW5kYW50IGlucHV0cwoJCQkJalF1ZXJ5LmV2ZW50LmFkZCggdGhpcywgImJlZm9yZWFjdGl2YXRlLl9jaGFuZ2UiLCBmdW5jdGlvbiggZSApIHsKCQkJCQl2YXIgZWxlbSA9IGUudGFyZ2V0OwoKCQkJCQlpZiAoIHJmb3JtRWxlbXMudGVzdCggZWxlbS5ub2RlTmFtZSApICYmICFqUXVlcnkuX2RhdGEoIGVsZW0sICJjaGFuZ2UiICkgKSB7CgkJCQkJCWpRdWVyeS5ldmVudC5hZGQoIGVsZW0sICJjaGFuZ2UuX2NoYW5nZSIsIGZ1bmN0aW9uKCBldmVudCApIHsKCQkJCQkJCWlmICggdGhpcy5wYXJlbnROb2RlICYmICFldmVudC5pc1NpbXVsYXRlZCAmJiAhZXZlbnQuaXNUcmlnZ2VyICkgewoJCQkJCQkJCWpRdWVyeS5ldmVudC5zaW11bGF0ZSggImNoYW5nZSIsIHRoaXMucGFyZW50Tm9kZSwgZXZlbnQgKTsKCQkJCQkJCX0KCQkJCQkJfSApOwoJCQkJCQlqUXVlcnkuX2RhdGEoIGVsZW0sICJjaGFuZ2UiLCB0cnVlICk7CgkJCQkJfQoJCQkJfSApOwoJCQl9LAoKCQkJaGFuZGxlOiBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQl2YXIgZWxlbSA9IGV2ZW50LnRhcmdldDsKCgkJCQkvLyBTd2FsbG93IG5hdGl2ZSBjaGFuZ2UgZXZlbnRzIGZyb20gY2hlY2tib3gvcmFkaW8sIHdlIGFscmVhZHkgdHJpZ2dlcmVkIHRoZW0gYWJvdmUKCQkJCWlmICggdGhpcyAhPT0gZWxlbSB8fCBldmVudC5pc1NpbXVsYXRlZCB8fCBldmVudC5pc1RyaWdnZXIgfHwKCQkJCQkoIGVsZW0udHlwZSAhPT0gInJhZGlvIiAmJiBlbGVtLnR5cGUgIT09ICJjaGVja2JveCIgKSApIHsKCgkJCQkJcmV0dXJuIGV2ZW50LmhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKCQkJCX0KCQkJfSwKCgkJCXRlYXJkb3duOiBmdW5jdGlvbigpIHsKCQkJCWpRdWVyeS5ldmVudC5yZW1vdmUoIHRoaXMsICIuX2NoYW5nZSIgKTsKCgkJCQlyZXR1cm4gIXJmb3JtRWxlbXMudGVzdCggdGhpcy5ub2RlTmFtZSApOwoJCQl9CgkJfTsKCX0KCgkvLyBTdXBwb3J0OiBGaXJlZm94CgkvLyBGaXJlZm94IGRvZXNuJ3QgaGF2ZSBmb2N1cyhpbiB8IG91dCkgZXZlbnRzCgkvLyBSZWxhdGVkIHRpY2tldCAtIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTY4Nzc4NwoJLy8KCS8vIFN1cHBvcnQ6IENocm9tZSwgU2FmYXJpCgkvLyBmb2N1cyhpbiB8IG91dCkgZXZlbnRzIGZpcmUgYWZ0ZXIgZm9jdXMgJiBibHVyIGV2ZW50cywKCS8vIHdoaWNoIGlzIHNwZWMgdmlvbGF0aW9uIC0gaHR0cDovL3d3dy53My5vcmcvVFIvRE9NLUxldmVsLTMtRXZlbnRzLyNldmVudHMtZm9jdXNldmVudC1ldmVudC1vcmRlcgoJLy8gUmVsYXRlZCB0aWNrZXQgLSBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9NDQ5ODU3CglpZiAoICFzdXBwb3J0LmZvY3VzaW4gKSB7CgkJalF1ZXJ5LmVhY2goIHsgZm9jdXM6ICJmb2N1c2luIiwgYmx1cjogImZvY3Vzb3V0IiB9LCBmdW5jdGlvbiggb3JpZywgZml4ICkgewoKCQkJLy8gQXR0YWNoIGEgc2luZ2xlIGNhcHR1cmluZyBoYW5kbGVyIG9uIHRoZSBkb2N1bWVudCB3aGlsZSBzb21lb25lIHdhbnRzIGZvY3VzaW4vZm9jdXNvdXQKCQkJdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQlqUXVlcnkuZXZlbnQuc2ltdWxhdGUoIGZpeCwgZXZlbnQudGFyZ2V0LCBqUXVlcnkuZXZlbnQuZml4KCBldmVudCApICk7CgkJCX07CgoJCQlqUXVlcnkuZXZlbnQuc3BlY2lhbFsgZml4IF0gPSB7CgkJCQlzZXR1cDogZnVuY3Rpb24oKSB7CgkJCQkJdmFyIGRvYyA9IHRoaXMub3duZXJEb2N1bWVudCB8fCB0aGlzLAoJCQkJCQlhdHRhY2hlcyA9IGpRdWVyeS5fZGF0YSggZG9jLCBmaXggKTsKCgkJCQkJaWYgKCAhYXR0YWNoZXMgKSB7CgkJCQkJCWRvYy5hZGRFdmVudExpc3RlbmVyKCBvcmlnLCBoYW5kbGVyLCB0cnVlICk7CgkJCQkJfQoJCQkJCWpRdWVyeS5fZGF0YSggZG9jLCBmaXgsICggYXR0YWNoZXMgfHwgMCApICsgMSApOwoJCQkJfSwKCQkJCXRlYXJkb3duOiBmdW5jdGlvbigpIHsKCQkJCQl2YXIgZG9jID0gdGhpcy5vd25lckRvY3VtZW50IHx8IHRoaXMsCgkJCQkJCWF0dGFjaGVzID0galF1ZXJ5Ll9kYXRhKCBkb2MsIGZpeCApIC0gMTsKCgkJCQkJaWYgKCAhYXR0YWNoZXMgKSB7CgkJCQkJCWRvYy5yZW1vdmVFdmVudExpc3RlbmVyKCBvcmlnLCBoYW5kbGVyLCB0cnVlICk7CgkJCQkJCWpRdWVyeS5fcmVtb3ZlRGF0YSggZG9jLCBmaXggKTsKCQkJCQl9IGVsc2UgewoJCQkJCQlqUXVlcnkuX2RhdGEoIGRvYywgZml4LCBhdHRhY2hlcyApOwoJCQkJCX0KCQkJCX0KCQkJfTsKCQl9ICk7Cgl9CgoJalF1ZXJ5LmZuLmV4dGVuZCggewoKCQlvbjogZnVuY3Rpb24oIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4gKSB7CgkJCXJldHVybiBvbiggdGhpcywgdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiApOwoJCX0sCgkJb25lOiBmdW5jdGlvbiggdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiApIHsKCQkJcmV0dXJuIG9uKCB0aGlzLCB0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuLCAxICk7CgkJfSwKCQlvZmY6IGZ1bmN0aW9uKCB0eXBlcywgc2VsZWN0b3IsIGZuICkgewoJCQl2YXIgaGFuZGxlT2JqLCB0eXBlOwoJCQlpZiAoIHR5cGVzICYmIHR5cGVzLnByZXZlbnREZWZhdWx0ICYmIHR5cGVzLmhhbmRsZU9iaiApIHsKCgkJCQkvLyAoIGV2ZW50ICkgIGRpc3BhdGNoZWQgalF1ZXJ5LkV2ZW50CgkJCQloYW5kbGVPYmogPSB0eXBlcy5oYW5kbGVPYmo7CgkJCQlqUXVlcnkoIHR5cGVzLmRlbGVnYXRlVGFyZ2V0ICkub2ZmKAoJCQkJCWhhbmRsZU9iai5uYW1lc3BhY2UgPwoJCQkJCQloYW5kbGVPYmoub3JpZ1R5cGUgKyAiLiIgKyBoYW5kbGVPYmoubmFtZXNwYWNlIDoKCQkJCQkJaGFuZGxlT2JqLm9yaWdUeXBlLAoJCQkJCWhhbmRsZU9iai5zZWxlY3RvciwKCQkJCQloYW5kbGVPYmouaGFuZGxlcgoJCQkJKTsKCQkJCXJldHVybiB0aGlzOwoJCQl9CgkJCWlmICggdHlwZW9mIHR5cGVzID09PSAib2JqZWN0IiApIHsKCgkJCQkvLyAoIHR5cGVzLW9iamVjdCBbLCBzZWxlY3Rvcl0gKQoJCQkJZm9yICggdHlwZSBpbiB0eXBlcyApIHsKCQkJCQl0aGlzLm9mZiggdHlwZSwgc2VsZWN0b3IsIHR5cGVzWyB0eXBlIF0gKTsKCQkJCX0KCQkJCXJldHVybiB0aGlzOwoJCQl9CgkJCWlmICggc2VsZWN0b3IgPT09IGZhbHNlIHx8IHR5cGVvZiBzZWxlY3RvciA9PT0gImZ1bmN0aW9uIiApIHsKCgkJCQkvLyAoIHR5cGVzIFssIGZuXSApCgkJCQlmbiA9IHNlbGVjdG9yOwoJCQkJc2VsZWN0b3IgPSB1bmRlZmluZWQ7CgkJCX0KCQkJaWYgKCBmbiA9PT0gZmFsc2UgKSB7CgkJCQlmbiA9IHJldHVybkZhbHNlOwoJCQl9CgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJalF1ZXJ5LmV2ZW50LnJlbW92ZSggdGhpcywgdHlwZXMsIGZuLCBzZWxlY3RvciApOwoJCQl9ICk7CgkJfSwKCgkJdHJpZ2dlcjogZnVuY3Rpb24oIHR5cGUsIGRhdGEgKSB7CgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJalF1ZXJ5LmV2ZW50LnRyaWdnZXIoIHR5cGUsIGRhdGEsIHRoaXMgKTsKCQkJfSApOwoJCX0sCgkJdHJpZ2dlckhhbmRsZXI6IGZ1bmN0aW9uKCB0eXBlLCBkYXRhICkgewoJCQl2YXIgZWxlbSA9IHRoaXNbIDAgXTsKCQkJaWYgKCBlbGVtICkgewoJCQkJcmV0dXJuIGpRdWVyeS5ldmVudC50cmlnZ2VyKCB0eXBlLCBkYXRhLCBlbGVtLCB0cnVlICk7CgkJCX0KCQl9Cgl9ICk7CgoKCXZhciByaW5saW5lalF1ZXJ5ID0gLyBqUXVlcnlcZCs9Iig/Om51bGx8XGQrKSIvZywKCQlybm9zaGltY2FjaGUgPSBuZXcgUmVnRXhwKCAiPCg/OiIgKyBub2RlTmFtZXMgKyAiKVtcXHMvPl0iLCAiaSIgKSwKCQlyeGh0bWxUYWcgPSAvPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1ldGF8cGFyYW0pKChbXHc6LV0rKVtePl0qKVwvPi9naSwKCgkJLy8gU3VwcG9ydDogSUUgMTAtMTEsIEVkZ2UgMTAyNDArCgkJLy8gSW4gSUUvRWRnZSB1c2luZyByZWdleCBncm91cHMgaGVyZSBjYXVzZXMgc2V2ZXJlIHNsb3dkb3ducy4KCQkvLyBTZWUgaHR0cHM6Ly9jb25uZWN0Lm1pY3Jvc29mdC5jb20vSUUvZmVlZGJhY2svZGV0YWlscy8xNzM2NTEyLwoJCXJub0lubmVyaHRtbCA9IC88c2NyaXB0fDxzdHlsZXw8bGluay9pLAoKCQkvLyBjaGVja2VkPSJjaGVja2VkIiBvciBjaGVja2VkCgkJcmNoZWNrZWQgPSAvY2hlY2tlZFxzKig/OltePV18PVxzKi5jaGVja2VkLikvaSwKCQlyc2NyaXB0VHlwZU1hc2tlZCA9IC9edHJ1ZVwvKC4qKS8sCgkJcmNsZWFuU2NyaXB0ID0gL15ccyo8ISg/OlxbQ0RBVEFcW3wtLSl8KD86XF1cXXwtLSk+XHMqJC9nLAoJCXNhZmVGcmFnbWVudCA9IGNyZWF0ZVNhZmVGcmFnbWVudCggZG9jdW1lbnQgKSwKCQlmcmFnbWVudERpdiA9IHNhZmVGcmFnbWVudC5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKSApOwoKCS8vIFN1cHBvcnQ6IElFPDgKCS8vIE1hbmlwdWxhdGluZyB0YWJsZXMgcmVxdWlyZXMgYSB0Ym9keQoJZnVuY3Rpb24gbWFuaXB1bGF0aW9uVGFyZ2V0KCBlbGVtLCBjb250ZW50ICkgewoJCXJldHVybiBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJ0YWJsZSIgKSAmJgoJCQlqUXVlcnkubm9kZU5hbWUoIGNvbnRlbnQubm9kZVR5cGUgIT09IDExID8gY29udGVudCA6IGNvbnRlbnQuZmlyc3RDaGlsZCwgInRyIiApID8KCgkJCWVsZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJ0Ym9keSIgKVsgMCBdIHx8CgkJCQllbGVtLmFwcGVuZENoaWxkKCBlbGVtLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCggInRib2R5IiApICkgOgoJCQllbGVtOwoJfQoKCS8vIFJlcGxhY2UvcmVzdG9yZSB0aGUgdHlwZSBhdHRyaWJ1dGUgb2Ygc2NyaXB0IGVsZW1lbnRzIGZvciBzYWZlIERPTSBtYW5pcHVsYXRpb24KCWZ1bmN0aW9uIGRpc2FibGVTY3JpcHQoIGVsZW0gKSB7CgkJZWxlbS50eXBlID0gKCBqUXVlcnkuZmluZC5hdHRyKCBlbGVtLCAidHlwZSIgKSAhPT0gbnVsbCApICsgIi8iICsgZWxlbS50eXBlOwoJCXJldHVybiBlbGVtOwoJfQoJZnVuY3Rpb24gcmVzdG9yZVNjcmlwdCggZWxlbSApIHsKCQl2YXIgbWF0Y2ggPSByc2NyaXB0VHlwZU1hc2tlZC5leGVjKCBlbGVtLnR5cGUgKTsKCQlpZiAoIG1hdGNoICkgewoJCQllbGVtLnR5cGUgPSBtYXRjaFsgMSBdOwoJCX0gZWxzZSB7CgkJCWVsZW0ucmVtb3ZlQXR0cmlidXRlKCAidHlwZSIgKTsKCQl9CgkJcmV0dXJuIGVsZW07Cgl9CgoJZnVuY3Rpb24gY2xvbmVDb3B5RXZlbnQoIHNyYywgZGVzdCApIHsKCQlpZiAoIGRlc3Qubm9kZVR5cGUgIT09IDEgfHwgIWpRdWVyeS5oYXNEYXRhKCBzcmMgKSApIHsKCQkJcmV0dXJuOwoJCX0KCgkJdmFyIHR5cGUsIGksIGwsCgkJCW9sZERhdGEgPSBqUXVlcnkuX2RhdGEoIHNyYyApLAoJCQljdXJEYXRhID0galF1ZXJ5Ll9kYXRhKCBkZXN0LCBvbGREYXRhICksCgkJCWV2ZW50cyA9IG9sZERhdGEuZXZlbnRzOwoKCQlpZiAoIGV2ZW50cyApIHsKCQkJZGVsZXRlIGN1ckRhdGEuaGFuZGxlOwoJCQljdXJEYXRhLmV2ZW50cyA9IHt9OwoKCQkJZm9yICggdHlwZSBpbiBldmVudHMgKSB7CgkJCQlmb3IgKCBpID0gMCwgbCA9IGV2ZW50c1sgdHlwZSBdLmxlbmd0aDsgaSA8IGw7IGkrKyApIHsKCQkJCQlqUXVlcnkuZXZlbnQuYWRkKCBkZXN0LCB0eXBlLCBldmVudHNbIHR5cGUgXVsgaSBdICk7CgkJCQl9CgkJCX0KCQl9CgoJCS8vIG1ha2UgdGhlIGNsb25lZCBwdWJsaWMgZGF0YSBvYmplY3QgYSBjb3B5IGZyb20gdGhlIG9yaWdpbmFsCgkJaWYgKCBjdXJEYXRhLmRhdGEgKSB7CgkJCWN1ckRhdGEuZGF0YSA9IGpRdWVyeS5leHRlbmQoIHt9LCBjdXJEYXRhLmRhdGEgKTsKCQl9Cgl9CgoJZnVuY3Rpb24gZml4Q2xvbmVOb2RlSXNzdWVzKCBzcmMsIGRlc3QgKSB7CgkJdmFyIG5vZGVOYW1lLCBlLCBkYXRhOwoKCQkvLyBXZSBkbyBub3QgbmVlZCB0byBkbyBhbnl0aGluZyBmb3Igbm9uLUVsZW1lbnRzCgkJaWYgKCBkZXN0Lm5vZGVUeXBlICE9PSAxICkgewoJCQlyZXR1cm47CgkJfQoKCQlub2RlTmFtZSA9IGRlc3Qubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCgkJLy8gSUU2LTggY29waWVzIGV2ZW50cyBib3VuZCB2aWEgYXR0YWNoRXZlbnQgd2hlbiB1c2luZyBjbG9uZU5vZGUuCgkJaWYgKCAhc3VwcG9ydC5ub0Nsb25lRXZlbnQgJiYgZGVzdFsgalF1ZXJ5LmV4cGFuZG8gXSApIHsKCQkJZGF0YSA9IGpRdWVyeS5fZGF0YSggZGVzdCApOwoKCQkJZm9yICggZSBpbiBkYXRhLmV2ZW50cyApIHsKCQkJCWpRdWVyeS5yZW1vdmVFdmVudCggZGVzdCwgZSwgZGF0YS5oYW5kbGUgKTsKCQkJfQoKCQkJLy8gRXZlbnQgZGF0YSBnZXRzIHJlZmVyZW5jZWQgaW5zdGVhZCBvZiBjb3BpZWQgaWYgdGhlIGV4cGFuZG8gZ2V0cyBjb3BpZWQgdG9vCgkJCWRlc3QucmVtb3ZlQXR0cmlidXRlKCBqUXVlcnkuZXhwYW5kbyApOwoJCX0KCgkJLy8gSUUgYmxhbmtzIGNvbnRlbnRzIHdoZW4gY2xvbmluZyBzY3JpcHRzLCBhbmQgdHJpZXMgdG8gZXZhbHVhdGUgbmV3bHktc2V0IHRleHQKCQlpZiAoIG5vZGVOYW1lID09PSAic2NyaXB0IiAmJiBkZXN0LnRleHQgIT09IHNyYy50ZXh0ICkgewoJCQlkaXNhYmxlU2NyaXB0KCBkZXN0ICkudGV4dCA9IHNyYy50ZXh0OwoJCQlyZXN0b3JlU2NyaXB0KCBkZXN0ICk7CgoJCS8vIElFNi0xMCBpbXByb3Blcmx5IGNsb25lcyBjaGlsZHJlbiBvZiBvYmplY3QgZWxlbWVudHMgdXNpbmcgY2xhc3NpZC4KCQkvLyBJRTEwIHRocm93cyBOb01vZGlmaWNhdGlvbkFsbG93ZWRFcnJvciBpZiBwYXJlbnQgaXMgbnVsbCwgIzEyMTMyLgoJCX0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSAib2JqZWN0IiApIHsKCQkJaWYgKCBkZXN0LnBhcmVudE5vZGUgKSB7CgkJCQlkZXN0Lm91dGVySFRNTCA9IHNyYy5vdXRlckhUTUw7CgkJCX0KCgkJCS8vIFRoaXMgcGF0aCBhcHBlYXJzIHVuYXZvaWRhYmxlIGZvciBJRTkuIFdoZW4gY2xvbmluZyBhbiBvYmplY3QKCQkJLy8gZWxlbWVudCBpbiBJRTksIHRoZSBvdXRlckhUTUwgc3RyYXRlZ3kgYWJvdmUgaXMgbm90IHN1ZmZpY2llbnQuCgkJCS8vIElmIHRoZSBzcmMgaGFzIGlubmVySFRNTCBhbmQgdGhlIGRlc3RpbmF0aW9uIGRvZXMgbm90LAoJCQkvLyBjb3B5IHRoZSBzcmMuaW5uZXJIVE1MIGludG8gdGhlIGRlc3QuaW5uZXJIVE1MLiAjMTAzMjQKCQkJaWYgKCBzdXBwb3J0Lmh0bWw1Q2xvbmUgJiYgKCBzcmMuaW5uZXJIVE1MICYmICFqUXVlcnkudHJpbSggZGVzdC5pbm5lckhUTUwgKSApICkgewoJCQkJZGVzdC5pbm5lckhUTUwgPSBzcmMuaW5uZXJIVE1MOwoJCQl9CgoJCX0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSAiaW5wdXQiICYmIHJjaGVja2FibGVUeXBlLnRlc3QoIHNyYy50eXBlICkgKSB7CgoJCQkvLyBJRTYtOCBmYWlscyB0byBwZXJzaXN0IHRoZSBjaGVja2VkIHN0YXRlIG9mIGEgY2xvbmVkIGNoZWNrYm94CgkJCS8vIG9yIHJhZGlvIGJ1dHRvbi4gV29yc2UsIElFNi03IGZhaWwgdG8gZ2l2ZSB0aGUgY2xvbmVkIGVsZW1lbnQKCQkJLy8gYSBjaGVja2VkIGFwcGVhcmFuY2UgaWYgdGhlIGRlZmF1bHRDaGVja2VkIHZhbHVlIGlzbid0IGFsc28gc2V0CgoJCQlkZXN0LmRlZmF1bHRDaGVja2VkID0gZGVzdC5jaGVja2VkID0gc3JjLmNoZWNrZWQ7CgoJCQkvLyBJRTYtNyBnZXQgY29uZnVzZWQgYW5kIGVuZCB1cCBzZXR0aW5nIHRoZSB2YWx1ZSBvZiBhIGNsb25lZAoJCQkvLyBjaGVja2JveC9yYWRpbyBidXR0b24gdG8gYW4gZW1wdHkgc3RyaW5nIGluc3RlYWQgb2YgIm9uIgoJCQlpZiAoIGRlc3QudmFsdWUgIT09IHNyYy52YWx1ZSApIHsKCQkJCWRlc3QudmFsdWUgPSBzcmMudmFsdWU7CgkJCX0KCgkJLy8gSUU2LTggZmFpbHMgdG8gcmV0dXJuIHRoZSBzZWxlY3RlZCBvcHRpb24gdG8gdGhlIGRlZmF1bHQgc2VsZWN0ZWQKCQkvLyBzdGF0ZSB3aGVuIGNsb25pbmcgb3B0aW9ucwoJCX0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSAib3B0aW9uIiApIHsKCQkJZGVzdC5kZWZhdWx0U2VsZWN0ZWQgPSBkZXN0LnNlbGVjdGVkID0gc3JjLmRlZmF1bHRTZWxlY3RlZDsKCgkJLy8gSUU2LTggZmFpbHMgdG8gc2V0IHRoZSBkZWZhdWx0VmFsdWUgdG8gdGhlIGNvcnJlY3QgdmFsdWUgd2hlbgoJCS8vIGNsb25pbmcgb3RoZXIgdHlwZXMgb2YgaW5wdXQgZmllbGRzCgkJfSBlbHNlIGlmICggbm9kZU5hbWUgPT09ICJpbnB1dCIgfHwgbm9kZU5hbWUgPT09ICJ0ZXh0YXJlYSIgKSB7CgkJCWRlc3QuZGVmYXVsdFZhbHVlID0gc3JjLmRlZmF1bHRWYWx1ZTsKCQl9Cgl9CgoJZnVuY3Rpb24gZG9tTWFuaXAoIGNvbGxlY3Rpb24sIGFyZ3MsIGNhbGxiYWNrLCBpZ25vcmVkICkgewoKCQkvLyBGbGF0dGVuIGFueSBuZXN0ZWQgYXJyYXlzCgkJYXJncyA9IGNvbmNhdC5hcHBseSggW10sIGFyZ3MgKTsKCgkJdmFyIGZpcnN0LCBub2RlLCBoYXNTY3JpcHRzLAoJCQlzY3JpcHRzLCBkb2MsIGZyYWdtZW50LAoJCQlpID0gMCwKCQkJbCA9IGNvbGxlY3Rpb24ubGVuZ3RoLAoJCQlpTm9DbG9uZSA9IGwgLSAxLAoJCQl2YWx1ZSA9IGFyZ3NbIDAgXSwKCQkJaXNGdW5jdGlvbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApOwoKCQkvLyBXZSBjYW4ndCBjbG9uZU5vZGUgZnJhZ21lbnRzIHRoYXQgY29udGFpbiBjaGVja2VkLCBpbiBXZWJLaXQKCQlpZiAoIGlzRnVuY3Rpb24gfHwKCQkJCSggbCA+IDEgJiYgdHlwZW9mIHZhbHVlID09PSAic3RyaW5nIiAmJgoJCQkJCSFzdXBwb3J0LmNoZWNrQ2xvbmUgJiYgcmNoZWNrZWQudGVzdCggdmFsdWUgKSApICkgewoJCQlyZXR1cm4gY29sbGVjdGlvbi5lYWNoKCBmdW5jdGlvbiggaW5kZXggKSB7CgkJCQl2YXIgc2VsZiA9IGNvbGxlY3Rpb24uZXEoIGluZGV4ICk7CgkJCQlpZiAoIGlzRnVuY3Rpb24gKSB7CgkJCQkJYXJnc1sgMCBdID0gdmFsdWUuY2FsbCggdGhpcywgaW5kZXgsIHNlbGYuaHRtbCgpICk7CgkJCQl9CgkJCQlkb21NYW5pcCggc2VsZiwgYXJncywgY2FsbGJhY2ssIGlnbm9yZWQgKTsKCQkJfSApOwoJCX0KCgkJaWYgKCBsICkgewoJCQlmcmFnbWVudCA9IGJ1aWxkRnJhZ21lbnQoIGFyZ3MsIGNvbGxlY3Rpb25bIDAgXS5vd25lckRvY3VtZW50LCBmYWxzZSwgY29sbGVjdGlvbiwgaWdub3JlZCApOwoJCQlmaXJzdCA9IGZyYWdtZW50LmZpcnN0Q2hpbGQ7CgoJCQlpZiAoIGZyYWdtZW50LmNoaWxkTm9kZXMubGVuZ3RoID09PSAxICkgewoJCQkJZnJhZ21lbnQgPSBmaXJzdDsKCQkJfQoKCQkJLy8gUmVxdWlyZSBlaXRoZXIgbmV3IGNvbnRlbnQgb3IgYW4gaW50ZXJlc3QgaW4gaWdub3JlZCBlbGVtZW50cyB0byBpbnZva2UgdGhlIGNhbGxiYWNrCgkJCWlmICggZmlyc3QgfHwgaWdub3JlZCApIHsKCQkJCXNjcmlwdHMgPSBqUXVlcnkubWFwKCBnZXRBbGwoIGZyYWdtZW50LCAic2NyaXB0IiApLCBkaXNhYmxlU2NyaXB0ICk7CgkJCQloYXNTY3JpcHRzID0gc2NyaXB0cy5sZW5ndGg7CgoJCQkJLy8gVXNlIHRoZSBvcmlnaW5hbCBmcmFnbWVudCBmb3IgdGhlIGxhc3QgaXRlbQoJCQkJLy8gaW5zdGVhZCBvZiB0aGUgZmlyc3QgYmVjYXVzZSBpdCBjYW4gZW5kIHVwCgkJCQkvLyBiZWluZyBlbXB0aWVkIGluY29ycmVjdGx5IGluIGNlcnRhaW4gc2l0dWF0aW9ucyAoIzgwNzApLgoJCQkJZm9yICggOyBpIDwgbDsgaSsrICkgewoJCQkJCW5vZGUgPSBmcmFnbWVudDsKCgkJCQkJaWYgKCBpICE9PSBpTm9DbG9uZSApIHsKCQkJCQkJbm9kZSA9IGpRdWVyeS5jbG9uZSggbm9kZSwgdHJ1ZSwgdHJ1ZSApOwoKCQkJCQkJLy8gS2VlcCByZWZlcmVuY2VzIHRvIGNsb25lZCBzY3JpcHRzIGZvciBsYXRlciByZXN0b3JhdGlvbgoJCQkJCQlpZiAoIGhhc1NjcmlwdHMgKSB7CgoJCQkJCQkJLy8gU3VwcG9ydDogQW5kcm9pZDw0LjEsIFBoYW50b21KUzwyCgkJCQkJCQkvLyBwdXNoLmFwcGx5KF8sIGFycmF5bGlrZSkgdGhyb3dzIG9uIGFuY2llbnQgV2ViS2l0CgkJCQkJCQlqUXVlcnkubWVyZ2UoIHNjcmlwdHMsIGdldEFsbCggbm9kZSwgInNjcmlwdCIgKSApOwoJCQkJCQl9CgkJCQkJfQoKCQkJCQljYWxsYmFjay5jYWxsKCBjb2xsZWN0aW9uWyBpIF0sIG5vZGUsIGkgKTsKCQkJCX0KCgkJCQlpZiAoIGhhc1NjcmlwdHMgKSB7CgkJCQkJZG9jID0gc2NyaXB0c1sgc2NyaXB0cy5sZW5ndGggLSAxIF0ub3duZXJEb2N1bWVudDsKCgkJCQkJLy8gUmVlbmFibGUgc2NyaXB0cwoJCQkJCWpRdWVyeS5tYXAoIHNjcmlwdHMsIHJlc3RvcmVTY3JpcHQgKTsKCgkJCQkJLy8gRXZhbHVhdGUgZXhlY3V0YWJsZSBzY3JpcHRzIG9uIGZpcnN0IGRvY3VtZW50IGluc2VydGlvbgoJCQkJCWZvciAoIGkgPSAwOyBpIDwgaGFzU2NyaXB0czsgaSsrICkgewoJCQkJCQlub2RlID0gc2NyaXB0c1sgaSBdOwoJCQkJCQlpZiAoIHJzY3JpcHRUeXBlLnRlc3QoIG5vZGUudHlwZSB8fCAiIiApICYmCgkJCQkJCQkhalF1ZXJ5Ll9kYXRhKCBub2RlLCAiZ2xvYmFsRXZhbCIgKSAmJgoJCQkJCQkJalF1ZXJ5LmNvbnRhaW5zKCBkb2MsIG5vZGUgKSApIHsKCgkJCQkJCQlpZiAoIG5vZGUuc3JjICkgewoKCQkJCQkJCQkvLyBPcHRpb25hbCBBSkFYIGRlcGVuZGVuY3ksIGJ1dCB3b24ndCBydW4gc2NyaXB0cyBpZiBub3QgcHJlc2VudAoJCQkJCQkJCWlmICggalF1ZXJ5Ll9ldmFsVXJsICkgewoJCQkJCQkJCQlqUXVlcnkuX2V2YWxVcmwoIG5vZGUuc3JjICk7CgkJCQkJCQkJfQoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQlqUXVlcnkuZ2xvYmFsRXZhbCgKCQkJCQkJCQkJKCBub2RlLnRleHQgfHwgbm9kZS50ZXh0Q29udGVudCB8fCBub2RlLmlubmVySFRNTCB8fCAiIiApCgkJCQkJCQkJCQkucmVwbGFjZSggcmNsZWFuU2NyaXB0LCAiIiApCgkJCQkJCQkJKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0KCgkJCQkvLyBGaXggIzExODA5OiBBdm9pZCBsZWFraW5nIG1lbW9yeQoJCQkJZnJhZ21lbnQgPSBmaXJzdCA9IG51bGw7CgkJCX0KCQl9CgoJCXJldHVybiBjb2xsZWN0aW9uOwoJfQoKCWZ1bmN0aW9uIHJlbW92ZSggZWxlbSwgc2VsZWN0b3IsIGtlZXBEYXRhICkgewoJCXZhciBub2RlLAoJCQllbGVtcyA9IHNlbGVjdG9yID8galF1ZXJ5LmZpbHRlciggc2VsZWN0b3IsIGVsZW0gKSA6IGVsZW0sCgkJCWkgPSAwOwoKCQlmb3IgKCA7ICggbm9kZSA9IGVsZW1zWyBpIF0gKSAhPSBudWxsOyBpKysgKSB7CgoJCQlpZiAoICFrZWVwRGF0YSAmJiBub2RlLm5vZGVUeXBlID09PSAxICkgewoJCQkJalF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCBub2RlICkgKTsKCQkJfQoKCQkJaWYgKCBub2RlLnBhcmVudE5vZGUgKSB7CgkJCQlpZiAoIGtlZXBEYXRhICYmIGpRdWVyeS5jb250YWlucyggbm9kZS5vd25lckRvY3VtZW50LCBub2RlICkgKSB7CgkJCQkJc2V0R2xvYmFsRXZhbCggZ2V0QWxsKCBub2RlLCAic2NyaXB0IiApICk7CgkJCQl9CgkJCQlub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIG5vZGUgKTsKCQkJfQoJCX0KCgkJcmV0dXJuIGVsZW07Cgl9CgoJalF1ZXJ5LmV4dGVuZCggewoJCWh0bWxQcmVmaWx0ZXI6IGZ1bmN0aW9uKCBodG1sICkgewoJCQlyZXR1cm4gaHRtbC5yZXBsYWNlKCByeGh0bWxUYWcsICI8JDE+PC8kMj4iICk7CgkJfSwKCgkJY2xvbmU6IGZ1bmN0aW9uKCBlbGVtLCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cyApIHsKCQkJdmFyIGRlc3RFbGVtZW50cywgbm9kZSwgY2xvbmUsIGksIHNyY0VsZW1lbnRzLAoJCQkJaW5QYWdlID0galF1ZXJ5LmNvbnRhaW5zKCBlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0gKTsKCgkJCWlmICggc3VwcG9ydC5odG1sNUNsb25lIHx8IGpRdWVyeS5pc1hNTERvYyggZWxlbSApIHx8CgkJCQkhcm5vc2hpbWNhY2hlLnRlc3QoICI8IiArIGVsZW0ubm9kZU5hbWUgKyAiPiIgKSApIHsKCgkJCQljbG9uZSA9IGVsZW0uY2xvbmVOb2RlKCB0cnVlICk7CgoJCQkvLyBJRTw9OCBkb2VzIG5vdCBwcm9wZXJseSBjbG9uZSBkZXRhY2hlZCwgdW5rbm93biBlbGVtZW50IG5vZGVzCgkJCX0gZWxzZSB7CgkJCQlmcmFnbWVudERpdi5pbm5lckhUTUwgPSBlbGVtLm91dGVySFRNTDsKCQkJCWZyYWdtZW50RGl2LnJlbW92ZUNoaWxkKCBjbG9uZSA9IGZyYWdtZW50RGl2LmZpcnN0Q2hpbGQgKTsKCQkJfQoKCQkJaWYgKCAoICFzdXBwb3J0Lm5vQ2xvbmVFdmVudCB8fCAhc3VwcG9ydC5ub0Nsb25lQ2hlY2tlZCApICYmCgkJCQkJKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGVsZW0ubm9kZVR5cGUgPT09IDExICkgJiYgIWpRdWVyeS5pc1hNTERvYyggZWxlbSApICkgewoKCQkJCS8vIFdlIGVzY2hldyBTaXp6bGUgaGVyZSBmb3IgcGVyZm9ybWFuY2UgcmVhc29uczogaHR0cDovL2pzcGVyZi5jb20vZ2V0YWxsLXZzLXNpenpsZS8yCgkJCQlkZXN0RWxlbWVudHMgPSBnZXRBbGwoIGNsb25lICk7CgkJCQlzcmNFbGVtZW50cyA9IGdldEFsbCggZWxlbSApOwoKCQkJCS8vIEZpeCBhbGwgSUUgY2xvbmluZyBpc3N1ZXMKCQkJCWZvciAoIGkgPSAwOyAoIG5vZGUgPSBzcmNFbGVtZW50c1sgaSBdICkgIT0gbnVsbDsgKytpICkgewoKCQkJCQkvLyBFbnN1cmUgdGhhdCB0aGUgZGVzdGluYXRpb24gbm9kZSBpcyBub3QgbnVsbDsgRml4ZXMgIzk1ODcKCQkJCQlpZiAoIGRlc3RFbGVtZW50c1sgaSBdICkgewoJCQkJCQlmaXhDbG9uZU5vZGVJc3N1ZXMoIG5vZGUsIGRlc3RFbGVtZW50c1sgaSBdICk7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBDb3B5IHRoZSBldmVudHMgZnJvbSB0aGUgb3JpZ2luYWwgdG8gdGhlIGNsb25lCgkJCWlmICggZGF0YUFuZEV2ZW50cyApIHsKCQkJCWlmICggZGVlcERhdGFBbmRFdmVudHMgKSB7CgkJCQkJc3JjRWxlbWVudHMgPSBzcmNFbGVtZW50cyB8fCBnZXRBbGwoIGVsZW0gKTsKCQkJCQlkZXN0RWxlbWVudHMgPSBkZXN0RWxlbWVudHMgfHwgZ2V0QWxsKCBjbG9uZSApOwoKCQkJCQlmb3IgKCBpID0gMDsgKCBub2RlID0gc3JjRWxlbWVudHNbIGkgXSApICE9IG51bGw7IGkrKyApIHsKCQkJCQkJY2xvbmVDb3B5RXZlbnQoIG5vZGUsIGRlc3RFbGVtZW50c1sgaSBdICk7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQljbG9uZUNvcHlFdmVudCggZWxlbSwgY2xvbmUgKTsKCQkJCX0KCQkJfQoKCQkJLy8gUHJlc2VydmUgc2NyaXB0IGV2YWx1YXRpb24gaGlzdG9yeQoJCQlkZXN0RWxlbWVudHMgPSBnZXRBbGwoIGNsb25lLCAic2NyaXB0IiApOwoJCQlpZiAoIGRlc3RFbGVtZW50cy5sZW5ndGggPiAwICkgewoJCQkJc2V0R2xvYmFsRXZhbCggZGVzdEVsZW1lbnRzLCAhaW5QYWdlICYmIGdldEFsbCggZWxlbSwgInNjcmlwdCIgKSApOwoJCQl9CgoJCQlkZXN0RWxlbWVudHMgPSBzcmNFbGVtZW50cyA9IG5vZGUgPSBudWxsOwoKCQkJLy8gUmV0dXJuIHRoZSBjbG9uZWQgc2V0CgkJCXJldHVybiBjbG9uZTsKCQl9LAoKCQljbGVhbkRhdGE6IGZ1bmN0aW9uKCBlbGVtcywgLyogaW50ZXJuYWwgKi8gZm9yY2VBY2NlcHREYXRhICkgewoJCQl2YXIgZWxlbSwgdHlwZSwgaWQsIGRhdGEsCgkJCQlpID0gMCwKCQkJCWludGVybmFsS2V5ID0galF1ZXJ5LmV4cGFuZG8sCgkJCQljYWNoZSA9IGpRdWVyeS5jYWNoZSwKCQkJCWF0dHJpYnV0ZXMgPSBzdXBwb3J0LmF0dHJpYnV0ZXMsCgkJCQlzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWw7CgoJCQlmb3IgKCA7ICggZWxlbSA9IGVsZW1zWyBpIF0gKSAhPSBudWxsOyBpKysgKSB7CgkJCQlpZiAoIGZvcmNlQWNjZXB0RGF0YSB8fCBhY2NlcHREYXRhKCBlbGVtICkgKSB7CgoJCQkJCWlkID0gZWxlbVsgaW50ZXJuYWxLZXkgXTsKCQkJCQlkYXRhID0gaWQgJiYgY2FjaGVbIGlkIF07CgoJCQkJCWlmICggZGF0YSApIHsKCQkJCQkJaWYgKCBkYXRhLmV2ZW50cyApIHsKCQkJCQkJCWZvciAoIHR5cGUgaW4gZGF0YS5ldmVudHMgKSB7CgkJCQkJCQkJaWYgKCBzcGVjaWFsWyB0eXBlIF0gKSB7CgkJCQkJCQkJCWpRdWVyeS5ldmVudC5yZW1vdmUoIGVsZW0sIHR5cGUgKTsKCgkJCQkJCQkJLy8gVGhpcyBpcyBhIHNob3J0Y3V0IHRvIGF2b2lkIGpRdWVyeS5ldmVudC5yZW1vdmUncyBvdmVyaGVhZAoJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCWpRdWVyeS5yZW1vdmVFdmVudCggZWxlbSwgdHlwZSwgZGF0YS5oYW5kbGUgKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCS8vIFJlbW92ZSBjYWNoZSBvbmx5IGlmIGl0IHdhcyBub3QgYWxyZWFkeSByZW1vdmVkIGJ5IGpRdWVyeS5ldmVudC5yZW1vdmUKCQkJCQkJaWYgKCBjYWNoZVsgaWQgXSApIHsKCgkJCQkJCQlkZWxldGUgY2FjaGVbIGlkIF07CgoJCQkJCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkJCQkJLy8gSUUgZG9lcyBub3QgYWxsb3cgdXMgdG8gZGVsZXRlIGV4cGFuZG8gcHJvcGVydGllcyBmcm9tIG5vZGVzCgkJCQkJCQkvLyBJRSBjcmVhdGVzIGV4cGFuZG8gYXR0cmlidXRlcyBhbG9uZyB3aXRoIHRoZSBwcm9wZXJ0eQoJCQkJCQkJLy8gSUUgZG9lcyBub3QgaGF2ZSBhIHJlbW92ZUF0dHJpYnV0ZSBmdW5jdGlvbiBvbiBEb2N1bWVudCBub2RlcwoJCQkJCQkJaWYgKCAhYXR0cmlidXRlcyAmJiB0eXBlb2YgZWxlbS5yZW1vdmVBdHRyaWJ1dGUgIT09ICJ1bmRlZmluZWQiICkgewoJCQkJCQkJCWVsZW0ucmVtb3ZlQXR0cmlidXRlKCBpbnRlcm5hbEtleSApOwoKCQkJCQkJCS8vIFdlYmtpdCAmIEJsaW5rIHBlcmZvcm1hbmNlIHN1ZmZlcnMgd2hlbiBkZWxldGluZyBwcm9wZXJ0aWVzCgkJCQkJCQkvLyBmcm9tIERPTSBub2Rlcywgc28gc2V0IHRvIHVuZGVmaW5lZCBpbnN0ZWFkCgkJCQkJCQkvLyBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9Mzc4NjA3CgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCWVsZW1bIGludGVybmFsS2V5IF0gPSB1bmRlZmluZWQ7CgkJCQkJCQl9CgoJCQkJCQkJZGVsZXRlZElkcy5wdXNoKCBpZCApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJfSApOwoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCgkJLy8gS2VlcCBkb21NYW5pcCBleHBvc2VkIHVudGlsIDMuMCAoZ2gtMjIyNSkKCQlkb21NYW5pcDogZG9tTWFuaXAsCgoJCWRldGFjaDogZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCQlyZXR1cm4gcmVtb3ZlKCB0aGlzLCBzZWxlY3RvciwgdHJ1ZSApOwoJCX0sCgoJCXJlbW92ZTogZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCQlyZXR1cm4gcmVtb3ZlKCB0aGlzLCBzZWxlY3RvciApOwoJCX0sCgoJCXRleHQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJcmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIHZhbHVlICkgewoJCQkJcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQgPwoJCQkJCWpRdWVyeS50ZXh0KCB0aGlzICkgOgoJCQkJCXRoaXMuZW1wdHkoKS5hcHBlbmQoCgkJCQkJCSggdGhpc1sgMCBdICYmIHRoaXNbIDAgXS5vd25lckRvY3VtZW50IHx8IGRvY3VtZW50ICkuY3JlYXRlVGV4dE5vZGUoIHZhbHVlICkKCQkJCQkpOwoJCQl9LCBudWxsLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCApOwoJCX0sCgoJCWFwcGVuZDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiBkb21NYW5pcCggdGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJCWlmICggdGhpcy5ub2RlVHlwZSA9PT0gMSB8fCB0aGlzLm5vZGVUeXBlID09PSAxMSB8fCB0aGlzLm5vZGVUeXBlID09PSA5ICkgewoJCQkJCXZhciB0YXJnZXQgPSBtYW5pcHVsYXRpb25UYXJnZXQoIHRoaXMsIGVsZW0gKTsKCQkJCQl0YXJnZXQuYXBwZW5kQ2hpbGQoIGVsZW0gKTsKCQkJCX0KCQkJfSApOwoJCX0sCgoJCXByZXBlbmQ6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gZG9tTWFuaXAoIHRoaXMsIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlpZiAoIHRoaXMubm9kZVR5cGUgPT09IDEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gMTEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gOSApIHsKCQkJCQl2YXIgdGFyZ2V0ID0gbWFuaXB1bGF0aW9uVGFyZ2V0KCB0aGlzLCBlbGVtICk7CgkJCQkJdGFyZ2V0Lmluc2VydEJlZm9yZSggZWxlbSwgdGFyZ2V0LmZpcnN0Q2hpbGQgKTsKCQkJCX0KCQkJfSApOwoJCX0sCgoJCWJlZm9yZTogZnVuY3Rpb24oKSB7CgkJCXJldHVybiBkb21NYW5pcCggdGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJCWlmICggdGhpcy5wYXJlbnROb2RlICkgewoJCQkJCXRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoIGVsZW0sIHRoaXMgKTsKCQkJCX0KCQkJfSApOwoJCX0sCgoJCWFmdGVyOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIGRvbU1hbmlwKCB0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJaWYgKCB0aGlzLnBhcmVudE5vZGUgKSB7CgkJCQkJdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZSggZWxlbSwgdGhpcy5uZXh0U2libGluZyApOwoJCQkJfQoJCQl9ICk7CgkJfSwKCgkJZW1wdHk6IGZ1bmN0aW9uKCkgewoJCQl2YXIgZWxlbSwKCQkJCWkgPSAwOwoKCQkJZm9yICggOyAoIGVsZW0gPSB0aGlzWyBpIF0gKSAhPSBudWxsOyBpKysgKSB7CgoJCQkJLy8gUmVtb3ZlIGVsZW1lbnQgbm9kZXMgYW5kIHByZXZlbnQgbWVtb3J5IGxlYWtzCgkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJalF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCBlbGVtLCBmYWxzZSApICk7CgkJCQl9CgoJCQkJLy8gUmVtb3ZlIGFueSByZW1haW5pbmcgbm9kZXMKCQkJCXdoaWxlICggZWxlbS5maXJzdENoaWxkICkgewoJCQkJCWVsZW0ucmVtb3ZlQ2hpbGQoIGVsZW0uZmlyc3RDaGlsZCApOwoJCQkJfQoKCQkJCS8vIElmIHRoaXMgaXMgYSBzZWxlY3QsIGVuc3VyZSB0aGF0IGl0IGRpc3BsYXlzIGVtcHR5ICgjMTIzMzYpCgkJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCQlpZiAoIGVsZW0ub3B0aW9ucyAmJiBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJzZWxlY3QiICkgKSB7CgkJCQkJZWxlbS5vcHRpb25zLmxlbmd0aCA9IDA7CgkJCQl9CgkJCX0KCgkJCXJldHVybiB0aGlzOwoJCX0sCgoJCWNsb25lOiBmdW5jdGlvbiggZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMgKSB7CgkJCWRhdGFBbmRFdmVudHMgPSBkYXRhQW5kRXZlbnRzID09IG51bGwgPyBmYWxzZSA6IGRhdGFBbmRFdmVudHM7CgkJCWRlZXBEYXRhQW5kRXZlbnRzID0gZGVlcERhdGFBbmRFdmVudHMgPT0gbnVsbCA/IGRhdGFBbmRFdmVudHMgOiBkZWVwRGF0YUFuZEV2ZW50czsKCgkJCXJldHVybiB0aGlzLm1hcCggZnVuY3Rpb24oKSB7CgkJCQlyZXR1cm4galF1ZXJ5LmNsb25lKCB0aGlzLCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cyApOwoJCQl9ICk7CgkJfSwKCgkJaHRtbDogZnVuY3Rpb24oIHZhbHVlICkgewoJCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggdmFsdWUgKSB7CgkJCQl2YXIgZWxlbSA9IHRoaXNbIDAgXSB8fCB7fSwKCQkJCQlpID0gMCwKCQkJCQlsID0gdGhpcy5sZW5ndGg7CgoJCQkJaWYgKCB2YWx1ZSA9PT0gdW5kZWZpbmVkICkgewoJCQkJCXJldHVybiBlbGVtLm5vZGVUeXBlID09PSAxID8KCQkJCQkJZWxlbS5pbm5lckhUTUwucmVwbGFjZSggcmlubGluZWpRdWVyeSwgIiIgKSA6CgkJCQkJCXVuZGVmaW5lZDsKCQkJCX0KCgkJCQkvLyBTZWUgaWYgd2UgY2FuIHRha2UgYSBzaG9ydGN1dCBhbmQganVzdCB1c2UgaW5uZXJIVE1MCgkJCQlpZiAoIHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYgIXJub0lubmVyaHRtbC50ZXN0KCB2YWx1ZSApICYmCgkJCQkJKCBzdXBwb3J0Lmh0bWxTZXJpYWxpemUgfHwgIXJub3NoaW1jYWNoZS50ZXN0KCB2YWx1ZSApICApICYmCgkJCQkJKCBzdXBwb3J0LmxlYWRpbmdXaGl0ZXNwYWNlIHx8ICFybGVhZGluZ1doaXRlc3BhY2UudGVzdCggdmFsdWUgKSApICYmCgkJCQkJIXdyYXBNYXBbICggcnRhZ05hbWUuZXhlYyggdmFsdWUgKSB8fCBbICIiLCAiIiBdIClbIDEgXS50b0xvd2VyQ2FzZSgpIF0gKSB7CgoJCQkJCXZhbHVlID0galF1ZXJ5Lmh0bWxQcmVmaWx0ZXIoIHZhbHVlICk7CgoJCQkJCXRyeSB7CgkJCQkJCWZvciAoIDsgaSA8IGw7IGkrKyApIHsKCgkJCQkJCQkvLyBSZW1vdmUgZWxlbWVudCBub2RlcyBhbmQgcHJldmVudCBtZW1vcnkgbGVha3MKCQkJCQkJCWVsZW0gPSB0aGlzWyBpIF0gfHwge307CgkJCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJCQkJalF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCBlbGVtLCBmYWxzZSApICk7CgkJCQkJCQkJZWxlbS5pbm5lckhUTUwgPSB2YWx1ZTsKCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJZWxlbSA9IDA7CgoJCQkJCS8vIElmIHVzaW5nIGlubmVySFRNTCB0aHJvd3MgYW4gZXhjZXB0aW9uLCB1c2UgdGhlIGZhbGxiYWNrIG1ldGhvZAoJCQkJCX0gY2F0Y2ggKCBlICkge30KCQkJCX0KCgkJCQlpZiAoIGVsZW0gKSB7CgkJCQkJdGhpcy5lbXB0eSgpLmFwcGVuZCggdmFsdWUgKTsKCQkJCX0KCQkJfSwgbnVsbCwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggKTsKCQl9LAoKCQlyZXBsYWNlV2l0aDogZnVuY3Rpb24oKSB7CgkJCXZhciBpZ25vcmVkID0gW107CgoJCQkvLyBNYWtlIHRoZSBjaGFuZ2VzLCByZXBsYWNpbmcgZWFjaCBub24taWdub3JlZCBjb250ZXh0IGVsZW1lbnQgd2l0aCB0aGUgbmV3IGNvbnRlbnQKCQkJcmV0dXJuIGRvbU1hbmlwKCB0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJdmFyIHBhcmVudCA9IHRoaXMucGFyZW50Tm9kZTsKCgkJCQlpZiAoIGpRdWVyeS5pbkFycmF5KCB0aGlzLCBpZ25vcmVkICkgPCAwICkgewoJCQkJCWpRdWVyeS5jbGVhbkRhdGEoIGdldEFsbCggdGhpcyApICk7CgkJCQkJaWYgKCBwYXJlbnQgKSB7CgkJCQkJCXBhcmVudC5yZXBsYWNlQ2hpbGQoIGVsZW0sIHRoaXMgKTsKCQkJCQl9CgkJCQl9CgoJCQkvLyBGb3JjZSBjYWxsYmFjayBpbnZvY2F0aW9uCgkJCX0sIGlnbm9yZWQgKTsKCQl9Cgl9ICk7CgoJalF1ZXJ5LmVhY2goIHsKCQlhcHBlbmRUbzogImFwcGVuZCIsCgkJcHJlcGVuZFRvOiAicHJlcGVuZCIsCgkJaW5zZXJ0QmVmb3JlOiAiYmVmb3JlIiwKCQlpbnNlcnRBZnRlcjogImFmdGVyIiwKCQlyZXBsYWNlQWxsOiAicmVwbGFjZVdpdGgiCgl9LCBmdW5jdGlvbiggbmFtZSwgb3JpZ2luYWwgKSB7CgkJalF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXZhciBlbGVtcywKCQkJCWkgPSAwLAoJCQkJcmV0ID0gW10sCgkJCQlpbnNlcnQgPSBqUXVlcnkoIHNlbGVjdG9yICksCgkJCQlsYXN0ID0gaW5zZXJ0Lmxlbmd0aCAtIDE7CgoJCQlmb3IgKCA7IGkgPD0gbGFzdDsgaSsrICkgewoJCQkJZWxlbXMgPSBpID09PSBsYXN0ID8gdGhpcyA6IHRoaXMuY2xvbmUoIHRydWUgKTsKCQkJCWpRdWVyeSggaW5zZXJ0WyBpIF0gKVsgb3JpZ2luYWwgXSggZWxlbXMgKTsKCgkJCQkvLyBNb2Rlcm4gYnJvd3NlcnMgY2FuIGFwcGx5IGpRdWVyeSBjb2xsZWN0aW9ucyBhcyBhcnJheXMsIGJ1dCBvbGRJRSBuZWVkcyBhIC5nZXQoKQoJCQkJcHVzaC5hcHBseSggcmV0LCBlbGVtcy5nZXQoKSApOwoJCQl9CgoJCQlyZXR1cm4gdGhpcy5wdXNoU3RhY2soIHJldCApOwoJCX07Cgl9ICk7CgoKCXZhciBpZnJhbWUsCgkJZWxlbWRpc3BsYXkgPSB7CgoJCQkvLyBTdXBwb3J0OiBGaXJlZm94CgkJCS8vIFdlIGhhdmUgdG8gcHJlLWRlZmluZSB0aGVzZSB2YWx1ZXMgZm9yIEZGICgjMTAyMjcpCgkJCUhUTUw6ICJibG9jayIsCgkJCUJPRFk6ICJibG9jayIKCQl9OwoKCS8qKgoJICogUmV0cmlldmUgdGhlIGFjdHVhbCBkaXNwbGF5IG9mIGEgZWxlbWVudAoJICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgbm9kZU5hbWUgb2YgdGhlIGVsZW1lbnQKCSAqIEBwYXJhbSB7T2JqZWN0fSBkb2MgRG9jdW1lbnQgb2JqZWN0CgkgKi8KCgkvLyBDYWxsZWQgb25seSBmcm9tIHdpdGhpbiBkZWZhdWx0RGlzcGxheQoJZnVuY3Rpb24gYWN0dWFsRGlzcGxheSggbmFtZSwgZG9jICkgewoJCXZhciBlbGVtID0galF1ZXJ5KCBkb2MuY3JlYXRlRWxlbWVudCggbmFtZSApICkuYXBwZW5kVG8oIGRvYy5ib2R5ICksCgoJCQlkaXNwbGF5ID0galF1ZXJ5LmNzcyggZWxlbVsgMCBdLCAiZGlzcGxheSIgKTsKCgkJLy8gV2UgZG9uJ3QgaGF2ZSBhbnkgZGF0YSBzdG9yZWQgb24gdGhlIGVsZW1lbnQsCgkJLy8gc28gdXNlICJkZXRhY2giIG1ldGhvZCBhcyBmYXN0IHdheSB0byBnZXQgcmlkIG9mIHRoZSBlbGVtZW50CgkJZWxlbS5kZXRhY2goKTsKCgkJcmV0dXJuIGRpc3BsYXk7Cgl9CgoJLyoqCgkgKiBUcnkgdG8gZGV0ZXJtaW5lIHRoZSBkZWZhdWx0IGRpc3BsYXkgdmFsdWUgb2YgYW4gZWxlbWVudAoJICogQHBhcmFtIHtTdHJpbmd9IG5vZGVOYW1lCgkgKi8KCWZ1bmN0aW9uIGRlZmF1bHREaXNwbGF5KCBub2RlTmFtZSApIHsKCQl2YXIgZG9jID0gZG9jdW1lbnQsCgkJCWRpc3BsYXkgPSBlbGVtZGlzcGxheVsgbm9kZU5hbWUgXTsKCgkJaWYgKCAhZGlzcGxheSApIHsKCQkJZGlzcGxheSA9IGFjdHVhbERpc3BsYXkoIG5vZGVOYW1lLCBkb2MgKTsKCgkJCS8vIElmIHRoZSBzaW1wbGUgd2F5IGZhaWxzLCByZWFkIGZyb20gaW5zaWRlIGFuIGlmcmFtZQoJCQlpZiAoIGRpc3BsYXkgPT09ICJub25lIiB8fCAhZGlzcGxheSApIHsKCgkJCQkvLyBVc2UgdGhlIGFscmVhZHktY3JlYXRlZCBpZnJhbWUgaWYgcG9zc2libGUKCQkJCWlmcmFtZSA9ICggaWZyYW1lIHx8IGpRdWVyeSggIjxpZnJhbWUgZnJhbWVib3JkZXI9JzAnIHdpZHRoPScwJyBoZWlnaHQ9JzAnLz4iICkgKQoJCQkJCS5hcHBlbmRUbyggZG9jLmRvY3VtZW50RWxlbWVudCApOwoKCQkJCS8vIEFsd2F5cyB3cml0ZSBhIG5ldyBIVE1MIHNrZWxldG9uIHNvIFdlYmtpdCBhbmQgRmlyZWZveCBkb24ndCBjaG9rZSBvbiByZXVzZQoJCQkJZG9jID0gKCBpZnJhbWVbIDAgXS5jb250ZW50V2luZG93IHx8IGlmcmFtZVsgMCBdLmNvbnRlbnREb2N1bWVudCApLmRvY3VtZW50OwoKCQkJCS8vIFN1cHBvcnQ6IElFCgkJCQlkb2Mud3JpdGUoKTsKCQkJCWRvYy5jbG9zZSgpOwoKCQkJCWRpc3BsYXkgPSBhY3R1YWxEaXNwbGF5KCBub2RlTmFtZSwgZG9jICk7CgkJCQlpZnJhbWUuZGV0YWNoKCk7CgkJCX0KCgkJCS8vIFN0b3JlIHRoZSBjb3JyZWN0IGRlZmF1bHQgZGlzcGxheQoJCQllbGVtZGlzcGxheVsgbm9kZU5hbWUgXSA9IGRpc3BsYXk7CgkJfQoKCQlyZXR1cm4gZGlzcGxheTsKCX0KCXZhciBybWFyZ2luID0gKCAvXm1hcmdpbi8gKTsKCgl2YXIgcm51bW5vbnB4ID0gbmV3IFJlZ0V4cCggIl4oIiArIHBudW0gKyAiKSg/IXB4KVthLXolXSskIiwgImkiICk7CgoJdmFyIHN3YXAgPSBmdW5jdGlvbiggZWxlbSwgb3B0aW9ucywgY2FsbGJhY2ssIGFyZ3MgKSB7CgkJdmFyIHJldCwgbmFtZSwKCQkJb2xkID0ge307CgoJCS8vIFJlbWVtYmVyIHRoZSBvbGQgdmFsdWVzLCBhbmQgaW5zZXJ0IHRoZSBuZXcgb25lcwoJCWZvciAoIG5hbWUgaW4gb3B0aW9ucyApIHsKCQkJb2xkWyBuYW1lIF0gPSBlbGVtLnN0eWxlWyBuYW1lIF07CgkJCWVsZW0uc3R5bGVbIG5hbWUgXSA9IG9wdGlvbnNbIG5hbWUgXTsKCQl9CgoJCXJldCA9IGNhbGxiYWNrLmFwcGx5KCBlbGVtLCBhcmdzIHx8IFtdICk7CgoJCS8vIFJldmVydCB0aGUgb2xkIHZhbHVlcwoJCWZvciAoIG5hbWUgaW4gb3B0aW9ucyApIHsKCQkJZWxlbS5zdHlsZVsgbmFtZSBdID0gb2xkWyBuYW1lIF07CgkJfQoKCQlyZXR1cm4gcmV0OwoJfTsKCgoJdmFyIGRvY3VtZW50RWxlbWVudCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCgoKCSggZnVuY3Rpb24oKSB7CgkJdmFyIHBpeGVsUG9zaXRpb25WYWwsIHBpeGVsTWFyZ2luUmlnaHRWYWwsIGJveFNpemluZ1JlbGlhYmxlVmFsLAoJCQlyZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwsIHJlbGlhYmxlTWFyZ2luUmlnaHRWYWwsIHJlbGlhYmxlTWFyZ2luTGVmdFZhbCwKCQkJY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKSwKCQkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCgkJLy8gRmluaXNoIGVhcmx5IGluIGxpbWl0ZWQgKG5vbi1icm93c2VyKSBlbnZpcm9ubWVudHMKCQlpZiAoICFkaXYuc3R5bGUgKSB7CgkJCXJldHVybjsKCQl9CgoJCWRpdi5zdHlsZS5jc3NUZXh0ID0gImZsb2F0OmxlZnQ7b3BhY2l0eTouNSI7CgoJCS8vIFN1cHBvcnQ6IElFPDkKCQkvLyBNYWtlIHN1cmUgdGhhdCBlbGVtZW50IG9wYWNpdHkgZXhpc3RzIChhcyBvcHBvc2VkIHRvIGZpbHRlcikKCQlzdXBwb3J0Lm9wYWNpdHkgPSBkaXYuc3R5bGUub3BhY2l0eSA9PT0gIjAuNSI7CgoJCS8vIFZlcmlmeSBzdHlsZSBmbG9hdCBleGlzdGVuY2UKCQkvLyAoSUUgdXNlcyBzdHlsZUZsb2F0IGluc3RlYWQgb2YgY3NzRmxvYXQpCgkJc3VwcG9ydC5jc3NGbG9hdCA9ICEhZGl2LnN0eWxlLmNzc0Zsb2F0OwoKCQlkaXYuc3R5bGUuYmFja2dyb3VuZENsaXAgPSAiY29udGVudC1ib3giOwoJCWRpdi5jbG9uZU5vZGUoIHRydWUgKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9ICIiOwoJCXN1cHBvcnQuY2xlYXJDbG9uZVN0eWxlID0gZGl2LnN0eWxlLmJhY2tncm91bmRDbGlwID09PSAiY29udGVudC1ib3giOwoKCQljb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApOwoJCWNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gImJvcmRlcjowO3dpZHRoOjhweDtoZWlnaHQ6MDt0b3A6MDtsZWZ0Oi05OTk5cHg7IiArCgkJCSJwYWRkaW5nOjA7bWFyZ2luLXRvcDoxcHg7cG9zaXRpb246YWJzb2x1dGUiOwoJCWRpdi5pbm5lckhUTUwgPSAiIjsKCQljb250YWluZXIuYXBwZW5kQ2hpbGQoIGRpdiApOwoKCQkvLyBTdXBwb3J0OiBGaXJlZm94PDI5LCBBbmRyb2lkIDIuMwoJCS8vIFZlbmRvci1wcmVmaXggYm94LXNpemluZwoJCXN1cHBvcnQuYm94U2l6aW5nID0gZGl2LnN0eWxlLmJveFNpemluZyA9PT0gIiIgfHwgZGl2LnN0eWxlLk1vekJveFNpemluZyA9PT0gIiIgfHwKCQkJZGl2LnN0eWxlLldlYmtpdEJveFNpemluZyA9PT0gIiI7CgoJCWpRdWVyeS5leHRlbmQoIHN1cHBvcnQsIHsKCQkJcmVsaWFibGVIaWRkZW5PZmZzZXRzOiBmdW5jdGlvbigpIHsKCQkJCWlmICggcGl4ZWxQb3NpdGlvblZhbCA9PSBudWxsICkgewoJCQkJCWNvbXB1dGVTdHlsZVRlc3RzKCk7CgkJCQl9CgkJCQlyZXR1cm4gcmVsaWFibGVIaWRkZW5PZmZzZXRzVmFsOwoJCQl9LAoKCQkJYm94U2l6aW5nUmVsaWFibGU6IGZ1bmN0aW9uKCkgewoKCQkJCS8vIFdlJ3JlIGNoZWNraW5nIGZvciBwaXhlbFBvc2l0aW9uVmFsIGhlcmUgaW5zdGVhZCBvZiBib3hTaXppbmdSZWxpYWJsZVZhbAoJCQkJLy8gc2luY2UgdGhhdCBjb21wcmVzc2VzIGJldHRlciBhbmQgdGhleSdyZSBjb21wdXRlZCB0b2dldGhlciBhbnl3YXkuCgkJCQlpZiAoIHBpeGVsUG9zaXRpb25WYWwgPT0gbnVsbCApIHsKCQkJCQljb21wdXRlU3R5bGVUZXN0cygpOwoJCQkJfQoJCQkJcmV0dXJuIGJveFNpemluZ1JlbGlhYmxlVmFsOwoJCQl9LAoKCQkJcGl4ZWxNYXJnaW5SaWdodDogZnVuY3Rpb24oKSB7CgoJCQkJLy8gU3VwcG9ydDogQW5kcm9pZCA0LjAtNC4zCgkJCQlpZiAoIHBpeGVsUG9zaXRpb25WYWwgPT0gbnVsbCApIHsKCQkJCQljb21wdXRlU3R5bGVUZXN0cygpOwoJCQkJfQoJCQkJcmV0dXJuIHBpeGVsTWFyZ2luUmlnaHRWYWw7CgkJCX0sCgoJCQlwaXhlbFBvc2l0aW9uOiBmdW5jdGlvbigpIHsKCQkJCWlmICggcGl4ZWxQb3NpdGlvblZhbCA9PSBudWxsICkgewoJCQkJCWNvbXB1dGVTdHlsZVRlc3RzKCk7CgkJCQl9CgkJCQlyZXR1cm4gcGl4ZWxQb3NpdGlvblZhbDsKCQkJfSwKCgkJCXJlbGlhYmxlTWFyZ2luUmlnaHQ6IGZ1bmN0aW9uKCkgewoKCQkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zCgkJCQlpZiAoIHBpeGVsUG9zaXRpb25WYWwgPT0gbnVsbCApIHsKCQkJCQljb21wdXRlU3R5bGVUZXN0cygpOwoJCQkJfQoJCQkJcmV0dXJuIHJlbGlhYmxlTWFyZ2luUmlnaHRWYWw7CgkJCX0sCgoJCQlyZWxpYWJsZU1hcmdpbkxlZnQ6IGZ1bmN0aW9uKCkgewoKCQkJCS8vIFN1cHBvcnQ6IElFIDw9OCBvbmx5LCBBbmRyb2lkIDQuMCAtIDQuMyBvbmx5LCBGaXJlZm94IDw9MyAtIDM3CgkJCQlpZiAoIHBpeGVsUG9zaXRpb25WYWwgPT0gbnVsbCApIHsKCQkJCQljb21wdXRlU3R5bGVUZXN0cygpOwoJCQkJfQoJCQkJcmV0dXJuIHJlbGlhYmxlTWFyZ2luTGVmdFZhbDsKCQkJfQoJCX0gKTsKCgkJZnVuY3Rpb24gY29tcHV0ZVN0eWxlVGVzdHMoKSB7CgkJCXZhciBjb250ZW50cywgZGl2U3R5bGUsCgkJCQlkb2N1bWVudEVsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CgoJCQkvLyBTZXR1cAoJCQlkb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoIGNvbnRhaW5lciApOwoKCQkJZGl2LnN0eWxlLmNzc1RleHQgPQoKCQkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zCgkJCQkvLyBWZW5kb3ItcHJlZml4IGJveC1zaXppbmcKCQkJCSItd2Via2l0LWJveC1zaXppbmc6Ym9yZGVyLWJveDtib3gtc2l6aW5nOmJvcmRlci1ib3g7IiArCgkJCQkicG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpibG9jazsiICsKCQkJCSJtYXJnaW46YXV0bztib3JkZXI6MXB4O3BhZGRpbmc6MXB4OyIgKwoJCQkJInRvcDoxJTt3aWR0aDo1MCUiOwoKCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkvLyBBc3N1bWUgcmVhc29uYWJsZSB2YWx1ZXMgaW4gdGhlIGFic2VuY2Ugb2YgZ2V0Q29tcHV0ZWRTdHlsZQoJCQlwaXhlbFBvc2l0aW9uVmFsID0gYm94U2l6aW5nUmVsaWFibGVWYWwgPSByZWxpYWJsZU1hcmdpbkxlZnRWYWwgPSBmYWxzZTsKCQkJcGl4ZWxNYXJnaW5SaWdodFZhbCA9IHJlbGlhYmxlTWFyZ2luUmlnaHRWYWwgPSB0cnVlOwoKCQkJLy8gQ2hlY2sgZm9yIGdldENvbXB1dGVkU3R5bGUgc28gdGhhdCB0aGlzIGNvZGUgaXMgbm90IHJ1biBpbiBJRTw5LgoJCQlpZiAoIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlICkgewoJCQkJZGl2U3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSggZGl2ICk7CgkJCQlwaXhlbFBvc2l0aW9uVmFsID0gKCBkaXZTdHlsZSB8fCB7fSApLnRvcCAhPT0gIjElIjsKCQkJCXJlbGlhYmxlTWFyZ2luTGVmdFZhbCA9ICggZGl2U3R5bGUgfHwge30gKS5tYXJnaW5MZWZ0ID09PSAiMnB4IjsKCQkJCWJveFNpemluZ1JlbGlhYmxlVmFsID0gKCBkaXZTdHlsZSB8fCB7IHdpZHRoOiAiNHB4IiB9ICkud2lkdGggPT09ICI0cHgiOwoKCQkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQgNC4wIC0gNC4zIG9ubHkKCQkJCS8vIFNvbWUgc3R5bGVzIGNvbWUgYmFjayB3aXRoIHBlcmNlbnRhZ2UgdmFsdWVzLCBldmVuIHRob3VnaCB0aGV5IHNob3VsZG4ndAoJCQkJZGl2LnN0eWxlLm1hcmdpblJpZ2h0ID0gIjUwJSI7CgkJCQlwaXhlbE1hcmdpblJpZ2h0VmFsID0gKCBkaXZTdHlsZSB8fCB7IG1hcmdpblJpZ2h0OiAiNHB4IiB9ICkubWFyZ2luUmlnaHQgPT09ICI0cHgiOwoKCQkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zIG9ubHkKCQkJCS8vIERpdiB3aXRoIGV4cGxpY2l0IHdpZHRoIGFuZCBubyBtYXJnaW4tcmlnaHQgaW5jb3JyZWN0bHkKCQkJCS8vIGdldHMgY29tcHV0ZWQgbWFyZ2luLXJpZ2h0IGJhc2VkIG9uIHdpZHRoIG9mIGNvbnRhaW5lciAoIzMzMzMpCgkJCQkvLyBXZWJLaXQgQnVnIDEzMzQzIC0gZ2V0Q29tcHV0ZWRTdHlsZSByZXR1cm5zIHdyb25nIHZhbHVlIGZvciBtYXJnaW4tcmlnaHQKCQkJCWNvbnRlbnRzID0gZGl2LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApICk7CgoJCQkJLy8gUmVzZXQgQ1NTOiBib3gtc2l6aW5nOyBkaXNwbGF5OyBtYXJnaW47IGJvcmRlcjsgcGFkZGluZwoJCQkJY29udGVudHMuc3R5bGUuY3NzVGV4dCA9IGRpdi5zdHlsZS5jc3NUZXh0ID0KCgkJCQkJLy8gU3VwcG9ydDogQW5kcm9pZCAyLjMKCQkJCQkvLyBWZW5kb3ItcHJlZml4IGJveC1zaXppbmcKCQkJCQkiLXdlYmtpdC1ib3gtc2l6aW5nOmNvbnRlbnQtYm94Oy1tb3otYm94LXNpemluZzpjb250ZW50LWJveDsiICsKCQkJCQkiYm94LXNpemluZzpjb250ZW50LWJveDtkaXNwbGF5OmJsb2NrO21hcmdpbjowO2JvcmRlcjowO3BhZGRpbmc6MCI7CgkJCQljb250ZW50cy5zdHlsZS5tYXJnaW5SaWdodCA9IGNvbnRlbnRzLnN0eWxlLndpZHRoID0gIjAiOwoJCQkJZGl2LnN0eWxlLndpZHRoID0gIjFweCI7CgoJCQkJcmVsaWFibGVNYXJnaW5SaWdodFZhbCA9CgkJCQkJIXBhcnNlRmxvYXQoICggd2luZG93LmdldENvbXB1dGVkU3R5bGUoIGNvbnRlbnRzICkgfHwge30gKS5tYXJnaW5SaWdodCApOwoKCQkJCWRpdi5yZW1vdmVDaGlsZCggY29udGVudHMgKTsKCQkJfQoKCQkJLy8gU3VwcG9ydDogSUU2LTgKCQkJLy8gRmlyc3QgY2hlY2sgdGhhdCBnZXRDbGllbnRSZWN0cyB3b3JrcyBhcyBleHBlY3RlZAoJCQkvLyBDaGVjayBpZiB0YWJsZSBjZWxscyBzdGlsbCBoYXZlIG9mZnNldFdpZHRoL0hlaWdodCB3aGVuIHRoZXkgYXJlIHNldAoJCQkvLyB0byBkaXNwbGF5Om5vbmUgYW5kIHRoZXJlIGFyZSBzdGlsbCBvdGhlciB2aXNpYmxlIHRhYmxlIGNlbGxzIGluIGEKCQkJLy8gdGFibGUgcm93OyBpZiBzbywgb2Zmc2V0V2lkdGgvSGVpZ2h0IGFyZSBub3QgcmVsaWFibGUgZm9yIHVzZSB3aGVuCgkJCS8vIGRldGVybWluaW5nIGlmIGFuIGVsZW1lbnQgaGFzIGJlZW4gaGlkZGVuIGRpcmVjdGx5IHVzaW5nCgkJCS8vIGRpc3BsYXk6bm9uZSAoaXQgaXMgc3RpbGwgc2FmZSB0byB1c2Ugb2Zmc2V0cyBpZiBhIHBhcmVudCBlbGVtZW50IGlzCgkJCS8vIGhpZGRlbjsgZG9uIHNhZmV0eSBnb2dnbGVzIGFuZCBzZWUgYnVnICM0NTEyIGZvciBtb3JlIGluZm9ybWF0aW9uKS4KCQkJZGl2LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgkJCXJlbGlhYmxlSGlkZGVuT2Zmc2V0c1ZhbCA9IGRpdi5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCA9PT0gMDsKCQkJaWYgKCByZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwgKSB7CgkJCQlkaXYuc3R5bGUuZGlzcGxheSA9ICIiOwoJCQkJZGl2LmlubmVySFRNTCA9ICI8dGFibGU+PHRyPjx0ZD48L3RkPjx0ZD50PC90ZD48L3RyPjwvdGFibGU+IjsKCQkJCWNvbnRlbnRzID0gZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAidGQiICk7CgkJCQljb250ZW50c1sgMCBdLnN0eWxlLmNzc1RleHQgPSAibWFyZ2luOjA7Ym9yZGVyOjA7cGFkZGluZzowO2Rpc3BsYXk6bm9uZSI7CgkJCQlyZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwgPSBjb250ZW50c1sgMCBdLm9mZnNldEhlaWdodCA9PT0gMDsKCQkJCWlmICggcmVsaWFibGVIaWRkZW5PZmZzZXRzVmFsICkgewoJCQkJCWNvbnRlbnRzWyAwIF0uc3R5bGUuZGlzcGxheSA9ICIiOwoJCQkJCWNvbnRlbnRzWyAxIF0uc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCQkJCQlyZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwgPSBjb250ZW50c1sgMCBdLm9mZnNldEhlaWdodCA9PT0gMDsKCQkJCX0KCQkJfQoKCQkJLy8gVGVhcmRvd24KCQkJZG9jdW1lbnRFbGVtZW50LnJlbW92ZUNoaWxkKCBjb250YWluZXIgKTsKCQl9CgoJfSApKCk7CgoKCXZhciBnZXRTdHlsZXMsIGN1ckNTUywKCQlycG9zaXRpb24gPSAvXih0b3B8cmlnaHR8Ym90dG9tfGxlZnQpJC87CgoJaWYgKCB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSApIHsKCQlnZXRTdHlsZXMgPSBmdW5jdGlvbiggZWxlbSApIHsKCgkJCS8vIFN1cHBvcnQ6IElFPD0xMSssIEZpcmVmb3g8PTMwKyAoIzE1MDk4LCAjMTQxNTApCgkJCS8vIElFIHRocm93cyBvbiBlbGVtZW50cyBjcmVhdGVkIGluIHBvcHVwcwoJCQkvLyBGRiBtZWFud2hpbGUgdGhyb3dzIG9uIGZyYW1lIGVsZW1lbnRzIHRocm91Z2ggImRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUiCgkJCXZhciB2aWV3ID0gZWxlbS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3OwoKCQkJaWYgKCAhdmlldyB8fCAhdmlldy5vcGVuZXIgKSB7CgkJCQl2aWV3ID0gd2luZG93OwoJCQl9CgoJCQlyZXR1cm4gdmlldy5nZXRDb21wdXRlZFN0eWxlKCBlbGVtICk7CgkJfTsKCgkJY3VyQ1NTID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGNvbXB1dGVkICkgewoJCQl2YXIgd2lkdGgsIG1pbldpZHRoLCBtYXhXaWR0aCwgcmV0LAoJCQkJc3R5bGUgPSBlbGVtLnN0eWxlOwoKCQkJY29tcHV0ZWQgPSBjb21wdXRlZCB8fCBnZXRTdHlsZXMoIGVsZW0gKTsKCgkJCS8vIGdldFByb3BlcnR5VmFsdWUgaXMgb25seSBuZWVkZWQgZm9yIC5jc3MoJ2ZpbHRlcicpIGluIElFOSwgc2VlICMxMjUzNwoJCQlyZXQgPSBjb21wdXRlZCA/IGNvbXB1dGVkLmdldFByb3BlcnR5VmFsdWUoIG5hbWUgKSB8fCBjb21wdXRlZFsgbmFtZSBdIDogdW5kZWZpbmVkOwoKCQkJLy8gU3VwcG9ydDogT3BlcmEgMTIuMXggb25seQoJCQkvLyBGYWxsIGJhY2sgdG8gc3R5bGUgZXZlbiB3aXRob3V0IGNvbXB1dGVkCgkJCS8vIGNvbXB1dGVkIGlzIHVuZGVmaW5lZCBmb3IgZWxlbXMgb24gZG9jdW1lbnQgZnJhZ21lbnRzCgkJCWlmICggKCByZXQgPT09ICIiIHx8IHJldCA9PT0gdW5kZWZpbmVkICkgJiYgIWpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICkgKSB7CgkJCQlyZXQgPSBqUXVlcnkuc3R5bGUoIGVsZW0sIG5hbWUgKTsKCQkJfQoKCQkJaWYgKCBjb21wdXRlZCApIHsKCgkJCQkvLyBBIHRyaWJ1dGUgdG8gdGhlICJhd2Vzb21lIGhhY2sgYnkgRGVhbiBFZHdhcmRzIgoJCQkJLy8gQ2hyb21lIDwgMTcgYW5kIFNhZmFyaSA1LjAgdXNlcyAiY29tcHV0ZWQgdmFsdWUiCgkJCQkvLyBpbnN0ZWFkIG9mICJ1c2VkIHZhbHVlIiBmb3IgbWFyZ2luLXJpZ2h0CgkJCQkvLyBTYWZhcmkgNS4xLjcgKGF0IGxlYXN0KSByZXR1cm5zIHBlcmNlbnRhZ2UgZm9yIGEgbGFyZ2VyIHNldCBvZiB2YWx1ZXMsCgkJCQkvLyBidXQgd2lkdGggc2VlbXMgdG8gYmUgcmVsaWFibHkgcGl4ZWxzCgkJCQkvLyB0aGlzIGlzIGFnYWluc3QgdGhlIENTU09NIGRyYWZ0IHNwZWM6CgkJCQkvLyBodHRwOi8vZGV2LnczLm9yZy9jc3N3Zy9jc3NvbS8jcmVzb2x2ZWQtdmFsdWVzCgkJCQlpZiAoICFzdXBwb3J0LnBpeGVsTWFyZ2luUmlnaHQoKSAmJiBybnVtbm9ucHgudGVzdCggcmV0ICkgJiYgcm1hcmdpbi50ZXN0KCBuYW1lICkgKSB7CgoJCQkJCS8vIFJlbWVtYmVyIHRoZSBvcmlnaW5hbCB2YWx1ZXMKCQkJCQl3aWR0aCA9IHN0eWxlLndpZHRoOwoJCQkJCW1pbldpZHRoID0gc3R5bGUubWluV2lkdGg7CgkJCQkJbWF4V2lkdGggPSBzdHlsZS5tYXhXaWR0aDsKCgkJCQkJLy8gUHV0IGluIHRoZSBuZXcgdmFsdWVzIHRvIGdldCBhIGNvbXB1dGVkIHZhbHVlIG91dAoJCQkJCXN0eWxlLm1pbldpZHRoID0gc3R5bGUubWF4V2lkdGggPSBzdHlsZS53aWR0aCA9IHJldDsKCQkJCQlyZXQgPSBjb21wdXRlZC53aWR0aDsKCgkJCQkJLy8gUmV2ZXJ0IHRoZSBjaGFuZ2VkIHZhbHVlcwoJCQkJCXN0eWxlLndpZHRoID0gd2lkdGg7CgkJCQkJc3R5bGUubWluV2lkdGggPSBtaW5XaWR0aDsKCQkJCQlzdHlsZS5tYXhXaWR0aCA9IG1heFdpZHRoOwoJCQkJfQoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRQoJCQkvLyBJRSByZXR1cm5zIHpJbmRleCB2YWx1ZSBhcyBhbiBpbnRlZ2VyLgoJCQlyZXR1cm4gcmV0ID09PSB1bmRlZmluZWQgPwoJCQkJcmV0IDoKCQkJCXJldCArICIiOwoJCX07Cgl9IGVsc2UgaWYgKCBkb2N1bWVudEVsZW1lbnQuY3VycmVudFN0eWxlICkgewoJCWdldFN0eWxlcyA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gZWxlbS5jdXJyZW50U3R5bGU7CgkJfTsKCgkJY3VyQ1NTID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGNvbXB1dGVkICkgewoJCQl2YXIgbGVmdCwgcnMsIHJzTGVmdCwgcmV0LAoJCQkJc3R5bGUgPSBlbGVtLnN0eWxlOwoKCQkJY29tcHV0ZWQgPSBjb21wdXRlZCB8fCBnZXRTdHlsZXMoIGVsZW0gKTsKCQkJcmV0ID0gY29tcHV0ZWQgPyBjb21wdXRlZFsgbmFtZSBdIDogdW5kZWZpbmVkOwoKCQkJLy8gQXZvaWQgc2V0dGluZyByZXQgdG8gZW1wdHkgc3RyaW5nIGhlcmUKCQkJLy8gc28gd2UgZG9uJ3QgZGVmYXVsdCB0byBhdXRvCgkJCWlmICggcmV0ID09IG51bGwgJiYgc3R5bGUgJiYgc3R5bGVbIG5hbWUgXSApIHsKCQkJCXJldCA9IHN0eWxlWyBuYW1lIF07CgkJCX0KCgkJCS8vIEZyb20gdGhlIGF3ZXNvbWUgaGFjayBieSBEZWFuIEVkd2FyZHMKCQkJLy8gaHR0cDovL2VyaWsuZWFlLm5ldC9hcmNoaXZlcy8yMDA3LzA3LzI3LzE4LjU0LjE1LyNjb21tZW50LTEwMjI5MQoKCQkJLy8gSWYgd2UncmUgbm90IGRlYWxpbmcgd2l0aCBhIHJlZ3VsYXIgcGl4ZWwgbnVtYmVyCgkJCS8vIGJ1dCBhIG51bWJlciB0aGF0IGhhcyBhIHdlaXJkIGVuZGluZywgd2UgbmVlZCB0byBjb252ZXJ0IGl0IHRvIHBpeGVscwoJCQkvLyBidXQgbm90IHBvc2l0aW9uIGNzcyBhdHRyaWJ1dGVzLCBhcyB0aG9zZSBhcmUKCQkJLy8gcHJvcG9ydGlvbmFsIHRvIHRoZSBwYXJlbnQgZWxlbWVudCBpbnN0ZWFkCgkJCS8vIGFuZCB3ZSBjYW4ndCBtZWFzdXJlIHRoZSBwYXJlbnQgaW5zdGVhZCBiZWNhdXNlIGl0CgkJCS8vIG1pZ2h0IHRyaWdnZXIgYSAic3RhY2tpbmcgZG9sbHMiIHByb2JsZW0KCQkJaWYgKCBybnVtbm9ucHgudGVzdCggcmV0ICkgJiYgIXJwb3NpdGlvbi50ZXN0KCBuYW1lICkgKSB7CgoJCQkJLy8gUmVtZW1iZXIgdGhlIG9yaWdpbmFsIHZhbHVlcwoJCQkJbGVmdCA9IHN0eWxlLmxlZnQ7CgkJCQlycyA9IGVsZW0ucnVudGltZVN0eWxlOwoJCQkJcnNMZWZ0ID0gcnMgJiYgcnMubGVmdDsKCgkJCQkvLyBQdXQgaW4gdGhlIG5ldyB2YWx1ZXMgdG8gZ2V0IGEgY29tcHV0ZWQgdmFsdWUgb3V0CgkJCQlpZiAoIHJzTGVmdCApIHsKCQkJCQlycy5sZWZ0ID0gZWxlbS5jdXJyZW50U3R5bGUubGVmdDsKCQkJCX0KCQkJCXN0eWxlLmxlZnQgPSBuYW1lID09PSAiZm9udFNpemUiID8gIjFlbSIgOiByZXQ7CgkJCQlyZXQgPSBzdHlsZS5waXhlbExlZnQgKyAicHgiOwoKCQkJCS8vIFJldmVydCB0aGUgY2hhbmdlZCB2YWx1ZXMKCQkJCXN0eWxlLmxlZnQgPSBsZWZ0OwoJCQkJaWYgKCByc0xlZnQgKSB7CgkJCQkJcnMubGVmdCA9IHJzTGVmdDsKCQkJCX0KCQkJfQoKCQkJLy8gU3VwcG9ydDogSUUKCQkJLy8gSUUgcmV0dXJucyB6SW5kZXggdmFsdWUgYXMgYW4gaW50ZWdlci4KCQkJcmV0dXJuIHJldCA9PT0gdW5kZWZpbmVkID8KCQkJCXJldCA6CgkJCQlyZXQgKyAiIiB8fCAiYXV0byI7CgkJfTsKCX0KCgoKCglmdW5jdGlvbiBhZGRHZXRIb29rSWYoIGNvbmRpdGlvbkZuLCBob29rRm4gKSB7CgoJCS8vIERlZmluZSB0aGUgaG9vaywgd2UnbGwgY2hlY2sgb24gdGhlIGZpcnN0IHJ1biBpZiBpdCdzIHJlYWxseSBuZWVkZWQuCgkJcmV0dXJuIHsKCQkJZ2V0OiBmdW5jdGlvbigpIHsKCQkJCWlmICggY29uZGl0aW9uRm4oKSApIHsKCgkJCQkJLy8gSG9vayBub3QgbmVlZGVkIChvciBpdCdzIG5vdCBwb3NzaWJsZSB0byB1c2UgaXQgZHVlCgkJCQkJLy8gdG8gbWlzc2luZyBkZXBlbmRlbmN5KSwgcmVtb3ZlIGl0LgoJCQkJCWRlbGV0ZSB0aGlzLmdldDsKCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJLy8gSG9vayBuZWVkZWQ7IHJlZGVmaW5lIGl0IHNvIHRoYXQgdGhlIHN1cHBvcnQgdGVzdCBpcyBub3QgZXhlY3V0ZWQgYWdhaW4uCgkJCQlyZXR1cm4gKCB0aGlzLmdldCA9IGhvb2tGbiApLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKCQkJfQoJCX07Cgl9CgoKCXZhcgoKCQkJcmFscGhhID0gL2FscGhhXChbXildKlwpL2ksCgkJcm9wYWNpdHkgPSAvb3BhY2l0eVxzKj1ccyooW14pXSopL2ksCgoJCS8vIHN3YXBwYWJsZSBpZiBkaXNwbGF5IGlzIG5vbmUgb3Igc3RhcnRzIHdpdGggdGFibGUgZXhjZXB0CgkJLy8gInRhYmxlIiwgInRhYmxlLWNlbGwiLCBvciAidGFibGUtY2FwdGlvbiIKCQkvLyBzZWUgaGVyZSBmb3IgZGlzcGxheSB2YWx1ZXM6CgkJLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9DU1MvZGlzcGxheQoJCXJkaXNwbGF5c3dhcCA9IC9eKG5vbmV8dGFibGUoPyEtY1tlYV0pLispLywKCQlybnVtc3BsaXQgPSBuZXcgUmVnRXhwKCAiXigiICsgcG51bSArICIpKC4qKSQiLCAiaSIgKSwKCgkJY3NzU2hvdyA9IHsgcG9zaXRpb246ICJhYnNvbHV0ZSIsIHZpc2liaWxpdHk6ICJoaWRkZW4iLCBkaXNwbGF5OiAiYmxvY2siIH0sCgkJY3NzTm9ybWFsVHJhbnNmb3JtID0gewoJCQlsZXR0ZXJTcGFjaW5nOiAiMCIsCgkJCWZvbnRXZWlnaHQ6ICI0MDAiCgkJfSwKCgkJY3NzUHJlZml4ZXMgPSBbICJXZWJraXQiLCAiTyIsICJNb3oiLCAibXMiIF0sCgkJZW1wdHlTdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICkuc3R5bGU7CgoKCS8vIHJldHVybiBhIGNzcyBwcm9wZXJ0eSBtYXBwZWQgdG8gYSBwb3RlbnRpYWxseSB2ZW5kb3IgcHJlZml4ZWQgcHJvcGVydHkKCWZ1bmN0aW9uIHZlbmRvclByb3BOYW1lKCBuYW1lICkgewoKCQkvLyBzaG9ydGN1dCBmb3IgbmFtZXMgdGhhdCBhcmUgbm90IHZlbmRvciBwcmVmaXhlZAoJCWlmICggbmFtZSBpbiBlbXB0eVN0eWxlICkgewoJCQlyZXR1cm4gbmFtZTsKCQl9CgoJCS8vIGNoZWNrIGZvciB2ZW5kb3IgcHJlZml4ZWQgbmFtZXMKCQl2YXIgY2FwTmFtZSA9IG5hbWUuY2hhckF0KCAwICkudG9VcHBlckNhc2UoKSArIG5hbWUuc2xpY2UoIDEgKSwKCQkJaSA9IGNzc1ByZWZpeGVzLmxlbmd0aDsKCgkJd2hpbGUgKCBpLS0gKSB7CgkJCW5hbWUgPSBjc3NQcmVmaXhlc1sgaSBdICsgY2FwTmFtZTsKCQkJaWYgKCBuYW1lIGluIGVtcHR5U3R5bGUgKSB7CgkJCQlyZXR1cm4gbmFtZTsKCQkJfQoJCX0KCX0KCglmdW5jdGlvbiBzaG93SGlkZSggZWxlbWVudHMsIHNob3cgKSB7CgkJdmFyIGRpc3BsYXksIGVsZW0sIGhpZGRlbiwKCQkJdmFsdWVzID0gW10sCgkJCWluZGV4ID0gMCwKCQkJbGVuZ3RoID0gZWxlbWVudHMubGVuZ3RoOwoKCQlmb3IgKCA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrICkgewoJCQllbGVtID0gZWxlbWVudHNbIGluZGV4IF07CgkJCWlmICggIWVsZW0uc3R5bGUgKSB7CgkJCQljb250aW51ZTsKCQkJfQoKCQkJdmFsdWVzWyBpbmRleCBdID0galF1ZXJ5Ll9kYXRhKCBlbGVtLCAib2xkZGlzcGxheSIgKTsKCQkJZGlzcGxheSA9IGVsZW0uc3R5bGUuZGlzcGxheTsKCQkJaWYgKCBzaG93ICkgewoKCQkJCS8vIFJlc2V0IHRoZSBpbmxpbmUgZGlzcGxheSBvZiB0aGlzIGVsZW1lbnQgdG8gbGVhcm4gaWYgaXQgaXMKCQkJCS8vIGJlaW5nIGhpZGRlbiBieSBjYXNjYWRlZCBydWxlcyBvciBub3QKCQkJCWlmICggIXZhbHVlc1sgaW5kZXggXSAmJiBkaXNwbGF5ID09PSAibm9uZSIgKSB7CgkJCQkJZWxlbS5zdHlsZS5kaXNwbGF5ID0gIiI7CgkJCQl9CgoJCQkJLy8gU2V0IGVsZW1lbnRzIHdoaWNoIGhhdmUgYmVlbiBvdmVycmlkZGVuIHdpdGggZGlzcGxheTogbm9uZQoJCQkJLy8gaW4gYSBzdHlsZXNoZWV0IHRvIHdoYXRldmVyIHRoZSBkZWZhdWx0IGJyb3dzZXIgc3R5bGUgaXMKCQkJCS8vIGZvciBzdWNoIGFuIGVsZW1lbnQKCQkJCWlmICggZWxlbS5zdHlsZS5kaXNwbGF5ID09PSAiIiAmJiBpc0hpZGRlbiggZWxlbSApICkgewoJCQkJCXZhbHVlc1sgaW5kZXggXSA9CgkJCQkJCWpRdWVyeS5fZGF0YSggZWxlbSwgIm9sZGRpc3BsYXkiLCBkZWZhdWx0RGlzcGxheSggZWxlbS5ub2RlTmFtZSApICk7CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQloaWRkZW4gPSBpc0hpZGRlbiggZWxlbSApOwoKCQkJCWlmICggZGlzcGxheSAmJiBkaXNwbGF5ICE9PSAibm9uZSIgfHwgIWhpZGRlbiApIHsKCQkJCQlqUXVlcnkuX2RhdGEoCgkJCQkJCWVsZW0sCgkJCQkJCSJvbGRkaXNwbGF5IiwKCQkJCQkJaGlkZGVuID8gZGlzcGxheSA6IGpRdWVyeS5jc3MoIGVsZW0sICJkaXNwbGF5IiApCgkJCQkJKTsKCQkJCX0KCQkJfQoJCX0KCgkJLy8gU2V0IHRoZSBkaXNwbGF5IG9mIG1vc3Qgb2YgdGhlIGVsZW1lbnRzIGluIGEgc2Vjb25kIGxvb3AKCQkvLyB0byBhdm9pZCB0aGUgY29uc3RhbnQgcmVmbG93CgkJZm9yICggaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKyApIHsKCQkJZWxlbSA9IGVsZW1lbnRzWyBpbmRleCBdOwoJCQlpZiAoICFlbGVtLnN0eWxlICkgewoJCQkJY29udGludWU7CgkJCX0KCQkJaWYgKCAhc2hvdyB8fCBlbGVtLnN0eWxlLmRpc3BsYXkgPT09ICJub25lIiB8fCBlbGVtLnN0eWxlLmRpc3BsYXkgPT09ICIiICkgewoJCQkJZWxlbS5zdHlsZS5kaXNwbGF5ID0gc2hvdyA/IHZhbHVlc1sgaW5kZXggXSB8fCAiIiA6ICJub25lIjsKCQkJfQoJCX0KCgkJcmV0dXJuIGVsZW1lbnRzOwoJfQoKCWZ1bmN0aW9uIHNldFBvc2l0aXZlTnVtYmVyKCBlbGVtLCB2YWx1ZSwgc3VidHJhY3QgKSB7CgkJdmFyIG1hdGNoZXMgPSBybnVtc3BsaXQuZXhlYyggdmFsdWUgKTsKCQlyZXR1cm4gbWF0Y2hlcyA/CgoJCQkvLyBHdWFyZCBhZ2FpbnN0IHVuZGVmaW5lZCAic3VidHJhY3QiLCBlLmcuLCB3aGVuIHVzZWQgYXMgaW4gY3NzSG9va3MKCQkJTWF0aC5tYXgoIDAsIG1hdGNoZXNbIDEgXSAtICggc3VidHJhY3QgfHwgMCApICkgKyAoIG1hdGNoZXNbIDIgXSB8fCAicHgiICkgOgoJCQl2YWx1ZTsKCX0KCglmdW5jdGlvbiBhdWdtZW50V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEsIGlzQm9yZGVyQm94LCBzdHlsZXMgKSB7CgkJdmFyIGkgPSBleHRyYSA9PT0gKCBpc0JvcmRlckJveCA/ICJib3JkZXIiIDogImNvbnRlbnQiICkgPwoKCQkJLy8gSWYgd2UgYWxyZWFkeSBoYXZlIHRoZSByaWdodCBtZWFzdXJlbWVudCwgYXZvaWQgYXVnbWVudGF0aW9uCgkJCTQgOgoKCQkJLy8gT3RoZXJ3aXNlIGluaXRpYWxpemUgZm9yIGhvcml6b250YWwgb3IgdmVydGljYWwgcHJvcGVydGllcwoJCQluYW1lID09PSAid2lkdGgiID8gMSA6IDAsCgoJCQl2YWwgPSAwOwoKCQlmb3IgKCA7IGkgPCA0OyBpICs9IDIgKSB7CgoJCQkvLyBib3RoIGJveCBtb2RlbHMgZXhjbHVkZSBtYXJnaW4sIHNvIGFkZCBpdCBpZiB3ZSB3YW50IGl0CgkJCWlmICggZXh0cmEgPT09ICJtYXJnaW4iICkgewoJCQkJdmFsICs9IGpRdWVyeS5jc3MoIGVsZW0sIGV4dHJhICsgY3NzRXhwYW5kWyBpIF0sIHRydWUsIHN0eWxlcyApOwoJCQl9CgoJCQlpZiAoIGlzQm9yZGVyQm94ICkgewoKCQkJCS8vIGJvcmRlci1ib3ggaW5jbHVkZXMgcGFkZGluZywgc28gcmVtb3ZlIGl0IGlmIHdlIHdhbnQgY29udGVudAoJCQkJaWYgKCBleHRyYSA9PT0gImNvbnRlbnQiICkgewoJCQkJCXZhbCAtPSBqUXVlcnkuY3NzKCBlbGVtLCAicGFkZGluZyIgKyBjc3NFeHBhbmRbIGkgXSwgdHJ1ZSwgc3R5bGVzICk7CgkJCQl9CgoJCQkJLy8gYXQgdGhpcyBwb2ludCwgZXh0cmEgaXNuJ3QgYm9yZGVyIG5vciBtYXJnaW4sIHNvIHJlbW92ZSBib3JkZXIKCQkJCWlmICggZXh0cmEgIT09ICJtYXJnaW4iICkgewoJCQkJCXZhbCAtPSBqUXVlcnkuY3NzKCBlbGVtLCAiYm9yZGVyIiArIGNzc0V4cGFuZFsgaSBdICsgIldpZHRoIiwgdHJ1ZSwgc3R5bGVzICk7CgkJCQl9CgkJCX0gZWxzZSB7CgoJCQkJLy8gYXQgdGhpcyBwb2ludCwgZXh0cmEgaXNuJ3QgY29udGVudCwgc28gYWRkIHBhZGRpbmcKCQkJCXZhbCArPSBqUXVlcnkuY3NzKCBlbGVtLCAicGFkZGluZyIgKyBjc3NFeHBhbmRbIGkgXSwgdHJ1ZSwgc3R5bGVzICk7CgoJCQkJLy8gYXQgdGhpcyBwb2ludCwgZXh0cmEgaXNuJ3QgY29udGVudCBub3IgcGFkZGluZywgc28gYWRkIGJvcmRlcgoJCQkJaWYgKCBleHRyYSAhPT0gInBhZGRpbmciICkgewoJCQkJCXZhbCArPSBqUXVlcnkuY3NzKCBlbGVtLCAiYm9yZGVyIiArIGNzc0V4cGFuZFsgaSBdICsgIldpZHRoIiwgdHJ1ZSwgc3R5bGVzICk7CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiB2YWw7Cgl9CgoJZnVuY3Rpb24gZ2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKSB7CgoJCS8vIFN0YXJ0IHdpdGggb2Zmc2V0IHByb3BlcnR5LCB3aGljaCBpcyBlcXVpdmFsZW50IHRvIHRoZSBib3JkZXItYm94IHZhbHVlCgkJdmFyIHZhbHVlSXNCb3JkZXJCb3ggPSB0cnVlLAoJCQl2YWwgPSBuYW1lID09PSAid2lkdGgiID8gZWxlbS5vZmZzZXRXaWR0aCA6IGVsZW0ub2Zmc2V0SGVpZ2h0LAoJCQlzdHlsZXMgPSBnZXRTdHlsZXMoIGVsZW0gKSwKCQkJaXNCb3JkZXJCb3ggPSBzdXBwb3J0LmJveFNpemluZyAmJgoJCQkJalF1ZXJ5LmNzcyggZWxlbSwgImJveFNpemluZyIsIGZhbHNlLCBzdHlsZXMgKSA9PT0gImJvcmRlci1ib3giOwoKCQkvLyBTdXBwb3J0OiBJRTExIG9ubHkKCQkvLyBJbiBJRSAxMSBmdWxsc2NyZWVuIGVsZW1lbnRzIGluc2lkZSBvZiBhbiBpZnJhbWUgaGF2ZQoJCS8vIDEwMHggdG9vIHNtYWxsIGRpbWVuc2lvbnMgKGdoLTE3NjQpLgoJCWlmICggZG9jdW1lbnQubXNGdWxsc2NyZWVuRWxlbWVudCAmJiB3aW5kb3cudG9wICE9PSB3aW5kb3cgKSB7CgoJCQkvLyBTdXBwb3J0OiBJRTExIG9ubHkKCQkJLy8gUnVubmluZyBnZXRCb3VuZGluZ0NsaWVudFJlY3Qgb24gYSBkaXNjb25uZWN0ZWQgbm9kZQoJCQkvLyBpbiBJRSB0aHJvd3MgYW4gZXJyb3IuCgkJCWlmICggZWxlbS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCApIHsKCQkJCXZhbCA9IE1hdGgucm91bmQoIGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClbIG5hbWUgXSAqIDEwMCApOwoJCQl9CgkJfQoKCQkvLyBzb21lIG5vbi1odG1sIGVsZW1lbnRzIHJldHVybiB1bmRlZmluZWQgZm9yIG9mZnNldFdpZHRoLCBzbyBjaGVjayBmb3IgbnVsbC91bmRlZmluZWQKCQkvLyBzdmcgLSBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02NDkyODUKCQkvLyBNYXRoTUwgLSBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD00OTE2NjgKCQlpZiAoIHZhbCA8PSAwIHx8IHZhbCA9PSBudWxsICkgewoKCQkJLy8gRmFsbCBiYWNrIHRvIGNvbXB1dGVkIHRoZW4gdW5jb21wdXRlZCBjc3MgaWYgbmVjZXNzYXJ5CgkJCXZhbCA9IGN1ckNTUyggZWxlbSwgbmFtZSwgc3R5bGVzICk7CgkJCWlmICggdmFsIDwgMCB8fCB2YWwgPT0gbnVsbCApIHsKCQkJCXZhbCA9IGVsZW0uc3R5bGVbIG5hbWUgXTsKCQkJfQoKCQkJLy8gQ29tcHV0ZWQgdW5pdCBpcyBub3QgcGl4ZWxzLiBTdG9wIGhlcmUgYW5kIHJldHVybi4KCQkJaWYgKCBybnVtbm9ucHgudGVzdCggdmFsICkgKSB7CgkJCQlyZXR1cm4gdmFsOwoJCQl9CgoJCQkvLyB3ZSBuZWVkIHRoZSBjaGVjayBmb3Igc3R5bGUgaW4gY2FzZSBhIGJyb3dzZXIgd2hpY2ggcmV0dXJucyB1bnJlbGlhYmxlIHZhbHVlcwoJCQkvLyBmb3IgZ2V0Q29tcHV0ZWRTdHlsZSBzaWxlbnRseSBmYWxscyBiYWNrIHRvIHRoZSByZWxpYWJsZSBlbGVtLnN0eWxlCgkJCXZhbHVlSXNCb3JkZXJCb3ggPSBpc0JvcmRlckJveCAmJgoJCQkJKCBzdXBwb3J0LmJveFNpemluZ1JlbGlhYmxlKCkgfHwgdmFsID09PSBlbGVtLnN0eWxlWyBuYW1lIF0gKTsKCgkJCS8vIE5vcm1hbGl6ZSAiIiwgYXV0bywgYW5kIHByZXBhcmUgZm9yIGV4dHJhCgkJCXZhbCA9IHBhcnNlRmxvYXQoIHZhbCApIHx8IDA7CgkJfQoKCQkvLyB1c2UgdGhlIGFjdGl2ZSBib3gtc2l6aW5nIG1vZGVsIHRvIGFkZC9zdWJ0cmFjdCBpcnJlbGV2YW50IHN0eWxlcwoJCXJldHVybiAoIHZhbCArCgkJCWF1Z21lbnRXaWR0aE9ySGVpZ2h0KAoJCQkJZWxlbSwKCQkJCW5hbWUsCgkJCQlleHRyYSB8fCAoIGlzQm9yZGVyQm94ID8gImJvcmRlciIgOiAiY29udGVudCIgKSwKCQkJCXZhbHVlSXNCb3JkZXJCb3gsCgkJCQlzdHlsZXMKCQkJKQoJCSkgKyAicHgiOwoJfQoKCWpRdWVyeS5leHRlbmQoIHsKCgkJLy8gQWRkIGluIHN0eWxlIHByb3BlcnR5IGhvb2tzIGZvciBvdmVycmlkaW5nIHRoZSBkZWZhdWx0CgkJLy8gYmVoYXZpb3Igb2YgZ2V0dGluZyBhbmQgc2V0dGluZyBhIHN0eWxlIHByb3BlcnR5CgkJY3NzSG9va3M6IHsKCQkJb3BhY2l0eTogewoJCQkJZ2V0OiBmdW5jdGlvbiggZWxlbSwgY29tcHV0ZWQgKSB7CgkJCQkJaWYgKCBjb21wdXRlZCApIHsKCgkJCQkJCS8vIFdlIHNob3VsZCBhbHdheXMgZ2V0IGEgbnVtYmVyIGJhY2sgZnJvbSBvcGFjaXR5CgkJCQkJCXZhciByZXQgPSBjdXJDU1MoIGVsZW0sICJvcGFjaXR5IiApOwoJCQkJCQlyZXR1cm4gcmV0ID09PSAiIiA/ICIxIiA6IHJldDsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9LAoKCQkvLyBEb24ndCBhdXRvbWF0aWNhbGx5IGFkZCAicHgiIHRvIHRoZXNlIHBvc3NpYmx5LXVuaXRsZXNzIHByb3BlcnRpZXMKCQljc3NOdW1iZXI6IHsKCQkJImFuaW1hdGlvbkl0ZXJhdGlvbkNvdW50IjogdHJ1ZSwKCQkJImNvbHVtbkNvdW50IjogdHJ1ZSwKCQkJImZpbGxPcGFjaXR5IjogdHJ1ZSwKCQkJImZsZXhHcm93IjogdHJ1ZSwKCQkJImZsZXhTaHJpbmsiOiB0cnVlLAoJCQkiZm9udFdlaWdodCI6IHRydWUsCgkJCSJsaW5lSGVpZ2h0IjogdHJ1ZSwKCQkJIm9wYWNpdHkiOiB0cnVlLAoJCQkib3JkZXIiOiB0cnVlLAoJCQkib3JwaGFucyI6IHRydWUsCgkJCSJ3aWRvd3MiOiB0cnVlLAoJCQkiekluZGV4IjogdHJ1ZSwKCQkJInpvb20iOiB0cnVlCgkJfSwKCgkJLy8gQWRkIGluIHByb3BlcnRpZXMgd2hvc2UgbmFtZXMgeW91IHdpc2ggdG8gZml4IGJlZm9yZQoJCS8vIHNldHRpbmcgb3IgZ2V0dGluZyB0aGUgdmFsdWUKCQljc3NQcm9wczogewoKCQkJLy8gbm9ybWFsaXplIGZsb2F0IGNzcyBwcm9wZXJ0eQoJCQkiZmxvYXQiOiBzdXBwb3J0LmNzc0Zsb2F0ID8gImNzc0Zsb2F0IiA6ICJzdHlsZUZsb2F0IgoJCX0sCgoJCS8vIEdldCBhbmQgc2V0IHRoZSBzdHlsZSBwcm9wZXJ0eSBvbiBhIERPTSBOb2RlCgkJc3R5bGU6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSwgZXh0cmEgKSB7CgoJCQkvLyBEb24ndCBzZXQgc3R5bGVzIG9uIHRleHQgYW5kIGNvbW1lbnQgbm9kZXMKCQkJaWYgKCAhZWxlbSB8fCBlbGVtLm5vZGVUeXBlID09PSAzIHx8IGVsZW0ubm9kZVR5cGUgPT09IDggfHwgIWVsZW0uc3R5bGUgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIE1ha2Ugc3VyZSB0aGF0IHdlJ3JlIHdvcmtpbmcgd2l0aCB0aGUgcmlnaHQgbmFtZQoJCQl2YXIgcmV0LCB0eXBlLCBob29rcywKCQkJCW9yaWdOYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggbmFtZSApLAoJCQkJc3R5bGUgPSBlbGVtLnN0eWxlOwoKCQkJbmFtZSA9IGpRdWVyeS5jc3NQcm9wc1sgb3JpZ05hbWUgXSB8fAoJCQkJKCBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gPSB2ZW5kb3JQcm9wTmFtZSggb3JpZ05hbWUgKSB8fCBvcmlnTmFtZSApOwoKCQkJLy8gZ2V0cyBob29rIGZvciB0aGUgcHJlZml4ZWQgdmVyc2lvbgoJCQkvLyBmb2xsb3dlZCBieSB0aGUgdW5wcmVmaXhlZCB2ZXJzaW9uCgkJCWhvb2tzID0galF1ZXJ5LmNzc0hvb2tzWyBuYW1lIF0gfHwgalF1ZXJ5LmNzc0hvb2tzWyBvcmlnTmFtZSBdOwoKCQkJLy8gQ2hlY2sgaWYgd2UncmUgc2V0dGluZyBhIHZhbHVlCgkJCWlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHsKCQkJCXR5cGUgPSB0eXBlb2YgdmFsdWU7CgoJCQkJLy8gQ29udmVydCAiKz0iIG9yICItPSIgdG8gcmVsYXRpdmUgbnVtYmVycyAoIzczNDUpCgkJCQlpZiAoIHR5cGUgPT09ICJzdHJpbmciICYmICggcmV0ID0gcmNzc051bS5leGVjKCB2YWx1ZSApICkgJiYgcmV0WyAxIF0gKSB7CgkJCQkJdmFsdWUgPSBhZGp1c3RDU1MoIGVsZW0sIG5hbWUsIHJldCApOwoKCQkJCQkvLyBGaXhlcyBidWcgIzkyMzcKCQkJCQl0eXBlID0gIm51bWJlciI7CgkJCQl9CgoJCQkJLy8gTWFrZSBzdXJlIHRoYXQgbnVsbCBhbmQgTmFOIHZhbHVlcyBhcmVuJ3Qgc2V0LiBTZWU6ICM3MTE2CgkJCQlpZiAoIHZhbHVlID09IG51bGwgfHwgdmFsdWUgIT09IHZhbHVlICkgewoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQkvLyBJZiBhIG51bWJlciB3YXMgcGFzc2VkIGluLCBhZGQgdGhlIHVuaXQgKGV4Y2VwdCBmb3IgY2VydGFpbiBDU1MgcHJvcGVydGllcykKCQkJCWlmICggdHlwZSA9PT0gIm51bWJlciIgKSB7CgkJCQkJdmFsdWUgKz0gcmV0ICYmIHJldFsgMyBdIHx8ICggalF1ZXJ5LmNzc051bWJlclsgb3JpZ05hbWUgXSA/ICIiIDogInB4IiApOwoJCQkJfQoKCQkJCS8vIEZpeGVzICM4OTA4LCBpdCBjYW4gYmUgZG9uZSBtb3JlIGNvcnJlY3RseSBieSBzcGVjaWZpbmcgc2V0dGVycyBpbiBjc3NIb29rcywKCQkJCS8vIGJ1dCBpdCB3b3VsZCBtZWFuIHRvIGRlZmluZSBlaWdodAoJCQkJLy8gKGZvciBldmVyeSBwcm9ibGVtYXRpYyBwcm9wZXJ0eSkgaWRlbnRpY2FsIGZ1bmN0aW9ucwoJCQkJaWYgKCAhc3VwcG9ydC5jbGVhckNsb25lU3R5bGUgJiYgdmFsdWUgPT09ICIiICYmIG5hbWUuaW5kZXhPZiggImJhY2tncm91bmQiICkgPT09IDAgKSB7CgkJCQkJc3R5bGVbIG5hbWUgXSA9ICJpbmhlcml0IjsKCQkJCX0KCgkJCQkvLyBJZiBhIGhvb2sgd2FzIHByb3ZpZGVkLCB1c2UgdGhhdCB2YWx1ZSwgb3RoZXJ3aXNlIGp1c3Qgc2V0IHRoZSBzcGVjaWZpZWQgdmFsdWUKCQkJCWlmICggIWhvb2tzIHx8ICEoICJzZXQiIGluIGhvb2tzICkgfHwKCQkJCQkoIHZhbHVlID0gaG9va3Muc2V0KCBlbGVtLCB2YWx1ZSwgZXh0cmEgKSApICE9PSB1bmRlZmluZWQgKSB7CgoJCQkJCS8vIFN1cHBvcnQ6IElFCgkJCQkJLy8gU3dhbGxvdyBlcnJvcnMgZnJvbSAnaW52YWxpZCcgQ1NTIHZhbHVlcyAoIzU1MDkpCgkJCQkJdHJ5IHsKCQkJCQkJc3R5bGVbIG5hbWUgXSA9IHZhbHVlOwoJCQkJCX0gY2F0Y2ggKCBlICkge30KCQkJCX0KCgkJCX0gZWxzZSB7CgoJCQkJLy8gSWYgYSBob29rIHdhcyBwcm92aWRlZCBnZXQgdGhlIG5vbi1jb21wdXRlZCB2YWx1ZSBmcm9tIHRoZXJlCgkJCQlpZiAoIGhvb2tzICYmICJnZXQiIGluIGhvb2tzICYmCgkJCQkJKCByZXQgPSBob29rcy5nZXQoIGVsZW0sIGZhbHNlLCBleHRyYSApICkgIT09IHVuZGVmaW5lZCApIHsKCgkJCQkJcmV0dXJuIHJldDsKCQkJCX0KCgkJCQkvLyBPdGhlcndpc2UganVzdCBnZXQgdGhlIHZhbHVlIGZyb20gdGhlIHN0eWxlIG9iamVjdAoJCQkJcmV0dXJuIHN0eWxlWyBuYW1lIF07CgkJCX0KCQl9LAoKCQ==", "base64"));
  res.write(new Buffer("CWNzczogZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGV4dHJhLCBzdHlsZXMgKSB7CgkJCXZhciBudW0sIHZhbCwgaG9va3MsCgkJCQlvcmlnTmFtZSA9IGpRdWVyeS5jYW1lbENhc2UoIG5hbWUgKTsKCgkJCS8vIE1ha2Ugc3VyZSB0aGF0IHdlJ3JlIHdvcmtpbmcgd2l0aCB0aGUgcmlnaHQgbmFtZQoJCQluYW1lID0galF1ZXJ5LmNzc1Byb3BzWyBvcmlnTmFtZSBdIHx8CgkJCQkoIGpRdWVyeS5jc3NQcm9wc1sgb3JpZ05hbWUgXSA9IHZlbmRvclByb3BOYW1lKCBvcmlnTmFtZSApIHx8IG9yaWdOYW1lICk7CgoJCQkvLyBnZXRzIGhvb2sgZm9yIHRoZSBwcmVmaXhlZCB2ZXJzaW9uCgkJCS8vIGZvbGxvd2VkIGJ5IHRoZSB1bnByZWZpeGVkIHZlcnNpb24KCQkJaG9va3MgPSBqUXVlcnkuY3NzSG9va3NbIG5hbWUgXSB8fCBqUXVlcnkuY3NzSG9va3NbIG9yaWdOYW1lIF07CgoJCQkvLyBJZiBhIGhvb2sgd2FzIHByb3ZpZGVkIGdldCB0aGUgY29tcHV0ZWQgdmFsdWUgZnJvbSB0aGVyZQoJCQlpZiAoIGhvb2tzICYmICJnZXQiIGluIGhvb2tzICkgewoJCQkJdmFsID0gaG9va3MuZ2V0KCBlbGVtLCB0cnVlLCBleHRyYSApOwoJCQl9CgoJCQkvLyBPdGhlcndpc2UsIGlmIGEgd2F5IHRvIGdldCB0aGUgY29tcHV0ZWQgdmFsdWUgZXhpc3RzLCB1c2UgdGhhdAoJCQlpZiAoIHZhbCA9PT0gdW5kZWZpbmVkICkgewoJCQkJdmFsID0gY3VyQ1NTKCBlbGVtLCBuYW1lLCBzdHlsZXMgKTsKCQkJfQoKCQkJLy9jb252ZXJ0ICJub3JtYWwiIHRvIGNvbXB1dGVkIHZhbHVlCgkJCWlmICggdmFsID09PSAibm9ybWFsIiAmJiBuYW1lIGluIGNzc05vcm1hbFRyYW5zZm9ybSApIHsKCQkJCXZhbCA9IGNzc05vcm1hbFRyYW5zZm9ybVsgbmFtZSBdOwoJCQl9CgoJCQkvLyBSZXR1cm4sIGNvbnZlcnRpbmcgdG8gbnVtYmVyIGlmIGZvcmNlZCBvciBhIHF1YWxpZmllciB3YXMgcHJvdmlkZWQgYW5kIHZhbCBsb29rcyBudW1lcmljCgkJCWlmICggZXh0cmEgPT09ICIiIHx8IGV4dHJhICkgewoJCQkJbnVtID0gcGFyc2VGbG9hdCggdmFsICk7CgkJCQlyZXR1cm4gZXh0cmEgPT09IHRydWUgfHwgaXNGaW5pdGUoIG51bSApID8gbnVtIHx8IDAgOiB2YWw7CgkJCX0KCQkJcmV0dXJuIHZhbDsKCQl9Cgl9ICk7CgoJalF1ZXJ5LmVhY2goIFsgImhlaWdodCIsICJ3aWR0aCIgXSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7CgkJalF1ZXJ5LmNzc0hvb2tzWyBuYW1lIF0gPSB7CgkJCWdldDogZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkLCBleHRyYSApIHsKCQkJCWlmICggY29tcHV0ZWQgKSB7CgoJCQkJCS8vIGNlcnRhaW4gZWxlbWVudHMgY2FuIGhhdmUgZGltZW5zaW9uIGluZm8gaWYgd2UgaW52aXNpYmx5IHNob3cgdGhlbQoJCQkJCS8vIGhvd2V2ZXIsIGl0IG11c3QgaGF2ZSBhIGN1cnJlbnQgZGlzcGxheSBzdHlsZSB0aGF0IHdvdWxkIGJlbmVmaXQgZnJvbSB0aGlzCgkJCQkJcmV0dXJuIHJkaXNwbGF5c3dhcC50ZXN0KCBqUXVlcnkuY3NzKCBlbGVtLCAiZGlzcGxheSIgKSApICYmCgkJCQkJCWVsZW0ub2Zmc2V0V2lkdGggPT09IDAgPwoJCQkJCQkJc3dhcCggZWxlbSwgY3NzU2hvdywgZnVuY3Rpb24oKSB7CgkJCQkJCQkJcmV0dXJuIGdldFdpZHRoT3JIZWlnaHQoIGVsZW0sIG5hbWUsIGV4dHJhICk7CgkJCQkJCQl9ICkgOgoJCQkJCQkJZ2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKTsKCQkJCX0KCQkJfSwKCgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlLCBleHRyYSApIHsKCQkJCXZhciBzdHlsZXMgPSBleHRyYSAmJiBnZXRTdHlsZXMoIGVsZW0gKTsKCQkJCXJldHVybiBzZXRQb3NpdGl2ZU51bWJlciggZWxlbSwgdmFsdWUsIGV4dHJhID8KCQkJCQlhdWdtZW50V2lkdGhPckhlaWdodCgKCQkJCQkJZWxlbSwKCQkJCQkJbmFtZSwKCQkJCQkJZXh0cmEsCgkJCQkJCXN1cHBvcnQuYm94U2l6aW5nICYmCgkJCQkJCQlqUXVlcnkuY3NzKCBlbGVtLCAiYm94U2l6aW5nIiwgZmFsc2UsIHN0eWxlcyApID09PSAiYm9yZGVyLWJveCIsCgkJCQkJCXN0eWxlcwoJCQkJCSkgOiAwCgkJCQkpOwoJCQl9CgkJfTsKCX0gKTsKCglpZiAoICFzdXBwb3J0Lm9wYWNpdHkgKSB7CgkJalF1ZXJ5LmNzc0hvb2tzLm9wYWNpdHkgPSB7CgkJCWdldDogZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkICkgewoKCQkJCS8vIElFIHVzZXMgZmlsdGVycyBmb3Igb3BhY2l0eQoJCQkJcmV0dXJuIHJvcGFjaXR5LnRlc3QoICggY29tcHV0ZWQgJiYgZWxlbS5jdXJyZW50U3R5bGUgPwoJCQkJCWVsZW0uY3VycmVudFN0eWxlLmZpbHRlciA6CgkJCQkJZWxlbS5zdHlsZS5maWx0ZXIgKSB8fCAiIiApID8KCQkJCQkJKCAwLjAxICogcGFyc2VGbG9hdCggUmVnRXhwLiQxICkgKSArICIiIDoKCQkJCQkJY29tcHV0ZWQgPyAiMSIgOiAiIjsKCQkJfSwKCgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCQkJdmFyIHN0eWxlID0gZWxlbS5zdHlsZSwKCQkJCQljdXJyZW50U3R5bGUgPSBlbGVtLmN1cnJlbnRTdHlsZSwKCQkJCQlvcGFjaXR5ID0galF1ZXJ5LmlzTnVtZXJpYyggdmFsdWUgKSA/ICJhbHBoYShvcGFjaXR5PSIgKyB2YWx1ZSAqIDEwMCArICIpIiA6ICIiLAoJCQkJCWZpbHRlciA9IGN1cnJlbnRTdHlsZSAmJiBjdXJyZW50U3R5bGUuZmlsdGVyIHx8IHN0eWxlLmZpbHRlciB8fCAiIjsKCgkJCQkvLyBJRSBoYXMgdHJvdWJsZSB3aXRoIG9wYWNpdHkgaWYgaXQgZG9lcyBub3QgaGF2ZSBsYXlvdXQKCQkJCS8vIEZvcmNlIGl0IGJ5IHNldHRpbmcgdGhlIHpvb20gbGV2ZWwKCQkJCXN0eWxlLnpvb20gPSAxOwoKCQkJCS8vIGlmIHNldHRpbmcgb3BhY2l0eSB0byAxLCBhbmQgbm8gb3RoZXIgZmlsdGVycyBleGlzdCAtCgkJCQkvLyBhdHRlbXB0IHRvIHJlbW92ZSBmaWx0ZXIgYXR0cmlidXRlICM2NjUyCgkJCQkvLyBpZiB2YWx1ZSA9PT0gIiIsIHRoZW4gcmVtb3ZlIGlubGluZSBvcGFjaXR5ICMxMjY4NQoJCQkJaWYgKCAoIHZhbHVlID49IDEgfHwgdmFsdWUgPT09ICIiICkgJiYKCQkJCQkJalF1ZXJ5LnRyaW0oIGZpbHRlci5yZXBsYWNlKCByYWxwaGEsICIiICkgKSA9PT0gIiIgJiYKCQkJCQkJc3R5bGUucmVtb3ZlQXR0cmlidXRlICkgewoKCQkJCQkvLyBTZXR0aW5nIHN0eWxlLmZpbHRlciB0byBudWxsLCAiIiAmICIgIiBzdGlsbCBsZWF2ZSAiZmlsdGVyOiIgaW4gdGhlIGNzc1RleHQKCQkJCQkvLyBpZiAiZmlsdGVyOiIgaXMgcHJlc2VudCBhdCBhbGwsIGNsZWFyVHlwZSBpcyBkaXNhYmxlZCwgd2Ugd2FudCB0byBhdm9pZCB0aGlzCgkJCQkJLy8gc3R5bGUucmVtb3ZlQXR0cmlidXRlIGlzIElFIE9ubHksIGJ1dCBzbyBhcHBhcmVudGx5IGlzIHRoaXMgY29kZSBwYXRoLi4uCgkJCQkJc3R5bGUucmVtb3ZlQXR0cmlidXRlKCAiZmlsdGVyIiApOwoKCQkJCQkvLyBpZiB0aGVyZSBpcyBubyBmaWx0ZXIgc3R5bGUgYXBwbGllZCBpbiBhIGNzcyBydWxlCgkJCQkJLy8gb3IgdW5zZXQgaW5saW5lIG9wYWNpdHksIHdlIGFyZSBkb25lCgkJCQkJaWYgKCB2YWx1ZSA9PT0gIiIgfHwgY3VycmVudFN0eWxlICYmICFjdXJyZW50U3R5bGUuZmlsdGVyICkgewoJCQkJCQlyZXR1cm47CgkJCQkJfQoJCQkJfQoKCQkJCS8vIG90aGVyd2lzZSwgc2V0IG5ldyBmaWx0ZXIgdmFsdWVzCgkJCQlzdHlsZS5maWx0ZXIgPSByYWxwaGEudGVzdCggZmlsdGVyICkgPwoJCQkJCWZpbHRlci5yZXBsYWNlKCByYWxwaGEsIG9wYWNpdHkgKSA6CgkJCQkJZmlsdGVyICsgIiAiICsgb3BhY2l0eTsKCQkJfQoJCX07Cgl9CgoJalF1ZXJ5LmNzc0hvb2tzLm1hcmdpblJpZ2h0ID0gYWRkR2V0SG9va0lmKCBzdXBwb3J0LnJlbGlhYmxlTWFyZ2luUmlnaHQsCgkJZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkICkgewoJCQlpZiAoIGNvbXB1dGVkICkgewoJCQkJcmV0dXJuIHN3YXAoIGVsZW0sIHsgImRpc3BsYXkiOiAiaW5saW5lLWJsb2NrIiB9LAoJCQkJCWN1ckNTUywgWyBlbGVtLCAibWFyZ2luUmlnaHQiIF0gKTsKCQkJfQoJCX0KCSk7CgoJalF1ZXJ5LmNzc0hvb2tzLm1hcmdpbkxlZnQgPSBhZGRHZXRIb29rSWYoIHN1cHBvcnQucmVsaWFibGVNYXJnaW5MZWZ0LAoJCWZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCApIHsKCQkJaWYgKCBjb21wdXRlZCApIHsKCQkJCXJldHVybiAoCgkJCQkJcGFyc2VGbG9hdCggY3VyQ1NTKCBlbGVtLCAibWFyZ2luTGVmdCIgKSApIHx8CgoJCQkJCS8vIFN1cHBvcnQ6IElFPD0xMSsKCQkJCQkvLyBSdW5uaW5nIGdldEJvdW5kaW5nQ2xpZW50UmVjdCBvbiBhIGRpc2Nvbm5lY3RlZCBub2RlIGluIElFIHRocm93cyBhbiBlcnJvcgoJCQkJCS8vIFN1cHBvcnQ6IElFOCBvbmx5CgkJCQkJLy8gZ2V0Q2xpZW50UmVjdHMoKSBlcnJvcnMgb24gZGlzY29ubmVjdGVkIGVsZW1zCgkJCQkJKCBqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSApID8KCQkJCQkJZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0IC0KCQkJCQkJCXN3YXAoIGVsZW0sIHsgbWFyZ2luTGVmdDogMCB9LCBmdW5jdGlvbigpIHsKCQkJCQkJCQlyZXR1cm4gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0OwoJCQkJCQkJfSApIDoKCQkJCQkJMAoJCQkJCSkKCQkJCSkgKyAicHgiOwoJCQl9CgkJfQoJKTsKCgkvLyBUaGVzZSBob29rcyBhcmUgdXNlZCBieSBhbmltYXRlIHRvIGV4cGFuZCBwcm9wZXJ0aWVzCglqUXVlcnkuZWFjaCggewoJCW1hcmdpbjogIiIsCgkJcGFkZGluZzogIiIsCgkJYm9yZGVyOiAiV2lkdGgiCgl9LCBmdW5jdGlvbiggcHJlZml4LCBzdWZmaXggKSB7CgkJalF1ZXJ5LmNzc0hvb2tzWyBwcmVmaXggKyBzdWZmaXggXSA9IHsKCQkJZXhwYW5kOiBmdW5jdGlvbiggdmFsdWUgKSB7CgkJCQl2YXIgaSA9IDAsCgkJCQkJZXhwYW5kZWQgPSB7fSwKCgkJCQkJLy8gYXNzdW1lcyBhIHNpbmdsZSBudW1iZXIgaWYgbm90IGEgc3RyaW5nCgkJCQkJcGFydHMgPSB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciID8gdmFsdWUuc3BsaXQoICIgIiApIDogWyB2YWx1ZSBdOwoKCQkJCWZvciAoIDsgaSA8IDQ7IGkrKyApIHsKCQkJCQlleHBhbmRlZFsgcHJlZml4ICsgY3NzRXhwYW5kWyBpIF0gKyBzdWZmaXggXSA9CgkJCQkJCXBhcnRzWyBpIF0gfHwgcGFydHNbIGkgLSAyIF0gfHwgcGFydHNbIDAgXTsKCQkJCX0KCgkJCQlyZXR1cm4gZXhwYW5kZWQ7CgkJCX0KCQl9OwoKCQlpZiAoICFybWFyZ2luLnRlc3QoIHByZWZpeCApICkgewoJCQlqUXVlcnkuY3NzSG9va3NbIHByZWZpeCArIHN1ZmZpeCBdLnNldCA9IHNldFBvc2l0aXZlTnVtYmVyOwoJCX0KCX0gKTsKCglqUXVlcnkuZm4uZXh0ZW5kKCB7CgkJY3NzOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7CgkJCXJldHVybiBhY2Nlc3MoIHRoaXMsIGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSApIHsKCQkJCXZhciBzdHlsZXMsIGxlbiwKCQkJCQltYXAgPSB7fSwKCQkJCQlpID0gMDsKCgkJCQlpZiAoIGpRdWVyeS5pc0FycmF5KCBuYW1lICkgKSB7CgkJCQkJc3R5bGVzID0gZ2V0U3R5bGVzKCBlbGVtICk7CgkJCQkJbGVuID0gbmFtZS5sZW5ndGg7CgoJCQkJCWZvciAoIDsgaSA8IGxlbjsgaSsrICkgewoJCQkJCQltYXBbIG5hbWVbIGkgXSBdID0galF1ZXJ5LmNzcyggZWxlbSwgbmFtZVsgaSBdLCBmYWxzZSwgc3R5bGVzICk7CgkJCQkJfQoKCQkJCQlyZXR1cm4gbWFwOwoJCQkJfQoKCQkJCXJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8KCQkJCQlqUXVlcnkuc3R5bGUoIGVsZW0sIG5hbWUsIHZhbHVlICkgOgoJCQkJCWpRdWVyeS5jc3MoIGVsZW0sIG5hbWUgKTsKCQkJfSwgbmFtZSwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggPiAxICk7CgkJfSwKCQlzaG93OiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHNob3dIaWRlKCB0aGlzLCB0cnVlICk7CgkJfSwKCQloaWRlOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHNob3dIaWRlKCB0aGlzICk7CgkJfSwKCQl0b2dnbGU6IGZ1bmN0aW9uKCBzdGF0ZSApIHsKCQkJaWYgKCB0eXBlb2Ygc3RhdGUgPT09ICJib29sZWFuIiApIHsKCQkJCXJldHVybiBzdGF0ZSA/IHRoaXMuc2hvdygpIDogdGhpcy5oaWRlKCk7CgkJCX0KCgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJaWYgKCBpc0hpZGRlbiggdGhpcyApICkgewoJCQkJCWpRdWVyeSggdGhpcyApLnNob3coKTsKCQkJCX0gZWxzZSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkuaGlkZSgpOwoJCQkJfQoJCQl9ICk7CgkJfQoJfSApOwoKCglmdW5jdGlvbiBUd2VlbiggZWxlbSwgb3B0aW9ucywgcHJvcCwgZW5kLCBlYXNpbmcgKSB7CgkJcmV0dXJuIG5ldyBUd2Vlbi5wcm90b3R5cGUuaW5pdCggZWxlbSwgb3B0aW9ucywgcHJvcCwgZW5kLCBlYXNpbmcgKTsKCX0KCWpRdWVyeS5Ud2VlbiA9IFR3ZWVuOwoKCVR3ZWVuLnByb3RvdHlwZSA9IHsKCQljb25zdHJ1Y3RvcjogVHdlZW4sCgkJaW5pdDogZnVuY3Rpb24oIGVsZW0sIG9wdGlvbnMsIHByb3AsIGVuZCwgZWFzaW5nLCB1bml0ICkgewoJCQl0aGlzLmVsZW0gPSBlbGVtOwoJCQl0aGlzLnByb3AgPSBwcm9wOwoJCQl0aGlzLmVhc2luZyA9IGVhc2luZyB8fCBqUXVlcnkuZWFzaW5nLl9kZWZhdWx0OwoJCQl0aGlzLm9wdGlvbnMgPSBvcHRpb25zOwoJCQl0aGlzLnN0YXJ0ID0gdGhpcy5ub3cgPSB0aGlzLmN1cigpOwoJCQl0aGlzLmVuZCA9IGVuZDsKCQkJdGhpcy51bml0ID0gdW5pdCB8fCAoIGpRdWVyeS5jc3NOdW1iZXJbIHByb3AgXSA/ICIiIDogInB4IiApOwoJCX0sCgkJY3VyOiBmdW5jdGlvbigpIHsKCQkJdmFyIGhvb2tzID0gVHdlZW4ucHJvcEhvb2tzWyB0aGlzLnByb3AgXTsKCgkJCXJldHVybiBob29rcyAmJiBob29rcy5nZXQgPwoJCQkJaG9va3MuZ2V0KCB0aGlzICkgOgoJCQkJVHdlZW4ucHJvcEhvb2tzLl9kZWZhdWx0LmdldCggdGhpcyApOwoJCX0sCgkJcnVuOiBmdW5jdGlvbiggcGVyY2VudCApIHsKCQkJdmFyIGVhc2VkLAoJCQkJaG9va3MgPSBUd2Vlbi5wcm9wSG9va3NbIHRoaXMucHJvcCBdOwoKCQkJaWYgKCB0aGlzLm9wdGlvbnMuZHVyYXRpb24gKSB7CgkJCQl0aGlzLnBvcyA9IGVhc2VkID0galF1ZXJ5LmVhc2luZ1sgdGhpcy5lYXNpbmcgXSgKCQkJCQlwZXJjZW50LCB0aGlzLm9wdGlvbnMuZHVyYXRpb24gKiBwZXJjZW50LCAwLCAxLCB0aGlzLm9wdGlvbnMuZHVyYXRpb24KCQkJCSk7CgkJCX0gZWxzZSB7CgkJCQl0aGlzLnBvcyA9IGVhc2VkID0gcGVyY2VudDsKCQkJfQoJCQl0aGlzLm5vdyA9ICggdGhpcy5lbmQgLSB0aGlzLnN0YXJ0ICkgKiBlYXNlZCArIHRoaXMuc3RhcnQ7CgoJCQlpZiAoIHRoaXMub3B0aW9ucy5zdGVwICkgewoJCQkJdGhpcy5vcHRpb25zLnN0ZXAuY2FsbCggdGhpcy5lbGVtLCB0aGlzLm5vdywgdGhpcyApOwoJCQl9CgoJCQlpZiAoIGhvb2tzICYmIGhvb2tzLnNldCApIHsKCQkJCWhvb2tzLnNldCggdGhpcyApOwoJCQl9IGVsc2UgewoJCQkJVHdlZW4ucHJvcEhvb2tzLl9kZWZhdWx0LnNldCggdGhpcyApOwoJCQl9CgkJCXJldHVybiB0aGlzOwoJCX0KCX07CgoJVHdlZW4ucHJvdG90eXBlLmluaXQucHJvdG90eXBlID0gVHdlZW4ucHJvdG90eXBlOwoKCVR3ZWVuLnByb3BIb29rcyA9IHsKCQlfZGVmYXVsdDogewoJCQlnZXQ6IGZ1bmN0aW9uKCB0d2VlbiApIHsKCQkJCXZhciByZXN1bHQ7CgoJCQkJLy8gVXNlIGEgcHJvcGVydHkgb24gdGhlIGVsZW1lbnQgZGlyZWN0bHkgd2hlbiBpdCBpcyBub3QgYSBET00gZWxlbWVudCwKCQkJCS8vIG9yIHdoZW4gdGhlcmUgaXMgbm8gbWF0Y2hpbmcgc3R5bGUgcHJvcGVydHkgdGhhdCBleGlzdHMuCgkJCQlpZiAoIHR3ZWVuLmVsZW0ubm9kZVR5cGUgIT09IDEgfHwKCQkJCQl0d2Vlbi5lbGVtWyB0d2Vlbi5wcm9wIF0gIT0gbnVsbCAmJiB0d2Vlbi5lbGVtLnN0eWxlWyB0d2Vlbi5wcm9wIF0gPT0gbnVsbCApIHsKCQkJCQlyZXR1cm4gdHdlZW4uZWxlbVsgdHdlZW4ucHJvcCBdOwoJCQkJfQoKCQkJCS8vIHBhc3NpbmcgYW4gZW1wdHkgc3RyaW5nIGFzIGEgM3JkIHBhcmFtZXRlciB0byAuY3NzIHdpbGwgYXV0b21hdGljYWxseQoJCQkJLy8gYXR0ZW1wdCBhIHBhcnNlRmxvYXQgYW5kIGZhbGxiYWNrIHRvIGEgc3RyaW5nIGlmIHRoZSBwYXJzZSBmYWlscwoJCQkJLy8gc28sIHNpbXBsZSB2YWx1ZXMgc3VjaCBhcyAiMTBweCIgYXJlIHBhcnNlZCB0byBGbG9hdC4KCQkJCS8vIGNvbXBsZXggdmFsdWVzIHN1Y2ggYXMgInJvdGF0ZSgxcmFkKSIgYXJlIHJldHVybmVkIGFzIGlzLgoJCQkJcmVzdWx0ID0galF1ZXJ5LmNzcyggdHdlZW4uZWxlbSwgdHdlZW4ucHJvcCwgIiIgKTsKCgkJCQkvLyBFbXB0eSBzdHJpbmdzLCBudWxsLCB1bmRlZmluZWQgYW5kICJhdXRvIiBhcmUgY29udmVydGVkIHRvIDAuCgkJCQlyZXR1cm4gIXJlc3VsdCB8fCByZXN1bHQgPT09ICJhdXRvIiA/IDAgOiByZXN1bHQ7CgkJCX0sCgkJCXNldDogZnVuY3Rpb24oIHR3ZWVuICkgewoKCQkJCS8vIHVzZSBzdGVwIGhvb2sgZm9yIGJhY2sgY29tcGF0IC0gdXNlIGNzc0hvb2sgaWYgaXRzIHRoZXJlIC0gdXNlIC5zdHlsZSBpZiBpdHMKCQkJCS8vIGF2YWlsYWJsZSBhbmQgdXNlIHBsYWluIHByb3BlcnRpZXMgd2hlcmUgYXZhaWxhYmxlCgkJCQlpZiAoIGpRdWVyeS5meC5zdGVwWyB0d2Vlbi5wcm9wIF0gKSB7CgkJCQkJalF1ZXJ5LmZ4LnN0ZXBbIHR3ZWVuLnByb3AgXSggdHdlZW4gKTsKCQkJCX0gZWxzZSBpZiAoIHR3ZWVuLmVsZW0ubm9kZVR5cGUgPT09IDEgJiYKCQkJCQkoIHR3ZWVuLmVsZW0uc3R5bGVbIGpRdWVyeS5jc3NQcm9wc1sgdHdlZW4ucHJvcCBdIF0gIT0gbnVsbCB8fAoJCQkJCQlqUXVlcnkuY3NzSG9va3NbIHR3ZWVuLnByb3AgXSApICkgewoJCQkJCWpRdWVyeS5zdHlsZSggdHdlZW4uZWxlbSwgdHdlZW4ucHJvcCwgdHdlZW4ubm93ICsgdHdlZW4udW5pdCApOwoJCQkJfSBlbHNlIHsKCQkJCQl0d2Vlbi5lbGVtWyB0d2Vlbi5wcm9wIF0gPSB0d2Vlbi5ub3c7CgkJCQl9CgkJCX0KCQl9Cgl9OwoKCS8vIFN1cHBvcnQ6IElFIDw9OQoJLy8gUGFuaWMgYmFzZWQgYXBwcm9hY2ggdG8gc2V0dGluZyB0aGluZ3Mgb24gZGlzY29ubmVjdGVkIG5vZGVzCgoJVHdlZW4ucHJvcEhvb2tzLnNjcm9sbFRvcCA9IFR3ZWVuLnByb3BIb29rcy5zY3JvbGxMZWZ0ID0gewoJCXNldDogZnVuY3Rpb24oIHR3ZWVuICkgewoJCQlpZiAoIHR3ZWVuLmVsZW0ubm9kZVR5cGUgJiYgdHdlZW4uZWxlbS5wYXJlbnROb2RlICkgewoJCQkJdHdlZW4uZWxlbVsgdHdlZW4ucHJvcCBdID0gdHdlZW4ubm93OwoJCQl9CgkJfQoJfTsKCglqUXVlcnkuZWFzaW5nID0gewoJCWxpbmVhcjogZnVuY3Rpb24oIHAgKSB7CgkJCXJldHVybiBwOwoJCX0sCgkJc3dpbmc6IGZ1bmN0aW9uKCBwICkgewoJCQlyZXR1cm4gMC41IC0gTWF0aC5jb3MoIHAgKiBNYXRoLlBJICkgLyAyOwoJCX0sCgkJX2RlZmF1bHQ6ICJzd2luZyIKCX07CgoJalF1ZXJ5LmZ4ID0gVHdlZW4ucHJvdG90eXBlLmluaXQ7CgoJLy8gQmFjayBDb21wYXQgPDEuOCBleHRlbnNpb24gcG9pbnQKCWpRdWVyeS5meC5zdGVwID0ge307CgoKCgoJdmFyCgkJZnhOb3csIHRpbWVySWQsCgkJcmZ4dHlwZXMgPSAvXig/OnRvZ2dsZXxzaG93fGhpZGUpJC8sCgkJcnJ1biA9IC9xdWV1ZUhvb2tzJC87CgoJLy8gQW5pbWF0aW9ucyBjcmVhdGVkIHN5bmNocm9ub3VzbHkgd2lsbCBydW4gc3luY2hyb25vdXNseQoJZnVuY3Rpb24gY3JlYXRlRnhOb3coKSB7CgkJd2luZG93LnNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgewoJCQlmeE5vdyA9IHVuZGVmaW5lZDsKCQl9ICk7CgkJcmV0dXJuICggZnhOb3cgPSBqUXVlcnkubm93KCkgKTsKCX0KCgkvLyBHZW5lcmF0ZSBwYXJhbWV0ZXJzIHRvIGNyZWF0ZSBhIHN0YW5kYXJkIGFuaW1hdGlvbgoJZnVuY3Rpb24gZ2VuRngoIHR5cGUsIGluY2x1ZGVXaWR0aCApIHsKCQl2YXIgd2hpY2gsCgkJCWF0dHJzID0geyBoZWlnaHQ6IHR5cGUgfSwKCQkJaSA9IDA7CgoJCS8vIGlmIHdlIGluY2x1ZGUgd2lkdGgsIHN0ZXAgdmFsdWUgaXMgMSB0byBkbyBhbGwgY3NzRXhwYW5kIHZhbHVlcywKCQkvLyBpZiB3ZSBkb24ndCBpbmNsdWRlIHdpZHRoLCBzdGVwIHZhbHVlIGlzIDIgdG8gc2tpcCBvdmVyIExlZnQgYW5kIFJpZ2h0CgkJaW5jbHVkZVdpZHRoID0gaW5jbHVkZVdpZHRoID8gMSA6IDA7CgkJZm9yICggOyBpIDwgNCA7IGkgKz0gMiAtIGluY2x1ZGVXaWR0aCApIHsKCQkJd2hpY2ggPSBjc3NFeHBhbmRbIGkgXTsKCQkJYXR0cnNbICJtYXJnaW4iICsgd2hpY2ggXSA9IGF0dHJzWyAicGFkZGluZyIgKyB3aGljaCBdID0gdHlwZTsKCQl9CgoJCWlmICggaW5jbHVkZVdpZHRoICkgewoJCQlhdHRycy5vcGFjaXR5ID0gYXR0cnMud2lkdGggPSB0eXBlOwoJCX0KCgkJcmV0dXJuIGF0dHJzOwoJfQoKCWZ1bmN0aW9uIGNyZWF0ZVR3ZWVuKCB2YWx1ZSwgcHJvcCwgYW5pbWF0aW9uICkgewoJCXZhciB0d2VlbiwKCQkJY29sbGVjdGlvbiA9ICggQW5pbWF0aW9uLnR3ZWVuZXJzWyBwcm9wIF0gfHwgW10gKS5jb25jYXQoIEFuaW1hdGlvbi50d2VlbmVyc1sgIioiIF0gKSwKCQkJaW5kZXggPSAwLAoJCQlsZW5ndGggPSBjb2xsZWN0aW9uLmxlbmd0aDsKCQlmb3IgKCA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrICkgewoJCQlpZiAoICggdHdlZW4gPSBjb2xsZWN0aW9uWyBpbmRleCBdLmNhbGwoIGFuaW1hdGlvbiwgcHJvcCwgdmFsdWUgKSApICkgewoKCQkJCS8vIHdlJ3JlIGRvbmUgd2l0aCB0aGlzIHByb3BlcnR5CgkJCQlyZXR1cm4gdHdlZW47CgkJCX0KCQl9Cgl9CgoJZnVuY3Rpb24gZGVmYXVsdFByZWZpbHRlciggZWxlbSwgcHJvcHMsIG9wdHMgKSB7CgkJLyoganNoaW50IHZhbGlkdGhpczogdHJ1ZSAqLwoJCXZhciBwcm9wLCB2YWx1ZSwgdG9nZ2xlLCB0d2VlbiwgaG9va3MsIG9sZGZpcmUsIGRpc3BsYXksIGNoZWNrRGlzcGxheSwKCQkJYW5pbSA9IHRoaXMsCgkJCW9yaWcgPSB7fSwKCQkJc3R5bGUgPSBlbGVtLnN0eWxlLAoJCQloaWRkZW4gPSBlbGVtLm5vZGVUeXBlICYmIGlzSGlkZGVuKCBlbGVtICksCgkJCWRhdGFTaG93ID0galF1ZXJ5Ll9kYXRhKCBlbGVtLCAiZnhzaG93IiApOwoKCQkvLyBoYW5kbGUgcXVldWU6IGZhbHNlIHByb21pc2VzCgkJaWYgKCAhb3B0cy5xdWV1ZSApIHsKCQkJaG9va3MgPSBqUXVlcnkuX3F1ZXVlSG9va3MoIGVsZW0sICJmeCIgKTsKCQkJaWYgKCBob29rcy51bnF1ZXVlZCA9PSBudWxsICkgewoJCQkJaG9va3MudW5xdWV1ZWQgPSAwOwoJCQkJb2xkZmlyZSA9IGhvb2tzLmVtcHR5LmZpcmU7CgkJCQlob29rcy5lbXB0eS5maXJlID0gZnVuY3Rpb24oKSB7CgkJCQkJaWYgKCAhaG9va3MudW5xdWV1ZWQgKSB7CgkJCQkJCW9sZGZpcmUoKTsKCQkJCQl9CgkJCQl9OwoJCQl9CgkJCWhvb2tzLnVucXVldWVkKys7CgoJCQlhbmltLmFsd2F5cyggZnVuY3Rpb24oKSB7CgoJCQkJLy8gZG9pbmcgdGhpcyBtYWtlcyBzdXJlIHRoYXQgdGhlIGNvbXBsZXRlIGhhbmRsZXIgd2lsbCBiZSBjYWxsZWQKCQkJCS8vIGJlZm9yZSB0aGlzIGNvbXBsZXRlcwoJCQkJYW5pbS5hbHdheXMoIGZ1bmN0aW9uKCkgewoJCQkJCWhvb2tzLnVucXVldWVkLS07CgkJCQkJaWYgKCAhalF1ZXJ5LnF1ZXVlKCBlbGVtLCAiZngiICkubGVuZ3RoICkgewoJCQkJCQlob29rcy5lbXB0eS5maXJlKCk7CgkJCQkJfQoJCQkJfSApOwoJCQl9ICk7CgkJfQoKCQkvLyBoZWlnaHQvd2lkdGggb3ZlcmZsb3cgcGFzcwoJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiAoICJoZWlnaHQiIGluIHByb3BzIHx8ICJ3aWR0aCIgaW4gcHJvcHMgKSApIHsKCgkJCS8vIE1ha2Ugc3VyZSB0aGF0IG5vdGhpbmcgc25lYWtzIG91dAoJCQkvLyBSZWNvcmQgYWxsIDMgb3ZlcmZsb3cgYXR0cmlidXRlcyBiZWNhdXNlIElFIGRvZXMgbm90CgkJCS8vIGNoYW5nZSB0aGUgb3ZlcmZsb3cgYXR0cmlidXRlIHdoZW4gb3ZlcmZsb3dYIGFuZAoJCQkvLyBvdmVyZmxvd1kgYXJlIHNldCB0byB0aGUgc2FtZSB2YWx1ZQoJCQlvcHRzLm92ZXJmbG93ID0gWyBzdHlsZS5vdmVyZmxvdywgc3R5bGUub3ZlcmZsb3dYLCBzdHlsZS5vdmVyZmxvd1kgXTsKCgkJCS8vIFNldCBkaXNwbGF5IHByb3BlcnR5IHRvIGlubGluZS1ibG9jayBmb3IgaGVpZ2h0L3dpZHRoCgkJCS8vIGFuaW1hdGlvbnMgb24gaW5saW5lIGVsZW1lbnRzIHRoYXQgYXJlIGhhdmluZyB3aWR0aC9oZWlnaHQgYW5pbWF0ZWQKCQkJZGlzcGxheSA9IGpRdWVyeS5jc3MoIGVsZW0sICJkaXNwbGF5IiApOwoKCQkJLy8gVGVzdCBkZWZhdWx0IGRpc3BsYXkgaWYgZGlzcGxheSBpcyBjdXJyZW50bHkgIm5vbmUiCgkJCWNoZWNrRGlzcGxheSA9IGRpc3BsYXkgPT09ICJub25lIiA/CgkJCQlqUXVlcnkuX2RhdGEoIGVsZW0sICJvbGRkaXNwbGF5IiApIHx8IGRlZmF1bHREaXNwbGF5KCBlbGVtLm5vZGVOYW1lICkgOiBkaXNwbGF5OwoKCQkJaWYgKCBjaGVja0Rpc3BsYXkgPT09ICJpbmxpbmUiICYmIGpRdWVyeS5jc3MoIGVsZW0sICJmbG9hdCIgKSA9PT0gIm5vbmUiICkgewoKCQkJCS8vIGlubGluZS1sZXZlbCBlbGVtZW50cyBhY2NlcHQgaW5saW5lLWJsb2NrOwoJCQkJLy8gYmxvY2stbGV2ZWwgZWxlbWVudHMgbmVlZCB0byBiZSBpbmxpbmUgd2l0aCBsYXlvdXQKCQkJCWlmICggIXN1cHBvcnQuaW5saW5lQmxvY2tOZWVkc0xheW91dCB8fCBkZWZhdWx0RGlzcGxheSggZWxlbS5ub2RlTmFtZSApID09PSAiaW5saW5lIiApIHsKCQkJCQlzdHlsZS5kaXNwbGF5ID0gImlubGluZS1ibG9jayI7CgkJCQl9IGVsc2UgewoJCQkJCXN0eWxlLnpvb20gPSAxOwoJCQkJfQoJCQl9CgkJfQoKCQlpZiAoIG9wdHMub3ZlcmZsb3cgKSB7CgkJCXN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CgkJCWlmICggIXN1cHBvcnQuc2hyaW5rV3JhcEJsb2NrcygpICkgewoJCQkJYW5pbS5hbHdheXMoIGZ1bmN0aW9uKCkgewoJCQkJCXN0eWxlLm92ZXJmbG93ID0gb3B0cy5vdmVyZmxvd1sgMCBdOwoJCQkJCXN0eWxlLm92ZXJmbG93WCA9IG9wdHMub3ZlcmZsb3dbIDEgXTsKCQkJCQlzdHlsZS5vdmVyZmxvd1kgPSBvcHRzLm92ZXJmbG93WyAyIF07CgkJCQl9ICk7CgkJCX0KCQl9CgoJCS8vIHNob3cvaGlkZSBwYXNzCgkJZm9yICggcHJvcCBpbiBwcm9wcyApIHsKCQkJdmFsdWUgPSBwcm9wc1sgcHJvcCBdOwoJCQlpZiAoIHJmeHR5cGVzLmV4ZWMoIHZhbHVlICkgKSB7CgkJCQlkZWxldGUgcHJvcHNbIHByb3AgXTsKCQkJCXRvZ2dsZSA9IHRvZ2dsZSB8fCB2YWx1ZSA9PT0gInRvZ2dsZSI7CgkJCQlpZiAoIHZhbHVlID09PSAoIGhpZGRlbiA/ICJoaWRlIiA6ICJzaG93IiApICkgewoKCQkJCQkvLyBJZiB0aGVyZSBpcyBkYXRhU2hvdyBsZWZ0IG92ZXIgZnJvbSBhIHN0b3BwZWQgaGlkZSBvciBzaG93CgkJCQkJLy8gYW5kIHdlIGFyZSBnb2luZyB0byBwcm9jZWVkIHdpdGggc2hvdywgd2Ugc2hvdWxkIHByZXRlbmQgdG8gYmUgaGlkZGVuCgkJCQkJaWYgKCB2YWx1ZSA9PT0gInNob3ciICYmIGRhdGFTaG93ICYmIGRhdGFTaG93WyBwcm9wIF0gIT09IHVuZGVmaW5lZCApIHsKCQkJCQkJaGlkZGVuID0gdHJ1ZTsKCQkJCQl9IGVsc2UgewoJCQkJCQljb250aW51ZTsKCQkJCQl9CgkJCQl9CgkJCQlvcmlnWyBwcm9wIF0gPSBkYXRhU2hvdyAmJiBkYXRhU2hvd1sgcHJvcCBdIHx8IGpRdWVyeS5zdHlsZSggZWxlbSwgcHJvcCApOwoKCQkJLy8gQW55IG5vbi1meCB2YWx1ZSBzdG9wcyB1cyBmcm9tIHJlc3RvcmluZyB0aGUgb3JpZ2luYWwgZGlzcGxheSB2YWx1ZQoJCQl9IGVsc2UgewoJCQkJZGlzcGxheSA9IHVuZGVmaW5lZDsKCQkJfQoJCX0KCgkJaWYgKCAhalF1ZXJ5LmlzRW1wdHlPYmplY3QoIG9yaWcgKSApIHsKCQkJaWYgKCBkYXRhU2hvdyApIHsKCQkJCWlmICggImhpZGRlbiIgaW4gZGF0YVNob3cgKSB7CgkJCQkJaGlkZGVuID0gZGF0YVNob3cuaGlkZGVuOwoJCQkJfQoJCQl9IGVsc2UgewoJCQkJZGF0YVNob3cgPSBqUXVlcnkuX2RhdGEoIGVsZW0sICJmeHNob3ciLCB7fSApOwoJCQl9CgoJCQkvLyBzdG9yZSBzdGF0ZSBpZiBpdHMgdG9nZ2xlIC0gZW5hYmxlcyAuc3RvcCgpLnRvZ2dsZSgpIHRvICJyZXZlcnNlIgoJCQlpZiAoIHRvZ2dsZSApIHsKCQkJCWRhdGFTaG93LmhpZGRlbiA9ICFoaWRkZW47CgkJCX0KCQkJaWYgKCBoaWRkZW4gKSB7CgkJCQlqUXVlcnkoIGVsZW0gKS5zaG93KCk7CgkJCX0gZWxzZSB7CgkJCQlhbmltLmRvbmUoIGZ1bmN0aW9uKCkgewoJCQkJCWpRdWVyeSggZWxlbSApLmhpZGUoKTsKCQkJCX0gKTsKCQkJfQoJCQlhbmltLmRvbmUoIGZ1bmN0aW9uKCkgewoJCQkJdmFyIHByb3A7CgkJCQlqUXVlcnkuX3JlbW92ZURhdGEoIGVsZW0sICJmeHNob3ciICk7CgkJCQlmb3IgKCBwcm9wIGluIG9yaWcgKSB7CgkJCQkJalF1ZXJ5LnN0eWxlKCBlbGVtLCBwcm9wLCBvcmlnWyBwcm9wIF0gKTsKCQkJCX0KCQkJfSApOwoJCQlmb3IgKCBwcm9wIGluIG9yaWcgKSB7CgkJCQl0d2VlbiA9IGNyZWF0ZVR3ZWVuKCBoaWRkZW4gPyBkYXRhU2hvd1sgcHJvcCBdIDogMCwgcHJvcCwgYW5pbSApOwoKCQkJCWlmICggISggcHJvcCBpbiBkYXRhU2hvdyApICkgewoJCQkJCWRhdGFTaG93WyBwcm9wIF0gPSB0d2Vlbi5zdGFydDsKCQkJCQlpZiAoIGhpZGRlbiApIHsKCQkJCQkJdHdlZW4uZW5kID0gdHdlZW4uc3RhcnQ7CgkJCQkJCXR3ZWVuLnN0YXJ0ID0gcHJvcCA9PT0gIndpZHRoIiB8fCBwcm9wID09PSAiaGVpZ2h0IiA/IDEgOiAwOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkvLyBJZiB0aGlzIGlzIGEgbm9vcCBsaWtlIC5oaWRlKCkuaGlkZSgpLCByZXN0b3JlIGFuIG92ZXJ3cml0dGVuIGRpc3BsYXkgdmFsdWUKCQl9IGVsc2UgaWYgKCAoIGRpc3BsYXkgPT09ICJub25lIiA/IGRlZmF1bHREaXNwbGF5KCBlbGVtLm5vZGVOYW1lICkgOiBkaXNwbGF5ICkgPT09ICJpbmxpbmUiICkgewoJCQlzdHlsZS5kaXNwbGF5ID0gZGlzcGxheTsKCQl9Cgl9CgoJZnVuY3Rpb24gcHJvcEZpbHRlciggcHJvcHMsIHNwZWNpYWxFYXNpbmcgKSB7CgkJdmFyIGluZGV4LCBuYW1lLCBlYXNpbmcsIHZhbHVlLCBob29rczsKCgkJLy8gY2FtZWxDYXNlLCBzcGVjaWFsRWFzaW5nIGFuZCBleHBhbmQgY3NzSG9vayBwYXNzCgkJZm9yICggaW5kZXggaW4gcHJvcHMgKSB7CgkJCW5hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKCBpbmRleCApOwoJCQllYXNpbmcgPSBzcGVjaWFsRWFzaW5nWyBuYW1lIF07CgkJCXZhbHVlID0gcHJvcHNbIGluZGV4IF07CgkJCWlmICggalF1ZXJ5LmlzQXJyYXkoIHZhbHVlICkgKSB7CgkJCQllYXNpbmcgPSB2YWx1ZVsgMSBdOwoJCQkJdmFsdWUgPSBwcm9wc1sgaW5kZXggXSA9IHZhbHVlWyAwIF07CgkJCX0KCgkJCWlmICggaW5kZXggIT09IG5hbWUgKSB7CgkJCQlwcm9wc1sgbmFtZSBdID0gdmFsdWU7CgkJCQlkZWxldGUgcHJvcHNbIGluZGV4IF07CgkJCX0KCgkJCWhvb2tzID0galF1ZXJ5LmNzc0hvb2tzWyBuYW1lIF07CgkJCWlmICggaG9va3MgJiYgImV4cGFuZCIgaW4gaG9va3MgKSB7CgkJCQl2YWx1ZSA9IGhvb2tzLmV4cGFuZCggdmFsdWUgKTsKCQkJCWRlbGV0ZSBwcm9wc1sgbmFtZSBdOwoKCQkJCS8vIG5vdCBxdWl0ZSAkLmV4dGVuZCwgdGhpcyB3b250IG92ZXJ3cml0ZSBrZXlzIGFscmVhZHkgcHJlc2VudC4KCQkJCS8vIGFsc28gLSByZXVzaW5nICdpbmRleCcgZnJvbSBhYm92ZSBiZWNhdXNlIHdlIGhhdmUgdGhlIGNvcnJlY3QgIm5hbWUiCgkJCQlmb3IgKCBpbmRleCBpbiB2YWx1ZSApIHsKCQkJCQlpZiAoICEoIGluZGV4IGluIHByb3BzICkgKSB7CgkJCQkJCXByb3BzWyBpbmRleCBdID0gdmFsdWVbIGluZGV4IF07CgkJCQkJCXNwZWNpYWxFYXNpbmdbIGluZGV4IF0gPSBlYXNpbmc7CgkJCQkJfQoJCQkJfQoJCQl9IGVsc2UgewoJCQkJc3BlY2lhbEVhc2luZ1sgbmFtZSBdID0gZWFzaW5nOwoJCQl9CgkJfQoJfQoKCWZ1bmN0aW9uIEFuaW1hdGlvbiggZWxlbSwgcHJvcGVydGllcywgb3B0aW9ucyApIHsKCQl2YXIgcmVzdWx0LAoJCQlzdG9wcGVkLAoJCQlpbmRleCA9IDAsCgkJCWxlbmd0aCA9IEFuaW1hdGlvbi5wcmVmaWx0ZXJzLmxlbmd0aCwKCQkJZGVmZXJyZWQgPSBqUXVlcnkuRGVmZXJyZWQoKS5hbHdheXMoIGZ1bmN0aW9uKCkgewoKCQkJCS8vIGRvbid0IG1hdGNoIGVsZW0gaW4gdGhlIDphbmltYXRlZCBzZWxlY3RvcgoJCQkJZGVsZXRlIHRpY2suZWxlbTsKCQkJfSApLAoJCQl0aWNrID0gZnVuY3Rpb24oKSB7CgkJCQlpZiAoIHN0b3BwZWQgKSB7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQkJdmFyIGN1cnJlbnRUaW1lID0gZnhOb3cgfHwgY3JlYXRlRnhOb3coKSwKCQkJCQlyZW1haW5pbmcgPSBNYXRoLm1heCggMCwgYW5pbWF0aW9uLnN0YXJ0VGltZSArIGFuaW1hdGlvbi5kdXJhdGlvbiAtIGN1cnJlbnRUaW1lICksCgoJCQkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zCgkJCQkJLy8gQXJjaGFpYyBjcmFzaCBidWcgd29uJ3QgYWxsb3cgdXMgdG8gdXNlIGAxIC0gKCAwLjUgfHwgMCApYCAoIzEyNDk3KQoJCQkJCXRlbXAgPSByZW1haW5pbmcgLyBhbmltYXRpb24uZHVyYXRpb24gfHwgMCwKCQkJCQlwZXJjZW50ID0gMSAtIHRlbXAsCgkJCQkJaW5kZXggPSAwLAoJCQkJCWxlbmd0aCA9IGFuaW1hdGlvbi50d2VlbnMubGVuZ3RoOwoKCQkJCWZvciAoIDsgaW5kZXggPCBsZW5ndGggOyBpbmRleCsrICkgewoJCQkJCWFuaW1hdGlvbi50d2VlbnNbIGluZGV4IF0ucnVuKCBwZXJjZW50ICk7CgkJCQl9CgoJCQkJZGVmZXJyZWQubm90aWZ5V2l0aCggZWxlbSwgWyBhbmltYXRpb24sIHBlcmNlbnQsIHJlbWFpbmluZyBdICk7CgoJCQkJaWYgKCBwZXJjZW50IDwgMSAmJiBsZW5ndGggKSB7CgkJCQkJcmV0dXJuIHJlbWFpbmluZzsKCQkJCX0gZWxzZSB7CgkJCQkJZGVmZXJyZWQucmVzb2x2ZVdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uIF0gKTsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCX0sCgkJCWFuaW1hdGlvbiA9IGRlZmVycmVkLnByb21pc2UoIHsKCQkJCWVsZW06IGVsZW0sCgkJCQlwcm9wczogalF1ZXJ5LmV4dGVuZCgge30sIHByb3BlcnRpZXMgKSwKCQkJCW9wdHM6IGpRdWVyeS5leHRlbmQoIHRydWUsIHsKCQkJCQlzcGVjaWFsRWFzaW5nOiB7fSwKCQkJCQllYXNpbmc6IGpRdWVyeS5lYXNpbmcuX2RlZmF1bHQKCQkJCX0sIG9wdGlvbnMgKSwKCQkJCW9yaWdpbmFsUHJvcGVydGllczogcHJvcGVydGllcywKCQkJCW9yaWdpbmFsT3B0aW9uczogb3B0aW9ucywKCQkJCXN0YXJ0VGltZTogZnhOb3cgfHwgY3JlYXRlRnhOb3coKSwKCQkJCWR1cmF0aW9uOiBvcHRpb25zLmR1cmF0aW9uLAoJCQkJdHdlZW5zOiBbXSwKCQkJCWNyZWF0ZVR3ZWVuOiBmdW5jdGlvbiggcHJvcCwgZW5kICkgewoJCQkJCXZhciB0d2VlbiA9IGpRdWVyeS5Ud2VlbiggZWxlbSwgYW5pbWF0aW9uLm9wdHMsIHByb3AsIGVuZCwKCQkJCQkJCWFuaW1hdGlvbi5vcHRzLnNwZWNpYWxFYXNpbmdbIHByb3AgXSB8fCBhbmltYXRpb24ub3B0cy5lYXNpbmcgKTsKCQkJCQlhbmltYXRpb24udHdlZW5zLnB1c2goIHR3ZWVuICk7CgkJCQkJcmV0dXJuIHR3ZWVuOwoJCQkJfSwKCQkJCXN0b3A6IGZ1bmN0aW9uKCBnb3RvRW5kICkgewoJCQkJCXZhciBpbmRleCA9IDAsCgoJCQkJCQkvLyBpZiB3ZSBhcmUgZ29pbmcgdG8gdGhlIGVuZCwgd2Ugd2FudCB0byBydW4gYWxsIHRoZSB0d2VlbnMKCQkJCQkJLy8gb3RoZXJ3aXNlIHdlIHNraXAgdGhpcyBwYXJ0CgkJCQkJCWxlbmd0aCA9IGdvdG9FbmQgPyBhbmltYXRpb24udHdlZW5zLmxlbmd0aCA6IDA7CgkJCQkJaWYgKCBzdG9wcGVkICkgewoJCQkJCQlyZXR1cm4gdGhpczsKCQkJCQl9CgkJCQkJc3RvcHBlZCA9IHRydWU7CgkJCQkJZm9yICggOyBpbmRleCA8IGxlbmd0aCA7IGluZGV4KysgKSB7CgkJCQkJCWFuaW1hdGlvbi50d2VlbnNbIGluZGV4IF0ucnVuKCAxICk7CgkJCQkJfQoKCQkJCQkvLyByZXNvbHZlIHdoZW4gd2UgcGxheWVkIHRoZSBsYXN0IGZyYW1lCgkJCQkJLy8gb3RoZXJ3aXNlLCByZWplY3QKCQkJCQlpZiAoIGdvdG9FbmQgKSB7CgkJCQkJCWRlZmVycmVkLm5vdGlmeVdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uLCAxLCAwIF0gKTsKCQkJCQkJZGVmZXJyZWQucmVzb2x2ZVdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uLCBnb3RvRW5kIF0gKTsKCQkJCQl9IGVsc2UgewoJCQkJCQlkZWZlcnJlZC5yZWplY3RXaXRoKCBlbGVtLCBbIGFuaW1hdGlvbiwgZ290b0VuZCBdICk7CgkJCQkJfQoJCQkJCXJldHVybiB0aGlzOwoJCQkJfQoJCQl9ICksCgkJCXByb3BzID0gYW5pbWF0aW9uLnByb3BzOwoKCQlwcm9wRmlsdGVyKCBwcm9wcywgYW5pbWF0aW9uLm9wdHMuc3BlY2lhbEVhc2luZyApOwoKCQlmb3IgKCA7IGluZGV4IDwgbGVuZ3RoIDsgaW5kZXgrKyApIHsKCQkJcmVzdWx0ID0gQW5pbWF0aW9uLnByZWZpbHRlcnNbIGluZGV4IF0uY2FsbCggYW5pbWF0aW9uLCBlbGVtLCBwcm9wcywgYW5pbWF0aW9uLm9wdHMgKTsKCQkJaWYgKCByZXN1bHQgKSB7CgkJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCByZXN1bHQuc3RvcCApICkgewoJCQkJCWpRdWVyeS5fcXVldWVIb29rcyggYW5pbWF0aW9uLmVsZW0sIGFuaW1hdGlvbi5vcHRzLnF1ZXVlICkuc3RvcCA9CgkJCQkJCWpRdWVyeS5wcm94eSggcmVzdWx0LnN0b3AsIHJlc3VsdCApOwoJCQkJfQoJCQkJcmV0dXJuIHJlc3VsdDsKCQkJfQoJCX0KCgkJalF1ZXJ5Lm1hcCggcHJvcHMsIGNyZWF0ZVR3ZWVuLCBhbmltYXRpb24gKTsKCgkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggYW5pbWF0aW9uLm9wdHMuc3RhcnQgKSApIHsKCQkJYW5pbWF0aW9uLm9wdHMuc3RhcnQuY2FsbCggZWxlbSwgYW5pbWF0aW9uICk7CgkJfQoKCQlqUXVlcnkuZngudGltZXIoCgkJCWpRdWVyeS5leHRlbmQoIHRpY2ssIHsKCQkJCWVsZW06IGVsZW0sCgkJCQlhbmltOiBhbmltYXRpb24sCgkJCQlxdWV1ZTogYW5pbWF0aW9uLm9wdHMucXVldWUKCQkJfSApCgkJKTsKCgkJLy8gYXR0YWNoIGNhbGxiYWNrcyBmcm9tIG9wdGlvbnMKCQlyZXR1cm4gYW5pbWF0aW9uLnByb2dyZXNzKCBhbmltYXRpb24ub3B0cy5wcm9ncmVzcyApCgkJCS5kb25lKCBhbmltYXRpb24ub3B0cy5kb25lLCBhbmltYXRpb24ub3B0cy5jb21wbGV0ZSApCgkJCS5mYWlsKCBhbmltYXRpb24ub3B0cy5mYWlsICkKCQkJLmFsd2F5cyggYW5pbWF0aW9uLm9wdHMuYWx3YXlzICk7Cgl9CgoJalF1ZXJ5LkFuaW1hdGlvbiA9IGpRdWVyeS5leHRlbmQoIEFuaW1hdGlvbiwgewoKCQl0d2VlbmVyczogewoJCQkiKiI6IFsgZnVuY3Rpb24oIHByb3AsIHZhbHVlICkgewoJCQkJdmFyIHR3ZWVuID0gdGhpcy5jcmVhdGVUd2VlbiggcHJvcCwgdmFsdWUgKTsKCQkJCWFkanVzdENTUyggdHdlZW4uZWxlbSwgcHJvcCwgcmNzc051bS5leGVjKCB2YWx1ZSApLCB0d2VlbiApOwoJCQkJcmV0dXJuIHR3ZWVuOwoJCQl9IF0KCQl9LAoKCQl0d2VlbmVyOiBmdW5jdGlvbiggcHJvcHMsIGNhbGxiYWNrICkgewoJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBwcm9wcyApICkgewoJCQkJY2FsbGJhY2sgPSBwcm9wczsKCQkJCXByb3BzID0gWyAiKiIgXTsKCQkJfSBlbHNlIHsKCQkJCXByb3BzID0gcHJvcHMubWF0Y2goIHJub3R3aGl0ZSApOwoJCQl9CgoJCQl2YXIgcHJvcCwKCQkJCWluZGV4ID0gMCwKCQkJCWxlbmd0aCA9IHByb3BzLmxlbmd0aDsKCgkJCWZvciAoIDsgaW5kZXggPCBsZW5ndGggOyBpbmRleCsrICkgewoJCQkJcHJvcCA9IHByb3BzWyBpbmRleCBdOwoJCQkJQW5pbWF0aW9uLnR3ZWVuZXJzWyBwcm9wIF0gPSBBbmltYXRpb24udHdlZW5lcnNbIHByb3AgXSB8fCBbXTsKCQkJCUFuaW1hdGlvbi50d2VlbmVyc1sgcHJvcCBdLnVuc2hpZnQoIGNhbGxiYWNrICk7CgkJCX0KCQl9LAoKCQlwcmVmaWx0ZXJzOiBbIGRlZmF1bHRQcmVmaWx0ZXIgXSwKCgkJcHJlZmlsdGVyOiBmdW5jdGlvbiggY2FsbGJhY2ssIHByZXBlbmQgKSB7CgkJCWlmICggcHJlcGVuZCApIHsKCQkJCUFuaW1hdGlvbi5wcmVmaWx0ZXJzLnVuc2hpZnQoIGNhbGxiYWNrICk7CgkJCX0gZWxzZSB7CgkJCQlBbmltYXRpb24ucHJlZmlsdGVycy5wdXNoKCBjYWxsYmFjayApOwoJCQl9CgkJfQoJfSApOwoKCWpRdWVyeS5zcGVlZCA9IGZ1bmN0aW9uKCBzcGVlZCwgZWFzaW5nLCBmbiApIHsKCQl2YXIgb3B0ID0gc3BlZWQgJiYgdHlwZW9mIHNwZWVkID09PSAib2JqZWN0IiA/IGpRdWVyeS5leHRlbmQoIHt9LCBzcGVlZCApIDogewoJCQljb21wbGV0ZTogZm4gfHwgIWZuICYmIGVhc2luZyB8fAoJCQkJalF1ZXJ5LmlzRnVuY3Rpb24oIHNwZWVkICkgJiYgc3BlZWQsCgkJCWR1cmF0aW9uOiBzcGVlZCwKCQkJZWFzaW5nOiBmbiAmJiBlYXNpbmcgfHwgZWFzaW5nICYmICFqUXVlcnkuaXNGdW5jdGlvbiggZWFzaW5nICkgJiYgZWFzaW5nCgkJfTsKCgkJb3B0LmR1cmF0aW9uID0galF1ZXJ5LmZ4Lm9mZiA/IDAgOiB0eXBlb2Ygb3B0LmR1cmF0aW9uID09PSAibnVtYmVyIiA/IG9wdC5kdXJhdGlvbiA6CgkJCW9wdC5kdXJhdGlvbiBpbiBqUXVlcnkuZnguc3BlZWRzID8KCQkJCWpRdWVyeS5meC5zcGVlZHNbIG9wdC5kdXJhdGlvbiBdIDogalF1ZXJ5LmZ4LnNwZWVkcy5fZGVmYXVsdDsKCgkJLy8gbm9ybWFsaXplIG9wdC5xdWV1ZSAtIHRydWUvdW5kZWZpbmVkL251bGwgLT4gImZ4IgoJCWlmICggb3B0LnF1ZXVlID09IG51bGwgfHwgb3B0LnF1ZXVlID09PSB0cnVlICkgewoJCQlvcHQucXVldWUgPSAiZngiOwoJCX0KCgkJLy8gUXVldWVpbmcKCQlvcHQub2xkID0gb3B0LmNvbXBsZXRlOwoKCQlvcHQuY29tcGxldGUgPSBmdW5jdGlvbigpIHsKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggb3B0Lm9sZCApICkgewoJCQkJb3B0Lm9sZC5jYWxsKCB0aGlzICk7CgkJCX0KCgkJCWlmICggb3B0LnF1ZXVlICkgewoJCQkJalF1ZXJ5LmRlcXVldWUoIHRoaXMsIG9wdC5xdWV1ZSApOwoJCQl9CgkJfTsKCgkJcmV0dXJuIG9wdDsKCX07CgoJalF1ZXJ5LmZuLmV4dGVuZCggewoJCWZhZGVUbzogZnVuY3Rpb24oIHNwZWVkLCB0bywgZWFzaW5nLCBjYWxsYmFjayApIHsKCgkJCS8vIHNob3cgYW55IGhpZGRlbiBlbGVtZW50cyBhZnRlciBzZXR0aW5nIG9wYWNpdHkgdG8gMAoJCQlyZXR1cm4gdGhpcy5maWx0ZXIoIGlzSGlkZGVuICkuY3NzKCAib3BhY2l0eSIsIDAgKS5zaG93KCkKCgkJCQkvLyBhbmltYXRlIHRvIHRoZSB2YWx1ZSBzcGVjaWZpZWQKCQkJCS5lbmQoKS5hbmltYXRlKCB7IG9wYWNpdHk6IHRvIH0sIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICk7CgkJfSwKCQlhbmltYXRlOiBmdW5jdGlvbiggcHJvcCwgc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKSB7CgkJCXZhciBlbXB0eSA9IGpRdWVyeS5pc0VtcHR5T2JqZWN0KCBwcm9wICksCgkJCQlvcHRhbGwgPSBqUXVlcnkuc3BlZWQoIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICksCgkJCQlkb0FuaW1hdGlvbiA9IGZ1bmN0aW9uKCkgewoKCQkJCQkvLyBPcGVyYXRlIG9uIGEgY29weSBvZiBwcm9wIHNvIHBlci1wcm9wZXJ0eSBlYXNpbmcgd29uJ3QgYmUgbG9zdAoJCQkJCXZhciBhbmltID0gQW5pbWF0aW9uKCB0aGlzLCBqUXVlcnkuZXh0ZW5kKCB7fSwgcHJvcCApLCBvcHRhbGwgKTsKCgkJCQkJLy8gRW1wdHkgYW5pbWF0aW9ucywgb3IgZmluaXNoaW5nIHJlc29sdmVzIGltbWVkaWF0ZWx5CgkJCQkJaWYgKCBlbXB0eSB8fCBqUXVlcnkuX2RhdGEoIHRoaXMsICJmaW5pc2giICkgKSB7CgkJCQkJCWFuaW0uc3RvcCggdHJ1ZSApOwoJCQkJCX0KCQkJCX07CgkJCQlkb0FuaW1hdGlvbi5maW5pc2ggPSBkb0FuaW1hdGlvbjsKCgkJCXJldHVybiBlbXB0eSB8fCBvcHRhbGwucXVldWUgPT09IGZhbHNlID8KCQkJCXRoaXMuZWFjaCggZG9BbmltYXRpb24gKSA6CgkJCQl0aGlzLnF1ZXVlKCBvcHRhbGwucXVldWUsIGRvQW5pbWF0aW9uICk7CgkJfSwKCQlzdG9wOiBmdW5jdGlvbiggdHlwZSwgY2xlYXJRdWV1ZSwgZ290b0VuZCApIHsKCQkJdmFyIHN0b3BRdWV1ZSA9IGZ1bmN0aW9uKCBob29rcyApIHsKCQkJCXZhciBzdG9wID0gaG9va3Muc3RvcDsKCQkJCWRlbGV0ZSBob29rcy5zdG9wOwoJCQkJc3RvcCggZ290b0VuZCApOwoJCQl9OwoKCQkJaWYgKCB0eXBlb2YgdHlwZSAhPT0gInN0cmluZyIgKSB7CgkJCQlnb3RvRW5kID0gY2xlYXJRdWV1ZTsKCQkJCWNsZWFyUXVldWUgPSB0eXBlOwoJCQkJdHlwZSA9IHVuZGVmaW5lZDsKCQkJfQoJCQlpZiAoIGNsZWFyUXVldWUgJiYgdHlwZSAhPT0gZmFsc2UgKSB7CgkJCQl0aGlzLnF1ZXVlKCB0eXBlIHx8ICJmeCIsIFtdICk7CgkJCX0KCgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJdmFyIGRlcXVldWUgPSB0cnVlLAoJCQkJCWluZGV4ID0gdHlwZSAhPSBudWxsICYmIHR5cGUgKyAicXVldWVIb29rcyIsCgkJCQkJdGltZXJzID0galF1ZXJ5LnRpbWVycywKCQkJCQlkYXRhID0galF1ZXJ5Ll9kYXRhKCB0aGlzICk7CgoJCQkJaWYgKCBpbmRleCApIHsKCQkJCQlpZiAoIGRhdGFbIGluZGV4IF0gJiYgZGF0YVsgaW5kZXggXS5zdG9wICkgewoJCQkJCQlzdG9wUXVldWUoIGRhdGFbIGluZGV4IF0gKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCWZvciAoIGluZGV4IGluIGRhdGEgKSB7CgkJCQkJCWlmICggZGF0YVsgaW5kZXggXSAmJiBkYXRhWyBpbmRleCBdLnN0b3AgJiYgcnJ1bi50ZXN0KCBpbmRleCApICkgewoJCQkJCQkJc3RvcFF1ZXVlKCBkYXRhWyBpbmRleCBdICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJZm9yICggaW5kZXggPSB0aW1lcnMubGVuZ3RoOyBpbmRleC0tOyApIHsKCQkJCQlpZiAoIHRpbWVyc1sgaW5kZXggXS5lbGVtID09PSB0aGlzICYmCgkJCQkJCSggdHlwZSA9PSBudWxsIHx8IHRpbWVyc1sgaW5kZXggXS5xdWV1ZSA9PT0gdHlwZSApICkgewoKCQkJCQkJdGltZXJzWyBpbmRleCBdLmFuaW0uc3RvcCggZ290b0VuZCApOwoJCQkJCQlkZXF1ZXVlID0gZmFsc2U7CgkJCQkJCXRpbWVycy5zcGxpY2UoIGluZGV4LCAxICk7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIHN0YXJ0IHRoZSBuZXh0IGluIHRoZSBxdWV1ZSBpZiB0aGUgbGFzdCBzdGVwIHdhc24ndCBmb3JjZWQKCQkJCS8vIHRpbWVycyBjdXJyZW50bHkgd2lsbCBjYWxsIHRoZWlyIGNvbXBsZXRlIGNhbGxiYWNrcywgd2hpY2ggd2lsbCBkZXF1ZXVlCgkJCQkvLyBidXQgb25seSBpZiB0aGV5IHdlcmUgZ290b0VuZAoJCQkJaWYgKCBkZXF1ZXVlIHx8ICFnb3RvRW5kICkgewoJCQkJCWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCB0eXBlICk7CgkJCQl9CgkJCX0gKTsKCQl9LAoJCWZpbmlzaDogZnVuY3Rpb24oIHR5cGUgKSB7CgkJCWlmICggdHlwZSAhPT0gZmFsc2UgKSB7CgkJCQl0eXBlID0gdHlwZSB8fCAiZngiOwoJCQl9CgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJdmFyIGluZGV4LAoJCQkJCWRhdGEgPSBqUXVlcnkuX2RhdGEoIHRoaXMgKSwKCQkJCQlxdWV1ZSA9IGRhdGFbIHR5cGUgKyAicXVldWUiIF0sCgkJCQkJaG9va3MgPSBkYXRhWyB0eXBlICsgInF1ZXVlSG9va3MiIF0sCgkJCQkJdGltZXJzID0galF1ZXJ5LnRpbWVycywKCQkJCQlsZW5ndGggPSBxdWV1ZSA/IHF1ZXVlLmxlbmd0aCA6IDA7CgoJCQkJLy8gZW5hYmxlIGZpbmlzaGluZyBmbGFnIG9uIHByaXZhdGUgZGF0YQoJCQkJZGF0YS5maW5pc2ggPSB0cnVlOwoKCQkJCS8vIGVtcHR5IHRoZSBxdWV1ZSBmaXJzdAoJCQkJalF1ZXJ5LnF1ZXVlKCB0aGlzLCB0eXBlLCBbXSApOwoKCQkJCWlmICggaG9va3MgJiYgaG9va3Muc3RvcCApIHsKCQkJCQlob29rcy5zdG9wLmNhbGwoIHRoaXMsIHRydWUgKTsKCQkJCX0KCgkJCQkvLyBsb29rIGZvciBhbnkgYWN0aXZlIGFuaW1hdGlvbnMsIGFuZCBmaW5pc2ggdGhlbQoJCQkJZm9yICggaW5kZXggPSB0aW1lcnMubGVuZ3RoOyBpbmRleC0tOyApIHsKCQkJCQlpZiAoIHRpbWVyc1sgaW5kZXggXS5lbGVtID09PSB0aGlzICYmIHRpbWVyc1sgaW5kZXggXS5xdWV1ZSA9PT0gdHlwZSApIHsKCQkJCQkJdGltZXJzWyBpbmRleCBdLmFuaW0uc3RvcCggdHJ1ZSApOwoJCQkJCQl0aW1lcnMuc3BsaWNlKCBpbmRleCwgMSApOwoJCQkJCX0KCQkJCX0KCgkJCQkvLyBsb29rIGZvciBhbnkgYW5pbWF0aW9ucyBpbiB0aGUgb2xkIHF1ZXVlIGFuZCBmaW5pc2ggdGhlbQoJCQkJZm9yICggaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKyApIHsKCQkJCQlpZiAoIHF1ZXVlWyBpbmRleCBdICYmIHF1ZXVlWyBpbmRleCBdLmZpbmlzaCApIHsKCQkJCQkJcXVldWVbIGluZGV4IF0uZmluaXNoLmNhbGwoIHRoaXMgKTsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gdHVybiBvZmYgZmluaXNoaW5nIGZsYWcKCQkJCWRlbGV0ZSBkYXRhLmZpbmlzaDsKCQkJfSApOwoJCX0KCX0gKTsKCglqUXVlcnkuZWFjaCggWyAidG9nZ2xlIiwgInNob3ciLCAiaGlkZSIgXSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7CgkJdmFyIGNzc0ZuID0galF1ZXJ5LmZuWyBuYW1lIF07CgkJalF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKSB7CgkJCXJldHVybiBzcGVlZCA9PSBudWxsIHx8IHR5cGVvZiBzcGVlZCA9PT0gImJvb2xlYW4iID8KCQkJCWNzc0ZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKSA6CgkJCQl0aGlzLmFuaW1hdGUoIGdlbkZ4KCBuYW1lLCB0cnVlICksIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICk7CgkJfTsKCX0gKTsKCgkvLyBHZW5lcmF0ZSBzaG9ydGN1dHMgZm9yIGN1c3RvbSBhbmltYXRpb25zCglqUXVlcnkuZWFjaCggewoJCXNsaWRlRG93bjogZ2VuRngoICJzaG93IiApLAoJCXNsaWRlVXA6IGdlbkZ4KCAiaGlkZSIgKSwKCQlzbGlkZVRvZ2dsZTogZ2VuRngoICJ0b2dnbGUiICksCgkJZmFkZUluOiB7IG9wYWNpdHk6ICJzaG93IiB9LAoJCWZhZGVPdXQ6IHsgb3BhY2l0eTogImhpZGUiIH0sCgkJZmFkZVRvZ2dsZTogeyBvcGFjaXR5OiAidG9nZ2xlIiB9Cgl9LCBmdW5jdGlvbiggbmFtZSwgcHJvcHMgKSB7CgkJalF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKSB7CgkJCXJldHVybiB0aGlzLmFuaW1hdGUoIHByb3BzLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApOwoJCX07Cgl9ICk7CgoJalF1ZXJ5LnRpbWVycyA9IFtdOwoJalF1ZXJ5LmZ4LnRpY2sgPSBmdW5jdGlvbigpIHsKCQl2YXIgdGltZXIsCgkJCXRpbWVycyA9IGpRdWVyeS50aW1lcnMsCgkJCWkgPSAwOwoKCQlmeE5vdyA9IGpRdWVyeS5ub3coKTsKCgkJZm9yICggOyBpIDwgdGltZXJzLmxlbmd0aDsgaSsrICkgewoJCQl0aW1lciA9IHRpbWVyc1sgaSBdOwoKCQkJLy8gQ2hlY2tzIHRoZSB0aW1lciBoYXMgbm90IGFscmVhZHkgYmVlbiByZW1vdmVkCgkJCWlmICggIXRpbWVyKCkgJiYgdGltZXJzWyBpIF0gPT09IHRpbWVyICkgewoJCQkJdGltZXJzLnNwbGljZSggaS0tLCAxICk7CgkJCX0KCQl9CgoJCWlmICggIXRpbWVycy5sZW5ndGggKSB7CgkJCWpRdWVyeS5meC5zdG9wKCk7CgkJfQoJCWZ4Tm93ID0gdW5kZWZpbmVkOwoJfTsKCglqUXVlcnkuZngudGltZXIgPSBmdW5jdGlvbiggdGltZXIgKSB7CgkJalF1ZXJ5LnRpbWVycy5wdXNoKCB0aW1lciApOwoJCWlmICggdGltZXIoKSApIHsKCQkJalF1ZXJ5LmZ4LnN0YXJ0KCk7CgkJfSBlbHNlIHsKCQkJalF1ZXJ5LnRpbWVycy5wb3AoKTsKCQl9Cgl9OwoKCWpRdWVyeS5meC5pbnRlcnZhbCA9IDEzOwoKCWpRdWVyeS5meC5zdGFydCA9IGZ1bmN0aW9uKCkgewoJCWlmICggIXRpbWVySWQgKSB7CgkJCXRpbWVySWQgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoIGpRdWVyeS5meC50aWNrLCBqUXVlcnkuZnguaW50ZXJ2YWwgKTsKCQl9Cgl9OwoKCWpRdWVyeS5meC5zdG9wID0gZnVuY3Rpb24oKSB7CgkJd2luZG93LmNsZWFySW50ZXJ2YWwoIHRpbWVySWQgKTsKCQl0aW1lcklkID0gbnVsbDsKCX07CgoJalF1ZXJ5LmZ4LnNwZWVkcyA9IHsKCQlzbG93OiA2MDAsCgkJZmFzdDogMjAwLAoKCQkvLyBEZWZhdWx0IHNwZWVkCgkJX2RlZmF1bHQ6IDQwMAoJfTsKCgoJLy8gQmFzZWQgb2ZmIG9mIHRoZSBwbHVnaW4gYnkgQ2xpbnQgSGVsZmVycywgd2l0aCBwZXJtaXNzaW9uLgoJLy8gaHR0cDovL3dlYi5hcmNoaXZlLm9yZy93ZWIvMjAxMDAzMjQwMTQ3NDcvaHR0cDovL2JsaW5kc2lnbmFscy5jb20vaW5kZXgucGhwLzIwMDkvMDcvanF1ZXJ5LWRlbGF5LwoJalF1ZXJ5LmZuLmRlbGF5ID0gZnVuY3Rpb24oIHRpbWUsIHR5cGUgKSB7CgkJdGltZSA9IGpRdWVyeS5meCA/IGpRdWVyeS5meC5zcGVlZHNbIHRpbWUgXSB8fCB0aW1lIDogdGltZTsKCQl0eXBlID0gdHlwZSB8fCAiZngiOwoKCQlyZXR1cm4gdGhpcy5xdWV1ZSggdHlwZSwgZnVuY3Rpb24oIG5leHQsIGhvb2tzICkgewoJCQl2YXIgdGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KCBuZXh0LCB0aW1lICk7CgkJCWhvb2tzLnN0b3AgPSBmdW5jdGlvbigpIHsKCQkJCXdpbmRvdy5jbGVhclRpbWVvdXQoIHRpbWVvdXQgKTsKCQkJfTsKCQl9ICk7Cgl9OwoKCgkoIGZ1bmN0aW9uKCkgewoJCXZhciBhLAoJCQlpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJpbnB1dCIgKSwKCQkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKSwKCQkJc2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggInNlbGVjdCIgKSwKCQkJb3B0ID0gc2VsZWN0LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAib3B0aW9uIiApICk7CgoJCS8vIFNldHVwCgkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCQlkaXYuc2V0QXR0cmlidXRlKCAiY2xhc3NOYW1lIiwgInQiICk7CgkJZGl2LmlubmVySFRNTCA9ICIgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYSc+YTwvYT48aW5wdXQgdHlwZT0nY2hlY2tib3gnLz4iOwoJCWEgPSBkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJhIiApWyAwIF07CgoJCS8vIFN1cHBvcnQ6IFdpbmRvd3MgV2ViIEFwcHMgKFdXQSkKCQkvLyBgdHlwZWAgbXVzdCB1c2UgLnNldEF0dHJpYnV0ZSBmb3IgV1dBICgjMTQ5MDEpCgkJaW5wdXQuc2V0QXR0cmlidXRlKCAidHlwZSIsICJjaGVja2JveCIgKTsKCQlkaXYuYXBwZW5kQ2hpbGQoIGlucHV0ICk7CgoJCWEgPSBkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJhIiApWyAwIF07CgoJCS8vIEZpcnN0IGJhdGNoIG9mIHRlc3RzLgoJCWEuc3R5bGUuY3NzVGV4dCA9ICJ0b3A6MXB4IjsKCgkJLy8gVGVzdCBzZXRBdHRyaWJ1dGUgb24gY2FtZWxDYXNlIGNsYXNzLgoJCS8vIElmIGl0IHdvcmtzLCB3ZSBuZWVkIGF0dHJGaXhlcyB3aGVuIGRvaW5nIGdldC9zZXRBdHRyaWJ1dGUgKGllNi83KQoJCXN1cHBvcnQuZ2V0U2V0QXR0cmlidXRlID0gZGl2LmNsYXNzTmFtZSAhPT0gInQiOwoKCQkvLyBHZXQgdGhlIHN0eWxlIGluZm9ybWF0aW9uIGZyb20gZ2V0QXR0cmlidXRlCgkJLy8gKElFIHVzZXMgLmNzc1RleHQgaW5zdGVhZCkKCQlzdXBwb3J0LnN0eWxlID0gL3RvcC8udGVzdCggYS5nZXRBdHRyaWJ1dGUoICJzdHlsZSIgKSApOwoKCQkvLyBNYWtlIHN1cmUgdGhhdCBVUkxzIGFyZW4ndCBtYW5pcHVsYXRlZAoJCS8vIChJRSBub3JtYWxpemVzIGl0IGJ5IGRlZmF1bHQpCgkJc3VwcG9ydC5ocmVmTm9ybWFsaXplZCA9IGEuZ2V0QXR0cmlidXRlKCAiaHJlZiIgKSA9PT0gIi9hIjsKCgkJLy8gQ2hlY2sgdGhlIGRlZmF1bHQgY2hlY2tib3gvcmFkaW8gdmFsdWUgKCIiIG9uIFdlYktpdDsgIm9uIiBlbHNld2hlcmUpCgkJc3VwcG9ydC5jaGVja09uID0gISFpbnB1dC52YWx1ZTsKCgkJLy8gTWFrZSBzdXJlIHRoYXQgYSBzZWxlY3RlZC1ieS1kZWZhdWx0IG9wdGlvbiBoYXMgYSB3b3JraW5nIHNlbGVjdGVkIHByb3BlcnR5LgoJCS8vIChXZWJLaXQgZGVmYXVsdHMgdG8gZmFsc2UgaW5zdGVhZCBvZiB0cnVlLCBJRSB0b28sIGlmIGl0J3MgaW4gYW4gb3B0Z3JvdXApCgkJc3VwcG9ydC5vcHRTZWxlY3RlZCA9IG9wdC5zZWxlY3RlZDsKCgkJLy8gVGVzdHMgZm9yIGVuY3R5cGUgc3VwcG9ydCBvbiBhIGZvcm0gKCM2NzQzKQoJCXN1cHBvcnQuZW5jdHlwZSA9ICEhZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImZvcm0iICkuZW5jdHlwZTsKCgkJLy8gTWFrZSBzdXJlIHRoYXQgdGhlIG9wdGlvbnMgaW5zaWRlIGRpc2FibGVkIHNlbGVjdHMgYXJlbid0IG1hcmtlZCBhcyBkaXNhYmxlZAoJCS8vIChXZWJLaXQgbWFya3MgdGhlbSBhcyBkaXNhYmxlZCkKCQlzZWxlY3QuZGlzYWJsZWQgPSB0cnVlOwoJCXN1cHBvcnQub3B0RGlzYWJsZWQgPSAhb3B0LmRpc2FibGVkOwoKCQkvLyBTdXBwb3J0OiBJRTggb25seQoJCS8vIENoZWNrIGlmIHdlIGNhbiB0cnVzdCBnZXRBdHRyaWJ1dGUoInZhbHVlIikKCQlpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJpbnB1dCIgKTsKCQlpbnB1dC5zZXRBdHRyaWJ1dGUoICJ2YWx1ZSIsICIiICk7CgkJc3VwcG9ydC5pbnB1dCA9IGlucHV0LmdldEF0dHJpYnV0ZSggInZhbHVlIiApID09PSAiIjsKCgkJLy8gQ2hlY2sgaWYgYW4gaW5wdXQgbWFpbnRhaW5zIGl0cyB2YWx1ZSBhZnRlciBiZWNvbWluZyBhIHJhZGlvCgkJaW5wdXQudmFsdWUgPSAidCI7CgkJaW5wdXQuc2V0QXR0cmlidXRlKCAidHlwZSIsICJyYWRpbyIgKTsKCQlzdXBwb3J0LnJhZGlvVmFsdWUgPSBpbnB1dC52YWx1ZSA9PT0gInQiOwoJfSApKCk7CgoKCXZhciBycmV0dXJuID0gL1xyL2c7CgoJalF1ZXJ5LmZuLmV4dGVuZCggewoJCXZhbDogZnVuY3Rpb24oIHZhbHVlICkgewoJCQl2YXIgaG9va3MsIHJldCwgaXNGdW5jdGlvbiwKCQkJCWVsZW0gPSB0aGlzWyAwIF07CgoJCQlpZiAoICFhcmd1bWVudHMubGVuZ3RoICkgewoJCQkJaWYgKCBlbGVtICkgewoJCQkJCWhvb2tzID0galF1ZXJ5LnZhbEhvb2tzWyBlbGVtLnR5cGUgXSB8fAoJCQkJCQlqUXVlcnkudmFsSG9va3NbIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSBdOwoKCQkJCQlpZiAoCgkJCQkJCWhvb2tzICYmCgkJCQkJCSJnZXQiIGluIGhvb2tzICYmCgkJCQkJCSggcmV0ID0gaG9va3MuZ2V0KCBlbGVtLCAidmFsdWUiICkgKSAhPT0gdW5kZWZpbmVkCgkJCQkJKSB7CgkJCQkJCXJldHVybiByZXQ7CgkJCQkJfQoKCQkJCQlyZXQgPSBlbGVtLnZhbHVlOwoKCQkJCQlyZXR1cm4gdHlwZW9mIHJldCA9PT0gInN0cmluZyIgPwoKCQkJCQkJLy8gaGFuZGxlIG1vc3QgY29tbW9uIHN0cmluZyBjYXNlcwoJCQkJCQlyZXQucmVwbGFjZSggcnJldHVybiwgIiIgKSA6CgoJCQkJCQkvLyBoYW5kbGUgY2FzZXMgd2hlcmUgdmFsdWUgaXMgbnVsbC91bmRlZiBvciBudW1iZXIKCQkJCQkJcmV0ID09IG51bGwgPyAiIiA6IHJldDsKCQkJCX0KCgkJCQlyZXR1cm47CgkJCX0KCgkJCWlzRnVuY3Rpb24gPSBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKTsKCgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCBpICkgewoJCQkJdmFyIHZhbDsKCgkJCQlpZiAoIHRoaXMubm9kZVR5cGUgIT09IDEgKSB7CgkJCQkJcmV0dXJuOwoJCQkJfQoKCQkJCWlmICggaXNGdW5jdGlvbiApIHsKCQkJCQl2YWwgPSB2YWx1ZS5jYWxsKCB0aGlzLCBpLCBqUXVlcnkoIHRoaXMgKS52YWwoKSApOwoJCQkJfSBlbHNlIHsKCQkJCQl2YWwgPSB2YWx1ZTsKCQkJCX0KCgkJCQkvLyBUcmVhdCBudWxsL3VuZGVmaW5lZCBhcyAiIjsgY29udmVydCBudW1iZXJzIHRvIHN0cmluZwoJCQkJaWYgKCB2YWwgPT0gbnVsbCApIHsKCQkJCQl2YWwgPSAiIjsKCQkJCX0gZWxzZSBpZiAoIHR5cGVvZiB2YWwgPT09ICJudW1iZXIiICkgewoJCQkJCXZhbCArPSAiIjsKCQkJCX0gZWxzZSBpZiAoIGpRdWVyeS5pc0FycmF5KCB2YWwgKSApIHsKCQkJCQl2YWwgPSBqUXVlcnkubWFwKCB2YWwsIGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJCQkJcmV0dXJuIHZhbHVlID09IG51bGwgPyAiIiA6IHZhbHVlICsgIiI7CgkJCQkJfSApOwoJCQkJfQoKCQkJCWhvb2tzID0galF1ZXJ5LnZhbEhvb2tzWyB0aGlzLnR5cGUgXSB8fCBqUXVlcnkudmFsSG9va3NbIHRoaXMubm9kZU5hbWUudG9Mb3dlckNhc2UoKSBdOwoKCQkJCS8vIElmIHNldCByZXR1cm5zIHVuZGVmaW5lZCwgZmFsbCBiYWNrIHRvIG5vcm1hbCBzZXR0aW5nCgkJCQlpZiAoICFob29rcyB8fCAhKCAic2V0IiBpbiBob29rcyApIHx8IGhvb2tzLnNldCggdGhpcywgdmFsLCAidmFsdWUiICkgPT09IHVuZGVmaW5lZCApIHsKCQkJCQl0aGlzLnZhbHVlID0gdmFsOwoJCQkJfQoJCQl9ICk7CgkJfQoJfSApOwoKCWpRdWVyeS5leHRlbmQoIHsKCQl2YWxIb29rczogewoJCQlvcHRpb246IHsKCQkJCWdldDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJdmFyIHZhbCA9IGpRdWVyeS5maW5kLmF0dHIoIGVsZW0sICJ2YWx1ZSIgKTsKCQkJCQlyZXR1cm4gdmFsICE9IG51bGwgPwoJCQkJCQl2YWwgOgoKCQkJCQkJLy8gU3VwcG9ydDogSUUxMC0xMSsKCQkJCQkJLy8gb3B0aW9uLnRleHQgdGhyb3dzIGV4Y2VwdGlvbnMgKCMxNDY4NiwgIzE0ODU4KQoJCQkJCQlqUXVlcnkudHJpbSggalF1ZXJ5LnRleHQoIGVsZW0gKSApOwoJCQkJfQoJCQl9LAoJCQlzZWxlY3Q6IHsKCQkJCWdldDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJdmFyIHZhbHVlLCBvcHRpb24sCgkJCQkJCW9wdGlvbnMgPSBlbGVtLm9wdGlvbnMsCgkJCQkJCWluZGV4ID0gZWxlbS5zZWxlY3RlZEluZGV4LAoJCQkJCQlvbmUgPSBlbGVtLnR5cGUgPT09ICJzZWxlY3Qtb25lIiB8fCBpbmRleCA8IDAsCgkJCQkJCXZhbHVlcyA9IG9uZSA/IG51bGwgOiBbXSwKCQkJCQkJbWF4ID0gb25lID8gaW5kZXggKyAxIDogb3B0aW9ucy5sZW5ndGgsCgkJCQkJCWkgPSBpbmRleCA8IDAgPwoJCQkJCQkJbWF4IDoKCQkJCQkJCW9uZSA/IGluZGV4IDogMDsKCgkJCQkJLy8gTG9vcCB0aHJvdWdoIGFsbCB0aGUgc2VsZWN0ZWQgb3B0aW9ucwoJCQkJCWZvciAoIDsgaSA8IG1heDsgaSsrICkgewoJCQkJCQlvcHRpb24gPSBvcHRpb25zWyBpIF07CgoJCQkJCQkvLyBvbGRJRSBkb2Vzbid0IHVwZGF0ZSBzZWxlY3RlZCBhZnRlciBmb3JtIHJlc2V0ICgjMjU1MSkKCQkJCQkJaWYgKCAoIG9wdGlvbi5zZWxlY3RlZCB8fCBpID09PSBpbmRleCApICYmCgoJCQkJCQkJCS8vIERvbid0IHJldHVybiBvcHRpb25zIHRoYXQgYXJlIGRpc2FibGVkIG9yIGluIGEgZGlzYWJsZWQgb3B0Z3JvdXAKCQkJCQkJCQkoIHN1cHBvcnQub3B0RGlzYWJsZWQgPwoJCQkJCQkJCQkhb3B0aW9uLmRpc2FibGVkIDoKCQkJCQkJCQkJb3B0aW9uLmdldEF0dHJpYnV0ZSggImRpc2FibGVkIiApID09PSBudWxsICkgJiYKCQkJCQkJCQkoICFvcHRpb24ucGFyZW50Tm9kZS5kaXNhYmxlZCB8fAoJCQkJCQkJCQkhalF1ZXJ5Lm5vZGVOYW1lKCBvcHRpb24ucGFyZW50Tm9kZSwgIm9wdGdyb3VwIiApICkgKSB7CgoJCQkJCQkJLy8gR2V0IHRoZSBzcGVjaWZpYyB2YWx1ZSBmb3IgdGhlIG9wdGlvbgoJCQkJCQkJdmFsdWUgPSBqUXVlcnkoIG9wdGlvbiApLnZhbCgpOwoKCQkJCQkJCS8vIFdlIGRvbid0IG5lZWQgYW4gYXJyYXkgZm9yIG9uZSBzZWxlY3RzCgkJCQkJCQlpZiAoIG9uZSApIHsKCQkJCQkJCQlyZXR1cm4gdmFsdWU7CgkJCQkJCQl9CgoJCQkJCQkJLy8gTXVsdGktU2VsZWN0cyByZXR1cm4gYW4gYXJyYXkKCQkJCQkJCXZhbHVlcy5wdXNoKCB2YWx1ZSApOwoJCQkJCQl9CgkJCQkJfQoKCQkJCQlyZXR1cm4gdmFsdWVzOwoJCQkJfSwKCgkJCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHsKCQkJCQl2YXIgb3B0aW9uU2V0LCBvcHRpb24sCgkJCQkJCW9wdGlvbnMgPSBlbGVtLm9wdGlvbnMsCgkJCQkJCXZhbHVlcyA9IGpRdWVyeS5tYWtlQXJyYXkoIHZhbHVlICksCgkJCQkJCWkgPSBvcHRpb25zLmxlbmd0aDsKCgkJCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQkJCW9wdGlvbiA9IG9wdGlvbnNbIGkgXTsKCgkJCQkJCWlmICggalF1ZXJ5LmluQXJyYXkoIGpRdWVyeS52YWxIb29rcy5vcHRpb24uZ2V0KCBvcHRpb24gKSwgdmFsdWVzICkgPj0gMCApIHsKCgkJCQkJCQkvLyBTdXBwb3J0OiBJRTYKCQkJCQkJCS8vIFdoZW4gbmV3IG9wdGlvbiBlbGVtZW50IGlzIGFkZGVkIHRvIHNlbGVjdCBib3ggd2UgbmVlZCB0bwoJCQkJCQkJLy8gZm9yY2UgcmVmbG93IG9mIG5ld2x5IGFkZGVkIG5vZGUgaW4gb3JkZXIgdG8gd29ya2Fyb3VuZCBkZWxheQoJCQkJCQkJLy8gb2YgaW5pdGlhbGl6YXRpb24gcHJvcGVydGllcwoJCQkJCQkJdHJ5IHsKCQkJCQkJCQlvcHRpb24uc2VsZWN0ZWQgPSBvcHRpb25TZXQgPSB0cnVlOwoKCQkJCQkJCX0gY2F0Y2ggKCBfICkgewoKCQkJCQkJCQkvLyBXaWxsIGJlIGV4ZWN1dGVkIG9ubHkgaW4gSUU2CgkJCQkJCQkJb3B0aW9uLnNjcm9sbEhlaWdodDsKCQkJCQkJCX0KCgkJCQkJCX0gZWxzZSB7CgkJCQkJCQlvcHRpb24uc2VsZWN0ZWQgPSBmYWxzZTsKCQkJCQkJfQoJCQkJCX0KCgkJCQkJLy8gRm9yY2UgYnJvd3NlcnMgdG8gYmVoYXZlIGNvbnNpc3RlbnRseSB3aGVuIG5vbi1tYXRjaGluZyB2YWx1ZSBpcyBzZXQKCQkJCQlpZiAoICFvcHRpb25TZXQgKSB7CgkJCQkJCWVsZW0uc2VsZWN0ZWRJbmRleCA9IC0xOwoJCQkJCX0KCgkJCQkJcmV0dXJuIG9wdGlvbnM7CgkJCQl9CgkJCX0KCQl9Cgl9ICk7CgoJLy8gUmFkaW9zIGFuZCBjaGVja2JveGVzIGdldHRlci9zZXR0ZXIKCWpRdWVyeS5lYWNoKCBbICJyYWRpbyIsICJjaGVja2JveCIgXSwgZnVuY3Rpb24oKSB7CgkJalF1ZXJ5LnZhbEhvb2tzWyB0aGlzIF0gPSB7CgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCQkJaWYgKCBqUXVlcnkuaXNBcnJheSggdmFsdWUgKSApIHsKCQkJCQlyZXR1cm4gKCBlbGVtLmNoZWNrZWQgPSBqUXVlcnkuaW5BcnJheSggalF1ZXJ5KCBlbGVtICkudmFsKCksIHZhbHVlICkgPiAtMSApOwoJCQkJfQoJCQl9CgkJfTsKCQlpZiAoICFzdXBwb3J0LmNoZWNrT24gKSB7CgkJCWpRdWVyeS52YWxIb29rc1sgdGhpcyBdLmdldCA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKCAidmFsdWUiICkgPT09IG51bGwgPyAib24iIDogZWxlbS52YWx1ZTsKCQkJfTsKCQl9Cgl9ICk7CgoKCgoJdmFyIG5vZGVIb29rLCBib29sSG9vaywKCQlhdHRySGFuZGxlID0galF1ZXJ5LmV4cHIuYXR0ckhhbmRsZSwKCQlydXNlRGVmYXVsdCA9IC9eKD86Y2hlY2tlZHxzZWxlY3RlZCkkL2ksCgkJZ2V0U2V0QXR0cmlidXRlID0gc3VwcG9ydC5nZXRTZXRBdHRyaWJ1dGUsCgkJZ2V0U2V0SW5wdXQgPSBzdXBwb3J0LmlucHV0OwoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCQlhdHRyOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7CgkJCXJldHVybiBhY2Nlc3MoIHRoaXMsIGpRdWVyeS5hdHRyLCBuYW1lLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgKTsKCQl9LAoKCQlyZW1vdmVBdHRyOiBmdW5jdGlvbiggbmFtZSApIHsKCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgkJCQlqUXVlcnkucmVtb3ZlQXR0ciggdGhpcywgbmFtZSApOwoJCQl9ICk7CgkJfQoJfSApOwoKCWpRdWVyeS5leHRlbmQoIHsKCQlhdHRyOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUgKSB7CgkJCXZhciByZXQsIGhvb2tzLAoJCQkJblR5cGUgPSBlbGVtLm5vZGVUeXBlOwoKCQkJLy8gRG9uJ3QgZ2V0L3NldCBhdHRyaWJ1dGVzIG9uIHRleHQsIGNvbW1lbnQgYW5kIGF0dHJpYnV0ZSBub2RlcwoJCQlpZiAoIG5UeXBlID09PSAzIHx8IG5UeXBlID09PSA4IHx8IG5UeXBlID09PSAyICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBGYWxsYmFjayB0byBwcm9wIHdoZW4gYXR0cmlidXRlcyBhcmUgbm90IHN1cHBvcnRlZAoJCQlpZiAoIHR5cGVvZiBlbGVtLmdldEF0dHJpYnV0ZSA9PT0gInVuZGVmaW5lZCIgKSB7CgkJCQlyZXR1cm4galF1ZXJ5LnByb3AoIGVsZW0sIG5hbWUsIHZhbHVlICk7CgkJCX0KCgkJCS8vIEFsbCBhdHRyaWJ1dGVzIGFyZSBsb3dlcmNhc2UKCQkJLy8gR3JhYiBuZWNlc3NhcnkgaG9vayBpZiBvbmUgaXMgZGVmaW5lZAoJCQlpZiAoIG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoIGVsZW0gKSApIHsKCQkJCW5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7CgkJCQlob29rcyA9IGpRdWVyeS5hdHRySG9va3NbIG5hbWUgXSB8fAoJCQkJCSggalF1ZXJ5LmV4cHIubWF0Y2guYm9vbC50ZXN0KCBuYW1lICkgPyBib29sSG9vayA6IG5vZGVIb29rICk7CgkJCX0KCgkJCWlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHsKCQkJCWlmICggdmFsdWUgPT09IG51bGwgKSB7CgkJCQkJalF1ZXJ5LnJlbW92ZUF0dHIoIGVsZW0sIG5hbWUgKTsKCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJaWYgKCBob29rcyAmJiAic2V0IiBpbiBob29rcyAmJgoJCQkJCSggcmV0ID0gaG9va3Muc2V0KCBlbGVtLCB2YWx1ZSwgbmFtZSApICkgIT09IHVuZGVmaW5lZCApIHsKCQkJCQlyZXR1cm4gcmV0OwoJCQkJfQoKCQkJCWVsZW0uc2V0QXR0cmlidXRlKCBuYW1lLCB2YWx1ZSArICIiICk7CgkJCQlyZXR1cm4gdmFsdWU7CgkJCX0KCgkJCWlmICggaG9va3MgJiYgImdldCIgaW4gaG9va3MgJiYgKCByZXQgPSBob29rcy5nZXQoIGVsZW0sIG5hbWUgKSApICE9PSBudWxsICkgewoJCQkJcmV0dXJuIHJldDsKCQkJfQoKCQkJcmV0ID0galF1ZXJ5LmZpbmQuYXR0ciggZWxlbSwgbmFtZSApOwoKCQkJLy8gTm9uLWV4aXN0ZW50IGF0dHJpYnV0ZXMgcmV0dXJuIG51bGwsIHdlIG5vcm1hbGl6ZSB0byB1bmRlZmluZWQKCQkJcmV0dXJuIHJldCA9PSBudWxsID8gdW5kZWZpbmVkIDogcmV0OwoJCX0sCgoJCWF0dHJIb29rczogewoJCQl0eXBlOiB7CgkJCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHsKCQkJCQlpZiAoICFzdXBwb3J0LnJhZGlvVmFsdWUgJiYgdmFsdWUgPT09ICJyYWRpbyIgJiYKCQkJCQkJalF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCAiaW5wdXQiICkgKSB7CgoJCQkJCQkvLyBTZXR0aW5nIHRoZSB0eXBlIG9uIGEgcmFkaW8gYnV0dG9uIGFmdGVyIHRoZSB2YWx1ZSByZXNldHMgdGhlIHZhbHVlIGluIElFOC05CgkJCQkJCS8vIFJlc2V0IHZhbHVlIHRvIGRlZmF1bHQgaW4gY2FzZSB0eXBlIGlzIHNldCBhZnRlciB2YWx1ZSBkdXJpbmcgY3JlYXRpb24KCQkJCQkJdmFyIHZhbCA9IGVsZW0udmFsdWU7CgkJCQkJCWVsZW0uc2V0QXR0cmlidXRlKCAidHlwZSIsIHZhbHVlICk7CgkJCQkJCWlmICggdmFsICkgewoJCQkJCQkJZWxlbS52YWx1ZSA9IHZhbDsKCQkJCQkJfQoJCQkJCQlyZXR1cm4gdmFsdWU7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfSwKCgkJcmVtb3ZlQXR0cjogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCQl2YXIgbmFtZSwgcHJvcE5hbWUsCgkJCQlpID0gMCwKCQkJCWF0dHJOYW1lcyA9IHZhbHVlICYmIHZhbHVlLm1hdGNoKCBybm90d2hpdGUgKTsKCgkJCWlmICggYXR0ck5hbWVzICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCQl3aGlsZSAoICggbmFtZSA9IGF0dHJOYW1lc1sgaSsrIF0gKSApIHsKCQkJCQlwcm9wTmFtZSA9IGpRdWVyeS5wcm9wRml4WyBuYW1lIF0gfHwgbmFtZTsKCgkJCQkJLy8gQm9vbGVhbiBhdHRyaWJ1dGVzIGdldCBzcGVjaWFsIHRyZWF0bWVudCAoIzEwODcwKQoJCQkJCWlmICggalF1ZXJ5LmV4cHIubWF0Y2guYm9vbC50ZXN0KCBuYW1lICkgKSB7CgoJCQkJCQkvLyBTZXQgY29ycmVzcG9uZGluZyBwcm9wZXJ0eSB0byBmYWxzZQoJCQkJCQlpZiAoIGdldFNldElucHV0ICYmIGdldFNldEF0dHJpYnV0ZSB8fCAhcnVzZURlZmF1bHQudGVzdCggbmFtZSApICkgewoJCQkJCQkJZWxlbVsgcHJvcE5hbWUgXSA9IGZhbHNlOwoKCQkJCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkJCQkvLyBBbHNvIGNsZWFyIGRlZmF1bHRDaGVja2VkL2RlZmF1bHRTZWxlY3RlZCAoaWYgYXBwcm9wcmlhdGUpCgkJCQkJCX0gZWxzZSB7CgkJCQkJCQllbGVtWyBqUXVlcnkuY2FtZWxDYXNlKCAiZGVmYXVsdC0iICsgbmFtZSApIF0gPQoJCQkJCQkJCWVsZW1bIHByb3BOYW1lIF0gPSBmYWxzZTsKCQkJCQkJfQoKCQkJCQkvLyBTZWUgIzk2OTkgZm9yIGV4cGxhbmF0aW9uIG9mIHRoaXMgYXBwcm9hY2ggKHNldHRpbmcgZmlyc3QsIHRoZW4gcmVtb3ZhbCkKCQkJCQl9IGVsc2UgewoJCQkJCQlqUXVlcnkuYXR0ciggZWxlbSwgbmFtZSwgIiIgKTsKCQkJCQl9CgoJCQkJCWVsZW0ucmVtb3ZlQXR0cmlidXRlKCBnZXRTZXRBdHRyaWJ1dGUgPyBuYW1lIDogcHJvcE5hbWUgKTsKCQkJCX0KCQkJfQoJCX0KCX0gKTsKCgkvLyBIb29rcyBmb3IgYm9vbGVhbiBhdHRyaWJ1dGVzCglib29sSG9vayA9IHsKCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSwgbmFtZSApIHsKCQkJaWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7CgoJCQkJLy8gUmVtb3ZlIGJvb2xlYW4gYXR0cmlidXRlcyB3aGVuIHNldCB0byBmYWxzZQoJCQkJalF1ZXJ5LnJlbW92ZUF0dHIoIGVsZW0sIG5hbWUgKTsKCQkJfSBlbHNlIGlmICggZ2V0U2V0SW5wdXQgJiYgZ2V0U2V0QXR0cmlidXRlIHx8ICFydXNlRGVmYXVsdC50ZXN0KCBuYW1lICkgKSB7CgoJCQkJLy8gSUU8OCBuZWVkcyB0aGUgKnByb3BlcnR5KiBuYW1lCgkJCQllbGVtLnNldEF0dHJpYnV0ZSggIWdldFNldEF0dHJpYnV0ZSAmJiBqUXVlcnkucHJvcEZpeFsgbmFtZSBdIHx8IG5hbWUsIG5hbWUgKTsKCgkJCX0gZWxzZSB7CgoJCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkJLy8gVXNlIGRlZmF1bHRDaGVja2VkIGFuZCBkZWZhdWx0U2VsZWN0ZWQgZm9yIG9sZElFCgkJCQllbGVtWyBqUXVlcnkuY2FtZWxDYXNlKCAiZGVmYXVsdC0iICsgbmFtZSApIF0gPSBlbGVtWyBuYW1lIF0gPSB0cnVlOwoJCQl9CgkJCXJldHVybiBuYW1lOwoJCX0KCX07CgoJalF1ZXJ5LmVhY2goIGpRdWVyeS5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKCAvXHcrL2cgKSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7CgkJdmFyIGdldHRlciA9IGF0dHJIYW5kbGVbIG5hbWUgXSB8fCBqUXVlcnkuZmluZC5hdHRyOwoKCQlpZiAoIGdldFNldElucHV0ICYmIGdldFNldEF0dHJpYnV0ZSB8fCAhcnVzZURlZmF1bHQudGVzdCggbmFtZSApICkgewoJCQlhdHRySGFuZGxlWyBuYW1lIF0gPSBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7CgkJCQl2YXIgcmV0LCBoYW5kbGU7CgkJCQlpZiAoICFpc1hNTCApIHsKCgkJCQkJLy8gQXZvaWQgYW4gaW5maW5pdGUgbG9vcCBieSB0ZW1wb3JhcmlseSByZW1vdmluZyB0aGlzIGZ1bmN0aW9uIGZyb20gdGhlIGdldHRlcgoJCQkJCWhhbmRsZSA9IGF0dHJIYW5kbGVbIG5hbWUgXTsKCQkJCQlhdHRySGFuZGxlWyBuYW1lIF0gPSByZXQ7CgkJCQkJcmV0ID0gZ2V0dGVyKCBlbGVtLCBuYW1lLCBpc1hNTCApICE9IG51bGwgPwoJCQkJCQluYW1lLnRvTG93ZXJDYXNlKCkgOgoJCQkJCQludWxsOwoJCQkJCWF0dHJIYW5kbGVbIG5hbWUgXSA9IGhhbmRsZTsKCQkJCX0KCQkJCXJldHVybiByZXQ7CgkJCX07CgkJfSBlbHNlIHsKCQkJYXR0ckhhbmRsZVsgbmFtZSBdID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkgewoJCQkJaWYgKCAhaXNYTUwgKSB7CgkJCQkJcmV0dXJuIGVsZW1bIGpRdWVyeS5jYW1lbENhc2UoICJkZWZhdWx0LSIgKyBuYW1lICkgXSA/CgkJCQkJCW5hbWUudG9Mb3dlckNhc2UoKSA6CgkJCQkJCW51bGw7CgkJCQl9CgkJCX07CgkJfQoJfSApOwoKCS8vIGZpeCBvbGRJRSBhdHRyb3BlcnRpZXMKCWlmICggIWdldFNldElucHV0IHx8ICFnZXRTZXRBdHRyaWJ1dGUgKSB7CgkJalF1ZXJ5LmF0dHJIb29rcy52YWx1ZSA9IHsKCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIG5hbWUgKSB7CgkJCQlpZiAoIGpRdWVyeS5ub2RlTmFtZSggZWxlbSwgImlucHV0IiApICkgewoKCQkJCQkvLyBEb2VzIG5vdCByZXR1cm4gc28gdGhhdCBzZXRBdHRyaWJ1dGUgaXMgYWxzbyB1c2VkCgkJCQkJZWxlbS5kZWZhdWx0VmFsdWUgPSB2YWx1ZTsKCQkJCX0gZWxzZSB7CgoJCQkJCS8vIFVzZSBub2RlSG9vayBpZiBkZWZpbmVkICgjMTk1NCk7IG90aGVyd2lzZSBzZXRBdHRyaWJ1dGUgaXMgZmluZQoJCQkJCXJldHVybiBub2RlSG9vayAmJiBub2RlSG9vay5zZXQoIGVsZW0sIHZhbHVlLCBuYW1lICk7CgkJCQl9CgkJCX0KCQl9OwoJfQoKCS8vIElFNi83IGRvIG5vdCBzdXBwb3J0IGdldHRpbmcvc2V0dGluZyBzb21lIGF0dHJpYnV0ZXMgd2l0aCBnZXQvc2V0QXR0cmlidXRlCglpZiAoICFnZXRTZXRBdHRyaWJ1dGUgKSB7CgoJCS8vIFVzZSB0aGlzIGZvciBhbnkgYXR0cmlidXRlIGluIElFNi83CgkJLy8gVGhpcyBmaXhlcyBhbG1vc3QgZXZlcnkgSUU2LzcgaXNzdWUKCQlub2RlSG9vayA9IHsKCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIG5hbWUgKSB7CgoJCQkJLy8gU2V0IHRoZSBleGlzdGluZyBvciBjcmVhdGUgYSBuZXcgYXR0cmlidXRlIG5vZGUKCQkJCXZhciByZXQgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoIG5hbWUgKTsKCQkJCWlmICggIXJldCApIHsKCQkJCQllbGVtLnNldEF0dHJpYnV0ZU5vZGUoCgkJCQkJCSggcmV0ID0gZWxlbS5vd25lckRvY3VtZW50LmNyZWF0ZUF0dHJpYnV0ZSggbmFtZSApICkKCQkJCQkpOwoJCQkJfQoKCQkJCXJldC52YWx1ZSA9IHZhbHVlICs9ICIiOwoKCQkJCS8vIEJyZWFrIGFzc29jaWF0aW9uIHdpdGggY2xvbmVkIGVsZW1lbnRzIGJ5IGFsc28gdXNpbmcgc2V0QXR0cmlidXRlICgjOTY0NikKCQkJCWlmICggbmFtZSA9PT0gInZhbHVlIiB8fCB2YWx1ZSA9PT0gZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUgKSApIHsKCQkJCQlyZXR1cm4gdmFsdWU7CgkJCQl9CgkJCX0KCQl9OwoKCQkvLyBTb21lIGF0dHJpYnV0ZXMgYXJlIGNvbnN0cnVjdGVkIHdpdGggZW1wdHktc3RyaW5nIHZhbHVlcyB3aGVuIG5vdCBkZWZpbmVkCgkJYXR0ckhhbmRsZS5pZCA9IGF0dHJIYW5kbGUubmFtZSA9IGF0dHJIYW5kbGUuY29vcmRzID0KCQkJZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkgewoJCQkJdmFyIHJldDsKCQkJCWlmICggIWlzWE1MICkgewoJCQkJCXJldHVybiAoIHJldCA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZSggbmFtZSApICkgJiYgcmV0LnZhbHVlICE9PSAiIiA/CgkJCQkJCXJldC52YWx1ZSA6CgkJCQkJCW51bGw7CgkJCQl9CgkJCX07CgoJCS8vIEZpeGluZyB2YWx1ZSByZXRyaWV2YWwgb24gYSBidXR0b24gcmVxdWlyZXMgdGhpcyBtb2R1bGUKCQlqUXVlcnkudmFsSG9va3MuYnV0dG9uID0gewoJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkgewoJCQkJdmFyIHJldCA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZSggbmFtZSApOwoJCQkJaWYgKCByZXQgJiYgcmV0LnNwZWNpZmllZCApIHsKCQkJCQlyZXR1cm4gcmV0LnZhbHVlOwoJCQkJfQoJCQl9LAoJCQlzZXQ6IG5vZGVIb29rLnNldAoJCX07CgoJCS8vIFNldCBjb250ZW50ZWRpdGFibGUgdG8gZmFsc2Ugb24gcmVtb3ZhbHMoIzEwNDI5KQoJCS8vIFNldHRpbmcgdG8gZW1wdHkgc3RyaW5nIHRocm93cyBhbiBlcnJvciBhcyBhbiBpbnZhbGlkIHZhbHVlCgkJalF1ZXJ5LmF0dHJIb29rcy5jb250ZW50ZWRpdGFibGUgPSB7CgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlLCBuYW1lICkgewoJCQkJbm9kZUhvb2suc2V0KCBlbGVtLCB2YWx1ZSA9PT0gIiIgPyBmYWxzZSA6IHZhbHVlLCBuYW1lICk7CgkJCX0KCQl9OwoKCQkvLyBTZXQgd2lkdGggYW5kIGhlaWdodCB0byBhdXRvIGluc3RlYWQgb2YgMCBvbiBlbXB0eSBzdHJpbmcoIEJ1ZyAjODE1MCApCgkJLy8gVGhpcyBpcyBmb3IgcmVtb3ZhbHMKCQlqUXVlcnkuZWFjaCggWyAid2lkdGgiLCAiaGVpZ2h0IiBdLCBmdW5jdGlvbiggaSwgbmFtZSApIHsKCQkJalF1ZXJ5LmF0dHJIb29rc1sgbmFtZSBdID0gewoJCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUgKSB7CgkJCQkJaWYgKCB2YWx1ZSA9PT0gIiIgKSB7CgkJCQkJCWVsZW0uc2V0QXR0cmlidXRlKCBuYW1lLCAiYXV0byIgKTsKCQkJCQkJcmV0dXJuIHZhbHVlOwoJCQkJCX0KCQkJCX0KCQkJfTsKCQl9ICk7Cgl9CgoJaWYgKCAhc3VwcG9ydC5zdHlsZSApIHsKCQlqUXVlcnkuYXR0ckhvb2tzLnN0eWxlID0gewoJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoKCQkJCS8vIFJldHVybiB1bmRlZmluZWQgaW4gdGhlIGNhc2Ugb2YgZW1wdHkgc3RyaW5nCgkJCQkvLyBOb3RlOiBJRSB1cHBlcmNhc2VzIGNzcyBwcm9wZXJ0eSBuYW1lcywgYnV0IGlmIHdlIHdlcmUgdG8gLnRvTG93ZXJDYXNlKCkKCQkJCS8vIC5jc3NUZXh0LCB0aGF0IHdvdWxkIGRlc3Ryb3kgY2FzZSBzZW5zaXRpdml0eSBpbiBVUkwncywgbGlrZSBpbiAiYmFja2dyb3VuZCIKCQkJCXJldHVybiBlbGVtLnN0eWxlLmNzc1RleHQgfHwgdW5kZWZpbmVkOwoJCQl9LAoJCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHsKCQkJCXJldHVybiAoIGVsZW0uc3R5bGUuY3NzVGV4dCA9IHZhbHVlICsgIiIgKTsKCQkJfQoJCX07Cgl9CgoKCgoJdmFyIHJmb2N1c2FibGUgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b258b2JqZWN0KSQvaSwKCQlyY2xpY2thYmxlID0gL14oPzphfGFyZWEpJC9pOwoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCQlwcm9wOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7CgkJCXJldHVybiBhY2Nlc3MoIHRoaXMsIGpRdWVyeS5wcm9wLCBuYW1lLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgKTsKCQl9LAoKCQlyZW1vdmVQcm9wOiBmdW5jdGlvbiggbmFtZSApIHsKCQkJbmFtZSA9IGpRdWVyeS5wcm9wRml4WyBuYW1lIF0gfHwgbmFtZTsKCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgoJCQkJLy8gdHJ5L2NhdGNoIGhhbmRsZXMgY2FzZXMgd2hlcmUgSUUgYmFsa3MgKHN1Y2ggYXMgcmVtb3ZpbmcgYSBwcm9wZXJ0eSBvbiB3aW5kb3cpCgkJCQl0cnkgewoJCQkJCXRoaXNbIG5hbWUgXSA9IHVuZGVmaW5lZDsKCQkJCQlkZWxldGUgdGhpc1sgbmFtZSBdOwoJCQkJfSBjYXRjaCAoIGUgKSB7fQoJCQl9ICk7CgkJfQoJfSApOwoKCWpRdWVyeS5leHRlbmQoIHsKCQlwcm9wOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUgKSB7CgkJCXZhciByZXQsIGhvb2tzLAoJCQkJblR5cGUgPSBlbGVtLm5vZGVUeXBlOwoKCQkJLy8gRG9uJ3QgZ2V0L3NldCBwcm9wZXJ0aWVzIG9uIHRleHQsIGNvbW1lbnQgYW5kIGF0dHJpYnV0ZSBub2RlcwoJCQlpZiAoIG5UeXBlID09PSAzIHx8IG5UeXBlID09PSA4IHx8IG5UeXBlID09PSAyICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQlpZiAoIG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoIGVsZW0gKSApIHsKCgkJCQkvLyBGaXggbmFtZSBhbmQgYXR0YWNoIGhvb2tzCgkJCQluYW1lID0galF1ZXJ5LnByb3BGaXhbIG5hbWUgXSB8fCBuYW1lOwoJCQkJaG9va3MgPSBqUXVlcnkucHJvcEhvb2tzWyBuYW1lIF07CgkJCX0KCgkJCWlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHsKCQkJCWlmICggaG9va3MgJiYgInNldCIgaW4gaG9va3MgJiYKCQkJCQkoIHJldCA9IGhvb2tzLnNldCggZWxlbSwgdmFsdWUsIG5hbWUgKSApICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJcmV0dXJuIHJldDsKCQkJCX0KCgkJCQlyZXR1cm4gKCBlbGVtWyBuYW1lIF0gPSB2YWx1ZSApOwoJCQl9CgoJCQlpZiAoIGhvb2tzICYmICJnZXQiIGluIGhvb2tzICYmICggcmV0ID0gaG9va3MuZ2V0KCBlbGVtLCBuYW1lICkgKSAhPT0gbnVsbCApIHsKCQkJCXJldHVybiByZXQ7CgkJCX0KCgkJCXJldHVybiBlbGVtWyBuYW1lIF07CgkJfSwKCgkJcHJvcEhvb2tzOiB7CgkJCXRhYkluZGV4OiB7CgkJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoKCQkJCQkvLyBlbGVtLnRhYkluZGV4IGRvZXNuJ3QgYWx3YXlzIHJldHVybiB0aGUKCQkJCQkvLyBjb3JyZWN0IHZhbHVlIHdoZW4gaXQgaGFzbid0IGJlZW4gZXhwbGljaXRseSBzZXQKCQkJCQkvLyBodHRwOi8vZmx1aWRwcm9qZWN0Lm9yZy9ibG9nLzIwMDgvMDEvMDkvZ2V0dGluZy1zZXR0aW5nLWFuZC1yZW1vdmluZy10YWJpbmRleC12YWx1ZXMtd2l0aC1qYXZhc2NyaXB0LwoJCQkJCS8vIFVzZSBwcm9wZXIgYXR0cmlidXRlIHJldHJpZXZhbCgjMTIwNzIpCgkJCQkJdmFyIHRhYmluZGV4ID0galF1ZXJ5LmZpbmQuYXR0ciggZWxlbSwgInRhYmluZGV4IiApOwoKCQkJCQlyZXR1cm4gdGFiaW5kZXggPwoJCQkJCQlwYXJzZUludCggdGFiaW5kZXgsIDEwICkgOgoJCQkJCQlyZm9jdXNhYmxlLnRlc3QoIGVsZW0ubm9kZU5hbWUgKSB8fAoJCQkJCQkJcmNsaWNrYWJsZS50ZXN0KCBlbGVtLm5vZGVOYW1lICkgJiYgZWxlbS5ocmVmID8KCQkJCQkJCQkwIDoKCQkJCQkJCQktMTsKCQkJCX0KCQkJfQoJCX0sCgoJCXByb3BGaXg6IHsKCQkJImZvciI6ICJodG1sRm9yIiwKCQkJImNsYXNzIjogImNsYXNzTmFtZSIKCQl9Cgl9ICk7CgoJLy8gU29tZSBhdHRyaWJ1dGVzIHJlcXVpcmUgYSBzcGVjaWFsIGNhbGwgb24gSUUKCS8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9tczUzNjQyOSUyOFZTLjg1JTI5LmFzcHgKCWlmICggIXN1cHBvcnQuaHJlZk5vcm1hbGl6ZWQgKSB7CgoJCS8vIGhyZWYvc3JjIHByb3BlcnR5IHNob3VsZCBnZXQgdGhlIGZ1bGwgbm9ybWFsaXplZCBVUkwgKCMxMDI5OS8jMTI5MTUpCgkJalF1ZXJ5LmVhY2goIFsgImhyZWYiLCAic3JjIiBdLCBmdW5jdGlvbiggaSwgbmFtZSApIHsKCQkJalF1ZXJ5LnByb3BIb29rc1sgbmFtZSBdID0gewoJCQkJZ2V0OiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCQlyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUsIDQgKTsKCQkJCX0KCQkJfTsKCQl9ICk7Cgl9CgoJLy8gU3VwcG9ydDogU2FmYXJpLCBJRTkrCgkvLyBtaXMtcmVwb3J0cyB0aGUgZGVmYXVsdCBzZWxlY3RlZCBwcm9wZXJ0eSBvZiBhbiBvcHRpb24KCS8vIEFjY2Vzc2luZyB0aGUgcGFyZW50J3Mgc2VsZWN0ZWRJbmRleCBwcm9wZXJ0eSBmaXhlcyBpdAoJaWYgKCAhc3VwcG9ydC5vcHRTZWxlY3RlZCApIHsKCQlqUXVlcnkucHJvcEhvb2tzLnNlbGVjdGVkID0gewoJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJdmFyIHBhcmVudCA9IGVsZW0ucGFyZW50Tm9kZTsKCgkJCQlpZiAoIHBhcmVudCApIHsKCQkJCQlwYXJlbnQuc2VsZWN0ZWRJbmRleDsKCgkJCQkJLy8gTWFrZSBzdXJlIHRoYXQgaXQgYWxzbyB3b3JrcyB3aXRoIG9wdGdyb3Vwcywgc2VlICM1NzAxCgkJCQkJaWYgKCBwYXJlbnQucGFyZW50Tm9kZSApIHsKCQkJCQkJcGFyZW50LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleDsKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gbnVsbDsKCQkJfQoJCX07Cgl9CgoJalF1ZXJ5LmVhY2goIFsKCQkidGFiSW5kZXgiLAoJCSJyZWFkT25seSIsCgkJIm1heExlbmd0aCIsCgkJImNlbGxTcGFjaW5nIiwKCQkiY2VsbFBhZGRpbmciLAoJCSJyb3dTcGFuIiwKCQkiY29sU3BhbiIsCgkJInVzZU1hcCIsCgkJImZyYW1lQm9yZGVyIiwKCQkiY29udGVudEVkaXRhYmxlIgoJXSwgZnVuY3Rpb24oKSB7CgkJalF1ZXJ5LnByb3BGaXhbIHRoaXMudG9Mb3dlckNhc2UoKSBdID0gdGhpczsKCX0gKTsKCgkvLyBJRTYvNyBjYWxsIGVuY3R5cGUgZW5jb2RpbmcKCWlmICggIXN1cHBvcnQuZW5jdHlwZSApIHsKCQlqUXVlcnkucHJvcEZpeC5lbmN0eXBlID0gImVuY29kaW5nIjsKCX0KCgoKCgl2YXIgcmNsYXNzID0gL1tcdFxyXG5cZl0vZzsKCglmdW5jdGlvbiBnZXRDbGFzcyggZWxlbSApIHsKCQlyZXR1cm4galF1ZXJ5LmF0dHIoIGVsZW0sICJjbGFzcyIgKSB8fCAiIjsKCX0KCglqUXVlcnkuZm4uZXh0ZW5kKCB7CgkJYWRkQ2xhc3M6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJdmFyIGNsYXNzZXMsIGVsZW0sIGN1ciwgY3VyVmFsdWUsIGNsYXp6LCBqLCBmaW5hbFZhbHVlLAoJCQkJaSA9IDA7CgoJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oIGogKSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkuYWRkQ2xhc3MoIHZhbHVlLmNhbGwoIHRoaXMsIGosIGdldENsYXNzKCB0aGlzICkgKSApOwoJCQkJfSApOwoJCQl9CgoJCQlpZiAoIHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYgdmFsdWUgKSB7CgkJCQljbGFzc2VzID0gdmFsdWUubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdOwoKCQkJCXdoaWxlICggKCBlbGVtID0gdGhpc1sgaSsrIF0gKSApIHsKCQkJCQljdXJWYWx1ZSA9IGdldENsYXNzKCBlbGVtICk7CgkJCQkJY3VyID0gZWxlbS5ub2RlVHlwZSA9PT0gMSAmJgoJCQkJCQkoICIgIiArIGN1clZhbHVlICsgIiAiICkucmVwbGFjZSggcmNsYXNzLCAiICIgKTsKCgkJCQkJaWYgKCBjdXIgKSB7CgkJCQkJCWogPSAwOwoJCQkJCQl3aGlsZSAoICggY2xhenogPSBjbGFzc2VzWyBqKysgXSApICkgewoJCQkJCQkJaWYgKCBjdXIuaW5kZXhPZiggIiAiICsgY2xhenogKyAiICIgKSA8IDAgKSB7CgkJCQkJCQkJY3VyICs9IGNsYXp6ICsgIiAiOwoJCQkJCQkJfQoJCQkJCQl9CgoJCQkJCQkvLyBvbmx5IGFzc2lnbiBpZiBkaWZmZXJlbnQgdG8gYXZvaWQgdW5uZWVkZWQgcmVuZGVyaW5nLgoJCQkJCQlmaW5hbFZhbHVlID0galF1ZXJ5LnRyaW0oIGN1ciApOwoJCQkJCQlpZiAoIGN1clZhbHVlICE9PSBmaW5hbFZhbHVlICkgewoJCQkJCQkJalF1ZXJ5LmF0dHIoIGVsZW0sICJjbGFzcyIsIGZpbmFsVmFsdWUgKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIHRoaXM7CgkJfSwKCgkJcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJdmFyIGNsYXNzZXMsIGVsZW0sIGN1ciwgY3VyVmFsdWUsIGNsYXp6LCBqLCBmaW5hbFZhbHVlLAoJCQkJaSA9IDA7CgoJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oIGogKSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkucmVtb3ZlQ2xhc3MoIHZhbHVlLmNhbGwoIHRoaXMsIGosIGdldENsYXNzKCB0aGlzICkgKSApOwoJCQkJfSApOwoJCQl9CgoJCQlpZiAoICFhcmd1bWVudHMubGVuZ3RoICkgewoJCQkJcmV0dXJuIHRoaXMuYXR0ciggImNsYXNzIiwgIiIgKTsKCQkJfQoKCQkJaWYgKCB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICYmIHZhbHVlICkgewoJCQkJY2xhc3NlcyA9IHZhbHVlLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbXTsKCgkJCQl3aGlsZSAoICggZWxlbSA9IHRoaXNbIGkrKyBdICkgKSB7CgkJCQkJY3VyVmFsdWUgPSBnZXRDbGFzcyggZWxlbSApOwoKCQkJCQkvLyBUaGlzIGV4cHJlc3Npb24gaXMgaGVyZSBmb3IgYmV0dGVyIGNvbXByZXNzaWJpbGl0eSAoc2VlIGFkZENsYXNzKQoJCQkJCWN1ciA9IGVsZW0ubm9kZVR5cGUgPT09IDEgJiYKCQkJCQkJKCAiICIgKyBjdXJWYWx1ZSArICIgIiApLnJlcGxhY2UoIHJjbGFzcywgIiAiICk7CgoJCQkJCWlmICggY3VyICkgewoJCQkJCQlqID0gMDsKCQkJCQkJd2hpbGUgKCAoIGNsYXp6ID0gY2xhc3Nlc1sgaisrIF0gKSApIHsKCgkJCQkJCQkvLyBSZW1vdmUgKmFsbCogaW5zdGFuY2VzCgkJCQkJCQl3aGlsZSAoIGN1ci5pbmRleE9mKCAiICIgKyBjbGF6eiArICIgIiApID4gLTEgKSB7CgkJCQkJCQkJY3VyID0gY3VyLnJlcGxhY2UoICIgIiArIGNsYXp6ICsgIiAiLCAiICIgKTsKCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJLy8gT25seSBhc3NpZ24gaWYgZGlmZmVyZW50IHRvIGF2b2lkIHVubmVlZGVkIHJlbmRlcmluZy4KCQkJCQkJZmluYWxWYWx1ZSA9IGpRdWVyeS50cmltKCBjdXIgKTsKCQkJCQkJaWYgKCBjdXJWYWx1ZSAhPT0gZmluYWxWYWx1ZSApIHsKCQkJCQkJCWpRdWVyeS5hdHRyKCBlbGVtLCAiY2xhc3MiLCBmaW5hbFZhbHVlICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCgkJCXJldHVybiB0aGlzOwoJCX0sCgoJCXRvZ2dsZUNsYXNzOiBmdW5jdGlvbiggdmFsdWUsIHN0YXRlVmFsICkgewoJCQl2YXIgdHlwZSA9IHR5cGVvZiB2YWx1ZTsKCgkJCWlmICggdHlwZW9mIHN0YXRlVmFsID09PSAiYm9vbGVhbiIgJiYgdHlwZSA9PT0gInN0cmluZyIgKSB7CgkJCQlyZXR1cm4gc3RhdGVWYWwgPyB0aGlzLmFkZENsYXNzKCB2YWx1ZSApIDogdGhpcy5yZW1vdmVDbGFzcyggdmFsdWUgKTsKCQkJfQoKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHsKCQkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCBpICkgewoJCQkJCWpRdWVyeSggdGhpcyApLnRvZ2dsZUNsYXNzKAoJCQkJCQl2YWx1ZS5jYWxsKCB0aGlzLCBpLCBnZXRDbGFzcyggdGhpcyApLCBzdGF0ZVZhbCApLAoJCQkJCQlzdGF0ZVZhbAoJCQkJCSk7CgkJCQl9ICk7CgkJCX0KCgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJdmFyIGNsYXNzTmFtZSwgaSwgc2VsZiwgY2xhc3NOYW1lczsKCgkJCQlpZiAoIHR5cGUgPT09ICJzdHJpbmciICkgewoKCQkJCQkvLyBUb2dnbGUgaW5kaXZpZHVhbCBjbGFzcyBuYW1lcwoJCQkJCWkgPSAwOwoJCQkJCXNlbGYgPSBqUXVlcnkoIHRoaXMgKTsKCQkJCQljbGFzc05hbWVzID0gdmFsdWUubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdOwoKCQkJCQl3aGlsZSAoICggY2xhc3NOYW1lID0gY2xhc3NOYW1lc1sgaSsrIF0gKSApIHsKCgkJCQkJCS8vIENoZWNrIGVhY2ggY2xhc3NOYW1lIGdpdmVuLCBzcGFjZSBzZXBhcmF0ZWQgbGlzdAoJCQkJCQlpZiAoIHNlbGYuaGFzQ2xhc3MoIGNsYXNzTmFtZSApICkgewoJCQkJCQkJc2VsZi5yZW1vdmVDbGFzcyggY2xhc3NOYW1lICk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQlzZWxmLmFkZENsYXNzKCBjbGFzc05hbWUgKTsKCQkJCQkJfQoJCQkJCX0KCgkJCQkvLyBUb2dnbGUgd2hvbGUgY2xhc3MgbmFtZQoJCQkJfSBlbHNlIGlmICggdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB0eXBlID09PSAiYm9vbGVhbiIgKSB7CgkJCQkJY2xhc3NOYW1lID0gZ2V0Q2xhc3MoIHRoaXMgKTsKCQkJCQlpZiAoIGNsYXNzTmFtZSApIHsKCgkJCQkJCS8vIHN0b3JlIGNsYXNzTmFtZSBpZiBzZXQKCQkJCQkJalF1ZXJ5Ll9kYXRhKCB0aGlzLCAiX19jbGFzc05hbWVfXyIsIGNsYXNzTmFtZSApOwoJCQkJCX0KCgkJCQkJLy8gSWYgdGhlIGVsZW1lbnQgaGFzIGEgY2xhc3MgbmFtZSBvciBpZiB3ZSdyZSBwYXNzZWQgImZhbHNlIiwKCQkJCQkvLyB0aGVuIHJlbW92ZSB0aGUgd2hvbGUgY2xhc3NuYW1lIChpZiB0aGVyZSB3YXMgb25lLCB0aGUgYWJvdmUgc2F2ZWQgaXQpLgoJCQkJCS8vIE90aGVyd2lzZSBicmluZyBiYWNrIHdoYXRldmVyIHdhcyBwcmV2aW91c2x5IHNhdmVkIChpZiBhbnl0aGluZyksCgkJCQkJLy8gZmFsbGluZyBiYWNrIHRvIHRoZSBlbXB0eSBzdHJpbmcgaWYgbm90aGluZyB3YXMgc3RvcmVkLgoJCQkJCWpRdWVyeS5hdHRyKCB0aGlzLCAiY2xhc3MiLAoJCQkJCQljbGFzc05hbWUgfHwgdmFsdWUgPT09IGZhbHNlID8KCQkJCQkJIiIgOgoJCQkJCQlqUXVlcnkuX2RhdGEoIHRoaXMsICJfX2NsYXNzTmFtZV9fIiApIHx8ICIiCgkJCQkJKTsKCQkJCX0KCQkJfSApOwoJCX0sCgoJCWhhc0NsYXNzOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXZhciBjbGFzc05hbWUsIGVsZW0sCgkJCQlpID0gMDsKCgkJCWNsYXNzTmFtZSA9ICIgIiArIHNlbGVjdG9yICsgIiAiOwoJCQl3aGlsZSAoICggZWxlbSA9IHRoaXNbIGkrKyBdICkgKSB7CgkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgJiYKCQkJCQkoICIgIiArIGdldENsYXNzKCBlbGVtICkgKyAiICIgKS5yZXBsYWNlKCByY2xhc3MsICIgIiApCgkJCQkJCS5pbmRleE9mKCBjbGFzc05hbWUgKSA+IC0xCgkJCQkpIHsKCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCX0gKTsKCgoKCgkvLyBSZXR1cm4galF1ZXJ5IGZvciBhdHRyaWJ1dGVzLW9ubHkgaW5jbHVzaW9uCgoKCWpRdWVyeS5lYWNoKCAoICJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgbG9hZCByZXNpemUgc2Nyb2xsIHVubG9hZCBjbGljayBkYmxjbGljayAiICsKCQkibW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgIiArCgkJImNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgZXJyb3IgY29udGV4dG1lbnUiICkuc3BsaXQoICIgIiApLAoJCWZ1bmN0aW9uKCBpLCBuYW1lICkgewoKCQkvLyBIYW5kbGUgZXZlbnQgYmluZGluZwoJCWpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIGRhdGEsIGZuICkgewoJCQlyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDAgPwoJCQkJdGhpcy5vbiggbmFtZSwgbnVsbCwgZGF0YSwgZm4gKSA6CgkJCQl0aGlzLnRyaWdnZXIoIG5hbWUgKTsKCQl9OwoJfSApOwoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCQlob3ZlcjogZnVuY3Rpb24oIGZuT3ZlciwgZm5PdXQgKSB7CgkJCXJldHVybiB0aGlzLm1vdXNlZW50ZXIoIGZuT3ZlciApLm1vdXNlbGVhdmUoIGZuT3V0IHx8IGZuT3ZlciApOwoJCX0KCX0gKTsKCgoJdmFyIGxvY2F0aW9uID0gd2luZG93LmxvY2F0aW9uOwoKCXZhciBub25jZSA9IGpRdWVyeS5ub3coKTsKCgl2YXIgcnF1ZXJ5ID0gKCAvXD8vICk7CgoKCgl2YXIgcnZhbGlkdG9rZW5zID0gLygsKXwoXFt8eyl8KH18XSl8Iig/OlteIlxcXHJcbl18XFxbIlxcXC9iZm5ydF18XFx1W1xkYS1mQS1GXXs0fSkqIlxzKjo/fHRydWV8ZmFsc2V8bnVsbHwtPyg/ITBcZClcZCsoPzpcLlxkK3wpKD86W2VFXVsrLV0/XGQrfCkvZzsKCglqUXVlcnkucGFyc2VKU09OID0gZnVuY3Rpb24oIGRhdGEgKSB7CgoJCS8vIEF0dGVtcHQgdG8gcGFyc2UgdXNpbmcgdGhlIG5hdGl2ZSBKU09OIHBhcnNlciBmaXJzdAoJCWlmICggd2luZG93LkpTT04gJiYgd2luZG93LkpTT04ucGFyc2UgKSB7CgoJCQkvLyBTdXBwb3J0OiBBbmRyb2lkIDIuMwoJCQkvLyBXb3JrYXJvdW5kIGZhaWx1cmUgdG8gc3RyaW5nLWNhc3QgbnVsbCBpbnB1dAoJCQlyZXR1cm4gd2luZG93LkpTT04ucGFyc2UoIGRhdGEgKyAiIiApOwoJCX0KCgkJdmFyIHJlcXVpcmVOb25Db21tYSwKCQkJZGVwdGggPSBudWxsLAoJCQlzdHIgPSBqUXVlcnkudHJpbSggZGF0YSArICIiICk7CgoJCS8vIEd1YXJkIGFnYWluc3QgaW52YWxpZCAoYW5kIHBvc3NpYmx5IGRhbmdlcm91cykgaW5wdXQgYnkgZW5zdXJpbmcgdGhhdCBub3RoaW5nIHJlbWFpbnMKCQkvLyBhZnRlciByZW1vdmluZyB2YWxpZCB0b2tlbnMKCQlyZXR1cm4gc3RyICYmICFqUXVlcnkudHJpbSggc3RyLnJlcGxhY2UoIHJ2YWxpZHRva2VucywgZnVuY3Rpb24oIHRva2VuLCBjb21tYSwgb3BlbiwgY2xvc2UgKSB7CgoJCQkvLyBGb3JjZSB0ZXJtaW5hdGlvbiBpZiB3ZSBzZWUgYSBtaXNwbGFjZWQgY29tbWEKCQkJaWYgKCByZXF1aXJlTm9uQ29tbWEgJiYgY29tbWEgKSB7CgkJCQlkZXB0aCA9IDA7CgkJCX0KCgkJCS8vIFBlcmZvcm0gbm8gbW9yZSByZXBsYWNlbWVudHMgYWZ0ZXIgcmV0dXJuaW5nIHRvIG91dGVybW9zdCBkZXB0aAoJCQlpZiAoIGRlcHRoID09PSAwICkgewoJCQkJcmV0dXJuIHRva2VuOwoJCQl9CgoJCQkvLyBDb21tYXMgbXVzdCBub3QgZm9sbG93ICJbIiwgInsiLCBvciAiLCIKCQkJcmVxdWlyZU5vbkNvbW1hID0gb3BlbiB8fCBjb21tYTsKCgkJCS8vIERldGVybWluZSBuZXcgZGVwdGgKCQkJLy8gYXJyYXkvb2JqZWN0IG9wZW4gKCJbIiBvciAieyIpOiBkZXB0aCArPSB0cnVlIC0gZmFsc2UgKGluY3JlbWVudCkKCQkJLy8gYXJyYXkvb2JqZWN0IGNsb3NlICgiXSIgb3IgIn0iKTogZGVwdGggKz0gZmFsc2UgLSB0cnVlIChkZWNyZW1lbnQpCgkJCS8vIG90aGVyIGNhc2VzICgiLCIgb3IgcHJpbWl0aXZlKTogZGVwdGggKz0gdHJ1ZSAtIHRydWUgKG51bWVyaWMgY2FzdCkKCQkJZGVwdGggKz0gIWNsb3NlIC0gIW9wZW47CgoJCQkvLyBSZW1vdmUgdGhpcyB0b2tlbgoJCQlyZXR1cm4gIiI7CgkJfSApICkgPwoJCQkoIEZ1bmN0aW9uKCAicmV0dXJuICIgKyBzdHIgKSApKCkgOgoJCQlqUXVlcnkuZXJyb3IoICJJbnZhbGlkIEpTT046ICIgKyBkYXRhICk7Cgl9OwoKCgkvLyBDcm9zcy1icm93c2VyIHhtbCBwYXJzaW5nCglqUXVlcnkucGFyc2VYTUwgPSBmdW5jdGlvbiggZGF0YSApIHsKCQl2YXIgeG1sLCB0bXA7CgkJaWYgKCAhZGF0YSB8fCB0eXBlb2YgZGF0YSAhPT0gInN0cmluZyIgKSB7CgkJCXJldHVybiBudWxsOwoJCX0KCQl0cnkgewoJCQlpZiAoIHdpbmRvdy5ET01QYXJzZXIgKSB7IC8vIFN0YW5kYXJkCgkJCQl0bXAgPSBuZXcgd2luZG93LkRPTVBhcnNlcigpOwoJCQkJeG1sID0gdG1wLnBhcnNlRnJvbVN0cmluZyggZGF0YSwgInRleHQveG1sIiApOwoJCQl9IGVsc2UgeyAvLyBJRQoJCQkJeG1sID0gbmV3IHdpbmRvdy5BY3RpdmVYT2JqZWN0KCAiTWljcm9zb2Z0LlhNTERPTSIgKTsKCQkJCXhtbC5hc3luYyA9ICJmYWxzZSI7CgkJCQl4bWwubG9hZFhNTCggZGF0YSApOwoJCQl9CgkJfSBjYXRjaCAoIGUgKSB7CgkJCXhtbCA9IHVuZGVmaW5lZDsKCQl9CgkJaWYgKCAheG1sIHx8ICF4bWwuZG9jdW1lbnRFbGVtZW50IHx8IHhtbC5nZXRFbGVtZW50c0J5VGFnTmFtZSggInBhcnNlcmVycm9yIiApLmxlbmd0aCApIHsKCQkJalF1ZXJ5LmVycm9yKCAiSW52YWxpZCBYTUw6ICIgKyBkYXRhICk7CgkJfQoJCXJldHVybiB4bWw7Cgl9OwoKCgl2YXIKCQlyaGFzaCA9IC8jLiokLywKCQlydHMgPSAvKFs/Jl0pXz1bXiZdKi8sCgoJCS8vIElFIGxlYXZlcyBhbiBcciBjaGFyYWN0ZXIgYXQgRU9MCgkJcmhlYWRlcnMgPSAvXiguKj8pOlsgXHRdKihbXlxyXG5dKilccj8kL21nLAoKCQkvLyAjNzY1MywgIzgxMjUsICM4MTUyOiBsb2NhbCBwcm90b2NvbCBkZXRlY3Rpb24KCQlybG9jYWxQcm90b2NvbCA9IC9eKD86YWJvdXR8YXBwfGFwcC1zdG9yYWdlfC4rLWV4dGVuc2lvbnxmaWxlfHJlc3x3aWRnZXQpOiQvLAoJCXJub0NvbnRlbnQgPSAvXig/OkdFVHxIRUFEKSQvLAoJCXJwcm90b2NvbCA9IC9eXC9cLy8sCgkJcnVybCA9IC9eKFtcdy4rLV0rOikoPzpcL1wvKD86W15cLz8jXSpAfCkoW15cLz8jOl0qKSg/OjooXGQrKXwpfCkvLAoKCQkvKiBQcmVmaWx0ZXJzCgkJICogMSkgVGhleSBhcmUgdXNlZnVsIHRvIGludHJvZHVjZSBjdXN0b20gZGF0YVR5cGVzIChzZWUgYWpheC9qc29ucC5qcyBmb3IgYW4gZXhhbXBsZSkKCQkgKiAyKSBUaGVzZSBhcmUgY2FsbGVkOgoJCSAqICAgIC0gQkVGT1JFIGFza2luZyBmb3IgYSB0cmFuc3BvcnQKCQkgKiAgICAtIEFGVEVSIHBhcmFtIHNlcmlhbGl6YXRpb24gKHMuZGF0YSBpcyBhIHN0cmluZyBpZiBzLnByb2Nlc3NEYXRhIGlzIHRydWUpCgkJICogMykga2V5IGlzIHRoZSBkYXRhVHlwZQoJCSAqIDQpIHRoZSBjYXRjaGFsbCBzeW1ib2wgIioiIGNhbiBiZSB1c2VkCgkJICogNSkgZXhlY3V0aW9uIHdpbGwgc3RhcnQgd2l0aCB0cmFuc3BvcnQgZGF0YVR5cGUgYW5kIFRIRU4gY29udGludWUgZG93biB0byAiKiIgaWYgbmVlZGVkCgkJICovCgkJcHJlZmlsdGVycyA9IHt9LAoKCQkvKiBUcmFuc3BvcnRzIGJpbmRpbmdzCgkJICogMSkga2V5IGlzIHRoZSBkYXRhVHlwZQoJCSAqIDIpIHRoZSBjYXRjaGFsbCBzeW1ib2wgIioiIGNhbiBiZSB1c2VkCgkJICogMykgc2VsZWN0aW9uIHdpbGwgc3RhcnQgd2l0aCB0cmFuc3BvcnQgZGF0YVR5cGUgYW5kIFRIRU4gZ28gdG8gIioiIGlmIG5lZWRlZAoJCSAqLwoJCXRyYW5zcG9ydHMgPSB7fSwKCgkJLy8gQXZvaWQgY29tbWVudC1wcm9sb2cgY2hhciBzZXF1ZW5jZSAoIzEwMDk4KTsgbXVzdCBhcHBlYXNlIGxpbnQgYW5kIGV2YWRlIGNvbXByZXNzaW9uCgkJYWxsVHlwZXMgPSAiKi8iLmNvbmNhdCggIioiICksCgoJCS8vIERvY3VtZW50IGxvY2F0aW9uCgkJYWpheExvY2F0aW9uID0gbG9jYXRpb24uaHJlZiwKCgkJLy8gU2VnbWVudCBsb2NhdGlvbiBpbnRvIHBhcnRzCgkJYWpheExvY1BhcnRzID0gcnVybC5leGVjKCBhamF4TG9jYXRpb24udG9Mb3dlckNhc2UoKSApIHx8IFtdOwoKCS8vIEJhc2UgImNvbnN0cnVjdG9yIiBmb3IgalF1ZXJ5LmFqYXhQcmVmaWx0ZXIgYW5kIGpRdWVyeS5hamF4VHJhbnNwb3J0CglmdW5jdGlvbiBhZGRUb1ByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHN0cnVjdHVyZSApIHsKCgkJLy8gZGF0YVR5cGVFeHByZXNzaW9uIGlzIG9wdGlvbmFsIGFuZCBkZWZhdWx0cyB0byAiKiIKCQlyZXR1cm4gZnVuY3Rpb24oIGRhdGFUeXBlRXhwcmVzc2lvbiwgZnVuYyApIHsKCgkJCWlmICggdHlwZW9mIGRhdGFUeXBlRXhwcmVzc2lvbiAhPT0gInN0cmluZyIgKSB7CgkJCQlmdW5jID0gZGF0YVR5cGVFeHByZXNzaW9uOwoJCQkJZGF0YVR5cGVFeHByZXNzaW9uID0gIioiOwoJCQl9CgoJCQl2YXIgZGF0YVR5cGUsCgkJCQlpID0gMCwKCQkJCWRhdGFUeXBlcyA9IGRhdGFUeXBlRXhwcmVzc2lvbi50b0xvd2VyQ2FzZSgpLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbXTsKCgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGZ1bmMgKSApIHsKCgkJCQkvLyBGb3IgZWFjaCBkYXRhVHlwZSBpbiB0aGUgZGF0YVR5cGVFeHByZXNzaW9uCgkJCQl3aGlsZSAoICggZGF0YVR5cGUgPSBkYXRhVHlwZXNbIGkrKyBdICkgKSB7CgoJCQkJCS8vIFByZXBlbmQgaWYgcmVxdWVzdGVkCgkJCQkJaWYgKCBkYXRhVHlwZS5jaGFyQXQoIDAgKSA9PT0gIisiICkgewoJCQkJCQlkYXRhVHlwZSA9IGRhdGFUeXBlLnNsaWNlKCAxICkgfHwgIioiOwoJCQkJCQkoIHN0cnVjdHVyZVsgZGF0YVR5cGUgXSA9IHN0cnVjdHVyZVsgZGF0YVR5cGUgXSB8fCBbXSApLnVuc2hpZnQoIGZ1bmMgKTsKCgkJCQkJLy8gT3RoZXJ3aXNlIGFwcGVuZAoJCQkJCX0gZWxzZSB7CgkJCQkJCSggc3RydWN0dXJlWyBkYXRhVHlwZSBdID0gc3RydWN0dXJlWyBkYXRhVHlwZSBdIHx8IFtdICkucHVzaCggZnVuYyApOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX07Cgl9CgoJLy8gQmFzZSBpbnNwZWN0aW9uIGZ1bmN0aW9uIGZvciBwcmVmaWx0ZXJzIGFuZCB0cmFuc3BvcnRzCglmdW5jdGlvbiBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyggc3RydWN0dXJlLCBvcHRpb25zLCBvcmlnaW5hbE9wdGlvbnMsIGpxWEhSICkgewoKCQl2YXIgaW5zcGVjdGVkID0ge30sCgkJCXNlZWtpbmdUcmFuc3BvcnQgPSAoIHN0cnVjdHVyZSA9PT0gdHJhbnNwb3J0cyApOwoKCQlmdW5jdGlvbiBpbnNwZWN0KCBkYXRhVHlwZSApIHsKCQkJdmFyIHNlbGVjdGVkOwoJCQlpbnNwZWN0ZWRbIGRhdGFUeXBlIF0gPSB0cnVlOwoJCQlqUXVlcnkuZWFjaCggc3RydWN0dXJlWyBkYXRhVHlwZSBdIHx8IFtdLCBmdW5jdGlvbiggXywgcHJlZmlsdGVyT3JGYWN0b3J5ICkgewoJCQkJdmFyIGRhdGFUeXBlT3JUcmFuc3BvcnQgPSBwcmVmaWx0ZXJPckZhY3RvcnkoIG9wdGlvbnMsIG9yaWdpbmFsT3B0aW9ucywganFYSFIgKTsKCQkJCWlmICggdHlwZW9mIGRhdGFUeXBlT3JUcmFuc3BvcnQgPT09ICJzdHJpbmciICYmCgkJCQkJIXNlZWtpbmdUcmFuc3BvcnQgJiYgIWluc3BlY3RlZFsgZGF0YVR5cGVPclRyYW5zcG9ydCBdICkgewoKCQkJCQlvcHRpb25zLmRhdGFUeXBlcy51bnNoaWZ0KCBkYXRhVHlwZU9yVHJhbnNwb3J0ICk7CgkJCQkJaW5zcGVjdCggZGF0YVR5cGVPclRyYW5zcG9ydCApOwoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0gZWxzZSBpZiAoIHNlZWtpbmdUcmFuc3BvcnQgKSB7CgkJCQkJcmV0dXJuICEoIHNlbGVjdGVkID0gZGF0YVR5cGVPclRyYW5zcG9ydCApOwoJCQkJfQoJCQl9ICk7CgkJCXJldHVybiBzZWxlY3RlZDsKCQl9CgoJCXJldHVybiBpbnNwZWN0KCBvcHRpb25zLmRhdGFUeXBlc1sgMCBdICkgfHwgIWluc3BlY3RlZFsgIioiIF0gJiYgaW5zcGVjdCggIioiICk7Cgl9CgoJLy8gQSBzcGVjaWFsIGV4dGVuZCBmb3IgYWpheCBvcHRpb25zCgkvLyB0aGF0IHRha2VzICJmbGF0IiBvcHRpb25zIChub3QgdG8gYmUgZGVlcCBleHRlbmRlZCkKCS8vIEZpeGVzICM5ODg3CglmdW5jdGlvbiBhamF4RXh0ZW5kKCB0YXJnZXQsIHNyYyApIHsKCQl2YXIgZGVlcCwga2V5LAoJCQlmbGF0T3B0aW9ucyA9IGpRdWVyeS5hamF4U2V0dGluZ3MuZmxhdE9wdGlvbnMgfHwge307CgoJCWZvciAoIGtleSBpbiBzcmMgKSB7CgkJCWlmICggc3JjWyBrZXkgXSAhPT0gdW5kZWZpbmVkICkgewoJCQkJKCBmbGF0T3B0aW9uc1sga2V5IF0gPyB0YXJnZXQgOiAoIGRlZXAgfHwgKCBkZWVwID0ge30gKSApIClbIGtleSBdID0gc3JjWyBrZXkgXTsKCQkJfQoJCX0KCQlpZiAoIGRlZXAgKSB7CgkJCWpRdWVyeS5leHRlbmQoIHRydWUsIHRhcmdldCwgZGVlcCApOwoJCX0KCgkJcmV0dXJuIHRhcmdldDsKCX0KCgkvKiBIYW5kbGVzIHJlc3BvbnNlcyB0byBhbiBhamF4IHJlcXVlc3Q6CgkgKiAtIGZpbmRzIHRoZSByaWdodCBkYXRhVHlwZSAobWVkaWF0ZXMgYmV0d2VlbiBjb250ZW50LXR5cGUgYW5kIGV4cGVjdGVkIGRhdGFUeXBlKQoJICogLSByZXR1cm5zIHRoZSBjb3JyZXNwb25kaW5nIHJlc3BvbnNlCgkgKi8KCWZ1bmN0aW9uIGFqYXhIYW5kbGVSZXNwb25zZXMoIHMsIGpxWEhSLCByZXNwb25zZXMgKSB7CgkJdmFyIGZpcnN0RGF0YVR5cGUsIGN0LCBmaW5hbERhdGFUeXBlLCB0eXBlLAoJCQljb250ZW50cyA9IHMuY29udGVudHMsCgkJCWRhdGFUeXBlcyA9IHMuZGF0YVR5cGVzOwoKCQkvLyBSZW1vdmUgYXV0byBkYXRhVHlwZSBhbmQgZ2V0IGNvbnRlbnQtdHlwZSBpbiB0aGUgcHJvY2VzcwoJCXdoaWxlICggZGF0YVR5cGVzWyAwIF0gPT09ICIqIiApIHsKCQkJZGF0YVR5cGVzLnNoaWZ0KCk7CgkJCWlmICggY3QgPT09IHVuZGVmaW5lZCApIHsKCQkJCWN0ID0gcy5taW1lVHlwZSB8fCBqcVhIUi5nZXRSZXNwb25zZUhlYWRlciggIkNvbnRlbnQtVHlwZSIgKTsKCQkJfQoJCX0KCgkJLy8gQ2hlY2sgaWYgd2UncmUgZGVhbGluZyB3aXRoIGEga25vd24gY29udGVudC10eXBlCgkJaWYgKCBjdCApIHsKCQkJZm9yICggdHlwZSBpbiBjb250ZW50cyApIHsKCQkJCWlmICggY29udGVudHNbIHR5cGUgXSAmJiBjb250ZW50c1sgdHlwZSBdLnRlc3QoIGN0ICkgKSB7CgkJCQkJZGF0YVR5cGVzLnVuc2hpZnQoIHR5cGUgKTsKCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCX0KCgkJLy8gQ2hlY2sgdG8gc2VlIGlmIHdlIGhhdmUgYSByZXNwb25zZSBmb3IgdGhlIGV4cGVjdGVkIGRhdGFUeXBlCgkJaWYgKCBkYXRhVHlwZXNbIDAgXSBpbiByZXNwb25zZXMgKSB7CgkJCWZpbmFsRGF0YVR5cGUgPSBkYXRhVHlwZXNbIDAgXTsKCQl9IGVsc2UgewoKCQkJLy8gVHJ5IGNvbnZlcnRpYmxlIGRhdGFUeXBlcwoJCQlmb3IgKCB0eXBlIGluIHJlc3BvbnNlcyApIHsKCQkJCWlmICggIWRhdGFUeXBlc1sgMCBdIHx8IHMuY29udmVydGVyc1sgdHlwZSArICIgIiArIGRhdGFUeXBlc1sgMCBdIF0gKSB7CgkJCQkJZmluYWxEYXRhVHlwZSA9IHR5cGU7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQlpZiAoICFmaXJzdERhdGFUeXBlICkgewoJCQkJCWZpcnN0RGF0YVR5cGUgPSB0eXBlOwoJCQkJfQoJCQl9CgoJCQkvLyBPciBqdXN0IHVzZSBmaXJzdCBvbmUKCQkJZmluYWxEYXRhVHlwZSA9IGZpbmFsRGF0YVR5cGUgfHwgZmlyc3REYXRhVHlwZTsKCQl9CgoJCS8vIElmIHdlIGZvdW5kIGEgZGF0YVR5cGUKCQkvLyBXZSBhZGQgdGhlIGRhdGFUeXBlIHRvIHRoZSBsaXN0IGlmIG5lZWRlZAoJCS8vIGFuZCByZXR1cm4gdGhlIGNvcnJlc3BvbmRpbmcgcmVzcG9uc2UKCQlpZiAoIGZpbmFsRGF0YVR5cGUgKSB7CgkJCWlmICggZmluYWxEYXRhVHlwZSAhPT0gZGF0YVR5cGVzWyAwIF0gKSB7CgkJCQlkYXRhVHlwZXMudW5zaGlmdCggZmluYWxEYXRhVHlwZSApOwoJCQl9CgkJCXJldHVybiByZXNwb25zZXNbIGZpbmFsRGF0YVR5cGUgXTsKCQl9Cgl9CgoJLyogQ2hhaW4gY29udmVyc2lvbnMgZ2l2ZW4gdGhlIHJlcXVlc3QgYW5kIHRoZSBvcmlnaW5hbCByZXNwb25zZQoJICogQWxzbyBzZXRzIHRoZSByZXNwb25zZVhYWCBmaWVsZHMgb24gdGhlIGpxWEhSIGluc3RhbmNlCgkgKi8KCWZ1bmN0aW9uIGFqYXhDb252ZXJ0KCBzLCByZXNwb25zZSwganFYSFIsIGlzU3VjY2VzcyApIHsKCQl2YXIgY29udjIsIGN1cnJlbnQsIGNvbnYsIHRtcCwgcHJldiwKCQkJY29udmVydGVycyA9IHt9LAoKCQkJLy8gV29yayB3aXRoIGEgY29weSBvZiBkYXRhVHlwZXMgaW4gY2FzZSB3ZSBuZWVkIHRvIG1vZGlmeSBpdCBmb3IgY29udmVyc2lvbgoJCQlkYXRhVHlwZXMgPSBzLmRhdGFUeXBlcy5zbGljZSgpOwoKCQkvLyBDcmVhdGUgY29udmVydGVycyBtYXAgd2l0aCBsb3dlcmNhc2VkIGtleXMKCQlpZiAoIGRhdGFUeXBlc1sgMSBdICkgewoJCQlmb3IgKCBjb252IGluIHMuY29udmVydGVycyApIHsKCQkJCWNvbnZlcnRlcnNbIGNvbnYudG9Mb3dlckNhc2UoKSBdID0gcy5jb252ZXJ0ZXJzWyBjb252IF07CgkJCX0KCQl9CgoJCWN1cnJlbnQgPSBkYXRhVHlwZXMuc2hpZnQoKTsKCgkJLy8gQ29udmVydCB0byBlYWNoIHNlcXVlbnRpYWwgZGF0YVR5cGUKCQl3aGlsZSAoIGN1cnJlbnQgKSB7CgoJCQlpZiAoIHMucmVzcG9uc2VGaWVsZHNbIGN1cnJlbnQgXSApIHsKCQkJCWpxWEhSWyBzLnJlc3BvbnNlRmllbGRzWyBjdXJyZW50IF0gXSA9IHJlc3BvbnNlOwoJCQl9CgoJCQkvLyBBcHBseSB0aGUgZGF0YUZpbHRlciBpZiBwcm92aWRlZAoJCQlpZiAoICFwcmV2ICYmIGlzU3VjY2VzcyAmJiBzLmRhdGFGaWx0ZXIgKSB7CgkJCQlyZXNwb25zZSA9IHMuZGF0YUZpbHRlciggcmVzcG9uc2UsIHMuZGF0YVR5cGUgKTsKCQkJfQoKCQkJcHJldiA9IGN1cnJlbnQ7CgkJCWN1cnJlbnQgPSBkYXRhVHlwZXMuc2hpZnQoKTsKCgkJCWlmICggY3VycmVudCApIHsKCgkJCQkvLyBUaGVyZSdzIG9ubHkgd29yayB0byBkbyBpZiBjdXJyZW50IGRhdGFUeXBlIGlzIG5vbi1hdXRvCgkJCQlpZiAoIGN1cnJlbnQgPT09ICIqIiApIHsKCgkJCQkJY3VycmVudCA9IHByZXY7CgoJCQkJLy8gQ29udmVydCByZXNwb25zZSBpZiBwcmV2IGRhdGFUeXBlIGlzIG5vbi1hdXRvIGFuZCBkaWZmZXJzIGZyb20gY3VycmVudAoJCQkJfSBlbHNlIGlmICggcHJldiAhPT0gIioiICYmIHByZXYgIT09IGN1cnJlbnQgKSB7CgoJCQkJCS8vIFNlZWsgYSBkaXJlY3QgY29udmVydGVyCgkJCQkJY29udiA9IGNvbnZlcnRlcnNbIHByZXYgKyAiICIgKyBjdXJyZW50IF0gfHwgY29udmVydGVyc1sgIiogIiArIGN1cnJlbnQgXTsKCgkJCQkJLy8gSWYgbm9uZSBmb3VuZCwgc2VlayBhIHBhaXIKCQkJCQlpZiAoICFjb252ICkgewoJCQkJCQlmb3IgKCBjb252MiBpbiBjb252ZXJ0ZXJzICkgewoKCQkJCQkJCS8vIElmIGNvbnYyIG91dHB1dHMgY3VycmVudAoJCQkJCQkJdG1wID0gY29udjIuc3BsaXQoICIgIiApOwoJCQkJCQkJaWYgKCB0bXBbIDEgXSA9PT0gY3VycmVudCApIHsKCgkJCQkJCQkJLy8gSWYgcHJldiBjYW4gYmUgY29udmVydGVkIHRvIGFjY2VwdGVkIGlucHV0CgkJCQkJCQkJY29udiA9IGNvbnZlcnRlcnNbIHByZXYgKyAiICIgKyB0bXBbIDAgXSBdIHx8CgkJCQkJCQkJCWNvbnZlcnRlcnNbICIqICIgKyB0bXBbIDAgXSBdOwoJCQkJCQkJCWlmICggY29udiApIHsKCgkJCQkJCQkJCS8vIENvbmRlbnNlIGVxdWl2YWxlbmNlIGNvbnZlcnRlcnMKCQkJCQkJCQkJaWYgKCBjb252ID09PSB0cnVlICkgewoJCQkJCQkJCQkJY29udiA9IGNvbnZlcnRlcnNbIGNvbnYyIF07CgoJCQkJCQkJCQkvLyBPdGhlcndpc2UsIGluc2VydCB0aGUgaW50ZXJtZWRpYXRlIGRhdGFUeXBlCgkJCQkJCQkJCX0gZWxzZSBpZiAoIGNvbnZlcnRlcnNbIGNvbnYyIF0gIT09IHRydWUgKSB7CgkJCQkJCQkJCQljdXJyZW50ID0gdG1wWyAwIF07CgkJCQkJCQkJCQlkYXRhVHlwZXMudW5zaGlmdCggdG1wWyAxIF0gKTsKCQkJCQkJCQkJfQoJCQkJCQkJCQlicmVhazsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgoJCQkJCS8vIEFwcGx5IGNvbnZlcnRlciAoaWYgbm90IGFuIGVxdWl2YWxlbmNlKQoJCQkJCWlmICggY29udiAhPT0gdHJ1ZSApIHsKCgkJCQkJCS8vIFVubGVzcyBlcnJvcnMgYXJlIGFsbG93ZWQgdG8gYnViYmxlLCBjYXRjaCBhbmQgcmV0dXJuIHRoZW0KCQkJCQkJaWYgKCBjb252ICYmIHNbICJ0aHJvd3MiIF0gKSB7IC8vIGpzY3M6aWdub3JlIHJlcXVpcmVEb3ROb3RhdGlvbgoJCQkJCQkJcmVzcG9uc2UgPSBjb252KCByZXNwb25zZSApOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJdHJ5IHsKCQkJCQkJCQlyZXNwb25zZSA9IGNvbnYoIHJlc3BvbnNlICk7CgkJCQkJCQl9IGNhdGNoICggZSApIHsKCQkJCQkJCQlyZXR1cm4gewoJCQkJCQkJCQlzdGF0ZTogInBhcnNlcmVycm9yIiwKCQkJCQkJCQkJZXJyb3I6IGNvbnYgPyBlIDogIk5vIGNvbnZlcnNpb24gZnJvbSAiICsgcHJldiArICIgdG8gIiArIGN1cnJlbnQKCQkJCQkJCQl9OwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoKCQlyZXR1cm4geyBzdGF0ZTogInN1Y2Nlc3MiLCBkYXRhOiByZXNwb25zZSB9OwoJfQoKCWpRdWVyeS5leHRlbmQoIHsKCgkJLy8gQ291bnRlciBmb3IgaG9sZGluZyB0aGUgbnVtYmVyIG9mIGFjdGl2ZSBxdWVyaWVzCgkJYWN0aXZlOiAwLAoKCQkvLyBMYXN0LU1vZGlmaWVkIGhlYWRlciBjYWNoZSBmb3IgbmV4dCByZXF1ZXN0CgkJbGFzdE1vZGlmaWVkOiB7fSwKCQlldGFnOiB7fSwKCgkJYWpheFNldHRpbmdzOiB7CgkJCXVybDogYWpheExvY2F0aW9uLAoJCQl0eXBlOiAiR0VUIiwKCQkJaXNMb2NhbDogcmxvY2FsUHJvdG9jb2wudGVzdCggYWpheExvY1BhcnRzWyAxIF0gKSwKCQkJZ2xvYmFsOiB0cnVlLAoJCQlwcm9jZXNzRGF0YTogdHJ1ZSwKCQkJYXN5bmM6IHRydWUsCgkJCWNvbnRlbnRUeXBlOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IiwKCQkJLyoKCQkJdGltZW91dDogMCwKCQkJZGF0YTogbnVsbCwKCQkJZGF0YVR5cGU6IG51bGwsCgkJCXVzZXJuYW1lOiBudWxsLAoJCQlwYXNzd29yZDogbnVsbCwKCQkJY2FjaGU6IG51bGwsCgkJCXRocm93czogZmFsc2UsCgkJCXRyYWRpdGlvbmFsOiBmYWxzZSwKCQkJaGVhZGVyczoge30sCgkJCSovCgoJCQlhY2NlcHRzOiB7CgkJCQkiKiI6IGFsbFR5cGVzLAoJCQkJdGV4dDogInRleHQvcGxhaW4iLAoJCQkJaHRtbDogInRleHQvaHRtbCIsCgkJCQl4bWw6ICJhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sIiwKCQkJCWpzb246ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQiCgkJCX0sCgoJCQljb250ZW50czogewoJCQkJeG1sOiAvXGJ4bWxcYi8sCgkJCQlodG1sOiAvXGJodG1sLywKCQkJCWpzb246IC9cYmpzb25cYi8KCQkJfSwKCgkJCXJlc3BvbnNlRmllbGRzOiB7CgkJCQl4bWw6ICJyZXNwb25zZVhNTCIsCgkJCQl0ZXh0OiAicmVzcG9uc2VUZXh0IiwKCQkJCWpzb246ICJyZXNwb25zZUpTT04iCgkJCX0sCgoJCQkvLyBEYXRhIGNvbnZlcnRlcnMKCQkJLy8gS2V5cyBzZXBhcmF0ZSBzb3VyY2UgKG9yIGNhdGNoYWxsICIqIikgYW5kIGRlc3RpbmF0aW9uIHR5cGVzIHdpdGggYSBzaW5nbGUgc3BhY2UKCQkJY29udmVydGVyczogewoKCQkJCS8vIENvbnZlcnQgYW55dGhpbmcgdG8gdGV4dAoJCQkJIiogdGV4dCI6IFN0cmluZywKCgkJCQkvLyBUZXh0IHRvIGh0bWwgKHRydWUgPSBubyB0cmFuc2Zvcm1hdGlvbikKCQkJCSJ0ZXh0IGh0bWwiOiB0cnVlLAoKCQkJCS8vIEV2YWx1YXRlIHRleHQgYXMgYSBqc29uIGV4cHJlc3Npb24KCQkJCSJ0ZXh0IGpzb24iOiBqUXVlcnkucGFyc2VKU09OLAoKCQkJCS8vIFBhcnNlIHRleHQgYXMgeG1sCgkJCQkidGV4dCB4bWwiOiBqUXVlcnkucGFyc2VYTUwKCQkJfSwKCgkJCS8vIEZvciBvcHRpb25zIHRoYXQgc2hvdWxkbid0IGJlIGRlZXAgZXh0ZW5kZWQ6CgkJCS8vIHlvdSBjYW4gYWRkIHlvdXIgb3duIGN1c3RvbSBvcHRpb25zIGhlcmUgaWYKCQkJLy8gYW5kIHdoZW4geW91IGNyZWF0ZSBvbmUgdGhhdCBzaG91bGRuJ3QgYmUKCQkJLy8gZGVlcCBleHRlbmRlZCAoc2VlIGFqYXhFeHRlbmQpCgkJCWZsYXRPcHRpb25zOiB7CgkJCQl1cmw6IHRydWUsCgkJCQljb250ZXh0OiB0cnVlCgkJCX0KCQl9LAoKCQkvLyBDcmVhdGVzIGEgZnVsbCBmbGVkZ2VkIHNldHRpbmdzIG9iamVjdCBpbnRvIHRhcmdldAoJCS8vIHdpdGggYm90aCBhamF4U2V0dGluZ3MgYW5kIHNldHRpbmdzIGZpZWxkcy4KCQkvLyBJZiB0YXJnZXQgaXMgb21pdHRlZCwgd3JpdGVzIGludG8gYWpheFNldHRpbmdzLgoJCWFqYXhTZXR1cDogZnVuY3Rpb24oIHRhcmdldCwgc2V0dGluZ3MgKSB7CgkJCXJldHVybiBzZXR0aW5ncyA/CgoJCQkJLy8gQnVpbGRpbmcgYSBzZXR0aW5ncyBvYmplY3QKCQkJCWFqYXhFeHRlbmQoIGFqYXhFeHRlbmQoIHRhcmdldCwgalF1ZXJ5LmFqYXhTZXR0aW5ncyApLCBzZXR0aW5ncyApIDoKCgkJCQkvLyBFeHRlbmRpbmcgYWpheFNldHRpbmdzCgkJCQlhamF4RXh0ZW5kKCBqUXVlcnkuYWpheFNldHRpbmdzLCB0YXJnZXQgKTsKCQl9LAoKCQlhamF4UHJlZmlsdGVyOiBhZGRUb1ByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHByZWZpbHRlcnMgKSwKCQlhamF4VHJhbnNwb3J0OiBhZGRUb1ByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHRyYW5zcG9ydHMgKSwKCgkJLy8gTWFpbiBtZXRob2QKCQlhamF4OiBmdW5jdGlvbiggdXJsLCBvcHRpb25zICkgewoKCQkJLy8gSWYgdXJsIGlzIGFuIG9iamVjdCwgc2ltdWxhdGUgcHJlLTEuNSBzaWduYXR1cmUKCQkJaWYgKCB0eXBlb2YgdXJsID09PSAib2JqZWN0IiApIHsKCQkJCW9wdGlvbnMgPSB1cmw7CgkJCQl1cmwgPSB1bmRlZmluZWQ7CgkJCX0KCgkJCS8vIEZvcmNlIG9wdGlvbnMgdG8gYmUgYW4gb2JqZWN0CgkJCW9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKCQkJdmFyCgoJCQkJLy8gQ3Jvc3MtZG9tYWluIGRldGVjdGlvbiB2YXJzCgkJCQlwYXJ0cywKCgkJCQkvLyBMb29wIHZhcmlhYmxlCgkJCQlpLAoKCQkJCS8vIFVSTCB3aXRob3V0IGFudGktY2FjaGUgcGFyYW0KCQkJCWNhY2hlVVJMLAoKCQkJCS8vIFJlc3BvbnNlIGhlYWRlcnMgYXMgc3RyaW5nCgkJCQlyZXNwb25zZUhlYWRlcnNTdHJpbmcsCgoJCQkJLy8gdGltZW91dCBoYW5kbGUKCQkJCXRpbWVvdXRUaW1lciwKCgkJCQkvLyBUbyBrbm93IGlmIGdsb2JhbCBldmVudHMgYXJlIHRvIGJlIGRpc3BhdGNoZWQKCQkJCWZpcmVHbG9iYWxzLAoKCQkJCXRyYW5zcG9ydCwKCgkJCQkvLyBSZXNwb25zZSBoZWFkZXJzCgkJCQlyZXNwb25zZUhlYWRlcnMsCgoJCQkJLy8gQ3JlYXRlIHRoZSBmaW5hbCBvcHRpb25zIG9iamVjdAoJCQkJcyA9IGpRdWVyeS5hamF4U2V0dXAoIHt9LCBvcHRpb25zICksCgoJCQkJLy8gQ2FsbGJhY2tzIGNvbnRleHQKCQkJCWNhbGxiYWNrQ29udGV4dCA9IHMuY29udGV4dCB8fCBzLAoKCQkJCS8vIENvbnRleHQgZm9yIGdsb2JhbCBldmVudHMgaXMgY2FsbGJhY2tDb250ZXh0IGlmIGl0IGlzIGEgRE9NIG5vZGUgb3IgalF1ZXJ5IGNvbGxlY3Rpb24KCQkJCWdsb2JhbEV2ZW50Q29udGV4dCA9IHMuY29udGV4dCAmJgoJCQkJCSggY2FsbGJhY2tDb250ZXh0Lm5vZGVUeXBlIHx8IGNhbGxiYWNrQ29udGV4dC5qcXVlcnkgKSA/CgkJCQkJCWpRdWVyeSggY2FsbGJhY2tDb250ZXh0ICkgOgoJCQkJCQlqUXVlcnkuZXZlbnQsCgoJCQkJLy8gRGVmZXJyZWRzCgkJCQlkZWZlcnJlZCA9IGpRdWVyeS5EZWZlcnJlZCgpLAoJCQkJY29tcGxldGVEZWZlcnJlZCA9IGpRdWVyeS5DYWxsYmFja3MoICJvbmNlIG1lbW9yeSIgKSwKCgkJCQkvLyBTdGF0dXMtZGVwZW5kZW50IGNhbGxiYWNrcwoJCQkJc3RhdHVzQ29kZSA9IHMuc3RhdHVzQ29kZSB8fCB7fSwKCgkJCQkvLyBIZWFkZXJzICh0aGV5IGFyZSBzZW50IGFsbCBhdCBvbmNlKQoJCQkJcmVxdWVzdEhlYWRlcnMgPSB7fSwKCQkJCXJlcXVlc3RIZWFkZXJzTmFtZXMgPSB7fSwKCgkJCQkvLyBUaGUganFYSFIgc3RhdGUKCQkJCXN0YXRlID0gMCwKCgkJCQkvLyBEZWZhdWx0IGFib3J0IG1lc3NhZ2UKCQkJCXN0ckFib3J0ID0gImNhbmNlbGVkIiwKCgkJCQkvLyBGYWtlIHhocgoJCQkJanFYSFIgPSB7CgkJCQkJcmVhZHlTdGF0ZTogMCwKCgkJCQkJLy8gQnVpbGRzIGhlYWRlcnMgaGFzaHRhYmxlIGlmIG5lZWRlZAoJCQkJCWdldFJlc3BvbnNlSGVhZGVyOiBmdW5jdGlvbigga2V5ICkgewoJCQkJCQl2YXIgbWF0Y2g7CgkJCQkJCWlmICggc3RhdGUgPT09IDIgKSB7CgkJCQkJCQlpZiAoICFyZXNwb25zZUhlYWRlcnMgKSB7CgkJCQkJCQkJcmVzcG9uc2VIZWFkZXJzID0ge307CgkJCQkJCQkJd2hpbGUgKCAoIG1hdGNoID0gcmhlYWRlcnMuZXhlYyggcmVzcG9uc2VIZWFkZXJzU3RyaW5nICkgKSApIHsKCQkJCQkJCQkJcmVzcG9uc2VIZWFkZXJzWyBtYXRjaFsgMSBdLnRvTG93ZXJDYXNlKCkgXSA9IG1hdGNoWyAyIF07CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQkJbWF0Y2ggPSByZXNwb25zZUhlYWRlcnNbIGtleS50b0xvd2VyQ2FzZSgpIF07CgkJCQkJCX0KCQkJCQkJcmV0dXJuIG1hdGNoID09IG51bGwgPyBudWxsIDogbWF0Y2g7CgkJCQkJfSwKCgkJCQkJLy8gUmF3IHN0cmluZwoJCQkJCWdldEFsbFJlc3BvbnNlSGVhZGVyczogZnVuY3Rpb24oKSB7CgkJCQkJCXJldHVybiBzdGF0ZSA9PT0gMiA/IHJlc3BvbnNlSGVhZGVyc1N0cmluZyA6IG51bGw7CgkJCQkJfSwKCgkJCQkJLy8gQ2FjaGVzIHRoZSBoZWFkZXIKCQkJCQlzZXRSZXF1ZXN0SGVhZGVyOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7CgkJCQkJCXZhciBsbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKCQkJCQkJaWYgKCAhc3RhdGUgKSB7CgkJCQkJCQluYW1lID0gcmVxdWVzdEhlYWRlcnNOYW1lc1sgbG5hbWUgXSA9IHJlcXVlc3RIZWFkZXJzTmFtZXNbIGxuYW1lIF0gfHwgbmFtZTsKCQkJCQkJCXJlcXVlc3RIZWFkZXJzWyBuYW1lIF0gPSB2YWx1ZTsKCQkJCQkJfQoJCQkJCQlyZXR1cm4gdGhpczsKCQkJCQl9LAoKCQkJCQkvLyBPdmVycmlkZXMgcmVzcG9uc2UgY29udGVudC10eXBlIGhlYWRlcgoJCQkJCW92ZXJyaWRlTWltZVR5cGU6IGZ1bmN0aW9uKCB0eXBlICkgewoJCQkJCQlpZiAoICFzdGF0ZSApIHsKCQkJCQkJCXMubWltZVR5cGUgPSB0eXBlOwoJCQkJCQl9CgkJCQkJCXJldHVybiB0aGlzOwoJCQkJCX0sCgoJCQkJCS8vIFN0YXR1cy1kZXBlbmRlbnQgY2FsbGJhY2tzCgkJCQkJc3RhdHVzQ29kZTogZnVuY3Rpb24oIG1hcCApIHsKCQkJCQkJdmFyIGNvZGU7CgkJCQkJCWlmICggbWFwICkgewoJCQkJCQkJaWYgKCBzdGF0ZSA8IDIgKSB7CgkJCQkJCQkJZm9yICggY29kZSBpbiBtYXAgKSB7CgoJCQkJCQkJCQkvLyBMYXp5LWFkZCB0aGUgbmV3IGNhbGxiYWNrIGluIGEgd2F5IHRoYXQgcHJlc2VydmVzIG9sZCBvbmVzCgkJCQkJCQkJCXN0YXR1c0NvZGVbIGNvZGUgXSA9IFsgc3RhdHVzQ29kZVsgY29kZSBdLCBtYXBbIGNvZGUgXSBdOwoJCQkJCQkJCX0KCQkJCQkJCX0gZWxzZSB7CgoJCQkJCQkJCS8vIEV4ZWN1dGUgdGhlIGFwcHJvcHJpYXRlIGNhbGxiYWNrcwoJCQkJCQkJCWpxWEhSLmFsd2F5cyggbWFwWyBqcVhIUi5zdGF0dXMgXSApOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCXJldHVybiB0aGlzOwoJCQkJCX0sCgoJCQkJCS8vIENhbmNlbCB0aGUgcmVxdWVzdAoJCQkJCWFib3J0OiBmdW5jdGlvbiggc3RhdHVzVGV4dCApIHsKCQkJCQkJdmFyIGZpbmFsVGV4dCA9IHN0YXR1c1RleHQgfHwgc3RyQWJvcnQ7CgkJCQkJCWlmICggdHJhbnNwb3J0ICkgewoJCQkJCQkJdHJhbnNwb3J0LmFib3J0KCBmaW5hbFRleHQgKTsKCQkJCQkJfQoJCQkJCQlkb25lKCAwLCBmaW5hbFRleHQgKTsKCQkJCQkJcmV0dXJuIHRoaXM7CgkJCQkJfQoJCQkJfTsKCgkJCS8vIEF0dGFjaCBkZWZlcnJlZHMKCQkJZGVmZXJyZWQucHJvbWlzZSgganFYSFIgKS5jb21wbGV0ZSA9IGNvbXBsZXRlRGVmZXJyZWQuYWRkOwoJCQlqcVhIUi5zdWNjZXNzID0ganFYSFIuZG9uZTsKCQkJanFYSFIuZXJyb3IgPSBqcVhIUi5mYWlsOwoKCQkJLy8gUmVtb3ZlIGhhc2ggY2hhcmFjdGVyICgjNzUzMTogYW5kIHN0cmluZyBwcm9tb3Rpb24pCgkJCS8vIEFkZCBwcm90b2NvbCBpZiBub3QgcHJvdmlkZWQgKCM1ODY2OiBJRTcgaXNzdWUgd2l0aCBwcm90b2NvbC1sZXNzIHVybHMpCgkJCS8vIEhhbmRsZSBmYWxzeSB1cmwgaW4gdGhlIHNldHRpbmdzIG9iamVjdCAoIzEwMDkzOiBjb25zaXN0ZW5jeSB3aXRoIG9sZCBzaWduYXR1cmUpCgkJCS8vIFdlIGFsc28gdXNlIHRoZSB1cmwgcGFyYW1ldGVyIGlmIGF2YWlsYWJsZQoJCQlzLnVybCA9ICggKCB1cmwgfHwgcy51cmwgfHwgYWpheExvY2F0aW9uICkgKyAiIiApCgkJCQkucmVwbGFjZSggcmhhc2gsICIiICkKCQkJCS5yZXBsYWNlKCBycHJvdG9jb2wsIGFqYXhMb2NQYXJ0c1sgMSBdICsgIi8vIiApOwoKCQkJLy8gQWxpYXMgbWV0aG9kIG9wdGlvbiB0byB0eXBlIGFzIHBlciB0aWNrZXQgIzEyMDA0CgkJCXMudHlwZSA9IG9wdGlvbnMubWV0aG9kIHx8IG9wdGlvbnMudHlwZSB8fCBzLm1ldGhvZCB8fCBzLnR5cGU7CgoJCQkvLyBFeHRyYWN0IGRhdGFUeXBlcyBsaXN0CgkJCXMuZGF0YVR5cGVzID0galF1ZXJ5LnRyaW0oIHMuZGF0YVR5cGUgfHwgIioiICkudG9Mb3dlckNhc2UoKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgWyAiIiBdOwoKCQkJLy8gQSBjcm9zcy1kb21haW4gcmVxdWVzdCBpcyBpbiBvcmRlciB3aGVuIHdlIGhhdmUgYSBwcm90b2NvbDpob3N0OnBvcnQgbWlzbWF0Y2gKCQkJaWYgKCBzLmNyb3NzRG9tYWluID09IG51bGwgKSB7CgkJCQlwYXJ0cyA9IHJ1cmwuZXhlYyggcy51cmwudG9Mb3dlckNhc2UoKSApOwoJCQkJcy5jcm9zc0RvbWFpbiA9ICEhKCBwYXJ0cyAmJgoJCQkJCSggcGFydHNbIDEgXSAhPT0gYWpheExvY1BhcnRzWyAxIF0gfHwgcGFydHNbIDIgXSAhPT0gYWpheExvY1BhcnRzWyAyIF0gfHwKCQkJCQkJKCBwYXJ0c1sgMyBdIHx8ICggcGFydHNbIDEgXSA9PT0gImh0dHA6IiA/ICI4MCIgOiAiNDQzIiApICkgIT09CgkJCQkJCQkoIGFqYXhMb2NQYXJ0c1sgMyBdIHx8ICggYWpheExvY1BhcnRzWyAxIF0gPT09ICJodHRwOiIgPyAiODAiIDogIjQ0MyIgKSApICkKCQkJCSk7CgkJCX0KCgkJCS8vIENvbnZlcnQgZGF0YSBpZiBub3QgYWxyZWFkeSBhIHN0cmluZwoJCQlpZiAoIHMuZGF0YSAmJiBzLnByb2Nlc3NEYXRhICYmIHR5cGVvZiBzLmRhdGEgIT09ICJzdHJpbmciICkgewoJCQkJcy5kYXRhID0galF1ZXJ5LnBhcmFtKCBzLmRhdGEsIHMudHJhZGl0aW9uYWwgKTsKCQkJfQoKCQkJLy8gQXBwbHkgcHJlZmlsdGVycwoJCQlpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyggcHJlZmlsdGVycywgcywgb3B0aW9ucywganFYSFIgKTsKCgkJCS8vIElmIHJlcXVlc3Qgd2FzIGFib3J0ZWQgaW5zaWRlIGEgcHJlZmlsdGVyLCBzdG9wIHRoZXJlCgkJCWlmICggc3RhdGUgPT09IDIgKSB7CgkJCQlyZXR1cm4ganFYSFI7CgkJCX0KCgkJCS8vIFdlIGNhbiBmaXJlIGdsb2JhbCBldmVudHMgYXMgb2Ygbm93IGlmIGFza2VkIHRvCgkJCS8vIERvbid0IGZpcmUgZXZlbnRzIGlmIGpRdWVyeS5ldmVudCBpcyB1bmRlZmluZWQgaW4gYW4gQU1ELXVzYWdlIHNjZW5hcmlvICgjMTUxMTgpCgkJCWZpcmVHbG9iYWxzID0galF1ZXJ5LmV2ZW50ICYmIHMuZ2xvYmFsOwoKCQkJLy8gV2F0Y2ggZm9yIGEgbmV3IHNldCBvZiByZXF1ZXN0cwoJCQlpZiAoIGZpcmVHbG9iYWxzICYmIGpRdWVyeS5hY3RpdmUrKyA9PT0gMCApIHsKCQkJCWpRdWVyeS5ldmVudC50cmlnZ2VyKCAiYWpheFN0YXJ0IiApOwoJCQl9CgoJCQkvLyBVcHBlcmNhc2UgdGhlIHR5cGUKCQkJcy50eXBlID0gcy50eXBlLnRvVXBwZXJDYXNlKCk7CgoJCQkvLyBEZXRlcm1pbmUgaWYgcmVxdWVzdCBoYXMgY29udGVudAoJCQlzLmhhc0NvbnRlbnQgPSAhcm5vQ29udGVudC50ZXN0KCBzLnR5cGUgKTsKCgkJCS8vIFNhdmUgdGhlIFVSTCBpbiBjYXNlIHdlJ3JlIHRveWluZyB3aXRoIHRoZSBJZi1Nb2RpZmllZC1TaW5jZQoJCQkvLyBhbmQvb3IgSWYtTm9uZQ==", "base64"));
  res.write(new Buffer("LU1hdGNoIGhlYWRlciBsYXRlciBvbgoJCQljYWNoZVVSTCA9IHMudXJsOwoKCQkJLy8gTW9yZSBvcHRpb25zIGhhbmRsaW5nIGZvciByZXF1ZXN0cyB3aXRoIG5vIGNvbnRlbnQKCQkJaWYgKCAhcy5oYXNDb250ZW50ICkgewoKCQkJCS8vIElmIGRhdGEgaXMgYXZhaWxhYmxlLCBhcHBlbmQgZGF0YSB0byB1cmwKCQkJCWlmICggcy5kYXRhICkgewoJCQkJCWNhY2hlVVJMID0gKCBzLnVybCArPSAoIHJxdWVyeS50ZXN0KCBjYWNoZVVSTCApID8gIiYiIDogIj8iICkgKyBzLmRhdGEgKTsKCgkJCQkJLy8gIzk2ODI6IHJlbW92ZSBkYXRhIHNvIHRoYXQgaXQncyBub3QgdXNlZCBpbiBhbiBldmVudHVhbCByZXRyeQoJCQkJCWRlbGV0ZSBzLmRhdGE7CgkJCQl9CgoJCQkJLy8gQWRkIGFudGktY2FjaGUgaW4gdXJsIGlmIG5lZWRlZAoJCQkJaWYgKCBzLmNhY2hlID09PSBmYWxzZSApIHsKCQkJCQlzLnVybCA9IHJ0cy50ZXN0KCBjYWNoZVVSTCApID8KCgkJCQkJCS8vIElmIHRoZXJlIGlzIGFscmVhZHkgYSAnXycgcGFyYW1ldGVyLCBzZXQgaXRzIHZhbHVlCgkJCQkJCWNhY2hlVVJMLnJlcGxhY2UoIHJ0cywgIiQxXz0iICsgbm9uY2UrKyApIDoKCgkJCQkJCS8vIE90aGVyd2lzZSBhZGQgb25lIHRvIHRoZSBlbmQKCQkJCQkJY2FjaGVVUkwgKyAoIHJxdWVyeS50ZXN0KCBjYWNoZVVSTCApID8gIiYiIDogIj8iICkgKyAiXz0iICsgbm9uY2UrKzsKCQkJCX0KCQkJfQoKCQkJLy8gU2V0IHRoZSBJZi1Nb2RpZmllZC1TaW5jZSBhbmQvb3IgSWYtTm9uZS1NYXRjaCBoZWFkZXIsIGlmIGluIGlmTW9kaWZpZWQgbW9kZS4KCQkJaWYgKCBzLmlmTW9kaWZpZWQgKSB7CgkJCQlpZiAoIGpRdWVyeS5sYXN0TW9kaWZpZWRbIGNhY2hlVVJMIF0gKSB7CgkJCQkJanFYSFIuc2V0UmVxdWVzdEhlYWRlciggIklmLU1vZGlmaWVkLVNpbmNlIiwgalF1ZXJ5Lmxhc3RNb2RpZmllZFsgY2FjaGVVUkwgXSApOwoJCQkJfQoJCQkJaWYgKCBqUXVlcnkuZXRhZ1sgY2FjaGVVUkwgXSApIHsKCQkJCQlqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCAiSWYtTm9uZS1NYXRjaCIsIGpRdWVyeS5ldGFnWyBjYWNoZVVSTCBdICk7CgkJCQl9CgkJCX0KCgkJCS8vIFNldCB0aGUgY29ycmVjdCBoZWFkZXIsIGlmIGRhdGEgaXMgYmVpbmcgc2VudAoJCQlpZiAoIHMuZGF0YSAmJiBzLmhhc0NvbnRlbnQgJiYgcy5jb250ZW50VHlwZSAhPT0gZmFsc2UgfHwgb3B0aW9ucy5jb250ZW50VHlwZSApIHsKCQkJCWpxWEhSLnNldFJlcXVlc3RIZWFkZXIoICJDb250ZW50LVR5cGUiLCBzLmNvbnRlbnRUeXBlICk7CgkJCX0KCgkJCS8vIFNldCB0aGUgQWNjZXB0cyBoZWFkZXIgZm9yIHRoZSBzZXJ2ZXIsIGRlcGVuZGluZyBvbiB0aGUgZGF0YVR5cGUKCQkJanFYSFIuc2V0UmVxdWVzdEhlYWRlcigKCQkJCSJBY2NlcHQiLAoJCQkJcy5kYXRhVHlwZXNbIDAgXSAmJiBzLmFjY2VwdHNbIHMuZGF0YVR5cGVzWyAwIF0gXSA/CgkJCQkJcy5hY2NlcHRzWyBzLmRhdGFUeXBlc1sgMCBdIF0gKwoJCQkJCQkoIHMuZGF0YVR5cGVzWyAwIF0gIT09ICIqIiA/ICIsICIgKyBhbGxUeXBlcyArICI7IHE9MC4wMSIgOiAiIiApIDoKCQkJCQlzLmFjY2VwdHNbICIqIiBdCgkJCSk7CgoJCQkvLyBDaGVjayBmb3IgaGVhZGVycyBvcHRpb24KCQkJZm9yICggaSBpbiBzLmhlYWRlcnMgKSB7CgkJCQlqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCBpLCBzLmhlYWRlcnNbIGkgXSApOwoJCQl9CgoJCQkvLyBBbGxvdyBjdXN0b20gaGVhZGVycy9taW1ldHlwZXMgYW5kIGVhcmx5IGFib3J0CgkJCWlmICggcy5iZWZvcmVTZW5kICYmCgkJCQkoIHMuYmVmb3JlU2VuZC5jYWxsKCBjYWxsYmFja0NvbnRleHQsIGpxWEhSLCBzICkgPT09IGZhbHNlIHx8IHN0YXRlID09PSAyICkgKSB7CgoJCQkJLy8gQWJvcnQgaWYgbm90IGRvbmUgYWxyZWFkeSBhbmQgcmV0dXJuCgkJCQlyZXR1cm4ganFYSFIuYWJvcnQoKTsKCQkJfQoKCQkJLy8gYWJvcnRpbmcgaXMgbm8gbG9uZ2VyIGEgY2FuY2VsbGF0aW9uCgkJCXN0ckFib3J0ID0gImFib3J0IjsKCgkJCS8vIEluc3RhbGwgY2FsbGJhY2tzIG9uIGRlZmVycmVkcwoJCQlmb3IgKCBpIGluIHsgc3VjY2VzczogMSwgZXJyb3I6IDEsIGNvbXBsZXRlOiAxIH0gKSB7CgkJCQlqcVhIUlsgaSBdKCBzWyBpIF0gKTsKCQkJfQoKCQkJLy8gR2V0IHRyYW5zcG9ydAoJCQl0cmFuc3BvcnQgPSBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyggdHJhbnNwb3J0cywgcywgb3B0aW9ucywganFYSFIgKTsKCgkJCS8vIElmIG5vIHRyYW5zcG9ydCwgd2UgYXV0by1hYm9ydAoJCQlpZiAoICF0cmFuc3BvcnQgKSB7CgkJCQlkb25lKCAtMSwgIk5vIFRyYW5zcG9ydCIgKTsKCQkJfSBlbHNlIHsKCQkJCWpxWEhSLnJlYWR5U3RhdGUgPSAxOwoKCQkJCS8vIFNlbmQgZ2xvYmFsIGV2ZW50CgkJCQlpZiAoIGZpcmVHbG9iYWxzICkgewoJCQkJCWdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCAiYWpheFNlbmQiLCBbIGpxWEhSLCBzIF0gKTsKCQkJCX0KCgkJCQkvLyBJZiByZXF1ZXN0IHdhcyBhYm9ydGVkIGluc2lkZSBhamF4U2VuZCwgc3RvcCB0aGVyZQoJCQkJaWYgKCBzdGF0ZSA9PT0gMiApIHsKCQkJCQlyZXR1cm4ganFYSFI7CgkJCQl9CgoJCQkJLy8gVGltZW91dAoJCQkJaWYgKCBzLmFzeW5jICYmIHMudGltZW91dCA+IDAgKSB7CgkJCQkJdGltZW91dFRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgewoJCQkJCQlqcVhIUi5hYm9ydCggInRpbWVvdXQiICk7CgkJCQkJfSwgcy50aW1lb3V0ICk7CgkJCQl9CgoJCQkJdHJ5IHsKCQkJCQlzdGF0ZSA9IDE7CgkJCQkJdHJhbnNwb3J0LnNlbmQoIHJlcXVlc3RIZWFkZXJzLCBkb25lICk7CgkJCQl9IGNhdGNoICggZSApIHsKCgkJCQkJLy8gUHJvcGFnYXRlIGV4Y2VwdGlvbiBhcyBlcnJvciBpZiBub3QgZG9uZQoJCQkJCWlmICggc3RhdGUgPCAyICkgewoJCQkJCQlkb25lKCAtMSwgZSApOwoKCQkJCQkvLyBTaW1wbHkgcmV0aHJvdyBvdGhlcndpc2UKCQkJCQl9IGVsc2UgewoJCQkJCQl0aHJvdyBlOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJLy8gQ2FsbGJhY2sgZm9yIHdoZW4gZXZlcnl0aGluZyBpcyBkb25lCgkJCWZ1bmN0aW9uIGRvbmUoIHN0YXR1cywgbmF0aXZlU3RhdHVzVGV4dCwgcmVzcG9uc2VzLCBoZWFkZXJzICkgewoJCQkJdmFyIGlzU3VjY2Vzcywgc3VjY2VzcywgZXJyb3IsIHJlc3BvbnNlLCBtb2RpZmllZCwKCQkJCQlzdGF0dXNUZXh0ID0gbmF0aXZlU3RhdHVzVGV4dDsKCgkJCQkvLyBDYWxsZWQgb25jZQoJCQkJaWYgKCBzdGF0ZSA9PT0gMiApIHsKCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJLy8gU3RhdGUgaXMgImRvbmUiIG5vdwoJCQkJc3RhdGUgPSAyOwoKCQkJCS8vIENsZWFyIHRpbWVvdXQgaWYgaXQgZXhpc3RzCgkJCQlpZiAoIHRpbWVvdXRUaW1lciApIHsKCQkJCQl3aW5kb3cuY2xlYXJUaW1lb3V0KCB0aW1lb3V0VGltZXIgKTsKCQkJCX0KCgkJCQkvLyBEZXJlZmVyZW5jZSB0cmFuc3BvcnQgZm9yIGVhcmx5IGdhcmJhZ2UgY29sbGVjdGlvbgoJCQkJLy8gKG5vIG1hdHRlciBob3cgbG9uZyB0aGUganFYSFIgb2JqZWN0IHdpbGwgYmUgdXNlZCkKCQkJCXRyYW5zcG9ydCA9IHVuZGVmaW5lZDsKCgkJCQkvLyBDYWNoZSByZXNwb25zZSBoZWFkZXJzCgkJCQlyZXNwb25zZUhlYWRlcnNTdHJpbmcgPSBoZWFkZXJzIHx8ICIiOwoKCQkJCS8vIFNldCByZWFkeVN0YXRlCgkJCQlqcVhIUi5yZWFkeVN0YXRlID0gc3RhdHVzID4gMCA/IDQgOiAwOwoKCQkJCS8vIERldGVybWluZSBpZiBzdWNjZXNzZnVsCgkJCQlpc1N1Y2Nlc3MgPSBzdGF0dXMgPj0gMjAwICYmIHN0YXR1cyA8IDMwMCB8fCBzdGF0dXMgPT09IDMwNDsKCgkJCQkvLyBHZXQgcmVzcG9uc2UgZGF0YQoJCQkJaWYgKCByZXNwb25zZXMgKSB7CgkJCQkJcmVzcG9uc2UgPSBhamF4SGFuZGxlUmVzcG9uc2VzKCBzLCBqcVhIUiwgcmVzcG9uc2VzICk7CgkJCQl9CgoJCQkJLy8gQ29udmVydCBubyBtYXR0ZXIgd2hhdCAodGhhdCB3YXkgcmVzcG9uc2VYWFggZmllbGRzIGFyZSBhbHdheXMgc2V0KQoJCQkJcmVzcG9uc2UgPSBhamF4Q29udmVydCggcywgcmVzcG9uc2UsIGpxWEhSLCBpc1N1Y2Nlc3MgKTsKCgkJCQkvLyBJZiBzdWNjZXNzZnVsLCBoYW5kbGUgdHlwZSBjaGFpbmluZwoJCQkJaWYgKCBpc1N1Y2Nlc3MgKSB7CgoJCQkJCS8vIFNldCB0aGUgSWYtTW9kaWZpZWQtU2luY2UgYW5kL29yIElmLU5vbmUtTWF0Y2ggaGVhZGVyLCBpZiBpbiBpZk1vZGlmaWVkIG1vZGUuCgkJCQkJaWYgKCBzLmlmTW9kaWZpZWQgKSB7CgkJCQkJCW1vZGlmaWVkID0ganFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoICJMYXN0LU1vZGlmaWVkIiApOwoJCQkJCQlpZiAoIG1vZGlmaWVkICkgewoJCQkJCQkJalF1ZXJ5Lmxhc3RNb2RpZmllZFsgY2FjaGVVUkwgXSA9IG1vZGlmaWVkOwoJCQkJCQl9CgkJCQkJCW1vZGlmaWVkID0ganFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoICJldGFnIiApOwoJCQkJCQlpZiAoIG1vZGlmaWVkICkgewoJCQkJCQkJalF1ZXJ5LmV0YWdbIGNhY2hlVVJMIF0gPSBtb2RpZmllZDsKCQkJCQkJfQoJCQkJCX0KCgkJCQkJLy8gaWYgbm8gY29udGVudAoJCQkJCWlmICggc3RhdHVzID09PSAyMDQgfHwgcy50eXBlID09PSAiSEVBRCIgKSB7CgkJCQkJCXN0YXR1c1RleHQgPSAibm9jb250ZW50IjsKCgkJCQkJLy8gaWYgbm90IG1vZGlmaWVkCgkJCQkJfSBlbHNlIGlmICggc3RhdHVzID09PSAzMDQgKSB7CgkJCQkJCXN0YXR1c1RleHQgPSAibm90bW9kaWZpZWQiOwoKCQkJCQkvLyBJZiB3ZSBoYXZlIGRhdGEsIGxldCdzIGNvbnZlcnQgaXQKCQkJCQl9IGVsc2UgewoJCQkJCQlzdGF0dXNUZXh0ID0gcmVzcG9uc2Uuc3RhdGU7CgkJCQkJCXN1Y2Nlc3MgPSByZXNwb25zZS5kYXRhOwoJCQkJCQllcnJvciA9IHJlc3BvbnNlLmVycm9yOwoJCQkJCQlpc1N1Y2Nlc3MgPSAhZXJyb3I7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCgkJCQkJLy8gV2UgZXh0cmFjdCBlcnJvciBmcm9tIHN0YXR1c1RleHQKCQkJCQkvLyB0aGVuIG5vcm1hbGl6ZSBzdGF0dXNUZXh0IGFuZCBzdGF0dXMgZm9yIG5vbi1hYm9ydHMKCQkJCQllcnJvciA9IHN0YXR1c1RleHQ7CgkJCQkJaWYgKCBzdGF0dXMgfHwgIXN0YXR1c1RleHQgKSB7CgkJCQkJCXN0YXR1c1RleHQgPSAiZXJyb3IiOwoJCQkJCQlpZiAoIHN0YXR1cyA8IDAgKSB7CgkJCQkJCQlzdGF0dXMgPSAwOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCS8vIFNldCBkYXRhIGZvciB0aGUgZmFrZSB4aHIgb2JqZWN0CgkJCQlqcVhIUi5zdGF0dXMgPSBzdGF0dXM7CgkJCQlqcVhIUi5zdGF0dXNUZXh0ID0gKCBuYXRpdmVTdGF0dXNUZXh0IHx8IHN0YXR1c1RleHQgKSArICIiOwoKCQkJCS8vIFN1Y2Nlc3MvRXJyb3IKCQkJCWlmICggaXNTdWNjZXNzICkgewoJCQkJCWRlZmVycmVkLnJlc29sdmVXaXRoKCBjYWxsYmFja0NvbnRleHQsIFsgc3VjY2Vzcywgc3RhdHVzVGV4dCwganFYSFIgXSApOwoJCQkJfSBlbHNlIHsKCQkJCQlkZWZlcnJlZC5yZWplY3RXaXRoKCBjYWxsYmFja0NvbnRleHQsIFsganFYSFIsIHN0YXR1c1RleHQsIGVycm9yIF0gKTsKCQkJCX0KCgkJCQkvLyBTdGF0dXMtZGVwZW5kZW50IGNhbGxiYWNrcwoJCQkJanFYSFIuc3RhdHVzQ29kZSggc3RhdHVzQ29kZSApOwoJCQkJc3RhdHVzQ29kZSA9IHVuZGVmaW5lZDsKCgkJCQlpZiAoIGZpcmVHbG9iYWxzICkgewoJCQkJCWdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCBpc1N1Y2Nlc3MgPyAiYWpheFN1Y2Nlc3MiIDogImFqYXhFcnJvciIsCgkJCQkJCVsganFYSFIsIHMsIGlzU3VjY2VzcyA/IHN1Y2Nlc3MgOiBlcnJvciBdICk7CgkJCQl9CgoJCQkJLy8gQ29tcGxldGUKCQkJCWNvbXBsZXRlRGVmZXJyZWQuZmlyZVdpdGgoIGNhbGxiYWNrQ29udGV4dCwgWyBqcVhIUiwgc3RhdHVzVGV4dCBdICk7CgoJCQkJaWYgKCBmaXJlR2xvYmFscyApIHsKCQkJCQlnbG9iYWxFdmVudENvbnRleHQudHJpZ2dlciggImFqYXhDb21wbGV0ZSIsIFsganFYSFIsIHMgXSApOwoKCQkJCQkvLyBIYW5kbGUgdGhlIGdsb2JhbCBBSkFYIGNvdW50ZXIKCQkJCQlpZiAoICEoIC0talF1ZXJ5LmFjdGl2ZSApICkgewoJCQkJCQlqUXVlcnkuZXZlbnQudHJpZ2dlciggImFqYXhTdG9wIiApOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIGpxWEhSOwoJCX0sCgoJCWdldEpTT046IGZ1bmN0aW9uKCB1cmwsIGRhdGEsIGNhbGxiYWNrICkgewoJCQlyZXR1cm4galF1ZXJ5LmdldCggdXJsLCBkYXRhLCBjYWxsYmFjaywgImpzb24iICk7CgkJfSwKCgkJZ2V0U2NyaXB0OiBmdW5jdGlvbiggdXJsLCBjYWxsYmFjayApIHsKCQkJcmV0dXJuIGpRdWVyeS5nZXQoIHVybCwgdW5kZWZpbmVkLCBjYWxsYmFjaywgInNjcmlwdCIgKTsKCQl9Cgl9ICk7CgoJalF1ZXJ5LmVhY2goIFsgImdldCIsICJwb3N0IiBdLCBmdW5jdGlvbiggaSwgbWV0aG9kICkgewoJCWpRdWVyeVsgbWV0aG9kIF0gPSBmdW5jdGlvbiggdXJsLCBkYXRhLCBjYWxsYmFjaywgdHlwZSApIHsKCgkJCS8vIHNoaWZ0IGFyZ3VtZW50cyBpZiBkYXRhIGFyZ3VtZW50IHdhcyBvbWl0dGVkCgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGRhdGEgKSApIHsKCQkJCXR5cGUgPSB0eXBlIHx8IGNhbGxiYWNrOwoJCQkJY2FsbGJhY2sgPSBkYXRhOwoJCQkJZGF0YSA9IHVuZGVmaW5lZDsKCQkJfQoKCQkJLy8gVGhlIHVybCBjYW4gYmUgYW4gb3B0aW9ucyBvYmplY3QgKHdoaWNoIHRoZW4gbXVzdCBoYXZlIC51cmwpCgkJCXJldHVybiBqUXVlcnkuYWpheCggalF1ZXJ5LmV4dGVuZCggewoJCQkJdXJsOiB1cmwsCgkJCQl0eXBlOiBtZXRob2QsCgkJCQlkYXRhVHlwZTogdHlwZSwKCQkJCWRhdGE6IGRhdGEsCgkJCQlzdWNjZXNzOiBjYWxsYmFjawoJCQl9LCBqUXVlcnkuaXNQbGFpbk9iamVjdCggdXJsICkgJiYgdXJsICkgKTsKCQl9OwoJfSApOwoKCglqUXVlcnkuX2V2YWxVcmwgPSBmdW5jdGlvbiggdXJsICkgewoJCXJldHVybiBqUXVlcnkuYWpheCggewoJCQl1cmw6IHVybCwKCgkJCS8vIE1ha2UgdGhpcyBleHBsaWNpdCwgc2luY2UgdXNlciBjYW4gb3ZlcnJpZGUgdGhpcyB0aHJvdWdoIGFqYXhTZXR1cCAoIzExMjY0KQoJCQl0eXBlOiAiR0VUIiwKCQkJZGF0YVR5cGU6ICJzY3JpcHQiLAoJCQljYWNoZTogdHJ1ZSwKCQkJYXN5bmM6IGZhbHNlLAoJCQlnbG9iYWw6IGZhbHNlLAoJCQkidGhyb3dzIjogdHJ1ZQoJCX0gKTsKCX07CgoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCQl3cmFwQWxsOiBmdW5jdGlvbiggaHRtbCApIHsKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggaHRtbCApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oIGkgKSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkud3JhcEFsbCggaHRtbC5jYWxsKCB0aGlzLCBpICkgKTsKCQkJCX0gKTsKCQkJfQoKCQkJaWYgKCB0aGlzWyAwIF0gKSB7CgoJCQkJLy8gVGhlIGVsZW1lbnRzIHRvIHdyYXAgdGhlIHRhcmdldCBhcm91bmQKCQkJCXZhciB3cmFwID0galF1ZXJ5KCBodG1sLCB0aGlzWyAwIF0ub3duZXJEb2N1bWVudCApLmVxKCAwICkuY2xvbmUoIHRydWUgKTsKCgkJCQlpZiAoIHRoaXNbIDAgXS5wYXJlbnROb2RlICkgewoJCQkJCXdyYXAuaW5zZXJ0QmVmb3JlKCB0aGlzWyAwIF0gKTsKCQkJCX0KCgkJCQl3cmFwLm1hcCggZnVuY3Rpb24oKSB7CgkJCQkJdmFyIGVsZW0gPSB0aGlzOwoKCQkJCQl3aGlsZSAoIGVsZW0uZmlyc3RDaGlsZCAmJiBlbGVtLmZpcnN0Q2hpbGQubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJCWVsZW0gPSBlbGVtLmZpcnN0Q2hpbGQ7CgkJCQkJfQoKCQkJCQlyZXR1cm4gZWxlbTsKCQkJCX0gKS5hcHBlbmQoIHRoaXMgKTsKCQkJfQoKCQkJcmV0dXJuIHRoaXM7CgkJfSwKCgkJd3JhcElubmVyOiBmdW5jdGlvbiggaHRtbCApIHsKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggaHRtbCApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oIGkgKSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkud3JhcElubmVyKCBodG1sLmNhbGwoIHRoaXMsIGkgKSApOwoJCQkJfSApOwoJCQl9CgoJCQlyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsKCQkJCXZhciBzZWxmID0galF1ZXJ5KCB0aGlzICksCgkJCQkJY29udGVudHMgPSBzZWxmLmNvbnRlbnRzKCk7CgoJCQkJaWYgKCBjb250ZW50cy5sZW5ndGggKSB7CgkJCQkJY29udGVudHMud3JhcEFsbCggaHRtbCApOwoKCQkJCX0gZWxzZSB7CgkJCQkJc2VsZi5hcHBlbmQoIGh0bWwgKTsKCQkJCX0KCQkJfSApOwoJCX0sCgoJCXdyYXA6IGZ1bmN0aW9uKCBodG1sICkgewoJCQl2YXIgaXNGdW5jdGlvbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKCBodG1sICk7CgoJCQlyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbiggaSApIHsKCQkJCWpRdWVyeSggdGhpcyApLndyYXBBbGwoIGlzRnVuY3Rpb24gPyBodG1sLmNhbGwoIHRoaXMsIGkgKSA6IGh0bWwgKTsKCQkJfSApOwoJCX0sCgoJCXVud3JhcDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLnBhcmVudCgpLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJaWYgKCAhalF1ZXJ5Lm5vZGVOYW1lKCB0aGlzLCAiYm9keSIgKSApIHsKCQkJCQlqUXVlcnkoIHRoaXMgKS5yZXBsYWNlV2l0aCggdGhpcy5jaGlsZE5vZGVzICk7CgkJCQl9CgkJCX0gKS5lbmQoKTsKCQl9Cgl9ICk7CgoKCWZ1bmN0aW9uIGdldERpc3BsYXkoIGVsZW0gKSB7CgkJcmV0dXJuIGVsZW0uc3R5bGUgJiYgZWxlbS5zdHlsZS5kaXNwbGF5IHx8IGpRdWVyeS5jc3MoIGVsZW0sICJkaXNwbGF5IiApOwoJfQoKCWZ1bmN0aW9uIGZpbHRlckhpZGRlbiggZWxlbSApIHsKCQl3aGlsZSAoIGVsZW0gJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSApIHsKCQkJaWYgKCBnZXREaXNwbGF5KCBlbGVtICkgPT09ICJub25lIiB8fCBlbGVtLnR5cGUgPT09ICJoaWRkZW4iICkgewoJCQkJcmV0dXJuIHRydWU7CgkJCX0KCQkJZWxlbSA9IGVsZW0ucGFyZW50Tm9kZTsKCQl9CgkJcmV0dXJuIGZhbHNlOwoJfQoKCWpRdWVyeS5leHByLmZpbHRlcnMuaGlkZGVuID0gZnVuY3Rpb24oIGVsZW0gKSB7CgoJCS8vIFN1cHBvcnQ6IE9wZXJhIDw9IDEyLjEyCgkJLy8gT3BlcmEgcmVwb3J0cyBvZmZzZXRXaWR0aHMgYW5kIG9mZnNldEhlaWdodHMgbGVzcyB0aGFuIHplcm8gb24gc29tZSBlbGVtZW50cwoJCXJldHVybiBzdXBwb3J0LnJlbGlhYmxlSGlkZGVuT2Zmc2V0cygpID8KCQkJKCBlbGVtLm9mZnNldFdpZHRoIDw9IDAgJiYgZWxlbS5vZmZzZXRIZWlnaHQgPD0gMCAmJgoJCQkJIWVsZW0uZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGggKSA6CgkJCQlmaWx0ZXJIaWRkZW4oIGVsZW0gKTsKCX07CgoJalF1ZXJ5LmV4cHIuZmlsdGVycy52aXNpYmxlID0gZnVuY3Rpb24oIGVsZW0gKSB7CgkJcmV0dXJuICFqUXVlcnkuZXhwci5maWx0ZXJzLmhpZGRlbiggZWxlbSApOwoJfTsKCgoKCgl2YXIgcjIwID0gLyUyMC9nLAoJCXJicmFja2V0ID0gL1xbXF0kLywKCQlyQ1JMRiA9IC9ccj9cbi9nLAoJCXJzdWJtaXR0ZXJUeXBlcyA9IC9eKD86c3VibWl0fGJ1dHRvbnxpbWFnZXxyZXNldHxmaWxlKSQvaSwKCQlyc3VibWl0dGFibGUgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxrZXlnZW4pL2k7CgoJZnVuY3Rpb24gYnVpbGRQYXJhbXMoIHByZWZpeCwgb2JqLCB0cmFkaXRpb25hbCwgYWRkICkgewoJCXZhciBuYW1lOwoKCQlpZiAoIGpRdWVyeS5pc0FycmF5KCBvYmogKSApIHsKCgkJCS8vIFNlcmlhbGl6ZSBhcnJheSBpdGVtLgoJCQlqUXVlcnkuZWFjaCggb2JqLCBmdW5jdGlvbiggaSwgdiApIHsKCQkJCWlmICggdHJhZGl0aW9uYWwgfHwgcmJyYWNrZXQudGVzdCggcHJlZml4ICkgKSB7CgoJCQkJCS8vIFRyZWF0IGVhY2ggYXJyYXkgaXRlbSBhcyBhIHNjYWxhci4KCQkJCQlhZGQoIHByZWZpeCwgdiApOwoKCQkJCX0gZWxzZSB7CgoJCQkJCS8vIEl0ZW0gaXMgbm9uLXNjYWxhciAoYXJyYXkgb3Igb2JqZWN0KSwgZW5jb2RlIGl0cyBudW1lcmljIGluZGV4LgoJCQkJCWJ1aWxkUGFyYW1zKAoJCQkJCQlwcmVmaXggKyAiWyIgKyAoIHR5cGVvZiB2ID09PSAib2JqZWN0IiAmJiB2ICE9IG51bGwgPyBpIDogIiIgKSArICJdIiwKCQkJCQkJdiwKCQkJCQkJdHJhZGl0aW9uYWwsCgkJCQkJCWFkZAoJCQkJCSk7CgkJCQl9CgkJCX0gKTsKCgkJfSBlbHNlIGlmICggIXRyYWRpdGlvbmFsICYmIGpRdWVyeS50eXBlKCBvYmogKSA9PT0gIm9iamVjdCIgKSB7CgoJCQkvLyBTZXJpYWxpemUgb2JqZWN0IGl0ZW0uCgkJCWZvciAoIG5hbWUgaW4gb2JqICkgewoJCQkJYnVpbGRQYXJhbXMoIHByZWZpeCArICJbIiArIG5hbWUgKyAiXSIsIG9ialsgbmFtZSBdLCB0cmFkaXRpb25hbCwgYWRkICk7CgkJCX0KCgkJfSBlbHNlIHsKCgkJCS8vIFNlcmlhbGl6ZSBzY2FsYXIgaXRlbS4KCQkJYWRkKCBwcmVmaXgsIG9iaiApOwoJCX0KCX0KCgkvLyBTZXJpYWxpemUgYW4gYXJyYXkgb2YgZm9ybSBlbGVtZW50cyBvciBhIHNldCBvZgoJLy8ga2V5L3ZhbHVlcyBpbnRvIGEgcXVlcnkgc3RyaW5nCglqUXVlcnkucGFyYW0gPSBmdW5jdGlvbiggYSwgdHJhZGl0aW9uYWwgKSB7CgkJdmFyIHByZWZpeCwKCQkJcyA9IFtdLAoJCQlhZGQgPSBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHsKCgkJCQkvLyBJZiB2YWx1ZSBpcyBhIGZ1bmN0aW9uLCBpbnZva2UgaXQgYW5kIHJldHVybiBpdHMgdmFsdWUKCQkJCXZhbHVlID0galF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICkgPyB2YWx1ZSgpIDogKCB2YWx1ZSA9PSBudWxsID8gIiIgOiB2YWx1ZSApOwoJCQkJc1sgcy5sZW5ndGggXSA9IGVuY29kZVVSSUNvbXBvbmVudCgga2V5ICkgKyAiPSIgKyBlbmNvZGVVUklDb21wb25lbnQoIHZhbHVlICk7CgkJCX07CgoJCS8vIFNldCB0cmFkaXRpb25hbCB0byB0cnVlIGZvciBqUXVlcnkgPD0gMS4zLjIgYmVoYXZpb3IuCgkJaWYgKCB0cmFkaXRpb25hbCA9PT0gdW5kZWZpbmVkICkgewoJCQl0cmFkaXRpb25hbCA9IGpRdWVyeS5hamF4U2V0dGluZ3MgJiYgalF1ZXJ5LmFqYXhTZXR0aW5ncy50cmFkaXRpb25hbDsKCQl9CgoJCS8vIElmIGFuIGFycmF5IHdhcyBwYXNzZWQgaW4sIGFzc3VtZSB0aGF0IGl0IGlzIGFuIGFycmF5IG9mIGZvcm0gZWxlbWVudHMuCgkJaWYgKCBqUXVlcnkuaXNBcnJheSggYSApIHx8ICggYS5qcXVlcnkgJiYgIWpRdWVyeS5pc1BsYWluT2JqZWN0KCBhICkgKSApIHsKCgkJCS8vIFNlcmlhbGl6ZSB0aGUgZm9ybSBlbGVtZW50cwoJCQlqUXVlcnkuZWFjaCggYSwgZnVuY3Rpb24oKSB7CgkJCQlhZGQoIHRoaXMubmFtZSwgdGhpcy52YWx1ZSApOwoJCQl9ICk7CgoJCX0gZWxzZSB7CgoJCQkvLyBJZiB0cmFkaXRpb25hbCwgZW5jb2RlIHRoZSAib2xkIiB3YXkgKHRoZSB3YXkgMS4zLjIgb3Igb2xkZXIKCQkJLy8gZGlkIGl0KSwgb3RoZXJ3aXNlIGVuY29kZSBwYXJhbXMgcmVjdXJzaXZlbHkuCgkJCWZvciAoIHByZWZpeCBpbiBhICkgewoJCQkJYnVpbGRQYXJhbXMoIHByZWZpeCwgYVsgcHJlZml4IF0sIHRyYWRpdGlvbmFsLCBhZGQgKTsKCQkJfQoJCX0KCgkJLy8gUmV0dXJuIHRoZSByZXN1bHRpbmcgc2VyaWFsaXphdGlvbgoJCXJldHVybiBzLmpvaW4oICImIiApLnJlcGxhY2UoIHIyMCwgIisiICk7Cgl9OwoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCQlzZXJpYWxpemU6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4galF1ZXJ5LnBhcmFtKCB0aGlzLnNlcmlhbGl6ZUFycmF5KCkgKTsKCQl9LAoJCXNlcmlhbGl6ZUFycmF5OiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMubWFwKCBmdW5jdGlvbigpIHsKCgkJCQkvLyBDYW4gYWRkIHByb3BIb29rIGZvciAiZWxlbWVudHMiIHRvIGZpbHRlciBvciBhZGQgZm9ybSBlbGVtZW50cwoJCQkJdmFyIGVsZW1lbnRzID0galF1ZXJ5LnByb3AoIHRoaXMsICJlbGVtZW50cyIgKTsKCQkJCXJldHVybiBlbGVtZW50cyA/IGpRdWVyeS5tYWtlQXJyYXkoIGVsZW1lbnRzICkgOiB0aGlzOwoJCQl9ICkKCQkJLmZpbHRlciggZnVuY3Rpb24oKSB7CgkJCQl2YXIgdHlwZSA9IHRoaXMudHlwZTsKCgkJCQkvLyBVc2UgLmlzKCI6ZGlzYWJsZWQiKSBzbyB0aGF0IGZpZWxkc2V0W2Rpc2FibGVkXSB3b3JrcwoJCQkJcmV0dXJuIHRoaXMubmFtZSAmJiAhalF1ZXJ5KCB0aGlzICkuaXMoICI6ZGlzYWJsZWQiICkgJiYKCQkJCQlyc3VibWl0dGFibGUudGVzdCggdGhpcy5ub2RlTmFtZSApICYmICFyc3VibWl0dGVyVHlwZXMudGVzdCggdHlwZSApICYmCgkJCQkJKCB0aGlzLmNoZWNrZWQgfHwgIXJjaGVja2FibGVUeXBlLnRlc3QoIHR5cGUgKSApOwoJCQl9ICkKCQkJLm1hcCggZnVuY3Rpb24oIGksIGVsZW0gKSB7CgkJCQl2YXIgdmFsID0galF1ZXJ5KCB0aGlzICkudmFsKCk7CgoJCQkJcmV0dXJuIHZhbCA9PSBudWxsID8KCQkJCQludWxsIDoKCQkJCQlqUXVlcnkuaXNBcnJheSggdmFsICkgPwoJCQkJCQlqUXVlcnkubWFwKCB2YWwsIGZ1bmN0aW9uKCB2YWwgKSB7CgkJCQkJCQlyZXR1cm4geyBuYW1lOiBlbGVtLm5hbWUsIHZhbHVlOiB2YWwucmVwbGFjZSggckNSTEYsICJcclxuIiApIH07CgkJCQkJCX0gKSA6CgkJCQkJCXsgbmFtZTogZWxlbS5uYW1lLCB2YWx1ZTogdmFsLnJlcGxhY2UoIHJDUkxGLCAiXHJcbiIgKSB9OwoJCQl9ICkuZ2V0KCk7CgkJfQoJfSApOwoKCgkvLyBDcmVhdGUgdGhlIHJlcXVlc3Qgb2JqZWN0CgkvLyAoVGhpcyBpcyBzdGlsbCBhdHRhY2hlZCB0byBhamF4U2V0dGluZ3MgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpCglqUXVlcnkuYWpheFNldHRpbmdzLnhociA9IHdpbmRvdy5BY3RpdmVYT2JqZWN0ICE9PSB1bmRlZmluZWQgPwoKCQkvLyBTdXBwb3J0OiBJRTYtSUU4CgkJZnVuY3Rpb24oKSB7CgoJCQkvLyBYSFIgY2Fubm90IGFjY2VzcyBsb2NhbCBmaWxlcywgYWx3YXlzIHVzZSBBY3RpdmVYIGZvciB0aGF0IGNhc2UKCQkJaWYgKCB0aGlzLmlzTG9jYWwgKSB7CgkJCQlyZXR1cm4gY3JlYXRlQWN0aXZlWEhSKCk7CgkJCX0KCgkJCS8vIFN1cHBvcnQ6IElFIDktMTEKCQkJLy8gSUUgc2VlbXMgdG8gZXJyb3Igb24gY3Jvc3MtZG9tYWluIFBBVENIIHJlcXVlc3RzIHdoZW4gQWN0aXZlWCBYSFIKCQkJLy8gaXMgdXNlZC4gSW4gSUUgOSsgYWx3YXlzIHVzZSB0aGUgbmF0aXZlIFhIUi4KCQkJLy8gTm90ZTogdGhpcyBjb25kaXRpb24gd29uJ3QgY2F0Y2ggRWRnZSBhcyBpdCBkb2Vzbid0IGRlZmluZQoJCQkvLyBkb2N1bWVudC5kb2N1bWVudE1vZGUgYnV0IGl0IGFsc28gZG9lc24ndCBzdXBwb3J0IEFjdGl2ZVggc28gaXQgd29uJ3QKCQkJLy8gcmVhY2ggdGhpcyBjb2RlLgoJCQlpZiAoIGRvY3VtZW50LmRvY3VtZW50TW9kZSA+IDggKSB7CgkJCQlyZXR1cm4gY3JlYXRlU3RhbmRhcmRYSFIoKTsKCQkJfQoKCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkvLyBvbGRJRSBYSFIgZG9lcyBub3Qgc3VwcG9ydCBub24tUkZDMjYxNiBtZXRob2RzICgjMTMyNDApCgkJCS8vIFNlZSBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvaWUvbXM1MzY2NDgodj12cy44NSkuYXNweAoJCQkvLyBhbmQgaHR0cDovL3d3dy53My5vcmcvUHJvdG9jb2xzL3JmYzI2MTYvcmZjMjYxNi1zZWM5Lmh0bWwjc2VjOQoJCQkvLyBBbHRob3VnaCB0aGlzIGNoZWNrIGZvciBzaXggbWV0aG9kcyBpbnN0ZWFkIG9mIGVpZ2h0CgkJCS8vIHNpbmNlIElFIGFsc28gZG9lcyBub3Qgc3VwcG9ydCAidHJhY2UiIGFuZCAiY29ubmVjdCIKCQkJcmV0dXJuIC9eKGdldHxwb3N0fGhlYWR8cHV0fGRlbGV0ZXxvcHRpb25zKSQvaS50ZXN0KCB0aGlzLnR5cGUgKSAmJgoJCQkJY3JlYXRlU3RhbmRhcmRYSFIoKSB8fCBjcmVhdGVBY3RpdmVYSFIoKTsKCQl9IDoKCgkJLy8gRm9yIGFsbCBvdGhlciBicm93c2VycywgdXNlIHRoZSBzdGFuZGFyZCBYTUxIdHRwUmVxdWVzdCBvYmplY3QKCQljcmVhdGVTdGFuZGFyZFhIUjsKCgl2YXIgeGhySWQgPSAwLAoJCXhockNhbGxiYWNrcyA9IHt9LAoJCXhoclN1cHBvcnRlZCA9IGpRdWVyeS5hamF4U2V0dGluZ3MueGhyKCk7CgoJLy8gU3VwcG9ydDogSUU8MTAKCS8vIE9wZW4gcmVxdWVzdHMgbXVzdCBiZSBtYW51YWxseSBhYm9ydGVkIG9uIHVubG9hZCAoIzUyODApCgkvLyBTZWUgaHR0cHM6Ly9zdXBwb3J0Lm1pY3Jvc29mdC5jb20va2IvMjg1Njc0NiBmb3IgbW9yZSBpbmZvCglpZiAoIHdpbmRvdy5hdHRhY2hFdmVudCApIHsKCQl3aW5kb3cuYXR0YWNoRXZlbnQoICJvbnVubG9hZCIsIGZ1bmN0aW9uKCkgewoJCQlmb3IgKCB2YXIga2V5IGluIHhockNhbGxiYWNrcyApIHsKCQkJCXhockNhbGxiYWNrc1sga2V5IF0oIHVuZGVmaW5lZCwgdHJ1ZSApOwoJCQl9CgkJfSApOwoJfQoKCS8vIERldGVybWluZSBzdXBwb3J0IHByb3BlcnRpZXMKCXN1cHBvcnQuY29ycyA9ICEheGhyU3VwcG9ydGVkICYmICggIndpdGhDcmVkZW50aWFscyIgaW4geGhyU3VwcG9ydGVkICk7Cgl4aHJTdXBwb3J0ZWQgPSBzdXBwb3J0LmFqYXggPSAhIXhoclN1cHBvcnRlZDsKCgkvLyBDcmVhdGUgdHJhbnNwb3J0IGlmIHRoZSBicm93c2VyIGNhbiBwcm92aWRlIGFuIHhocgoJaWYgKCB4aHJTdXBwb3J0ZWQgKSB7CgoJCWpRdWVyeS5hamF4VHJhbnNwb3J0KCBmdW5jdGlvbiggb3B0aW9ucyApIHsKCgkJCS8vIENyb3NzIGRvbWFpbiBvbmx5IGFsbG93ZWQgaWYgc3VwcG9ydGVkIHRocm91Z2ggWE1MSHR0cFJlcXVlc3QKCQkJaWYgKCAhb3B0aW9ucy5jcm9zc0RvbWFpbiB8fCBzdXBwb3J0LmNvcnMgKSB7CgoJCQkJdmFyIGNhbGxiYWNrOwoKCQkJCXJldHVybiB7CgkJCQkJc2VuZDogZnVuY3Rpb24oIGhlYWRlcnMsIGNvbXBsZXRlICkgewoJCQkJCQl2YXIgaSwKCQkJCQkJCXhociA9IG9wdGlvbnMueGhyKCksCgkJCQkJCQlpZCA9ICsreGhySWQ7CgoJCQkJCQkvLyBPcGVuIHRoZSBzb2NrZXQKCQkJCQkJeGhyLm9wZW4oCgkJCQkJCQlvcHRpb25zLnR5cGUsCgkJCQkJCQlvcHRpb25zLnVybCwKCQkJCQkJCW9wdGlvbnMuYXN5bmMsCgkJCQkJCQlvcHRpb25zLnVzZXJuYW1lLAoJCQkJCQkJb3B0aW9ucy5wYXNzd29yZAoJCQkJCQkpOwoKCQkJCQkJLy8gQXBwbHkgY3VzdG9tIGZpZWxkcyBpZiBwcm92aWRlZAoJCQkJCQlpZiAoIG9wdGlvbnMueGhyRmllbGRzICkgewoJCQkJCQkJZm9yICggaSBpbiBvcHRpb25zLnhockZpZWxkcyApIHsKCQkJCQkJCQl4aHJbIGkgXSA9IG9wdGlvbnMueGhyRmllbGRzWyBpIF07CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCS8vIE92ZXJyaWRlIG1pbWUgdHlwZSBpZiBuZWVkZWQKCQkJCQkJaWYgKCBvcHRpb25zLm1pbWVUeXBlICYmIHhoci5vdmVycmlkZU1pbWVUeXBlICkgewoJCQkJCQkJeGhyLm92ZXJyaWRlTWltZVR5cGUoIG9wdGlvbnMubWltZVR5cGUgKTsKCQkJCQkJfQoKCQkJCQkJLy8gWC1SZXF1ZXN0ZWQtV2l0aCBoZWFkZXIKCQkJCQkJLy8gRm9yIGNyb3NzLWRvbWFpbiByZXF1ZXN0cywgc2VlaW5nIGFzIGNvbmRpdGlvbnMgZm9yIGEgcHJlZmxpZ2h0IGFyZQoJCQkJCQkvLyBha2luIHRvIGEgamlnc2F3IHB1enpsZSwgd2Ugc2ltcGx5IG5ldmVyIHNldCBpdCB0byBiZSBzdXJlLgoJCQkJCQkvLyAoaXQgY2FuIGFsd2F5cyBiZSBzZXQgb24gYSBwZXItcmVxdWVzdCBiYXNpcyBvciBldmVuIHVzaW5nIGFqYXhTZXR1cCkKCQkJCQkJLy8gRm9yIHNhbWUtZG9tYWluIHJlcXVlc3RzLCB3b24ndCBjaGFuZ2UgaGVhZGVyIGlmIGFscmVhZHkgcHJvdmlkZWQuCgkJCQkJCWlmICggIW9wdGlvbnMuY3Jvc3NEb21haW4gJiYgIWhlYWRlcnNbICJYLVJlcXVlc3RlZC1XaXRoIiBdICkgewoJCQkJCQkJaGVhZGVyc1sgIlgtUmVxdWVzdGVkLVdpdGgiIF0gPSAiWE1MSHR0cFJlcXVlc3QiOwoJCQkJCQl9CgoJCQkJCQkvLyBTZXQgaGVhZGVycwoJCQkJCQlmb3IgKCBpIGluIGhlYWRlcnMgKSB7CgoJCQkJCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkJCQkJLy8gSUUncyBBY3RpdmVYT2JqZWN0IHRocm93cyBhICdUeXBlIE1pc21hdGNoJyBleGNlcHRpb24gd2hlbiBzZXR0aW5nCgkJCQkJCQkvLyByZXF1ZXN0IGhlYWRlciB0byBhIG51bGwtdmFsdWUuCgkJCQkJCQkvLwoJCQkJCQkJLy8gVG8ga2VlcCBjb25zaXN0ZW50IHdpdGggb3RoZXIgWEhSIGltcGxlbWVudGF0aW9ucywgY2FzdCB0aGUgdmFsdWUKCQkJCQkJCS8vIHRvIHN0cmluZyBhbmQgaWdub3JlIGB1bmRlZmluZWRgLgoJCQkJCQkJaWYgKCBoZWFkZXJzWyBpIF0gIT09IHVuZGVmaW5lZCApIHsKCQkJCQkJCQl4aHIuc2V0UmVxdWVzdEhlYWRlciggaSwgaGVhZGVyc1sgaSBdICsgIiIgKTsKCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJLy8gRG8gc2VuZCB0aGUgcmVxdWVzdAoJCQkJCQkvLyBUaGlzIG1heSByYWlzZSBhbiBleGNlcHRpb24gd2hpY2ggaXMgYWN0dWFsbHkKCQkJCQkJLy8gaGFuZGxlZCBpbiBqUXVlcnkuYWpheCAoc28gbm8gdHJ5L2NhdGNoIGhlcmUpCgkJCQkJCXhoci5zZW5kKCAoIG9wdGlvbnMuaGFzQ29udGVudCAmJiBvcHRpb25zLmRhdGEgKSB8fCBudWxsICk7CgoJCQkJCQkvLyBMaXN0ZW5lcgoJCQkJCQljYWxsYmFjayA9IGZ1bmN0aW9uKCBfLCBpc0Fib3J0ICkgewoJCQkJCQkJdmFyIHN0YXR1cywgc3RhdHVzVGV4dCwgcmVzcG9uc2VzOwoKCQkJCQkJCS8vIFdhcyBuZXZlciBjYWxsZWQgYW5kIGlzIGFib3J0ZWQgb3IgY29tcGxldGUKCQkJCQkJCWlmICggY2FsbGJhY2sgJiYgKCBpc0Fib3J0IHx8IHhoci5yZWFkeVN0YXRlID09PSA0ICkgKSB7CgoJCQkJCQkJCS8vIENsZWFuIHVwCgkJCQkJCQkJZGVsZXRlIHhockNhbGxiYWNrc1sgaWQgXTsKCQkJCQkJCQljYWxsYmFjayA9IHVuZGVmaW5lZDsKCQkJCQkJCQl4aHIub25yZWFkeXN0YXRlY2hhbmdlID0galF1ZXJ5Lm5vb3A7CgoJCQkJCQkJCS8vIEFib3J0IG1hbnVhbGx5IGlmIG5lZWRlZAoJCQkJCQkJCWlmICggaXNBYm9ydCApIHsKCQkJCQkJCQkJaWYgKCB4aHIucmVhZHlTdGF0ZSAhPT0gNCApIHsKCQkJCQkJCQkJCXhoci5hYm9ydCgpOwoJCQkJCQkJCQl9CgkJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkJcmVzcG9uc2VzID0ge307CgkJCQkJCQkJCXN0YXR1cyA9IHhoci5zdGF0dXM7CgoJCQkJCQkJCQkvLyBTdXBwb3J0OiBJRTwxMAoJCQkJCQkJCQkvLyBBY2Nlc3NpbmcgYmluYXJ5LWRhdGEgcmVzcG9uc2VUZXh0IHRocm93cyBhbiBleGNlcHRpb24KCQkJCQkJCQkJLy8gKCMxMTQyNikKCQkJCQkJCQkJaWYgKCB0eXBlb2YgeGhyLnJlc3BvbnNlVGV4dCA9PT0gInN0cmluZyIgKSB7CgkJCQkJCQkJCQlyZXNwb25zZXMudGV4dCA9IHhoci5yZXNwb25zZVRleHQ7CgkJCQkJCQkJCX0KCgkJCQkJCQkJCS8vIEZpcmVmb3ggdGhyb3dzIGFuIGV4Y2VwdGlvbiB3aGVuIGFjY2Vzc2luZwoJCQkJCQkJCQkvLyBzdGF0dXNUZXh0IGZvciBmYXVsdHkgY3Jvc3MtZG9tYWluIHJlcXVlc3RzCgkJCQkJCQkJCXRyeSB7CgkJCQkJCQkJCQlzdGF0dXNUZXh0ID0geGhyLnN0YXR1c1RleHQ7CgkJCQkJCQkJCX0gY2F0Y2ggKCBlICkgewoKCQkJCQkJCQkJCS8vIFdlIG5vcm1hbGl6ZSB3aXRoIFdlYmtpdCBnaXZpbmcgYW4gZW1wdHkgc3RhdHVzVGV4dAoJCQkJCQkJCQkJc3RhdHVzVGV4dCA9ICIiOwoJCQkJCQkJCQl9CgoJCQkJCQkJCQkvLyBGaWx0ZXIgc3RhdHVzIGZvciBub24gc3RhbmRhcmQgYmVoYXZpb3JzCgoJCQkJCQkJCQkvLyBJZiB0aGUgcmVxdWVzdCBpcyBsb2NhbCBhbmQgd2UgaGF2ZSBkYXRhOiBhc3N1bWUgYSBzdWNjZXNzCgkJCQkJCQkJCS8vIChzdWNjZXNzIHdpdGggbm8gZGF0YSB3b24ndCBnZXQgbm90aWZpZWQsIHRoYXQncyB0aGUgYmVzdCB3ZQoJCQkJCQkJCQkvLyBjYW4gZG8gZ2l2ZW4gY3VycmVudCBpbXBsZW1lbnRhdGlvbnMpCgkJCQkJCQkJCWlmICggIXN0YXR1cyAmJiBvcHRpb25zLmlzTG9jYWwgJiYgIW9wdGlvbnMuY3Jvc3NEb21haW4gKSB7CgkJCQkJCQkJCQlzdGF0dXMgPSByZXNwb25zZXMudGV4dCA/IDIwMCA6IDQwNDsKCgkJCQkJCQkJCS8vIElFIC0gIzE0NTA6IHNvbWV0aW1lcyByZXR1cm5zIDEyMjMgd2hlbiBpdCBzaG91bGQgYmUgMjA0CgkJCQkJCQkJCX0gZWxzZSBpZiAoIHN0YXR1cyA9PT0gMTIyMyApIHsKCQkJCQkJCQkJCXN0YXR1cyA9IDIwNDsKCQkJCQkJCQkJfQoJCQkJCQkJCX0KCQkJCQkJCX0KCgkJCQkJCQkvLyBDYWxsIGNvbXBsZXRlIGlmIG5lZWRlZAoJCQkJCQkJaWYgKCByZXNwb25zZXMgKSB7CgkJCQkJCQkJY29tcGxldGUoIHN0YXR1cywgc3RhdHVzVGV4dCwgcmVzcG9uc2VzLCB4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkgKTsKCQkJCQkJCX0KCQkJCQkJfTsKCgkJCQkJCS8vIERvIHNlbmQgdGhlIHJlcXVlc3QKCQkJCQkJLy8gYHhoci5zZW5kYCBtYXkgcmFpc2UgYW4gZXhjZXB0aW9uLCBidXQgaXQgd2lsbCBiZQoJCQkJCQkvLyBoYW5kbGVkIGluIGpRdWVyeS5hamF4IChzbyBubyB0cnkvY2F0Y2ggaGVyZSkKCQkJCQkJaWYgKCAhb3B0aW9ucy5hc3luYyApIHsKCgkJCQkJCQkvLyBJZiB3ZSdyZSBpbiBzeW5jIG1vZGUgd2UgZmlyZSB0aGUgY2FsbGJhY2sKCQkJCQkJCWNhbGxiYWNrKCk7CgkJCQkJCX0gZWxzZSBpZiAoIHhoci5yZWFkeVN0YXRlID09PSA0ICkgewoKCQkJCQkJCS8vIChJRTYgJiBJRTcpIGlmIGl0J3MgaW4gY2FjaGUgYW5kIGhhcyBiZWVuCgkJCQkJCQkvLyByZXRyaWV2ZWQgZGlyZWN0bHkgd2UgbmVlZCB0byBmaXJlIHRoZSBjYWxsYmFjawoJCQkJCQkJd2luZG93LnNldFRpbWVvdXQoIGNhbGxiYWNrICk7CgkJCQkJCX0gZWxzZSB7CgoJCQkJCQkJLy8gUmVnaXN0ZXIgdGhlIGNhbGxiYWNrLCBidXQgZGVsYXkgaXQgaW4gY2FzZSBgeGhyLnNlbmRgIHRocm93cwoJCQkJCQkJLy8gQWRkIHRvIHRoZSBsaXN0IG9mIGFjdGl2ZSB4aHIgY2FsbGJhY2tzCgkJCQkJCQl4aHIub25yZWFkeXN0YXRlY2hhbmdlID0geGhyQ2FsbGJhY2tzWyBpZCBdID0gY2FsbGJhY2s7CgkJCQkJCX0KCQkJCQl9LAoKCQkJCQlhYm9ydDogZnVuY3Rpb24oKSB7CgkJCQkJCWlmICggY2FsbGJhY2sgKSB7CgkJCQkJCQljYWxsYmFjayggdW5kZWZpbmVkLCB0cnVlICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9OwoJCQl9CgkJfSApOwoJfQoKCS8vIEZ1bmN0aW9ucyB0byBjcmVhdGUgeGhycwoJZnVuY3Rpb24gY3JlYXRlU3RhbmRhcmRYSFIoKSB7CgkJdHJ5IHsKCQkJcmV0dXJuIG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTsKCQl9IGNhdGNoICggZSApIHt9Cgl9CgoJZnVuY3Rpb24gY3JlYXRlQWN0aXZlWEhSKCkgewoJCXRyeSB7CgkJCXJldHVybiBuZXcgd2luZG93LkFjdGl2ZVhPYmplY3QoICJNaWNyb3NvZnQuWE1MSFRUUCIgKTsKCQl9IGNhdGNoICggZSApIHt9Cgl9CgoKCgoJLy8gUHJldmVudCBhdXRvLWV4ZWN1dGlvbiBvZiBzY3JpcHRzIHdoZW4gbm8gZXhwbGljaXQgZGF0YVR5cGUgd2FzIHByb3ZpZGVkIChTZWUgZ2gtMjQzMikKCWpRdWVyeS5hamF4UHJlZmlsdGVyKCBmdW5jdGlvbiggcyApIHsKCQlpZiAoIHMuY3Jvc3NEb21haW4gKSB7CgkJCXMuY29udGVudHMuc2NyaXB0ID0gZmFsc2U7CgkJfQoJfSApOwoKCS8vIEluc3RhbGwgc2NyaXB0IGRhdGFUeXBlCglqUXVlcnkuYWpheFNldHVwKCB7CgkJYWNjZXB0czogewoJCQlzY3JpcHQ6ICJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsICIgKwoJCQkJImFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdCIKCQl9LAoJCWNvbnRlbnRzOiB7CgkJCXNjcmlwdDogL1xiKD86amF2YXxlY21hKXNjcmlwdFxiLwoJCX0sCgkJY29udmVydGVyczogewoJCQkidGV4dCBzY3JpcHQiOiBmdW5jdGlvbiggdGV4dCApIHsKCQkJCWpRdWVyeS5nbG9iYWxFdmFsKCB0ZXh0ICk7CgkJCQlyZXR1cm4gdGV4dDsKCQkJfQoJCX0KCX0gKTsKCgkvLyBIYW5kbGUgY2FjaGUncyBzcGVjaWFsIGNhc2UgYW5kIGdsb2JhbAoJalF1ZXJ5LmFqYXhQcmVmaWx0ZXIoICJzY3JpcHQiLCBmdW5jdGlvbiggcyApIHsKCQlpZiAoIHMuY2FjaGUgPT09IHVuZGVmaW5lZCApIHsKCQkJcy5jYWNoZSA9IGZhbHNlOwoJCX0KCQlpZiAoIHMuY3Jvc3NEb21haW4gKSB7CgkJCXMudHlwZSA9ICJHRVQiOwoJCQlzLmdsb2JhbCA9IGZhbHNlOwoJCX0KCX0gKTsKCgkvLyBCaW5kIHNjcmlwdCB0YWcgaGFjayB0cmFuc3BvcnQKCWpRdWVyeS5hamF4VHJhbnNwb3J0KCAic2NyaXB0IiwgZnVuY3Rpb24oIHMgKSB7CgoJCS8vIFRoaXMgdHJhbnNwb3J0IG9ubHkgZGVhbHMgd2l0aCBjcm9zcyBkb21haW4gcmVxdWVzdHMKCQlpZiAoIHMuY3Jvc3NEb21haW4gKSB7CgoJCQl2YXIgc2NyaXB0LAoJCQkJaGVhZCA9IGRvY3VtZW50LmhlYWQgfHwgalF1ZXJ5KCAiaGVhZCIgKVsgMCBdIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCgkJCXJldHVybiB7CgoJCQkJc2VuZDogZnVuY3Rpb24oIF8sIGNhbGxiYWNrICkgewoKCQkJCQlzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAic2NyaXB0IiApOwoKCQkJCQlzY3JpcHQuYXN5bmMgPSB0cnVlOwoKCQkJCQlpZiAoIHMuc2NyaXB0Q2hhcnNldCApIHsKCQkJCQkJc2NyaXB0LmNoYXJzZXQgPSBzLnNjcmlwdENoYXJzZXQ7CgkJCQkJfQoKCQkJCQlzY3JpcHQuc3JjID0gcy51cmw7CgoJCQkJCS8vIEF0dGFjaCBoYW5kbGVycyBmb3IgYWxsIGJyb3dzZXJzCgkJCQkJc2NyaXB0Lm9ubG9hZCA9IHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiggXywgaXNBYm9ydCApIHsKCgkJCQkJCWlmICggaXNBYm9ydCB8fCAhc2NyaXB0LnJlYWR5U3RhdGUgfHwgL2xvYWRlZHxjb21wbGV0ZS8udGVzdCggc2NyaXB0LnJlYWR5U3RhdGUgKSApIHsKCgkJCQkJCQkvLyBIYW5kbGUgbWVtb3J5IGxlYWsgaW4gSUUKCQkJCQkJCXNjcmlwdC5vbmxvYWQgPSBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDsKCgkJCQkJCQkvLyBSZW1vdmUgdGhlIHNjcmlwdAoJCQkJCQkJaWYgKCBzY3JpcHQucGFyZW50Tm9kZSApIHsKCQkJCQkJCQlzY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggc2NyaXB0ICk7CgkJCQkJCQl9CgoJCQkJCQkJLy8gRGVyZWZlcmVuY2UgdGhlIHNjcmlwdAoJCQkJCQkJc2NyaXB0ID0gbnVsbDsKCgkJCQkJCQkvLyBDYWxsYmFjayBpZiBub3QgYWJvcnQKCQkJCQkJCWlmICggIWlzQWJvcnQgKSB7CgkJCQkJCQkJY2FsbGJhY2soIDIwMCwgInN1Y2Nlc3MiICk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9OwoKCQkJCQkvLyBDaXJjdW12ZW50IElFNiBidWdzIHdpdGggYmFzZSBlbGVtZW50cyAoIzI3MDkgYW5kICM0Mzc4KSBieSBwcmVwZW5kaW5nCgkJCQkJLy8gVXNlIG5hdGl2ZSBET00gbWFuaXB1bGF0aW9uIHRvIGF2b2lkIG91ciBkb21NYW5pcCBBSkFYIHRyaWNrZXJ5CgkJCQkJaGVhZC5pbnNlcnRCZWZvcmUoIHNjcmlwdCwgaGVhZC5maXJzdENoaWxkICk7CgkJCQl9LAoKCQkJCWFib3J0OiBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIHNjcmlwdCApIHsKCQkJCQkJc2NyaXB0Lm9ubG9hZCggdW5kZWZpbmVkLCB0cnVlICk7CgkJCQkJfQoJCQkJfQoJCQl9OwoJCX0KCX0gKTsKCgoKCgl2YXIgb2xkQ2FsbGJhY2tzID0gW10sCgkJcmpzb25wID0gLyg9KVw/KD89JnwkKXxcP1w/LzsKCgkvLyBEZWZhdWx0IGpzb25wIHNldHRpbmdzCglqUXVlcnkuYWpheFNldHVwKCB7CgkJanNvbnA6ICJjYWxsYmFjayIsCgkJanNvbnBDYWxsYmFjazogZnVuY3Rpb24oKSB7CgkJCXZhciBjYWxsYmFjayA9IG9sZENhbGxiYWNrcy5wb3AoKSB8fCAoIGpRdWVyeS5leHBhbmRvICsgIl8iICsgKCBub25jZSsrICkgKTsKCQkJdGhpc1sgY2FsbGJhY2sgXSA9IHRydWU7CgkJCXJldHVybiBjYWxsYmFjazsKCQl9Cgl9ICk7CgoJLy8gRGV0ZWN0LCBub3JtYWxpemUgb3B0aW9ucyBhbmQgaW5zdGFsbCBjYWxsYmFja3MgZm9yIGpzb25wIHJlcXVlc3RzCglqUXVlcnkuYWpheFByZWZpbHRlciggImpzb24ganNvbnAiLCBmdW5jdGlvbiggcywgb3JpZ2luYWxTZXR0aW5ncywganFYSFIgKSB7CgoJCXZhciBjYWxsYmFja05hbWUsIG92ZXJ3cml0dGVuLCByZXNwb25zZUNvbnRhaW5lciwKCQkJanNvblByb3AgPSBzLmpzb25wICE9PSBmYWxzZSAmJiAoIHJqc29ucC50ZXN0KCBzLnVybCApID8KCQkJCSJ1cmwiIDoKCQkJCXR5cGVvZiBzLmRhdGEgPT09ICJzdHJpbmciICYmCgkJCQkJKCBzLmNvbnRlbnRUeXBlIHx8ICIiICkKCQkJCQkJLmluZGV4T2YoICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiICkgPT09IDAgJiYKCQkJCQlyanNvbnAudGVzdCggcy5kYXRhICkgJiYgImRhdGEiCgkJCSk7CgoJCS8vIEhhbmRsZSBpZmYgdGhlIGV4cGVjdGVkIGRhdGEgdHlwZSBpcyAianNvbnAiIG9yIHdlIGhhdmUgYSBwYXJhbWV0ZXIgdG8gc2V0CgkJaWYgKCBqc29uUHJvcCB8fCBzLmRhdGFUeXBlc1sgMCBdID09PSAianNvbnAiICkgewoKCQkJLy8gR2V0IGNhbGxiYWNrIG5hbWUsIHJlbWVtYmVyaW5nIHByZWV4aXN0aW5nIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCBpdAoJCQljYWxsYmFja05hbWUgPSBzLmpzb25wQ2FsbGJhY2sgPSBqUXVlcnkuaXNGdW5jdGlvbiggcy5qc29ucENhbGxiYWNrICkgPwoJCQkJcy5qc29ucENhbGxiYWNrKCkgOgoJCQkJcy5qc29ucENhbGxiYWNrOwoKCQkJLy8gSW5zZXJ0IGNhbGxiYWNrIGludG8gdXJsIG9yIGZvcm0gZGF0YQoJCQlpZiAoIGpzb25Qcm9wICkgewoJCQkJc1sganNvblByb3AgXSA9IHNbIGpzb25Qcm9wIF0ucmVwbGFjZSggcmpzb25wLCAiJDEiICsgY2FsbGJhY2tOYW1lICk7CgkJCX0gZWxzZSBpZiAoIHMuanNvbnAgIT09IGZhbHNlICkgewoJCQkJcy51cmwgKz0gKCBycXVlcnkudGVzdCggcy51cmwgKSA/ICImIiA6ICI/IiApICsgcy5qc29ucCArICI9IiArIGNhbGxiYWNrTmFtZTsKCQkJfQoKCQkJLy8gVXNlIGRhdGEgY29udmVydGVyIHRvIHJldHJpZXZlIGpzb24gYWZ0ZXIgc2NyaXB0IGV4ZWN1dGlvbgoJCQlzLmNvbnZlcnRlcnNbICJzY3JpcHQganNvbiIgXSA9IGZ1bmN0aW9uKCkgewoJCQkJaWYgKCAhcmVzcG9uc2VDb250YWluZXIgKSB7CgkJCQkJalF1ZXJ5LmVycm9yKCBjYWxsYmFja05hbWUgKyAiIHdhcyBub3QgY2FsbGVkIiApOwoJCQkJfQoJCQkJcmV0dXJuIHJlc3BvbnNlQ29udGFpbmVyWyAwIF07CgkJCX07CgoJCQkvLyBmb3JjZSBqc29uIGRhdGFUeXBlCgkJCXMuZGF0YVR5cGVzWyAwIF0gPSAianNvbiI7CgoJCQkvLyBJbnN0YWxsIGNhbGxiYWNrCgkJCW92ZXJ3cml0dGVuID0gd2luZG93WyBjYWxsYmFja05hbWUgXTsKCQkJd2luZG93WyBjYWxsYmFja05hbWUgXSA9IGZ1bmN0aW9uKCkgewoJCQkJcmVzcG9uc2VDb250YWluZXIgPSBhcmd1bWVudHM7CgkJCX07CgoJCQkvLyBDbGVhbi11cCBmdW5jdGlvbiAoZmlyZXMgYWZ0ZXIgY29udmVydGVycykKCQkJanFYSFIuYWx3YXlzKCBmdW5jdGlvbigpIHsKCgkJCQkvLyBJZiBwcmV2aW91cyB2YWx1ZSBkaWRuJ3QgZXhpc3QgLSByZW1vdmUgaXQKCQkJCWlmICggb3ZlcndyaXR0ZW4gPT09IHVuZGVmaW5lZCApIHsKCQkJCQlqUXVlcnkoIHdpbmRvdyApLnJlbW92ZVByb3AoIGNhbGxiYWNrTmFtZSApOwoKCQkJCS8vIE90aGVyd2lzZSByZXN0b3JlIHByZWV4aXN0aW5nIHZhbHVlCgkJCQl9IGVsc2UgewoJCQkJCXdpbmRvd1sgY2FsbGJhY2tOYW1lIF0gPSBvdmVyd3JpdHRlbjsKCQkJCX0KCgkJCQkvLyBTYXZlIGJhY2sgYXMgZnJlZQoJCQkJaWYgKCBzWyBjYWxsYmFja05hbWUgXSApIHsKCgkJCQkJLy8gbWFrZSBzdXJlIHRoYXQgcmUtdXNpbmcgdGhlIG9wdGlvbnMgZG9lc24ndCBzY3JldyB0aGluZ3MgYXJvdW5kCgkJCQkJcy5qc29ucENhbGxiYWNrID0gb3JpZ2luYWxTZXR0aW5ncy5qc29ucENhbGxiYWNrOwoKCQkJCQkvLyBzYXZlIHRoZSBjYWxsYmFjayBuYW1lIGZvciBmdXR1cmUgdXNlCgkJCQkJb2xkQ2FsbGJhY2tzLnB1c2goIGNhbGxiYWNrTmFtZSApOwoJCQkJfQoKCQkJCS8vIENhbGwgaWYgaXQgd2FzIGEgZnVuY3Rpb24gYW5kIHdlIGhhdmUgYSByZXNwb25zZQoJCQkJaWYgKCByZXNwb25zZUNvbnRhaW5lciAmJiBqUXVlcnkuaXNGdW5jdGlvbiggb3ZlcndyaXR0ZW4gKSApIHsKCQkJCQlvdmVyd3JpdHRlbiggcmVzcG9uc2VDb250YWluZXJbIDAgXSApOwoJCQkJfQoKCQkJCXJlc3BvbnNlQ29udGFpbmVyID0gb3ZlcndyaXR0ZW4gPSB1bmRlZmluZWQ7CgkJCX0gKTsKCgkJCS8vIERlbGVnYXRlIHRvIHNjcmlwdAoJCQlyZXR1cm4gInNjcmlwdCI7CgkJfQoJfSApOwoKCgoKCS8vIFN1cHBvcnQ6IFNhZmFyaSA4KwoJLy8gSW4gU2FmYXJpIDggZG9jdW1lbnRzIGNyZWF0ZWQgdmlhIGRvY3VtZW50LmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudAoJLy8gY29sbGFwc2Ugc2libGluZyBmb3JtczogdGhlIHNlY29uZCBvbmUgYmVjb21lcyBhIGNoaWxkIG9mIHRoZSBmaXJzdCBvbmUuCgkvLyBCZWNhdXNlIG9mIHRoYXQsIHRoaXMgc2VjdXJpdHkgbWVhc3VyZSBoYXMgdG8gYmUgZGlzYWJsZWQgaW4gU2FmYXJpIDguCgkvLyBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTM3MzM3CglzdXBwb3J0LmNyZWF0ZUhUTUxEb2N1bWVudCA9ICggZnVuY3Rpb24oKSB7CgkJaWYgKCAhZG9jdW1lbnQuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50ICkgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCXZhciBkb2MgPSBkb2N1bWVudC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoICIiICk7CgkJZG9jLmJvZHkuaW5uZXJIVE1MID0gIjxmb3JtPjwvZm9ybT48Zm9ybT48L2Zvcm0+IjsKCQlyZXR1cm4gZG9jLmJvZHkuY2hpbGROb2Rlcy5sZW5ndGggPT09IDI7Cgl9ICkoKTsKCgoJLy8gZGF0YTogc3RyaW5nIG9mIGh0bWwKCS8vIGNvbnRleHQgKG9wdGlvbmFsKTogSWYgc3BlY2lmaWVkLCB0aGUgZnJhZ21lbnQgd2lsbCBiZSBjcmVhdGVkIGluIHRoaXMgY29udGV4dCwKCS8vIGRlZmF1bHRzIHRvIGRvY3VtZW50CgkvLyBrZWVwU2NyaXB0cyAob3B0aW9uYWwpOiBJZiB0cnVlLCB3aWxsIGluY2x1ZGUgc2NyaXB0cyBwYXNzZWQgaW4gdGhlIGh0bWwgc3RyaW5nCglqUXVlcnkucGFyc2VIVE1MID0gZnVuY3Rpb24oIGRhdGEsIGNvbnRleHQsIGtlZXBTY3JpcHRzICkgewoJCWlmICggIWRhdGEgfHwgdHlwZW9mIGRhdGEgIT09ICJzdHJpbmciICkgewoJCQlyZXR1cm4gbnVsbDsKCQl9CgkJaWYgKCB0eXBlb2YgY29udGV4dCA9PT0gImJvb2xlYW4iICkgewoJCQlrZWVwU2NyaXB0cyA9IGNvbnRleHQ7CgkJCWNvbnRleHQgPSBmYWxzZTsKCQl9CgoJCS8vIGRvY3VtZW50LmltcGxlbWVudGF0aW9uIHN0b3BzIHNjcmlwdHMgb3IgaW5saW5lIGV2ZW50IGhhbmRsZXJzIGZyb20KCQkvLyBiZWluZyBleGVjdXRlZCBpbW1lZGlhdGVseQoJCWNvbnRleHQgPSBjb250ZXh0IHx8ICggc3VwcG9ydC5jcmVhdGVIVE1MRG9jdW1lbnQgPwoJCQlkb2N1bWVudC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoICIiICkgOgoJCQlkb2N1bWVudCApOwoKCQl2YXIgcGFyc2VkID0gcnNpbmdsZVRhZy5leGVjKCBkYXRhICksCgkJCXNjcmlwdHMgPSAha2VlcFNjcmlwdHMgJiYgW107CgoJCS8vIFNpbmdsZSB0YWcKCQlpZiAoIHBhcnNlZCApIHsKCQkJcmV0dXJuIFsgY29udGV4dC5jcmVhdGVFbGVtZW50KCBwYXJzZWRbIDEgXSApIF07CgkJfQoKCQlwYXJzZWQgPSBidWlsZEZyYWdtZW50KCBbIGRhdGEgXSwgY29udGV4dCwgc2NyaXB0cyApOwoKCQlpZiAoIHNjcmlwdHMgJiYgc2NyaXB0cy5sZW5ndGggKSB7CgkJCWpRdWVyeSggc2NyaXB0cyApLnJlbW92ZSgpOwoJCX0KCgkJcmV0dXJuIGpRdWVyeS5tZXJnZSggW10sIHBhcnNlZC5jaGlsZE5vZGVzICk7Cgl9OwoKCgkvLyBLZWVwIGEgY29weSBvZiB0aGUgb2xkIGxvYWQgbWV0aG9kCgl2YXIgX2xvYWQgPSBqUXVlcnkuZm4ubG9hZDsKCgkvKioKCSAqIExvYWQgYSB1cmwgaW50byBhIHBhZ2UKCSAqLwoJalF1ZXJ5LmZuLmxvYWQgPSBmdW5jdGlvbiggdXJsLCBwYXJhbXMsIGNhbGxiYWNrICkgewoJCWlmICggdHlwZW9mIHVybCAhPT0gInN0cmluZyIgJiYgX2xvYWQgKSB7CgkJCXJldHVybiBfbG9hZC5hcHBseSggdGhpcywgYXJndW1lbnRzICk7CgkJfQoKCQl2YXIgc2VsZWN0b3IsIHR5cGUsIHJlc3BvbnNlLAoJCQlzZWxmID0gdGhpcywKCQkJb2ZmID0gdXJsLmluZGV4T2YoICIgIiApOwoKCQlpZiAoIG9mZiA+IC0xICkgewoJCQlzZWxlY3RvciA9IGpRdWVyeS50cmltKCB1cmwuc2xpY2UoIG9mZiwgdXJsLmxlbmd0aCApICk7CgkJCXVybCA9IHVybC5zbGljZSggMCwgb2ZmICk7CgkJfQoKCQkvLyBJZiBpdCdzIGEgZnVuY3Rpb24KCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBwYXJhbXMgKSApIHsKCgkJCS8vIFdlIGFzc3VtZSB0aGF0IGl0J3MgdGhlIGNhbGxiYWNrCgkJCWNhbGxiYWNrID0gcGFyYW1zOwoJCQlwYXJhbXMgPSB1bmRlZmluZWQ7CgoJCS8vIE90aGVyd2lzZSwgYnVpbGQgYSBwYXJhbSBzdHJpbmcKCQl9IGVsc2UgaWYgKCBwYXJhbXMgJiYgdHlwZW9mIHBhcmFtcyA9PT0gIm9iamVjdCIgKSB7CgkJCXR5cGUgPSAiUE9TVCI7CgkJfQoKCQkvLyBJZiB3ZSBoYXZlIGVsZW1lbnRzIHRvIG1vZGlmeSwgbWFrZSB0aGUgcmVxdWVzdAoJCWlmICggc2VsZi5sZW5ndGggPiAwICkgewoJCQlqUXVlcnkuYWpheCggewoJCQkJdXJsOiB1cmwsCgoJCQkJLy8gSWYgInR5cGUiIHZhcmlhYmxlIGlzIHVuZGVmaW5lZCwgdGhlbiAiR0VUIiBtZXRob2Qgd2lsbCBiZSB1c2VkLgoJCQkJLy8gTWFrZSB2YWx1ZSBvZiB0aGlzIGZpZWxkIGV4cGxpY2l0IHNpbmNlCgkJCQkvLyB1c2VyIGNhbiBvdmVycmlkZSBpdCB0aHJvdWdoIGFqYXhTZXR1cCBtZXRob2QKCQkJCXR5cGU6IHR5cGUgfHwgIkdFVCIsCgkJCQlkYXRhVHlwZTogImh0bWwiLAoJCQkJZGF0YTogcGFyYW1zCgkJCX0gKS5kb25lKCBmdW5jdGlvbiggcmVzcG9uc2VUZXh0ICkgewoKCQkJCS8vIFNhdmUgcmVzcG9uc2UgZm9yIHVzZSBpbiBjb21wbGV0ZSBjYWxsYmFjawoJCQkJcmVzcG9uc2UgPSBhcmd1bWVudHM7CgoJCQkJc2VsZi5odG1sKCBzZWxlY3RvciA/CgoJCQkJCS8vIElmIGEgc2VsZWN0b3Igd2FzIHNwZWNpZmllZCwgbG9jYXRlIHRoZSByaWdodCBlbGVtZW50cyBpbiBhIGR1bW15IGRpdgoJCQkJCS8vIEV4Y2x1ZGUgc2NyaXB0cyB0byBhdm9pZCBJRSAnUGVybWlzc2lvbiBEZW5pZWQnIGVycm9ycwoJCQkJCWpRdWVyeSggIjxkaXY+IiApLmFwcGVuZCggalF1ZXJ5LnBhcnNlSFRNTCggcmVzcG9uc2VUZXh0ICkgKS5maW5kKCBzZWxlY3RvciApIDoKCgkJCQkJLy8gT3RoZXJ3aXNlIHVzZSB0aGUgZnVsbCByZXN1bHQKCQkJCQlyZXNwb25zZVRleHQgKTsKCgkJCS8vIElmIHRoZSByZXF1ZXN0IHN1Y2NlZWRzLCB0aGlzIGZ1bmN0aW9uIGdldHMgImRhdGEiLCAic3RhdHVzIiwgImpxWEhSIgoJCQkvLyBidXQgdGhleSBhcmUgaWdub3JlZCBiZWNhdXNlIHJlc3BvbnNlIHdhcyBzZXQgYWJvdmUuCgkJCS8vIElmIGl0IGZhaWxzLCB0aGlzIGZ1bmN0aW9uIGdldHMgImpxWEhSIiwgInN0YXR1cyIsICJlcnJvciIKCQkJfSApLmFsd2F5cyggY2FsbGJhY2sgJiYgZnVuY3Rpb24oIGpxWEhSLCBzdGF0dXMgKSB7CgkJCQlzZWxmLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJCWNhbGxiYWNrLmFwcGx5KCBzZWxmLCByZXNwb25zZSB8fCBbIGpxWEhSLnJlc3BvbnNlVGV4dCwgc3RhdHVzLCBqcVhIUiBdICk7CgkJCQl9ICk7CgkJCX0gKTsKCQl9CgoJCXJldHVybiB0aGlzOwoJfTsKCgoKCgkvLyBBdHRhY2ggYSBidW5jaCBvZiBmdW5jdGlvbnMgZm9yIGhhbmRsaW5nIGNvbW1vbiBBSkFYIGV2ZW50cwoJalF1ZXJ5LmVhY2goIFsKCQkiYWpheFN0YXJ0IiwKCQkiYWpheFN0b3AiLAoJCSJhamF4Q29tcGxldGUiLAoJCSJhamF4RXJyb3IiLAoJCSJhamF4U3VjY2VzcyIsCgkJImFqYXhTZW5kIgoJXSwgZnVuY3Rpb24oIGksIHR5cGUgKSB7CgkJalF1ZXJ5LmZuWyB0eXBlIF0gPSBmdW5jdGlvbiggZm4gKSB7CgkJCXJldHVybiB0aGlzLm9uKCB0eXBlLCBmbiApOwoJCX07Cgl9ICk7CgoKCgoJalF1ZXJ5LmV4cHIuZmlsdGVycy5hbmltYXRlZCA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCXJldHVybiBqUXVlcnkuZ3JlcCggalF1ZXJ5LnRpbWVycywgZnVuY3Rpb24oIGZuICkgewoJCQlyZXR1cm4gZWxlbSA9PT0gZm4uZWxlbTsKCQl9ICkubGVuZ3RoOwoJfTsKCgoKCgoJLyoqCgkgKiBHZXRzIGEgd2luZG93IGZyb20gYW4gZWxlbWVudAoJICovCglmdW5jdGlvbiBnZXRXaW5kb3coIGVsZW0gKSB7CgkJcmV0dXJuIGpRdWVyeS5pc1dpbmRvdyggZWxlbSApID8KCQkJZWxlbSA6CgkJCWVsZW0ubm9kZVR5cGUgPT09IDkgPwoJCQkJZWxlbS5kZWZhdWx0VmlldyB8fCBlbGVtLnBhcmVudFdpbmRvdyA6CgkJCQlmYWxzZTsKCX0KCglqUXVlcnkub2Zmc2V0ID0gewoJCXNldE9mZnNldDogZnVuY3Rpb24oIGVsZW0sIG9wdGlvbnMsIGkgKSB7CgkJCXZhciBjdXJQb3NpdGlvbiwgY3VyTGVmdCwgY3VyQ1NTVG9wLCBjdXJUb3AsIGN1ck9mZnNldCwgY3VyQ1NTTGVmdCwgY2FsY3VsYXRlUG9zaXRpb24sCgkJCQlwb3NpdGlvbiA9IGpRdWVyeS5jc3MoIGVsZW0sICJwb3NpdGlvbiIgKSwKCQkJCWN1ckVsZW0gPSBqUXVlcnkoIGVsZW0gKSwKCQkJCXByb3BzID0ge307CgoJCQkvLyBzZXQgcG9zaXRpb24gZmlyc3QsIGluLWNhc2UgdG9wL2xlZnQgYXJlIHNldCBldmVuIG9uIHN0YXRpYyBlbGVtCgkJCWlmICggcG9zaXRpb24gPT09ICJzdGF0aWMiICkgewoJCQkJZWxlbS5zdHlsZS5wb3NpdGlvbiA9ICJyZWxhdGl2ZSI7CgkJCX0KCgkJCWN1ck9mZnNldCA9IGN1ckVsZW0ub2Zmc2V0KCk7CgkJCWN1ckNTU1RvcCA9IGpRdWVyeS5jc3MoIGVsZW0sICJ0b3AiICk7CgkJCWN1ckNTU0xlZnQgPSBqUXVlcnkuY3NzKCBlbGVtLCAibGVmdCIgKTsKCQkJY2FsY3VsYXRlUG9zaXRpb24gPSAoIHBvc2l0aW9uID09PSAiYWJzb2x1dGUiIHx8IHBvc2l0aW9uID09PSAiZml4ZWQiICkgJiYKCQkJCWpRdWVyeS5pbkFycmF5KCAiYXV0byIsIFsgY3VyQ1NTVG9wLCBjdXJDU1NMZWZ0IF0gKSA+IC0xOwoKCQkJLy8gbmVlZCB0byBiZSBhYmxlIHRvIGNhbGN1bGF0ZSBwb3NpdGlvbiBpZiBlaXRoZXIgdG9wIG9yIGxlZnQKCQkJLy8gaXMgYXV0byBhbmQgcG9zaXRpb24gaXMgZWl0aGVyIGFic29sdXRlIG9yIGZpeGVkCgkJCWlmICggY2FsY3VsYXRlUG9zaXRpb24gKSB7CgkJCQljdXJQb3NpdGlvbiA9IGN1ckVsZW0ucG9zaXRpb24oKTsKCQkJCWN1clRvcCA9IGN1clBvc2l0aW9uLnRvcDsKCQkJCWN1ckxlZnQgPSBjdXJQb3NpdGlvbi5sZWZ0OwoJCQl9IGVsc2UgewoJCQkJY3VyVG9wID0gcGFyc2VGbG9hdCggY3VyQ1NTVG9wICkgfHwgMDsKCQkJCWN1ckxlZnQgPSBwYXJzZUZsb2F0KCBjdXJDU1NMZWZ0ICkgfHwgMDsKCQkJfQoKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggb3B0aW9ucyApICkgewoKCQkJCS8vIFVzZSBqUXVlcnkuZXh0ZW5kIGhlcmUgdG8gYWxsb3cgbW9kaWZpY2F0aW9uIG9mIGNvb3JkaW5hdGVzIGFyZ3VtZW50IChnaC0xODQ4KQoJCQkJb3B0aW9ucyA9IG9wdGlvbnMuY2FsbCggZWxlbSwgaSwgalF1ZXJ5LmV4dGVuZCgge30sIGN1ck9mZnNldCApICk7CgkJCX0KCgkJCWlmICggb3B0aW9ucy50b3AgIT0gbnVsbCApIHsKCQkJCXByb3BzLnRvcCA9ICggb3B0aW9ucy50b3AgLSBjdXJPZmZzZXQudG9wICkgKyBjdXJUb3A7CgkJCX0KCQkJaWYgKCBvcHRpb25zLmxlZnQgIT0gbnVsbCApIHsKCQkJCXByb3BzLmxlZnQgPSAoIG9wdGlvbnMubGVmdCAtIGN1ck9mZnNldC5sZWZ0ICkgKyBjdXJMZWZ0OwoJCQl9CgoJCQlpZiAoICJ1c2luZyIgaW4gb3B0aW9ucyApIHsKCQkJCW9wdGlvbnMudXNpbmcuY2FsbCggZWxlbSwgcHJvcHMgKTsKCQkJfSBlbHNlIHsKCQkJCWN1ckVsZW0uY3NzKCBwcm9wcyApOwoJCQl9CgkJfQoJfTsKCglqUXVlcnkuZm4uZXh0ZW5kKCB7CgkJb2Zmc2V0OiBmdW5jdGlvbiggb3B0aW9ucyApIHsKCQkJaWYgKCBhcmd1bWVudHMubGVuZ3RoICkgewoJCQkJcmV0dXJuIG9wdGlvbnMgPT09IHVuZGVmaW5lZCA/CgkJCQkJdGhpcyA6CgkJCQkJdGhpcy5lYWNoKCBmdW5jdGlvbiggaSApIHsKCQkJCQkJalF1ZXJ5Lm9mZnNldC5zZXRPZmZzZXQoIHRoaXMsIG9wdGlvbnMsIGkgKTsKCQkJCQl9ICk7CgkJCX0KCgkJCXZhciBkb2NFbGVtLCB3aW4sCgkJCQlib3ggPSB7IHRvcDogMCwgbGVmdDogMCB9LAoJCQkJZWxlbSA9IHRoaXNbIDAgXSwKCQkJCWRvYyA9IGVsZW0gJiYgZWxlbS5vd25lckRvY3VtZW50OwoKCQkJaWYgKCAhZG9jICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQlkb2NFbGVtID0gZG9jLmRvY3VtZW50RWxlbWVudDsKCgkJCS8vIE1ha2Ugc3VyZSBpdCdzIG5vdCBhIGRpc2Nvbm5lY3RlZCBET00gbm9kZQoJCQlpZiAoICFqUXVlcnkuY29udGFpbnMoIGRvY0VsZW0sIGVsZW0gKSApIHsKCQkJCXJldHVybiBib3g7CgkJCX0KCgkJCS8vIElmIHdlIGRvbid0IGhhdmUgZ0JDUiwganVzdCB1c2UgMCwwIHJhdGhlciB0aGFuIGVycm9yCgkJCS8vIEJsYWNrQmVycnkgNSwgaU9TIDMgKG9yaWdpbmFsIGlQaG9uZSkKCQkJaWYgKCB0eXBlb2YgZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QgIT09ICJ1bmRlZmluZWQiICkgewoJCQkJYm94ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKCQkJfQoJCQl3aW4gPSBnZXRXaW5kb3coIGRvYyApOwoJCQlyZXR1cm4gewoJCQkJdG9wOiBib3gudG9wICArICggd2luLnBhZ2VZT2Zmc2V0IHx8IGRvY0VsZW0uc2Nyb2xsVG9wICkgIC0gKCBkb2NFbGVtLmNsaWVudFRvcCAgfHwgMCApLAoJCQkJbGVmdDogYm94LmxlZnQgKyAoIHdpbi5wYWdlWE9mZnNldCB8fCBkb2NFbGVtLnNjcm9sbExlZnQgKSAtICggZG9jRWxlbS5jbGllbnRMZWZ0IHx8IDAgKQoJCQl9OwoJCX0sCgoJCXBvc2l0aW9uOiBmdW5jdGlvbigpIHsKCQkJaWYgKCAhdGhpc1sgMCBdICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQl2YXIgb2Zmc2V0UGFyZW50LCBvZmZzZXQsCgkJCQlwYXJlbnRPZmZzZXQgPSB7IHRvcDogMCwgbGVmdDogMCB9LAoJCQkJZWxlbSA9IHRoaXNbIDAgXTsKCgkJCS8vIEZpeGVkIGVsZW1lbnRzIGFyZSBvZmZzZXQgZnJvbSB3aW5kb3cgKHBhcmVudE9mZnNldCA9IHt0b3A6MCwgbGVmdDogMH0sCgkJCS8vIGJlY2F1c2UgaXQgaXMgaXRzIG9ubHkgb2Zmc2V0IHBhcmVudAoJCQlpZiAoIGpRdWVyeS5jc3MoIGVsZW0sICJwb3NpdGlvbiIgKSA9PT0gImZpeGVkIiApIHsKCgkJCQkvLyB3ZSBhc3N1bWUgdGhhdCBnZXRCb3VuZGluZ0NsaWVudFJlY3QgaXMgYXZhaWxhYmxlIHdoZW4gY29tcHV0ZWQgcG9zaXRpb24gaXMgZml4ZWQKCQkJCW9mZnNldCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CgkJCX0gZWxzZSB7CgoJCQkJLy8gR2V0ICpyZWFsKiBvZmZzZXRQYXJlbnQKCQkJCW9mZnNldFBhcmVudCA9IHRoaXMub2Zmc2V0UGFyZW50KCk7CgoJCQkJLy8gR2V0IGNvcnJlY3Qgb2Zmc2V0cwoJCQkJb2Zmc2V0ID0gdGhpcy5vZmZzZXQoKTsKCQkJCWlmICggIWpRdWVyeS5ub2RlTmFtZSggb2Zmc2V0UGFyZW50WyAwIF0sICJodG1sIiApICkgewoJCQkJCXBhcmVudE9mZnNldCA9IG9mZnNldFBhcmVudC5vZmZzZXQoKTsKCQkJCX0KCgkJCQkvLyBBZGQgb2Zmc2V0UGFyZW50IGJvcmRlcnMKCQkJCXBhcmVudE9mZnNldC50b3AgICs9IGpRdWVyeS5jc3MoIG9mZnNldFBhcmVudFsgMCBdLCAiYm9yZGVyVG9wV2lkdGgiLCB0cnVlICk7CgkJCQlwYXJlbnRPZmZzZXQubGVmdCArPSBqUXVlcnkuY3NzKCBvZmZzZXRQYXJlbnRbIDAgXSwgImJvcmRlckxlZnRXaWR0aCIsIHRydWUgKTsKCQkJfQoKCQkJLy8gU3VidHJhY3QgcGFyZW50IG9mZnNldHMgYW5kIGVsZW1lbnQgbWFyZ2lucwoJCQkvLyBub3RlOiB3aGVuIGFuIGVsZW1lbnQgaGFzIG1hcmdpbjogYXV0byB0aGUgb2Zmc2V0TGVmdCBhbmQgbWFyZ2luTGVmdAoJCQkvLyBhcmUgdGhlIHNhbWUgaW4gU2FmYXJpIGNhdXNpbmcgb2Zmc2V0LmxlZnQgdG8gaW5jb3JyZWN0bHkgYmUgMAoJCQlyZXR1cm4gewoJCQkJdG9wOiAgb2Zmc2V0LnRvcCAgLSBwYXJlbnRPZmZzZXQudG9wIC0galF1ZXJ5LmNzcyggZWxlbSwgIm1hcmdpblRvcCIsIHRydWUgKSwKCQkJCWxlZnQ6IG9mZnNldC5sZWZ0IC0gcGFyZW50T2Zmc2V0LmxlZnQgLSBqUXVlcnkuY3NzKCBlbGVtLCAibWFyZ2luTGVmdCIsIHRydWUgKQoJCQl9OwoJCX0sCgoJCW9mZnNldFBhcmVudDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLm1hcCggZnVuY3Rpb24oKSB7CgkJCQl2YXIgb2Zmc2V0UGFyZW50ID0gdGhpcy5vZmZzZXRQYXJlbnQ7CgoJCQkJd2hpbGUgKCBvZmZzZXRQYXJlbnQgJiYgKCAhalF1ZXJ5Lm5vZGVOYW1lKCBvZmZzZXRQYXJlbnQsICJodG1sIiApICYmCgkJCQkJalF1ZXJ5LmNzcyggb2Zmc2V0UGFyZW50LCAicG9zaXRpb24iICkgPT09ICJzdGF0aWMiICkgKSB7CgkJCQkJb2Zmc2V0UGFyZW50ID0gb2Zmc2V0UGFyZW50Lm9mZnNldFBhcmVudDsKCQkJCX0KCQkJCXJldHVybiBvZmZzZXRQYXJlbnQgfHwgZG9jdW1lbnRFbGVtZW50OwoJCQl9ICk7CgkJfQoJfSApOwoKCS8vIENyZWF0ZSBzY3JvbGxMZWZ0IGFuZCBzY3JvbGxUb3AgbWV0aG9kcwoJalF1ZXJ5LmVhY2goIHsgc2Nyb2xsTGVmdDogInBhZ2VYT2Zmc2V0Iiwgc2Nyb2xsVG9wOiAicGFnZVlPZmZzZXQiIH0sIGZ1bmN0aW9uKCBtZXRob2QsIHByb3AgKSB7CgkJdmFyIHRvcCA9IC9ZLy50ZXN0KCBwcm9wICk7CgoJCWpRdWVyeS5mblsgbWV0aG9kIF0gPSBmdW5jdGlvbiggdmFsICkgewoJCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggZWxlbSwgbWV0aG9kLCB2YWwgKSB7CgkJCQl2YXIgd2luID0gZ2V0V2luZG93KCBlbGVtICk7CgoJCQkJaWYgKCB2YWwgPT09IHVuZGVmaW5lZCApIHsKCQkJCQlyZXR1cm4gd2luID8gKCBwcm9wIGluIHdpbiApID8gd2luWyBwcm9wIF0gOgoJCQkJCQl3aW4uZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyBtZXRob2QgXSA6CgkJCQkJCWVsZW1bIG1ldGhvZCBdOwoJCQkJfQoKCQkJCWlmICggd2luICkgewoJCQkJCXdpbi5zY3JvbGxUbygKCQkJCQkJIXRvcCA/IHZhbCA6IGpRdWVyeSggd2luICkuc2Nyb2xsTGVmdCgpLAoJCQkJCQl0b3AgPyB2YWwgOiBqUXVlcnkoIHdpbiApLnNjcm9sbFRvcCgpCgkJCQkJKTsKCgkJCQl9IGVsc2UgewoJCQkJCWVsZW1bIG1ldGhvZCBdID0gdmFsOwoJCQkJfQoJCQl9LCBtZXRob2QsIHZhbCwgYXJndW1lbnRzLmxlbmd0aCwgbnVsbCApOwoJCX07Cgl9ICk7CgoJLy8gU3VwcG9ydDogU2FmYXJpPDctOCssIENocm9tZTwzNy00NCsKCS8vIEFkZCB0aGUgdG9wL2xlZnQgY3NzSG9va3MgdXNpbmcgalF1ZXJ5LmZuLnBvc2l0aW9uCgkvLyBXZWJraXQgYnVnOiBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjkwODQKCS8vIGdldENvbXB1dGVkU3R5bGUgcmV0dXJucyBwZXJjZW50IHdoZW4gc3BlY2lmaWVkIGZvciB0b3AvbGVmdC9ib3R0b20vcmlnaHQKCS8vIHJhdGhlciB0aGFuIG1ha2UgdGhlIGNzcyBtb2R1bGUgZGVwZW5kIG9uIHRoZSBvZmZzZXQgbW9kdWxlLCB3ZSBqdXN0IGNoZWNrIGZvciBpdCBoZXJlCglqUXVlcnkuZWFjaCggWyAidG9wIiwgImxlZnQiIF0sIGZ1bmN0aW9uKCBpLCBwcm9wICkgewoJCWpRdWVyeS5jc3NIb29rc1sgcHJvcCBdID0gYWRkR2V0SG9va0lmKCBzdXBwb3J0LnBpeGVsUG9zaXRpb24sCgkJCWZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCApIHsKCQkJCWlmICggY29tcHV0ZWQgKSB7CgkJCQkJY29tcHV0ZWQgPSBjdXJDU1MoIGVsZW0sIHByb3AgKTsKCgkJCQkJLy8gaWYgY3VyQ1NTIHJldHVybnMgcGVyY2VudGFnZSwgZmFsbGJhY2sgdG8gb2Zmc2V0CgkJCQkJcmV0dXJuIHJudW1ub25weC50ZXN0KCBjb21wdXRlZCApID8KCQkJCQkJalF1ZXJ5KCBlbGVtICkucG9zaXRpb24oKVsgcHJvcCBdICsgInB4IiA6CgkJCQkJCWNvbXB1dGVkOwoJCQkJfQoJCQl9CgkJKTsKCX0gKTsKCgoJLy8gQ3JlYXRlIGlubmVySGVpZ2h0LCBpbm5lcldpZHRoLCBoZWlnaHQsIHdpZHRoLCBvdXRlckhlaWdodCBhbmQgb3V0ZXJXaWR0aCBtZXRob2RzCglqUXVlcnkuZWFjaCggeyBIZWlnaHQ6ICJoZWlnaHQiLCBXaWR0aDogIndpZHRoIiB9LCBmdW5jdGlvbiggbmFtZSwgdHlwZSApIHsKCQlqUXVlcnkuZWFjaCggeyBwYWRkaW5nOiAiaW5uZXIiICsgbmFtZSwgY29udGVudDogdHlwZSwgIiI6ICJvdXRlciIgKyBuYW1lIH0sCgkJZnVuY3Rpb24oIGRlZmF1bHRFeHRyYSwgZnVuY05hbWUgKSB7CgoJCQkvLyBtYXJnaW4gaXMgb25seSBmb3Igb3V0ZXJIZWlnaHQsIG91dGVyV2lkdGgKCQkJalF1ZXJ5LmZuWyBmdW5jTmFtZSBdID0gZnVuY3Rpb24oIG1hcmdpbiwgdmFsdWUgKSB7CgkJCQl2YXIgY2hhaW5hYmxlID0gYXJndW1lbnRzLmxlbmd0aCAmJiAoIGRlZmF1bHRFeHRyYSB8fCB0eXBlb2YgbWFyZ2luICE9PSAiYm9vbGVhbiIgKSwKCQkJCQlleHRyYSA9IGRlZmF1bHRFeHRyYSB8fCAoIG1hcmdpbiA9PT0gdHJ1ZSB8fCB2YWx1ZSA9PT0gdHJ1ZSA/ICJtYXJnaW4iIDogImJvcmRlciIgKTsKCgkJCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggZWxlbSwgdHlwZSwgdmFsdWUgKSB7CgkJCQkJdmFyIGRvYzsKCgkJCQkJaWYgKCBqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSApIHsKCgkJCQkJCS8vIEFzIG9mIDUvOC8yMDEyIHRoaXMgd2lsbCB5aWVsZCBpbmNvcnJlY3QgcmVzdWx0cyBmb3IgTW9iaWxlIFNhZmFyaSwgYnV0IHRoZXJlCgkJCQkJCS8vIGlzbid0IGEgd2hvbGUgbG90IHdlIGNhbiBkby4gU2VlIHB1bGwgcmVxdWVzdCBhdCB0aGlzIFVSTCBmb3IgZGlzY3Vzc2lvbjoKCQkJCQkJLy8gaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9qcXVlcnkvcHVsbC83NjQKCQkJCQkJcmV0dXJuIGVsZW0uZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyAiY2xpZW50IiArIG5hbWUgXTsKCQkJCQl9CgoJCQkJCS8vIEdldCBkb2N1bWVudCB3aWR0aCBvciBoZWlnaHQKCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDkgKSB7CgkJCQkJCWRvYyA9IGVsZW0uZG9jdW1lbnRFbGVtZW50OwoKCQkJCQkJLy8gRWl0aGVyIHNjcm9sbFtXaWR0aC9IZWlnaHRdIG9yIG9mZnNldFtXaWR0aC9IZWlnaHRdIG9yIGNsaWVudFtXaWR0aC9IZWlnaHRdLAoJCQkJCQkvLyB3aGljaGV2ZXIgaXMgZ3JlYXRlc3QKCQkJCQkJLy8gdW5mb3J0dW5hdGVseSwgdGhpcyBjYXVzZXMgYnVnICMzODM4IGluIElFNi84IG9ubHksCgkJCQkJCS8vIGJ1dCB0aGVyZSBpcyBjdXJyZW50bHkgbm8gZ29vZCwgc21hbGwgd2F5IHRvIGZpeCBpdC4KCQkJCQkJcmV0dXJuIE1hdGgubWF4KAoJCQkJCQkJZWxlbS5ib2R5WyAic2Nyb2xsIiArIG5hbWUgXSwgZG9jWyAic2Nyb2xsIiArIG5hbWUgXSwKCQkJCQkJCWVsZW0uYm9keVsgIm9mZnNldCIgKyBuYW1lIF0sIGRvY1sgIm9mZnNldCIgKyBuYW1lIF0sCgkJCQkJCQlkb2NbICJjbGllbnQiICsgbmFtZSBdCgkJCQkJCSk7CgkJCQkJfQoKCQkJCQlyZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/CgoJCQkJCQkvLyBHZXQgd2lkdGggb3IgaGVpZ2h0IG9uIHRoZSBlbGVtZW50LCByZXF1ZXN0aW5nIGJ1dCBub3QgZm9yY2luZyBwYXJzZUZsb2F0CgkJCQkJCWpRdWVyeS5jc3MoIGVsZW0sIHR5cGUsIGV4dHJhICkgOgoKCQkJCQkJLy8gU2V0IHdpZHRoIG9yIGhlaWdodCBvbiB0aGUgZWxlbWVudAoJCQkJCQlqUXVlcnkuc3R5bGUoIGVsZW0sIHR5cGUsIHZhbHVlLCBleHRyYSApOwoJCQkJfSwgdHlwZSwgY2hhaW5hYmxlID8gbWFyZ2luIDogdW5kZWZpbmVkLCBjaGFpbmFibGUsIG51bGwgKTsKCQkJfTsKCQl9ICk7Cgl9ICk7CgoKCWpRdWVyeS5mbi5leHRlbmQoIHsKCgkJYmluZDogZnVuY3Rpb24oIHR5cGVzLCBkYXRhLCBmbiApIHsKCQkJcmV0dXJuIHRoaXMub24oIHR5cGVzLCBudWxsLCBkYXRhLCBmbiApOwoJCX0sCgkJdW5iaW5kOiBmdW5jdGlvbiggdHlwZXMsIGZuICkgewoJCQlyZXR1cm4gdGhpcy5vZmYoIHR5cGVzLCBudWxsLCBmbiApOwoJCX0sCgoJCWRlbGVnYXRlOiBmdW5jdGlvbiggc2VsZWN0b3IsIHR5cGVzLCBkYXRhLCBmbiApIHsKCQkJcmV0dXJuIHRoaXMub24oIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4gKTsKCQl9LAoJCXVuZGVsZWdhdGU6IGZ1bmN0aW9uKCBzZWxlY3RvciwgdHlwZXMsIGZuICkgewoKCQkJLy8gKCBuYW1lc3BhY2UgKSBvciAoIHNlbGVjdG9yLCB0eXBlcyBbLCBmbl0gKQoJCQlyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA9PT0gMSA/CgkJCQl0aGlzLm9mZiggc2VsZWN0b3IsICIqKiIgKSA6CgkJCQl0aGlzLm9mZiggdHlwZXMsIHNlbGVjdG9yIHx8ICIqKiIsIGZuICk7CgkJfQoJfSApOwoKCS8vIFRoZSBudW1iZXIgb2YgZWxlbWVudHMgY29udGFpbmVkIGluIHRoZSBtYXRjaGVkIGVsZW1lbnQgc2V0CglqUXVlcnkuZm4uc2l6ZSA9IGZ1bmN0aW9uKCkgewoJCXJldHVybiB0aGlzLmxlbmd0aDsKCX07CgoJalF1ZXJ5LmZuLmFuZFNlbGYgPSBqUXVlcnkuZm4uYWRkQmFjazsKCgoKCgkvLyBSZWdpc3RlciBhcyBhIG5hbWVkIEFNRCBtb2R1bGUsIHNpbmNlIGpRdWVyeSBjYW4gYmUgY29uY2F0ZW5hdGVkIHdpdGggb3RoZXIKCS8vIGZpbGVzIHRoYXQgbWF5IHVzZSBkZWZpbmUsIGJ1dCBub3QgdmlhIGEgcHJvcGVyIGNvbmNhdGVuYXRpb24gc2NyaXB0IHRoYXQKCS8vIHVuZGVyc3RhbmRzIGFub255bW91cyBBTUQgbW9kdWxlcy4gQSBuYW1lZCBBTUQgaXMgc2FmZXN0IGFuZCBtb3N0IHJvYnVzdAoJLy8gd2F5IHRvIHJlZ2lzdGVyLiBMb3dlcmNhc2UganF1ZXJ5IGlzIHVzZWQgYmVjYXVzZSBBTUQgbW9kdWxlIG5hbWVzIGFyZQoJLy8gZGVyaXZlZCBmcm9tIGZpbGUgbmFtZXMsIGFuZCBqUXVlcnkgaXMgbm9ybWFsbHkgZGVsaXZlcmVkIGluIGEgbG93ZXJjYXNlCgkvLyBmaWxlIG5hbWUuIERvIHRoaXMgYWZ0ZXIgY3JlYXRpbmcgdGhlIGdsb2JhbCBzbyB0aGF0IGlmIGFuIEFNRCBtb2R1bGUgd2FudHMKCS8vIHRvIGNhbGwgbm9Db25mbGljdCB0byBoaWRlIHRoaXMgdmVyc2lvbiBvZiBqUXVlcnksIGl0IHdpbGwgd29yay4KCgkvLyBOb3RlIHRoYXQgZm9yIG1heGltdW0gcG9ydGFiaWxpdHksIGxpYnJhcmllcyB0aGF0IGFyZSBub3QgalF1ZXJ5IHNob3VsZAoJLy8gZGVjbGFyZSB0aGVtc2VsdmVzIGFzIGFub255bW91cyBtb2R1bGVzLCBhbmQgYXZvaWQgc2V0dGluZyBhIGdsb2JhbCBpZiBhbgoJLy8gQU1EIGxvYWRlciBpcyBwcmVzZW50LiBqUXVlcnkgaXMgYSBzcGVjaWFsIGNhc2UuIEZvciBtb3JlIGluZm9ybWF0aW9uLCBzZWUKCS8vIGh0dHBzOi8vZ2l0aHViLmNvbS9qcmJ1cmtlL3JlcXVpcmVqcy93aWtpL1VwZGF0aW5nLWV4aXN0aW5nLWxpYnJhcmllcyN3aWtpLWFub24KCglpZiAoIHRydWUgKSB7CgkJIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW10sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oKSB7CgkJCXJldHVybiBqUXVlcnk7CgkJfS5hcHBseShleHBvcnRzLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpOwoJfQoKCgoJdmFyCgoJCS8vIE1hcCBvdmVyIGpRdWVyeSBpbiBjYXNlIG9mIG92ZXJ3cml0ZQoJCV9qUXVlcnkgPSB3aW5kb3cualF1ZXJ5LAoKCQkvLyBNYXAgb3ZlciB0aGUgJCBpbiBjYXNlIG9mIG92ZXJ3cml0ZQoJCV8kID0gd2luZG93LiQ7CgoJalF1ZXJ5Lm5vQ29uZmxpY3QgPSBmdW5jdGlvbiggZGVlcCApIHsKCQlpZiAoIHdpbmRvdy4kID09PSBqUXVlcnkgKSB7CgkJCXdpbmRvdy4kID0gXyQ7CgkJfQoKCQlpZiAoIGRlZXAgJiYgd2luZG93LmpRdWVyeSA9PT0galF1ZXJ5ICkgewoJCQl3aW5kb3cualF1ZXJ5ID0gX2pRdWVyeTsKCQl9CgoJCXJldHVybiBqUXVlcnk7Cgl9OwoKCS8vIEV4cG9zZSBqUXVlcnkgYW5kICQgaWRlbnRpZmllcnMsIGV2ZW4gaW4KCS8vIEFNRCAoIzcxMDIjY29tbWVudDoxMCwgaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9qcXVlcnkvcHVsbC81NTcpCgkvLyBhbmQgQ29tbW9uSlMgZm9yIGJyb3dzZXIgZW11bGF0b3JzICgjMTM1NjYpCglpZiAoICFub0dsb2JhbCApIHsKCQl3aW5kb3cualF1ZXJ5ID0gd2luZG93LiQgPSBqUXVlcnk7Cgl9CgoJcmV0dXJuIGpRdWVyeTsKCX0pKTsKCgovKioqLyB9LAovKiAzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsndXNlIHN0cmljdCc7CgoJLyogZXNsaW50IG1heC1zdGF0ZW1lbnRzOiBbMiwgMjNdIGNvbXBsZXhpdHk6IFsyLCA3XSAqLwoJIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW19fd2VicGFja19yZXF1aXJlX18oNCksIF9fd2VicGFja19yZXF1aXJlX18oNSksIF9fd2VicGFja19yZXF1aXJlX18oNiksIF9fd2VicGFja19yZXF1aXJlX18oMTApLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKV0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24gKCQsIEhhbmRsZWJhcnMsIENvb2tpZSwgY2FjaGVidXN0TWFwKSB7CgoJICB2YXIgdHBsID0gSGFuZGxlYmFycy5jb21waWxlOwoJICB2YXIgZm9ybVRwbCA9IHRwbCgnPGZvcm0gbWV0aG9kPSJQT1NUIiBhY3Rpb249Int7YWN0aW9ufX0iPjwvZm9ybT4nKTsKCSAgdmFyIGlucHV0VHBsID0gdHBsKCc8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJ7e25hbWV9fSIgdmFsdWU9Int7dmFsdWV9fSIgLz4nKTsKCgkgIHZhciBVdGlsID0ge307CgoJICB2YXIgamFtbWVyVGVtcGxhdGUgPSB7CgkgICAgJ2Nocm9tZSc6ICc8aW5wdXQgc3R5bGU9Im9wYWNpdHk6IDA7IHdpZHRoOiAwOyBoZWlnaHQ6IDA7IiBpZD0ib2t0YV9oaWRkZW5fdXNlcm5hbWVfY2hyb21lX3NlcXVlbmNlX25vIiBcCgkgICAgICAgICAgICAgICAgdHlwZT0idGV4dCIgYXV0b2NvbXBsZXRlPSJvZmYiIC8+XAoJICAgICAgICAgICAgICAgIDxpbnB1dCBzdHlsZT0ib3BhY2l0eTogMDsgd2lkdGg6IDA7IGhlaWdodDogMDsiIGlkPSJva3RhX2hpZGRlbl9wYXNzX2Nocm9tZV9zZXF1ZW5jZV9ubyJcCgkgICAgICAgICAgICAgICAgdHlwZT0icGFzc3dvcmQiIGF1dG9jb21wbGV0ZT0ib2ZmIiAvPicsCgoJICAgICdzYWZhcmknOiAnPGlucHV0IHN0eWxlPSJvcGFjaXR5OiAwOyB3aWR0aDogMDsgaGVpZ2h0OiAwOyIgaWQ9Im9rdGFfaGlkZGVuX3Bhc3Nfc2FmYXJpX3NlcXVlbmNlX25vIiBcCgkgICAgICAgICAgICAgICAgICB0eXBlPSJwYXNzd29yZCIgYXV0b2NvbXBsZXRlPSJvZmYiIC8+JywKCgkgICAgJ21vemlsbGEnOiAnPGlucHV0IHN0eWxlPSJkaXNwbGF5Om5vbmUiIHR5cGU9InBhc3N3b3JkIiBpZD0ib2t0YV9oaWRkZW5fcGFzc19maXJlZm94X3NlcXVlbmNlX25vIiBcCgkgICAgICAgICAgICAgICAgICBhdXRvY29tcGxldGU9Im9mZiIgdmFsdWU9InRlc3QiIC8+JywKCgkgICAgJ21zaWUnOiAnPGlucHV0IGlkPSJva3RhX2hpZGRlbl9wYXNzX2llX3NlcXVlbmNlX25vIiB0eXBlPSJwYXNzd29yZCIgYXV0b2NvbXBsZXRlPSJvZmYiXAoJICAgICAgICAgICAgICBzdHlsZT0iZGlzcGxheTpub25lIiB2YWx1ZSA9ICJ0ZXN0X3NlcXVlbmNlX25vIi8+JwoJICB9OwoKCSAgdmFyIGNsZWFyQmVlblRvSG9tZVBhZ2UgPSBmdW5jdGlvbiBjbGVhckJlZW5Ub0hvbWVQYWdlKCkgewoJICAgIENvb2tpZS5yZW1vdmVDb29raWUoJ2FvJywgeyBwYXRoOiAnLycgfSk7CgkgIH07CgoJICB2YXIgcmVzZXRBdXRvTGF1bmNoID0gZnVuY3Rpb24gcmVzZXRBdXRvTGF1bmNoKCkgewoJICAgIENvb2tpZS5yZW1vdmVDb29raWUoJ2F1dG9sYXVuY2hfdHJpZ2dlcmVkJywgeyBwYXRoOiAnLycgfSk7CgkgIH07CgoJICB2YXIgaXNQb3N0U2FtbEVtYmVkVXJsID0gZnVuY3Rpb24gaXNQb3N0U2FtbEVtYmVkVXJsKHVybCkgewoJICAgIC8vIEFQUF9TQU1MX0ZPUl9JTlNUQU5DRSBpcyAvYXBwL3thcHB9L3trZXl9L3Nzby9zYW1sCgkgICAgcmV0dXJuIHVybC5zZWFyY2goL1wvYXBwXC9bXi9dK1wvW14vXStcL3Nzb1wvc2FtbC4qXD8vaSkgIT09IC0xOwoJICB9OwoKCSAgLy8gUG9zdHMgdG8gYSBnaXZlbiB1cmwsIGNvbnZlcnRpbmcgYW55IHF1ZXJ5IHBhcmFtcyB0byBwb3N0IHBhcmFtcy4gVGhpcyBpcwoJICAvLyBkb25lIGJ5IGNyZWF0aW5nIGEgZm9ybSBvbiB0aGUgcGFnZSwgcGFyc2luZyB0aGUgcGFyYW1zIGZyb20gdGhlIHVybCwgYW5kCgkgIC8vIHN1Ym1pdHRpbmcgaXQuCgkgIC8vICRlbCBpcyBhbiBlbGVtZW50IHRvIGFwcGVuZCB0aGUgZm9ybSB0by4KCSAgdmFyIHBvc3RUb1VybCA9IGZ1bmN0aW9uIHBvc3RUb1VybCh1cmwsICRlbCkgewoJICAgIHZhciBwYXJ0cyA9IHVybC5zcGxpdCgnPycpLAoJICAgICAgICBiYXNlVXJsID0gcGFydHNbMF0sCgkgICAgICAgIHF1ZXJ5U3RyaW5nID0gcGFydHNbMV0sCgkgICAgICAgIHF1ZXJ5UGFyYW1zLAoJICAgICAgICBmb3JtOwoJICAgIGZvcm0gPSAkKGZvcm1UcGwoeyBhY3Rpb246IGJhc2VVcmwgfSkpOwoJICAgIGlmIChxdWVyeVN0cmluZykgewoJICAgICAgcXVlcnlQYXJhbXMgPSBxdWVyeVN0cmluZy5zcGxpdCgnJicpOwoJICAgICAgJC5lYWNoKHF1ZXJ5UGFyYW1zLCBmdW5jdGlvbiAoaSwgcGFyYW0pIHsKCSAgICAgICAgdmFyIHRva2VucyA9IHBhcmFtLnNwbGl0KCc9Jyk7CgkgICAgICAgIGZvcm0uYXBwZW5kKGlucHV0VHBsKHsKCSAgICAgICAgICBuYW1lOiB0b2tlbnNbMF0sCgkgICAgICAgICAgdmFsdWU6IGRlY29kZVVSSUNvbXBvbmVudCh0b2tlbnNbMV0pCgkgICAgICAgIH0pKTsKCSAgICAgIH0pOwoJICAgIH0KCSAgICAkZWwuYXBwZW5kKGZvcm0pOwoJICAgIGZvcm0uc3VibWl0KCk7CgkgIH07CgoJICB2YXIgYWRkUGFzc3dvcmRKYW1tZXJzID0gZnVuY3Rpb24gYWRkUGFzc3dvcmRKYW1tZXJzKCRlbCkgewoJICAgIHZhciBoaWRkZW5JbnB1dCwgYnJvd3NlciwgdG90YWxSZXBldGl0aW9uczsKCgkgICAgaWYgKCQuYnJvd3Nlci5jaHJvbWUpIHsKCSAgICAgIGhpZGRlbklucHV0ID0gcGFzc3dvcmRKYW1tZXJGYWN0b3J5KCdjaHJvbWUnLCAzKTsKCSAgICAgICRlbC5wcmVwZW5kKGhpZGRlbklucHV0KTsKCSAgICAgIHJldHVybjsKCSAgICB9CgkgICAgaWYgKCQuYnJvd3Nlci5zYWZhcmkpIHsKCSAgICAgIGJyb3dzZXIgPSAnc2FmYXJpJzsKCSAgICAgIHRvdGFsUmVwZXRpdGlvbnMgPSAyOwoJICAgIH0gZWxzZSBpZiAoJC5icm93c2VyLm1vemlsbGEpIHsKCSAgICAgIGJyb3dzZXIgPSAnbW96aWxsYSc7CgkgICAgICB0b3RhbFJlcGV0aXRpb25zID0gMzsKCSAgICB9IGVsc2UgewoJICAgICAgYnJvd3NlciA9ICdtc2llJzsKCSAgICAgIHRvdGFsUmVwZXRpdGlvbnMgPSAyOwoJICAgIH0KCSAgICBoaWRkZW5JbnB1dCA9IHBhc3N3b3JkSmFtbWVyRmFjdG9yeShicm93c2VyLCB0b3RhbFJlcGV0aXRpb25zKTsKCSAgICAkZWwuYXBwZW5kKGhpZGRlbklucHV0KTsKCSAgfTsKCgkgIGZ1bmN0aW9uIHBhc3N3b3JkSmFtbWVyRmFjdG9yeShicm93c2VyLCB0b3RhbFJlcGV0aXRpb25zKSB7CgoJICAgIHZhciBjdXJyZW50VGVtcGxhdGUgPSBqYW1tZXJUZW1wbGF0ZVticm93c2VyXSwKCSAgICAgICAgcmVzdWx0ID0gJycsCgkgICAgICAgIGk7CgoJICAgIGZvciAoaSA9IDA7IGkgPCB0b3RhbFJlcGV0aXRpb25zOyBpKyspIHsKCSAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoY3VycmVudFRlbXBsYXRlLnJlcGxhY2UoL3NlcXVlbmNlX25vL2csIGkgKyAxKSk7CgkgICAgfQoJICAgIHJldHVybiByZXN1bHQ7CgkgIH0KCgkgIC8vIFJld3JpdGVzIHRoZSBkZWZhdWx0IFNpZ24taW4gV2lkZ2V0IGFzc2V0IGJ1bmRsZSBwYXRocyB0byBoYW5kbGUgb3VyCgkgIC8vIGludGVybmFsIGkxOG4ganNvbnAgZmlsZXM6CgkgIC8vIDEuIEFkZCBjYWNoZWJ1c3Qgc2hhCgkgIC8vIDIuIFJlcGxhY2UgLmpzb25wIHdpdGggLmpzCgkgIHZhciBwYXRoUmUgPSBuZXcgUmVnRXhwKCcvKFteL10qKVwuanNvbnAkJyk7CgoJICBmdW5jdGlvbiBhc3NldFJld3JpdGUocGF0aCkgewoJICAgIHZhciBtYXRjaGVzID0gcGF0aFJlLmV4ZWMocGF0aCk7CgkgICAgaWYgKCFtYXRjaGVzIHx8ICFjYWNoZWJ1c3RNYXBbbWF0Y2hlc1sxXV0pIHsKCSAgICAgIHJldHVybiBwYXRoOwoJICAgIH0KCSAgICByZXR1cm4gJy8nICsgY2FjaGVidXN0TWFwW21hdGNoZXNbMV1dICsgJy5qcyc7CgkgIH0KCgkgIC8vIE9LVEEtMTAxNTA5OiBUaGVyZSBhcmUgZW1iZWRkZWQgYnJvd3NlcnMgdGhhdCBoYXZlIHB1c2hTdGF0ZSwgYnV0IHRocm93CgkgIC8vIGFuIGVycm9yIHdoZW4gaXQncyBjYWxsZWQuIFNvLCB3ZSBhY3R1YWxseSBjYWxsIHJlcGxhY2VTdGF0ZSBpbiBhIHRyeS9jYXRjaAoJICAvLyB0byBzZWUgaWYgaXQgaGl0cyB0aGlzIGNvbmRpdGlvbi4KCSAgZnVuY3Rpb24gc3VwcG9ydHNSb3V0ZXIoKSB7CgkgICAgdmFyIHN1cHBvcnRzUHVzaCA9ICEhKHdpbmRvdy5oaXN0b3J5ICYmIHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZSksCgkgICAgICAgIHN1cHBvcnRzUmVwbGFjZSA9IHN1cHBvcnRzUHVzaCAmJiB3aW5kb3cuaGlzdG9yeS5yZXBsYWNlU3RhdGU7CgkgICAgaWYgKCFzdXBwb3J0c1B1c2ggfHwgIXN1cHBvcnRzUmVwbGFjZSkgewoJICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH0KCSAgICB0cnkgewoJICAgICAgd2luZG93Lmhpc3RvcnkucmVwbGFjZVN0YXRlKHt9LCBkb2N1bWVudC50aXRsZSwgbG9jYXRpb24uaHJlZik7CgkgICAgICByZXR1cm4gdHJ1ZTsKCSAgICB9IGNhdGNoIChlKSB7CgkgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfQoJICB9CgoJICAvLyBIYWNrIGZvciBPS1RBLTEwMjIxNyA6IEdpdmVuIGEgYmFzZSB1cmwsIGNyZWF0ZSBhbm90aGVyIGJhc2UgdXJsCgkgIC8vIGJ5IHJlbW92aW5nL2FkZGluZyBwb3J0IG51bWJlciB0aGF0IGlzIGZ1bmN0aW9uYWxseSB0aGUgc2FtZSBidXQgYXZvaWRzIGEgTWljcm9zb2Z0IGRvdWJsZS1yZXF1ZXN0IGJ1Zy4KCSAgZnVuY3Rpb24gYmFzZVVybFdpdGhQb3J0QWRkZWRPclJlbW92ZWQoYmFzZVVybCkgewoKCSAgICB2YXIgYmFzZVVybEhvc3RuYW1lOwoJICAgIHZhciBob3N0bmFtZTsKCSAgICB2YXIgcHJvdG9jb2w7CgkgICAgdmFyIGhvc3RBbmRQYXRoOwoJICAgIHZhciBub1Byb3RvY29sRm91bmQgPSBmYWxzZTsKCgkgICAgLy8gU3BsaXQgb3V0IHByb3RvY29sIGFuZCBob3N0bmFtZQoJICAgIGlmIChiYXNlVXJsLmluZGV4T2YoJzovLycpID4gLTEpIHsKCSAgICAgIHByb3RvY29sID0gYmFzZVVybC5zcGxpdCgnOi8vJylbMF07CgkgICAgICAvLyBzZWNvbmQgaGFsZiBvZiBVUkwgaXMgaG9zdG5hbWUgKyBwYXRoIGNvbXBvbmVudHMKCSAgICAgIGhvc3RBbmRQYXRoID0gYmFzZVVybC5zcGxpdCgnOi8vJylbMV07CgkgICAgICAvLyBmaXJzdCBlbGVtZW50IGlzIGhvc3RuYW1lLCByZXN0IG9mIHRoZW0gYXJlIHBhdGggY29tcG9uZW50cwoJICAgICAgYmFzZVVybEhvc3RuYW1lID0gaG9zdEFuZFBhdGguc3BsaXQoJy8nKVswXTsKCSAgICB9IGVsc2UgewoJICAgICAgbm9Qcm90b2NvbEZvdW5kID0gdHJ1ZTsKCSAgICAgIHByb3RvY29sID0gJ2h0dHBzJzsKCSAgICAgIGJhc2VVcmxIb3N0bmFtZSA9IGJhc2VVcmwuc3BsaXQoJy8nKVswXTsKCSAgICB9CgoJICAgIC8vIElmIHRoZXJlIGlzIGEgcG9ydCBudW1iZXIsIHJlbW92ZSBpdAoJICAgIGlmIChiYXNlVXJsSG9zdG5hbWUuaW5kZXhPZignOicpID4gLTEpIHsKCSAgICAgIHZhciBwb3J0ID0gYmFzZVVybEhvc3RuYW1lLnNwbGl0KCc6JylbMV07CgkgICAgICAvLyBodHRwcyBwb3J0IHdpdGggbm8gcHJvdG9jb2wKCSAgICAgIGlmIChwb3J0ID09ICc0NDMnICYmIG5vUHJvdG9jb2xGb3VuZCkgewoJICAgICAgICBwcm90b2NvbCA9ICdodHRwcyc7CgkgICAgICAgIC8vIHN0YW5kYXJkIHBvcnQsIHNvIHJlbW92ZSBpdAoJICAgICAgfSBlbHNlIGlmIChwb3J0ID09PSAnODAnIHx8IHBvcnQgPT09ICc0NDMnKSB7CgkgICAgICAgIGhvc3RuYW1lID0gYmFzZVVybEhvc3RuYW1lLnNwbGl0KCc6JylbMF07CgkgICAgICAgIC8vIE5vbi1zdGFuZGFyZCBwb3J0IGVnIGZvciByYWluLCBzbyBsZWF2ZSBpdCBiZQoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgcmV0dXJuIGJhc2VVcmw7CgkgICAgICB9CgkgICAgfSBlbHNlIHsKCSAgICAgIC8vIElmIHRoZXJlIGlzIG5vIHBvcnQgbnVtYmVyLCBhZGQgb25lCgkgICAgICBpZiAocHJvdG9jb2wgPT09ICdodHRwcycpIHsKCSAgICAgICAgaG9zdG5hbWUgPSBiYXNlVXJsSG9zdG5hbWUgKyAnOjQ0Myc7CgkgICAgICB9IGVsc2UgewoJICAgICAgICBob3N0bmFtZSA9IGJhc2VVcmxIb3N0bmFtZSArICc6ODAnOwoJICAgICAgfQoJICAgIH0KCgkgICAgcmV0dXJuIHByb3RvY29sICsgJzovLycgKyBob3N0bmFtZTsKCSAgfQoKCSAgZnVuY3Rpb24gdXNlckFnZW50SXNJb3MxMCh1c2VyQWdlbnQpIHsKCSAgICByZXR1cm4gdXNlckFnZW50LmluZGV4T2YoJ0FwcGxlV2ViS2l0JykgPiAtMSAmJiB1c2VyQWdlbnQuaW5kZXhPZignTW9iaWxlJykgPiAtMSAmJiB1c2VyQWdlbnQuaW5kZXhPZignMTBfJykgPiAtMTsKCSAgfQoKCSAgLy8gQm9ycm93ZWQgZnJvbSBva3RhLWF1dGgtanMKCSAgZnVuY3Rpb24gdG9RdWVyeVBhcmFtcyhvYmopIHsKCSAgICB2YXIgc3RyID0gW107CgoJICAgIGlmIChvYmogPT09IG51bGwpIHsKCSAgICAgIHJldHVybiAnJzsKCSAgICB9CgkgICAgZm9yICh2YXIga2V5IGluIG9iaikgewoJICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIG9ialtrZXldICE9PSB1bmRlZmluZWQgJiYgb2JqW2tleV0gIT09IG51bGwpIHsKCSAgICAgICAgc3RyLnB1c2goa2V5ICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG9ialtrZXldKSk7CgkgICAgICB9CgkgICAgfQoKCSAgICBpZiAoc3RyLmxlbmd0aCkgewoJICAgICAgcmV0dXJuICc/JyArIHN0ci5qb2luKCcmJyk7CgkgICAgfSBlbHNlIHsKCSAgICAgIHJldHVybiAnJzsKCSAgICB9CgkgIH0KCgkgIGZ1bmN0aW9uIGFkanVzdFVybFBhdGgocmVkaXJlY1VybCkgewoJICAgIHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZSgnJywgZG9jdW1lbnQudGl0bGUsIHJlZGlyZWNVcmwpOwoJICB9CgoJICBmdW5jdGlvbiBpc0xvZ2luVXJsU3RhbGUobG9naW5QYWdlVXJsUmVkaXJlY3QsIGhyZWYpIHsKCSAgICByZXR1cm4gISEobG9naW5QYWdlVXJsUmVkaXJlY3QgJiYgbG9naW5QYWdlVXJsUmVkaXJlY3QgIT09IGhyZWYpOwoJICB9CgoJICBVdGlsID0gewoJICAgIGNsZWFyQmVlblRvSG9tZVBhZ2U6IGNsZWFyQmVlblRvSG9tZVBhZ2UsCgkgICAgcmVzZXRBdXRvTGF1bmNoOiByZXNldEF1dG9MYXVuY2gsCgkgICAgaXNQb3N0U2FtbEVtYmVkVXJsOiBpc1Bvc3RTYW1sRW1iZWRVcmwsCgkgICAgcG9zdFRvVXJsOiBwb3N0VG9VcmwsCgkgICAgYWRkUGFzc3dvcmRKYW1tZXJzOiBhZGRQYXNzd29yZEphbW1lcnMsCgkgICAgYXNzZXRSZXdyaXRlOiBhc3NldFJld3JpdGUsCgkgICAgc3VwcG9ydHNSb3V0ZXI6IHN1cHBvcnRzUm91dGVyLAoJICAgIGJhc2VVcmxXaXRoUG9ydEFkZGVkT3JSZW1vdmVkOiBiYXNlVXJsV2l0aFBvcnRBZGRlZE9yUmVtb3ZlZCwKCSAgICB1c2VyQWdlbnRJc0lvczEwOiB1c2VyQWdlbnRJc0lvczEwLAoJICAgIHRvUXVlcnlQYXJhbXM6IHRvUXVlcnlQYXJhbXMsCgkgICAgYWRqdXN0VXJsUGF0aDogYWRqdXN0VXJsUGF0aCwKCSAgICBpc0xvZ2luVXJsU3RhbGU6IGlzTG9naW5VcmxTdGFsZQoJICB9OwoKCSAgcmV0dXJuIFV0aWw7Cgl9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7CgovKioqLyB9LAovKiA0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsvKiEKCSAqIGpRdWVyeSBKYXZhU2NyaXB0IExpYnJhcnkgdjEuMTEuMwoJICogaHR0cDovL2pxdWVyeS5jb20vCgkgKgoJICogSW5jbHVkZXMgU2l6emxlLmpzCgkgKiBodHRwOi8vc2l6emxlanMuY29tLwoJICoKCSAqIENvcHlyaWdodCAyMDA1LCAyMDE0IGpRdWVyeSBGb3VuZGF0aW9uLCBJbmMuIGFuZCBvdGhlciBjb250cmlidXRvcnMKCSAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZQoJICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQoJICoKCSAqIERhdGU6IDIwMTUtMDQtMjhUMTY6MTlaCgkgKi8KCgkoZnVuY3Rpb24oIGdsb2JhbCwgZmFjdG9yeSApIHsKCgkJaWYgKCB0eXBlb2YgbW9kdWxlID09PSAib2JqZWN0IiAmJiB0eXBlb2YgbW9kdWxlLmV4cG9ydHMgPT09ICJvYmplY3QiICkgewoJCQkvLyBGb3IgQ29tbW9uSlMgYW5kIENvbW1vbkpTLWxpa2UgZW52aXJvbm1lbnRzIHdoZXJlIGEgcHJvcGVyIHdpbmRvdyBpcyBwcmVzZW50LAoJCQkvLyBleGVjdXRlIHRoZSBmYWN0b3J5IGFuZCBnZXQgalF1ZXJ5CgkJCS8vIEZvciBlbnZpcm9ubWVudHMgdGhhdCBkbyBub3QgaW5oZXJlbnRseSBwb3NzZXMgYSB3aW5kb3cgd2l0aCBhIGRvY3VtZW50CgkJCS8vIChzdWNoIGFzIE5vZGUuanMpLCBleHBvc2UgYSBqUXVlcnktbWFraW5nIGZhY3RvcnkgYXMgbW9kdWxlLmV4cG9ydHMKCQkJLy8gVGhpcyBhY2NlbnR1YXRlcyB0aGUgbmVlZCBmb3IgdGhlIGNyZWF0aW9uIG9mIGEgcmVhbCB3aW5kb3cKCQkJLy8gZS5nLiB2YXIgalF1ZXJ5ID0gcmVxdWlyZSgianF1ZXJ5Iikod2luZG93KTsKCQkJLy8gU2VlIHRpY2tldCAjMTQ1NDkgZm9yIG1vcmUgaW5mbwoJCQltb2R1bGUuZXhwb3J0cyA9IGdsb2JhbC5kb2N1bWVudCA/CgkJCQlmYWN0b3J5KCBnbG9iYWwsIHRydWUgKSA6CgkJCQlmdW5jdGlvbiggdyApIHsKCQkJCQlpZiAoICF3LmRvY3VtZW50ICkgewoJCQkJCQl0aHJvdyBuZXcgRXJyb3IoICJqUXVlcnkgcmVxdWlyZXMgYSB3aW5kb3cgd2l0aCBhIGRvY3VtZW50IiApOwoJCQkJCX0KCQkJCQlyZXR1cm4gZmFjdG9yeSggdyApOwoJCQkJfTsKCQl9IGVsc2UgewoJCQlmYWN0b3J5KCBnbG9iYWwgKTsKCQl9CgoJLy8gUGFzcyB0aGlzIGlmIHdpbmRvdyBpcyBub3QgZGVmaW5lZCB5ZXQKCX0odHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgPyB3aW5kb3cgOiB0aGlzLCBmdW5jdGlvbiggd2luZG93LCBub0dsb2JhbCApIHsKCgkvLyBDYW4ndCBkbyB0aGlzIGJlY2F1c2Ugc2V2ZXJhbCBhcHBzIGluY2x1ZGluZyBBU1AuTkVUIHRyYWNlCgkvLyB0aGUgc3RhY2sgdmlhIGFyZ3VtZW50cy5jYWxsZXIuY2FsbGVlIGFuZCBGaXJlZm94IGRpZXMgaWYKCS8vIHlvdSB0cnkgdG8gdHJhY2UgdGhyb3VnaCAidXNlIHN0cmljdCIgY2FsbCBjaGFpbnMuICgjMTMzMzUpCgkvLyBTdXBwb3J0OiBGaXJlZm94IDE4KwoJLy8KCgl2YXIgZGVsZXRlZElkcyA9IFtdOwoKCXZhciBzbGljZSA9IGRlbGV0ZWRJZHMuc2xpY2U7CgoJdmFyIGNvbmNhdCA9IGRlbGV0ZWRJZHMuY29uY2F0OwoKCXZhciBwdXNoID0gZGVsZXRlZElkcy5wdXNoOwoKCXZhciBpbmRleE9mID0gZGVsZXRlZElkcy5pbmRleE9mOwoKCXZhciBjbGFzczJ0eXBlID0ge307CgoJdmFyIHRvU3RyaW5nID0gY2xhc3MydHlwZS50b1N0cmluZzsKCgl2YXIgaGFzT3duID0gY2xhc3MydHlwZS5oYXNPd25Qcm9wZXJ0eTsKCgl2YXIgc3VwcG9ydCA9IHt9OwoKCgoJdmFyCgkJdmVyc2lvbiA9ICIxLjExLjMiLAoKCQkvLyBEZWZpbmUgYSBsb2NhbCBjb3B5IG9mIGpRdWVyeQoJCWpRdWVyeSA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCApIHsKCQkJLy8gVGhlIGpRdWVyeSBvYmplY3QgaXMgYWN0dWFsbHkganVzdCB0aGUgaW5pdCBjb25zdHJ1Y3RvciAnZW5oYW5jZWQnCgkJCS8vIE5lZWQgaW5pdCBpZiBqUXVlcnkgaXMgY2FsbGVkIChqdXN0IGFsbG93IGVycm9yIHRvIGJlIHRocm93biBpZiBub3QgaW5jbHVkZWQpCgkJCXJldHVybiBuZXcgalF1ZXJ5LmZuLmluaXQoIHNlbGVjdG9yLCBjb250ZXh0ICk7CgkJfSwKCgkJLy8gU3VwcG9ydDogQW5kcm9pZDw0LjEsIElFPDkKCQkvLyBNYWtlIHN1cmUgd2UgdHJpbSBCT00gYW5kIE5CU1AKCQlydHJpbSA9IC9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZywKCgkJLy8gTWF0Y2hlcyBkYXNoZWQgc3RyaW5nIGZvciBjYW1lbGl6aW5nCgkJcm1zUHJlZml4ID0gL14tbXMtLywKCQlyZGFzaEFscGhhID0gLy0oW1xkYS16XSkvZ2ksCgoJCS8vIFVzZWQgYnkgalF1ZXJ5LmNhbWVsQ2FzZSBhcyBjYWxsYmFjayB0byByZXBsYWNlKCkKCQlmY2FtZWxDYXNlID0gZnVuY3Rpb24oIGFsbCwgbGV0dGVyICkgewoJCQlyZXR1cm4gbGV0dGVyLnRvVXBwZXJDYXNlKCk7CgkJfTsKCglqUXVlcnkuZm4gPSBqUXVlcnkucHJvdG90eXBlID0gewoJCS8vIFRoZSBjdXJyZW50IHZlcnNpb24gb2YgalF1ZXJ5IGJlaW5nIHVzZWQKCQlqcXVlcnk6IHZlcnNpb24sCgoJCWNvbnN0cnVjdG9yOiBqUXVlcnksCgoJCS8vIFN0YXJ0IHdpdGggYW4gZW1wdHkgc2VsZWN0b3IKCQlzZWxlY3RvcjogIiIsCgoJCS8vIFRoZSBkZWZhdWx0IGxlbmd0aCBvZiBhIGpRdWVyeSBvYmplY3QgaXMgMAoJCWxlbmd0aDogMCwKCgkJdG9BcnJheTogZnVuY3Rpb24oKSB7CgkJCXJldHVybiBzbGljZS5jYWxsKCB0aGlzICk7CgkJfSwKCgkJLy8gR2V0IHRoZSBOdGggZWxlbWVudCBpbiB0aGUgbWF0Y2hlZCBlbGVtZW50IHNldCBPUgoJCS8vIEdldCB0aGUgd2hvbGUgbWF0Y2hlZCBlbGVtZW50IHNldCBhcyBhIGNsZWFuIGFycmF5CgkJZ2V0OiBmdW5jdGlvbiggbnVtICkgewoJCQlyZXR1cm4gbnVtICE9IG51bGwgPwoKCQkJCS8vIFJldHVybiBqdXN0IHRoZSBvbmUgZWxlbWVudCBmcm9tIHRoZSBzZXQKCQkJCSggbnVtIDwgMCA/IHRoaXNbIG51bSArIHRoaXMubGVuZ3RoIF0gOiB0aGlzWyBudW0gXSApIDoKCgkJCQkvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyBpbiBhIGNsZWFuIGFycmF5CgkJCQlzbGljZS5jYWxsKCB0aGlzICk7CgkJfSwKCgkJLy8gVGFrZSBhbiBhcnJheSBvZiBlbGVtZW50cyBhbmQgcHVzaCBpdCBvbnRvIHRoZSBzdGFjawoJCS8vIChyZXR1cm5pbmcgdGhlIG5ldyBtYXRjaGVkIGVsZW1lbnQgc2V0KQoJCXB1c2hTdGFjazogZnVuY3Rpb24oIGVsZW1zICkgewoKCQkJLy8gQnVpbGQgYSBuZXcgalF1ZXJ5IG1hdGNoZWQgZWxlbWVudCBzZXQKCQkJdmFyIHJldCA9IGpRdWVyeS5tZXJnZSggdGhpcy5jb25zdHJ1Y3RvcigpLCBlbGVtcyApOwoKCQkJLy8gQWRkIHRoZSBvbGQgb2JqZWN0IG9udG8gdGhlIHN0YWNrIChhcyBhIHJlZmVyZW5jZSkKCQkJcmV0LnByZXZPYmplY3QgPSB0aGlzOwoJCQlyZXQuY29udGV4dCA9IHRoaXMuY29udGV4dDsKCgkJCS8vIFJldHVybiB0aGUgbmV3bHktZm9ybWVkIGVsZW1lbnQgc2V0CgkJCXJldHVybiByZXQ7CgkJfSwKCgkJLy8gRXhlY3V0ZSBhIGNhbGxiYWNrIGZvciBldmVyeSBlbGVtZW50IGluIHRoZSBtYXRjaGVkIHNldC4KCQkvLyAoWW91IGNhbiBzZWVkIHRoZSBhcmd1bWVudHMgd2l0aCBhbiBhcnJheSBvZiBhcmdzLCBidXQgdGhpcyBpcwoJCS8vIG9ubHkgdXNlZCBpbnRlcm5hbGx5LikKCQllYWNoOiBmdW5jdGlvbiggY2FsbGJhY2ssIGFyZ3MgKSB7CgkJCXJldHVybiBqUXVlcnkuZWFjaCggdGhpcywgY2FsbGJhY2ssIGFyZ3MgKTsKCQl9LAoKCQltYXA6IGZ1bmN0aW9uKCBjYWxsYmFjayApIHsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqUXVlcnkubWFwKHRoaXMsIGZ1bmN0aW9uKCBlbGVtLCBpICkgewoJCQkJcmV0dXJuIGNhbGxiYWNrLmNhbGwoIGVsZW0sIGksIGVsZW0gKTsKCQkJfSkpOwoJCX0sCgoJCXNsaWNlOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBzbGljZS5hcHBseSggdGhpcywgYXJndW1lbnRzICkgKTsKCQl9LAoKCQlmaXJzdDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLmVxKCAwICk7CgkJfSwKCgkJbGFzdDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLmVxKCAtMSApOwoJCX0sCgoJCWVxOiBmdW5jdGlvbiggaSApIHsKCQkJdmFyIGxlbiA9IHRoaXMubGVuZ3RoLAoJCQkJaiA9ICtpICsgKCBpIDwgMCA/IGxlbiA6IDAgKTsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqID49IDAgJiYgaiA8IGxlbiA/IFsgdGhpc1tqXSBdIDogW10gKTsKCQl9LAoKCQllbmQ6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gdGhpcy5wcmV2T2JqZWN0IHx8IHRoaXMuY29uc3RydWN0b3IobnVsbCk7CgkJfSwKCgkJLy8gRm9yIGludGVybmFsIHVzZSBvbmx5LgoJCS8vIEJlaGF2ZXMgbGlrZSBhbiBBcnJheSdzIG1ldGhvZCwgbm90IGxpa2UgYSBqUXVlcnkgbWV0aG9kLgoJCXB1c2g6IHB1c2gsCgkJc29ydDogZGVsZXRlZElkcy5zb3J0LAoJCXNwbGljZTogZGVsZXRlZElkcy5zcGxpY2UKCX07CgoJalF1ZXJ5LmV4dGVuZCA9IGpRdWVyeS5mbi5leHRlbmQgPSBmdW5jdGlvbigpIHsKCQl2YXIgc3JjLCBjb3B5SXNBcnJheSwgY29weSwgbmFtZSwgb3B0aW9ucywgY2xvbmUsCgkJCXRhcmdldCA9IGFyZ3VtZW50c1swXSB8fCB7fSwKCQkJaSA9IDEsCgkJCWxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsCgkJCWRlZXAgPSBmYWxzZTsKCgkJLy8gSGFuZGxlIGEgZGVlcCBjb3B5IHNpdHVhdGlvbgoJCWlmICggdHlwZW9mIHRhcmdldCA9PT0gImJvb2xlYW4iICkgewoJCQlkZWVwID0gdGFyZ2V0OwoKCQkJLy8gc2tpcCB0aGUgYm9vbGVhbiBhbmQgdGhlIHRhcmdldAoJCQl0YXJnZXQgPSBhcmd1bWVudHNbIGkgXSB8fCB7fTsKCQkJaSsrOwoJCX0KCgkJLy8gSGFuZGxlIGNhc2Ugd2hlbiB0YXJnZXQgaXMgYSBzdHJpbmcgb3Igc29tZXRoaW5nIChwb3NzaWJsZSBpbiBkZWVwIGNvcHkpCgkJaWYgKCB0eXBlb2YgdGFyZ2V0ICE9PSAib2JqZWN0IiAmJiAhalF1ZXJ5LmlzRnVuY3Rpb24odGFyZ2V0KSApIHsKCQkJdGFyZ2V0ID0ge307CgkJfQoKCQkvLyBleHRlbmQgalF1ZXJ5IGl0c2VsZiBpZiBvbmx5IG9uZSBhcmd1bWVudCBpcyBwYXNzZWQKCQlpZiAoIGkgPT09IGxlbmd0aCApIHsKCQkJdGFyZ2V0ID0gdGhpczsKCQkJaS0tOwoJCX0KCgkJZm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCS8vIE9ubHkgZGVhbCB3aXRoIG5vbi1udWxsL3VuZGVmaW5lZCB2YWx1ZXMKCQkJaWYgKCAob3B0aW9ucyA9IGFyZ3VtZW50c1sgaSBdKSAhPSBudWxsICkgewoJCQkJLy8gRXh0ZW5kIHRoZSBiYXNlIG9iamVjdAoJCQkJZm9yICggbmFtZSBpbiBvcHRpb25zICkgewoJCQkJCXNyYyA9IHRhcmdldFsgbmFtZSBdOwoJCQkJCWNvcHkgPSBvcHRpb25zWyBuYW1lIF07CgoJCQkJCS8vIFByZXZlbnQgbmV2ZXItZW5kaW5nIGxvb3AKCQkJCQlpZiAoIHRhcmdldCA9PT0gY29weSApIHsKCQkJCQkJY29udGludWU7CgkJCQkJfQoKCQkJCQkvLyBSZWN1cnNlIGlmIHdlJ3JlIG1lcmdpbmcgcGxhaW4gb2JqZWN0cyBvciBhcnJheXMKCQkJCQlpZiAoIGRlZXAgJiYgY29weSAmJiAoIGpRdWVyeS5pc1BsYWluT2JqZWN0KGNvcHkpIHx8IChjb3B5SXNBcnJheSA9IGpRdWVyeS5pc0FycmF5KGNvcHkpKSApICkgewoJCQkJCQlpZiAoIGNvcHlJc0FycmF5ICkgewoJCQkJCQkJY29weUlzQXJyYXkgPSBmYWxzZTsKCQkJCQkJCWNsb25lID0gc3JjICYmIGpRdWVyeS5pc0FycmF5KHNyYykgPyBzcmMgOiBbXTsKCgkJCQkJCX0gZWxzZSB7CgkJCQkJCQljbG9uZSA9IHNyYyAmJiBqUXVlcnkuaXNQbGFpbk9iamVjdChzcmMpID8gc3JjIDoge307CgkJCQkJCX0KCgkJCQkJCS8vIE5ldmVyIG1vdmUgb3JpZ2luYWwgb2JqZWN0cywgY2xvbmUgdGhlbQoJCQkJCQl0YXJnZXRbIG5hbWUgXSA9IGpRdWVyeS5leHRlbmQoIGRlZXAsIGNsb25lLCBjb3B5ICk7CgoJCQkJCS8vIERvbid0IGJyaW5nIGluIHVuZGVmaW5lZCB2YWx1ZXMKCQkJCQl9IGVsc2UgaWYgKCBjb3B5ICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJCXRhcmdldFsgbmFtZSBdID0gY29weTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCS8vIFJldHVybiB0aGUgbW9kaWZpZWQgb2JqZWN0CgkJcmV0dXJuIHRhcmdldDsKCX07CgoJalF1ZXJ5LmV4dGVuZCh7CgkJLy8gVW5pcXVlIGZvciBlYWNoIGNvcHkgb2YgalF1ZXJ5IG9uIHRoZSBwYWdlCgkJZXhwYW5kbzogImpRdWVyeSIgKyAoIHZlcnNpb24gKyBNYXRoLnJhbmRvbSgpICkucmVwbGFjZSggL1xEL2csICIiICksCgoJCS8vIEFzc3VtZSBqUXVlcnkgaXMgcmVhZHkgd2l0aG91dCB0aGUgcmVhZHkgbW9kdWxlCgkJaXNSZWFkeTogdHJ1ZSwKCgkJZXJyb3I6IGZ1bmN0aW9uKCBtc2cgKSB7CgkJCXRocm93IG5ldyBFcnJvciggbXNnICk7CgkJfSwKCgkJbm9vcDogZnVuY3Rpb24oKSB7fSwKCgkJLy8gU2VlIHRlc3QvdW5pdC9jb3JlLmpzIGZvciBkZXRhaWxzIGNvbmNlcm5pbmcgaXNGdW5jdGlvbi4KCQkvLyBTaW5jZSB2ZXJzaW9uIDEuMywgRE9NIG1ldGhvZHMgYW5kIGZ1bmN0aW9ucyBsaWtlIGFsZXJ0CgkJLy8gYXJlbid0IHN1cHBvcnRlZC4gVGhleSByZXR1cm4gZmFsc2Ugb24gSUUgKCMyOTY4KS4KCQlpc0Z1bmN0aW9uOiBmdW5jdGlvbiggb2JqICkgewoJCQlyZXR1cm4galF1ZXJ5LnR5cGUob2JqKSA9PT0gImZ1bmN0aW9uIjsKCQl9LAoKCQlpc0FycmF5OiBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uKCBvYmogKSB7CgkJCXJldHVybiBqUXVlcnkudHlwZShvYmopID09PSAiYXJyYXkiOwoJCX0sCgoJCWlzV2luZG93OiBmdW5jdGlvbiggb2JqICkgewoJCQkvKiBqc2hpbnQgZXFlcWVxOiBmYWxzZSAqLwoJCQlyZXR1cm4gb2JqICE9IG51bGwgJiYgb2JqID09IG9iai53aW5kb3c7CgkJfSwKCgkJaXNOdW1lcmljOiBmdW5jdGlvbiggb2JqICkgewoJCQkvLyBwYXJzZUZsb2F0IE5hTnMgbnVtZXJpYy1jYXN0IGZhbHNlIHBvc2l0aXZlcyAobnVsbHx0cnVlfGZhbHNlfCIiKQoJCQkvLyAuLi5idXQgbWlzaW50ZXJwcmV0cyBsZWFkaW5nLW51bWJlciBzdHJpbmdzLCBwYXJ0aWN1bGFybHkgaGV4IGxpdGVyYWxzICgiMHguLi4iKQoJCQkvLyBzdWJ0cmFjdGlvbiBmb3JjZXMgaW5maW5pdGllcyB0byBOYU4KCQkJLy8gYWRkaW5nIDEgY29ycmVjdHMgbG9zcyBvZiBwcmVjaXNpb24gZnJvbSBwYXJzZUZsb2F0ICgjMTUxMDApCgkJCXJldHVybiAhalF1ZXJ5LmlzQXJyYXkoIG9iaiApICYmIChvYmogLSBwYXJzZUZsb2F0KCBvYmogKSArIDEpID49IDA7CgkJfSwKCgkJaXNFbXB0eU9iamVjdDogZnVuY3Rpb24oIG9iaiApIHsKCQkJdmFyIG5hbWU7CgkJCWZvciAoIG5hbWUgaW4gb2JqICkgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJCXJldHVybiB0cnVlOwoJCX0sCgoJCWlzUGxhaW5PYmplY3Q6IGZ1bmN0aW9uKCBvYmogKSB7CgkJCXZhciBrZXk7CgoJCQkvLyBNdXN0IGJlIGFuIE9iamVjdC4KCQkJLy8gQmVjYXVzZSBvZiBJRSwgd2UgYWxzbyBoYXZlIHRvIGNoZWNrIHRoZSBwcmVzZW5jZSBvZiB0aGUgY29uc3RydWN0b3IgcHJvcGVydHkuCgkJCS8vIE1ha2Ugc3VyZSB0aGF0IERPTSBub2RlcyBhbmQgd2luZG93IG9iamVjdHMgZG9uJ3QgcGFzcyB0aHJvdWdoLCBhcyB3ZWxsCgkJCWlmICggIW9iaiB8fCBqUXVlcnkudHlwZShvYmopICE9PSAib2JqZWN0IiB8fCBvYmoubm9kZVR5cGUgfHwgalF1ZXJ5LmlzV2luZG93KCBvYmogKSApIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoKCQkJdHJ5IHsKCQkJCS8vIE5vdCBvd24gY29uc3RydWN0b3IgcHJvcGVydHkgbXVzdCBiZSBPYmplY3QKCQkJCWlmICggb2JqLmNvbnN0cnVjdG9yICYmCgkJCQkJIWhhc093bi5jYWxsKG9iaiwgImNvbnN0cnVjdG9yIikgJiYKCQkJCQkhaGFzT3duLmNhbGwob2JqLmNvbnN0cnVjdG9yLnByb3RvdHlwZSwgImlzUHJvdG90eXBlT2YiKSApIHsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCX0gY2F0Y2ggKCBlICkgewoJCQkJLy8gSUU4LDkgV2lsbCB0aHJvdyBleGNlcHRpb25zIG9uIGNlcnRhaW4gaG9zdCBvYmplY3RzICM5ODk3CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCgkJCS8vIFN1cHBvcnQ6IElFPDkKCQkJLy8gSGFuZGxlIGl0ZXJhdGlvbiBvdmVyIGluaGVyaXRlZCBwcm9wZXJ0aWVzIGJlZm9yZSBvd24gcHJvcGVydGllcy4KCQkJaWYgKCBzdXBwb3J0Lm93bkxhc3QgKSB7CgkJCQlmb3IgKCBrZXkgaW4gb2JqICkgewoJCQkJCXJldHVybiBoYXNPd24uY2FsbCggb2JqLCBrZXkgKTsKCQkJCX0KCQkJfQoKCQkJLy8gT3duIHByb3BlcnRpZXMgYXJlIGVudW1lcmF0ZWQgZmlyc3RseSwgc28gdG8gc3BlZWQgdXAsCgkJCS8vIGlmIGxhc3Qgb25lIGlzIG93biwgdGhlbiBhbGwgcHJvcGVydGllcyBhcmUgb3duLgoJCQlmb3IgKCBrZXkgaW4gb2JqICkge30KCgkJCXJldHVybiBrZXkgPT09IHVuZGVmaW5lZCB8fCBoYXNPd24uY2FsbCggb2JqLCBrZXkgKTsKCQl9LAoKCQl0eXBlOiBmdW5jdGlvbiggb2JqICkgewoJCQlpZiAoIG9iaiA9PSBudWxsICkgewoJCQkJcmV0dXJuIG9iaiArICIiOwoJCQl9CgkJCXJldHVybiB0eXBlb2Ygb2JqID09PSAib2JqZWN0IiB8fCB0eXBlb2Ygb2JqID09PSAiZnVuY3Rpb24iID8KCQkJCWNsYXNzMnR5cGVbIHRvU3RyaW5nLmNhbGwob2JqKSBdIHx8ICJvYmplY3QiIDoKCQkJCXR5cGVvZiBvYmo7CgkJfSwKCgkJLy8gRXZhbHVhdGVzIGEgc2NyaXB0IGluIGEgZ2xvYmFsIGNvbnRleHQKCQkvLyBXb3JrYXJvdW5kcyBiYXNlZCBvbiBmaW5kaW5ncyBieSBKaW0gRHJpc2NvbGwKCQkvLyBodHRwOi8vd2VibG9ncy5qYXZhLm5ldC9ibG9nL2RyaXNjb2xsL2FyY2hpdmUvMjAwOS8wOS8wOC9ldmFsLWphdmFzY3JpcHQtZ2xvYmFsLWNvbnRleHQKCQlnbG9iYWxFdmFsOiBmdW5jdGlvbiggZGF0YSApIHsKCQkJaWYgKCBkYXRhICYmIGpRdWVyeS50cmltKCBkYXRhICkgKSB7CgkJCQkvLyBXZSB1c2UgZXhlY1NjcmlwdCBvbiBJbnRlcm5ldCBFeHBsb3JlcgoJCQkJLy8gV2UgdXNlIGFuIGFub255bW91cyBmdW5jdGlvbiBzbyB0aGF0IGNvbnRleHQgaXMgd2luZG93CgkJCQkvLyByYXRoZXIgdGhhbiBqUXVlcnkgaW4gRmlyZWZveAoJCQkJKCB3aW5kb3cuZXhlY1NjcmlwdCB8fCBmdW5jdGlvbiggZGF0YSApIHsKCQkJCQl3aW5kb3dbICJldmFsIiBdLmNhbGwoIHdpbmRvdywgZGF0YSApOwoJCQkJfSApKCBkYXRhICk7CgkJCX0KCQl9LAoKCQkvLyBDb252ZXJ0IGRhc2hlZCB0byBjYW1lbENhc2U7IHVzZWQgYnkgdGhlIGNzcyBhbmQgZGF0YSBtb2R1bGVzCgkJLy8gTWljcm9zb2Z0IGZvcmdvdCB0byBodW1wIHRoZWlyIHZlbmRvciBwcmVmaXggKCM5NTcyKQoJCWNhbWVsQ2FzZTogZnVuY3Rpb24oIHN0cmluZyApIHsKCQkJcmV0dXJuIHN0cmluZy5yZXBsYWNlKCBybXNQcmVmaXgsICJtcy0iICkucmVwbGFjZSggcmRhc2hBbHBoYSwgZmNhbWVsQ2FzZSApOwoJCX0sCgoJCW5vZGVOYW1lOiBmdW5jdGlvbiggZWxlbSwgbmFtZSApIHsKCQkJcmV0dXJuIGVsZW0ubm9kZU5hbWUgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBuYW1lLnRvTG93ZXJDYXNlKCk7CgkJfSwKCgkJLy8gYXJncyBpcyBmb3IgaW50ZXJuYWwgdXNhZ2Ugb25seQoJCWVhY2g6IGZ1bmN0aW9uKCBvYmosIGNhbGxiYWNrLCBhcmdzICkgewoJCQl2YXIgdmFsdWUsCgkJCQlpID0gMCwKCQkJCWxlbmd0aCA9IG9iai5sZW5ndGgsCgkJCQlpc0FycmF5ID0gaXNBcnJheWxpa2UoIG9iaiApOwoKCQkJaWYgKCBhcmdzICkgewoJCQkJaWYgKCBpc0FycmF5ICkgewoJCQkJCWZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkgewoJCQkJCQl2YWx1ZSA9IGNhbGxiYWNrLmFwcGx5KCBvYmpbIGkgXSwgYXJncyApOwoKCQkJCQkJaWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7CgkJCQkJCQlicmVhazsKCQkJCQkJfQoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJZm9yICggaSBpbiBvYmogKSB7CgkJCQkJCXZhbHVlID0gY2FsbGJhY2suYXBwbHkoIG9ialsgaSBdLCBhcmdzICk7CgoJCQkJCQlpZiAoIHZhbHVlID09PSBmYWxzZSApIHsKCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJLy8gQSBzcGVjaWFsLCBmYXN0LCBjYXNlIGZvciB0aGUgbW9zdCBjb21tb24gdXNlIG9mIGVhY2gKCQkJfSBlbHNlIHsKCQkJCWlmICggaXNBcnJheSApIHsKCQkJCQlmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHsKCQkJCQkJdmFsdWUgPSBjYWxsYmFjay5jYWxsKCBvYmpbIGkgXSwgaSwgb2JqWyBpIF0gKTsKCgkJCQkJCWlmICggdmFsdWUgPT09IGZhbHNlICkgewoJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCWZvciAoIGkgaW4gb2JqICkgewoJCQkJCQl2YWx1ZSA9IGNhbGxiYWNrLmNhbGwoIG9ialsgaSBdLCBpLCBvYmpbIGkgXSApOwoKCQkJCQkJaWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7CgkJCQkJCQlicmVhazsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIG9iajsKCQl9LAoKCQkvLyBTdXBwb3J0OiBBbmRyb2lkPDQuMSwgSUU8OQoJCXRyaW06IGZ1bmN0aW9uKCB0ZXh0ICkgewoJCQlyZXR1cm4gdGV4dCA9PSBudWxsID8KCQkJCSIiIDoKCQkJCSggdGV4dCArICIiICkucmVwbGFjZSggcnRyaW0sICIiICk7CgkJfSwKCgkJLy8gcmVzdWx0cyBpcyBmb3IgaW50ZXJuYWwgdXNhZ2Ugb25seQoJCW1ha2VBcnJheTogZnVuY3Rpb24oIGFyciwgcmVzdWx0cyApIHsKCQkJdmFyIHJldCA9IHJlc3VsdHMgfHwgW107CgoJCQlpZiAoIGFyciAhPSBudWxsICkgewoJCQkJaWYgKCBpc0FycmF5bGlrZSggT2JqZWN0KGFycikgKSApIHsKCQkJCQlqUXVlcnkubWVyZ2UoIHJldCwKCQkJCQkJdHlwZW9mIGFyciA9PT0gInN0cmluZyIgPwoJCQkJCQlbIGFyciBdIDogYXJyCgkJCQkJKTsKCQkJCX0gZWxzZSB7CgkJCQkJcHVzaC5jYWxsKCByZXQsIGFyciApOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gcmV0OwoJCX0sCgoJCWluQXJyYXk6IGZ1bmN0aW9uKCBlbGVtLCBhcnIsIGkgKSB7CgkJCXZhciBsZW47CgoJCQlpZiAoIGFyciApIHsKCQkJCWlmICggaW5kZXhPZiApIHsKCQkJCQlyZXR1cm4gaW5kZXhPZi5jYWxsKCBhcnIsIGVsZW0sIGkgKTsKCQkJCX0KCgkJCQlsZW4gPSBhcnIubGVuZ3RoOwoJCQkJaSA9IGkgPyBpIDwgMCA/IE1hdGgubWF4KCAwLCBsZW4gKyBpICkgOiBpIDogMDsKCgkJCQlmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQkJCQkvLyBTa2lwIGFjY2Vzc2luZyBpbiBzcGFyc2UgYXJyYXlzCgkJCQkJaWYgKCBpIGluIGFyciAmJiBhcnJbIGkgXSA9PT0gZWxlbSApIHsKCQkJCQkJcmV0dXJuIGk7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gLTE7CgkJfSwKCgkJbWVyZ2U6IGZ1bmN0aW9uKCBmaXJzdCwgc2Vjb25kICkgewoJCQl2YXIgbGVuID0gK3NlY29uZC5sZW5ndGgsCgkJCQlqID0gMCwKCQkJCWkgPSBmaXJzdC5sZW5ndGg7CgoJCQl3aGlsZSAoIGogPCBsZW4gKSB7CgkJCQlmaXJzdFsgaSsrIF0gPSBzZWNvbmRbIGorKyBdOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCS8vIFdvcmthcm91bmQgY2FzdGluZyBvZiAubGVuZ3RoIHRvIE5hTiBvbiBvdGhlcndpc2UgYXJyYXlsaWtlIG9iamVjdHMgKGUuZy4sIE5vZGVMaXN0cykKCQkJaWYgKCBsZW4gIT09IGxlbiApIHsKCQkJCXdoaWxlICggc2Vjb25kW2pdICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJZmlyc3RbIGkrKyBdID0gc2Vjb25kWyBqKysgXTsKCQkJCX0KCQkJfQoKCQkJZmlyc3QubGVuZ3RoID0gaTsKCgkJCXJldHVybiBmaXJzdDsKCQl9LAoKCQlncmVwOiBmdW5jdGlvbiggZWxlbXMsIGNhbGxiYWNrLCBpbnZlcnQgKSB7CgkJCXZhciBjYWxsYmFja0ludmVyc2UsCgkJCQltYXRjaGVzID0gW10sCgkJCQlpID0gMCwKCQkJCWxlbmd0aCA9IGVsZW1zLmxlbmd0aCwKCQkJCWNhbGxiYWNrRXhwZWN0ID0gIWludmVydDsKCgkJCS8vIEdvIHRocm91Z2ggdGhlIGFycmF5LCBvbmx5IHNhdmluZyB0aGUgaXRlbXMKCQkJLy8gdGhhdCBwYXNzIHRoZSB2YWxpZGF0b3IgZnVuY3Rpb24KCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCQljYWxsYmFja0ludmVyc2UgPSAhY2FsbGJhY2soIGVsZW1zWyBpIF0sIGkgKTsKCQkJCWlmICggY2FsbGJhY2tJbnZlcnNlICE9PSBjYWxsYmFja0V4cGVjdCApIHsKCQkJCQltYXRjaGVzLnB1c2goIGVsZW1zWyBpIF0gKTsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIG1hdGNoZXM7CgkJfSwKCgkJLy8gYXJnIGlzIGZvciBpbnRlcm5hbCB1c2FnZSBvbmx5CgkJbWFwOiBmdW5jdGlvbiggZWxlbXMsIGNhbGxiYWNrLCBhcmcgKSB7CgkJCXZhciB2YWx1ZSwKCQkJCWkgPSAwLAoJCQkJbGVuZ3RoID0gZWxlbXMubGVuZ3RoLAoJCQkJaXNBcnJheSA9IGlzQXJyYXlsaWtlKCBlbGVtcyApLAoJCQkJcmV0ID0gW107CgoJCQkvLyBHbyB0aHJvdWdoIHRoZSBhcnJheSwgdHJhbnNsYXRpbmcgZWFjaCBvZiB0aGUgaXRlbXMgdG8gdGhlaXIgbmV3IHZhbHVlcwoJCQlpZiAoIGlzQXJyYXkgKSB7CgkJCQlmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHsKCQkJCQl2YWx1ZSA9IGNhbGxiYWNrKCBlbGVtc1sgaSBdLCBpLCBhcmcgKTsKCgkJCQkJaWYgKCB2YWx1ZSAhPSBudWxsICkgewoJCQkJCQlyZXQucHVzaCggdmFsdWUgKTsKCQkJCQl9CgkJCQl9CgoJCQkvLyBHbyB0aHJvdWdoIGV2ZXJ5IGtleSBvbiB0aGUgb2JqZWN0LAoJCQl9IGVsc2UgewoJCQkJZm9yICggaSBpbiBlbGVtcyApIHsKCQkJCQl2YWx1ZSA9IGNhbGxiYWNrKCBlbGVtc1sgaSBdLCBpLCBhcmcgKTsKCgkJCQkJaWYgKCB2YWx1ZSAhPSBudWxsICkgewoJCQkJCQlyZXQucHVzaCggdmFsdWUgKTsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCS8vIEZsYXR0ZW4gYW55IG5lc3RlZCBhcnJheXMKCQkJcmV0dXJuIGNvbmNhdC5hcHBseSggW10sIHJldCApOwoJCX0sCgoJCS8vIEEgZ2xvYmFsIEdVSUQgY291bnRlciBmb3Igb2JqZWN0cwoJCWd1aWQ6IDEsCgoJCS8vIEJpbmQgYSBmdW5jdGlvbiB0byBhIGNvbnRleHQsIG9wdGlvbmFsbHkgcGFydGlhbGx5IGFwcGx5aW5nIGFueQoJCS8vIGFyZ3VtZW50cy4KCQlwcm94eTogZnVuY3Rpb24oIGZuLCBjb250ZXh0ICkgewoJCQl2YXIgYXJncywgcHJveHksIHRtcDsKCgkJCWlmICggdHlwZW9mIGNvbnRleHQgPT09ICJzdHJpbmciICkgewoJCQkJdG1wID0gZm5bIGNvbnRleHQgXTsKCQkJCWNvbnRleHQgPSBmbjsKCQkJCWZuID0gdG1wOwoJCQl9CgoJCQkvLyBRdWljayBjaGVjayB0byBkZXRlcm1pbmUgaWYgdGFyZ2V0IGlzIGNhbGxhYmxlLCBpbiB0aGUgc3BlYwoJCQkvLyB0aGlzIHRocm93cyBhIFR5cGVFcnJvciwgYnV0IHdlIHdpbGwganVzdCByZXR1cm4gdW5kZWZpbmVkLgoJCQlpZiAoICFqUXVlcnkuaXNGdW5jdGlvbiggZm4gKSApIHsKCQkJCXJldHVybiB1bmRlZmluZWQ7CgkJCX0KCgkJCS8vIFNpbXVsYXRlZCBiaW5kCgkJCWFyZ3MgPSBzbGljZS5jYWxsKCBhcmd1bWVudHMsIDIgKTsKCQkJcHJveHkgPSBmdW5jdGlvbigpIHsKCQkJCXJldHVybiBmbi5hcHBseSggY29udGV4dCB8fCB0aGlzLCBhcmdzLmNvbmNhdCggc2xpY2UuY2FsbCggYXJndW1lbnRzICkgKSApOwoJCQl9OwoKCQkJLy8gU2V0IHRoZSBndWlkIG9mIHVuaXF1ZSBoYW5kbGVyIHRvIHRoZSBzYW1lIG9mIG9yaWdpbmFsIGhhbmRsZXIsIHNvIGl0IGNhbiBiZSByZW1vdmVkCgkJCXByb3h5Lmd1aWQgPSBmbi5ndWlkID0gZm4uZ3VpZCB8fCBqUXVlcnkuZ3VpZCsrOwoKCQkJcmV0dXJuIHByb3h5OwoJCX0sCgoJCW5vdzogZnVuY3Rpb24oKSB7CgkJCXJldHVybiArKCBuZXcgRGF0ZSgpICk7CgkJfSwKCgkJLy8galF1ZXJ5LnN1cHBvcnQgaXMgbm90IHVzZWQgaW4gQ29yZSBidXQgb3RoZXIgcHJvamVjdHMgYXR0YWNoIHRoZWlyCgkJLy8gcHJvcGVydGllcyB0byBpdCBzbyBpdCBuZWVkcyB0byBleGlzdC4KCQlzdXBwb3J0OiBzdXBwb3J0Cgl9KTsKCgkvLyBQb3B1bGF0ZSB0aGUgY2xhc3MydHlwZSBtYXAKCWpRdWVyeS5lYWNoKCJCb29sZWFuIE51bWJlciBTdHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0IEVycm9yIi5zcGxpdCgiICIpLCBmdW5jdGlvbihpLCBuYW1lKSB7CgkJY2xhc3MydHlwZVsgIltvYmplY3QgIiArIG5hbWUgKyAiXSIgXSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKCX0pOwoKCWZ1bmN0aW9uIGlzQXJyYXlsaWtlKCBvYmogKSB7CgoJCS8vIFN1cHBvcnQ6IGlPUyA4LjIgKG5vdCByZXByb2R1Y2libGUgaW4gc2ltdWxhdG9yKQoJCS8vIGBpbmAgY2hlY2sgdXNlZCB0byBwcmV2ZW50IEpJVCBlcnJvciAoZ2gtMjE0NSkKCQkvLyBoYXNPd24gaXNuJ3QgdXNlZCBoZXJlIGR1ZSB0byBmYWxzZSBuZWdhdGl2ZXMKCQkvLyByZWdhcmRpbmcgTm9kZWxpc3QgbGVuZ3RoIGluIElFCgkJdmFyIGxlbmd0aCA9ICJsZW5ndGgiIGluIG9iaiAmJiBvYmoubGVuZ3RoLAoJCQl0eXBlID0galF1ZXJ5LnR5cGUoIG9iaiApOwoKCQlpZiAoIHR5cGUgPT09ICJmdW5jdGlvbiIgfHwgalF1ZXJ5LmlzV2luZG93KCBvYmogKSApIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJaWYgKCBvYmoubm9kZVR5cGUgPT09IDEgJiYgbGVuZ3RoICkgewoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgoJCXJldHVybiB0eXBlID09PSAiYXJyYXkiIHx8IGxlbmd0aCA9PT0gMCB8fAoJCQl0eXBlb2YgbGVuZ3RoID09PSAibnVtYmVyIiAmJiBsZW5ndGggPiAwICYmICggbGVuZ3RoIC0gMSApIGluIG9iajsKCX0KCXZhciBTaXp6bGUgPQoJLyohCgkgKiBTaXp6bGUgQ1NTIFNlbGVjdG9yIEVuZ2luZSB2Mi4yLjAtcHJlCgkgKiBodHRwOi8vc2l6emxlanMuY29tLwoJICoKCSAqIENvcHlyaWdodCAyMDA4LCAyMDE0IGpRdWVyeSBGb3VuZGF0aW9uLCBJbmMuIGFuZCBvdGhlciBjb250cmlidXRvcnMKCSAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZQoJICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQoJICoKCSAqIERhdGU6IDIwMTQtMTItMTYKCSAqLwoJKGZ1bmN0aW9uKCB3aW5kb3cgKSB7CgoJdmFyIGksCgkJc3VwcG9ydCwKCQlFeHByLAoJCWdldFRleHQsCgkJaXNYTUwsCgkJdG9rZW5pemUsCgkJY29tcGlsZSwKCQlzZWxlY3QsCgkJb3V0ZXJtb3N0Q29udGV4dCwKCQlzb3J0SW5wdXQsCgkJaGFzRHVwbGljYXRlLAoKCQkvLyBMb2NhbCBkb2N1bWVudCB2YXJzCgkJc2V0RG9jdW1lbnQsCgkJZG9jdW1lbnQsCgkJZG9jRWxlbSwKCQlkb2N1bWVudElzSFRNTCwKCQlyYnVnZ3lRU0EsCgkJcmJ1Z2d5TWF0Y2hlcywKCQltYXRjaGVzLAoJCWNvbnRhaW5zLAoKCQkvLyBJbnN0YW5jZS1zcGVjaWZpYyBkYXRhCgkJZXhwYW5kbyA9ICJzaXp6bGUiICsgMSAqIG5ldyBEYXRlKCksCgkJcHJlZmVycmVkRG9jID0gd2luZG93LmRvY3VtZW50LAoJCWRpcnJ1bnMgPSAwLAoJCWRvbmUgPSAwLAoJCWNsYXNzQ2FjaGUgPSBjcmVhdGVDYWNoZSgpLAoJCXRva2VuQ2FjaGUgPSBjcmVhdGVDYWNoZSgpLAoJCWNvbXBpbGVyQ2FjaGUgPSBjcmVhdGVDYWNoZSgpLAoJCXNvcnRPcmRlciA9IGZ1bmN0aW9uKCBhLCBiICkgewoJCQlpZiAoIGEgPT09IGIg", "base64"));
  res.write(new Buffer("KSB7CgkJCQloYXNEdXBsaWNhdGUgPSB0cnVlOwoJCQl9CgkJCXJldHVybiAwOwoJCX0sCgoJCS8vIEdlbmVyYWwtcHVycG9zZSBjb25zdGFudHMKCQlNQVhfTkVHQVRJVkUgPSAxIDw8IDMxLAoKCQkvLyBJbnN0YW5jZSBtZXRob2RzCgkJaGFzT3duID0gKHt9KS5oYXNPd25Qcm9wZXJ0eSwKCQlhcnIgPSBbXSwKCQlwb3AgPSBhcnIucG9wLAoJCXB1c2hfbmF0aXZlID0gYXJyLnB1c2gsCgkJcHVzaCA9IGFyci5wdXNoLAoJCXNsaWNlID0gYXJyLnNsaWNlLAoJCS8vIFVzZSBhIHN0cmlwcGVkLWRvd24gaW5kZXhPZiBhcyBpdCdzIGZhc3RlciB0aGFuIG5hdGl2ZQoJCS8vIGh0dHA6Ly9qc3BlcmYuY29tL3Rob3ItaW5kZXhvZi12cy1mb3IvNQoJCWluZGV4T2YgPSBmdW5jdGlvbiggbGlzdCwgZWxlbSApIHsKCQkJdmFyIGkgPSAwLAoJCQkJbGVuID0gbGlzdC5sZW5ndGg7CgkJCWZvciAoIDsgaSA8IGxlbjsgaSsrICkgewoJCQkJaWYgKCBsaXN0W2ldID09PSBlbGVtICkgewoJCQkJCXJldHVybiBpOwoJCQkJfQoJCQl9CgkJCXJldHVybiAtMTsKCQl9LAoKCQlib29sZWFucyA9ICJjaGVja2VkfHNlbGVjdGVkfGFzeW5jfGF1dG9mb2N1c3xhdXRvcGxheXxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58aXNtYXB8bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZCIsCgoJCS8vIFJlZ3VsYXIgZXhwcmVzc2lvbnMKCgkJLy8gV2hpdGVzcGFjZSBjaGFyYWN0ZXJzIGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtc2VsZWN0b3JzLyN3aGl0ZXNwYWNlCgkJd2hpdGVzcGFjZSA9ICJbXFx4MjBcXHRcXHJcXG5cXGZdIiwKCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXN5bnRheC8jY2hhcmFjdGVycwoJCWNoYXJhY3RlckVuY29kaW5nID0gIig/OlxcXFwufFtcXHctXXxbXlxceDAwLVxceGEwXSkrIiwKCgkJLy8gTG9vc2VseSBtb2RlbGVkIG9uIENTUyBpZGVudGlmaWVyIGNoYXJhY3RlcnMKCQkvLyBBbiB1bnF1b3RlZCB2YWx1ZSBzaG91bGQgYmUgYSBDU1MgaWRlbnRpZmllciBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXNlbGVjdG9ycy8jYXR0cmlidXRlLXNlbGVjdG9ycwoJCS8vIFByb3BlciBzeW50YXg6IGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIxL3N5bmRhdGEuaHRtbCN2YWx1ZS1kZWYtaWRlbnRpZmllcgoJCWlkZW50aWZpZXIgPSBjaGFyYWN0ZXJFbmNvZGluZy5yZXBsYWNlKCAidyIsICJ3IyIgKSwKCgkJLy8gQXR0cmlidXRlIHNlbGVjdG9yczogaHR0cDovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLyNhdHRyaWJ1dGUtc2VsZWN0b3JzCgkJYXR0cmlidXRlcyA9ICJcXFsiICsgd2hpdGVzcGFjZSArICIqKCIgKyBjaGFyYWN0ZXJFbmNvZGluZyArICIpKD86IiArIHdoaXRlc3BhY2UgKwoJCQkvLyBPcGVyYXRvciAoY2FwdHVyZSAyKQoJCQkiKihbKl4kfCF+XT89KSIgKyB3aGl0ZXNwYWNlICsKCQkJLy8gIkF0dHJpYnV0ZSB2YWx1ZXMgbXVzdCBiZSBDU1MgaWRlbnRpZmllcnMgW2NhcHR1cmUgNV0gb3Igc3RyaW5ncyBbY2FwdHVyZSAzIG9yIGNhcHR1cmUgNF0iCgkJCSIqKD86JygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCJ8KCIgKyBpZGVudGlmaWVyICsgIikpfCkiICsgd2hpdGVzcGFjZSArCgkJCSIqXFxdIiwKCgkJcHNldWRvcyA9ICI6KCIgKyBjaGFyYWN0ZXJFbmNvZGluZyArICIpKD86XFwoKCIgKwoJCQkvLyBUbyByZWR1Y2UgdGhlIG51bWJlciBvZiBzZWxlY3RvcnMgbmVlZGluZyB0b2tlbml6ZSBpbiB0aGUgcHJlRmlsdGVyLCBwcmVmZXIgYXJndW1lbnRzOgoJCQkvLyAxLiBxdW90ZWQgKGNhcHR1cmUgMzsgY2FwdHVyZSA0IG9yIGNhcHR1cmUgNSkKCQkJIignKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcIil8IiArCgkJCS8vIDIuIHNpbXBsZSAoY2FwdHVyZSA2KQoJCQkiKCg/OlxcXFwufFteXFxcXCgpW1xcXV18IiArIGF0dHJpYnV0ZXMgKyAiKSopfCIgKwoJCQkvLyAzLiBhbnl0aGluZyBlbHNlIChjYXB0dXJlIDIpCgkJCSIuKiIgKwoJCQkiKVxcKXwpIiwKCgkJLy8gTGVhZGluZyBhbmQgbm9uLWVzY2FwZWQgdHJhaWxpbmcgd2hpdGVzcGFjZSwgY2FwdHVyaW5nIHNvbWUgbm9uLXdoaXRlc3BhY2UgY2hhcmFjdGVycyBwcmVjZWRpbmcgdGhlIGxhdHRlcgoJCXJ3aGl0ZXNwYWNlID0gbmV3IFJlZ0V4cCggd2hpdGVzcGFjZSArICIrIiwgImciICksCgkJcnRyaW0gPSBuZXcgUmVnRXhwKCAiXiIgKyB3aGl0ZXNwYWNlICsgIit8KCg/Ol58W15cXFxcXSkoPzpcXFxcLikqKSIgKyB3aGl0ZXNwYWNlICsgIiskIiwgImciICksCgoJCXJjb21tYSA9IG5ldyBSZWdFeHAoICJeIiArIHdoaXRlc3BhY2UgKyAiKiwiICsgd2hpdGVzcGFjZSArICIqIiApLAoJCXJjb21iaW5hdG9ycyA9IG5ldyBSZWdFeHAoICJeIiArIHdoaXRlc3BhY2UgKyAiKihbPit+XXwiICsgd2hpdGVzcGFjZSArICIpIiArIHdoaXRlc3BhY2UgKyAiKiIgKSwKCgkJcmF0dHJpYnV0ZVF1b3RlcyA9IG5ldyBSZWdFeHAoICI9IiArIHdoaXRlc3BhY2UgKyAiKihbXlxcXSdcIl0qPykiICsgd2hpdGVzcGFjZSArICIqXFxdIiwgImciICksCgoJCXJwc2V1ZG8gPSBuZXcgUmVnRXhwKCBwc2V1ZG9zICksCgkJcmlkZW50aWZpZXIgPSBuZXcgUmVnRXhwKCAiXiIgKyBpZGVudGlmaWVyICsgIiQiICksCgoJCW1hdGNoRXhwciA9IHsKCQkJIklEIjogbmV3IFJlZ0V4cCggIl4jKCIgKyBjaGFyYWN0ZXJFbmNvZGluZyArICIpIiApLAoJCQkiQ0xBU1MiOiBuZXcgUmVnRXhwKCAiXlxcLigiICsgY2hhcmFjdGVyRW5jb2RpbmcgKyAiKSIgKSwKCQkJIlRBRyI6IG5ldyBSZWdFeHAoICJeKCIgKyBjaGFyYWN0ZXJFbmNvZGluZy5yZXBsYWNlKCAidyIsICJ3KiIgKSArICIpIiApLAoJCQkiQVRUUiI6IG5ldyBSZWdFeHAoICJeIiArIGF0dHJpYnV0ZXMgKSwKCQkJIlBTRVVETyI6IG5ldyBSZWdFeHAoICJeIiArIHBzZXVkb3MgKSwKCQkJIkNISUxEIjogbmV3IFJlZ0V4cCggIl46KG9ubHl8Zmlyc3R8bGFzdHxudGh8bnRoLWxhc3QpLShjaGlsZHxvZi10eXBlKSg/OlxcKCIgKyB3aGl0ZXNwYWNlICsKCQkJCSIqKGV2ZW58b2RkfCgoWystXXwpKFxcZCopbnwpIiArIHdoaXRlc3BhY2UgKyAiKig/OihbKy1dfCkiICsgd2hpdGVzcGFjZSArCgkJCQkiKihcXGQrKXwpKSIgKyB3aGl0ZXNwYWNlICsgIipcXCl8KSIsICJpIiApLAoJCQkiYm9vbCI6IG5ldyBSZWdFeHAoICJeKD86IiArIGJvb2xlYW5zICsgIikkIiwgImkiICksCgkJCS8vIEZvciB1c2UgaW4gbGlicmFyaWVzIGltcGxlbWVudGluZyAuaXMoKQoJCQkvLyBXZSB1c2UgdGhpcyBmb3IgUE9TIG1hdGNoaW5nIGluIGBzZWxlY3RgCgkJCSJuZWVkc0NvbnRleHQiOiBuZXcgUmVnRXhwKCAiXiIgKyB3aGl0ZXNwYWNlICsgIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcKCIgKwoJCQkJd2hpdGVzcGFjZSArICIqKCg/Oi1cXGQpP1xcZCopIiArIHdoaXRlc3BhY2UgKyAiKlxcKXwpKD89W14tXXwkKSIsICJpIiApCgkJfSwKCgkJcmlucHV0cyA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksCgkJcmhlYWRlciA9IC9eaFxkJC9pLAoKCQlybmF0aXZlID0gL15bXntdK1x7XHMqXFtuYXRpdmUgXHcvLAoKCQkvLyBFYXNpbHktcGFyc2VhYmxlL3JldHJpZXZhYmxlIElEIG9yIFRBRyBvciBDTEFTUyBzZWxlY3RvcnMKCQlycXVpY2tFeHByID0gL14oPzojKFtcdy1dKyl8KFx3Kyl8XC4oW1x3LV0rKSkkLywKCgkJcnNpYmxpbmcgPSAvWyt+XS8sCgkJcmVzY2FwZSA9IC8nfFxcL2csCgoJCS8vIENTUyBlc2NhcGVzIGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIxL3N5bmRhdGEuaHRtbCNlc2NhcGVkLWNoYXJhY3RlcnMKCQlydW5lc2NhcGUgPSBuZXcgUmVnRXhwKCAiXFxcXChbXFxkYS1mXXsxLDZ9IiArIHdoaXRlc3BhY2UgKyAiP3woIiArIHdoaXRlc3BhY2UgKyAiKXwuKSIsICJpZyIgKSwKCQlmdW5lc2NhcGUgPSBmdW5jdGlvbiggXywgZXNjYXBlZCwgZXNjYXBlZFdoaXRlc3BhY2UgKSB7CgkJCXZhciBoaWdoID0gIjB4IiArIGVzY2FwZWQgLSAweDEwMDAwOwoJCQkvLyBOYU4gbWVhbnMgbm9uLWNvZGVwb2ludAoJCQkvLyBTdXBwb3J0OiBGaXJlZm94PDI0CgkJCS8vIFdvcmthcm91bmQgZXJyb25lb3VzIG51bWVyaWMgaW50ZXJwcmV0YXRpb24gb2YgKyIweCIKCQkJcmV0dXJuIGhpZ2ggIT09IGhpZ2ggfHwgZXNjYXBlZFdoaXRlc3BhY2UgPwoJCQkJZXNjYXBlZCA6CgkJCQloaWdoIDwgMCA/CgkJCQkJLy8gQk1QIGNvZGVwb2ludAoJCQkJCVN0cmluZy5mcm9tQ2hhckNvZGUoIGhpZ2ggKyAweDEwMDAwICkgOgoJCQkJCS8vIFN1cHBsZW1lbnRhbCBQbGFuZSBjb2RlcG9pbnQgKHN1cnJvZ2F0ZSBwYWlyKQoJCQkJCVN0cmluZy5mcm9tQ2hhckNvZGUoIGhpZ2ggPj4gMTAgfCAweEQ4MDAsIGhpZ2ggJiAweDNGRiB8IDB4REMwMCApOwoJCX0sCgoJCS8vIFVzZWQgZm9yIGlmcmFtZXMKCQkvLyBTZWUgc2V0RG9jdW1lbnQoKQoJCS8vIFJlbW92aW5nIHRoZSBmdW5jdGlvbiB3cmFwcGVyIGNhdXNlcyBhICJQZXJtaXNzaW9uIERlbmllZCIKCQkvLyBlcnJvciBpbiBJRQoJCXVubG9hZEhhbmRsZXIgPSBmdW5jdGlvbigpIHsKCQkJc2V0RG9jdW1lbnQoKTsKCQl9OwoKCS8vIE9wdGltaXplIGZvciBwdXNoLmFwcGx5KCBfLCBOb2RlTGlzdCApCgl0cnkgewoJCXB1c2guYXBwbHkoCgkJCShhcnIgPSBzbGljZS5jYWxsKCBwcmVmZXJyZWREb2MuY2hpbGROb2RlcyApKSwKCQkJcHJlZmVycmVkRG9jLmNoaWxkTm9kZXMKCQkpOwoJCS8vIFN1cHBvcnQ6IEFuZHJvaWQ8NC4wCgkJLy8gRGV0ZWN0IHNpbGVudGx5IGZhaWxpbmcgcHVzaC5hcHBseQoJCWFyclsgcHJlZmVycmVkRG9jLmNoaWxkTm9kZXMubGVuZ3RoIF0ubm9kZVR5cGU7Cgl9IGNhdGNoICggZSApIHsKCQlwdXNoID0geyBhcHBseTogYXJyLmxlbmd0aCA/CgoJCQkvLyBMZXZlcmFnZSBzbGljZSBpZiBwb3NzaWJsZQoJCQlmdW5jdGlvbiggdGFyZ2V0LCBlbHMgKSB7CgkJCQlwdXNoX25hdGl2ZS5hcHBseSggdGFyZ2V0LCBzbGljZS5jYWxsKGVscykgKTsKCQkJfSA6CgoJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCS8vIE90aGVyd2lzZSBhcHBlbmQgZGlyZWN0bHkKCQkJZnVuY3Rpb24oIHRhcmdldCwgZWxzICkgewoJCQkJdmFyIGogPSB0YXJnZXQubGVuZ3RoLAoJCQkJCWkgPSAwOwoJCQkJLy8gQ2FuJ3QgdHJ1c3QgTm9kZUxpc3QubGVuZ3RoCgkJCQl3aGlsZSAoICh0YXJnZXRbaisrXSA9IGVsc1tpKytdKSApIHt9CgkJCQl0YXJnZXQubGVuZ3RoID0gaiAtIDE7CgkJCX0KCQl9OwoJfQoKCWZ1bmN0aW9uIFNpenpsZSggc2VsZWN0b3IsIGNvbnRleHQsIHJlc3VsdHMsIHNlZWQgKSB7CgkJdmFyIG1hdGNoLCBlbGVtLCBtLCBub2RlVHlwZSwKCQkJLy8gUVNBIHZhcnMKCQkJaSwgZ3JvdXBzLCBvbGQsIG5pZCwgbmV3Q29udGV4dCwgbmV3U2VsZWN0b3I7CgoJCWlmICggKCBjb250ZXh0ID8gY29udGV4dC5vd25lckRvY3VtZW50IHx8IGNvbnRleHQgOiBwcmVmZXJyZWREb2MgKSAhPT0gZG9jdW1lbnQgKSB7CgkJCXNldERvY3VtZW50KCBjb250ZXh0ICk7CgkJfQoKCQljb250ZXh0ID0gY29udGV4dCB8fCBkb2N1bWVudDsKCQlyZXN1bHRzID0gcmVzdWx0cyB8fCBbXTsKCQlub2RlVHlwZSA9IGNvbnRleHQubm9kZVR5cGU7CgoJCWlmICggdHlwZW9mIHNlbGVjdG9yICE9PSAic3RyaW5nIiB8fCAhc2VsZWN0b3IgfHwKCQkJbm9kZVR5cGUgIT09IDEgJiYgbm9kZVR5cGUgIT09IDkgJiYgbm9kZVR5cGUgIT09IDExICkgewoKCQkJcmV0dXJuIHJlc3VsdHM7CgkJfQoKCQlpZiAoICFzZWVkICYmIGRvY3VtZW50SXNIVE1MICkgewoKCQkJLy8gVHJ5IHRvIHNob3J0Y3V0IGZpbmQgb3BlcmF0aW9ucyB3aGVuIHBvc3NpYmxlIChlLmcuLCBub3QgdW5kZXIgRG9jdW1lbnRGcmFnbWVudCkKCQkJaWYgKCBub2RlVHlwZSAhPT0gMTEgJiYgKG1hdGNoID0gcnF1aWNrRXhwci5leGVjKCBzZWxlY3RvciApKSApIHsKCQkJCS8vIFNwZWVkLXVwOiBTaXp6bGUoIiNJRCIpCgkJCQlpZiAoIChtID0gbWF0Y2hbMV0pICkgewoJCQkJCWlmICggbm9kZVR5cGUgPT09IDkgKSB7CgkJCQkJCWVsZW0gPSBjb250ZXh0LmdldEVsZW1lbnRCeUlkKCBtICk7CgkJCQkJCS8vIENoZWNrIHBhcmVudE5vZGUgdG8gY2F0Y2ggd2hlbiBCbGFja2JlcnJ5IDQuNiByZXR1cm5zCgkJCQkJCS8vIG5vZGVzIHRoYXQgYXJlIG5vIGxvbmdlciBpbiB0aGUgZG9jdW1lbnQgKGpRdWVyeSAjNjk2MykKCQkJCQkJaWYgKCBlbGVtICYmIGVsZW0ucGFyZW50Tm9kZSApIHsKCQkJCQkJCS8vIEhhbmRsZSB0aGUgY2FzZSB3aGVyZSBJRSwgT3BlcmEsIGFuZCBXZWJraXQgcmV0dXJuIGl0ZW1zCgkJCQkJCQkvLyBieSBuYW1lIGluc3RlYWQgb2YgSUQKCQkJCQkJCWlmICggZWxlbS5pZCA9PT0gbSApIHsKCQkJCQkJCQlyZXN1bHRzLnB1c2goIGVsZW0gKTsKCQkJCQkJCQlyZXR1cm4gcmVzdWx0czsKCQkJCQkJCX0KCQkJCQkJfSBlbHNlIHsKCQkJCQkJCXJldHVybiByZXN1bHRzOwoJCQkJCQl9CgkJCQkJfSBlbHNlIHsKCQkJCQkJLy8gQ29udGV4dCBpcyBub3QgYSBkb2N1bWVudAoJCQkJCQlpZiAoIGNvbnRleHQub3duZXJEb2N1bWVudCAmJiAoZWxlbSA9IGNvbnRleHQub3duZXJEb2N1bWVudC5nZXRFbGVtZW50QnlJZCggbSApKSAmJgoJCQkJCQkJY29udGFpbnMoIGNvbnRleHQsIGVsZW0gKSAmJiBlbGVtLmlkID09PSBtICkgewoJCQkJCQkJcmVzdWx0cy5wdXNoKCBlbGVtICk7CgkJCQkJCQlyZXR1cm4gcmVzdWx0czsKCQkJCQkJfQoJCQkJCX0KCgkJCQkvLyBTcGVlZC11cDogU2l6emxlKCJUQUciKQoJCQkJfSBlbHNlIGlmICggbWF0Y2hbMl0gKSB7CgkJCQkJcHVzaC5hcHBseSggcmVzdWx0cywgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSggc2VsZWN0b3IgKSApOwoJCQkJCXJldHVybiByZXN1bHRzOwoKCQkJCS8vIFNwZWVkLXVwOiBTaXp6bGUoIi5DTEFTUyIpCgkJCQl9IGVsc2UgaWYgKCAobSA9IG1hdGNoWzNdKSAmJiBzdXBwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgKSB7CgkJCQkJcHVzaC5hcHBseSggcmVzdWx0cywgY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCBtICkgKTsKCQkJCQlyZXR1cm4gcmVzdWx0czsKCQkJCX0KCQkJfQoKCQkJLy8gUVNBIHBhdGgKCQkJaWYgKCBzdXBwb3J0LnFzYSAmJiAoIXJidWdneVFTQSB8fCAhcmJ1Z2d5UVNBLnRlc3QoIHNlbGVjdG9yICkpICkgewoJCQkJbmlkID0gb2xkID0gZXhwYW5kbzsKCQkJCW5ld0NvbnRleHQgPSBjb250ZXh0OwoJCQkJbmV3U2VsZWN0b3IgPSBub2RlVHlwZSAhPT0gMSAmJiBzZWxlY3RvcjsKCgkJCQkvLyBxU0Egd29ya3Mgc3RyYW5nZWx5IG9uIEVsZW1lbnQtcm9vdGVkIHF1ZXJpZXMKCQkJCS8vIFdlIGNhbiB3b3JrIGFyb3VuZCB0aGlzIGJ5IHNwZWNpZnlpbmcgYW4gZXh0cmEgSUQgb24gdGhlIHJvb3QKCQkJCS8vIGFuZCB3b3JraW5nIHVwIGZyb20gdGhlcmUgKFRoYW5rcyB0byBBbmRyZXcgRHVwb250IGZvciB0aGUgdGVjaG5pcXVlKQoJCQkJLy8gSUUgOCBkb2Vzbid0IHdvcmsgb24gb2JqZWN0IGVsZW1lbnRzCgkJCQlpZiAoIG5vZGVUeXBlID09PSAxICYmIGNvbnRleHQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gIm9iamVjdCIgKSB7CgkJCQkJZ3JvdXBzID0gdG9rZW5pemUoIHNlbGVjdG9yICk7CgoJCQkJCWlmICggKG9sZCA9IGNvbnRleHQuZ2V0QXR0cmlidXRlKCJpZCIpKSApIHsKCQkJCQkJbmlkID0gb2xkLnJlcGxhY2UoIHJlc2NhcGUsICJcXCQmIiApOwoJCQkJCX0gZWxzZSB7CgkJCQkJCWNvbnRleHQuc2V0QXR0cmlidXRlKCAiaWQiLCBuaWQgKTsKCQkJCQl9CgkJCQkJbmlkID0gIltpZD0nIiArIG5pZCArICInXSAiOwoKCQkJCQlpID0gZ3JvdXBzLmxlbmd0aDsKCQkJCQl3aGlsZSAoIGktLSApIHsKCQkJCQkJZ3JvdXBzW2ldID0gbmlkICsgdG9TZWxlY3RvciggZ3JvdXBzW2ldICk7CgkJCQkJfQoJCQkJCW5ld0NvbnRleHQgPSByc2libGluZy50ZXN0KCBzZWxlY3RvciApICYmIHRlc3RDb250ZXh0KCBjb250ZXh0LnBhcmVudE5vZGUgKSB8fCBjb250ZXh0OwoJCQkJCW5ld1NlbGVjdG9yID0gZ3JvdXBzLmpvaW4oIiwiKTsKCQkJCX0KCgkJCQlpZiAoIG5ld1NlbGVjdG9yICkgewoJCQkJCXRyeSB7CgkJCQkJCXB1c2guYXBwbHkoIHJlc3VsdHMsCgkJCQkJCQluZXdDb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoIG5ld1NlbGVjdG9yICkKCQkJCQkJKTsKCQkJCQkJcmV0dXJuIHJlc3VsdHM7CgkJCQkJfSBjYXRjaChxc2FFcnJvcikgewoJCQkJCX0gZmluYWxseSB7CgkJCQkJCWlmICggIW9sZCApIHsKCQkJCQkJCWNvbnRleHQucmVtb3ZlQXR0cmlidXRlKCJpZCIpOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoKCQkvLyBBbGwgb3RoZXJzCgkJcmV0dXJuIHNlbGVjdCggc2VsZWN0b3IucmVwbGFjZSggcnRyaW0sICIkMSIgKSwgY29udGV4dCwgcmVzdWx0cywgc2VlZCApOwoJfQoKCS8qKgoJICogQ3JlYXRlIGtleS12YWx1ZSBjYWNoZXMgb2YgbGltaXRlZCBzaXplCgkgKiBAcmV0dXJucyB7RnVuY3Rpb24oc3RyaW5nLCBPYmplY3QpfSBSZXR1cm5zIHRoZSBPYmplY3QgZGF0YSBhZnRlciBzdG9yaW5nIGl0IG9uIGl0c2VsZiB3aXRoCgkgKglwcm9wZXJ0eSBuYW1lIHRoZSAoc3BhY2Utc3VmZml4ZWQpIHN0cmluZyBhbmQgKGlmIHRoZSBjYWNoZSBpcyBsYXJnZXIgdGhhbiBFeHByLmNhY2hlTGVuZ3RoKQoJICoJZGVsZXRpbmcgdGhlIG9sZGVzdCBlbnRyeQoJICovCglmdW5jdGlvbiBjcmVhdGVDYWNoZSgpIHsKCQl2YXIga2V5cyA9IFtdOwoKCQlmdW5jdGlvbiBjYWNoZSgga2V5LCB2YWx1ZSApIHsKCQkJLy8gVXNlIChrZXkgKyAiICIpIHRvIGF2b2lkIGNvbGxpc2lvbiB3aXRoIG5hdGl2ZSBwcm90b3R5cGUgcHJvcGVydGllcyAoc2VlIElzc3VlICMxNTcpCgkJCWlmICgga2V5cy5wdXNoKCBrZXkgKyAiICIgKSA+IEV4cHIuY2FjaGVMZW5ndGggKSB7CgkJCQkvLyBPbmx5IGtlZXAgdGhlIG1vc3QgcmVjZW50IGVudHJpZXMKCQkJCWRlbGV0ZSBjYWNoZVsga2V5cy5zaGlmdCgpIF07CgkJCX0KCQkJcmV0dXJuIChjYWNoZVsga2V5ICsgIiAiIF0gPSB2YWx1ZSk7CgkJfQoJCXJldHVybiBjYWNoZTsKCX0KCgkvKioKCSAqIE1hcmsgYSBmdW5jdGlvbiBmb3Igc3BlY2lhbCB1c2UgYnkgU2l6emxlCgkgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gbWFyawoJICovCglmdW5jdGlvbiBtYXJrRnVuY3Rpb24oIGZuICkgewoJCWZuWyBleHBhbmRvIF0gPSB0cnVlOwoJCXJldHVybiBmbjsKCX0KCgkvKioKCSAqIFN1cHBvcnQgdGVzdGluZyB1c2luZyBhbiBlbGVtZW50CgkgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBQYXNzZWQgdGhlIGNyZWF0ZWQgZGl2IGFuZCBleHBlY3RzIGEgYm9vbGVhbiByZXN1bHQKCSAqLwoJZnVuY3Rpb24gYXNzZXJ0KCBmbiApIHsKCQl2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CgoJCXRyeSB7CgkJCXJldHVybiAhIWZuKCBkaXYgKTsKCQl9IGNhdGNoIChlKSB7CgkJCXJldHVybiBmYWxzZTsKCQl9IGZpbmFsbHkgewoJCQkvLyBSZW1vdmUgZnJvbSBpdHMgcGFyZW50IGJ5IGRlZmF1bHQKCQkJaWYgKCBkaXYucGFyZW50Tm9kZSApIHsKCQkJCWRpdi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBkaXYgKTsKCQkJfQoJCQkvLyByZWxlYXNlIG1lbW9yeSBpbiBJRQoJCQlkaXYgPSBudWxsOwoJCX0KCX0KCgkvKioKCSAqIEFkZHMgdGhlIHNhbWUgaGFuZGxlciBmb3IgYWxsIG9mIHRoZSBzcGVjaWZpZWQgYXR0cnMKCSAqIEBwYXJhbSB7U3RyaW5nfSBhdHRycyBQaXBlLXNlcGFyYXRlZCBsaXN0IG9mIGF0dHJpYnV0ZXMKCSAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIgVGhlIG1ldGhvZCB0aGF0IHdpbGwgYmUgYXBwbGllZAoJICovCglmdW5jdGlvbiBhZGRIYW5kbGUoIGF0dHJzLCBoYW5kbGVyICkgewoJCXZhciBhcnIgPSBhdHRycy5zcGxpdCgifCIpLAoJCQlpID0gYXR0cnMubGVuZ3RoOwoKCQl3aGlsZSAoIGktLSApIHsKCQkJRXhwci5hdHRySGFuZGxlWyBhcnJbaV0gXSA9IGhhbmRsZXI7CgkJfQoJfQoKCS8qKgoJICogQ2hlY2tzIGRvY3VtZW50IG9yZGVyIG9mIHR3byBzaWJsaW5ncwoJICogQHBhcmFtIHtFbGVtZW50fSBhCgkgKiBAcGFyYW0ge0VsZW1lbnR9IGIKCSAqIEByZXR1cm5zIHtOdW1iZXJ9IFJldHVybnMgbGVzcyB0aGFuIDAgaWYgYSBwcmVjZWRlcyBiLCBncmVhdGVyIHRoYW4gMCBpZiBhIGZvbGxvd3MgYgoJICovCglmdW5jdGlvbiBzaWJsaW5nQ2hlY2soIGEsIGIgKSB7CgkJdmFyIGN1ciA9IGIgJiYgYSwKCQkJZGlmZiA9IGN1ciAmJiBhLm5vZGVUeXBlID09PSAxICYmIGIubm9kZVR5cGUgPT09IDEgJiYKCQkJCSggfmIuc291cmNlSW5kZXggfHwgTUFYX05FR0FUSVZFICkgLQoJCQkJKCB+YS5zb3VyY2VJbmRleCB8fCBNQVhfTkVHQVRJVkUgKTsKCgkJLy8gVXNlIElFIHNvdXJjZUluZGV4IGlmIGF2YWlsYWJsZSBvbiBib3RoIG5vZGVzCgkJaWYgKCBkaWZmICkgewoJCQlyZXR1cm4gZGlmZjsKCQl9CgoJCS8vIENoZWNrIGlmIGIgZm9sbG93cyBhCgkJaWYgKCBjdXIgKSB7CgkJCXdoaWxlICggKGN1ciA9IGN1ci5uZXh0U2libGluZykgKSB7CgkJCQlpZiAoIGN1ciA9PT0gYiApIHsKCQkJCQlyZXR1cm4gLTE7CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiBhID8gMSA6IC0xOwoJfQoKCS8qKgoJICogUmV0dXJucyBhIGZ1bmN0aW9uIHRvIHVzZSBpbiBwc2V1ZG9zIGZvciBpbnB1dCB0eXBlcwoJICogQHBhcmFtIHtTdHJpbmd9IHR5cGUKCSAqLwoJZnVuY3Rpb24gY3JlYXRlSW5wdXRQc2V1ZG8oIHR5cGUgKSB7CgkJcmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkgewoJCQl2YXIgbmFtZSA9IGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCQkJcmV0dXJuIG5hbWUgPT09ICJpbnB1dCIgJiYgZWxlbS50eXBlID09PSB0eXBlOwoJCX07Cgl9CgoJLyoqCgkgKiBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gdXNlIGluIHBzZXVkb3MgZm9yIGJ1dHRvbnMKCSAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlCgkgKi8KCWZ1bmN0aW9uIGNyZWF0ZUJ1dHRvblBzZXVkbyggdHlwZSApIHsKCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwoJCQlyZXR1cm4gKG5hbWUgPT09ICJpbnB1dCIgfHwgbmFtZSA9PT0gImJ1dHRvbiIpICYmIGVsZW0udHlwZSA9PT0gdHlwZTsKCQl9OwoJfQoKCS8qKgoJICogUmV0dXJucyBhIGZ1bmN0aW9uIHRvIHVzZSBpbiBwc2V1ZG9zIGZvciBwb3NpdGlvbmFscwoJICogQHBhcmFtIHtGdW5jdGlvbn0gZm4KCSAqLwoJZnVuY3Rpb24gY3JlYXRlUG9zaXRpb25hbFBzZXVkbyggZm4gKSB7CgkJcmV0dXJuIG1hcmtGdW5jdGlvbihmdW5jdGlvbiggYXJndW1lbnQgKSB7CgkJCWFyZ3VtZW50ID0gK2FyZ3VtZW50OwoJCQlyZXR1cm4gbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWVkLCBtYXRjaGVzICkgewoJCQkJdmFyIGosCgkJCQkJbWF0Y2hJbmRleGVzID0gZm4oIFtdLCBzZWVkLmxlbmd0aCwgYXJndW1lbnQgKSwKCQkJCQlpID0gbWF0Y2hJbmRleGVzLmxlbmd0aDsKCgkJCQkvLyBNYXRjaCBlbGVtZW50cyBmb3VuZCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4ZXMKCQkJCXdoaWxlICggaS0tICkgewoJCQkJCWlmICggc2VlZFsgKGogPSBtYXRjaEluZGV4ZXNbaV0pIF0gKSB7CgkJCQkJCXNlZWRbal0gPSAhKG1hdGNoZXNbal0gPSBzZWVkW2pdKTsKCQkJCQl9CgkJCQl9CgkJCX0pOwoJCX0pOwoJfQoKCS8qKgoJICogQ2hlY2tzIGEgbm9kZSBmb3IgdmFsaWRpdHkgYXMgYSBTaXp6bGUgY29udGV4dAoJICogQHBhcmFtIHtFbGVtZW50fE9iamVjdD19IGNvbnRleHQKCSAqIEByZXR1cm5zIHtFbGVtZW50fE9iamVjdHxCb29sZWFufSBUaGUgaW5wdXQgbm9kZSBpZiBhY2NlcHRhYmxlLCBvdGhlcndpc2UgYSBmYWxzeSB2YWx1ZQoJICovCglmdW5jdGlvbiB0ZXN0Q29udGV4dCggY29udGV4dCApIHsKCQlyZXR1cm4gY29udGV4dCAmJiB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gInVuZGVmaW5lZCIgJiYgY29udGV4dDsKCX0KCgkvLyBFeHBvc2Ugc3VwcG9ydCB2YXJzIGZvciBjb252ZW5pZW5jZQoJc3VwcG9ydCA9IFNpenpsZS5zdXBwb3J0ID0ge307CgoJLyoqCgkgKiBEZXRlY3RzIFhNTCBub2RlcwoJICogQHBhcmFtIHtFbGVtZW50fE9iamVjdH0gZWxlbSBBbiBlbGVtZW50IG9yIGEgZG9jdW1lbnQKCSAqIEByZXR1cm5zIHtCb29sZWFufSBUcnVlIGlmZiBlbGVtIGlzIGEgbm9uLUhUTUwgWE1MIG5vZGUKCSAqLwoJaXNYTUwgPSBTaXp6bGUuaXNYTUwgPSBmdW5jdGlvbiggZWxlbSApIHsKCQkvLyBkb2N1bWVudEVsZW1lbnQgaXMgdmVyaWZpZWQgZm9yIGNhc2VzIHdoZXJlIGl0IGRvZXNuJ3QgeWV0IGV4aXN0CgkJLy8gKHN1Y2ggYXMgbG9hZGluZyBpZnJhbWVzIGluIElFIC0gIzQ4MzMpCgkJdmFyIGRvY3VtZW50RWxlbWVudCA9IGVsZW0gJiYgKGVsZW0ub3duZXJEb2N1bWVudCB8fCBlbGVtKS5kb2N1bWVudEVsZW1lbnQ7CgkJcmV0dXJuIGRvY3VtZW50RWxlbWVudCA/IGRvY3VtZW50RWxlbWVudC5ub2RlTmFtZSAhPT0gIkhUTUwiIDogZmFsc2U7Cgl9OwoKCS8qKgoJICogU2V0cyBkb2N1bWVudC1yZWxhdGVkIHZhcmlhYmxlcyBvbmNlIGJhc2VkIG9uIHRoZSBjdXJyZW50IGRvY3VtZW50CgkgKiBAcGFyYW0ge0VsZW1lbnR8T2JqZWN0fSBbZG9jXSBBbiBlbGVtZW50IG9yIGRvY3VtZW50IG9iamVjdCB0byB1c2UgdG8gc2V0IHRoZSBkb2N1bWVudAoJICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgY3VycmVudCBkb2N1bWVudAoJICovCglzZXREb2N1bWVudCA9IFNpenpsZS5zZXREb2N1bWVudCA9IGZ1bmN0aW9uKCBub2RlICkgewoJCXZhciBoYXNDb21wYXJlLCBwYXJlbnQsCgkJCWRvYyA9IG5vZGUgPyBub2RlLm93bmVyRG9jdW1lbnQgfHwgbm9kZSA6IHByZWZlcnJlZERvYzsKCgkJLy8gSWYgbm8gZG9jdW1lbnQgYW5kIGRvY3VtZW50RWxlbWVudCBpcyBhdmFpbGFibGUsIHJldHVybgoJCWlmICggZG9jID09PSBkb2N1bWVudCB8fCBkb2Mubm9kZVR5cGUgIT09IDkgfHwgIWRvYy5kb2N1bWVudEVsZW1lbnQgKSB7CgkJCXJldHVybiBkb2N1bWVudDsKCQl9CgoJCS8vIFNldCBvdXIgZG9jdW1lbnQKCQlkb2N1bWVudCA9IGRvYzsKCQlkb2NFbGVtID0gZG9jLmRvY3VtZW50RWxlbWVudDsKCQlwYXJlbnQgPSBkb2MuZGVmYXVsdFZpZXc7CgoJCS8vIFN1cHBvcnQ6IElFPjgKCQkvLyBJZiBpZnJhbWUgZG9jdW1lbnQgaXMgYXNzaWduZWQgdG8gImRvY3VtZW50IiB2YXJpYWJsZSBhbmQgaWYgaWZyYW1lIGhhcyBiZWVuIHJlbG9hZGVkLAoJCS8vIElFIHdpbGwgdGhyb3cgInBlcm1pc3Npb24gZGVuaWVkIiBlcnJvciB3aGVuIGFjY2Vzc2luZyAiZG9jdW1lbnQiIHZhcmlhYmxlLCBzZWUgalF1ZXJ5ICMxMzkzNgoJCS8vIElFNi04IGRvIG5vdCBzdXBwb3J0IHRoZSBkZWZhdWx0VmlldyBwcm9wZXJ0eSBzbyBwYXJlbnQgd2lsbCBiZSB1bmRlZmluZWQKCQlpZiAoIHBhcmVudCAmJiBwYXJlbnQgIT09IHBhcmVudC50b3AgKSB7CgkJCS8vIElFMTEgZG9lcyBub3QgaGF2ZSBhdHRhY2hFdmVudCwgc28gYWxsIG11c3Qgc3VmZmVyCgkJCWlmICggcGFyZW50LmFkZEV2ZW50TGlzdGVuZXIgKSB7CgkJCQlwYXJlbnQuYWRkRXZlbnRMaXN0ZW5lciggInVubG9hZCIsIHVubG9hZEhhbmRsZXIsIGZhbHNlICk7CgkJCX0gZWxzZSBpZiAoIHBhcmVudC5hdHRhY2hFdmVudCApIHsKCQkJCXBhcmVudC5hdHRhY2hFdmVudCggIm9udW5sb2FkIiwgdW5sb2FkSGFuZGxlciApOwoJCQl9CgkJfQoKCQkvKiBTdXBwb3J0IHRlc3RzCgkJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoJCWRvY3VtZW50SXNIVE1MID0gIWlzWE1MKCBkb2MgKTsKCgkJLyogQXR0cmlidXRlcwoJCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCgkJLy8gU3VwcG9ydDogSUU8OAoJCS8vIFZlcmlmeSB0aGF0IGdldEF0dHJpYnV0ZSByZWFsbHkgcmV0dXJucyBhdHRyaWJ1dGVzIGFuZCBub3QgcHJvcGVydGllcwoJCS8vIChleGNlcHRpbmcgSUU4IGJvb2xlYW5zKQoJCXN1cHBvcnQuYXR0cmlidXRlcyA9IGFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCQlkaXYuY2xhc3NOYW1lID0gImkiOwoJCQlyZXR1cm4gIWRpdi5nZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIpOwoJCX0pOwoKCQkvKiBnZXRFbGVtZW50KHMpQnkqCgkJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKCQkvLyBDaGVjayBpZiBnZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpIHJldHVybnMgb25seSBlbGVtZW50cwoJCXN1cHBvcnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgPSBhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHsKCQkJZGl2LmFwcGVuZENoaWxkKCBkb2MuY3JlYXRlQ29tbWVudCgiIikgKTsKCQkJcmV0dXJuICFkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKS5sZW5ndGg7CgkJfSk7CgoJCS8vIFN1cHBvcnQ6IElFPDkKCQlzdXBwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgPSBybmF0aXZlLnRlc3QoIGRvYy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lICk7CgoJCS8vIFN1cHBvcnQ6IElFPDEwCgkJLy8gQ2hlY2sgaWYgZ2V0RWxlbWVudEJ5SWQgcmV0dXJucyBlbGVtZW50cyBieSBuYW1lCgkJLy8gVGhlIGJyb2tlbiBnZXRFbGVtZW50QnlJZCBtZXRob2RzIGRvbid0IHBpY2sgdXAgcHJvZ3JhbWF0aWNhbGx5LXNldCBuYW1lcywKCQkvLyBzbyB1c2UgYSByb3VuZGFib3V0IGdldEVsZW1lbnRzQnlOYW1lIHRlc3QKCQlzdXBwb3J0LmdldEJ5SWQgPSBhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHsKCQkJZG9jRWxlbS5hcHBlbmRDaGlsZCggZGl2ICkuaWQgPSBleHBhbmRvOwoJCQlyZXR1cm4gIWRvYy5nZXRFbGVtZW50c0J5TmFtZSB8fCAhZG9jLmdldEVsZW1lbnRzQnlOYW1lKCBleHBhbmRvICkubGVuZ3RoOwoJCX0pOwoKCQkvLyBJRCBmaW5kIGFuZCBmaWx0ZXIKCQlpZiAoIHN1cHBvcnQuZ2V0QnlJZCApIHsKCQkJRXhwci5maW5kWyJJRCJdID0gZnVuY3Rpb24oIGlkLCBjb250ZXh0ICkgewoJCQkJaWYgKCB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50QnlJZCAhPT0gInVuZGVmaW5lZCIgJiYgZG9jdW1lbnRJc0hUTUwgKSB7CgkJCQkJdmFyIG0gPSBjb250ZXh0LmdldEVsZW1lbnRCeUlkKCBpZCApOwoJCQkJCS8vIENoZWNrIHBhcmVudE5vZGUgdG8gY2F0Y2ggd2hlbiBCbGFja2JlcnJ5IDQuNiByZXR1cm5zCgkJCQkJLy8gbm9kZXMgdGhhdCBhcmUgbm8gbG9uZ2VyIGluIHRoZSBkb2N1bWVudCAjNjk2MwoJCQkJCXJldHVybiBtICYmIG0ucGFyZW50Tm9kZSA/IFsgbSBdIDogW107CgkJCQl9CgkJCX07CgkJCUV4cHIuZmlsdGVyWyJJRCJdID0gZnVuY3Rpb24oIGlkICkgewoJCQkJdmFyIGF0dHJJZCA9IGlkLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7CgkJCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJcmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKCJpZCIpID09PSBhdHRySWQ7CgkJCQl9OwoJCQl9OwoJCX0gZWxzZSB7CgkJCS8vIFN1cHBvcnQ6IElFNi83CgkJCS8vIGdldEVsZW1lbnRCeUlkIGlzIG5vdCByZWxpYWJsZSBhcyBhIGZpbmQgc2hvcnRjdXQKCQkJZGVsZXRlIEV4cHIuZmluZFsiSUQiXTsKCgkJCUV4cHIuZmlsdGVyWyJJRCJdID0gIGZ1bmN0aW9uKCBpZCApIHsKCQkJCXZhciBhdHRySWQgPSBpZC5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApOwoJCQkJcmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCXZhciBub2RlID0gdHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlTm9kZSAhPT0gInVuZGVmaW5lZCIgJiYgZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpOwoJCQkJCXJldHVybiBub2RlICYmIG5vZGUudmFsdWUgPT09IGF0dHJJZDsKCQkJCX07CgkJCX07CgkJfQoKCQkvLyBUYWcKCQlFeHByLmZpbmRbIlRBRyJdID0gc3VwcG9ydC5nZXRFbGVtZW50c0J5VGFnTmFtZSA/CgkJCWZ1bmN0aW9uKCB0YWcsIGNvbnRleHQgKSB7CgkJCQlpZiAoIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lICE9PSAidW5kZWZpbmVkIiApIHsKCQkJCQlyZXR1cm4gY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSggdGFnICk7CgoJCQkJLy8gRG9jdW1lbnRGcmFnbWVudCBub2RlcyBkb24ndCBoYXZlIGdFQlROCgkJCQl9IGVsc2UgaWYgKCBzdXBwb3J0LnFzYSApIHsKCQkJCQlyZXR1cm4gY29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKCB0YWcgKTsKCQkJCX0KCQkJfSA6CgoJCQlmdW5jdGlvbiggdGFnLCBjb250ZXh0ICkgewoJCQkJdmFyIGVsZW0sCgkJCQkJdG1wID0gW10sCgkJCQkJaSA9IDAsCgkJCQkJLy8gQnkgaGFwcHkgY29pbmNpZGVuY2UsIGEgKGJyb2tlbikgZ0VCVE4gYXBwZWFycyBvbiBEb2N1bWVudEZyYWdtZW50IG5vZGVzIHRvbwoJCQkJCXJlc3VsdHMgPSBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCB0YWcgKTsKCgkJCQkvLyBGaWx0ZXIgb3V0IHBvc3NpYmxlIGNvbW1lbnRzCgkJCQlpZiAoIHRhZyA9PT0gIioiICkgewoJCQkJCXdoaWxlICggKGVsZW0gPSByZXN1bHRzW2krK10pICkgewoJCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJCQl0bXAucHVzaCggZWxlbSApOwoJCQkJCQl9CgkJCQkJfQoKCQkJCQlyZXR1cm4gdG1wOwoJCQkJfQoJCQkJcmV0dXJuIHJlc3VsdHM7CgkJCX07CgoJCS8vIENsYXNzCgkJRXhwci5maW5kWyJDTEFTUyJdID0gc3VwcG9ydC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lICYmIGZ1bmN0aW9uKCBjbGFzc05hbWUsIGNvbnRleHQgKSB7CgkJCWlmICggZG9jdW1lbnRJc0hUTUwgKSB7CgkJCQlyZXR1cm4gY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCBjbGFzc05hbWUgKTsKCQkJfQoJCX07CgoJCS8qIFFTQS9tYXRjaGVzU2VsZWN0b3IKCQktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCgoJCS8vIFFTQSBhbmQgbWF0Y2hlc1NlbGVjdG9yIHN1cHBvcnQKCgkJLy8gbWF0Y2hlc1NlbGVjdG9yKDphY3RpdmUpIHJlcG9ydHMgZmFsc2Ugd2hlbiB0cnVlIChJRTkvT3BlcmEgMTEuNSkKCQlyYnVnZ3lNYXRjaGVzID0gW107CgoJCS8vIHFTYSg6Zm9jdXMpIHJlcG9ydHMgZmFsc2Ugd2hlbiB0cnVlIChDaHJvbWUgMjEpCgkJLy8gV2UgYWxsb3cgdGhpcyBiZWNhdXNlIG9mIGEgYnVnIGluIElFOC85IHRoYXQgdGhyb3dzIGFuIGVycm9yCgkJLy8gd2hlbmV2ZXIgYGRvY3VtZW50LmFjdGl2ZUVsZW1lbnRgIGlzIGFjY2Vzc2VkIG9uIGFuIGlmcmFtZQoJCS8vIFNvLCB3ZSBhbGxvdyA6Zm9jdXMgdG8gcGFzcyB0aHJvdWdoIFFTQSBhbGwgdGhlIHRpbWUgdG8gYXZvaWQgdGhlIElFIGVycm9yCgkJLy8gU2VlIGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzEzMzc4CgkJcmJ1Z2d5UVNBID0gW107CgoJCWlmICggKHN1cHBvcnQucXNhID0gcm5hdGl2ZS50ZXN0KCBkb2MucXVlcnlTZWxlY3RvckFsbCApKSApIHsKCQkJLy8gQnVpbGQgUVNBIHJlZ2V4CgkJCS8vIFJlZ2V4IHN0cmF0ZWd5IGFkb3B0ZWQgZnJvbSBEaWVnbyBQZXJpbmkKCQkJYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJCQkvLyBTZWxlY3QgaXMgc2V0IHRvIGVtcHR5IHN0cmluZyBvbiBwdXJwb3NlCgkJCQkvLyBUaGlzIGlzIHRvIHRlc3QgSUUncyB0cmVhdG1lbnQgb2Ygbm90IGV4cGxpY2l0bHkKCQkJCS8vIHNldHRpbmcgYSBib29sZWFuIGNvbnRlbnQgYXR0cmlidXRlLAoJCQkJLy8gc2luY2UgaXRzIHByZXNlbmNlIHNob3VsZCBiZSBlbm91Z2gKCQkJCS8vIGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzEyMzU5CgkJCQlkb2NFbGVtLmFwcGVuZENoaWxkKCBkaXYgKS5pbm5lckhUTUwgPSAiPGEgaWQ9JyIgKyBleHBhbmRvICsgIic+PC9hPiIgKwoJCQkJCSI8c2VsZWN0IGlkPSciICsgZXhwYW5kbyArICItXGZdJyBtc2FsbG93Y2FwdHVyZT0nJz4iICsKCQkJCQkiPG9wdGlvbiBzZWxlY3RlZD0nJz48L29wdGlvbj48L3NlbGVjdD4iOwoKCQkJCS8vIFN1cHBvcnQ6IElFOCwgT3BlcmEgMTEtMTIuMTYKCQkJCS8vIE5vdGhpbmcgc2hvdWxkIGJlIHNlbGVjdGVkIHdoZW4gZW1wdHkgc3RyaW5ncyBmb2xsb3cgXj0gb3IgJD0gb3IgKj0KCQkJCS8vIFRoZSB0ZXN0IGF0dHJpYnV0ZSBtdXN0IGJlIHVua25vd24gaW4gT3BlcmEgYnV0ICJzYWZlIiBmb3IgV2luUlQKCQkJCS8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9pZS9oaDQ2NTM4OC5hc3B4I2F0dHJpYnV0ZV9zZWN0aW9uCgkJCQlpZiAoIGRpdi5xdWVyeVNlbGVjdG9yQWxsKCJbbXNhbGxvd2NhcHR1cmVePScnXSIpLmxlbmd0aCApIHsKCQkJCQlyYnVnZ3lRU0EucHVzaCggIlsqXiRdPSIgKyB3aGl0ZXNwYWNlICsgIiooPzonJ3xcIlwiKSIgKTsKCQkJCX0KCgkJCQkvLyBTdXBwb3J0OiBJRTgKCQkJCS8vIEJvb2xlYW4gYXR0cmlidXRlcyBhbmQgInZhbHVlIiBhcmUgbm90IHRyZWF0ZWQgY29ycmVjdGx5CgkJCQlpZiAoICFkaXYucXVlcnlTZWxlY3RvckFsbCgiW3NlbGVjdGVkXSIpLmxlbmd0aCApIHsKCQkJCQlyYnVnZ3lRU0EucHVzaCggIlxcWyIgKyB3aGl0ZXNwYWNlICsgIiooPzp2YWx1ZXwiICsgYm9vbGVhbnMgKyAiKSIgKTsKCQkJCX0KCgkJCQkvLyBTdXBwb3J0OiBDaHJvbWU8MjksIEFuZHJvaWQ8NC4yKywgU2FmYXJpPDcuMCssIGlPUzw3LjArLCBQaGFudG9tSlM8MS45LjcrCgkJCQlpZiAoICFkaXYucXVlcnlTZWxlY3RvckFsbCggIltpZH49IiArIGV4cGFuZG8gKyAiLV0iICkubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCJ+PSIpOwoJCQkJfQoKCQkJCS8vIFdlYmtpdC9PcGVyYSAtIDpjaGVja2VkIHNob3VsZCByZXR1cm4gc2VsZWN0ZWQgb3B0aW9uIGVsZW1lbnRzCgkJCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi8yMDExL1JFQy1jc3MzLXNlbGVjdG9ycy0yMDExMDkyOS8jY2hlY2tlZAoJCQkJLy8gSUU4IHRocm93cyBlcnJvciBoZXJlIGFuZCB3aWxsIG5vdCBzZWUgbGF0ZXIgdGVzdHMKCQkJCWlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0aCApIHsKCQkJCQlyYnVnZ3lRU0EucHVzaCgiOmNoZWNrZWQiKTsKCQkJCX0KCgkJCQkvLyBTdXBwb3J0OiBTYWZhcmkgOCssIGlPUyA4KwoJCQkJLy8gaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTEzNjg1MQoJCQkJLy8gSW4tcGFnZSBgc2VsZWN0b3IjaWQgc2liaW5nLWNvbWJpbmF0b3Igc2VsZWN0b3JgIGZhaWxzCgkJCQlpZiAoICFkaXYucXVlcnlTZWxlY3RvckFsbCggImEjIiArIGV4cGFuZG8gKyAiKyoiICkubGVuZ3RoICkgewoJCQkJCXJidWdneVFTQS5wdXNoKCIuIy4rWyt+XSIpOwoJCQkJfQoJCQl9KTsKCgkJCWFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCQkJLy8gU3VwcG9ydDogV2luZG93cyA4IE5hdGl2ZSBBcHBzCgkJCQkvLyBUaGUgdHlwZSBhbmQgbmFtZSBhdHRyaWJ1dGVzIGFyZSByZXN0cmljdGVkIGR1cmluZyAuaW5uZXJIVE1MIGFzc2lnbm1lbnQKCQkJCXZhciBpbnB1dCA9IGRvYy5jcmVhdGVFbGVtZW50KCJpbnB1dCIpOwoJCQkJaW5wdXQuc2V0QXR0cmlidXRlKCAidHlwZSIsICJoaWRkZW4iICk7CgkJCQlkaXYuYXBwZW5kQ2hpbGQoIGlucHV0ICkuc2V0QXR0cmlidXRlKCAibmFtZSIsICJEIiApOwoKCQkJCS8vIFN1cHBvcnQ6IElFOAoJCQkJLy8gRW5mb3JjZSBjYXNlLXNlbnNpdGl2aXR5IG9mIG5hbWUgYXR0cmlidXRlCgkJCQlpZiAoIGRpdi5xdWVyeVNlbGVjdG9yQWxsKCJbbmFtZT1kXSIpLmxlbmd0aCApIHsKCQkJCQlyYnVnZ3lRU0EucHVzaCggIm5hbWUiICsgd2hpdGVzcGFjZSArICIqWypeJHwhfl0/PSIgKTsKCQkJCX0KCgkJCQkvLyBGRiAzLjUgLSA6ZW5hYmxlZC86ZGlzYWJsZWQgYW5kIGhpZGRlbiBlbGVtZW50cyAoaGlkZGVuIGVsZW1lbnRzIGFyZSBzdGlsbCBlbmFibGVkKQoJCQkJLy8gSUU4IHRocm93cyBlcnJvciBoZXJlIGFuZCB3aWxsIG5vdCBzZWUgbGF0ZXIgdGVzdHMKCQkJCWlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCI6ZW5hYmxlZCIpLmxlbmd0aCApIHsKCQkJCQlyYnVnZ3lRU0EucHVzaCggIjplbmFibGVkIiwgIjpkaXNhYmxlZCIgKTsKCQkJCX0KCgkJCQkvLyBPcGVyYSAxMC0xMSBkb2VzIG5vdCB0aHJvdyBvbiBwb3N0LWNvbW1hIGludmFsaWQgcHNldWRvcwoJCQkJZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIiosOngiKTsKCQkJCXJidWdneVFTQS5wdXNoKCIsLio6Iik7CgkJCX0pOwoJCX0KCgkJaWYgKCAoc3VwcG9ydC5tYXRjaGVzU2VsZWN0b3IgPSBybmF0aXZlLnRlc3QoIChtYXRjaGVzID0gZG9jRWxlbS5tYXRjaGVzIHx8CgkJCWRvY0VsZW0ud2Via2l0TWF0Y2hlc1NlbGVjdG9yIHx8CgkJCWRvY0VsZW0ubW96TWF0Y2hlc1NlbGVjdG9yIHx8CgkJCWRvY0VsZW0ub01hdGNoZXNTZWxlY3RvciB8fAoJCQlkb2NFbGVtLm1zTWF0Y2hlc1NlbGVjdG9yKSApKSApIHsKCgkJCWFzc2VydChmdW5jdGlvbiggZGl2ICkgewoJCQkJLy8gQ2hlY2sgdG8gc2VlIGlmIGl0J3MgcG9zc2libGUgdG8gZG8gbWF0Y2hlc1NlbGVjdG9yCgkJCQkvLyBvbiBhIGRpc2Nvbm5lY3RlZCBub2RlIChJRSA5KQoJCQkJc3VwcG9ydC5kaXNjb25uZWN0ZWRNYXRjaCA9IG1hdGNoZXMuY2FsbCggZGl2LCAiZGl2IiApOwoKCQkJCS8vIFRoaXMgc2hvdWxkIGZhaWwgd2l0aCBhbiBleGNlcHRpb24KCQkJCS8vIEdlY2tvIGRvZXMgbm90IGVycm9yLCByZXR1cm5zIGZhbHNlIGluc3RlYWQKCQkJCW1hdGNoZXMuY2FsbCggZGl2LCAiW3MhPScnXTp4IiApOwoJCQkJcmJ1Z2d5TWF0Y2hlcy5wdXNoKCAiIT0iLCBwc2V1ZG9zICk7CgkJCX0pOwoJCX0KCgkJcmJ1Z2d5UVNBID0gcmJ1Z2d5UVNBLmxlbmd0aCAmJiBuZXcgUmVnRXhwKCByYnVnZ3lRU0Euam9pbigifCIpICk7CgkJcmJ1Z2d5TWF0Y2hlcyA9IHJidWdneU1hdGNoZXMubGVuZ3RoICYmIG5ldyBSZWdFeHAoIHJidWdneU1hdGNoZXMuam9pbigifCIpICk7CgoJCS8qIENvbnRhaW5zCgkJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoJCWhhc0NvbXBhcmUgPSBybmF0aXZlLnRlc3QoIGRvY0VsZW0uY29tcGFyZURvY3VtZW50UG9zaXRpb24gKTsKCgkJLy8gRWxlbWVudCBjb250YWlucyBhbm90aGVyCgkJLy8gUHVycG9zZWZ1bGx5IGRvZXMgbm90IGltcGxlbWVudCBpbmNsdXNpdmUgZGVzY2VuZGVudAoJCS8vIEFzIGluLCBhbiBlbGVtZW50IGRvZXMgbm90IGNvbnRhaW4gaXRzZWxmCgkJY29udGFpbnMgPSBoYXNDb21wYXJlIHx8IHJuYXRpdmUudGVzdCggZG9jRWxlbS5jb250YWlucyApID8KCQkJZnVuY3Rpb24oIGEsIGIgKSB7CgkJCQl2YXIgYWRvd24gPSBhLm5vZGVUeXBlID09PSA5ID8gYS5kb2N1bWVudEVsZW1lbnQgOiBhLAoJCQkJCWJ1cCA9IGIgJiYgYi5wYXJlbnROb2RlOwoJCQkJcmV0dXJuIGEgPT09IGJ1cCB8fCAhISggYnVwICYmIGJ1cC5ub2RlVHlwZSA9PT0gMSAmJiAoCgkJCQkJYWRvd24uY29udGFpbnMgPwoJCQkJCQlhZG93bi5jb250YWlucyggYnVwICkgOgoJCQkJCQlhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uICYmIGEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oIGJ1cCApICYgMTYKCQkJCSkpOwoJCQl9IDoKCQkJZnVuY3Rpb24oIGEsIGIgKSB7CgkJCQlpZiAoIGIgKSB7CgkJCQkJd2hpbGUgKCAoYiA9IGIucGFyZW50Tm9kZSkgKSB7CgkJCQkJCWlmICggYiA9PT0gYSApIHsKCQkJCQkJCXJldHVybiB0cnVlOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9OwoKCQkvKiBTb3J0aW5nCgkJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKCQkvLyBEb2N1bWVudCBvcmRlciBzb3J0aW5nCgkJc29ydE9yZGVyID0gaGFzQ29tcGFyZSA/CgkJZnVuY3Rpb24oIGEsIGIgKSB7CgoJCQkvLyBGbGFnIGZvciBkdXBsaWNhdGUgcmVtb3ZhbAoJCQlpZiAoIGEgPT09IGIgKSB7CgkJCQloYXNEdXBsaWNhdGUgPSB0cnVlOwoJCQkJcmV0dXJuIDA7CgkJCX0KCgkJCS8vIFNvcnQgb24gbWV0aG9kIGV4aXN0ZW5jZSBpZiBvbmx5IG9uZSBpbnB1dCBoYXMgY29tcGFyZURvY3VtZW50UG9zaXRpb24KCQkJdmFyIGNvbXBhcmUgPSAhYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiAtICFiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uOwoJCQlpZiAoIGNvbXBhcmUgKSB7CgkJCQlyZXR1cm4gY29tcGFyZTsKCQkJfQoKCQkJLy8gQ2FsY3VsYXRlIHBvc2l0aW9uIGlmIGJvdGggaW5wdXRzIGJlbG9uZyB0byB0aGUgc2FtZSBkb2N1bWVudAoJCQljb21wYXJlID0gKCBhLm93bmVyRG9jdW1lbnQgfHwgYSApID09PSAoIGIub3duZXJEb2N1bWVudCB8fCBiICkgPwoJCQkJYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggYiApIDoKCgkJCQkvLyBPdGhlcndpc2Ugd2Uga25vdyB0aGV5IGFyZSBkaXNjb25uZWN0ZWQKCQkJCTE7CgoJCQkvLyBEaXNjb25uZWN0ZWQgbm9kZXMKCQkJaWYgKCBjb21wYXJlICYgMSB8fAoJCQkJKCFzdXBwb3J0LnNvcnREZXRhY2hlZCAmJiBiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKCBhICkgPT09IGNvbXBhcmUpICkgewoKCQkJCS8vIENob29zZSB0aGUgZmlyc3QgZWxlbWVudCB0aGF0IGlzIHJlbGF0ZWQgdG8gb3VyIHByZWZlcnJlZCBkb2N1bWVudAoJCQkJaWYgKCBhID09PSBkb2MgfHwgYS5vd25lckRvY3VtZW50ID09PSBwcmVmZXJyZWREb2MgJiYgY29udGFpbnMocHJlZmVycmVkRG9jLCBhKSApIHsKCQkJCQlyZXR1cm4gLTE7CgkJCQl9CgkJCQlpZiAoIGIgPT09IGRvYyB8fCBiLm93bmVyRG9jdW1lbnQgPT09IHByZWZlcnJlZERvYyAmJiBjb250YWlucyhwcmVmZXJyZWREb2MsIGIpICkgewoJCQkJCXJldHVybiAxOwoJCQkJfQoKCQkJCS8vIE1haW50YWluIG9yaWdpbmFsIG9yZGVyCgkJCQlyZXR1cm4gc29ydElucHV0ID8KCQkJCQkoIGluZGV4T2YoIHNvcnRJbnB1dCwgYSApIC0gaW5kZXhPZiggc29ydElucHV0LCBiICkgKSA6CgkJCQkJMDsKCQkJfQoKCQkJcmV0dXJuIGNvbXBhcmUgJiA0ID8gLTEgOiAxOwoJCX0gOgoJCWZ1bmN0aW9uKCBhLCBiICkgewoJCQkvLyBFeGl0IGVhcmx5IGlmIHRoZSBub2RlcyBhcmUgaWRlbnRpY2FsCgkJCWlmICggYSA9PT0gYiApIHsKCQkJCWhhc0R1cGxpY2F0ZSA9IHRydWU7CgkJCQlyZXR1cm4gMDsKCQkJfQoKCQkJdmFyIGN1ciwKCQkJCWkgPSAwLAoJCQkJYXVwID0gYS5wYXJlbnROb2RlLAoJCQkJYnVwID0gYi5wYXJlbnROb2RlLAoJCQkJYXAgPSBbIGEgXSwKCQkJCWJwID0gWyBiIF07CgoJCQkvLyBQYXJlbnRsZXNzIG5vZGVzIGFyZSBlaXRoZXIgZG9jdW1lbnRzIG9yIGRpc2Nvbm5lY3RlZAoJCQlpZiAoICFhdXAgfHwgIWJ1cCApIHsKCQkJCXJldHVybiBhID09PSBkb2MgPyAtMSA6CgkJCQkJYiA9PT0gZG9jID8gMSA6CgkJCQkJYXVwID8gLTEgOgoJCQkJCWJ1cCA/IDEgOgoJCQkJCXNvcnRJbnB1dCA/CgkJCQkJKCBpbmRleE9mKCBzb3J0SW5wdXQsIGEgKSAtIGluZGV4T2YoIHNvcnRJbnB1dCwgYiApICkgOgoJCQkJCTA7CgoJCQkvLyBJZiB0aGUgbm9kZXMgYXJlIHNpYmxpbmdzLCB3ZSBjYW4gZG8gYSBxdWljayBjaGVjawoJCQl9IGVsc2UgaWYgKCBhdXAgPT09IGJ1cCApIHsKCQkJCXJldHVybiBzaWJsaW5nQ2hlY2soIGEsIGIgKTsKCQkJfQoKCQkJLy8gT3RoZXJ3aXNlIHdlIG5lZWQgZnVsbCBsaXN0cyBvZiB0aGVpciBhbmNlc3RvcnMgZm9yIGNvbXBhcmlzb24KCQkJY3VyID0gYTsKCQkJd2hpbGUgKCAoY3VyID0gY3VyLnBhcmVudE5vZGUpICkgewoJCQkJYXAudW5zaGlmdCggY3VyICk7CgkJCX0KCQkJY3VyID0gYjsKCQkJd2hpbGUgKCAoY3VyID0gY3VyLnBhcmVudE5vZGUpICkgewoJCQkJYnAudW5zaGlmdCggY3VyICk7CgkJCX0KCgkJCS8vIFdhbGsgZG93biB0aGUgdHJlZSBsb29raW5nIGZvciBhIGRpc2NyZXBhbmN5CgkJCXdoaWxlICggYXBbaV0gPT09IGJwW2ldICkgewoJCQkJaSsrOwoJCQl9CgoJCQlyZXR1cm4gaSA/CgkJCQkvLyBEbyBhIHNpYmxpbmcgY2hlY2sgaWYgdGhlIG5vZGVzIGhhdmUgYSBjb21tb24gYW5jZXN0b3IKCQkJCXNpYmxpbmdDaGVjayggYXBbaV0sIGJwW2ldICkgOgoKCQkJCS8vIE90aGVyd2lzZSBub2RlcyBpbiBvdXIgZG9jdW1lbnQgc29ydCBmaXJzdAoJCQkJYXBbaV0gPT09IHByZWZlcnJlZERvYyA/IC0xIDoKCQkJCWJwW2ldID09PSBwcmVmZXJyZWREb2MgPyAxIDoKCQkJCTA7CgkJfTsKCgkJcmV0dXJuIGRvYzsKCX07CgoJU2l6emxlLm1hdGNoZXMgPSBmdW5jdGlvbiggZXhwciwgZWxlbWVudHMgKSB7CgkJcmV0dXJuIFNpenpsZSggZXhwciwgbnVsbCwgbnVsbCwgZWxlbWVudHMgKTsKCX07CgoJU2l6emxlLm1hdGNoZXNTZWxlY3RvciA9IGZ1bmN0aW9uKCBlbGVtLCBleHByICkgewoJCS8vIFNldCBkb2N1bWVudCB2YXJzIGlmIG5lZWRlZAoJCWlmICggKCBlbGVtLm93bmVyRG9jdW1lbnQgfHwgZWxlbSApICE9PSBkb2N1bWVudCApIHsKCQkJc2V0RG9jdW1lbnQoIGVsZW0gKTsKCQl9CgoJCS8vIE1ha2Ugc3VyZSB0aGF0IGF0dHJpYnV0ZSBzZWxlY3RvcnMgYXJlIHF1b3RlZAoJCWV4cHIgPSBleHByLnJlcGxhY2UoIHJhdHRyaWJ1dGVRdW90ZXMsICI9JyQxJ10iICk7CgoJCWlmICggc3VwcG9ydC5tYXRjaGVzU2VsZWN0b3IgJiYgZG9jdW1lbnRJc0hUTUwgJiYKCQkJKCAhcmJ1Z2d5TWF0Y2hlcyB8fCAhcmJ1Z2d5TWF0Y2hlcy50ZXN0KCBleHByICkgKSAmJgoJCQkoICFyYnVnZ3lRU0EgICAgIHx8ICFyYnVnZ3lRU0EudGVzdCggZXhwciApICkgKSB7CgoJCQl0cnkgewoJCQkJdmFyIHJldCA9IG1hdGNoZXMuY2FsbCggZWxlbSwgZXhwciApOwoKCQkJCS8vIElFIDkncyBtYXRjaGVzU2VsZWN0b3IgcmV0dXJucyBmYWxzZSBvbiBkaXNjb25uZWN0ZWQgbm9kZXMKCQkJCWlmICggcmV0IHx8IHN1cHBvcnQuZGlzY29ubmVjdGVkTWF0Y2ggfHwKCQkJCQkJLy8gQXMgd2VsbCwgZGlzY29ubmVjdGVkIG5vZGVzIGFyZSBzYWlkIHRvIGJlIGluIGEgZG9jdW1lbnQKCQkJCQkJLy8gZnJhZ21lbnQgaW4gSUUgOQoJCQkJCQllbGVtLmRvY3VtZW50ICYmIGVsZW0uZG9jdW1lbnQubm9kZVR5cGUgIT09IDExICkgewoJCQkJCXJldHVybiByZXQ7CgkJCQl9CgkJCX0gY2F0Y2ggKGUpIHt9CgkJfQoKCQlyZXR1cm4gU2l6emxlKCBleHByLCBkb2N1bWVudCwgbnVsbCwgWyBlbGVtIF0gKS5sZW5ndGggPiAwOwoJfTsKCglTaXp6bGUuY29udGFpbnMgPSBmdW5jdGlvbiggY29udGV4dCwgZWxlbSApIHsKCQkvLyBTZXQgZG9jdW1lbnQgdmFycyBpZiBuZWVkZWQKCQlpZiAoICggY29udGV4dC5vd25lckRvY3VtZW50IHx8IGNvbnRleHQgKSAhPT0gZG9jdW1lbnQgKSB7CgkJCXNldERvY3VtZW50KCBjb250ZXh0ICk7CgkJfQoJCXJldHVybiBjb250YWlucyggY29udGV4dCwgZWxlbSApOwoJfTsKCglTaXp6bGUuYXR0ciA9IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkgewoJCS8vIFNldCBkb2N1bWVudCB2YXJzIGlmIG5lZWRlZAoJCWlmICggKCBlbGVtLm93bmVyRG9jdW1lbnQgfHwgZWxlbSApICE9PSBkb2N1bWVudCApIHsKCQkJc2V0RG9jdW1lbnQoIGVsZW0gKTsKCQl9CgoJCXZhciBmbiA9IEV4cHIuYXR0ckhhbmRsZVsgbmFtZS50b0xvd2VyQ2FzZSgpIF0sCgkJCS8vIERvbid0IGdldCBmb29sZWQgYnkgT2JqZWN0LnByb3RvdHlwZSBwcm9wZXJ0aWVzIChqUXVlcnkgIzEzODA3KQoJCQl2YWwgPSBmbiAmJiBoYXNPd24uY2FsbCggRXhwci5hdHRySGFuZGxlLCBuYW1lLnRvTG93ZXJDYXNlKCkgKSA/CgkJCQlmbiggZWxlbSwgbmFtZSwgIWRvY3VtZW50SXNIVE1MICkgOgoJCQkJdW5kZWZpbmVkOwoKCQlyZXR1cm4gdmFsICE9PSB1bmRlZmluZWQgPwoJCQl2YWwgOgoJCQlzdXBwb3J0LmF0dHJpYnV0ZXMgfHwgIWRvY3VtZW50SXNIVE1MID8KCQkJCWVsZW0uZ2V0QXR0cmlidXRlKCBuYW1lICkgOgoJCQkJKHZhbCA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZShuYW1lKSkgJiYgdmFsLnNwZWNpZmllZCA/CgkJCQkJdmFsLnZhbHVlIDoKCQkJCQludWxsOwoJfTsKCglTaXp6bGUuZXJyb3IgPSBmdW5jdGlvbiggbXNnICkgewoJCXRocm93IG5ldyBFcnJvciggIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246ICIgKyBtc2cgKTsKCX07CgoJLyoqCgkgKiBEb2N1bWVudCBzb3J0aW5nIGFuZCByZW1vdmluZyBkdXBsaWNhdGVzCgkgKiBAcGFyYW0ge0FycmF5TGlrZX0gcmVzdWx0cwoJICovCglTaXp6bGUudW5pcXVlU29ydCA9IGZ1bmN0aW9uKCByZXN1bHRzICkgewoJCXZhciBlbGVtLAoJCQlkdXBsaWNhdGVzID0gW10sCgkJCWogPSAwLAoJCQlpID0gMDsKCgkJLy8gVW5sZXNzIHdlICprbm93KiB3ZSBjYW4gZGV0ZWN0IGR1cGxpY2F0ZXMsIGFzc3VtZSB0aGVpciBwcmVzZW5jZQoJCWhhc0R1cGxpY2F0ZSA9ICFzdXBwb3J0LmRldGVjdER1cGxpY2F0ZXM7CgkJc29ydElucHV0ID0gIXN1cHBvcnQuc29ydFN0YWJsZSAmJiByZXN1bHRzLnNsaWNlKCAwICk7CgkJcmVzdWx0cy5zb3J0KCBzb3J0T3JkZXIgKTsKCgkJaWYgKCBoYXNEdXBsaWNhdGUgKSB7CgkJCXdoaWxlICggKGVsZW0gPSByZXN1bHRzW2krK10pICkgewoJCQkJaWYgKCBlbGVtID09PSByZXN1bHRzWyBpIF0gKSB7CgkJCQkJaiA9IGR1cGxpY2F0ZXMucHVzaCggaSApOwoJCQkJfQoJCQl9CgkJCXdoaWxlICggai0tICkgewoJCQkJcmVzdWx0cy5zcGxpY2UoIGR1cGxpY2F0ZXNbIGogXSwgMSApOwoJCQl9CgkJfQoKCQkvLyBDbGVhciBpbnB1dCBhZnRlciBzb3J0aW5nIHRvIHJlbGVhc2Ugb2JqZWN0cwoJCS8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vanF1ZXJ5L3NpenpsZS9wdWxsLzIyNQoJCXNvcnRJbnB1dCA9IG51bGw7CgoJCXJldHVybiByZXN1bHRzOwoJfTsKCgkvKioKCSAqIFV0aWxpdHkgZnVuY3Rpb24gZm9yIHJldHJpZXZpbmcgdGhlIHRleHQgdmFsdWUgb2YgYW4gYXJyYXkgb2YgRE9NIG5vZGVzCgkgKiBAcGFyYW0ge0FycmF5fEVsZW1lbnR9IGVsZW0KCSAqLwoJZ2V0VGV4dCA9IFNpenpsZS5nZXRUZXh0ID0gZnVuY3Rpb24oIGVsZW0gKSB7CgkJdmFyIG5vZGUsCgkJCXJldCA9ICIiLAoJCQlpID0gMCwKCQkJbm9kZVR5cGUgPSBlbGVtLm5vZGVUeXBlOwoKCQlpZiAoICFub2RlVHlwZSApIHsKCQkJLy8gSWYgbm8gbm9kZVR5cGUsIHRoaXMgaXMgZXhwZWN0ZWQgdG8gYmUgYW4gYXJyYXkKCQkJd2hpbGUgKCAobm9kZSA9IGVsZW1baSsrXSkgKSB7CgkJCQkvLyBEbyBub3QgdHJhdmVyc2UgY29tbWVudCBub2RlcwoJCQkJcmV0ICs9IGdldFRleHQoIG5vZGUgKTsKCQkJfQoJCX0gZWxzZSBpZiAoIG5vZGVUeXBlID09PSAxIHx8IG5vZGVUeXBlID09PSA5IHx8IG5vZGVUeXBlID09PSAxMSApIHsKCQkJLy8gVXNlIHRleHRDb250ZW50IGZvciBlbGVtZW50cwoJCQkvLyBpbm5lclRleHQgdXNhZ2UgcmVtb3ZlZCBmb3IgY29uc2lzdGVuY3kgb2YgbmV3IGxpbmVzIChqUXVlcnkgIzExMTUzKQoJCQlpZiAoIHR5cGVvZiBlbGVtLnRleHRDb250ZW50ID09PSAic3RyaW5nIiApIHsKCQkJCXJldHVybiBlbGVtLnRleHRDb250ZW50OwoJCQl9IGVsc2UgewoJCQkJLy8gVHJhdmVyc2UgaXRzIGNoaWxkcmVuCgkJCQlmb3IgKCBlbGVtID0gZWxlbS5maXJzdENoaWxkOyBlbGVtOyBlbGVtID0gZWxlbS5uZXh0U2libGluZyApIHsKCQkJCQlyZXQgKz0gZ2V0VGV4dCggZWxlbSApOwoJCQkJfQoJCQl9CgkJfSBlbHNlIGlmICggbm9kZVR5cGUgPT09IDMgfHwgbm9kZVR5cGUgPT09IDQgKSB7CgkJCXJldHVybiBlbGVtLm5vZGVWYWx1ZTsKCQl9CgkJLy8gRG8gbm90IGluY2x1ZGUgY29tbWVudCBvciBwcm9jZXNzaW5nIGluc3RydWN0aW9uIG5vZGVzCgoJCXJldHVybiByZXQ7Cgl9OwoKCUV4cHIgPSBTaXp6bGUuc2VsZWN0b3JzID0gewoKCQkvLyBDYW4gYmUgYWRqdXN0ZWQgYnkgdGhlIHVzZXIKCQljYWNoZUxlbmd0aDogNTAsCgoJCWNyZWF0ZVBzZXVkbzogbWFya0Z1bmN0aW9uLAoKCQltYXRjaDogbWF0Y2hFeHByLAoKCQlhdHRySGFuZGxlOiB7fSwKCgkJZmluZDoge30sCgoJCXJlbGF0aXZlOiB7CgkJCSI+IjogeyBkaXI6ICJwYXJlbnROb2RlIiwgZmlyc3Q6IHRydWUgfSwKCQkJIiAiOiB7IGRpcjogInBhcmVudE5vZGUiIH0sCgkJCSIrIjogeyBkaXI6ICJwcmV2aW91c1NpYmxpbmciLCBmaXJzdDogdHJ1ZSB9LAoJCQkifiI6IHsgZGlyOiAicHJldmlvdXNTaWJsaW5nIiB9CgkJfSwKCgkJcHJlRmlsdGVyOiB7CgkJCSJBVFRSIjogZnVuY3Rpb24oIG1hdGNoICkgewoJCQkJbWF0Y2hbMV0gPSBtYXRjaFsxXS5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApOwoKCQkJCS8vIE1vdmUgdGhlIGdpdmVuIHZhbHVlIHRvIG1hdGNoWzNdIHdoZXRoZXIgcXVvdGVkIG9yIHVucXVvdGVkCgkJCQltYXRjaFszXSA9ICggbWF0Y2hbM10gfHwgbWF0Y2hbNF0gfHwgbWF0Y2hbNV0gfHwgIiIgKS5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApOwoKCQkJCWlmICggbWF0Y2hbMl0gPT09ICJ+PSIgKSB7CgkJCQkJbWF0Y2hbM10gPSAiICIgKyBtYXRjaFszXSArICIgIjsKCQkJCX0KCgkJCQlyZXR1cm4gbWF0Y2guc2xpY2UoIDAsIDQgKTsKCQkJfSwKCgkJCSJDSElMRCI6IGZ1bmN0aW9uKCBtYXRjaCApIHsKCQkJCS8qIG1hdGNoZXMgZnJvbSBtYXRjaEV4cHJbIkNISUxEIl0KCQkJCQkxIHR5cGUgKG9ubHl8bnRofC4uLikKCQkJCQkyIHdoYXQgKGNoaWxkfG9mLXR5cGUpCgkJCQkJMyBhcmd1bWVudCAoZXZlbnxvZGR8XGQqfFxkKm4oWystXVxkKyk/fC4uLikKCQkJCQk0IHhuLWNvbXBvbmVudCBvZiB4bit5IGFyZ3VtZW50IChbKy1dP1xkKm58KQoJCQkJCTUgc2lnbiBvZiB4bi1jb21wb25lbnQKCQkJCQk2IHggb2YgeG4tY29tcG9uZW50CgkJCQkJNyBzaWduIG9mIHktY29tcG9uZW50CgkJCQkJOCB5IG9mIHktY29tcG9uZW50CgkJCQkqLwoJCQkJbWF0Y2hbMV0gPSBtYXRjaFsxXS50b0xvd2VyQ2FzZSgpOwoKCQkJCWlmICggbWF0Y2hbMV0uc2xpY2UoIDAsIDMgKSA9PT0gIm50aCIgKSB7CgkJCQkJLy8gbnRoLSogcmVxdWlyZXMgYXJndW1lbnQKCQkJCQlpZiAoICFtYXRjaFszXSApIHsKCQkJCQkJU2l6emxlLmVycm9yKCBtYXRjaFswXSApOwoJCQkJCX0KCgkJCQkJLy8gbnVtZXJpYyB4IGFuZCB5IHBhcmFtZXRlcnMgZm9yIEV4cHIuZmlsdGVyLkNISUxECgkJCQkJLy8gcmVtZW1iZXIgdGhhdCBmYWxzZS90cnVlIGNhc3QgcmVzcGVjdGl2ZWx5IHRvIDAvMQoJCQkJCW1hdGNoWzRdID0gKyggbWF0Y2hbNF0gPyBtYXRjaFs1XSArIChtYXRjaFs2XSB8fCAxKSA6IDIgKiAoIG1hdGNoWzNdID09PSAiZXZlbiIgfHwgbWF0Y2hbM10gPT09ICJvZGQiICkgKTsKCQkJCQltYXRjaFs1XSA9ICsoICggbWF0Y2hbN10gKyBtYXRjaFs4XSApIHx8IG1hdGNoWzNdID09PSAib2RkIiApOwoKCQkJCS8vIG90aGVyIHR5cGVzIHByb2hpYml0IGFyZ3VtZW50cwoJCQkJfSBlbHNlIGlmICggbWF0Y2hbM10gKSB7CgkJCQkJU2l6emxlLmVycm9yKCBtYXRjaFswXSApOwoJCQkJfQoKCQkJCXJldHVybiBtYXRjaDsKCQkJfSwKCgkJCSJQU0VVRE8iOiBmdW5jdGlvbiggbWF0Y2ggKSB7CgkJCQl2YXIgZXhjZXNzLAoJCQkJCXVucXVvdGVkID0gIW1hdGNoWzZdICYmIG1hdGNoWzJdOwoKCQkJCWlmICggbWF0Y2hFeHByWyJDSElMRCJdLnRlc3QoIG1hdGNoWzBdICkgKSB7CgkJCQkJcmV0dXJuIG51bGw7CgkJCQl9CgoJCQkJLy8gQWNjZXB0IHF1b3RlZCBhcmd1bWVudHMgYXMtaXMKCQkJCWlmICggbWF0Y2hbM10gKSB7CgkJCQkJbWF0Y2hbMl0gPSBtYXRjaFs0XSB8fCBtYXRjaFs1XSB8fCAiIjsKCgkJCQkvLyBTdHJpcCBleGNlc3MgY2hhcmFjdGVycyBmcm9tIHVucXVvdGVkIGFyZ3VtZW50cwoJCQkJfSBlbHNlIGlmICggdW5xdW90ZWQgJiYgcnBzZXVkby50ZXN0KCB1bnF1b3RlZCApICYmCgkJCQkJLy8gR2V0IGV4Y2VzcyBmcm9tIHRva2VuaXplIChyZWN1cnNpdmVseSkKCQkJCQkoZXhjZXNzID0gdG9rZW5pemUoIHVucXVvdGVkLCB0cnVlICkpICYmCgkJCQkJLy8gYWR2YW5jZSB0byB0aGUgbmV4dCBjbG9zaW5nIHBhcmVudGhlc2lzCgkJCQkJKGV4Y2VzcyA9IHVucXVvdGVkLmluZGV4T2YoICIpIiwgdW5xdW90ZWQubGVuZ3RoIC0gZXhjZXNzICkgLSB1bnF1b3RlZC5sZW5ndGgpICkgewoKCQkJCQkvLyBleGNlc3MgaXMgYSBuZWdhdGl2ZSBpbmRleAoJCQkJCW1hdGNoWzBdID0gbWF0Y2hbMF0uc2xpY2UoIDAsIGV4Y2VzcyApOwoJCQkJCW1hdGNoWzJdID0gdW5xdW90ZWQuc2xpY2UoIDAsIGV4Y2VzcyApOwoJCQkJfQoKCQkJCS8vIFJldHVybiBvbmx5IGNhcHR1cmVzIG5lZWRlZCBieSB0aGUgcHNldWRvIGZpbHRlciBtZXRob2QgKHR5cGUgYW5kIGFyZ3VtZW50KQoJCQkJcmV0dXJuIG1hdGNoLnNsaWNlKCAwLCAzICk7CgkJCX0KCQl9LAoKCQlmaWx0ZXI6IHsKCgkJCSJUQUciOiBmdW5jdGlvbiggbm9kZU5hbWVTZWxlY3RvciApIHsKCQkJCXZhciBub2RlTmFtZSA9IG5vZGVOYW1lU2VsZWN0b3IucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKS50b0xvd2VyQ2FzZSgpOwoJCQkJcmV0dXJuIG5vZGVOYW1lU2VsZWN0b3IgPT09ICIqIiA/CgkJCQkJZnVuY3Rpb24oKSB7IHJldHVybiB0cnVlOyB9IDoKCQkJCQlmdW5jdGlvbiggZWxlbSApIHsKCQkJCQkJcmV0dXJuIGVsZW0ubm9kZU5hbWUgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBub2RlTmFtZTsKCQkJCQl9OwoJCQl9LAoKCQkJIkNMQVNTIjogZnVuY3Rpb24oIGNsYXNzTmFtZSApIHsKCQkJCXZhciBwYXR0ZXJuID0gY2xhc3NDYWNoZVsgY2xhc3NOYW1lICsgIiAiIF07CgoJCQkJcmV0dXJuIHBhdHRlcm4gfHwKCQkJCQkocGF0dGVybiA9IG5ldyBSZWdFeHAoICIoXnwiICsgd2hpdGVzcGFjZSArICIpIiArIGNsYXNzTmFtZSArICIoIiArIHdoaXRlc3BhY2UgKyAifCQpIiApKSAmJgoJCQkJCWNsYXNzQ2FjaGUoIGNsYXNzTmFtZSwgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJCXJldHVybiBwYXR0ZXJuLnRlc3QoIHR5cGVvZiBlbGVtLmNsYXNzTmFtZSA9PT0gInN0cmluZyIgJiYgZWxlbS5jbGFzc05hbWUgfHwgdHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlICE9PSAidW5kZWZpbmVkIiAmJiBlbGVtLmdldEF0dHJpYnV0ZSgiY2xhc3MiKSB8fCAiIiApOwoJCQkJCX0pOwoJCQl9LAoKCQkJIkFUVFIiOiBmdW5jdGlvbiggbmFtZSwgb3BlcmF0b3IsIGNoZWNrICkgewoJCQkJcmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCXZhciByZXN1bHQgPSBTaXp6bGUuYXR0ciggZWxlbSwgbmFtZSApOwoKCQkJCQlpZiAoIHJlc3VsdCA9PSBudWxsICkgewoJCQkJCQlyZXR1cm4gb3BlcmF0b3IgPT09ICIhPSI7CgkJCQkJfQoJCQkJCWlmICggIW9wZXJhdG9yICkgewoJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQl9CgoJCQkJCXJlc3VsdCArPSAiIjsKCgkJCQkJcmV0dXJuIG9wZXJhdG9yID09PSAiPSIgPyByZXN1bHQgPT09IGNoZWNrIDoKCQkJCQkJb3BlcmF0b3IgPT09ICIhPSIgPyByZXN1bHQgIT09IGNoZWNrIDoKCQkJCQkJb3BlcmF0b3IgPT09ICJePSIgPyBjaGVjayAmJiByZXN1bHQuaW5kZXhPZiggY2hlY2sgKSA9PT0gMCA6CgkJCQkJCW9wZXJhdG9yID09PSAiKj0iID8gY2hlY2sgJiYgcmVzdWx0LmluZGV4T2YoIGNoZWNrICkgPiAtMSA6CgkJCQkJCW9wZXJhdG9yID09PSAiJD0iID8gY2hlY2sgJiYgcmVzdWx0LnNsaWNlKCAtY2hlY2subGVuZ3RoICkgPT09IGNoZWNrIDoKCQkJCQkJb3BlcmF0b3IgPT09ICJ+PSIgPyAoICIgIiArIHJlc3VsdC5yZXBsYWNlKCByd2hpdGVzcGFjZSwgIiAiICkgKyAiICIgKS5pbmRleE9mKCBjaGVjayApID4gLTEgOgoJCQkJCQlvcGVyYXRvciA9PT0gInw9IiA/IHJlc3VsdCA9PT0gY2hlY2sgfHwgcmVzdWx0LnNsaWNlKCAwLCBjaGVjay5sZW5ndGggKyAxICkgPT09IGNoZWNrICsgIi0iIDoKCQkJCQkJZmFsc2U7CgkJCQl9OwoJCQl9LAoKCQkJIkNISUxEIjogZnVuY3Rpb24oIHR5cGUsIHdoYXQsIGFyZ3VtZW50LCBmaXJzdCwgbGFzdCApIHsKCQkJCXZhciBzaW1wbGUgPSB0eXBlLnNsaWNlKCAwLCAzICkgIT09ICJudGgiLAoJCQkJCWZvcndhcmQgPSB0eXBlLnNsaWNlKCAtNCApICE9PSAibGFzdCIsCgkJCQkJb2ZUeXBlID0gd2hhdCA9PT0gIm9mLXR5cGUiOwoKCQkJCXJldHVybiBmaXJzdCA9PT0gMSAmJiBsYXN0ID09PSAwID8KCgkJCQkJLy8gU2hvcnRjdXQgZm9yIDpudGgtKihuKQoJCQkJCWZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCQlyZXR1cm4gISFlbGVtLnBhcmVudE5vZGU7CgkJCQkJfSA6CgoJCQkJCWZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7CgkJCQkJCXZhciBjYWNoZSwgb3V0ZXJDYWNoZSwgbm9kZSwgZGlmZiwgbm9kZUluZGV4LCBzdGFydCwKCQkJCQkJCWRpciA9IHNpbXBsZSAhPT0gZm9yd2FyZCA/ICJuZXh0U2libGluZyIgOiAicHJldmlvdXNTaWJsaW5nIiwKCQkJCQkJCXBhcmVudCA9IGVsZW0ucGFyZW50Tm9kZSwKCQkJCQkJCW5hbWUgPSBvZlR5cGUgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLAoJCQkJCQkJdXNlQ2FjaGUgPSAheG1sICYmICFvZlR5cGU7CgoJCQkJCQlpZiAoIHBhcmVudCApIHsKCgkJCQkJCQkvLyA6KGZpcnN0fGxhc3R8b25seSktKGNoaWxkfG9mLXR5cGUpCgkJCQkJCQlpZiAoIHNpbXBsZSApIHsKCQkJCQkJCQl3aGlsZSAoIGRpciApIHsKCQkJCQkJCQkJbm9kZSA9IGVsZW07CgkJCQkJCQkJCXdoaWxlICggKG5vZGUgPSBub2RlWyBkaXIgXSkgKSB7CgkJCQkJCQkJCQlpZiAoIG9mVHlwZSA/IG5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbmFtZSA6IG5vZGUubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJCQkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJCQkJCQkJfQoJCQkJCQkJCQl9CgkJCQkJCQkJCS8vIFJldmVyc2UgZGlyZWN0aW9uIGZvciA6b25seS0qIChpZiB3ZSBoYXZlbid0IHlldCBkb25lIHNvKQoJCQkJCQkJCQlzdGFydCA9IGRpciA9IHR5cGUgPT09ICJvbmx5IiAmJiAhc3RhcnQgJiYgIm5leHRTaWJsaW5nIjsKCQkJCQkJCQl9CgkJCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJCQl9CgoJCQkJCQkJc3RhcnQgPSBbIGZvcndhcmQgPyBwYXJlbnQuZmlyc3RDaGlsZCA6IHBhcmVudC5sYXN0Q2hpbGQgXTsKCgkJCQkJCQkvLyBub24teG1sIDpudGgtY2hpbGQoLi4uKSBzdG9yZXMgY2FjaGUgZGF0YSBvbiBgcGFyZW50YAoJCQkJCQkJaWYgKCBmb3J3YXJkICYmIHVzZUNhY2hlICkgewoJCQkJCQkJCS8vIFNlZWsgYGVsZW1gIGZyb20gYSBwcmV2aW91c2x5LWNhY2hlZCBpbmRleAoJCQkJCQkJCW91dGVyQ2FjaGUgPSBwYXJlbnRbIGV4cGFuZG8gXSB8fCAocGFyZW50WyBleHBhbmRvIF0gPSB7fSk7CgkJCQkJCQkJY2FjaGUgPSBvdXRlckNhY2hlWyB0eXBlIF0gfHwgW107CgkJCQkJCQkJbm9kZUluZGV4ID0gY2FjaGVbMF0gPT09IGRpcnJ1bnMgJiYgY2FjaGVbMV07CgkJCQkJCQkJZGlmZiA9IGNhY2hlWzBdID09PSBkaXJydW5zICYmIGNhY2hlWzJdOwoJCQkJCQkJCW5vZGUgPSBub2RlSW5kZXggJiYgcGFyZW50LmNoaWxkTm9kZXNbIG5vZGVJbmRleCBdOwoKCQkJCQkJCQl3aGlsZSAoIChub2RlID0gKytub2RlSW5kZXggJiYgbm9kZSAmJiBub2RlWyBkaXIgXSB8fAoKCQkJCQkJCQkJLy8gRmFsbGJhY2sgdG8gc2Vla2luZyBgZWxlbWAgZnJvbSB0aGUgc3RhcnQKCQkJCQkJCQkJKGRpZmYgPSBub2RlSW5kZXggPSAwKSB8fCBzdGFydC5wb3AoKSkgKSB7CgoJCQkJCQkJCQkvLyBXaGVuIGZvdW5kLCBjYWNoZSBpbmRleGVzIG9uIGBwYXJlbnRgIGFuZCBicmVhawoJCQkJCQkJCQlpZiAoIG5vZGUubm9kZVR5cGUgPT09IDEgJiYgKytkaWZmICYmIG5vZGUgPT09IGVsZW0gKSB7CgkJCQkJCQkJCQlvdXRlckNhY2hlWyB0eXBlIF0gPSBbIGRpcnJ1bnMsIG5vZGVJbmRleCwgZGlmZiBdOwoJCQkJCQkJCQkJYnJlYWs7CgkJCQkJCQkJCX0KCQkJCQkJCQl9CgoJCQkJCQkJLy8gVXNlIHByZXZpb3VzbHktY2FjaGVkIGVsZW1lbnQgaW5kZXggaWYgYXZhaWxhYmxlCgkJCQkJCQl9IGVsc2UgaWYgKCB1c2VDYWNoZSAmJiAoY2FjaGUgPSAoZWxlbVsgZXhwYW5kbyBdIHx8IChlbGVtWyBleHBhbmRvIF0gPSB7fSkpWyB0eXBlIF0pICYmIGNhY2hlWzBdID09PSBkaXJydW5zICkgewoJCQkJCQkJCWRpZmYgPSBjYWNoZVsxXTsKCgkJCQkJCQkvLyB4bWwgOm50aC1jaGlsZCguLi4pIG9yIDpudGgtbGFzdC1jaGlsZCguLi4pIG9yIDpudGgoLWxhc3QpPy1vZi10eXBlKC4uLikKCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJLy8gVXNlIHRoZSBzYW1lIGxvb3AgYXMgYWJvdmUgdG8gc2VlayBgZWxlbWAgZnJvbSB0aGUgc3RhcnQKCQkJCQkJCQl3aGlsZSAoIChub2RlID0gKytub2RlSW5kZXggJiYgbm9kZSAmJiBub2RlWyBkaXIgXSB8fAoJCQkJCQkJCQkoZGlmZiA9IG5vZGVJbmRleCA9IDApIHx8IHN0YXJ0LnBvcCgpKSApIHsKCgkJCQkJCQkJCWlmICggKCBvZlR5cGUgPyBub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5hbWUgOiBub2RlLm5vZGVUeXBlID09PSAxICkgJiYgKytkaWZmICkgewoJCQkJCQkJCQkJLy8gQ2FjaGUgdGhlIGluZGV4IG9mIGVhY2ggZW5jb3VudGVyZWQgZWxlbWVudAoJCQkJCQkJCQkJaWYgKCB1c2VDYWNoZSApIHsKCQkJCQkJCQkJCQkobm9kZVsgZXhwYW5kbyBdIHx8IChub2RlWyBleHBhbmRvIF0gPSB7fSkpWyB0eXBlIF0gPSBbIGRpcnJ1bnMsIGRpZmYgXTsKCQkJCQkJCQkJCX0KCgkJCQkJCQkJCQlpZiAoIG5vZGUgPT09IGVsZW0gKSB7CgkJCQkJCQkJCQkJYnJlYWs7CgkJCQkJCQkJCQl9CgkJCQkJCQkJCX0KCQkJCQkJCQl9CgkJCQkJCQl9CgoJCQkJCQkJLy8gSW5jb3Jwb3JhdGUgdGhlIG9mZnNldCwgdGhlbiBjaGVjayBhZ2FpbnN0IGN5Y2xlIHNpemUKCQkJCQkJCWRpZmYgLT0gbGFzdDsKCQkJCQkJCXJldHVybiBkaWZmID09PSBmaXJzdCB8fCAoIGRpZmYgJSBmaXJzdCA9PT0gMCAmJiBkaWZmIC8gZmlyc3QgPj0gMCApOwoJCQkJCQl9CgkJCQkJfTsKCQkJfSwKCgkJCSJQU0VVRE8iOiBmdW5jdGlvbiggcHNldWRvLCBhcmd1bWVudCApIHsKCQkJCS8vIHBzZXVkby1jbGFzcyBuYW1lcyBhcmUgY2FzZS1pbnNlbnNpdGl2ZQoJCQkJLy8gaHR0cDovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLyNwc2V1ZG8tY2xhc3NlcwoJCQkJLy8gUHJpb3JpdGl6ZSBieSBjYXNlIHNlbnNpdGl2aXR5IGluIGNhc2UgY3VzdG9tIHBzZXVkb3MgYXJlIGFkZGVkIHdpdGggdXBwZXJjYXNlIGxldHRlcnMKCQkJCS8vIFJlbWVtYmVyIHRoYXQgc2V0RmlsdGVycyBpbmhlcml0cyBmcm9tIHBzZXVkb3MKCQkJCXZhciBhcmdzLAoJCQkJCWZuID0gRXhwci5wc2V1ZG9zWyBwc2V1ZG8gXSB8fCBFeHByLnNldEZpbHRlcnNbIHBzZXVkby50b0xvd2VyQ2FzZSgpIF0gfHwKCQkJCQkJU2l6emxlLmVycm9yKCAidW5zdXBwb3J0ZWQgcHNldWRvOiAiICsgcHNldWRvICk7CgoJCQkJLy8gVGhlIHVzZXIgbWF5IHVzZSBjcmVhdGVQc2V1ZG8gdG8gaW5kaWNhdGUgdGhhdAoJCQkJLy8gYXJndW1lbnRzIGFyZSBuZWVkZWQgdG8gY3JlYXRlIHRoZSBmaWx0ZXIgZnVuY3Rpb24KCQkJCS8vIGp1c3QgYXMgU2l6emxlIGRvZXMKCQkJCWlmICggZm5bIGV4cGFuZG8gXSApIHsKCQkJCQlyZXR1cm4gZm4oIGFyZ3VtZW50ICk7CgkJCQl9CgoJCQkJLy8gQnV0IG1haW50YWluIHN1cHBvcnQgZm9yIG9sZCBzaWduYXR1cmVzCgkJCQlpZiAoIGZuLmxlbmd0aCA+IDEgKSB7CgkJCQkJYXJncyA9IFsgcHNldWRvLCBwc2V1ZG8sICIiLCBhcmd1bWVudCBdOwoJCQkJCXJldHVybiBFeHByLnNldEZpbHRlcnMuaGFzT3duUHJvcGVydHkoIHBzZXVkby50b0xvd2VyQ2FzZSgpICkgPwoJCQkJCQltYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlZWQsIG1hdGNoZXMgKSB7CgkJCQkJCQl2YXIgaWR4LAoJCQkJCQkJCW1hdGNoZWQgPSBmbiggc2VlZCwgYXJndW1lbnQgKSwKCQkJCQkJCQlpID0gbWF0Y2hlZC5sZW5ndGg7CgkJCQkJCQl3aGlsZSAoIGktLSApIHsKCQkJCQkJCQlpZHggPSBpbmRleE9mKCBzZWVkLCBtYXRjaGVkW2ldICk7CgkJCQkJCQkJc2VlZFsgaWR4IF0gPSAhKCBtYXRjaGVzWyBpZHggXSA9IG1hdGNoZWRbaV0gKTsKCQkJCQkJCX0KCQkJCQkJfSkgOgoJCQkJCQlmdW5jdGlvbiggZWxlbSApIHsKCQkJCQkJCXJldHVybiBmbiggZWxlbSwgMCwgYXJncyApOwoJCQkJCQl9OwoJCQkJfQoKCQkJCXJldHVybiBmbjsKCQkJfQoJCX0sCgoJCXBzZXVkb3M6IHsKCQkJLy8gUG90ZW50aWFsbHkgY29tcGxleCBwc2V1ZG9zCgkJCSJub3QiOiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCQkJLy8gVHJpbSB0aGUgc2VsZWN0b3IgcGFzc2VkIHRvIGNvbXBpbGUKCQkJCS8vIHRvIGF2b2lkIHRyZWF0aW5nIGxlYWRpbmcgYW5kIHRyYWlsaW5nCgkJCQkvLyBzcGFjZXMgYXMgY29tYmluYXRvcnMKCQkJCXZhciBpbnB1dCA9IFtdLAoJCQkJCXJlc3VsdHMgPSBbXSwKCQkJCQltYXRjaGVyID0gY29tcGlsZSggc2VsZWN0b3IucmVwbGFjZSggcnRyaW0sICIkMSIgKSApOwoKCQkJCXJldHVybiBtYXRjaGVyWyBleHBhbmRvIF0gPwoJCQkJCW1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VlZCwgbWF0Y2hlcywgY29udGV4dCwgeG1sICkgewoJCQkJCQl2YXIgZWxlbSwKCQkJCQkJCXVubWF0Y2hlZCA9IG1hdGNoZXIoIHNlZWQsIG51bGwsIHhtbCwgW10gKSwKCQkJCQkJCWkgPSBzZWVkLmxlbmd0aDsKCgkJCQkJCS8vIE1hdGNoIGVsZW1lbnRzIHVubWF0Y2hlZCBieSBgbWF0Y2hlcmAKCQkJCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQkJCQlpZiAoIChlbGVtID0gdW5tYXRjaGVkW2ldKSApIHsKCQkJCQkJCQlzZWVkW2ldID0gIShtYXRjaGVzW2ldID0gZWxlbSk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9KSA6CgkJCQkJZnVuY3Rpb24oIGVsZW0sIGNvbnRleHQsIHhtbCApIHsKCQkJCQkJaW5wdXRbMF0gPSBlbGVtOwoJCQkJCQltYXRjaGVyKCBpbnB1dCwgbnVsbCwgeG1sLCByZXN1bHRzICk7CgkJCQkJCS8vIERvbid0IGtlZXAgdGhlIGVsZW1lbnQgKGlzc3VlICMyOTkpCgkJCQkJCWlucHV0WzBdID0gbnVsbDsKCQkJCQkJcmV0dXJuICFyZXN1bHRzLnBvcCgpOwoJCQkJCX07CgkJCX0pLAoKCQkJImhhcyI6IG1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJcmV0dXJuIFNpenpsZSggc2VsZWN0b3IsIGVsZW0gKS5sZW5ndGggPiAwOwoJCQkJfTsKCQkJfSksCgoJCQkiY29udGFpbnMiOiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHRleHQgKSB7CgkJCQl0ZXh0ID0gdGV4dC5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApOwoJCQkJcmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCXJldHVybiAoIGVsZW0udGV4dENvbnRlbnQgfHwgZWxlbS5pbm5lclRleHQgfHwgZ2V0VGV4dCggZWxlbSApICkuaW5kZXhPZiggdGV4dCApID4gLTE7CgkJCQl9OwoJCQl9KSwKCgkJCS8vICJXaGV0aGVyIGFuIGVsZW1lbnQgaXMgcmVwcmVzZW50ZWQgYnkgYSA6bGFuZygpIHNlbGVjdG9yCgkJCS8vIGlzIGJhc2VkIHNvbGVseSBvbiB0aGUgZWxlbWVudCdzIGxhbmd1YWdlIHZhbHVlCgkJCS8vIGJlaW5nIGVxdWFsIHRvIHRoZSBpZGVudGlmaWVyIEMsCgkJCS8vIG9yIGJlZ2lubmluZyB3aXRoIHRoZSBpZGVudGlmaWVyIEMgaW1tZWRpYXRlbHkgZm9sbG93ZWQgYnkgIi0iLgoJCQkvLyBUaGUgbWF0Y2hpbmcgb2YgQyBhZ2FpbnN0IHRoZSBlbGVtZW50J3MgbGFuZ3VhZ2UgdmFsdWUgaXMgcGVyZm9ybWVkIGNhc2UtaW5zZW5zaXRpdmVseS4KCQkJLy8gVGhlIGlkZW50aWZpZXIgQyBkb2VzIG5vdCBoYXZlIHRvIGJlIGEgdmFsaWQgbGFuZ3VhZ2UgbmFtZS4iCgkJCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSL3NlbGVjdG9ycy8jbGFuZy1wc2V1ZG8KCQkJImxhbmciOiBtYXJrRnVuY3Rpb24oIGZ1bmN0aW9uKCBsYW5nICkgewoJCQkJLy8gbGFuZyB2YWx1ZSBtdXN0IGJlIGEgdmFsaWQgaWRlbnRpZmllcgoJCQkJaWYgKCAhcmlkZW50aWZpZXIudGVzdChsYW5nIHx8ICIiKSApIHsKCQkJCQlTaXp6bGUuZXJyb3IoICJ1bnN1cHBvcnRlZCBsYW5nOiAiICsgbGFuZyApOwoJCQkJfQoJCQkJbGFuZyA9IGxhbmcucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKS50b0xvd2VyQ2FzZSgpOwoJCQkJcmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCXZhciBlbGVtTGFuZzsKCQkJCQlkbyB7CgkJCQkJCWlmICggKGVsZW1MYW5nID0gZG9jdW1lbnRJc0hUTUwgPwoJCQkJCQkJZWxlbS5sYW5nIDoKCQkJCQkJCWVsZW0uZ2V0QXR0cmlidXRlKCJ4bWw6bGFuZyIpIHx8IGVsZW0uZ2V0QXR0cmlidXRlKCJsYW5nIikpICkgewoKCQkJCQkJCWVsZW1MYW5nID0gZWxlbUxhbmcudG9Mb3dlckNhc2UoKTsKCQkJCQkJCXJldHVybiBlbGVtTGFuZyA9PT0gbGFuZyB8fCBlbGVtTGFuZy5pbmRleE9mKCBsYW5nICsgIi0iICkgPT09IDA7CgkJCQkJCX0KCQkJCQl9IHdoaWxlICggKGVsZW0gPSBlbGVtLnBhcmVudE5vZGUpICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKTsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9OwoJCQl9KSwKCgkJCS8vIE1pc2NlbGxhbmVvdXMKCQkJInRhcmdldCI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJdmFyIGhhc2ggPSB3aW5kb3cubG9jYXRpb24gJiYgd2luZG93LmxvY2F0aW9uLmhhc2g7CgkJCQlyZXR1cm4gaGFzaCAmJiBoYXNoLnNsaWNlKCAxICkgPT09IGVsZW0uaWQ7CgkJCX0sCgoJCQkicm9vdCI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGVsZW0gPT09IGRvY0VsZW07CgkJCX0sCgoJCQkiZm9jdXMiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiBlbGVtID09PSBkb2N1bWVudC5hY3RpdmVFbGVtZW50ICYmICghZG9jdW1lbnQuaGFzRm9jdXMgfHwgZG9jdW1lbnQuaGFzRm9jdXMoKSkgJiYgISEoZWxlbS50eXBlIHx8IGVsZW0uaHJlZiB8fCB+ZWxlbS50YWJJbmRleCk7CgkJCX0sCgoJCQkvLyBCb29sZWFuIHByb3BlcnRpZXMKCQkJImVuYWJsZWQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiBlbGVtLmRpc2FibGVkID09PSBmYWxzZTsKCQkJfSwKCgkJCSJkaXNhYmxlZCI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGVsZW0uZGlzYWJsZWQgPT09IHRydWU7CgkJCX0sCgoJCQkiY2hlY2tlZCI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJLy8gSW4gQ1NTMywgOmNoZWNrZWQgc2hvdWxkIHJldHVybiBib3RoIGNoZWNrZWQgYW5kIHNlbGVjdGVkIGVsZW1lbnRzCgkJCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi8yMDExL1JFQy1jc3MzLXNlbGVjdG9ycy0yMDExMDkyOS8jY2hlY2tlZAoJCQkJdmFyIG5vZGVOYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwoJCQkJcmV0dXJuIChub2RlTmFtZSA9PT0gImlucHV0IiAmJiAhIWVsZW0uY2hlY2tlZCkgfHwgKG5vZGVOYW1lID09PSAib3B0aW9uIiAmJiAhIWVsZW0uc2VsZWN0ZWQpOwoJCQl9LAoKCQkJInNlbGVjdGVkIjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkvLyBBY2Nlc3NpbmcgdGhpcyBwcm9wZXJ0eSBtYWtlcyBzZWxlY3RlZC1ieS1kZWZhdWx0CgkJCQkvLyBvcHRpb25zIGluIFNhZmFyaSB3b3JrIHByb3Blcmx5CgkJCQlpZiAoIGVsZW0ucGFyZW50Tm9kZSApIHsKCQkJCQllbGVtLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleDsKCQkJCX0KCgkJCQlyZXR1cm4gZWxlbS5zZWxlY3RlZCA9PT0gdHJ1ZTsKCQkJfSwKCgkJCS8vIENvbnRlbnRzCgkJCSJlbXB0eSI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJLy8gaHR0cDovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLyNlbXB0eS1wc2V1ZG8KCQkJCS8vIDplbXB0eSBpcyBuZWdhdGVkIGJ5IGVsZW1lbnQgKDEpIG9yIGNvbnRlbnQgbm9kZXMgKHRleHQ6IDM7IGNkYXRhOiA0OyBlbnRpdHkgcmVmOiA1KSwKCQkJCS8vICAgYnV0IG5vdCBieSBvdGhlcnMgKGNvbW1lbnQ6IDg7IHByb2Nlc3NpbmcgaW5zdHJ1Y3Rpb246IDc7IGV0Yy4pCgkJCQkvLyBub2RlVHlwZSA8IDYgd29ya3MgYmVjYXVzZSBhdHRyaWJ1dGVzICgyKSBkbyBub3QgYXBwZWFyIGFzIGNoaWxkcmVuCgkJCQlmb3IgKCBlbGVtID0gZWxlbS5maXJzdENoaWxkOyBlbGVtOyBlbGVtID0gZWxlbS5uZXh0U2libGluZyApIHsKCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPCA2ICkgewoJCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQkJfQoJCQkJfQoJCQkJcmV0dXJuIHRydWU7CgkJCX0sCgoJCQkicGFyZW50IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gIUV4cHIucHNldWRvc1siZW1wdHkiXSggZWxlbSApOwoJCQl9LAoKCQkJLy8gRWxlbWVudC9pbnB1dCB0eXBlcwoJCQkiaGVhZGVyIjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gcmhlYWRlci50ZXN0KCBlbGVtLm5vZGVOYW1lICk7CgkJCX0sCgoJCQkiaW5wdXQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiByaW5wdXRzLnRlc3QoIGVsZW0ubm9kZU5hbWUgKTsKCQkJfSwKCgkJCSJidXR0b24iOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwoJCQkJcmV0dXJuIG5hbWUgPT09ICJpbnB1dCIgJiYgZWxlbS50eXBlID09PSAiYnV0dG9uIiB8fCBuYW1lID09PSAiYnV0dG9uIjsKCQkJfSwKCgkJCSJ0ZXh0IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQl2YXIgYXR0cjsKCQkJCXJldHVybiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICJpbnB1dCIgJiYKCQkJCQllbGVtLnR5cGUgPT09ICJ0ZXh0IiAmJgoKCQkJCQkvLyBTdXBwb3J0OiBJRTw4CgkJCQkJLy8gTmV3IEhUTUw1IGF0dHJpYnV0ZSB2YWx1ZXMgKGUuZy4sICJzZWFyY2giKSBhcHBlYXIgd2l0aCBlbGVtLnR5cGUgPT09ICJ0ZXh0IgoJCQkJCSggKGF0dHIgPSBlbGVtLmdldEF0dHJpYnV0ZSgidHlwZSIpKSA9PSBudWxsIHx8IGF0dHIudG9Mb3dlckNhc2UoKSA9PT0gInRleHQiICk7CgkJCX0sCgoJCQkvLyBQb3NpdGlvbi1pbi1jb2xsZWN0aW9uCgkJCSJmaXJzdCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oKSB7CgkJCQlyZXR1cm4gWyAwIF07CgkJCX0pLAoKCQkJImxhc3QiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCApIHsKCQkJCXJldHVybiBbIGxlbmd0aCAtIDEgXTsKCQkJfSksCgoJCQkiZXEiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCwgYXJndW1lbnQgKSB7CgkJCQlyZXR1cm4gWyBhcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50IF07CgkJCX0pLAoKCQkJImV2ZW4iOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCApIHsKCQkJCXZhciBpID0gMDsKCQkJCWZvciAoIDsgaSA8IGxlbmd0aDsgaSArPSAyICkgewoJCQkJCW1hdGNoSW5kZXhlcy5wdXNoKCBpICk7CgkJCQl9CgkJCQlyZXR1cm4gbWF0Y2hJbmRleGVzOwoJCQl9KSwKCgkJCSJvZGQiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCApIHsKCQkJCXZhciBpID0gMTsKCQkJCWZvciAoIDsgaSA8IGxlbmd0aDsgaSArPSAyICkgewoJCQkJCW1hdGNoSW5kZXhlcy5wdXNoKCBpICk7CgkJCQl9CgkJCQlyZXR1cm4gbWF0Y2hJbmRleGVzOwoJCQl9KSwKCgkJCSJsdCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoLCBhcmd1bWVudCApIHsKCQkJCXZhciBpID0gYXJndW1lbnQgPCAwID8gYXJndW1lbnQgKyBsZW5ndGggOiBhcmd1bWVudDsKCQkJCWZvciAoIDsgLS1pID49IDA7ICkgewoJCQkJCW1hdGNoSW5kZXhlcy5wdXNoKCBpICk7CgkJCQl9CgkJCQlyZXR1cm4gbWF0Y2hJbmRleGVzOwoJCQl9KSwKCgkJCSJndCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoLCBhcmd1bWVudCApIHsKCQkJCXZhciBpID0gYXJndW1lbnQgPCAwID8gYXJndW1lbnQgKyBsZW5ndGggOiBhcmd1bWVudDsKCQkJCWZvciAoIDsgKytpIDwgbGVuZ3RoOyApIHsKCQkJCQltYXRjaEluZGV4ZXMucHVzaCggaSApOwoJCQkJfQoJCQkJcmV0dXJuIG1hdGNoSW5kZXhlczsKCQkJfSkKCQl9Cgl9OwoKCUV4cHIucHNldWRvc1sibnRoIl0gPSBFeHByLnBzZXVkb3NbImVxIl07CgoJLy8gQWRkIGJ1dHRvbi9pbnB1dCB0eXBlIHBzZXVkb3MKCWZvciAoIGkgaW4geyByYWRpbzogdHJ1ZSwgY2hlY2tib3g6IHRydWUsIGZpbGU6IHRydWUsIHBhc3N3b3JkOiB0cnVlLCBpbWFnZTogdHJ1ZSB9ICkgewoJCUV4cHIucHNldWRvc1sgaSBdID0gY3JlYXRlSW5wdXRQc2V1ZG8oIGkgKTsKCX0KCWZvciAoIGkgaW4geyBzdWJtaXQ6IHRydWUsIHJlc2V0OiB0cnVlIH0gKSB7CgkJRXhwci5wc2V1ZG9zWyBpIF0gPSBjcmVhdGVCdXR0b25Qc2V1ZG8oIGkgKTsKCX0KCgkvLyBFYXN5IEFQSSBmb3IgY3JlYXRpbmcgbmV3IHNldEZpbHRlcnMKCWZ1bmN0aW9uIHNldEZpbHRlcnMoKSB7fQoJc2V0RmlsdGVycy5wcm90b3R5cGUgPSBFeHByLmZpbHRlcnMgPSBFeHByLnBzZXVkb3M7CglFeHByLnNldEZpbHRlcnMgPSBuZXcgc2V0RmlsdGVycygpOwoKCXRva2VuaXplID0gU2l6emxlLnRva2VuaXplID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBwYXJzZU9ubHkgKSB7CgkJdmFyIG1hdGNoZWQsIG1hdGNoLCB0b2tlbnMsIHR5cGUsCgkJCXNvRmFyLCBncm91cHMsIHByZUZpbHRlcnMsCgkJCWNhY2hlZCA9IHRva2VuQ2FjaGVbIHNlbGVjdG9yICsgIiAiIF07CgoJCWlmICggY2FjaGVkICkgewoJCQlyZXR1cm4gcGFyc2VPbmx5ID8gMCA6IGNhY2hlZC5zbGljZSggMCApOwoJCX0KCgkJc29GYXIgPSBzZWxlY3RvcjsKCQlncm91cHMgPSBbXTsKCQlwcmVGaWx0ZXJzID0gRXhwci5wcmVGaWx0ZXI7CgoJCXdoaWxlICggc29GYXIgKSB7CgoJCQkvLyBDb21tYSBhbmQgZmlyc3QgcnVuCgkJCWlmICggIW1hdGNoZWQgfHwgKG1hdGNoID0gcmNvbW1hLmV4ZWMoIHNvRmFyICkpICkgewoJCQkJaWYgKCBtYXRjaCApIHsKCQkJCQkvLyBEb24ndCBjb25zdW1lIHRyYWlsaW5nIGNvbW1hcyBhcyB2YWxpZAoJCQkJCXNvRmFyID0gc29GYXIuc2xpY2UoIG1hdGNoWzBdLmxlbmd0aCApIHx8IHNvRmFyOwoJCQkJfQoJCQkJZ3JvdXBzLnB1c2goICh0b2tlbnMgPSBbXSkgKTsKCQkJfQoKCQkJbWF0Y2hlZCA9IGZhbHNlOwoKCQkJLy8gQ29tYmluYXRvcnMKCQkJaWYgKCAobWF0Y2ggPSByY29tYmluYXRvcnMuZXhlYyggc29GYXIgKSkgKSB7CgkJCQltYXRjaGVkID0gbWF0Y2guc2hpZnQoKTsKCQkJCXRva2Vucy5wdXNoKHsKCQkJCQl2YWx1ZTogbWF0Y2hlZCwKCQkJCQkvLyBDYXN0IGRlc2NlbmRhbnQgY29tYmluYXRvcnMgdG8gc3BhY2UKCQkJCQl0eXBlOiBtYXRjaFswXS5yZXBsYWNlKCBydHJpbSwgIiAiICkKCQkJCX0pOwoJCQkJc29GYXIgPSBzb0Zhci5zbGljZSggbWF0Y2hlZC5sZW5ndGggKTsKCQkJfQoKCQkJLy8gRmlsdGVycwoJCQlmb3IgKCB0eXBlIGluIEV4cHIuZmlsdGVyICkgewoJCQkJaWYgKCAobWF0Y2ggPSBtYXRjaEV4cHJbIHR5cGUgXS5leGVjKCBzb0ZhciApKSAmJiAoIXByZUZpbHRlcnNbIHR5cGUgXSB8fAoJCQkJCShtYXRjaCA9IHByZUZpbHRlcnNbIHR5cGUgXSggbWF0Y2ggKSkpICkgewoJCQkJCW1hdGNoZWQgPSBtYXRjaC5zaGlmdCgpOwoJCQkJCXRva2Vucy5wdXNoKHsKCQkJCQkJdmFsdWU6IG1hdGNoZWQsCgkJCQkJCXR5cGU6IHR5cGUsCgkJCQkJCW1hdGNoZXM6IG1hdGNoCgkJCQkJfSk7CgkJCQkJc29GYXIgPSBzb0Zhci5zbGljZSggbWF0Y2hlZC5sZW5ndGggKTsKCQkJCX0KCQkJfQoKCQkJaWYgKCAhbWF0Y2hlZCApIHsKCQkJCWJyZWFrOwoJCQl9CgkJfQoKCQkvLyBSZXR1cm4gdGhlIGxlbmd0aCBvZiB0aGUgaW52YWxpZCBleGNlc3MKCQkvLyBpZiB3ZSdyZSBqdXN0IHBhcnNpbmcKCQkvLyBPdGhlcndpc2UsIHRocm93IGFuIGVycm9yIG9yIHJldHVybiB0b2tlbnMKCQlyZXR1cm4gcGFyc2VPbmx5ID8KCQkJc29GYXIubGVuZ3RoIDoKCQkJc29GYXIgPwoJCQkJU2l6emxlLmVycm9yKCBzZWxlY3RvciApIDoKCQkJCS8vIENhY2hlIHRoZSB0b2tlbnMKCQkJCXRva2VuQ2FjaGUoIHNlbGVjdG9yLCBncm91cHMgKS5zbGljZSggMCApOwoJfTsKCglmdW5jdGlvbiB0b1NlbGVjdG9yKCB0b2tlbnMgKSB7CgkJdmFyIGkgPSAwLAoJCQlsZW4gPSB0b2tlbnMubGVuZ3RoLAoJCQlzZWxlY3RvciA9ICIiOwoJCWZvciAoIDsgaSA8IGxlbjsgaSsrICkgewoJCQlzZWxlY3RvciArPSB0b2tlbnNbaV0udmFsdWU7CgkJfQoJCXJldHVybiBzZWxlY3RvcjsKCX0KCglmdW5jdGlvbiBhZGRDb21iaW5hdG9yKCBtYXRjaGVyLCBjb21iaW5hdG9yLCBiYXNlICkgewoJCXZhciBkaXIgPSBjb21iaW5hdG9yLmRpciwKCQkJY2hlY2tOb25FbGVtZW50cyA9IGJhc2UgJiYgZGlyID09PSAicGFyZW50Tm9kZSIsCgkJCWRvbmVOYW1lID0gZG9uZSsrOwoKCQlyZXR1cm4gY29tYmluYXRvci5maXJzdCA/CgkJCS8vIENoZWNrIGFnYWluc3QgY2xvc2VzdCBhbmNlc3Rvci9wcmVjZWRpbmcgZWxlbWVudAoJCQlmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkgewoJCQkJd2hpbGUgKCAoZWxlbSA9IGVsZW1bIGRpciBdKSApIHsKCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgfHwgY2hlY2tOb25FbGVtZW50cyApIHsKCQkJCQkJcmV0dXJuIG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApOwoJCQkJCX0KCQkJCX0KCQkJfSA6CgoJCQkvLyBDaGVjayBhZ2FpbnN0IGFsbCBhbmNlc3Rvci9wcmVjZWRpbmcgZWxlbWVudHMKCQkJZnVuY3Rpb24oIGVsZW0sIGNvbnRleHQsIHhtbCApIHsKCQkJCXZhciBvbGRDYWNoZSwgb3V0ZXJDYWNoZSwKCQkJCQluZXdDYWNoZSA9IFsgZGlycnVucywgZG9uZU5hbWUgXTsKCgkJCQkvLyBXZSBjYW4ndCBzZXQgYXJiaXRyYXJ5IGRhdGEgb24gWE1MIG5vZGVzLCBzbyB0aGV5IGRvbid0IGJlbmVmaXQgZnJvbSBkaXIgY2FjaGluZwoJCQkJaWYgKCB4bWwgKSB7CgkJCQkJd2hpbGUgKCAoZWxlbSA9IGVsZW1bIGRpciBdKSApIHsKCQkJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGNoZWNrTm9uRWxlbWVudHMgKSB7CgkJCQkJCQlpZiAoIG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApICkgewoJCQkJCQkJCXJldHVybiB0cnVlOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQl3aGlsZSAoIChlbGVtID0gZWxlbVsgZGlyIF0pICkgewoJCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgfHwgY2hlY2tOb25FbGVtZW50cyApIHsKCQkJCQkJCW91dGVyQ2FjaGUgPSBlbGVtWyBleHBhbmRvIF0gfHwgKGVsZW1bIGV4cGFuZG8gXSA9IHt9KTsKCQkJCQkJCWlmICggKG9sZENhY2hlID0gb3V0ZXJDYWNoZVsgZGlyIF0pICYmCgkJCQkJCQkJb2xkQ2FjaGVbIDAgXSA9PT0gZGlycnVucyAmJiBvbGRDYWNoZVsgMSBdID09PSBkb25lTmFtZSApIHsKCgkJCQkJCQkJLy8gQXNzaWduIHRvIG5ld0NhY2hlIHNvIHJlc3VsdHMgYmFjay1wcm9wYWdhdGUgdG8gcHJldmlvdXMgZWxlbWVudHMKCQkJCQkJCQlyZXR1cm4gKG5ld0NhY2hlWyAyIF0gPSBvbGRDYWNoZVsgMiBdKTsKCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJLy8gUmV1c2UgbmV3Y2FjaGUgc28gcmVzdWx0cyBiYWNrLXByb3BhZ2F0ZSB0byBwcmV2aW91cyBlbGVtZW50cwoJCQkJCQkJCW91dGVyQ2FjaGVbIGRpciBdID0gbmV3Q2FjaGU7CgoJCQkJCQkJCS8vIEEgbWF0Y2ggbWVhbnMgd2UncmUgZG9uZTsgYSBmYWlsIG1lYW5zIHdlIGhhdmUgdG8ga2VlcCBjaGVja2luZwoJCQkJCQkJCWlmICggKG5ld0NhY2hlWyAyIF0gPSBtYXRjaGVyKCBlbGVtLCBjb250ZXh0LCB4bWwgKSkgKSB7CgkJCQkJCQkJCXJldHVybiB0cnVlOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfTsKCX0KCglmdW5jdGlvbiBlbGVtZW50TWF0Y2hlciggbWF0Y2hlcnMgKSB7CgkJcmV0dXJuIG1hdGNoZXJzLmxlbmd0aCA+IDEgPwoJCQlmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkgewoJCQkJdmFyIGkgPSBtYXRjaGVycy5sZW5ndGg7CgkJCQl3aGlsZSAoIGktLSApIHsKCQkJCQlpZiAoICFtYXRjaGVyc1tpXSggZWxlbSwgY29udGV4dCwgeG1sICkgKSB7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gdHJ1ZTsKCQkJfSA6CgkJCW1hdGNoZXJzWzBdOwoJfQoKCWZ1bmN0aW9uIG11bHRpcGxlQ29udGV4dHMoIHNlbGVjdG9yLCBjb250ZXh0cywgcmVzdWx0cyApIHsKCQl2YXIgaSA9IDAsCgkJCWxlbiA9IGNvbnRleHRzLmxlbmd0aDsKCQlmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQkJU2l6emxlKCBzZWxlY3RvciwgY29udGV4dHNbaV0sIHJlc3VsdHMgKTsKCQl9CgkJcmV0dXJuIHJlc3VsdHM7Cgl9CgoJZnVuY3Rpb24gY29uZGVuc2UoIHVubWF0Y2hlZCwgbWFwLCBmaWx0ZXIsIGNvbnRleHQsIHhtbCApIHsKCQl2YXIgZWxlbSwKCQkJbmV3VW5tYXRjaGVkID0gW10sCgkJCWkgPSAwLAoJCQlsZW4gPSB1bm1hdGNoZWQubGVuZ3RoLAoJCQltYXBwZWQgPSBtYXAgIT0gbnVsbDsKCgkJZm9yICggOyBpIDwgbGVuOyBpKysgKSB7CgkJCWlmICggKGVsZW0gPSB1bm1hdGNoZWRbaV0pICkgewoJCQkJaWYgKCAhZmlsdGVyIHx8IGZpbHRlciggZWxlbSwgY29udGV4dCwgeG1sICkgKSB7CgkJCQkJbmV3VW5tYXRjaGVkLnB1c2goIGVsZW0gKTsKCQkJCQlpZiAoIG1hcHBlZCApIHsKCQkJCQkJbWFwLnB1c2goIGkgKTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiBuZXdVbm1hdGNoZWQ7Cgl9CgoJZnVuY3Rpb24gc2V0TWF0Y2hlciggcHJlRmlsdGVyLCBzZWxlY3RvciwgbWF0Y2hlciwgcG9zdEZpbHRlciwgcG9zdEZpbmRlciwgcG9zdFNlbGVjdG9yICkgewoJCWlmICggcG9zdEZpbHRlciAmJiAhcG9zdEZpbHRlclsgZXhwYW5kbyBdICkgewoJCQlwb3N0RmlsdGVyID0gc2V0TWF0Y2hlciggcG9zdEZpbHRlciApOwoJCX0KCQlpZiAoIHBvc3RGaW5kZXIgJiYgIXBvc3RGaW5kZXJbIGV4cGFuZG8gXSApIHsKCQkJcG9zdEZpbmRlciA9IHNldE1hdGNoZXIoIHBvc3RGaW5kZXIsIHBvc3RTZWxlY3RvciApOwoJCX0KCQlyZXR1cm4gbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWVkLCByZXN1bHRzLCBjb250ZXh0LCB4bWwgKSB7CgkJCXZhciB0ZW1wLCBpLCBlbGVtLAoJCQkJcHJlTWFwID0gW10sCgkJCQlwb3N0TWFwID0gW10sCgkJCQlwcmVleGlzdGluZyA9IHJlc3VsdHMubGVuZ3RoLAoKCQkJCS8vIEdldCBpbml0aWFsIGVsZW1lbnRzIGZyb20gc2VlZCBvciBjb250ZXh0CgkJCQllbGVtcyA9IHNlZWQgfHwgbXVsdGlwbGVDb250ZXh0cyggc2VsZWN0b3IgfHwgIioiLCBjb250ZXh0Lm5vZGVUeXBlID8gWyBjb250ZXh0IF0gOiBjb250ZXh0LCBbXSApLAoKCQkJCS8vIFByZWZpbHRlciB0byBnZXQgbWF0Y2hlciBpbnB1dCwgcHJlc2VydmluZyBhIG1hcCBmb3Igc2VlZC1yZXN1bHRzIHN5bmNocm9uaXphdGlvbgoJCQkJbWF0Y2hlckluID0gcHJlRmlsdGVyICYmICggc2VlZCB8fCAhc2VsZWN0b3IgKSA/CgkJCQkJY29uZGVuc2UoIGVsZW1zLCBwcmVNYXAsIHByZUZpbHRlciwgY29udGV4dCwgeG1sICkgOgoJCQkJCWVsZW1zLAoKCQkJCW1hdGNoZXJPdXQgPSBtYXRjaGVyID8KCQkJCQkvLyBJZiB3ZSBoYXZlIGEgcG9zdEZpbmRlciwgb3IgZmlsdGVyZWQgc2VlZCwgb3Igbm9uLXNlZWQgcG9zdEZpbHRlciBvciBwcmVleGlzdGluZyByZXN1bHRzLAoJCQkJCXBvc3RGaW5kZXIgfHwgKCBzZWVkID8gcHJlRmlsdGVyIDogcHJlZXhpc3RpbmcgfHwgcG9zdEZpbHRlciApID8KCgkJCQkJCS8vIC4uLmludGVybWVkaWF0ZSBwcm9jZXNzaW5nIGlzIG5lY2Vzc2FyeQoJCQkJCQlbXSA6CgoJCQkJCQkvLyAuLi5vdGhlcndpc2UgdXNlIHJlc3VsdHMgZGlyZWN0bHkKCQkJCQkJcmVzdWx0cyA6CgkJCQkJbWF0Y2hlckluOwoKCQkJLy8gRmluZCBwcmltYXJ5IG1hdGNoZXMKCQkJaWYgKCBtYXRjaGVyICkgewoJCQkJbWF0Y2hlciggbWF0Y2hlckluLCBtYXRjaGVyT3V0LCBjb250ZXh0LCB4bWwgKTsKCQkJfQoKCQkJLy8gQXBwbHkgcG9zdEZpbHRlcgoJCQlpZiAoIHBvc3RGaWx0ZXIgKSB7CgkJCQl0ZW1wID0gY29uZGVuc2UoIG1hdGNoZXJPdXQsIHBvc3RNYXAgKTsKCQkJCXBvc3RGaWx0ZXIoIHRlbXAsIFtdLCBjb250ZXh0LCB4bWwgKTsKCgkJCQkvLyBVbi1tYXRjaCBmYWlsaW5nIGVsZW1lbnRzIGJ5IG1vdmluZyB0aGVtIGJhY2sgdG8gbWF0Y2hlckluCgkJCQlpID0gdGVtcC5sZW5ndGg7CgkJCQl3aGlsZSAoIGktLSApIHsKCQkJCQlpZiAoIChlbGVtID0gdGVtcFtpXSkgKSB7CgkJCQkJCW1hdGNoZXJPdXRbIHBvc3RNYXBbaV0gXSA9ICEobWF0Y2hlckluWyBwb3N0TWFwW2ldIF0gPSBlbGVtKTsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCWlmICggc2VlZCApIHsKCQkJCWlmICggcG9zdEZpbmRlciB8fCBwcmVGaWx0ZXIgKSB7CgkJCQkJaWYgKCBwb3N0RmluZGVyICkgewoJCQkJCQkvLyBHZXQgdGhlIGZpbmFsIG1hdGNoZXJPdXQgYnkgY29uZGVuc2luZyB0aGlzIGludGVybWVkaWF0ZSBpbnRvIHBvc3RGaW5kZXIgY29udGV4dHMKCQkJCQkJdGVtcCA9IFtdOwoJCQkJCQlpID0gbWF0Y2hlck91dC5sZW5ndGg7CgkJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQkJaWYgKCAoZWxlbSA9IG1hdGNoZXJPdXRbaV0pICkgewoJCQkJCQkJCS8vIFJlc3RvcmUgbWF0Y2hlckluIHNpbmNlIGVsZW0gaXMgbm90IHlldCBhIGZpbmFsIG1hdGNoCgkJCQkJCQkJdGVtcC5wdXNoKCAobWF0Y2hlckluW2ldID0gZWxlbSkgKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQlwb3N0RmluZGVyKCBudWxsLCAobWF0Y2hlck91dCA9IFtdKSwgdGVtcCwgeG1sICk7CgkJCQkJfQoKCQkJCQkvLyBNb3ZlIG1hdGNoZWQgZWxlbWVudHMgZnJvbSBzZWVkIHRvIHJlc3VsdHMgdG8ga2VlcCB0aGVtIHN5bmNocm9uaXplZAoJCQkJCWkgPSBtYXRjaGVyT3V0Lmxlbmd0aDsKCQkJCQl3aGlsZSAoIGktLSApIHsKCQkJCQkJaWYgKCAoZWxlbSA9IG1hdGNoZXJPdXRbaV0pICYmCgkJCQkJCQkodGVtcCA9IHBvc3RGaW5kZXIgPyBpbmRleE9mKCBzZWVkLCBlbGVtICkgOiBwcmVNYXBbaV0pID4gLTEgKSB7CgoJCQkJCQkJc2VlZFt0ZW1wXSA9ICEocmVzdWx0c1t0ZW1wXSA9IGVsZW0pOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJLy8gQWRkIGVsZW1lbnRzIHRvIHJlc3VsdHMsIHRocm91Z2ggcG9zdEZpbmRlciBpZiBkZWZpbmVkCgkJCX0gZWxzZSB7CgkJCQltYXRjaGVyT3V0ID0gY29uZGVuc2UoCgkJCQkJbWF0Y2hlck91dCA9PT0gcmVzdWx0cyA/CgkJCQkJCW1hdGNoZXJPdXQuc3BsaWNlKCBwcmVleGlzdGluZywgbWF0Y2hlck91dC5sZW5ndGggKSA6CgkJCQkJCW1hdGNoZXJPdXQKCQkJCSk7CgkJCQlpZiAoIHBvc3RGaW5kZXIgKSB7CgkJCQkJcG9zdEZpbmRlciggbnVsbCwgcmVzdWx0cywgbWF0Y2hlck91dCwgeG1sICk7CgkJCQl9IGVsc2UgewoJCQkJCXB1c2guYXBwbHkoIHJlc3VsdHMsIG1hdGNoZXJPdXQgKTsKCQkJCX0KCQkJfQoJCX0pOwoJfQoKCWZ1bmN0aW9uIG1hdGNoZXJGcm9tVG9rZW5zKCB0b2tlbnMgKSB7CgkJdmFyIGNoZWNrQ29udGV4dCwgbWF0Y2hlciwgaiwKCQkJbGVuID0gdG9rZW5zLmxlbmd0aCwKCQkJbGVhZGluZ1JlbGF0aXZlID0gRXhwci5yZWxhdGl2ZVsgdG9rZW5zWzBdLnR5cGUgXSwKCQkJaW1wbGljaXRSZWxhdGl2ZSA9IGxlYWRpbmdSZWxhdGl2ZSB8fCBFeHByLnJlbGF0aXZlWyIgIl0sCgkJCWkgPSBsZWFkaW5nUmVsYXRpdmUgPyAxIDogMCwKCgkJCS8vIFRoZSBmb3VuZGF0aW9uYWwgbWF0Y2hlciBlbnN1cmVzIHRoYXQgZWxlbWVudHMgYXJlIHJlYWNoYWJsZSBmcm9tIHRvcC1sZXZlbCBjb250ZXh0KHMpCgkJCW1hdGNoQ29udGV4dCA9IGFkZENvbWJpbmF0b3IoIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGVsZW0gPT09IGNoZWNrQ29udGV4dDsKCQkJfSwgaW1wbGljaXRSZWxhdGl2ZSwgdHJ1ZSApLAoJCQltYXRjaEFueUNvbnRleHQgPSBhZGRDb21iaW5hdG9yKCBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiBpbmRleE9mKCBjaGVja0NvbnRleHQsIGVsZW0gKSA+IC0xOwoJCQl9LCBpbXBsaWNpdFJlbGF0aXZlLCB0cnVlICksCgkJCW1hdGNoZXJzID0gWyBmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkgewoJCQkJdmFyIHJldCA9ICggIWxlYWRpbmdSZWxhdGl2ZSAmJiAoIHhtbCB8fCBjb250ZXh0ICE9PSBvdXRlcm1vc3RDb250ZXh0ICkgKSB8fCAoCgkJCQkJKGNoZWNrQ29udGV4dCA9IGNvbnRleHQpLm5vZGVUeXBlID8KCQkJCQkJbWF0Y2hDb250ZXh0KCBlbGVtLCBjb250ZXh0LCB4bWwgKSA6CgkJCQkJCW1hdGNoQW55Q29udGV4dCggZWxlbSwgY29udGV4dCwgeG1sICkgKTsKCQkJCS8vIEF2b2lkIGhhbmdpbmcgb250byBlbGVtZW50IChpc3N1ZSAjMjk5KQoJCQkJY2hlY2tDb250ZXh0ID0gbnVsbDsKCQkJCXJldHVybiByZXQ7CgkJCX0gXTsKCgkJZm9yICggOyBpIDwgbGVuOyBpKysgKSB7CgkJCWlmICggKG1hdGNoZXIgPSBFeHByLnJlbGF0aXZlWyB0b2tlbnNbaV0udHlwZSBdKSApIHsKCQkJCW1hdGNoZXJzID0gWyBhZGRDb21iaW5hdG9yKGVsZW1lbnRNYXRjaGVyKCBtYXRjaGVycyApLCBtYXRjaGVyKSBdOwoJCQl9IGVsc2UgewoJCQkJbWF0Y2hlciA9IEV4cHIuZmlsdGVyWyB0b2tlbnNbaV0udHlwZSBdLmFwcGx5KCBudWxsLCB0b2tlbnNbaV0ubWF0Y2hlcyApOwoKCQkJCS8vIFJldHVybiBzcGVjaWFsIHVwb24gc2VlaW5nIGEgcG9zaXRpb25hbCBtYXRjaGVyCgkJCQlpZiAoIG1hdGNoZXJbIGV4cGFuZG8gXSApIHsKCQkJCQkvLyBGaW5kIHRoZSBuZXh0IHJlbGF0aXZlIG9wZXJhdG9yIChpZiBhbnkpIGZvciBwcm9wZXIgaGFuZGxpbmcKCQkJCQlqID0gKytpOwoJCQkJCWZvciAoIDsgaiA8IGxlbjsgaisrICkgewoJCQkJCQlpZiAoIEV4cHIucmVsYXRpdmVbIHRva2Vuc1tqXS50eXBlIF0gKSB7CgkJCQkJCQlicmVhazsKCQkJCQkJfQoJCQkJCX0KCQkJCQlyZXR1cm4gc2V0TWF0Y2hlcigKCQkJCQkJaSA+IDEgJiYgZWxlbWVudE1hdGNoZXIoIG1hdGNoZXJzICksCgkJCQkJCWkgPiAxICYmIHRvU2VsZWN0b3IoCgkJCQkJCQkvLyBJZiB0aGUgcHJlY2VkaW5nIHRva2VuIHdhcyBhIGRlc2NlbmRhbnQgY29tYmluYXRvciwgaW5zZXJ0IGFuIGltcGxpY2l0IGFueS1lbGVtZW50IGAqYAoJCQkJCQkJdG9rZW5zLnNsaWNlKCAwLCBpIC0gMSApLmNvbmNhdCh7IHZhbHVlOiB0b2tlbnNbIGkgLSAyIF0udHlwZSA9PT0gIiAiID8gIioiIDogIiIgfSkKCQkJCQkJKS5yZXBsYWNlKCBydHJpbSwgIiQxIiApLAoJCQkJCQltYXRjaGVyLAoJCQkJCQlpIDwgaiAmJiBtYXRjaGVyRnJvbVRva2VucyggdG9rZW5zLnNsaWNlKCBpLCBqICkgKSwKCQkJCQkJaiA8IGxlbiAmJiBtYXRjaGVyRnJvbVRva2VucyggKHRva2VucyA9IHRva2Vucy5zbGljZSggaiApKSApLAoJCQkJCQlqIDwgbGVuICYmIHRvU2VsZWN0b3IoIHRva2VucyApCgkJCQkJKTsKCQkJCX0KCQkJCW1hdGNoZXJzLnB1c2goIG1hdGNoZXIgKTsKCQkJfQoJCX0KCgkJcmV0dXJuIGVsZW1lbnRNYXRjaGVyKCBtYXRjaGVycyApOwoJfQoKCWZ1bmN0aW9uIG1hdGNoZXJGcm9tR3JvdXBNYXRjaGVycyggZWxlbWVudE1hdGNoZXJzLCBzZXRNYXRjaGVycyApIHsKCQl2YXIgYnlTZXQgPSBzZXRNYXRjaGVycy5sZW5ndGggPiAwLAoJCQlieUVsZW1lbnQgPSBlbGVtZW50TWF0Y2hlcnMubGVuZ3RoID4gMCwKCQkJc3VwZXJNYXRjaGVyID0gZnVuY3Rpb24oIHNlZWQsIGNvbnRleHQsIHhtbCwgcmVzdWx0cywgb3V0ZXJtb3N0ICkgewoJCQkJdmFyIGVsZW0sIGosIG1hdGNoZXIsCgkJCQkJbWF0Y2hlZENvdW50ID0gMCwKCQkJCQlpID0gIjAiLAoJCQkJCXVubWF0Y2hlZCA9IHNlZWQgJiYgW10sCgkJCQkJc2V0TWF0Y2hlZCA9IFtdLAoJCQkJCWNvbnRleHRCYWNrdXAgPSBvdXRlcm1vc3RDb250ZXh0LAoJCQkJCS8vIFdlIG11c3QgYWx3YXlzIGhhdmUgZWl0aGVyIHNlZWQgZWxlbWVudHMgb3Igb3V0ZXJtb3N0IGNvbnRleHQKCQkJCQllbGVtcyA9IHNlZWQgfHwgYnlFbGVtZW50ICYmIEV4cHIuZmluZFsiVEFHIl0oICIqIiwgb3V0ZXJtb3N0ICksCgkJCQkJLy8gVXNlIGludGVnZXIgZGlycnVucyBpZmYgdGhpcyBpcyB0aGUgb3V0ZXJtb3N0IG1hdGNoZXIKCQkJCQlkaXJydW5zVW5pcXVlID0gKGRpcnJ1bnMgKz0gY29udGV4dEJhY2t1cCA9PSBudWxsID8gMSA6IE1hdGgucmFuZG9tKCkgfHwgMC4xKSwKCQkJCQlsZW4gPSBlbGVtcy5sZW5ndGg7CgoJCQkJaWYgKCBvdXRlcm1vc3QgKSB7CgkJCQkJb3V0ZXJtb3N0Q29udGV4dCA9IGNvbnRleHQgIT09IGRvY3VtZW50ICYmIGNvbnRleHQ7CgkJCQl9CgoJCQkJLy8gQWRkIGVsZW1lbnRzIHBhc3NpbmcgZWxlbWVudE1hdGNoZXJzIGRpcmVjdGx5IHRvIHJlc3VsdHMKCQkJCS8vIEtlZXAgYGlgIGEgc3RyaW5nIGlmIHRoZXJlIGFyZSBubyBlbGVtZW50cyBzbyBgbWF0Y2hlZENvdW50YCB3aWxsIGJlICIwMCIgYmVsb3cKCQkJCS8vIFN1cHBvcnQ6IElFPDksIFNhZmFyaQoJCQkJLy8gVG9sZXJhdGUgTm9kZUxpc3QgcHJvcGVydGllcyAoSUU6ICJsZW5ndGgiOyBTYWZhcmk6IDxudW1iZXI+KSBtYXRjaGluZyBlbGVtZW50cyBieSBpZAoJCQkJZm9yICggOyBpICE9PSBsZW4gJiYgKGVsZW0gPSBlbGVtc1tpXSkgIT0gbnVsbDsgaSsrICkgewoJCQkJCWlmICggYnlFbGVtZW50ICYmIGVsZW0gKSB7CgkJCQkJCWogPSAwOwoJCQkJCQl3aGlsZSAoIChtYXRjaGVyID0gZWxlbWVudE1hdGNoZXJzW2orK10pICkgewoJCQkJCQkJaWYgKCBtYXRjaGVyKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHsKCQkJCQkJCQlyZXN1bHRzLnB1c2goIGVsZW0gKTsKCQkJCQkJCQlicmVhazsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQlpZiAoIG91dGVybW9zdCApIHsKCQkJCQkJCWRpcnJ1bnMgPSBkaXJydW5zVW5pcXVlOwoJCQkJCQl9CgkJCQkJfQoKCQkJCQkvLyBUcmFjayB1bm1hdGNoZWQgZWxlbWVudHMgZm9yIHNldCBmaWx0ZXJzCgkJCQkJaWYgKCBieVNldCApIHsKCQkJCQkJLy8gVGhleSB3aWxsIGhhdmUgZ29uZSB0aHJvdWdoIGFsbCBwb3NzaWJsZSBtYXRjaGVycwoJCQkJCQlpZiAoIChlbGVtID0gIW1hdGNoZXIgJiYgZWxlbSkgKSB7CgkJCQkJCQltYXRjaGVkQ291bnQtLTsKCQkJCQkJfQoKCQkJCQkJLy8gTGVuZ3RoZW4gdGhlIGFycmF5IGZvciBldmVyeSBlbGVtZW50LCBtYXRjaGVkIG9yIG5vdAoJCQkJCQlpZiAoIHNlZWQgKSB7CgkJCQkJCQl1bm1hdGNoZWQucHVzaCggZWxlbSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCS8vIEFwcGx5IHNldCBmaWx0ZXJzIHRvIHVubWF0Y2hlZCBlbGVtZW50cwoJCQkJbWF0Y2hlZENvdW50ICs9IGk7CgkJCQlpZiAoIGJ5U2V0ICYmIGkgIT09IG1hdGNoZWRDb3VudCApIHsKCQkJCQlqID0gMDsKCQkJCQl3aGlsZSAoIChtYXRjaGVyID0gc2V0TWF0Y2hlcnNbaisrXSkgKSB7CgkJCQkJCW1hdGNoZXIoIHVubWF0Y2hlZCwgc2V0TWF0Y2hlZCwgY29udGV4dCwgeG1sICk7CgkJCQkJfQoKCQkJCQlpZiAoIHNlZWQgKSB7CgkJCQkJCS8vIFJlaW50ZWdyYXRlIGVsZW1lbnQgbWF0Y2hlcyB0byBlbGltaW5hdGUgdGhlIG5lZWQgZm9yIHNvcnRpbmcKCQkJCQkJaWYgKCBtYXRjaGVkQ291bnQgPiAwICkgewoJCQkJCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQkJCQkJaWYgKCAhKHVubWF0Y2hlZFtpXSB8fCBzZXRNYXRjaGVkW2ldKSApIHsKCQkJCQkJCQkJc2V0TWF0Y2hlZFtpXSA9IHBvcC5jYWxsKCByZXN1bHRzICk7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgoJCQkJCQkvLyBEaXNjYXJkIGluZGV4IHBsYWNlaG9sZGVyIHZhbHVlcyB0byBnZXQgb25seSBhY3R1YWwgbWF0Y2hlcwoJCQkJCQlzZXRNYXRjaGVkID0gY29uZGVuc2UoIHNldE1hdGNoZWQgKTsKCQkJCQl9CgoJCQkJCS8vIEFkZCBtYXRjaGVzIHRvIHJlc3VsdHMKCQkJCQlwdXNoLmFwcGx5KCByZXN1bHRzLCBzZXRNYXRjaGVkICk7CgoJCQkJCS8vIFNlZWRsZXNzIHNldCBtYXRjaGVzIHN1Y2NlZWRpbmcgbXVsdGlwbGUgc3VjY2Vzc2Z1bCBtYXRjaGVycyBzdGlwdWxhdGUgc29ydGluZwoJCQkJCWlmICggb3V0ZXJtb3N0ICYmICFzZWVkICYmIHNldE1hdGNoZWQubGVuZ3RoID4gMCAmJgoJCQkJCQkoIG1hdGNoZWRDb3VudCArIHNldE1hdGNoZXJzLmxlbmd0aCApID4gMSApIHsKCgkJCQkJCVNpenpsZS51bmlxdWVTb3J0KCByZXN1bHRzICk7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIE92ZXJyaWRlIG1hbmlwdWxhdGlvbiBvZiBnbG9iYWxzIGJ5IG5lc3RlZCBtYXRjaGVycwoJCQkJaWYgKCBvdXRlcm1vc3QgKSB7CgkJCQkJZGlycnVucyA9IGRpcnJ1bnNVbmlxdWU7CgkJCQkJb3V0ZXJtb3N0Q29udGV4dCA9IGNvbnRleHRCYWNrdXA7CgkJCQl9CgoJCQkJcmV0dXJuIHVubWF0Y2hlZDsKCQkJfTsKCgkJcmV0dXJuIGJ5U2V0ID8KCQkJbWFya0Z1bmN0aW9uKCBzdXBlck1hdGNoZXIgKSA6CgkJCXN1cGVyTWF0Y2hlcjsKCX0KCgljb21waWxlID0gU2l6emxlLmNvbXBpbGUgPSBmdW5jdGlvbiggc2VsZWN0b3IsIG1hdGNoIC8qIEludGVybmFsIFVzZSBPbmx5ICovICkgewoJCXZhciBpLAoJCQlzZXRNYXRjaGVycyA9IFtdLAoJCQllbGVtZW50TWF0Y2hlcnMgPSBbXSwKCQkJY2FjaGVkID0gY29tcGlsZXJDYWNoZVsgc2VsZWN0b3IgKyAiICIgXTsKCgkJaWYgKCAhY2FjaGVkICkgewoJCQkvLyBHZW5lcmF0ZSBhIGZ1bmN0aW9uIG9mIHJlY3Vyc2l2ZSBmdW5jdGlvbnMgdGhhdCBjYW4gYmUgdXNlZCB0byBjaGVjayBlYWNoIGVsZW1lbnQKCQkJaWYgKCAhbWF0Y2ggKSB7CgkJCQltYXRjaCA9IHRva2VuaXplKCBzZWxlY3RvciApOwoJCQl9CgkJCWkgPSBtYXRjaC5sZW5ndGg7CgkJCXdoaWxlICggaS0tICkgewoJCQkJY2FjaGVkID0gbWF0Y2hlckZyb21Ub2tlbnMoIG1hdGNoW2ldICk7CgkJCQlpZiAoIGNhY2hlZFsgZXhwYW5kbyBdICkgewoJCQkJCXNldE1hdGNoZXJzLnB1c2goIGNhY2hlZCApOwoJCQkJfSBlbHNlIHsKCQkJCQllbGVtZW50TWF0Y2hlcnMucHVzaCggY2FjaGVkICk7CgkJCQl9CgkJCX0KCgkJCS8vIENhY2hlIHRoZSBjb21waWxlZCBmdW5jdGlvbgoJCQljYWNoZWQgPSBjb21waWxlckNhY2hlKCBzZWxlY3RvciwgbWF0Y2hlckZyb21Hcm91cE1hdGNoZXJzKCBlbGVtZW50TWF0Y2hlcnMsIHNldE1hdGNoZXJzICkgKTsKCgkJCS8vIFNhdmUgc2VsZWN0b3IgYW5kIHRva2VuaXphdGlvbgoJCQljYWNoZWQuc2VsZWN0b3IgPSBzZWxlY3RvcjsKCQl9CgkJcmV0dXJuIGNhY2hlZDsKCX07CgoJLyoqCgkgKiBBIGxvdy1sZXZlbCBzZWxlY3Rpb24gZnVuY3Rpb24gdGhhdCB3b3JrcyB3aXRoIFNpenpsZSdzIGNvbXBpbGVkCgkgKiAgc2VsZWN0b3IgZnVuY3Rpb25zCgkgKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gc2VsZWN0b3IgQSBzZWxlY3RvciBvciBhIHByZS1jb21waWxlZAoJICogIHNlbGVjdG9yIGZ1bmN0aW9uIGJ1aWx0IHdpdGggU2l6emxlLmNvbXBpbGUKCSAqIEBwYXJhbSB7RWxlbWVudH0gY29udGV4dAoJICogQHBhcmFtIHtBcnJheX0gW3Jlc3VsdHNdCgkgKiBAcGFyYW0ge0FycmF5fSBbc2VlZF0gQSBzZXQgb2YgZWxlbWVudHMgdG8gbWF0Y2ggYWdhaW5zdAoJICovCglzZWxlY3QgPSBTaXp6bGUuc2VsZWN0ID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkICkgewoJCXZhciBpLCB0b2tlbnMsIHRva2VuLCB0eXBlLCBmaW5kLAoJCQljb21waWxlZCA9IHR5cGVvZiBzZWxlY3RvciA9PT0gImZ1bmN0aW9uIiAmJiBzZWxlY3RvciwKCQkJbWF0Y2ggPSAhc2VlZCAmJiB0b2tlbml6ZSggKHNlbGVjdG9yID0gY29tcGlsZWQuc2VsZWN0b3IgfHwgc2VsZWN0b3IpICk7CgoJCXJlc3VsdHMgPSByZXN1bHRzIHx8IFtdOwoKCQkvLyBUcnkgdG8gbWluaW1pemUgb3BlcmF0aW9ucyBpZiB0aGVyZSBpcyBubyBzZWVkIGFuZCBvbmx5IG9uZSBncm91cAoJCWlmICggbWF0Y2gubGVuZ3RoID09PSAxICkgewoKCQkJLy8gVGFrZSBhIHNob3J0Y3V0IGFuZCBzZXQgdGhlIGNvbnRleHQgaWYgdGhlIHJvb3Qgc2VsZWN0b3IgaXMgYW4gSUQKCQkJdG9rZW5zID0gbWF0Y2hbMF0gPSBtYXRjaFswXS5zbGljZSggMCApOwoJCQlpZiAoIHRva2Vucy5sZW5ndGggPiAyICYmICh0b2tlbiA9IHRva2Vuc1swXSkudHlwZSA9PT0gIklEIiAmJgoJCQkJCXN1cHBvcnQuZ2V0QnlJZCAmJiBjb250ZXh0Lm5vZGVUeXBlID09PSA5ICYmIGRvY3VtZW50SXNIVE1MICYmCgkJCQkJRXhwci5yZWxhdGl2ZVsgdG9rZW5zWzFdLnR5cGUgXSApIHsKCgkJCQljb250ZXh0ID0gKCBFeHByLmZpbmRbIklEIl0oIHRva2VuLm1hdGNoZXNbMF0ucmVwbGFjZShydW5lc2NhcGUsIGZ1bmVzY2FwZSksIGNvbnRleHQgKSB8fCBbXSApWzBdOwoJCQkJaWYgKCAhY29udGV4dCApIHsKCQkJCQlyZXR1cm4gcmVzdWx0czsKCgkJCQkvLyBQcmVjb21waWxlZCBtYXRjaGVycyB3aWxsIHN0aWxsIHZlcmlmeSBhbmNlc3RyeSwgc28gc3RlcCB1cCBhIGxldmVsCgkJCQl9IGVsc2UgaWYgKCBjb21waWxlZCApIHsKCQkJCQljb250ZXh0ID0gY29udGV4dC5wYXJlbnROb2RlOwoJCQkJfQoKCQkJCXNlbGVjdG9yID0gc2VsZWN0b3Iuc2xpY2UoIHRva2Vucy5zaGlmdCgpLnZhbHVlLmxlbmd0aCApOwoJCQl9CgoJCQkvLyBGZXRjaCBhIHNlZWQgc2V0IGZvciByaWdodC10by1sZWZ0IG1hdGNoaW5nCgkJCWkgPSBtYXRjaEV4cHJbIm5lZWRzQ29udGV4dCJdLnRlc3QoIHNlbGVjdG9yICkgPyAwIDogdG9rZW5zLmxlbmd0aDsKCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQl0b2tlbiA9IHRva2Vuc1tpXTsKCgkJCQkvLyBBYm9ydCBpZiB3ZSBoaXQgYSBjb21iaW5hdG9yCgkJCQlpZiAoIEV4cHIucmVsYXRpdmVbICh0eXBlID0gdG9rZW4udHlwZSkgXSApIHsKCQkJCQlicmVhazsKCQkJCX0KCQkJCWlmICggKGZpbmQgPSBFeHByLmZpbmRbIHR5cGUgXSkgKSB7CgkJCQkJLy8gU2VhcmNoLCBleHBhbmRpbmcgY29udGV4dCBmb3IgbGVhZGluZyBzaWJsaW5nIGNvbWJpbmF0b3JzCgkJCQkJaWYgKCAoc2VlZCA9IGZpbmQoCgkJCQkJCXRva2VuLm1hdGNoZXNbMF0ucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKSwKCQkJCQkJcnNpYmxpbmcudGVzdCggdG9rZW5zWzBdLnR5cGUgKSAmJiB0ZXN0Q29udGV4dCggY29udGV4dC5wYXJlbnROb2RlICkgfHwgY29udGV4dAoJCQkJCSkpICkgewoKCQkJCQkJLy8gSWYgc2VlZCBpcyBlbXB0eSBvciBubyB0b2tlbnMgcmVtYWluLCB3ZSBjYW4gcmV0dXJuIGVhcmx5CgkJCQkJCXRva2Vucy5zcGxpY2UoIGksIDEgKTsKCQkJCQkJc2VsZWN0b3IgPSBzZWVkLmxlbmd0aCAmJiB0b1NlbGVjdG9yKCB0b2tlbnMgKTsKCQkJCQkJaWYgKCAhc2VsZWN0b3IgKSB7CgkJCQkJCQlwdXNoLmFwcGx5KCByZXN1bHRzLCBzZWVkICk7CgkJCQkJCQlyZXR1cm4gcmVzdWx0czsKCQkJCQkJfQoKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoKCQkvLyBDb21waWxlIGFuZCBleGVjdXRlIGEgZmlsdGVyaW5nIGZ1bmN0aW9uIGlmIG9uZSBpcyBub3QgcHJvdmlkZWQKCQkvLyBQcm92aWRlIGBtYXRjaGAgdG8gYXZvaWQgcmV0b2tlbml6YXRpb24gaWYgd2UgbW9kaWZpZWQgdGhlIHNlbGVjdG9yIGFib3ZlCgkJKCBjb21waWxlZCB8fCBjb21waWxlKCBzZWxlY3RvciwgbWF0Y2ggKSApKAoJCQlzZWVkLAoJCQljb250ZXh0LAoJCQkhZG9jdW1lbnRJc0hUTUwsCgkJCXJlc3VsdHMsCgkJCXJzaWJsaW5nLnRlc3QoIHNlbGVjdG9yICkgJiYgdGVzdENvbnRleHQoIGNvbnRleHQucGFyZW50Tm9kZSApIHx8IGNvbnRleHQKCQkpOwoJCXJldHVybiByZXN1bHRzOwoJfTsKCgkvLyBPbmUtdGltZSBhc3NpZ25tZW50cwoKCS8vIFNvcnQgc3RhYmlsaXR5CglzdXBwb3J0LnNvcnRTdGFibGUgPSBleHBhbmRvLnNwbGl0KCIiKS5zb3J0KCBzb3J0T3JkZXIgKS5qb2luKCIiKSA9PT0gZXhwYW5kbzsKCgkvLyBTdXBwb3J0OiBDaHJvbWUgMTQtMzUrCgkvLyBBbHdheXMgYXNzdW1lIGR1cGxpY2F0ZXMgaWYgdGhleSBhcmVuJ3QgcGFzc2VkIHRvIHRoZSBjb21wYXJpc29uIGZ1bmN0aW9uCglzdXBwb3J0LmRldGVjdER1cGxpY2F0ZXMgPSAhIWhhc0R1cGxpY2F0ZTsKCgkvLyBJbml0aWFsaXplIGFnYWluc3QgdGhlIGRlZmF1bHQgZG9jdW1lbnQKCXNldERvY3VtZW50KCk7CgoJLy8gU3VwcG9ydDogV2Via2l0PDUzNy4zMiAtIFNhZmFyaSA2LjAuMy9DaHJvbWUgMjUgKGZpeGVkIGluIENocm9tZSAyNykKCS8vIERldGFjaGVkIG5vZGVzIGNvbmZvdW5kaW5nbHkgZm9sbG93ICplYWNoIG90aGVyKgoJc3VwcG9ydC5zb3J0RGV0YWNoZWQgPSBhc3NlcnQoZnVuY3Rpb24oIGRpdjEgKSB7CgkJLy8gU2hvdWxkIHJldHVybiAxLCBidXQgcmV0dXJucyA0IChmb2xsb3dpbmcpCgkJcmV0dXJuIGRpdjEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpICkgJiAxOwoJfSk7CgoJLy8gU3VwcG9ydDogSUU8OAoJLy8gUHJldmVudCBhdHRyaWJ1dGUvcHJvcGVydHkgImludGVycG9sYXRpb24iCgkvLyBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvbXM1MzY0MjklMjhWUy44NSUyOS5hc3B4CglpZiAoICFhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHsKCQlkaXYuaW5uZXJIVE1MID0gIjxhIGhyZWY9JyMnPjwvYT4iOwoJCXJldHVybiBkaXYuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoImhyZWYiKSA9PT0gIiMiIDsKCX0pICkgewoJCWFkZEhhbmRsZSggInR5cGV8aHJlZnxoZWlnaHR8d2lkdGgiLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7CgkJCWlmICggIWlzWE1MICkgewoJCQkJcmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKCBuYW1lLCBuYW1lLnRvTG93ZXJDYXNlKCkgPT09ICJ0eXBlIiA/IDEgOiAyICk7CgkJCX0KCQl9KTsKCX0KCgkvLyBTdXBwb3J0OiBJRTw5CgkvLyBVc2UgZGVmYXVsdFZhbHVlIGluIHBsYWNlIG9mIGdldEF0dHJpYnV0ZSgidmFsdWUiKQoJaWYgKCAhc3VwcG9ydC5hdHRyaWJ1dGVzIHx8ICFhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHsKCQlkaXYuaW5uZXJIVE1MID0gIjxpbnB1dC8+IjsKCQlkaXYuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoICJ2YWx1ZSIsICIiICk7CgkJcmV0dXJuIGRpdi5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSggInZhbHVlIiApID09PSAiIjsKCX0pICkgewoJCWFkZEhhbmRsZSggInZhbHVlIiwgZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkgewoJCQlpZiAoICFpc1hNTCAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICJpbnB1dCIgKSB7CgkJCQlyZXR1cm4gZWxlbS5kZWZhdWx0VmFsdWU7CgkJCX0KCQl9KTsKCX0KCgkvLyBTdXBwb3J0OiBJRTw5CgkvLyBVc2UgZ2V0QXR0cmlidXRlTm9kZSB0byBmZXRjaCBib29sZWFucyB3aGVuIGdldEF0dHJpYnV0ZSBsaWVzCglpZiAoICFhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHsKCQlyZXR1cm4gZGl2LmdldEF0dHJpYnV0ZSgiZGlzYWJsZWQiKSA9PSBudWxsOwoJfSkgKSB7CgkJYWRkSGFuZGxlKCBib29sZWFucywgZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkgewoJCQl2YXIgdmFsOwoJCQlpZiAoICFpc1hNTCApIHsKCQkJCXJldHVybiBlbGVtWyBuYW1lIF0gPT09IHRydWUgPyBuYW1lLnRvTG93ZXJDYXNlKCkgOgoJCQkJCQkodmFsID0gZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKCBuYW1lICkpICYmIHZhbC5zcGVjaWZpZWQgPwoJCQkJCQl2YWwudmFsdWUgOgoJCQkJCW51bGw7CgkJCX0KCQl9KTsKCX0KCglyZXR1cm4gU2l6emxlOwoKCX0pKCB3aW5kb3cgKTsKCgoKCWpRdWVyeS5maW5kID0gU2l6emxlOwoJalF1ZXJ5LmV4cHIgPSBTaXp6bGUuc2VsZWN0b3JzOwoJalF1ZXJ5LmV4cHJbIjoiXSA9IGpRdWVyeS5leHByLnBzZXVkb3M7CglqUXVlcnkudW5pcXVlID0gU2l6emxlLnVuaXF1ZVNvcnQ7CglqUXVlcnkudGV4dCA9IFNpenpsZS5nZXRUZXh0OwoJalF1ZXJ5LmlzWE1MRG9jID0gU2l6emxlLmlzWE1MOwoJalF1ZXJ5LmNvbnRhaW5zID0gU2l6emxlLmNvbnRhaW5zOwoKCgoJdmFyIHJuZWVkc0NvbnRleHQgPSBqUXVlcnkuZXhwci5tYXRjaC5uZWVkc0NvbnRleHQ7CgoJdmFyIHJzaW5nbGVUYWcgPSAoL148KFx3KylccypcLz8+KD86PFwvXDE+fCkkLyk7CgoKCgl2YXIgcmlzU2ltcGxlID0gL14uW146I1xbXC4sXSokLzsKCgkvLyBJbXBsZW1lbnQgdGhlIGlkZW50aWNhbCBmdW5jdGlvbmFsaXR5IGZvciBmaWx0ZXIgYW5kIG5vdAoJZnVuY3Rpb24gd2lubm93KCBlbGVtZW50cywgcXVhbGlmaWVyLCBub3QgKSB7CgkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggcXVhbGlmaWVyICkgKSB7CgkJCXJldHVybiBqUXVlcnkuZ3JlcCggZWxlbWVudHMsIGZ1bmN0aW9uKCBlbGVtLCBpICkgewoJCQkJLyoganNoaW50IC1XMDE4ICovCgkJCQlyZXR1cm4gISFxdWFsaWZpZXIuY2FsbCggZWxlbSwgaSwgZWxlbSApICE9PSBub3Q7CgkJCX0pOwoKCQl9CgoJCWlmICggcXVhbGlmaWVyLm5vZGVUeXBlICkgewoJCQlyZXR1cm4galF1ZXJ5LmdyZXAoIGVsZW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiAoIGVsZW0gPT09IHF1YWxpZmllciApICE9PSBub3Q7CgkJCX0pOwoKCQl9CgoJCWlmICggdHlwZW9mIHF1YWxpZmllciA9PT0gInN0cmluZyIgKSB7CgkJCWlmICggcmlzU2ltcGxlLnRlc3QoIHF1YWxpZmllciApICkgewoJCQkJcmV0dXJuIGpRdWVyeS5maWx0ZXIoIHF1YWxpZmllciwgZWxlbWVudHMsIG5vdCApOwoJCQl9CgoJCQlxdWFsaWZpZXIgPSBqUXVlcnkuZmlsdGVyKCBxdWFsaWZpZXIsIGVsZW1lbnRzICk7CgkJfQoKCQlyZXR1cm4galF1ZXJ5LmdyZXAoIGVsZW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuICggalF1ZXJ5LmluQXJyYXkoIGVsZW0sIHF1YWxpZmllciApID49IDAgKSAhPT0gbm90OwoJCX0pOwoJfQoKCWpRdWVyeS5maWx0ZXIgPSBmdW5jdGlvbiggZXhwciwgZWxlbXMsIG5vdCApIHsKCQl2YXIgZWxlbSA9IGVsZW1zWyAwIF07CgoJCWlmICggbm90ICkgewoJCQlleHByID0gIjpub3QoIiArIGV4cHIgKyAiKSI7CgkJfQoKCQlyZXR1cm4gZWxlbXMubGVuZ3RoID09PSAxICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgPwoJCQlqUXVlcnkuZmluZC5tYXRjaGVzU2VsZWN0b3IoIGVsZW0sIGV4cHIgKSA/IFsgZWxlbSBdIDogW10gOgoJCQlqUXVlcnkuZmluZC5tYXRjaGVzKCBleHByLCBqUXVlcnkuZ3JlcCggZWxlbXMsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJcmV0dXJuIGVsZW0ubm9kZVR5cGUgPT09IDE7CgkJCX0pKTsKCX07CgoJalF1ZXJ5LmZuLmV4dGVuZCh7CgkJZmluZDogZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCQl2YXIgaSwKCQkJCXJldCA9IFtdLAoJCQkJc2VsZiA9IHRoaXMsCgkJCQlsZW4gPSBzZWxmLmxlbmd0aDsKCgkJCWlmICggdHlwZW9mIHNlbGVjdG9yICE9PSAic3RyaW5nIiApIHsKCQkJCXJldHVybiB0aGlzLnB1c2hTdGFjayggalF1ZXJ5KCBzZWxlY3RvciApLmZpbHRlcihmdW5jdGlvbigpIHsKCQkJCQlmb3IgKCBpID0gMDsgaSA8IGxlbjsgaSsrICkgewoJCQkJCQlpZiAoIGpRdWVyeS5jb250YWlucyggc2VsZlsgaSBdLCB0aGlzICkgKSB7CgkJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0pICk7CgkJCX0KCgkJCWZvciAoIGkgPSAwOyBpIDwgbGVuOyBpKysgKSB7CgkJCQlqUXVlcnkuZmluZCggc2VsZWN0b3IsIHNlbGZbIGkgXSwgcmV0ICk7CgkJCX0KCgkJCS8vIE5lZWRlZCBiZWNhdXNlICQoIHNlbGVjdG9yLCBjb250ZXh0ICkgYmVjb21lcyAkKCBjb250ZXh0ICkuZmluZCggc2VsZWN0b3IgKQoJCQlyZXQgPSB0aGlzLnB1c2hTdGFjayggbGVuID4gMSA/IGpRdWVyeS51bmlxdWUoIHJldCApIDogcmV0ICk7CgkJCXJldC5zZWxlY3RvciA9IHRoaXMuc2VsZWN0b3IgPyB0aGlzLnNlbGVjdG9yICsgIiAiICsgc2VsZWN0b3IgOiBzZWxlY3RvcjsKCQkJcmV0dXJuIHJldDsKCQl9LAoJCWZpbHRlcjogZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCQlyZXR1cm4gdGhpcy5wdXNoU3RhY2soIHdpbm5vdyh0aGlzLCBzZWxlY3RvciB8fCBbXSwgZmFsc2UpICk7CgkJfSwKCQlub3Q6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCB3aW5ub3codGhpcywgc2VsZWN0b3IgfHwgW10sIHRydWUpICk7CgkJfSwKCQlpczogZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCQlyZXR1cm4gISF3aW5ub3coCgkJCQl0aGlzLAoKCQkJCS8vIElmIHRoaXMgaXMgYSBwb3NpdGlvbmFsL3JlbGF0aXZlIHNlbGVjdG9yLCBjaGVjayBtZW1iZXJzaGlwIGluIHRoZSByZXR1cm5lZCBzZXQKCQkJCS8vIHNvICQoInA6Zmlyc3QiKS5pcygicDpsYXN0Iikgd29uJ3QgcmV0dXJuIHRydWUgZm9yIGEgZG9jIHdpdGggdHdvICJwIi4KCQkJCXR5cGVvZiBzZWxlY3RvciA9PT0gInN0cmluZyIgJiYgcm5lZWRzQ29udGV4dC50ZXN0KCBzZWxlY3RvciApID8KCQkJCQlqUXVlcnkoIHNlbGVjdG9yICkgOgoJCQkJCXNlbGVjdG9yIHx8IFtdLAoJCQkJZmFsc2UKCQkJKS5sZW5ndGg7CgkJfQoJfSk7CgoKCS8vIEluaXRpYWxpemUgYSBqUXVlcnkgb2JqZWN0CgoKCS8vIEEgY2VudHJhbCByZWZlcmVuY2UgdG8gdGhlIHJvb3QgalF1ZXJ5KGRvY3VtZW50KQoJdmFyIHJvb3RqUXVlcnksCgoJCS8vIFVzZSB0aGUgY29ycmVjdCBkb2N1bWVudCBhY2NvcmRpbmdseSB3aXRoIHdpbmRvdyBhcmd1bWVudCAoc2FuZGJveCkKCQlkb2N1bWVudCA9IHdpbmRvdy5kb2N1bWVudCwKCgkJLy8gQSBzaW1wbGUgd2F5IHRvIGNoZWNrIGZvciBIVE1MIHN0cmluZ3MKCQkvLyBQcmlvcml0aXplICNpZCBvdmVyIDx0YWc+IHRvIGF2b2lkIFhTUyB2aWEgbG9jYXRpb24uaGFzaCAoIzk1MjEpCgkJLy8gU3RyaWN0IEhUTUwgcmVjb2duaXRpb24gKCMxMTI5MDogbXVzdCBzdGFydCB3aXRoIDwpCgkJcnF1aWNrRXhwciA9IC9eKD86XHMqKDxbXHdcV10rPilbXj5dKnwjKFtcdy1dKikpJC8sCgoJCWluaXQgPSBqUXVlcnkuZm4uaW5pdCA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCApIHsKCQkJdmFyIG1hdGNoLCBlbGVtOwoKCQkJLy8gSEFORExFOiAkKCIiKSwgJChudWxsKSwgJCh1bmRlZmluZWQpLCAkKGZhbHNlKQoJCQlpZiAoICFzZWxlY3RvciApIHsKCQkJCXJldHVybiB0aGlzOwoJCQl9CgoJCQkvLyBIYW5kbGUgSFRNTCBzdHJpbmdzCgkJCWlmICggdHlwZW9mIHNlbGVjdG9yID09PSAic3RyaW5nIiApIHsKCQkJCWlmICggc2VsZWN0b3IuY2hhckF0KDApID09PSAiPCIgJiYgc2VsZWN0b3IuY2hhckF0KCBzZWxlY3Rvci5sZW5ndGggLSAxICkgPT09ICI+IiAmJiBzZWxlY3Rvci5sZW5ndGggPj0gMyApIHsKCQkJCQkvLyBBc3N1bWUgdGhhdCBzdHJpbmdzIHRoYXQgc3RhcnQgYW5kIGVuZCB3aXRoIDw+IGFyZSBIVE1MIGFuZCBza2lwIHRoZSByZWdleCBjaGVjawoJCQkJCW1hdGNoID0gWyBudWxsLCBzZWxlY3RvciwgbnVsbCBdOwoKCQkJCX0gZWxzZSB7CgkJCQkJbWF0Y2ggPSBycXVpY2tFeHByLmV4ZWMoIHNlbGVjdG9yICk7CgkJCQl9CgoJCQkJLy8gTWF0Y2ggaHRtbCBvciBtYWtlIHN1cmUgbm8gY29udGV4dCBpcyBzcGVjaWZpZWQgZm9yICNpZAoJCQkJaWYgKCBtYXRjaCAmJiAobWF0Y2hbMV0gfHwgIWNvbnRleHQpICkgewoKCQkJCQkvLyBIQU5ETEU6ICQoaHRtbCkgLT4gJChhcnJheSkKCQkJCQlpZiAoIG1hdGNoWzFdICkgewoJCQkJCQljb250ZXh0ID0gY29udGV4dCBpbnN0YW5jZW9mIGpRdWVyeSA/IGNvbnRleHRbMF0gOiBjb250ZXh0OwoKCQkJCQkJLy8gc2NyaXB0cyBpcyB0cnVlIGZvciBiYWNrLWNvbXBhdAoJCQkJCQkvLyBJbnRlbnRpb25hbGx5IGxldCB0aGUgZXJyb3IgYmUgdGhyb3duIGlmIHBhcnNlSFRNTCBpcyBub3QgcHJlc2VudAoJCQkJCQlqUXVlcnkubWVyZ2UoIHRoaXMsIGpRdWVyeS5wYXJzZUhUTUwoCgkJCQkJCQltYXRjaFsxXSwKCQkJCQkJCWNvbnRleHQgJiYgY29udGV4dC5ub2RlVHlwZSA/IGNvbnRleHQub3duZXJEb2N1bWVudCB8fCBjb250ZXh0IDogZG9jdW1lbnQsCgkJCQkJCQl0cnVlCgkJCQkJCSkgKTsKCgkJCQkJCS8vIEhBTkRMRTogJChodG1sLCBwcm9wcykKCQkJCQkJaWYgKCByc2luZ2xlVGFnLnRlc3QoIG1hdGNoWzFdICkgJiYgalF1ZXJ5LmlzUGxhaW5PYmplY3QoIGNvbnRleHQgKSApIHsKCQkJCQkJCWZvciAoIG1hdGNoIGluIGNvbnRleHQgKSB7CgkJCQkJCQkJLy8gUHJvcGVydGllcyBvZiBjb250ZXh0IGFyZSBjYWxsZWQgYXMgbWV0aG9kcyBpZiBwb3NzaWJsZQoJCQkJCQkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHRoaXNbIG1hdGNoIF0gKSApIHsKCQkJCQkJCQkJdGhpc1sgbWF0Y2ggXSggY29udGV4dFsgbWF0Y2ggXSApOwoKCQkJCQkJCQkvLyAuLi5hbmQgb3RoZXJ3aXNlIHNldCBhcyBhdHRyaWJ1dGVzCgkJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkJdGhpcy5hdHRyKCBtYXRjaCwgY29udGV4dFsgbWF0Y2ggXSApOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJcmV0dXJuIHRoaXM7CgoJCQkJCS8vIEhBTkRMRTogJCgjaWQpCgkJCQkJfSBlbHNlIHsKCQkJCQkJZWxlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBtYXRjaFsyXSApOwoKCQkJCQkJLy8gQ2hlY2sgcGFyZW50Tm9kZSB0byBjYXRjaCB3aGVuIEJsYWNrYmVycnkgNC42IHJldHVybnMKCQkJCQkJLy8gbm9kZXMgdGhhdCBhcmUgbm8gbG9uZ2VyIGluIHRoZSBkb2N1bWVudCAjNjk2MwoJCQkJCQlpZiAoIGVsZW0gJiYgZWxlbS5wYXJlbnROb2RlICkgewoJCQkJCQkJLy8gSGFuZGxlIHRoZSBjYXNlIHdoZXJlIElFIGFuZCBPcGVyYSByZXR1cm4gaXRlbXMKCQkJCQkJCS8vIGJ5IG5hbWUgaW5zdGVhZCBvZiBJRAoJCQkJCQkJaWYgKCBlbGVtLmlkICE9PSBtYXRjaFsyXSApIHsKCQkJCQkJCQlyZXR1cm4gcm9vdGpRdWVyeS5maW5kKCBzZWxlY3RvciApOwoJCQkJCQkJfQoKCQkJCQkJCS8vIE90aGVyd2lzZSwgd2UgaW5qZWN0IHRoZSBlbGVtZW50IGRpcmVjdGx5IGludG8gdGhlIGpRdWVyeSBvYmplY3QKCQkJCQkJCXRoaXMubGVuZ3RoID0gMTsKCQkJCQkJCXRoaXNbMF0gPSBlbGVtOwoJCQkJCQl9CgoJCQkJCQl0aGlzLmNvbnRleHQgPSBkb2N1bWVudDsKCQkJCQkJdGhpcy5zZWxlY3RvciA9IHNlbGVjdG9yOwoJCQkJCQlyZXR1cm4gdGhpczsKCQkJCQl9CgoJCQkJLy8gSEFORExFOiAkKGV4cHIsICQoLi4uKSkKCQkJCX0gZWxzZSBpZiAoICFjb250ZXh0IHx8IGNvbnRleA==", "base64"));
  res.write(new Buffer("dC5qcXVlcnkgKSB7CgkJCQkJcmV0dXJuICggY29udGV4dCB8fCByb290alF1ZXJ5ICkuZmluZCggc2VsZWN0b3IgKTsKCgkJCQkvLyBIQU5ETEU6ICQoZXhwciwgY29udGV4dCkKCQkJCS8vICh3aGljaCBpcyBqdXN0IGVxdWl2YWxlbnQgdG86ICQoY29udGV4dCkuZmluZChleHByKQoJCQkJfSBlbHNlIHsKCQkJCQlyZXR1cm4gdGhpcy5jb25zdHJ1Y3RvciggY29udGV4dCApLmZpbmQoIHNlbGVjdG9yICk7CgkJCQl9CgoJCQkvLyBIQU5ETEU6ICQoRE9NRWxlbWVudCkKCQkJfSBlbHNlIGlmICggc2VsZWN0b3Iubm9kZVR5cGUgKSB7CgkJCQl0aGlzLmNvbnRleHQgPSB0aGlzWzBdID0gc2VsZWN0b3I7CgkJCQl0aGlzLmxlbmd0aCA9IDE7CgkJCQlyZXR1cm4gdGhpczsKCgkJCS8vIEhBTkRMRTogJChmdW5jdGlvbikKCQkJLy8gU2hvcnRjdXQgZm9yIGRvY3VtZW50IHJlYWR5CgkJCX0gZWxzZSBpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBzZWxlY3RvciApICkgewoJCQkJcmV0dXJuIHR5cGVvZiByb290alF1ZXJ5LnJlYWR5ICE9PSAidW5kZWZpbmVkIiA/CgkJCQkJcm9vdGpRdWVyeS5yZWFkeSggc2VsZWN0b3IgKSA6CgkJCQkJLy8gRXhlY3V0ZSBpbW1lZGlhdGVseSBpZiByZWFkeSBpcyBub3QgcHJlc2VudAoJCQkJCXNlbGVjdG9yKCBqUXVlcnkgKTsKCQkJfQoKCQkJaWYgKCBzZWxlY3Rvci5zZWxlY3RvciAhPT0gdW5kZWZpbmVkICkgewoJCQkJdGhpcy5zZWxlY3RvciA9IHNlbGVjdG9yLnNlbGVjdG9yOwoJCQkJdGhpcy5jb250ZXh0ID0gc2VsZWN0b3IuY29udGV4dDsKCQkJfQoKCQkJcmV0dXJuIGpRdWVyeS5tYWtlQXJyYXkoIHNlbGVjdG9yLCB0aGlzICk7CgkJfTsKCgkvLyBHaXZlIHRoZSBpbml0IGZ1bmN0aW9uIHRoZSBqUXVlcnkgcHJvdG90eXBlIGZvciBsYXRlciBpbnN0YW50aWF0aW9uCglpbml0LnByb3RvdHlwZSA9IGpRdWVyeS5mbjsKCgkvLyBJbml0aWFsaXplIGNlbnRyYWwgcmVmZXJlbmNlCglyb290alF1ZXJ5ID0galF1ZXJ5KCBkb2N1bWVudCApOwoKCgl2YXIgcnBhcmVudHNwcmV2ID0gL14oPzpwYXJlbnRzfHByZXYoPzpVbnRpbHxBbGwpKS8sCgkJLy8gbWV0aG9kcyBndWFyYW50ZWVkIHRvIHByb2R1Y2UgYSB1bmlxdWUgc2V0IHdoZW4gc3RhcnRpbmcgZnJvbSBhIHVuaXF1ZSBzZXQKCQlndWFyYW50ZWVkVW5pcXVlID0gewoJCQljaGlsZHJlbjogdHJ1ZSwKCQkJY29udGVudHM6IHRydWUsCgkJCW5leHQ6IHRydWUsCgkJCXByZXY6IHRydWUKCQl9OwoKCWpRdWVyeS5leHRlbmQoewoJCWRpcjogZnVuY3Rpb24oIGVsZW0sIGRpciwgdW50aWwgKSB7CgkJCXZhciBtYXRjaGVkID0gW10sCgkJCQljdXIgPSBlbGVtWyBkaXIgXTsKCgkJCXdoaWxlICggY3VyICYmIGN1ci5ub2RlVHlwZSAhPT0gOSAmJiAodW50aWwgPT09IHVuZGVmaW5lZCB8fCBjdXIubm9kZVR5cGUgIT09IDEgfHwgIWpRdWVyeSggY3VyICkuaXMoIHVudGlsICkpICkgewoJCQkJaWYgKCBjdXIubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJbWF0Y2hlZC5wdXNoKCBjdXIgKTsKCQkJCX0KCQkJCWN1ciA9IGN1cltkaXJdOwoJCQl9CgkJCXJldHVybiBtYXRjaGVkOwoJCX0sCgoJCXNpYmxpbmc6IGZ1bmN0aW9uKCBuLCBlbGVtICkgewoJCQl2YXIgciA9IFtdOwoKCQkJZm9yICggOyBuOyBuID0gbi5uZXh0U2libGluZyApIHsKCQkJCWlmICggbi5ub2RlVHlwZSA9PT0gMSAmJiBuICE9PSBlbGVtICkgewoJCQkJCXIucHVzaCggbiApOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gcjsKCQl9Cgl9KTsKCglqUXVlcnkuZm4uZXh0ZW5kKHsKCQloYXM6IGZ1bmN0aW9uKCB0YXJnZXQgKSB7CgkJCXZhciBpLAoJCQkJdGFyZ2V0cyA9IGpRdWVyeSggdGFyZ2V0LCB0aGlzICksCgkJCQlsZW4gPSB0YXJnZXRzLmxlbmd0aDsKCgkJCXJldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbigpIHsKCQkJCWZvciAoIGkgPSAwOyBpIDwgbGVuOyBpKysgKSB7CgkJCQkJaWYgKCBqUXVlcnkuY29udGFpbnMoIHRoaXMsIHRhcmdldHNbaV0gKSApIHsKCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJfQoJCQkJfQoJCQl9KTsKCQl9LAoKCQljbG9zZXN0OiBmdW5jdGlvbiggc2VsZWN0b3JzLCBjb250ZXh0ICkgewoJCQl2YXIgY3VyLAoJCQkJaSA9IDAsCgkJCQlsID0gdGhpcy5sZW5ndGgsCgkJCQltYXRjaGVkID0gW10sCgkJCQlwb3MgPSBybmVlZHNDb250ZXh0LnRlc3QoIHNlbGVjdG9ycyApIHx8IHR5cGVvZiBzZWxlY3RvcnMgIT09ICJzdHJpbmciID8KCQkJCQlqUXVlcnkoIHNlbGVjdG9ycywgY29udGV4dCB8fCB0aGlzLmNvbnRleHQgKSA6CgkJCQkJMDsKCgkJCWZvciAoIDsgaSA8IGw7IGkrKyApIHsKCQkJCWZvciAoIGN1ciA9IHRoaXNbaV07IGN1ciAmJiBjdXIgIT09IGNvbnRleHQ7IGN1ciA9IGN1ci5wYXJlbnROb2RlICkgewoJCQkJCS8vIEFsd2F5cyBza2lwIGRvY3VtZW50IGZyYWdtZW50cwoJCQkJCWlmICggY3VyLm5vZGVUeXBlIDwgMTEgJiYgKHBvcyA/CgkJCQkJCXBvcy5pbmRleChjdXIpID4gLTEgOgoKCQkJCQkJLy8gRG9uJ3QgcGFzcyBub24tZWxlbWVudHMgdG8gU2l6emxlCgkJCQkJCWN1ci5ub2RlVHlwZSA9PT0gMSAmJgoJCQkJCQkJalF1ZXJ5LmZpbmQubWF0Y2hlc1NlbGVjdG9yKGN1ciwgc2VsZWN0b3JzKSkgKSB7CgoJCQkJCQltYXRjaGVkLnB1c2goIGN1ciApOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCXJldHVybiB0aGlzLnB1c2hTdGFjayggbWF0Y2hlZC5sZW5ndGggPiAxID8galF1ZXJ5LnVuaXF1ZSggbWF0Y2hlZCApIDogbWF0Y2hlZCApOwoJCX0sCgoJCS8vIERldGVybWluZSB0aGUgcG9zaXRpb24gb2YgYW4gZWxlbWVudCB3aXRoaW4KCQkvLyB0aGUgbWF0Y2hlZCBzZXQgb2YgZWxlbWVudHMKCQlpbmRleDogZnVuY3Rpb24oIGVsZW0gKSB7CgoJCQkvLyBObyBhcmd1bWVudCwgcmV0dXJuIGluZGV4IGluIHBhcmVudAoJCQlpZiAoICFlbGVtICkgewoJCQkJcmV0dXJuICggdGhpc1swXSAmJiB0aGlzWzBdLnBhcmVudE5vZGUgKSA/IHRoaXMuZmlyc3QoKS5wcmV2QWxsKCkubGVuZ3RoIDogLTE7CgkJCX0KCgkJCS8vIGluZGV4IGluIHNlbGVjdG9yCgkJCWlmICggdHlwZW9mIGVsZW0gPT09ICJzdHJpbmciICkgewoJCQkJcmV0dXJuIGpRdWVyeS5pbkFycmF5KCB0aGlzWzBdLCBqUXVlcnkoIGVsZW0gKSApOwoJCQl9CgoJCQkvLyBMb2NhdGUgdGhlIHBvc2l0aW9uIG9mIHRoZSBkZXNpcmVkIGVsZW1lbnQKCQkJcmV0dXJuIGpRdWVyeS5pbkFycmF5KAoJCQkJLy8gSWYgaXQgcmVjZWl2ZXMgYSBqUXVlcnkgb2JqZWN0LCB0aGUgZmlyc3QgZWxlbWVudCBpcyB1c2VkCgkJCQllbGVtLmpxdWVyeSA/IGVsZW1bMF0gOiBlbGVtLCB0aGlzICk7CgkJfSwKCgkJYWRkOiBmdW5jdGlvbiggc2VsZWN0b3IsIGNvbnRleHQgKSB7CgkJCXJldHVybiB0aGlzLnB1c2hTdGFjaygKCQkJCWpRdWVyeS51bmlxdWUoCgkJCQkJalF1ZXJ5Lm1lcmdlKCB0aGlzLmdldCgpLCBqUXVlcnkoIHNlbGVjdG9yLCBjb250ZXh0ICkgKQoJCQkJKQoJCQkpOwoJCX0sCgoJCWFkZEJhY2s6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQkJcmV0dXJuIHRoaXMuYWRkKCBzZWxlY3RvciA9PSBudWxsID8KCQkJCXRoaXMucHJldk9iamVjdCA6IHRoaXMucHJldk9iamVjdC5maWx0ZXIoc2VsZWN0b3IpCgkJCSk7CgkJfQoJfSk7CgoJZnVuY3Rpb24gc2libGluZyggY3VyLCBkaXIgKSB7CgkJZG8gewoJCQljdXIgPSBjdXJbIGRpciBdOwoJCX0gd2hpbGUgKCBjdXIgJiYgY3VyLm5vZGVUeXBlICE9PSAxICk7CgoJCXJldHVybiBjdXI7Cgl9CgoJalF1ZXJ5LmVhY2goewoJCXBhcmVudDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXZhciBwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGU7CgkJCXJldHVybiBwYXJlbnQgJiYgcGFyZW50Lm5vZGVUeXBlICE9PSAxMSA/IHBhcmVudCA6IG51bGw7CgkJfSwKCQlwYXJlbnRzOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIGpRdWVyeS5kaXIoIGVsZW0sICJwYXJlbnROb2RlIiApOwoJCX0sCgkJcGFyZW50c1VudGlsOiBmdW5jdGlvbiggZWxlbSwgaSwgdW50aWwgKSB7CgkJCXJldHVybiBqUXVlcnkuZGlyKCBlbGVtLCAicGFyZW50Tm9kZSIsIHVudGlsICk7CgkJfSwKCQluZXh0OiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIHNpYmxpbmcoIGVsZW0sICJuZXh0U2libGluZyIgKTsKCQl9LAoJCXByZXY6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gc2libGluZyggZWxlbSwgInByZXZpb3VzU2libGluZyIgKTsKCQl9LAoJCW5leHRBbGw6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4galF1ZXJ5LmRpciggZWxlbSwgIm5leHRTaWJsaW5nIiApOwoJCX0sCgkJcHJldkFsbDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXJldHVybiBqUXVlcnkuZGlyKCBlbGVtLCAicHJldmlvdXNTaWJsaW5nIiApOwoJCX0sCgkJbmV4dFVudGlsOiBmdW5jdGlvbiggZWxlbSwgaSwgdW50aWwgKSB7CgkJCXJldHVybiBqUXVlcnkuZGlyKCBlbGVtLCAibmV4dFNpYmxpbmciLCB1bnRpbCApOwoJCX0sCgkJcHJldlVudGlsOiBmdW5jdGlvbiggZWxlbSwgaSwgdW50aWwgKSB7CgkJCXJldHVybiBqUXVlcnkuZGlyKCBlbGVtLCAicHJldmlvdXNTaWJsaW5nIiwgdW50aWwgKTsKCQl9LAoJCXNpYmxpbmdzOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIGpRdWVyeS5zaWJsaW5nKCAoIGVsZW0ucGFyZW50Tm9kZSB8fCB7fSApLmZpcnN0Q2hpbGQsIGVsZW0gKTsKCQl9LAoJCWNoaWxkcmVuOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIGpRdWVyeS5zaWJsaW5nKCBlbGVtLmZpcnN0Q2hpbGQgKTsKCQl9LAoJCWNvbnRlbnRzOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIGpRdWVyeS5ub2RlTmFtZSggZWxlbSwgImlmcmFtZSIgKSA/CgkJCQllbGVtLmNvbnRlbnREb2N1bWVudCB8fCBlbGVtLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQgOgoJCQkJalF1ZXJ5Lm1lcmdlKCBbXSwgZWxlbS5jaGlsZE5vZGVzICk7CgkJfQoJfSwgZnVuY3Rpb24oIG5hbWUsIGZuICkgewoJCWpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIHVudGlsLCBzZWxlY3RvciApIHsKCQkJdmFyIHJldCA9IGpRdWVyeS5tYXAoIHRoaXMsIGZuLCB1bnRpbCApOwoKCQkJaWYgKCBuYW1lLnNsaWNlKCAtNSApICE9PSAiVW50aWwiICkgewoJCQkJc2VsZWN0b3IgPSB1bnRpbDsKCQkJfQoKCQkJaWYgKCBzZWxlY3RvciAmJiB0eXBlb2Ygc2VsZWN0b3IgPT09ICJzdHJpbmciICkgewoJCQkJcmV0ID0galF1ZXJ5LmZpbHRlciggc2VsZWN0b3IsIHJldCApOwoJCQl9CgoJCQlpZiAoIHRoaXMubGVuZ3RoID4gMSApIHsKCQkJCS8vIFJlbW92ZSBkdXBsaWNhdGVzCgkJCQlpZiAoICFndWFyYW50ZWVkVW5pcXVlWyBuYW1lIF0gKSB7CgkJCQkJcmV0ID0galF1ZXJ5LnVuaXF1ZSggcmV0ICk7CgkJCQl9CgoJCQkJLy8gUmV2ZXJzZSBvcmRlciBmb3IgcGFyZW50cyogYW5kIHByZXYtZGVyaXZhdGl2ZXMKCQkJCWlmICggcnBhcmVudHNwcmV2LnRlc3QoIG5hbWUgKSApIHsKCQkJCQlyZXQgPSByZXQucmV2ZXJzZSgpOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gdGhpcy5wdXNoU3RhY2soIHJldCApOwoJCX07Cgl9KTsKCXZhciBybm90d2hpdGUgPSAoL1xTKy9nKTsKCgoKCS8vIFN0cmluZyB0byBPYmplY3Qgb3B0aW9ucyBmb3JtYXQgY2FjaGUKCXZhciBvcHRpb25zQ2FjaGUgPSB7fTsKCgkvLyBDb252ZXJ0IFN0cmluZy1mb3JtYXR0ZWQgb3B0aW9ucyBpbnRvIE9iamVjdC1mb3JtYXR0ZWQgb25lcyBhbmQgc3RvcmUgaW4gY2FjaGUKCWZ1bmN0aW9uIGNyZWF0ZU9wdGlvbnMoIG9wdGlvbnMgKSB7CgkJdmFyIG9iamVjdCA9IG9wdGlvbnNDYWNoZVsgb3B0aW9ucyBdID0ge307CgkJalF1ZXJ5LmVhY2goIG9wdGlvbnMubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdLCBmdW5jdGlvbiggXywgZmxhZyApIHsKCQkJb2JqZWN0WyBmbGFnIF0gPSB0cnVlOwoJCX0pOwoJCXJldHVybiBvYmplY3Q7Cgl9CgoJLyoKCSAqIENyZWF0ZSBhIGNhbGxiYWNrIGxpc3QgdXNpbmcgdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzOgoJICoKCSAqCW9wdGlvbnM6IGFuIG9wdGlvbmFsIGxpc3Qgb2Ygc3BhY2Utc2VwYXJhdGVkIG9wdGlvbnMgdGhhdCB3aWxsIGNoYW5nZSBob3cKCSAqCQkJdGhlIGNhbGxiYWNrIGxpc3QgYmVoYXZlcyBvciBhIG1vcmUgdHJhZGl0aW9uYWwgb3B0aW9uIG9iamVjdAoJICoKCSAqIEJ5IGRlZmF1bHQgYSBjYWxsYmFjayBsaXN0IHdpbGwgYWN0IGxpa2UgYW4gZXZlbnQgY2FsbGJhY2sgbGlzdCBhbmQgY2FuIGJlCgkgKiAiZmlyZWQiIG11bHRpcGxlIHRpbWVzLgoJICoKCSAqIFBvc3NpYmxlIG9wdGlvbnM6CgkgKgoJICoJb25jZToJCQl3aWxsIGVuc3VyZSB0aGUgY2FsbGJhY2sgbGlzdCBjYW4gb25seSBiZSBmaXJlZCBvbmNlIChsaWtlIGEgRGVmZXJyZWQpCgkgKgoJICoJbWVtb3J5OgkJCXdpbGwga2VlcCB0cmFjayBvZiBwcmV2aW91cyB2YWx1ZXMgYW5kIHdpbGwgY2FsbCBhbnkgY2FsbGJhY2sgYWRkZWQKCSAqCQkJCQlhZnRlciB0aGUgbGlzdCBoYXMgYmVlbiBmaXJlZCByaWdodCBhd2F5IHdpdGggdGhlIGxhdGVzdCAibWVtb3JpemVkIgoJICoJCQkJCXZhbHVlcyAobGlrZSBhIERlZmVycmVkKQoJICoKCSAqCXVuaXF1ZToJCQl3aWxsIGVuc3VyZSBhIGNhbGxiYWNrIGNhbiBvbmx5IGJlIGFkZGVkIG9uY2UgKG5vIGR1cGxpY2F0ZSBpbiB0aGUgbGlzdCkKCSAqCgkgKglzdG9wT25GYWxzZToJaW50ZXJydXB0IGNhbGxpbmdzIHdoZW4gYSBjYWxsYmFjayByZXR1cm5zIGZhbHNlCgkgKgoJICovCglqUXVlcnkuQ2FsbGJhY2tzID0gZnVuY3Rpb24oIG9wdGlvbnMgKSB7CgoJCS8vIENvbnZlcnQgb3B0aW9ucyBmcm9tIFN0cmluZy1mb3JtYXR0ZWQgdG8gT2JqZWN0LWZvcm1hdHRlZCBpZiBuZWVkZWQKCQkvLyAod2UgY2hlY2sgaW4gY2FjaGUgZmlyc3QpCgkJb3B0aW9ucyA9IHR5cGVvZiBvcHRpb25zID09PSAic3RyaW5nIiA/CgkJCSggb3B0aW9uc0NhY2hlWyBvcHRpb25zIF0gfHwgY3JlYXRlT3B0aW9ucyggb3B0aW9ucyApICkgOgoJCQlqUXVlcnkuZXh0ZW5kKCB7fSwgb3B0aW9ucyApOwoKCQl2YXIgLy8gRmxhZyB0byBrbm93IGlmIGxpc3QgaXMgY3VycmVudGx5IGZpcmluZwoJCQlmaXJpbmcsCgkJCS8vIExhc3QgZmlyZSB2YWx1ZSAoZm9yIG5vbi1mb3JnZXR0YWJsZSBsaXN0cykKCQkJbWVtb3J5LAoJCQkvLyBGbGFnIHRvIGtub3cgaWYgbGlzdCB3YXMgYWxyZWFkeSBmaXJlZAoJCQlmaXJlZCwKCQkJLy8gRW5kIG9mIHRoZSBsb29wIHdoZW4gZmlyaW5nCgkJCWZpcmluZ0xlbmd0aCwKCQkJLy8gSW5kZXggb2YgY3VycmVudGx5IGZpcmluZyBjYWxsYmFjayAobW9kaWZpZWQgYnkgcmVtb3ZlIGlmIG5lZWRlZCkKCQkJZmlyaW5nSW5kZXgsCgkJCS8vIEZpcnN0IGNhbGxiYWNrIHRvIGZpcmUgKHVzZWQgaW50ZXJuYWxseSBieSBhZGQgYW5kIGZpcmVXaXRoKQoJCQlmaXJpbmdTdGFydCwKCQkJLy8gQWN0dWFsIGNhbGxiYWNrIGxpc3QKCQkJbGlzdCA9IFtdLAoJCQkvLyBTdGFjayBvZiBmaXJlIGNhbGxzIGZvciByZXBlYXRhYmxlIGxpc3RzCgkJCXN0YWNrID0gIW9wdGlvbnMub25jZSAmJiBbXSwKCQkJLy8gRmlyZSBjYWxsYmFja3MKCQkJZmlyZSA9IGZ1bmN0aW9uKCBkYXRhICkgewoJCQkJbWVtb3J5ID0gb3B0aW9ucy5tZW1vcnkgJiYgZGF0YTsKCQkJCWZpcmVkID0gdHJ1ZTsKCQkJCWZpcmluZ0luZGV4ID0gZmlyaW5nU3RhcnQgfHwgMDsKCQkJCWZpcmluZ1N0YXJ0ID0gMDsKCQkJCWZpcmluZ0xlbmd0aCA9IGxpc3QubGVuZ3RoOwoJCQkJZmlyaW5nID0gdHJ1ZTsKCQkJCWZvciAoIDsgbGlzdCAmJiBmaXJpbmdJbmRleCA8IGZpcmluZ0xlbmd0aDsgZmlyaW5nSW5kZXgrKyApIHsKCQkJCQlpZiAoIGxpc3RbIGZpcmluZ0luZGV4IF0uYXBwbHkoIGRhdGFbIDAgXSwgZGF0YVsgMSBdICkgPT09IGZhbHNlICYmIG9wdGlvbnMuc3RvcE9uRmFsc2UgKSB7CgkJCQkJCW1lbW9yeSA9IGZhbHNlOyAvLyBUbyBwcmV2ZW50IGZ1cnRoZXIgY2FsbHMgdXNpbmcgYWRkCgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCX0KCQkJCWZpcmluZyA9IGZhbHNlOwoJCQkJaWYgKCBsaXN0ICkgewoJCQkJCWlmICggc3RhY2sgKSB7CgkJCQkJCWlmICggc3RhY2subGVuZ3RoICkgewoJCQkJCQkJZmlyZSggc3RhY2suc2hpZnQoKSApOwoJCQkJCQl9CgkJCQkJfSBlbHNlIGlmICggbWVtb3J5ICkgewoJCQkJCQlsaXN0ID0gW107CgkJCQkJfSBlbHNlIHsKCQkJCQkJc2VsZi5kaXNhYmxlKCk7CgkJCQkJfQoJCQkJfQoJCQl9LAoJCQkvLyBBY3R1YWwgQ2FsbGJhY2tzIG9iamVjdAoJCQlzZWxmID0gewoJCQkJLy8gQWRkIGEgY2FsbGJhY2sgb3IgYSBjb2xsZWN0aW9uIG9mIGNhbGxiYWNrcyB0byB0aGUgbGlzdAoJCQkJYWRkOiBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIGxpc3QgKSB7CgkJCQkJCS8vIEZpcnN0LCB3ZSBzYXZlIHRoZSBjdXJyZW50IGxlbmd0aAoJCQkJCQl2YXIgc3RhcnQgPSBsaXN0Lmxlbmd0aDsKCQkJCQkJKGZ1bmN0aW9uIGFkZCggYXJncyApIHsKCQkJCQkJCWpRdWVyeS5lYWNoKCBhcmdzLCBmdW5jdGlvbiggXywgYXJnICkgewoJCQkJCQkJCXZhciB0eXBlID0galF1ZXJ5LnR5cGUoIGFyZyApOwoJCQkJCQkJCWlmICggdHlwZSA9PT0gImZ1bmN0aW9uIiApIHsKCQkJCQkJCQkJaWYgKCAhb3B0aW9ucy51bmlxdWUgfHwgIXNlbGYuaGFzKCBhcmcgKSApIHsKCQkJCQkJCQkJCWxpc3QucHVzaCggYXJnICk7CgkJCQkJCQkJCX0KCQkJCQkJCQl9IGVsc2UgaWYgKCBhcmcgJiYgYXJnLmxlbmd0aCAmJiB0eXBlICE9PSAic3RyaW5nIiApIHsKCQkJCQkJCQkJLy8gSW5zcGVjdCByZWN1cnNpdmVseQoJCQkJCQkJCQlhZGQoIGFyZyApOwoJCQkJCQkJCX0KCQkJCQkJCX0pOwoJCQkJCQl9KSggYXJndW1lbnRzICk7CgkJCQkJCS8vIERvIHdlIG5lZWQgdG8gYWRkIHRoZSBjYWxsYmFja3MgdG8gdGhlCgkJCQkJCS8vIGN1cnJlbnQgZmlyaW5nIGJhdGNoPwoJCQkJCQlpZiAoIGZpcmluZyApIHsKCQkJCQkJCWZpcmluZ0xlbmd0aCA9IGxpc3QubGVuZ3RoOwoJCQkJCQkvLyBXaXRoIG1lbW9yeSwgaWYgd2UncmUgbm90IGZpcmluZyB0aGVuCgkJCQkJCS8vIHdlIHNob3VsZCBjYWxsIHJpZ2h0IGF3YXkKCQkJCQkJfSBlbHNlIGlmICggbWVtb3J5ICkgewoJCQkJCQkJZmlyaW5nU3RhcnQgPSBzdGFydDsKCQkJCQkJCWZpcmUoIG1lbW9yeSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJCXJldHVybiB0aGlzOwoJCQkJfSwKCQkJCS8vIFJlbW92ZSBhIGNhbGxiYWNrIGZyb20gdGhlIGxpc3QKCQkJCXJlbW92ZTogZnVuY3Rpb24oKSB7CgkJCQkJaWYgKCBsaXN0ICkgewoJCQkJCQlqUXVlcnkuZWFjaCggYXJndW1lbnRzLCBmdW5jdGlvbiggXywgYXJnICkgewoJCQkJCQkJdmFyIGluZGV4OwoJCQkJCQkJd2hpbGUgKCAoIGluZGV4ID0galF1ZXJ5LmluQXJyYXkoIGFyZywgbGlzdCwgaW5kZXggKSApID4gLTEgKSB7CgkJCQkJCQkJbGlzdC5zcGxpY2UoIGluZGV4LCAxICk7CgkJCQkJCQkJLy8gSGFuZGxlIGZpcmluZyBpbmRleGVzCgkJCQkJCQkJaWYgKCBmaXJpbmcgKSB7CgkJCQkJCQkJCWlmICggaW5kZXggPD0gZmlyaW5nTGVuZ3RoICkgewoJCQkJCQkJCQkJZmlyaW5nTGVuZ3RoLS07CgkJCQkJCQkJCX0KCQkJCQkJCQkJaWYgKCBpbmRleCA8PSBmaXJpbmdJbmRleCApIHsKCQkJCQkJCQkJCWZpcmluZ0luZGV4LS07CgkJCQkJCQkJCX0KCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0pOwoJCQkJCX0KCQkJCQlyZXR1cm4gdGhpczsKCQkJCX0sCgkJCQkvLyBDaGVjayBpZiBhIGdpdmVuIGNhbGxiYWNrIGlzIGluIHRoZSBsaXN0LgoJCQkJLy8gSWYgbm8gYXJndW1lbnQgaXMgZ2l2ZW4sIHJldHVybiB3aGV0aGVyIG9yIG5vdCBsaXN0IGhhcyBjYWxsYmFja3MgYXR0YWNoZWQuCgkJCQloYXM6IGZ1bmN0aW9uKCBmbiApIHsKCQkJCQlyZXR1cm4gZm4gPyBqUXVlcnkuaW5BcnJheSggZm4sIGxpc3QgKSA+IC0xIDogISEoIGxpc3QgJiYgbGlzdC5sZW5ndGggKTsKCQkJCX0sCgkJCQkvLyBSZW1vdmUgYWxsIGNhbGxiYWNrcyBmcm9tIHRoZSBsaXN0CgkJCQllbXB0eTogZnVuY3Rpb24oKSB7CgkJCQkJbGlzdCA9IFtdOwoJCQkJCWZpcmluZ0xlbmd0aCA9IDA7CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9LAoJCQkJLy8gSGF2ZSB0aGUgbGlzdCBkbyBub3RoaW5nIGFueW1vcmUKCQkJCWRpc2FibGU6IGZ1bmN0aW9uKCkgewoJCQkJCWxpc3QgPSBzdGFjayA9IG1lbW9yeSA9IHVuZGVmaW5lZDsKCQkJCQlyZXR1cm4gdGhpczsKCQkJCX0sCgkJCQkvLyBJcyBpdCBkaXNhYmxlZD8KCQkJCWRpc2FibGVkOiBmdW5jdGlvbigpIHsKCQkJCQlyZXR1cm4gIWxpc3Q7CgkJCQl9LAoJCQkJLy8gTG9jayB0aGUgbGlzdCBpbiBpdHMgY3VycmVudCBzdGF0ZQoJCQkJbG9jazogZnVuY3Rpb24oKSB7CgkJCQkJc3RhY2sgPSB1bmRlZmluZWQ7CgkJCQkJaWYgKCAhbWVtb3J5ICkgewoJCQkJCQlzZWxmLmRpc2FibGUoKTsKCQkJCQl9CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9LAoJCQkJLy8gSXMgaXQgbG9ja2VkPwoJCQkJbG9ja2VkOiBmdW5jdGlvbigpIHsKCQkJCQlyZXR1cm4gIXN0YWNrOwoJCQkJfSwKCQkJCS8vIENhbGwgYWxsIGNhbGxiYWNrcyB3aXRoIHRoZSBnaXZlbiBjb250ZXh0IGFuZCBhcmd1bWVudHMKCQkJCWZpcmVXaXRoOiBmdW5jdGlvbiggY29udGV4dCwgYXJncyApIHsKCQkJCQlpZiAoIGxpc3QgJiYgKCAhZmlyZWQgfHwgc3RhY2sgKSApIHsKCQkJCQkJYXJncyA9IGFyZ3MgfHwgW107CgkJCQkJCWFyZ3MgPSBbIGNvbnRleHQsIGFyZ3Muc2xpY2UgPyBhcmdzLnNsaWNlKCkgOiBhcmdzIF07CgkJCQkJCWlmICggZmlyaW5nICkgewoJCQkJCQkJc3RhY2sucHVzaCggYXJncyApOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJZmlyZSggYXJncyApOwoJCQkJCQl9CgkJCQkJfQoJCQkJCXJldHVybiB0aGlzOwoJCQkJfSwKCQkJCS8vIENhbGwgYWxsIHRoZSBjYWxsYmFja3Mgd2l0aCB0aGUgZ2l2ZW4gYXJndW1lbnRzCgkJCQlmaXJlOiBmdW5jdGlvbigpIHsKCQkJCQlzZWxmLmZpcmVXaXRoKCB0aGlzLCBhcmd1bWVudHMgKTsKCQkJCQlyZXR1cm4gdGhpczsKCQkJCX0sCgkJCQkvLyBUbyBrbm93IGlmIHRoZSBjYWxsYmFja3MgaGF2ZSBhbHJlYWR5IGJlZW4gY2FsbGVkIGF0IGxlYXN0IG9uY2UKCQkJCWZpcmVkOiBmdW5jdGlvbigpIHsKCQkJCQlyZXR1cm4gISFmaXJlZDsKCQkJCX0KCQkJfTsKCgkJcmV0dXJuIHNlbGY7Cgl9OwoKCglqUXVlcnkuZXh0ZW5kKHsKCgkJRGVmZXJyZWQ6IGZ1bmN0aW9uKCBmdW5jICkgewoJCQl2YXIgdHVwbGVzID0gWwoJCQkJCS8vIGFjdGlvbiwgYWRkIGxpc3RlbmVyLCBsaXN0ZW5lciBsaXN0LCBmaW5hbCBzdGF0ZQoJCQkJCVsgInJlc29sdmUiLCAiZG9uZSIsIGpRdWVyeS5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksICJyZXNvbHZlZCIgXSwKCQkJCQlbICJyZWplY3QiLCAiZmFpbCIsIGpRdWVyeS5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksICJyZWplY3RlZCIgXSwKCQkJCQlbICJub3RpZnkiLCAicHJvZ3Jlc3MiLCBqUXVlcnkuQ2FsbGJhY2tzKCJtZW1vcnkiKSBdCgkJCQldLAoJCQkJc3RhdGUgPSAicGVuZGluZyIsCgkJCQlwcm9taXNlID0gewoJCQkJCXN0YXRlOiBmdW5jdGlvbigpIHsKCQkJCQkJcmV0dXJuIHN0YXRlOwoJCQkJCX0sCgkJCQkJYWx3YXlzOiBmdW5jdGlvbigpIHsKCQkJCQkJZGVmZXJyZWQuZG9uZSggYXJndW1lbnRzICkuZmFpbCggYXJndW1lbnRzICk7CgkJCQkJCXJldHVybiB0aGlzOwoJCQkJCX0sCgkJCQkJdGhlbjogZnVuY3Rpb24oIC8qIGZuRG9uZSwgZm5GYWlsLCBmblByb2dyZXNzICovICkgewoJCQkJCQl2YXIgZm5zID0gYXJndW1lbnRzOwoJCQkJCQlyZXR1cm4galF1ZXJ5LkRlZmVycmVkKGZ1bmN0aW9uKCBuZXdEZWZlciApIHsKCQkJCQkJCWpRdWVyeS5lYWNoKCB0dXBsZXMsIGZ1bmN0aW9uKCBpLCB0dXBsZSApIHsKCQkJCQkJCQl2YXIgZm4gPSBqUXVlcnkuaXNGdW5jdGlvbiggZm5zWyBpIF0gKSAmJiBmbnNbIGkgXTsKCQkJCQkJCQkvLyBkZWZlcnJlZFsgZG9uZSB8IGZhaWwgfCBwcm9ncmVzcyBdIGZvciBmb3J3YXJkaW5nIGFjdGlvbnMgdG8gbmV3RGVmZXIKCQkJCQkJCQlkZWZlcnJlZFsgdHVwbGVbMV0gXShmdW5jdGlvbigpIHsKCQkJCQkJCQkJdmFyIHJldHVybmVkID0gZm4gJiYgZm4uYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOwoJCQkJCQkJCQlpZiAoIHJldHVybmVkICYmIGpRdWVyeS5pc0Z1bmN0aW9uKCByZXR1cm5lZC5wcm9taXNlICkgKSB7CgkJCQkJCQkJCQlyZXR1cm5lZC5wcm9taXNlKCkKCQkJCQkJCQkJCQkuZG9uZSggbmV3RGVmZXIucmVzb2x2ZSApCgkJCQkJCQkJCQkJLmZhaWwoIG5ld0RlZmVyLnJlamVjdCApCgkJCQkJCQkJCQkJLnByb2dyZXNzKCBuZXdEZWZlci5ub3RpZnkgKTsKCQkJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkJCW5ld0RlZmVyWyB0dXBsZVsgMCBdICsgIldpdGgiIF0oIHRoaXMgPT09IHByb21pc2UgPyBuZXdEZWZlci5wcm9taXNlKCkgOiB0aGlzLCBmbiA/IFsgcmV0dXJuZWQgXSA6IGFyZ3VtZW50cyApOwoJCQkJCQkJCQl9CgkJCQkJCQkJfSk7CgkJCQkJCQl9KTsKCQkJCQkJCWZucyA9IG51bGw7CgkJCQkJCX0pLnByb21pc2UoKTsKCQkJCQl9LAoJCQkJCS8vIEdldCBhIHByb21pc2UgZm9yIHRoaXMgZGVmZXJyZWQKCQkJCQkvLyBJZiBvYmogaXMgcHJvdmlkZWQsIHRoZSBwcm9taXNlIGFzcGVjdCBpcyBhZGRlZCB0byB0aGUgb2JqZWN0CgkJCQkJcHJvbWlzZTogZnVuY3Rpb24oIG9iaiApIHsKCQkJCQkJcmV0dXJuIG9iaiAhPSBudWxsID8galF1ZXJ5LmV4dGVuZCggb2JqLCBwcm9taXNlICkgOiBwcm9taXNlOwoJCQkJCX0KCQkJCX0sCgkJCQlkZWZlcnJlZCA9IHt9OwoKCQkJLy8gS2VlcCBwaXBlIGZvciBiYWNrLWNvbXBhdAoJCQlwcm9taXNlLnBpcGUgPSBwcm9taXNlLnRoZW47CgoJCQkvLyBBZGQgbGlzdC1zcGVjaWZpYyBtZXRob2RzCgkJCWpRdWVyeS5lYWNoKCB0dXBsZXMsIGZ1bmN0aW9uKCBpLCB0dXBsZSApIHsKCQkJCXZhciBsaXN0ID0gdHVwbGVbIDIgXSwKCQkJCQlzdGF0ZVN0cmluZyA9IHR1cGxlWyAzIF07CgoJCQkJLy8gcHJvbWlzZVsgZG9uZSB8IGZhaWwgfCBwcm9ncmVzcyBdID0gbGlzdC5hZGQKCQkJCXByb21pc2VbIHR1cGxlWzFdIF0gPSBsaXN0LmFkZDsKCgkJCQkvLyBIYW5kbGUgc3RhdGUKCQkJCWlmICggc3RhdGVTdHJpbmcgKSB7CgkJCQkJbGlzdC5hZGQoZnVuY3Rpb24oKSB7CgkJCQkJCS8vIHN0YXRlID0gWyByZXNvbHZlZCB8IHJlamVjdGVkIF0KCQkJCQkJc3RhdGUgPSBzdGF0ZVN0cmluZzsKCgkJCQkJLy8gWyByZWplY3RfbGlzdCB8IHJlc29sdmVfbGlzdCBdLmRpc2FibGU7IHByb2dyZXNzX2xpc3QubG9jawoJCQkJCX0sIHR1cGxlc1sgaSBeIDEgXVsgMiBdLmRpc2FibGUsIHR1cGxlc1sgMiBdWyAyIF0ubG9jayApOwoJCQkJfQoKCQkJCS8vIGRlZmVycmVkWyByZXNvbHZlIHwgcmVqZWN0IHwgbm90aWZ5IF0KCQkJCWRlZmVycmVkWyB0dXBsZVswXSBdID0gZnVuY3Rpb24oKSB7CgkJCQkJZGVmZXJyZWRbIHR1cGxlWzBdICsgIldpdGgiIF0oIHRoaXMgPT09IGRlZmVycmVkID8gcHJvbWlzZSA6IHRoaXMsIGFyZ3VtZW50cyApOwoJCQkJCXJldHVybiB0aGlzOwoJCQkJfTsKCQkJCWRlZmVycmVkWyB0dXBsZVswXSArICJXaXRoIiBdID0gbGlzdC5maXJlV2l0aDsKCQkJfSk7CgoJCQkvLyBNYWtlIHRoZSBkZWZlcnJlZCBhIHByb21pc2UKCQkJcHJvbWlzZS5wcm9taXNlKCBkZWZlcnJlZCApOwoKCQkJLy8gQ2FsbCBnaXZlbiBmdW5jIGlmIGFueQoJCQlpZiAoIGZ1bmMgKSB7CgkJCQlmdW5jLmNhbGwoIGRlZmVycmVkLCBkZWZlcnJlZCApOwoJCQl9CgoJCQkvLyBBbGwgZG9uZSEKCQkJcmV0dXJuIGRlZmVycmVkOwoJCX0sCgoJCS8vIERlZmVycmVkIGhlbHBlcgoJCXdoZW46IGZ1bmN0aW9uKCBzdWJvcmRpbmF0ZSAvKiAsIC4uLiwgc3Vib3JkaW5hdGVOICovICkgewoJCQl2YXIgaSA9IDAsCgkJCQlyZXNvbHZlVmFsdWVzID0gc2xpY2UuY2FsbCggYXJndW1lbnRzICksCgkJCQlsZW5ndGggPSByZXNvbHZlVmFsdWVzLmxlbmd0aCwKCgkJCQkvLyB0aGUgY291bnQgb2YgdW5jb21wbGV0ZWQgc3Vib3JkaW5hdGVzCgkJCQlyZW1haW5pbmcgPSBsZW5ndGggIT09IDEgfHwgKCBzdWJvcmRpbmF0ZSAmJiBqUXVlcnkuaXNGdW5jdGlvbiggc3Vib3JkaW5hdGUucHJvbWlzZSApICkgPyBsZW5ndGggOiAwLAoKCQkJCS8vIHRoZSBtYXN0ZXIgRGVmZXJyZWQuIElmIHJlc29sdmVWYWx1ZXMgY29uc2lzdCBvZiBvbmx5IGEgc2luZ2xlIERlZmVycmVkLCBqdXN0IHVzZSB0aGF0LgoJCQkJZGVmZXJyZWQgPSByZW1haW5pbmcgPT09IDEgPyBzdWJvcmRpbmF0ZSA6IGpRdWVyeS5EZWZlcnJlZCgpLAoKCQkJCS8vIFVwZGF0ZSBmdW5jdGlvbiBmb3IgYm90aCByZXNvbHZlIGFuZCBwcm9ncmVzcyB2YWx1ZXMKCQkJCXVwZGF0ZUZ1bmMgPSBmdW5jdGlvbiggaSwgY29udGV4dHMsIHZhbHVlcyApIHsKCQkJCQlyZXR1cm4gZnVuY3Rpb24oIHZhbHVlICkgewoJCQkJCQljb250ZXh0c1sgaSBdID0gdGhpczsKCQkJCQkJdmFsdWVzWyBpIF0gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IHNsaWNlLmNhbGwoIGFyZ3VtZW50cyApIDogdmFsdWU7CgkJCQkJCWlmICggdmFsdWVzID09PSBwcm9ncmVzc1ZhbHVlcyApIHsKCQkJCQkJCWRlZmVycmVkLm5vdGlmeVdpdGgoIGNvbnRleHRzLCB2YWx1ZXMgKTsKCgkJCQkJCX0gZWxzZSBpZiAoICEoLS1yZW1haW5pbmcpICkgewoJCQkJCQkJZGVmZXJyZWQucmVzb2x2ZVdpdGgoIGNvbnRleHRzLCB2YWx1ZXMgKTsKCQkJCQkJfQoJCQkJCX07CgkJCQl9LAoKCQkJCXByb2dyZXNzVmFsdWVzLCBwcm9ncmVzc0NvbnRleHRzLCByZXNvbHZlQ29udGV4dHM7CgoJCQkvLyBhZGQgbGlzdGVuZXJzIHRvIERlZmVycmVkIHN1Ym9yZGluYXRlczsgdHJlYXQgb3RoZXJzIGFzIHJlc29sdmVkCgkJCWlmICggbGVuZ3RoID4gMSApIHsKCQkJCXByb2dyZXNzVmFsdWVzID0gbmV3IEFycmF5KCBsZW5ndGggKTsKCQkJCXByb2dyZXNzQ29udGV4dHMgPSBuZXcgQXJyYXkoIGxlbmd0aCApOwoJCQkJcmVzb2x2ZUNvbnRleHRzID0gbmV3IEFycmF5KCBsZW5ndGggKTsKCQkJCWZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkgewoJCQkJCWlmICggcmVzb2x2ZVZhbHVlc1sgaSBdICYmIGpRdWVyeS5pc0Z1bmN0aW9uKCByZXNvbHZlVmFsdWVzWyBpIF0ucHJvbWlzZSApICkgewoJCQkJCQlyZXNvbHZlVmFsdWVzWyBpIF0ucHJvbWlzZSgpCgkJCQkJCQkuZG9uZSggdXBkYXRlRnVuYyggaSwgcmVzb2x2ZUNvbnRleHRzLCByZXNvbHZlVmFsdWVzICkgKQoJCQkJCQkJLmZhaWwoIGRlZmVycmVkLnJlamVjdCApCgkJCQkJCQkucHJvZ3Jlc3MoIHVwZGF0ZUZ1bmMoIGksIHByb2dyZXNzQ29udGV4dHMsIHByb2dyZXNzVmFsdWVzICkgKTsKCQkJCQl9IGVsc2UgewoJCQkJCQktLXJlbWFpbmluZzsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCS8vIGlmIHdlJ3JlIG5vdCB3YWl0aW5nIG9uIGFueXRoaW5nLCByZXNvbHZlIHRoZSBtYXN0ZXIKCQkJaWYgKCAhcmVtYWluaW5nICkgewoJCQkJZGVmZXJyZWQucmVzb2x2ZVdpdGgoIHJlc29sdmVDb250ZXh0cywgcmVzb2x2ZVZhbHVlcyApOwoJCQl9CgoJCQlyZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpOwoJCX0KCX0pOwoKCgkvLyBUaGUgZGVmZXJyZWQgdXNlZCBvbiBET00gcmVhZHkKCXZhciByZWFkeUxpc3Q7CgoJalF1ZXJ5LmZuLnJlYWR5ID0gZnVuY3Rpb24oIGZuICkgewoJCS8vIEFkZCB0aGUgY2FsbGJhY2sKCQlqUXVlcnkucmVhZHkucHJvbWlzZSgpLmRvbmUoIGZuICk7CgoJCXJldHVybiB0aGlzOwoJfTsKCglqUXVlcnkuZXh0ZW5kKHsKCQkvLyBJcyB0aGUgRE9NIHJlYWR5IHRvIGJlIHVzZWQ/IFNldCB0byB0cnVlIG9uY2UgaXQgb2NjdXJzLgoJCWlzUmVhZHk6IGZhbHNlLAoKCQkvLyBBIGNvdW50ZXIgdG8gdHJhY2sgaG93IG1hbnkgaXRlbXMgdG8gd2FpdCBmb3IgYmVmb3JlCgkJLy8gdGhlIHJlYWR5IGV2ZW50IGZpcmVzLiBTZWUgIzY3ODEKCQlyZWFkeVdhaXQ6IDEsCgoJCS8vIEhvbGQgKG9yIHJlbGVhc2UpIHRoZSByZWFkeSBldmVudAoJCWhvbGRSZWFkeTogZnVuY3Rpb24oIGhvbGQgKSB7CgkJCWlmICggaG9sZCApIHsKCQkJCWpRdWVyeS5yZWFkeVdhaXQrKzsKCQkJfSBlbHNlIHsKCQkJCWpRdWVyeS5yZWFkeSggdHJ1ZSApOwoJCQl9CgkJfSwKCgkJLy8gSGFuZGxlIHdoZW4gdGhlIERPTSBpcyByZWFkeQoJCXJlYWR5OiBmdW5jdGlvbiggd2FpdCApIHsKCgkJCS8vIEFib3J0IGlmIHRoZXJlIGFyZSBwZW5kaW5nIGhvbGRzIG9yIHdlJ3JlIGFscmVhZHkgcmVhZHkKCQkJaWYgKCB3YWl0ID09PSB0cnVlID8gLS1qUXVlcnkucmVhZHlXYWl0IDogalF1ZXJ5LmlzUmVhZHkgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIE1ha2Ugc3VyZSBib2R5IGV4aXN0cywgYXQgbGVhc3QsIGluIGNhc2UgSUUgZ2V0cyBhIGxpdHRsZSBvdmVyemVhbG91cyAodGlja2V0ICM1NDQzKS4KCQkJaWYgKCAhZG9jdW1lbnQuYm9keSApIHsKCQkJCXJldHVybiBzZXRUaW1lb3V0KCBqUXVlcnkucmVhZHkgKTsKCQkJfQoKCQkJLy8gUmVtZW1iZXIgdGhhdCB0aGUgRE9NIGlzIHJlYWR5CgkJCWpRdWVyeS5pc1JlYWR5ID0gdHJ1ZTsKCgkJCS8vIElmIGEgbm9ybWFsIERPTSBSZWFkeSBldmVudCBmaXJlZCwgZGVjcmVtZW50LCBhbmQgd2FpdCBpZiBuZWVkIGJlCgkJCWlmICggd2FpdCAhPT0gdHJ1ZSAmJiAtLWpRdWVyeS5yZWFkeVdhaXQgPiAwICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBJZiB0aGVyZSBhcmUgZnVuY3Rpb25zIGJvdW5kLCB0byBleGVjdXRlCgkJCXJlYWR5TGlzdC5yZXNvbHZlV2l0aCggZG9jdW1lbnQsIFsgalF1ZXJ5IF0gKTsKCgkJCS8vIFRyaWdnZXIgYW55IGJvdW5kIHJlYWR5IGV2ZW50cwoJCQlpZiAoIGpRdWVyeS5mbi50cmlnZ2VySGFuZGxlciApIHsKCQkJCWpRdWVyeSggZG9jdW1lbnQgKS50cmlnZ2VySGFuZGxlciggInJlYWR5IiApOwoJCQkJalF1ZXJ5KCBkb2N1bWVudCApLm9mZiggInJlYWR5IiApOwoJCQl9CgkJfQoJfSk7CgoJLyoqCgkgKiBDbGVhbi11cCBtZXRob2QgZm9yIGRvbSByZWFkeSBldmVudHMKCSAqLwoJZnVuY3Rpb24gZGV0YWNoKCkgewoJCWlmICggZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciApIHsKCQkJZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggIkRPTUNvbnRlbnRMb2FkZWQiLCBjb21wbGV0ZWQsIGZhbHNlICk7CgkJCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCAibG9hZCIsIGNvbXBsZXRlZCwgZmFsc2UgKTsKCgkJfSBlbHNlIHsKCQkJZG9jdW1lbnQuZGV0YWNoRXZlbnQoICJvbnJlYWR5c3RhdGVjaGFuZ2UiLCBjb21wbGV0ZWQgKTsKCQkJd2luZG93LmRldGFjaEV2ZW50KCAib25sb2FkIiwgY29tcGxldGVkICk7CgkJfQoJfQoKCS8qKgoJICogVGhlIHJlYWR5IGV2ZW50IGhhbmRsZXIgYW5kIHNlbGYgY2xlYW51cCBtZXRob2QKCSAqLwoJZnVuY3Rpb24gY29tcGxldGVkKCkgewoJCS8vIHJlYWR5U3RhdGUgPT09ICJjb21wbGV0ZSIgaXMgZ29vZCBlbm91Z2ggZm9yIHVzIHRvIGNhbGwgdGhlIGRvbSByZWFkeSBpbiBvbGRJRQoJCWlmICggZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciB8fCBldmVudC50eXBlID09PSAibG9hZCIgfHwgZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gImNvbXBsZXRlIiApIHsKCQkJZGV0YWNoKCk7CgkJCWpRdWVyeS5yZWFkeSgpOwoJCX0KCX0KCglqUXVlcnkucmVhZHkucHJvbWlzZSA9IGZ1bmN0aW9uKCBvYmogKSB7CgkJaWYgKCAhcmVhZHlMaXN0ICkgewoKCQkJcmVhZHlMaXN0ID0galF1ZXJ5LkRlZmVycmVkKCk7CgoJCQkvLyBDYXRjaCBjYXNlcyB3aGVyZSAkKGRvY3VtZW50KS5yZWFkeSgpIGlzIGNhbGxlZCBhZnRlciB0aGUgYnJvd3NlciBldmVudCBoYXMgYWxyZWFkeSBvY2N1cnJlZC4KCQkJLy8gd2Ugb25jZSB0cmllZCB0byB1c2UgcmVhZHlTdGF0ZSAiaW50ZXJhY3RpdmUiIGhlcmUsIGJ1dCBpdCBjYXVzZWQgaXNzdWVzIGxpa2UgdGhlIG9uZQoJCQkvLyBkaXNjb3ZlcmVkIGJ5IENocmlzUyBoZXJlOiBodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC8xMjI4MiNjb21tZW50OjE1CgkJCWlmICggZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gImNvbXBsZXRlIiApIHsKCQkJCS8vIEhhbmRsZSBpdCBhc3luY2hyb25vdXNseSB0byBhbGxvdyBzY3JpcHRzIHRoZSBvcHBvcnR1bml0eSB0byBkZWxheSByZWFkeQoJCQkJc2V0VGltZW91dCggalF1ZXJ5LnJlYWR5ICk7CgoJCQkvLyBTdGFuZGFyZHMtYmFzZWQgYnJvd3NlcnMgc3VwcG9ydCBET01Db250ZW50TG9hZGVkCgkJCX0gZWxzZSBpZiAoIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIgKSB7CgkJCQkvLyBVc2UgdGhlIGhhbmR5IGV2ZW50IGNhbGxiYWNrCgkJCQlkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCAiRE9NQ29udGVudExvYWRlZCIsIGNvbXBsZXRlZCwgZmFsc2UgKTsKCgkJCQkvLyBBIGZhbGxiYWNrIHRvIHdpbmRvdy5vbmxvYWQsIHRoYXQgd2lsbCBhbHdheXMgd29yawoJCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICJsb2FkIiwgY29tcGxldGVkLCBmYWxzZSApOwoKCQkJLy8gSWYgSUUgZXZlbnQgbW9kZWwgaXMgdXNlZAoJCQl9IGVsc2UgewoJCQkJLy8gRW5zdXJlIGZpcmluZyBiZWZvcmUgb25sb2FkLCBtYXliZSBsYXRlIGJ1dCBzYWZlIGFsc28gZm9yIGlmcmFtZXMKCQkJCWRvY3VtZW50LmF0dGFjaEV2ZW50KCAib25yZWFkeXN0YXRlY2hhbmdlIiwgY29tcGxldGVkICk7CgoJCQkJLy8gQSBmYWxsYmFjayB0byB3aW5kb3cub25sb2FkLCB0aGF0IHdpbGwgYWx3YXlzIHdvcmsKCQkJCXdpbmRvdy5hdHRhY2hFdmVudCggIm9ubG9hZCIsIGNvbXBsZXRlZCApOwoKCQkJCS8vIElmIElFIGFuZCBub3QgYSBmcmFtZQoJCQkJLy8gY29udGludWFsbHkgY2hlY2sgdG8gc2VlIGlmIHRoZSBkb2N1bWVudCBpcyByZWFkeQoJCQkJdmFyIHRvcCA9IGZhbHNlOwoKCQkJCXRyeSB7CgkJCQkJdG9wID0gd2luZG93LmZyYW1lRWxlbWVudCA9PSBudWxsICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCQkJCX0gY2F0Y2goZSkge30KCgkJCQlpZiAoIHRvcCAmJiB0b3AuZG9TY3JvbGwgKSB7CgkJCQkJKGZ1bmN0aW9uIGRvU2Nyb2xsQ2hlY2soKSB7CgkJCQkJCWlmICggIWpRdWVyeS5pc1JlYWR5ICkgewoKCQkJCQkJCXRyeSB7CgkJCQkJCQkJLy8gVXNlIHRoZSB0cmljayBieSBEaWVnbyBQZXJpbmkKCQkJCQkJCQkvLyBodHRwOi8vamF2YXNjcmlwdC5ud2JveC5jb20vSUVDb250ZW50TG9hZGVkLwoJCQkJCQkJCXRvcC5kb1Njcm9sbCgibGVmdCIpOwoJCQkJCQkJfSBjYXRjaChlKSB7CgkJCQkJCQkJcmV0dXJuIHNldFRpbWVvdXQoIGRvU2Nyb2xsQ2hlY2ssIDUwICk7CgkJCQkJCQl9CgoJCQkJCQkJLy8gZGV0YWNoIGFsbCBkb20gcmVhZHkgZXZlbnRzCgkJCQkJCQlkZXRhY2goKTsKCgkJCQkJCQkvLyBhbmQgZXhlY3V0ZSBhbnkgd2FpdGluZyBmdW5jdGlvbnMKCQkJCQkJCWpRdWVyeS5yZWFkeSgpOwoJCQkJCQl9CgkJCQkJfSkoKTsKCQkJCX0KCQkJfQoJCX0KCQlyZXR1cm4gcmVhZHlMaXN0LnByb21pc2UoIG9iaiApOwoJfTsKCgoJdmFyIHN0cnVuZGVmaW5lZCA9IHR5cGVvZiB1bmRlZmluZWQ7CgoKCgkvLyBTdXBwb3J0OiBJRTw5CgkvLyBJdGVyYXRpb24gb3ZlciBvYmplY3QncyBpbmhlcml0ZWQgcHJvcGVydGllcyBiZWZvcmUgaXRzIG93bgoJdmFyIGk7Cglmb3IgKCBpIGluIGpRdWVyeSggc3VwcG9ydCApICkgewoJCWJyZWFrOwoJfQoJc3VwcG9ydC5vd25MYXN0ID0gaSAhPT0gIjAiOwoKCS8vIE5vdGU6IG1vc3Qgc3VwcG9ydCB0ZXN0cyBhcmUgZGVmaW5lZCBpbiB0aGVpciByZXNwZWN0aXZlIG1vZHVsZXMuCgkvLyBmYWxzZSB1bnRpbCB0aGUgdGVzdCBpcyBydW4KCXN1cHBvcnQuaW5saW5lQmxvY2tOZWVkc0xheW91dCA9IGZhbHNlOwoKCS8vIEV4ZWN1dGUgQVNBUCBpbiBjYXNlIHdlIG5lZWQgdG8gc2V0IGJvZHkuc3R5bGUuem9vbQoJalF1ZXJ5KGZ1bmN0aW9uKCkgewoJCS8vIE1pbmlmaWVkOiB2YXIgYSxiLGMsZAoJCXZhciB2YWwsIGRpdiwgYm9keSwgY29udGFpbmVyOwoKCQlib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJib2R5IiApWyAwIF07CgkJaWYgKCAhYm9keSB8fCAhYm9keS5zdHlsZSApIHsKCQkJLy8gUmV0dXJuIGZvciBmcmFtZXNldCBkb2NzIHRoYXQgZG9uJ3QgaGF2ZSBhIGJvZHkKCQkJcmV0dXJuOwoJCX0KCgkJLy8gU2V0dXAKCQlkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApOwoJCWNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICk7CgkJY29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAicG9zaXRpb246YWJzb2x1dGU7Ym9yZGVyOjA7d2lkdGg6MDtoZWlnaHQ6MDt0b3A6MDtsZWZ0Oi05OTk5cHgiOwoJCWJvZHkuYXBwZW5kQ2hpbGQoIGNvbnRhaW5lciApLmFwcGVuZENoaWxkKCBkaXYgKTsKCgkJaWYgKCB0eXBlb2YgZGl2LnN0eWxlLnpvb20gIT09IHN0cnVuZGVmaW5lZCApIHsKCQkJLy8gU3VwcG9ydDogSUU8OAoJCQkvLyBDaGVjayBpZiBuYXRpdmVseSBibG9jay1sZXZlbCBlbGVtZW50cyBhY3QgbGlrZSBpbmxpbmUtYmxvY2sKCQkJLy8gZWxlbWVudHMgd2hlbiBzZXR0aW5nIHRoZWlyIGRpc3BsYXkgdG8gJ2lubGluZScgYW5kIGdpdmluZwoJCQkvLyB0aGVtIGxheW91dAoJCQlkaXYuc3R5bGUuY3NzVGV4dCA9ICJkaXNwbGF5OmlubGluZTttYXJnaW46MDtib3JkZXI6MDtwYWRkaW5nOjFweDt3aWR0aDoxcHg7em9vbToxIjsKCgkJCXN1cHBvcnQuaW5saW5lQmxvY2tOZWVkc0xheW91dCA9IHZhbCA9IGRpdi5vZmZzZXRXaWR0aCA9PT0gMzsKCQkJaWYgKCB2YWwgKSB7CgkJCQkvLyBQcmV2ZW50IElFIDYgZnJvbSBhZmZlY3RpbmcgbGF5b3V0IGZvciBwb3NpdGlvbmVkIGVsZW1lbnRzICMxMTA0OAoJCQkJLy8gUHJldmVudCBJRSBmcm9tIHNocmlua2luZyB0aGUgYm9keSBpbiBJRSA3IG1vZGUgIzEyODY5CgkJCQkvLyBTdXBwb3J0OiBJRTw4CgkJCQlib2R5LnN0eWxlLnpvb20gPSAxOwoJCQl9CgkJfQoKCQlib2R5LnJlbW92ZUNoaWxkKCBjb250YWluZXIgKTsKCX0pOwoKCgoKCShmdW5jdGlvbigpIHsKCQl2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCgkJLy8gRXhlY3V0ZSB0aGUgdGVzdCBvbmx5IGlmIG5vdCBhbHJlYWR5IGV4ZWN1dGVkIGluIGFub3RoZXIgbW9kdWxlLgoJCWlmIChzdXBwb3J0LmRlbGV0ZUV4cGFuZG8gPT0gbnVsbCkgewoJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCXN1cHBvcnQuZGVsZXRlRXhwYW5kbyA9IHRydWU7CgkJCXRyeSB7CgkJCQlkZWxldGUgZGl2LnRlc3Q7CgkJCX0gY2F0Y2goIGUgKSB7CgkJCQlzdXBwb3J0LmRlbGV0ZUV4cGFuZG8gPSBmYWxzZTsKCQkJfQoJCX0KCgkJLy8gTnVsbCBlbGVtZW50cyB0byBhdm9pZCBsZWFrcyBpbiBJRS4KCQlkaXYgPSBudWxsOwoJfSkoKTsKCgoJLyoqCgkgKiBEZXRlcm1pbmVzIHdoZXRoZXIgYW4gb2JqZWN0IGNhbiBoYXZlIGRhdGEKCSAqLwoJalF1ZXJ5LmFjY2VwdERhdGEgPSBmdW5jdGlvbiggZWxlbSApIHsKCQl2YXIgbm9EYXRhID0galF1ZXJ5Lm5vRGF0YVsgKGVsZW0ubm9kZU5hbWUgKyAiICIpLnRvTG93ZXJDYXNlKCkgXSwKCQkJbm9kZVR5cGUgPSArZWxlbS5ub2RlVHlwZSB8fCAxOwoKCQkvLyBEbyBub3Qgc2V0IGRhdGEgb24gbm9uLWVsZW1lbnQgRE9NIG5vZGVzIGJlY2F1c2UgaXQgd2lsbCBub3QgYmUgY2xlYXJlZCAoIzgzMzUpLgoJCXJldHVybiBub2RlVHlwZSAhPT0gMSAmJiBub2RlVHlwZSAhPT0gOSA/CgkJCWZhbHNlIDoKCgkJCS8vIE5vZGVzIGFjY2VwdCBkYXRhIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkOyByZWplY3Rpb24gY2FuIGJlIGNvbmRpdGlvbmFsCgkJCSFub0RhdGEgfHwgbm9EYXRhICE9PSB0cnVlICYmIGVsZW0uZ2V0QXR0cmlidXRlKCJjbGFzc2lkIikgPT09IG5vRGF0YTsKCX07CgoKCXZhciByYnJhY2UgPSAvXig/Olx7W1x3XFddKlx9fFxbW1x3XFddKlxdKSQvLAoJCXJtdWx0aURhc2ggPSAvKFtBLVpdKS9nOwoKCWZ1bmN0aW9uIGRhdGFBdHRyKCBlbGVtLCBrZXksIGRhdGEgKSB7CgkJLy8gSWYgbm90aGluZyB3YXMgZm91bmQgaW50ZXJuYWxseSwgdHJ5IHRvIGZldGNoIGFueQoJCS8vIGRhdGEgZnJvbSB0aGUgSFRNTDUgZGF0YS0qIGF0dHJpYnV0ZQoJCWlmICggZGF0YSA9PT0gdW5kZWZpbmVkICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgoJCQl2YXIgbmFtZSA9ICJkYXRhLSIgKyBrZXkucmVwbGFjZSggcm11bHRpRGFzaCwgIi0kMSIgKS50b0xvd2VyQ2FzZSgpOwoKCQkJZGF0YSA9IGVsZW0uZ2V0QXR0cmlidXRlKCBuYW1lICk7CgoJCQlpZiAoIHR5cGVvZiBkYXRhID09PSAic3RyaW5nIiApIHsKCQkJCXRyeSB7CgkJCQkJZGF0YSA9IGRhdGEgPT09ICJ0cnVlIiA/IHRydWUgOgoJCQkJCQlkYXRhID09PSAiZmFsc2UiID8gZmFsc2UgOgoJCQkJCQlkYXRhID09PSAibnVsbCIgPyBudWxsIDoKCQkJCQkJLy8gT25seSBjb252ZXJ0IHRvIGEgbnVtYmVyIGlmIGl0IGRvZXNuJ3QgY2hhbmdlIHRoZSBzdHJpbmcKCQkJCQkJK2RhdGEgKyAiIiA9PT0gZGF0YSA/ICtkYXRhIDoKCQkJCQkJcmJyYWNlLnRlc3QoIGRhdGEgKSA/IGpRdWVyeS5wYXJzZUpTT04oIGRhdGEgKSA6CgkJCQkJCWRhdGE7CgkJCQl9IGNhdGNoKCBlICkge30KCgkJCQkvLyBNYWtlIHN1cmUgd2Ugc2V0IHRoZSBkYXRhIHNvIGl0IGlzbid0IGNoYW5nZWQgbGF0ZXIKCQkJCWpRdWVyeS5kYXRhKCBlbGVtLCBrZXksIGRhdGEgKTsKCgkJCX0gZWxzZSB7CgkJCQlkYXRhID0gdW5kZWZpbmVkOwoJCQl9CgkJfQoKCQlyZXR1cm4gZGF0YTsKCX0KCgkvLyBjaGVja3MgYSBjYWNoZSBvYmplY3QgZm9yIGVtcHRpbmVzcwoJZnVuY3Rpb24gaXNFbXB0eURhdGFPYmplY3QoIG9iaiApIHsKCQl2YXIgbmFtZTsKCQlmb3IgKCBuYW1lIGluIG9iaiApIHsKCgkJCS8vIGlmIHRoZSBwdWJsaWMgZGF0YSBvYmplY3QgaXMgZW1wdHksIHRoZSBwcml2YXRlIGlzIHN0aWxsIGVtcHR5CgkJCWlmICggbmFtZSA9PT0gImRhdGEiICYmIGpRdWVyeS5pc0VtcHR5T2JqZWN0KCBvYmpbbmFtZV0gKSApIHsKCQkJCWNvbnRpbnVlOwoJCQl9CgkJCWlmICggbmFtZSAhPT0gInRvSlNPTiIgKSB7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQl9CgoJCXJldHVybiB0cnVlOwoJfQoKCWZ1bmN0aW9uIGludGVybmFsRGF0YSggZWxlbSwgbmFtZSwgZGF0YSwgcHZ0IC8qIEludGVybmFsIFVzZSBPbmx5ICovICkgewoJCWlmICggIWpRdWVyeS5hY2NlcHREYXRhKCBlbGVtICkgKSB7CgkJCXJldHVybjsKCQl9CgoJCXZhciByZXQsIHRoaXNDYWNoZSwKCQkJaW50ZXJuYWxLZXkgPSBqUXVlcnkuZXhwYW5kbywKCgkJCS8vIFdlIGhhdmUgdG8gaGFuZGxlIERPTSBub2RlcyBhbmQgSlMgb2JqZWN0cyBkaWZmZXJlbnRseSBiZWNhdXNlIElFNi03CgkJCS8vIGNhbid0IEdDIG9iamVjdCByZWZlcmVuY2VzIHByb3Blcmx5IGFjcm9zcyB0aGUgRE9NLUpTIGJvdW5kYXJ5CgkJCWlzTm9kZSA9IGVsZW0ubm9kZVR5cGUsCgoJCQkvLyBPbmx5IERPTSBub2RlcyBuZWVkIHRoZSBnbG9iYWwgalF1ZXJ5IGNhY2hlOyBKUyBvYmplY3QgZGF0YSBpcwoJCQkvLyBhdHRhY2hlZCBkaXJlY3RseSB0byB0aGUgb2JqZWN0IHNvIEdDIGNhbiBvY2N1ciBhdXRvbWF0aWNhbGx5CgkJCWNhY2hlID0gaXNOb2RlID8galF1ZXJ5LmNhY2hlIDogZWxlbSwKCgkJCS8vIE9ubHkgZGVmaW5pbmcgYW4gSUQgZm9yIEpTIG9iamVjdHMgaWYgaXRzIGNhY2hlIGFscmVhZHkgZXhpc3RzIGFsbG93cwoJCQkvLyB0aGUgY29kZSB0byBzaG9ydGN1dCBvbiB0aGUgc2FtZSBwYXRoIGFzIGEgRE9NIG5vZGUgd2l0aCBubyBjYWNoZQoJCQlpZCA9IGlzTm9kZSA/IGVsZW1bIGludGVybmFsS2V5IF0gOiBlbGVtWyBpbnRlcm5hbEtleSBdICYmIGludGVybmFsS2V5OwoKCQkvLyBBdm9pZCBkb2luZyBhbnkgbW9yZSB3b3JrIHRoYW4gd2UgbmVlZCB0byB3aGVuIHRyeWluZyB0byBnZXQgZGF0YSBvbiBhbgoJCS8vIG9iamVjdCB0aGF0IGhhcyBubyBkYXRhIGF0IGFsbAoJCWlmICggKCFpZCB8fCAhY2FjaGVbaWRdIHx8ICghcHZ0ICYmICFjYWNoZVtpZF0uZGF0YSkpICYmIGRhdGEgPT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgbmFtZSA9PT0gInN0cmluZyIgKSB7CgkJCXJldHVybjsKCQl9CgoJCWlmICggIWlkICkgewoJCQkvLyBPbmx5IERPTSBub2RlcyBuZWVkIGEgbmV3IHVuaXF1ZSBJRCBmb3IgZWFjaCBlbGVtZW50IHNpbmNlIHRoZWlyIGRhdGEKCQkJLy8gZW5kcyB1cCBpbiB0aGUgZ2xvYmFsIGNhY2hlCgkJCWlmICggaXNOb2RlICkgewoJCQkJaWQgPSBlbGVtWyBpbnRlcm5hbEtleSBdID0gZGVsZXRlZElkcy5wb3AoKSB8fCBqUXVlcnkuZ3VpZCsrOwoJCQl9IGVsc2UgewoJCQkJaWQgPSBpbnRlcm5hbEtleTsKCQkJfQoJCX0KCgkJaWYgKCAhY2FjaGVbIGlkIF0gKSB7CgkJCS8vIEF2b2lkIGV4cG9zaW5nIGpRdWVyeSBtZXRhZGF0YSBvbiBwbGFpbiBKUyBvYmplY3RzIHdoZW4gdGhlIG9iamVjdAoJCQkvLyBpcyBzZXJpYWxpemVkIHVzaW5nIEpTT04uc3RyaW5naWZ5CgkJCWNhY2hlWyBpZCBdID0gaXNOb2RlID8ge30gOiB7IHRvSlNPTjogalF1ZXJ5Lm5vb3AgfTsKCQl9CgoJCS8vIEFuIG9iamVjdCBjYW4gYmUgcGFzc2VkIHRvIGpRdWVyeS5kYXRhIGluc3RlYWQgb2YgYSBrZXkvdmFsdWUgcGFpcjsgdGhpcyBnZXRzCgkJLy8gc2hhbGxvdyBjb3BpZWQgb3ZlciBvbnRvIHRoZSBleGlzdGluZyBjYWNoZQoJCWlmICggdHlwZW9mIG5hbWUgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBuYW1lID09PSAiZnVuY3Rpb24iICkgewoJCQlpZiAoIHB2dCApIHsKCQkJCWNhY2hlWyBpZCBdID0galF1ZXJ5LmV4dGVuZCggY2FjaGVbIGlkIF0sIG5hbWUgKTsKCQkJfSBlbHNlIHsKCQkJCWNhY2hlWyBpZCBdLmRhdGEgPSBqUXVlcnkuZXh0ZW5kKCBjYWNoZVsgaWQgXS5kYXRhLCBuYW1lICk7CgkJCX0KCQl9CgoJCXRoaXNDYWNoZSA9IGNhY2hlWyBpZCBdOwoKCQkvLyBqUXVlcnkgZGF0YSgpIGlzIHN0b3JlZCBpbiBhIHNlcGFyYXRlIG9iamVjdCBpbnNpZGUgdGhlIG9iamVjdCdzIGludGVybmFsIGRhdGEKCQkvLyBjYWNoZSBpbiBvcmRlciB0byBhdm9pZCBrZXkgY29sbGlzaW9ucyBiZXR3ZWVuIGludGVybmFsIGRhdGEgYW5kIHVzZXItZGVmaW5lZAoJCS8vIGRhdGEuCgkJaWYgKCAhcHZ0ICkgewoJCQlpZiAoICF0aGlzQ2FjaGUuZGF0YSApIHsKCQkJCXRoaXNDYWNoZS5kYXRhID0ge307CgkJCX0KCgkJCXRoaXNDYWNoZSA9IHRoaXNDYWNoZS5kYXRhOwoJCX0KCgkJaWYgKCBkYXRhICE9PSB1bmRlZmluZWQgKSB7CgkJCXRoaXNDYWNoZVsgalF1ZXJ5LmNhbWVsQ2FzZSggbmFtZSApIF0gPSBkYXRhOwoJCX0KCgkJLy8gQ2hlY2sgZm9yIGJvdGggY29udmVydGVkLXRvLWNhbWVsIGFuZCBub24tY29udmVydGVkIGRhdGEgcHJvcGVydHkgbmFtZXMKCQkvLyBJZiBhIGRhdGEgcHJvcGVydHkgd2FzIHNwZWNpZmllZAoJCWlmICggdHlwZW9mIG5hbWUgPT09ICJzdHJpbmciICkgewoKCQkJLy8gRmlyc3QgVHJ5IHRvIGZpbmQgYXMtaXMgcHJvcGVydHkgZGF0YQoJCQlyZXQgPSB0aGlzQ2FjaGVbIG5hbWUgXTsKCgkJCS8vIFRlc3QgZm9yIG51bGx8dW5kZWZpbmVkIHByb3BlcnR5IGRhdGEKCQkJaWYgKCByZXQgPT0gbnVsbCApIHsKCgkJCQkvLyBUcnkgdG8gZmluZCB0aGUgY2FtZWxDYXNlZCBwcm9wZXJ0eQoJCQkJcmV0ID0gdGhpc0NhY2hlWyBqUXVlcnkuY2FtZWxDYXNlKCBuYW1lICkgXTsKCQkJfQoJCX0gZWxzZSB7CgkJCXJldCA9IHRoaXNDYWNoZTsKCQl9CgoJCXJldHVybiByZXQ7Cgl9CgoJZnVuY3Rpb24gaW50ZXJuYWxSZW1vdmVEYXRhKCBlbGVtLCBuYW1lLCBwdnQgKSB7CgkJaWYgKCAhalF1ZXJ5LmFjY2VwdERhdGEoIGVsZW0gKSApIHsKCQkJcmV0dXJuOwoJCX0KCgkJdmFyIHRoaXNDYWNoZSwgaSwKCQkJaXNOb2RlID0gZWxlbS5ub2RlVHlwZSwKCgkJCS8vIFNlZSBqUXVlcnkuZGF0YSBmb3IgbW9yZSBpbmZvcm1hdGlvbgoJCQljYWNoZSA9IGlzTm9kZSA/IGpRdWVyeS5jYWNoZSA6IGVsZW0sCgkJCWlkID0gaXNOb2RlID8gZWxlbVsgalF1ZXJ5LmV4cGFuZG8gXSA6IGpRdWVyeS5leHBhbmRvOwoKCQkvLyBJZiB0aGVyZSBpcyBhbHJlYWR5IG5vIGNhY2hlIGVudHJ5IGZvciB0aGlzIG9iamVjdCwgdGhlcmUgaXMgbm8KCQkvLyBwdXJwb3NlIGluIGNvbnRpbnVpbmcKCQlpZiAoICFjYWNoZVsgaWQgXSApIHsKCQkJcmV0dXJuOwoJCX0KCgkJaWYgKCBuYW1lICkgewoKCQkJdGhpc0NhY2hlID0gcHZ0ID8gY2FjaGVbIGlkIF0gOiBjYWNoZVsgaWQgXS5kYXRhOwoKCQkJaWYgKCB0aGlzQ2FjaGUgKSB7CgoJCQkJLy8gU3VwcG9ydCBhcnJheSBvciBzcGFjZSBzZXBhcmF0ZWQgc3RyaW5nIG5hbWVzIGZvciBkYXRhIGtleXMKCQkJCWlmICggIWpRdWVyeS5pc0FycmF5KCBuYW1lICkgKSB7CgoJCQkJCS8vIHRyeSB0aGUgc3RyaW5nIGFzIGEga2V5IGJlZm9yZSBhbnkgbWFuaXB1bGF0aW9uCgkJCQkJaWYgKCBuYW1lIGluIHRoaXNDYWNoZSApIHsKCQkJCQkJbmFtZSA9IFsgbmFtZSBdOwoJCQkJCX0gZWxzZSB7CgoJCQkJCQkvLyBzcGxpdCB0aGUgY2FtZWwgY2FzZWQgdmVyc2lvbiBieSBzcGFjZXMgdW5sZXNzIGEga2V5IHdpdGggdGhlIHNwYWNlcyBleGlzdHMKCQkJCQkJbmFtZSA9IGpRdWVyeS5jYW1lbENhc2UoIG5hbWUgKTsKCQkJCQkJaWYgKCBuYW1lIGluIHRoaXNDYWNoZSApIHsKCQkJCQkJCW5hbWUgPSBbIG5hbWUgXTsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCW5hbWUgPSBuYW1lLnNwbGl0KCIgIik7CgkJCQkJCX0KCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCS8vIElmICJuYW1lIiBpcyBhbiBhcnJheSBvZiBrZXlzLi4uCgkJCQkJLy8gV2hlbiBkYXRhIGlzIGluaXRpYWxseSBjcmVhdGVkLCB2aWEgKCJrZXkiLCAidmFsIikgc2lnbmF0dXJlLAoJCQkJCS8vIGtleXMgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gY2FtZWxDYXNlLgoJCQkJCS8vIFNpbmNlIHRoZXJlIGlzIG5vIHdheSB0byB0ZWxsIF9ob3dfIGEga2V5IHdhcyBhZGRlZCwgcmVtb3ZlCgkJCQkJLy8gYm90aCBwbGFpbiBrZXkgYW5kIGNhbWVsQ2FzZSBrZXkuICMxMjc4NgoJCQkJCS8vIFRoaXMgd2lsbCBvbmx5IHBlbmFsaXplIHRoZSBhcnJheSBhcmd1bWVudCBwYXRoLgoJCQkJCW5hbWUgPSBuYW1lLmNvbmNhdCggalF1ZXJ5Lm1hcCggbmFtZSwgalF1ZXJ5LmNhbWVsQ2FzZSApICk7CgkJCQl9CgoJCQkJaSA9IG5hbWUubGVuZ3RoOwoJCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQkJZGVsZXRlIHRoaXNDYWNoZVsgbmFtZVtpXSBdOwoJCQkJfQoKCQkJCS8vIElmIHRoZXJlIGlzIG5vIGRhdGEgbGVmdCBpbiB0aGUgY2FjaGUsIHdlIHdhbnQgdG8gY29udGludWUKCQkJCS8vIGFuZCBsZXQgdGhlIGNhY2hlIG9iamVjdCBpdHNlbGYgZ2V0IGRlc3Ryb3llZAoJCQkJaWYgKCBwdnQgPyAhaXNFbXB0eURhdGFPYmplY3QodGhpc0NhY2hlKSA6ICFqUXVlcnkuaXNFbXB0eU9iamVjdCh0aGlzQ2FjaGUpICkgewoJCQkJCXJldHVybjsKCQkJCX0KCQkJfQoJCX0KCgkJLy8gU2VlIGpRdWVyeS5kYXRhIGZvciBtb3JlIGluZm9ybWF0aW9uCgkJaWYgKCAhcHZ0ICkgewoJCQlkZWxldGUgY2FjaGVbIGlkIF0uZGF0YTsKCgkJCS8vIERvbid0IGRlc3Ryb3kgdGhlIHBhcmVudCBjYWNoZSB1bmxlc3MgdGhlIGludGVybmFsIGRhdGEgb2JqZWN0CgkJCS8vIGhhZCBiZWVuIHRoZSBvbmx5IHRoaW5nIGxlZnQgaW4gaXQKCQkJaWYgKCAhaXNFbXB0eURhdGFPYmplY3QoIGNhY2hlWyBpZCBdICkgKSB7CgkJCQlyZXR1cm47CgkJCX0KCQl9CgoJCS8vIERlc3Ryb3kgdGhlIGNhY2hlCgkJaWYgKCBpc05vZGUgKSB7CgkJCWpRdWVyeS5jbGVhbkRhdGEoIFsgZWxlbSBdLCB0cnVlICk7CgoJCS8vIFVzZSBkZWxldGUgd2hlbiBzdXBwb3J0ZWQgZm9yIGV4cGFuZG9zIG9yIGBjYWNoZWAgaXMgbm90IGEgd2luZG93IHBlciBpc1dpbmRvdyAoIzEwMDgwKQoJCS8qIGpzaGludCBlcWVxZXE6IGZhbHNlICovCgkJfSBlbHNlIGlmICggc3VwcG9ydC5kZWxldGVFeHBhbmRvIHx8IGNhY2hlICE9IGNhY2hlLndpbmRvdyApIHsKCQkJLyoganNoaW50IGVxZXFlcTogdHJ1ZSAqLwoJCQlkZWxldGUgY2FjaGVbIGlkIF07CgoJCS8vIFdoZW4gYWxsIGVsc2UgZmFpbHMsIG51bGwKCQl9IGVsc2UgewoJCQljYWNoZVsgaWQgXSA9IG51bGw7CgkJfQoJfQoKCWpRdWVyeS5leHRlbmQoewoJCWNhY2hlOiB7fSwKCgkJLy8gVGhlIGZvbGxvd2luZyBlbGVtZW50cyAoc3BhY2Utc3VmZml4ZWQgdG8gYXZvaWQgT2JqZWN0LnByb3RvdHlwZSBjb2xsaXNpb25zKQoJCS8vIHRocm93IHVuY2F0Y2hhYmxlIGV4Y2VwdGlvbnMgaWYgeW91IGF0dGVtcHQgdG8gc2V0IGV4cGFuZG8gcHJvcGVydGllcwoJCW5vRGF0YTogewoJCQkiYXBwbGV0ICI6IHRydWUsCgkJCSJlbWJlZCAiOiB0cnVlLAoJCQkvLyAuLi5idXQgRmxhc2ggb2JqZWN0cyAod2hpY2ggaGF2ZSB0aGlzIGNsYXNzaWQpICpjYW4qIGhhbmRsZSBleHBhbmRvcwoJCQkib2JqZWN0ICI6ICJjbHNpZDpEMjdDREI2RS1BRTZELTExY2YtOTZCOC00NDQ1NTM1NDAwMDAiCgkJfSwKCgkJaGFzRGF0YTogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCWVsZW0gPSBlbGVtLm5vZGVUeXBlID8galF1ZXJ5LmNhY2hlWyBlbGVtW2pRdWVyeS5leHBhbmRvXSBdIDogZWxlbVsgalF1ZXJ5LmV4cGFuZG8gXTsKCQkJcmV0dXJuICEhZWxlbSAmJiAhaXNFbXB0eURhdGFPYmplY3QoIGVsZW0gKTsKCQl9LAoKCQlkYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZGF0YSApIHsKCQkJcmV0dXJuIGludGVybmFsRGF0YSggZWxlbSwgbmFtZSwgZGF0YSApOwoJCX0sCgoJCXJlbW92ZURhdGE6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkgewoJCQlyZXR1cm4gaW50ZXJuYWxSZW1vdmVEYXRhKCBlbGVtLCBuYW1lICk7CgkJfSwKCgkJLy8gRm9yIGludGVybmFsIHVzZSBvbmx5LgoJCV9kYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZGF0YSApIHsKCQkJcmV0dXJuIGludGVybmFsRGF0YSggZWxlbSwgbmFtZSwgZGF0YSwgdHJ1ZSApOwoJCX0sCgoJCV9yZW1vdmVEYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSApIHsKCQkJcmV0dXJuIGludGVybmFsUmVtb3ZlRGF0YSggZWxlbSwgbmFtZSwgdHJ1ZSApOwoJCX0KCX0pOwoKCWpRdWVyeS5mbi5leHRlbmQoewoJCWRhdGE6IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkgewoJCQl2YXIgaSwgbmFtZSwgZGF0YSwKCQkJCWVsZW0gPSB0aGlzWzBdLAoJCQkJYXR0cnMgPSBlbGVtICYmIGVsZW0uYXR0cmlidXRlczsKCgkJCS8vIFNwZWNpYWwgZXhwZWN0aW9ucyBvZiAuZGF0YSBiYXNpY2FsbHkgdGh3YXJ0IGpRdWVyeS5hY2Nlc3MsCgkJCS8vIHNvIGltcGxlbWVudCB0aGUgcmVsZXZhbnQgYmVoYXZpb3Igb3Vyc2VsdmVzCgoJCQkvLyBHZXRzIGFsbCB2YWx1ZXMKCQkJaWYgKCBrZXkgPT09IHVuZGVmaW5lZCApIHsKCQkJCWlmICggdGhpcy5sZW5ndGggKSB7CgkJCQkJZGF0YSA9IGpRdWVyeS5kYXRhKCBlbGVtICk7CgoJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiAhalF1ZXJ5Ll9kYXRhKCBlbGVtLCAicGFyc2VkQXR0cnMiICkgKSB7CgkJCQkJCWkgPSBhdHRycy5sZW5ndGg7CgkJCQkJCXdoaWxlICggaS0tICkgewoKCQkJCQkJCS8vIFN1cHBvcnQ6IElFMTErCgkJCQkJCQkvLyBUaGUgYXR0cnMgZWxlbWVudHMgY2FuIGJlIG51bGwgKCMxNDg5NCkKCQkJCQkJCWlmICggYXR0cnNbIGkgXSApIHsKCQkJCQkJCQluYW1lID0gYXR0cnNbIGkgXS5uYW1lOwoJCQkJCQkJCWlmICggbmFtZS5pbmRleE9mKCAiZGF0YS0iICkgPT09IDAgKSB7CgkJCQkJCQkJCW5hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKCBuYW1lLnNsaWNlKDUpICk7CgkJCQkJCQkJCWRhdGFBdHRyKCBlbGVtLCBuYW1lLCBkYXRhWyBuYW1lIF0gKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJalF1ZXJ5Ll9kYXRhKCBlbGVtLCAicGFyc2VkQXR0cnMiLCB0cnVlICk7CgkJCQkJfQoJCQkJfQoKCQkJCXJldHVybiBkYXRhOwoJCQl9CgoJCQkvLyBTZXRzIG11bHRpcGxlIHZhbHVlcwoJCQlpZiAoIHR5cGVvZiBrZXkgPT09ICJvYmplY3QiICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQkJCQlqUXVlcnkuZGF0YSggdGhpcywga2V5ICk7CgkJCQl9KTsKCQkJfQoKCQkJcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPiAxID8KCgkJCQkvLyBTZXRzIG9uZSB2YWx1ZQoJCQkJdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJCWpRdWVyeS5kYXRhKCB0aGlzLCBrZXksIHZhbHVlICk7CgkJCQl9KSA6CgoJCQkJLy8gR2V0cyBvbmUgdmFsdWUKCQkJCS8vIFRyeSB0byBmZXRjaCBhbnkgaW50ZXJuYWxseSBzdG9yZWQgZGF0YSBmaXJzdAoJCQkJZWxlbSA/IGRhdGFBdHRyKCBlbGVtLCBrZXksIGpRdWVyeS5kYXRhKCBlbGVtLCBrZXkgKSApIDogdW5kZWZpbmVkOwoJCX0sCgoJCXJlbW92ZURhdGE6IGZ1bmN0aW9uKCBrZXkgKSB7CgkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CgkJCQlqUXVlcnkucmVtb3ZlRGF0YSggdGhpcywga2V5ICk7CgkJCX0pOwoJCX0KCX0pOwoKCglqUXVlcnkuZXh0ZW5kKHsKCQlxdWV1ZTogZnVuY3Rpb24oIGVsZW0sIHR5cGUsIGRhdGEgKSB7CgkJCXZhciBxdWV1ZTsKCgkJCWlmICggZWxlbSApIHsKCQkJCXR5cGUgPSAoIHR5cGUgfHwgImZ4IiApICsgInF1ZXVlIjsKCQkJCXF1ZXVlID0galF1ZXJ5Ll9kYXRhKCBlbGVtLCB0eXBlICk7CgoJCQkJLy8gU3BlZWQgdXAgZGVxdWV1ZSBieSBnZXR0aW5nIG91dCBxdWlja2x5IGlmIHRoaXMgaXMganVzdCBhIGxvb2t1cAoJCQkJaWYgKCBkYXRhICkgewoJCQkJCWlmICggIXF1ZXVlIHx8IGpRdWVyeS5pc0FycmF5KGRhdGEpICkgewoJCQkJCQlxdWV1ZSA9IGpRdWVyeS5fZGF0YSggZWxlbSwgdHlwZSwgalF1ZXJ5Lm1ha2VBcnJheShkYXRhKSApOwoJCQkJCX0gZWxzZSB7CgkJCQkJCXF1ZXVlLnB1c2goIGRhdGEgKTsKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gcXVldWUgfHwgW107CgkJCX0KCQl9LAoKCQlkZXF1ZXVlOiBmdW5jdGlvbiggZWxlbSwgdHlwZSApIHsKCQkJdHlwZSA9IHR5cGUgfHwgImZ4IjsKCgkJCXZhciBxdWV1ZSA9IGpRdWVyeS5xdWV1ZSggZWxlbSwgdHlwZSApLAoJCQkJc3RhcnRMZW5ndGggPSBxdWV1ZS5sZW5ndGgsCgkJCQlmbiA9IHF1ZXVlLnNoaWZ0KCksCgkJCQlob29rcyA9IGpRdWVyeS5fcXVldWVIb29rcyggZWxlbSwgdHlwZSApLAoJCQkJbmV4dCA9IGZ1bmN0aW9uKCkgewoJCQkJCWpRdWVyeS5kZXF1ZXVlKCBlbGVtLCB0eXBlICk7CgkJCQl9OwoKCQkJLy8gSWYgdGhlIGZ4IHF1ZXVlIGlzIGRlcXVldWVkLCBhbHdheXMgcmVtb3ZlIHRoZSBwcm9ncmVzcyBzZW50aW5lbAoJCQlpZiAoIGZuID09PSAiaW5wcm9ncmVzcyIgKSB7CgkJCQlmbiA9IHF1ZXVlLnNoaWZ0KCk7CgkJCQlzdGFydExlbmd0aC0tOwoJCQl9CgoJCQlpZiAoIGZuICkgewoKCQkJCS8vIEFkZCBhIHByb2dyZXNzIHNlbnRpbmVsIHRvIHByZXZlbnQgdGhlIGZ4IHF1ZXVlIGZyb20gYmVpbmcKCQkJCS8vIGF1dG9tYXRpY2FsbHkgZGVxdWV1ZWQKCQkJCWlmICggdHlwZSA9PT0gImZ4IiApIHsKCQkJCQlxdWV1ZS51bnNoaWZ0KCAiaW5wcm9ncmVzcyIgKTsKCQkJCX0KCgkJCQkvLyBjbGVhciB1cCB0aGUgbGFzdCBxdWV1ZSBzdG9wIGZ1bmN0aW9uCgkJCQlkZWxldGUgaG9va3Muc3RvcDsKCQkJCWZuLmNhbGwoIGVsZW0sIG5leHQsIGhvb2tzICk7CgkJCX0KCgkJCWlmICggIXN0YXJ0TGVuZ3RoICYmIGhvb2tzICkgewoJCQkJaG9va3MuZW1wdHkuZmlyZSgpOwoJCQl9CgkJfSwKCgkJLy8gbm90IGludGVuZGVkIGZvciBwdWJsaWMgY29uc3VtcHRpb24gLSBnZW5lcmF0ZXMgYSBxdWV1ZUhvb2tzIG9iamVjdCwgb3IgcmV0dXJucyB0aGUgY3VycmVudCBvbmUKCQlfcXVldWVIb29rczogZnVuY3Rpb24oIGVsZW0sIHR5cGUgKSB7CgkJCXZhciBrZXkgPSB0eXBlICsgInF1ZXVlSG9va3MiOwoJCQlyZXR1cm4galF1ZXJ5Ll9kYXRhKCBlbGVtLCBrZXkgKSB8fCBqUXVlcnkuX2RhdGEoIGVsZW0sIGtleSwgewoJCQkJZW1wdHk6IGpRdWVyeS5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IikuYWRkKGZ1bmN0aW9uKCkgewoJCQkJCWpRdWVyeS5fcmVtb3ZlRGF0YSggZWxlbSwgdHlwZSArICJxdWV1ZSIgKTsKCQkJCQlqUXVlcnkuX3JlbW92ZURhdGEoIGVsZW0sIGtleSApOwoJCQkJfSkKCQkJfSk7CgkJfQoJfSk7CgoJalF1ZXJ5LmZuLmV4dGVuZCh7CgkJcXVldWU6IGZ1bmN0aW9uKCB0eXBlLCBkYXRhICkgewoJCQl2YXIgc2V0dGVyID0gMjsKCgkJCWlmICggdHlwZW9mIHR5cGUgIT09ICJzdHJpbmciICkgewoJCQkJZGF0YSA9IHR5cGU7CgkJCQl0eXBlID0gImZ4IjsKCQkJCXNldHRlci0tOwoJCQl9CgoJCQlpZiAoIGFyZ3VtZW50cy5sZW5ndGggPCBzZXR0ZXIgKSB7CgkJCQlyZXR1cm4galF1ZXJ5LnF1ZXVlKCB0aGlzWzBdLCB0eXBlICk7CgkJCX0KCgkJCXJldHVybiBkYXRhID09PSB1bmRlZmluZWQgPwoJCQkJdGhpcyA6CgkJCQl0aGlzLmVhY2goZnVuY3Rpb24oKSB7CgkJCQkJdmFyIHF1ZXVlID0galF1ZXJ5LnF1ZXVlKCB0aGlzLCB0eXBlLCBkYXRhICk7CgoJCQkJCS8vIGVuc3VyZSBhIGhvb2tzIGZvciB0aGlzIHF1ZXVlCgkJCQkJalF1ZXJ5Ll9xdWV1ZUhvb2tzKCB0aGlzLCB0eXBlICk7CgoJCQkJCWlmICggdHlwZSA9PT0gImZ4IiAmJiBxdWV1ZVswXSAhPT0gImlucHJvZ3Jlc3MiICkgewoJCQkJCQlqUXVlcnkuZGVxdWV1ZSggdGhpcywgdHlwZSApOwoJCQkJCX0KCQkJCX0pOwoJCX0sCgkJZGVxdWV1ZTogZnVuY3Rpb24oIHR5cGUgKSB7CgkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CgkJCQlqUXVlcnkuZGVxdWV1ZSggdGhpcywgdHlwZSApOwoJCQl9KTsKCQl9LAoJCWNsZWFyUXVldWU6IGZ1bmN0aW9uKCB0eXBlICkgewoJCQlyZXR1cm4gdGhpcy5xdWV1ZSggdHlwZSB8fCAiZngiLCBbXSApOwoJCX0sCgkJLy8gR2V0IGEgcHJvbWlzZSByZXNvbHZlZCB3aGVuIHF1ZXVlcyBvZiBhIGNlcnRhaW4gdHlwZQoJCS8vIGFyZSBlbXB0aWVkIChmeCBpcyB0aGUgdHlwZSBieSBkZWZhdWx0KQoJCXByb21pc2U6IGZ1bmN0aW9uKCB0eXBlLCBvYmogKSB7CgkJCXZhciB0bXAsCgkJCQljb3VudCA9IDEsCgkJCQlkZWZlciA9IGpRdWVyeS5EZWZlcnJlZCgpLAoJCQkJZWxlbWVudHMgPSB0aGlzLAoJCQkJaSA9IHRoaXMubGVuZ3RoLAoJCQkJcmVzb2x2ZSA9IGZ1bmN0aW9uKCkgewoJCQkJCWlmICggISggLS1jb3VudCApICkgewoJCQkJCQlkZWZlci5yZXNvbHZlV2l0aCggZWxlbWVudHMsIFsgZWxlbWVudHMgXSApOwoJCQkJCX0KCQkJCX07CgoJCQlpZiAoIHR5cGVvZiB0eXBlICE9PSAic3RyaW5nIiApIHsKCQkJCW9iaiA9IHR5cGU7CgkJCQl0eXBlID0gdW5kZWZpbmVkOwoJCQl9CgkJCXR5cGUgPSB0eXBlIHx8ICJmeCI7CgoJCQl3aGlsZSAoIGktLSApIHsKCQkJCXRtcCA9IGpRdWVyeS5fZGF0YSggZWxlbWVudHNbIGkgXSwgdHlwZSArICJxdWV1ZUhvb2tzIiApOwoJCQkJaWYgKCB0bXAgJiYgdG1wLmVtcHR5ICkgewoJCQkJCWNvdW50Kys7CgkJCQkJdG1wLmVtcHR5LmFkZCggcmVzb2x2ZSApOwoJCQkJfQoJCQl9CgkJCXJlc29sdmUoKTsKCQkJcmV0dXJuIGRlZmVyLnByb21pc2UoIG9iaiApOwoJCX0KCX0pOwoJdmFyIHBudW0gPSAoL1srLV0/KD86XGQqXC58KVxkKyg/OltlRV1bKy1dP1xkK3wpLykuc291cmNlOwoKCXZhciBjc3NFeHBhbmQgPSBbICJUb3AiLCAiUmlnaHQiLCAiQm90dG9tIiwgIkxlZnQiIF07CgoJdmFyIGlzSGlkZGVuID0gZnVuY3Rpb24oIGVsZW0sIGVsICkgewoJCQkvLyBpc0hpZGRlbiBtaWdodCBiZSBjYWxsZWQgZnJvbSBqUXVlcnkjZmlsdGVyIGZ1bmN0aW9uOwoJCQkvLyBpbiB0aGF0IGNhc2UsIGVsZW1lbnQgd2lsbCBiZSBzZWNvbmQgYXJndW1lbnQKCQkJZWxlbSA9IGVsIHx8IGVsZW07CgkJCXJldHVybiBqUXVlcnkuY3NzKCBlbGVtLCAiZGlzcGxheSIgKSA9PT0gIm5vbmUiIHx8ICFqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSApOwoJCX07CgoKCgkvLyBNdWx0aWZ1bmN0aW9uYWwgbWV0aG9kIHRvIGdldCBhbmQgc2V0IHZhbHVlcyBvZiBhIGNvbGxlY3Rpb24KCS8vIFRoZSB2YWx1ZS9zIGNhbiBvcHRpb25hbGx5IGJlIGV4ZWN1dGVkIGlmIGl0J3MgYSBmdW5jdGlvbgoJdmFyIGFjY2VzcyA9IGpRdWVyeS5hY2Nlc3MgPSBmdW5jdGlvbiggZWxlbXMsIGZuLCBrZXksIHZhbHVlLCBjaGFpbmFibGUsIGVtcHR5R2V0LCByYXcgKSB7CgkJdmFyIGkgPSAwLAoJCQlsZW5ndGggPSBlbGVtcy5sZW5ndGgsCgkJCWJ1bGsgPSBrZXkgPT0gbnVsbDsKCgkJLy8gU2V0cyBtYW55IHZhbHVlcwoJCWlmICggalF1ZXJ5LnR5cGUoIGtleSApID09PSAib2JqZWN0IiApIHsKCQkJY2hhaW5hYmxlID0gdHJ1ZTsKCQkJZm9yICggaSBpbiBrZXkgKSB7CgkJCQlqUXVlcnkuYWNjZXNzKCBlbGVtcywgZm4sIGksIGtleVtpXSwgdHJ1ZSwgZW1wdHlHZXQsIHJhdyApOwoJCQl9CgoJCS8vIFNldHMgb25lIHZhbHVlCgkJfSBlbHNlIGlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHsKCQkJY2hhaW5hYmxlID0gdHJ1ZTsKCgkJCWlmICggIWpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkgewoJCQkJcmF3ID0gdHJ1ZTsKCQkJfQoKCQkJaWYgKCBidWxrICkgewoJCQkJLy8gQnVsayBvcGVyYXRpb25zIHJ1biBhZ2FpbnN0IHRoZSBlbnRpcmUgc2V0CgkJCQlpZiAoIHJhdyApIHsKCQkJCQlmbi5jYWxsKCBlbGVtcywgdmFsdWUgKTsKCQkJCQlmbiA9IG51bGw7CgoJCQkJLy8gLi4uZXhjZXB0IHdoZW4gZXhlY3V0aW5nIGZ1bmN0aW9uIHZhbHVlcwoJCQkJfSBlbHNlIHsKCQkJCQlidWxrID0gZm47CgkJCQkJZm4gPSBmdW5jdGlvbiggZWxlbSwga2V5LCB2YWx1ZSApIHsKCQkJCQkJcmV0dXJuIGJ1bGsuY2FsbCggalF1ZXJ5KCBlbGVtICksIHZhbHVlICk7CgkJCQkJfTsKCQkJCX0KCQkJfQoKCQkJaWYgKCBmbiApIHsKCQkJCWZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkgewoJCQkJCWZuKCBlbGVtc1tpXSwga2V5LCByYXcgPyB2YWx1ZSA6IHZhbHVlLmNhbGwoIGVsZW1zW2ldLCBpLCBmbiggZWxlbXNbaV0sIGtleSApICkgKTsKCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIGNoYWluYWJsZSA/CgkJCWVsZW1zIDoKCgkJCS8vIEdldHMKCQkJYnVsayA/CgkJCQlmbi5jYWxsKCBlbGVtcyApIDoKCQkJCWxlbmd0aCA/IGZuKCBlbGVtc1swXSwga2V5ICkgOiBlbXB0eUdldDsKCX07Cgl2YXIgcmNoZWNrYWJsZVR5cGUgPSAoL14oPzpjaGVja2JveHxyYWRpbykkL2kpOwoKCgoJKGZ1bmN0aW9uKCkgewoJCS8vIE1pbmlmaWVkOiB2YXIgYSxiLGMKCQl2YXIgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiaW5wdXQiICksCgkJCWRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICksCgkJCWZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpOwoKCQkvLyBTZXR1cAoJCWRpdi5pbm5lckhUTUwgPSAiICA8bGluay8+PHRhYmxlPjwvdGFibGU+PGEgaHJlZj0nL2EnPmE8L2E+PGlucHV0IHR5cGU9J2NoZWNrYm94Jy8+IjsKCgkJLy8gSUUgc3RyaXBzIGxlYWRpbmcgd2hpdGVzcGFjZSB3aGVuIC5pbm5lckhUTUwgaXMgdXNlZAoJCXN1cHBvcnQubGVhZGluZ1doaXRlc3BhY2UgPSBkaXYuZmlyc3RDaGlsZC5ub2RlVHlwZSA9PT0gMzsKCgkJLy8gTWFrZSBzdXJlIHRoYXQgdGJvZHkgZWxlbWVudHMgYXJlbid0IGF1dG9tYXRpY2FsbHkgaW5zZXJ0ZWQKCQkvLyBJRSB3aWxsIGluc2VydCB0aGVtIGludG8gZW1wdHkgdGFibGVzCgkJc3VwcG9ydC50Ym9keSA9ICFkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJ0Ym9keSIgKS5sZW5ndGg7CgoJCS8vIE1ha2Ugc3VyZSB0aGF0IGxpbmsgZWxlbWVudHMgZ2V0IHNlcmlhbGl6ZWQgY29ycmVjdGx5IGJ5IGlubmVySFRNTAoJCS8vIFRoaXMgcmVxdWlyZXMgYSB3cmFwcGVyIGVsZW1lbnQgaW4gSUUKCQlzdXBwb3J0Lmh0bWxTZXJpYWxpemUgPSAhIWRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSggImxpbmsiICkubGVuZ3RoOwoKCQkvLyBNYWtlcyBzdXJlIGNsb25pbmcgYW4gaHRtbDUgZWxlbWVudCBkb2VzIG5vdCBjYXVzZSBwcm9ibGVtcwoJCS8vIFdoZXJlIG91dGVySFRNTCBpcyB1bmRlZmluZWQsIHRoaXMgc3RpbGwgd29ya3MKCQlzdXBwb3J0Lmh0bWw1Q2xvbmUgPQoJCQlkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAibmF2IiApLmNsb25lTm9kZSggdHJ1ZSApLm91dGVySFRNTCAhPT0gIjw6bmF2PjwvOm5hdj4iOwoKCQkvLyBDaGVjayBpZiBhIGRpc2Nvbm5lY3RlZCBjaGVja2JveCB3aWxsIHJldGFpbiBpdHMgY2hlY2tlZAoJCS8vIHZhbHVlIG9mIHRydWUgYWZ0ZXIgYXBwZW5kZWQgdG8gdGhlIERPTSAoSUU2LzcpCgkJaW5wdXQudHlwZSA9ICJjaGVja2JveCI7CgkJaW5wdXQuY2hlY2tlZCA9IHRydWU7CgkJZnJhZ21lbnQuYXBwZW5kQ2hpbGQoIGlucHV0ICk7CgkJc3VwcG9ydC5hcHBlbmRDaGVja2VkID0gaW5wdXQuY2hlY2tlZDsKCgkJLy8gTWFrZSBzdXJlIHRleHRhcmVhIChhbmQgY2hlY2tib3gpIGRlZmF1bHRWYWx1ZSBpcyBwcm9wZXJseSBjbG9uZWQKCQkvLyBTdXBwb3J0OiBJRTYtSUUxMSsKCQlkaXYuaW5uZXJIVE1MID0gIjx0ZXh0YXJlYT54PC90ZXh0YXJlYT4iOwoJCXN1cHBvcnQubm9DbG9uZUNoZWNrZWQgPSAhIWRpdi5jbG9uZU5vZGUoIHRydWUgKS5sYXN0Q2hpbGQuZGVmYXVsdFZhbHVlOwoKCQkvLyAjMTEyMTcgLSBXZWJLaXQgbG9zZXMgY2hlY2sgd2hlbiB0aGUgbmFtZSBpcyBhZnRlciB0aGUgY2hlY2tlZCBhdHRyaWJ1dGUKCQlmcmFnbWVudC5hcHBlbmRDaGlsZCggZGl2ICk7CgkJZGl2LmlubmVySFRNTCA9ICI8aW5wdXQgdHlwZT0ncmFkaW8nIGNoZWNrZWQ9J2NoZWNrZWQnIG5hbWU9J3QnLz4iOwoKCQkvLyBTdXBwb3J0OiBTYWZhcmkgNS4xLCBpT1MgNS4xLCBBbmRyb2lkIDQueCwgQW5kcm9pZCAyLjMKCQkvLyBvbGQgV2ViS2l0IGRvZXNuJ3QgY2xvbmUgY2hlY2tlZCBzdGF0ZSBjb3JyZWN0bHkgaW4gZnJhZ21lbnRzCgkJc3VwcG9ydC5jaGVja0Nsb25lID0gZGl2LmNsb25lTm9kZSggdHJ1ZSApLmNsb25lTm9kZSggdHJ1ZSApLmxhc3RDaGlsZC5jaGVja2VkOwoKCQkvLyBTdXBwb3J0OiBJRTw5CgkJLy8gT3BlcmEgZG9lcyBub3QgY2xvbmUgZXZlbnRzIChhbmQgdHlwZW9mIGRpdi5hdHRhY2hFdmVudCA9PT0gdW5kZWZpbmVkKS4KCQkvLyBJRTktMTAgY2xvbmVzIGV2ZW50cyBib3VuZCB2aWEgYXR0YWNoRXZlbnQsIGJ1dCB0aGV5IGRvbid0IHRyaWdnZXIgd2l0aCAuY2xpY2soKQoJCXN1cHBvcnQubm9DbG9uZUV2ZW50ID0gdHJ1ZTsKCQlpZiAoIGRpdi5hdHRhY2hFdmVudCApIHsKCQkJZGl2LmF0dGFjaEV2ZW50KCAib25jbGljayIsIGZ1bmN0aW9uKCkgewoJCQkJc3VwcG9ydC5ub0Nsb25lRXZlbnQgPSBmYWxzZTsKCQkJfSk7CgoJCQlkaXYuY2xvbmVOb2RlKCB0cnVlICkuY2xpY2soKTsKCQl9CgoJCS8vIEV4ZWN1dGUgdGhlIHRlc3Qgb25seSBpZiBub3QgYWxyZWFkeSBleGVjdXRlZCBpbiBhbm90aGVyIG1vZHVsZS4KCQlpZiAoc3VwcG9ydC5kZWxldGVFeHBhbmRvID09IG51bGwpIHsKCQkJLy8gU3VwcG9ydDogSUU8OQoJCQlzdXBwb3J0LmRlbGV0ZUV4cGFuZG8gPSB0cnVlOwoJCQl0cnkgewoJCQkJZGVsZXRlIGRpdi50ZXN0OwoJCQl9IGNhdGNoKCBlICkgewoJCQkJc3VwcG9ydC5kZWxldGVFeHBhbmRvID0gZmFsc2U7CgkJCX0KCQl9Cgl9KSgpOwoKCgkoZnVuY3Rpb24oKSB7CgkJdmFyIGksIGV2ZW50TmFtZSwKCQkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCgkJLy8gU3VwcG9ydDogSUU8OSAobGFjayBzdWJtaXQvY2hhbmdlIGJ1YmJsZSksIEZpcmVmb3ggMjMrIChsYWNrIGZvY3VzaW4gZXZlbnQpCgkJZm9yICggaSBpbiB7IHN1Ym1pdDogdHJ1ZSwgY2hhbmdlOiB0cnVlLCBmb2N1c2luOiB0cnVlIH0pIHsKCQkJZXZlbnROYW1lID0gIm9uIiArIGk7CgoJCQlpZiAoICEoc3VwcG9ydFsgaSArICJCdWJibGVzIiBdID0gZXZlbnROYW1lIGluIHdpbmRvdykgKSB7CgkJCQkvLyBCZXdhcmUgb2YgQ1NQIHJlc3RyaWN0aW9ucyAoaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vU2VjdXJpdHkvQ1NQKQoJCQkJZGl2LnNldEF0dHJpYnV0ZSggZXZlbnROYW1lLCAidCIgKTsKCQkJCXN1cHBvcnRbIGkgKyAiQnViYmxlcyIgXSA9IGRpdi5hdHRyaWJ1dGVzWyBldmVudE5hbWUgXS5leHBhbmRvID09PSBmYWxzZTsKCQkJfQoJCX0KCgkJLy8gTnVsbCBlbGVtZW50cyB0byBhdm9pZCBsZWFrcyBpbiBJRS4KCQlkaXYgPSBudWxsOwoJfSkoKTsKCgoJdmFyIHJmb3JtRWxlbXMgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYSkkL2ksCgkJcmtleUV2ZW50ID0gL15rZXkvLAoJCXJtb3VzZUV2ZW50ID0gL14oPzptb3VzZXxwb2ludGVyfGNvbnRleHRtZW51KXxjbGljay8sCgkJcmZvY3VzTW9ycGggPSAvXig/OmZvY3VzaW5mb2N1c3xmb2N1c291dGJsdXIpJC8sCgkJcnR5cGVuYW1lc3BhY2UgPSAvXihbXi5dKikoPzpcLiguKyl8KSQvOwoKCWZ1bmN0aW9uIHJldHVyblRydWUoKSB7CgkJcmV0dXJuIHRydWU7Cgl9CgoJZnVuY3Rpb24gcmV0dXJuRmFsc2UoKSB7CgkJcmV0dXJuIGZhbHNlOwoJfQoKCWZ1bmN0aW9uIHNhZmVBY3RpdmVFbGVtZW50KCkgewoJCXRyeSB7CgkJCXJldHVybiBkb2N1bWVudC5hY3RpdmVFbGVtZW50OwoJCX0gY2F0Y2ggKCBlcnIgKSB7IH0KCX0KCgkvKgoJICogSGVscGVyIGZ1bmN0aW9ucyBmb3IgbWFuYWdpbmcgZXZlbnRzIC0tIG5vdCBwYXJ0IG9mIHRoZSBwdWJsaWMgaW50ZXJmYWNlLgoJICogUHJvcHMgdG8gRGVhbiBFZHdhcmRzJyBhZGRFdmVudCBsaWJyYXJ5IGZvciBtYW55IG9mIHRoZSBpZGVhcy4KCSAqLwoJalF1ZXJ5LmV2ZW50ID0gewoKCQlnbG9iYWw6IHt9LAoKCQlhZGQ6IGZ1bmN0aW9uKCBlbGVtLCB0eXBlcywgaGFuZGxlciwgZGF0YSwgc2VsZWN0b3IgKSB7CgkJCXZhciB0bXAsIGV2ZW50cywgdCwgaGFuZGxlT2JqSW4sCgkJCQlzcGVjaWFsLCBldmVudEhhbmRsZSwgaGFuZGxlT2JqLAoJCQkJaGFuZGxlcnMsIHR5cGUsIG5hbWVzcGFjZXMsIG9yaWdUeXBlLAoJCQkJZWxlbURhdGEgPSBqUXVlcnkuX2RhdGEoIGVsZW0gKTsKCgkJCS8vIERvbid0IGF0dGFjaCBldmVudHMgdG8gbm9EYXRhIG9yIHRleHQvY29tbWVudCBub2RlcyAoYnV0IGFsbG93IHBsYWluIG9iamVjdHMpCgkJCWlmICggIWVsZW1EYXRhICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBDYWxsZXIgY2FuIHBhc3MgaW4gYW4gb2JqZWN0IG9mIGN1c3RvbSBkYXRhIGluIGxpZXUgb2YgdGhlIGhhbmRsZXIKCQkJaWYgKCBoYW5kbGVyLmhhbmRsZXIgKSB7CgkJCQloYW5kbGVPYmpJbiA9IGhhbmRsZXI7CgkJCQloYW5kbGVyID0gaGFuZGxlT2JqSW4uaGFuZGxlcjsKCQkJCXNlbGVjdG9yID0gaGFuZGxlT2JqSW4uc2VsZWN0b3I7CgkJCX0KCgkJCS8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBoYW5kbGVyIGhhcyBhIHVuaXF1ZSBJRCwgdXNlZCB0byBmaW5kL3JlbW92ZSBpdCBsYXRlcgoJCQlpZiAoICFoYW5kbGVyLmd1aWQgKSB7CgkJCQloYW5kbGVyLmd1aWQgPSBqUXVlcnkuZ3VpZCsrOwoJCQl9CgoJCQkvLyBJbml0IHRoZSBlbGVtZW50J3MgZXZlbnQgc3RydWN0dXJlIGFuZCBtYWluIGhhbmRsZXIsIGlmIHRoaXMgaXMgdGhlIGZpcnN0CgkJCWlmICggIShldmVudHMgPSBlbGVtRGF0YS5ldmVudHMpICkgewoJCQkJZXZlbnRzID0gZWxlbURhdGEuZXZlbnRzID0ge307CgkJCX0KCQkJaWYgKCAhKGV2ZW50SGFuZGxlID0gZWxlbURhdGEuaGFuZGxlKSApIHsKCQkJCWV2ZW50SGFuZGxlID0gZWxlbURhdGEuaGFuZGxlID0gZnVuY3Rpb24oIGUgKSB7CgkJCQkJLy8gRGlzY2FyZCB0aGUgc2Vjb25kIGV2ZW50IG9mIGEgalF1ZXJ5LmV2ZW50LnRyaWdnZXIoKSBhbmQKCQkJCQkvLyB3aGVuIGFuIGV2ZW50IGlzIGNhbGxlZCBhZnRlciBhIHBhZ2UgaGFzIHVubG9hZGVkCgkJCQkJcmV0dXJuIHR5cGVvZiBqUXVlcnkgIT09IHN0cnVuZGVmaW5lZCAmJiAoIWUgfHwgalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCAhPT0gZS50eXBlKSA/CgkJCQkJCWpRdWVyeS5ldmVudC5kaXNwYXRjaC5hcHBseSggZXZlbnRIYW5kbGUuZWxlbSwgYXJndW1lbnRzICkgOgoJCQkJCQl1bmRlZmluZWQ7CgkJCQl9OwoJCQkJLy8gQWRkIGVsZW0gYXMgYSBwcm9wZXJ0eSBvZiB0aGUgaGFuZGxlIGZuIHRvIHByZXZlbnQgYSBtZW1vcnkgbGVhayB3aXRoIElFIG5vbi1uYXRpdmUgZXZlbnRzCgkJCQlldmVudEhhbmRsZS5lbGVtID0gZWxlbTsKCQkJfQoKCQkJLy8gSGFuZGxlIG11bHRpcGxlIGV2ZW50cyBzZXBhcmF0ZWQgYnkgYSBzcGFjZQoJCQl0eXBlcyA9ICggdHlwZXMgfHwgIiIgKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgWyAiIiBdOwoJCQl0ID0gdHlwZXMubGVuZ3RoOwoJCQl3aGlsZSAoIHQtLSApIHsKCQkJCXRtcCA9IHJ0eXBlbmFtZXNwYWNlLmV4ZWMoIHR5cGVzW3RdICkgfHwgW107CgkJCQl0eXBlID0gb3JpZ1R5cGUgPSB0bXBbMV07CgkJCQluYW1lc3BhY2VzID0gKCB0bXBbMl0gfHwgIiIgKS5zcGxpdCggIi4iICkuc29ydCgpOwoKCQkJCS8vIFRoZXJlICptdXN0KiBiZSBhIHR5cGUsIG5vIGF0dGFjaGluZyBuYW1lc3BhY2Utb25seSBoYW5kbGVycwoJCQkJaWYgKCAhdHlwZSApIHsKCQkJCQljb250aW51ZTsKCQkJCX0KCgkJCQkvLyBJZiBldmVudCBjaGFuZ2VzIGl0cyB0eXBlLCB1c2UgdGhlIHNwZWNpYWwgZXZlbnQgaGFuZGxlcnMgZm9yIHRoZSBjaGFuZ2VkIHR5cGUKCQkJCXNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFsgdHlwZSBdIHx8IHt9OwoKCQkJCS8vIElmIHNlbGVjdG9yIGRlZmluZWQsIGRldGVybWluZSBzcGVjaWFsIGV2ZW50IGFwaSB0eXBlLCBvdGhlcndpc2UgZ2l2ZW4gdHlwZQoJCQkJdHlwZSA9ICggc2VsZWN0b3IgPyBzcGVjaWFsLmRlbGVnYXRlVHlwZSA6IHNwZWNpYWwuYmluZFR5cGUgKSB8fCB0eXBlOwoKCQkJCS8vIFVwZGF0ZSBzcGVjaWFsIGJhc2VkIG9uIG5ld2x5IHJlc2V0IHR5cGUKCQkJCXNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFsgdHlwZSBdIHx8IHt9OwoKCQkJCS8vIGhhbmRsZU9iaiBpcyBwYXNzZWQgdG8gYWxsIGV2ZW50IGhhbmRsZXJzCgkJCQloYW5kbGVPYmogPSBqUXVlcnkuZXh0ZW5kKHsKCQkJCQl0eXBlOiB0eXBlLAoJCQkJCW9yaWdUeXBlOiBvcmlnVHlwZSwKCQkJCQlkYXRhOiBkYXRhLAoJCQkJCWhhbmRsZXI6IGhhbmRsZXIsCgkJCQkJZ3VpZDogaGFuZGxlci5ndWlkLAoJCQkJCXNlbGVjdG9yOiBzZWxlY3RvciwKCQkJCQluZWVkc0NvbnRleHQ6IHNlbGVjdG9yICYmIGpRdWVyeS5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KCBzZWxlY3RvciApLAoJCQkJCW5hbWVzcGFjZTogbmFtZXNwYWNlcy5qb2luKCIuIikKCQkJCX0sIGhhbmRsZU9iakluICk7CgoJCQkJLy8gSW5pdCB0aGUgZXZlbnQgaGFuZGxlciBxdWV1ZSBpZiB3ZSdyZSB0aGUgZmlyc3QKCQkJCWlmICggIShoYW5kbGVycyA9IGV2ZW50c1sgdHlwZSBdKSApIHsKCQkJCQloYW5kbGVycyA9IGV2ZW50c1sgdHlwZSBdID0gW107CgkJCQkJaGFuZGxlcnMuZGVsZWdhdGVDb3VudCA9IDA7CgoJCQkJCS8vIE9ubHkgdXNlIGFkZEV2ZW50TGlzdGVuZXIvYXR0YWNoRXZlbnQgaWYgdGhlIHNwZWNpYWwgZXZlbnRzIGhhbmRsZXIgcmV0dXJucyBmYWxzZQoJCQkJCWlmICggIXNwZWNpYWwuc2V0dXAgfHwgc3BlY2lhbC5zZXR1cC5jYWxsKCBlbGVtLCBkYXRhLCBuYW1lc3BhY2VzLCBldmVudEhhbmRsZSApID09PSBmYWxzZSApIHsKCQkJCQkJLy8gQmluZCB0aGUgZ2xvYmFsIGV2ZW50IGhhbmRsZXIgdG8gdGhlIGVsZW1lbnQKCQkJCQkJaWYgKCBlbGVtLmFkZEV2ZW50TGlzdGVuZXIgKSB7CgkJCQkJCQllbGVtLmFkZEV2ZW50TGlzdGVuZXIoIHR5cGUsIGV2ZW50SGFuZGxlLCBmYWxzZSApOwoKCQkJCQkJfSBlbHNlIGlmICggZWxlbS5hdHRhY2hFdmVudCApIHsKCQkJCQkJCWVsZW0uYXR0YWNoRXZlbnQoICJvbiIgKyB0eXBlLCBldmVudEhhbmRsZSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCWlmICggc3BlY2lhbC5hZGQgKSB7CgkJCQkJc3BlY2lhbC5hZGQuY2FsbCggZWxlbSwgaGFuZGxlT2JqICk7CgoJCQkJCWlmICggIWhhbmRsZU9iai5oYW5kbGVyLmd1aWQgKSB7CgkJCQkJCWhhbmRsZU9iai5oYW5kbGVyLmd1aWQgPSBoYW5kbGVyLmd1aWQ7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIEFkZCB0byB0aGUgZWxlbWVudCdzIGhhbmRsZXIgbGlzdCwgZGVsZWdhdGVzIGluIGZyb250CgkJCQlpZiAoIHNlbGVjdG9yICkgewoJCQkJCWhhbmRsZXJzLnNwbGljZSggaGFuZGxlcnMuZGVsZWdhdGVDb3VudCsrLCAwLCBoYW5kbGVPYmogKTsKCQkJCX0gZWxzZSB7CgkJCQkJaGFuZGxlcnMucHVzaCggaGFuZGxlT2JqICk7CgkJCQl9CgoJCQkJLy8gS2VlcCB0cmFjayBvZiB3aGljaCBldmVudHMgaGF2ZSBldmVyIGJlZW4gdXNlZCwgZm9yIGV2ZW50IG9wdGltaXphdGlvbgoJCQkJalF1ZXJ5LmV2ZW50Lmdsb2JhbFsgdHlwZSBdID0gdHJ1ZTsKCQkJfQoKCQkJLy8gTnVsbGlmeSBlbGVtIHRvIHByZXZlbnQgbWVtb3J5IGxlYWtzIGluIElFCgkJCWVsZW0gPSBudWxsOwoJCX0sCgoJCS8vIERldGFjaCBhbiBldmVudCBvciBzZXQgb2YgZXZlbnRzIGZyb20gYW4gZWxlbWVudAoJCXJlbW92ZTogZnVuY3Rpb24oIGVsZW0sIHR5cGVzLCBoYW5kbGVyLCBzZWxlY3RvciwgbWFwcGVkVHlwZXMgKSB7CgkJCXZhciBqLCBoYW5kbGVPYmosIHRtcCwKCQkJCW9yaWdDb3VudCwgdCwgZXZlbnRzLAoJCQkJc3BlY2lhbCwgaGFuZGxlcnMsIHR5cGUsCgkJCQluYW1lc3BhY2VzLCBvcmlnVHlwZSwKCQkJCWVsZW1EYXRhID0galF1ZXJ5Lmhhc0RhdGEoIGVsZW0gKSAmJiBqUXVlcnkuX2RhdGEoIGVsZW0gKTsKCgkJCWlmICggIWVsZW1EYXRhIHx8ICEoZXZlbnRzID0gZWxlbURhdGEuZXZlbnRzKSApIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gT25jZSBmb3IgZWFjaCB0eXBlLm5hbWVzcGFjZSBpbiB0eXBlczsgdHlwZSBtYXkgYmUgb21pdHRlZAoJCQl0eXBlcyA9ICggdHlwZXMgfHwgIiIgKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgWyAiIiBdOwoJCQl0ID0gdHlwZXMubGVuZ3RoOwoJCQl3aGlsZSAoIHQtLSApIHsKCQkJCXRtcCA9IHJ0eXBlbmFtZXNwYWNlLmV4ZWMoIHR5cGVzW3RdICkgfHwgW107CgkJCQl0eXBlID0gb3JpZ1R5cGUgPSB0bXBbMV07CgkJCQluYW1lc3BhY2VzID0gKCB0bXBbMl0gfHwgIiIgKS5zcGxpdCggIi4iICkuc29ydCgpOwoKCQkJCS8vIFVuYmluZCBhbGwgZXZlbnRzIChvbiB0aGlzIG5hbWVzcGFjZSwgaWYgcHJvdmlkZWQpIGZvciB0aGUgZWxlbWVudAoJCQkJaWYgKCAhdHlwZSApIHsKCQkJCQlmb3IgKCB0eXBlIGluIGV2ZW50cyApIHsKCQkJCQkJalF1ZXJ5LmV2ZW50LnJlbW92ZSggZWxlbSwgdHlwZSArIHR5cGVzWyB0IF0sIGhhbmRsZXIsIHNlbGVjdG9yLCB0cnVlICk7CgkJCQkJfQoJCQkJCWNvbnRpbnVlOwoJCQkJfQoKCQkJCXNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFsgdHlwZSBdIHx8IHt9OwoJCQkJdHlwZSA9ICggc2VsZWN0b3IgPyBzcGVjaWFsLmRlbGVnYXRlVHlwZSA6IHNwZWNpYWwuYmluZFR5cGUgKSB8fCB0eXBlOwoJCQkJaGFuZGxlcnMgPSBldmVudHNbIHR5cGUgXSB8fCBbXTsKCQkJCXRtcCA9IHRtcFsyXSAmJiBuZXcgUmVnRXhwKCAiKF58XFwuKSIgKyBuYW1lc3BhY2VzLmpvaW4oIlxcLig/Oi4qXFwufCkiKSArICIoXFwufCQpIiApOwoKCQkJCS8vIFJlbW92ZSBtYXRjaGluZyBldmVudHMKCQkJCW9yaWdDb3VudCA9IGogPSBoYW5kbGVycy5sZW5ndGg7CgkJCQl3aGlsZSAoIGotLSApIHsKCQkJCQloYW5kbGVPYmogPSBoYW5kbGVyc1sgaiBdOwoKCQkJCQlpZiAoICggbWFwcGVkVHlwZXMgfHwgb3JpZ1R5cGUgPT09IGhhbmRsZU9iai5vcmlnVHlwZSApICYmCgkJCQkJCSggIWhhbmRsZXIgfHwgaGFuZGxlci5ndWlkID09PSBoYW5kbGVPYmouZ3VpZCApICYmCgkJCQkJCSggIXRtcCB8fCB0bXAudGVzdCggaGFuZGxlT2JqLm5hbWVzcGFjZSApICkgJiYKCQkJCQkJKCAhc2VsZWN0b3IgfHwgc2VsZWN0b3IgPT09IGhhbmRsZU9iai5zZWxlY3RvciB8fCBzZWxlY3RvciA9PT0gIioqIiAmJiBoYW5kbGVPYmouc2VsZWN0b3IgKSApIHsKCQkJCQkJaGFuZGxlcnMuc3BsaWNlKCBqLCAxICk7CgoJCQkJCQlpZiAoIGhhbmRsZU9iai5zZWxlY3RvciApIHsKCQkJCQkJCWhhbmRsZXJzLmRlbGVnYXRlQ291bnQtLTsKCQkJCQkJfQoJCQkJCQlpZiAoIHNwZWNpYWwucmVtb3ZlICkgewoJCQkJCQkJc3BlY2lhbC5yZW1vdmUuY2FsbCggZWxlbSwgaGFuZGxlT2JqICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJLy8gUmVtb3ZlIGdlbmVyaWMgZXZlbnQgaGFuZGxlciBpZiB3ZSByZW1vdmVkIHNvbWV0aGluZyBhbmQgbm8gbW9yZSBoYW5kbGVycyBleGlzdAoJCQkJLy8gKGF2b2lkcyBwb3RlbnRpYWwgZm9yIGVuZGxlc3MgcmVjdXJzaW9uIGR1cmluZyByZW1vdmFsIG9mIHNwZWNpYWwgZXZlbnQgaGFuZGxlcnMpCgkJCQlpZiAoIG9yaWdDb3VudCAmJiAhaGFuZGxlcnMubGVuZ3RoICkgewoJCQkJCWlmICggIXNwZWNpYWwudGVhcmRvd24gfHwgc3BlY2lhbC50ZWFyZG93bi5jYWxsKCBlbGVtLCBuYW1lc3BhY2VzLCBlbGVtRGF0YS5oYW5kbGUgKSA9PT0gZmFsc2UgKSB7CgkJCQkJCWpRdWVyeS5yZW1vdmVFdmVudCggZWxlbSwgdHlwZSwgZWxlbURhdGEuaGFuZGxlICk7CgkJCQkJfQoKCQkJCQlkZWxldGUgZXZlbnRzWyB0eXBlIF07CgkJCQl9CgkJCX0KCgkJCS8vIFJlbW92ZSB0aGUgZXhwYW5kbyBpZiBpdCdzIG5vIGxvbmdlciB1c2VkCgkJCWlmICggalF1ZXJ5LmlzRW1wdHlPYmplY3QoIGV2ZW50cyApICkgewoJCQkJZGVsZXRlIGVsZW1EYXRhLmhhbmRsZTsKCgkJCQkvLyByZW1vdmVEYXRhIGFsc28gY2hlY2tzIGZvciBlbXB0aW5lc3MgYW5kIGNsZWFycyB0aGUgZXhwYW5kbyBpZiBlbXB0eQoJCQkJLy8gc28gdXNlIGl0IGluc3RlYWQgb2YgZGVsZXRlCgkJCQlqUXVlcnkuX3JlbW92ZURhdGEoIGVsZW0sICJldmVudHMiICk7CgkJCX0KCQl9LAoKCQl0cmlnZ2VyOiBmdW5jdGlvbiggZXZlbnQsIGRhdGEsIGVsZW0sIG9ubHlIYW5kbGVycyApIHsKCQkJdmFyIGhhbmRsZSwgb250eXBlLCBjdXIsCgkJCQlidWJibGVUeXBlLCBzcGVjaWFsLCB0bXAsIGksCgkJCQlldmVudFBhdGggPSBbIGVsZW0gfHwgZG9jdW1lbnQgXSwKCQkJCXR5cGUgPSBoYXNPd24uY2FsbCggZXZlbnQsICJ0eXBlIiApID8gZXZlbnQudHlwZSA6IGV2ZW50LAoJCQkJbmFtZXNwYWNlcyA9IGhhc093bi5jYWxsKCBldmVudCwgIm5hbWVzcGFjZSIgKSA/IGV2ZW50Lm5hbWVzcGFjZS5zcGxpdCgiLiIpIDogW107CgoJCQljdXIgPSB0bXAgPSBlbGVtID0gZWxlbSB8fCBkb2N1bWVudDsKCgkJCS8vIERvbid0IGRvIGV2ZW50cyBvbiB0ZXh0IGFuZCBjb21tZW50IG5vZGVzCgkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMyB8fCBlbGVtLm5vZGVUeXBlID09PSA4ICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBmb2N1cy9ibHVyIG1vcnBocyB0byBmb2N1c2luL291dDsgZW5zdXJlIHdlJ3JlIG5vdCBmaXJpbmcgdGhlbSByaWdodCBub3cKCQkJaWYgKCByZm9jdXNNb3JwaC50ZXN0KCB0eXBlICsgalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCApICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQlpZiAoIHR5cGUuaW5kZXhPZigiLiIpID49IDAgKSB7CgkJCQkvLyBOYW1lc3BhY2VkIHRyaWdnZXI7IGNyZWF0ZSBhIHJlZ2V4cCB0byBtYXRjaCBldmVudCB0eXBlIGluIGhhbmRsZSgpCgkJCQluYW1lc3BhY2VzID0gdHlwZS5zcGxpdCgiLiIpOwoJCQkJdHlwZSA9IG5hbWVzcGFjZXMuc2hpZnQoKTsKCQkJCW5hbWVzcGFjZXMuc29ydCgpOwoJCQl9CgkJCW9udHlwZSA9IHR5cGUuaW5kZXhPZigiOiIpIDwgMCAmJiAib24iICsgdHlwZTsKCgkJCS8vIENhbGxlciBjYW4gcGFzcyBpbiBhIGpRdWVyeS5FdmVudCBvYmplY3QsIE9iamVjdCwgb3IganVzdCBhbiBldmVudCB0eXBlIHN0cmluZwoJCQlldmVudCA9IGV2ZW50WyBqUXVlcnkuZXhwYW5kbyBdID8KCQkJCWV2ZW50IDoKCQkJCW5ldyBqUXVlcnkuRXZlbnQoIHR5cGUsIHR5cGVvZiBldmVudCA9PT0gIm9iamVjdCIgJiYgZXZlbnQgKTsKCgkJCS8vIFRyaWdnZXIgYml0bWFzazogJiAxIGZvciBuYXRpdmUgaGFuZGxlcnM7ICYgMiBmb3IgalF1ZXJ5IChhbHdheXMgdHJ1ZSkKCQkJZXZlbnQuaXNUcmlnZ2VyID0gb25seUhhbmRsZXJzID8gMiA6IDM7CgkJCWV2ZW50Lm5hbWVzcGFjZSA9IG5hbWVzcGFjZXMuam9pbigiLiIpOwoJCQlldmVudC5uYW1lc3BhY2VfcmUgPSBldmVudC5uYW1lc3BhY2UgPwoJCQkJbmV3IFJlZ0V4cCggIihefFxcLikiICsgbmFtZXNwYWNlcy5qb2luKCJcXC4oPzouKlxcLnwpIikgKyAiKFxcLnwkKSIgKSA6CgkJCQludWxsOwoKCQkJLy8gQ2xlYW4gdXAgdGhlIGV2ZW50IGluIGNhc2UgaXQgaXMgYmVpbmcgcmV1c2VkCgkJCWV2ZW50LnJlc3VsdCA9IHVuZGVmaW5lZDsKCQkJaWYgKCAhZXZlbnQudGFyZ2V0ICkgewoJCQkJZXZlbnQudGFyZ2V0ID0gZWxlbTsKCQkJfQoKCQkJLy8gQ2xvbmUgYW55IGluY29taW5nIGRhdGEgYW5kIHByZXBlbmQgdGhlIGV2ZW50LCBjcmVhdGluZyB0aGUgaGFuZGxlciBhcmcgbGlzdAoJCQlkYXRhID0gZGF0YSA9PSBudWxsID8KCQkJCVsgZXZlbnQgXSA6CgkJCQlqUXVlcnkubWFrZUFycmF5KCBkYXRhLCBbIGV2ZW50IF0gKTsKCgkJCS8vIEFsbG93IHNwZWNpYWwgZXZlbnRzIHRvIGRyYXcgb3V0c2lkZSB0aGUgbGluZXMKCQkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307CgkJCWlmICggIW9ubHlIYW5kbGVycyAmJiBzcGVjaWFsLnRyaWdnZXIgJiYgc3BlY2lhbC50cmlnZ2VyLmFwcGx5KCBlbGVtLCBkYXRhICkgPT09IGZhbHNlICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBEZXRlcm1pbmUgZXZlbnQgcHJvcGFnYXRpb24gcGF0aCBpbiBhZHZhbmNlLCBwZXIgVzNDIGV2ZW50cyBzcGVjICgjOTk1MSkKCQkJLy8gQnViYmxlIHVwIHRvIGRvY3VtZW50LCB0aGVuIHRvIHdpbmRvdzsgd2F0Y2ggZm9yIGEgZ2xvYmFsIG93bmVyRG9jdW1lbnQgdmFyICgjOTcyNCkKCQkJaWYgKCAhb25seUhhbmRsZXJzICYmICFzcGVjaWFsLm5vQnViYmxlICYmICFqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSApIHsKCgkJCQlidWJibGVUeXBlID0gc3BlY2lhbC5kZWxlZ2F0ZVR5cGUgfHwgdHlwZTsKCQkJCWlmICggIXJmb2N1c01vcnBoLnRlc3QoIGJ1YmJsZVR5cGUgKyB0eXBlICkgKSB7CgkJCQkJY3VyID0gY3VyLnBhcmVudE5vZGU7CgkJCQl9CgkJCQlmb3IgKCA7IGN1cjsgY3VyID0gY3VyLnBhcmVudE5vZGUgKSB7CgkJCQkJZXZlbnRQYXRoLnB1c2goIGN1ciApOwoJCQkJCXRtcCA9IGN1cjsKCQkJCX0KCgkJCQkvLyBPbmx5IGFkZCB3aW5kb3cgaWYgd2UgZ290IHRvIGRvY3VtZW50IChlLmcuLCBub3QgcGxhaW4gb2JqIG9yIGRldGFjaGVkIERPTSkKCQkJCWlmICggdG1wID09PSAoZWxlbS5vd25lckRvY3VtZW50IHx8IGRvY3VtZW50KSApIHsKCQkJCQlldmVudFBhdGgucHVzaCggdG1wLmRlZmF1bHRWaWV3IHx8IHRtcC5wYXJlbnRXaW5kb3cgfHwgd2luZG93ICk7CgkJCQl9CgkJCX0KCgkJCS8vIEZpcmUgaGFuZGxlcnMgb24gdGhlIGV2ZW50IHBhdGgKCQkJaSA9IDA7CgkJCXdoaWxlICggKGN1ciA9IGV2ZW50UGF0aFtpKytdKSAmJiAhZXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSApIHsKCgkJCQlldmVudC50eXBlID0gaSA+IDEgPwoJCQkJCWJ1YmJsZVR5cGUgOgoJCQkJCXNwZWNpYWwuYmluZFR5cGUgfHwgdHlwZTsKCgkJCQkvLyBqUXVlcnkgaGFuZGxlcgoJCQkJaGFuZGxlID0gKCBqUXVlcnkuX2RhdGEoIGN1ciwgImV2ZW50cyIgKSB8fCB7fSApWyBldmVudC50eXBlIF0gJiYgalF1ZXJ5Ll9kYXRhKCBjdXIsICJoYW5kbGUiICk7CgkJCQlpZiAoIGhhbmRsZSApIHsKCQkJCQloYW5kbGUuYXBwbHkoIGN1ciwgZGF0YSApOwoJCQkJfQoKCQkJCS8vIE5hdGl2ZSBoYW5kbGVyCgkJCQloYW5kbGUgPSBvbnR5cGUgJiYgY3VyWyBvbnR5cGUgXTsKCQkJCWlmICggaGFuZGxlICYmIGhhbmRsZS5hcHBseSAmJiBqUXVlcnkuYWNjZXB0RGF0YSggY3VyICkgKSB7CgkJCQkJZXZlbnQucmVzdWx0ID0gaGFuZGxlLmFwcGx5KCBjdXIsIGRhdGEgKTsKCQkJCQlpZiAoIGV2ZW50LnJlc3VsdCA9PT0gZmFsc2UgKSB7CgkJCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCWV2ZW50LnR5cGUgPSB0eXBlOwoKCQkJLy8gSWYgbm9ib2R5IHByZXZlbnRlZCB0aGUgZGVmYXVsdCBhY3Rpb24sIGRvIGl0IG5vdwoJCQlpZiAoICFvbmx5SGFuZGxlcnMgJiYgIWV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpICkgewoKCQkJCWlmICggKCFzcGVjaWFsLl9kZWZhdWx0IHx8IHNwZWNpYWwuX2RlZmF1bHQuYXBwbHkoIGV2ZW50UGF0aC5wb3AoKSwgZGF0YSApID09PSBmYWxzZSkgJiYKCQkJCQlqUXVlcnkuYWNjZXB0RGF0YSggZWxlbSApICkgewoKCQkJCQkvLyBDYWxsIGEgbmF0aXZlIERPTSBtZXRob2Qgb24gdGhlIHRhcmdldCB3aXRoIHRoZSBzYW1lIG5hbWUgbmFtZSBhcyB0aGUgZXZlbnQuCgkJCQkJLy8gQ2FuJ3QgdXNlIGFuIC5pc0Z1bmN0aW9uKCkgY2hlY2sgaGVyZSBiZWNhdXNlIElFNi83IGZhaWxzIHRoYXQgdGVzdC4KCQkJCQkvLyBEb24ndCBkbyBkZWZhdWx0IGFjdGlvbnMgb24gd2luZG93LCB0aGF0J3Mgd2hlcmUgZ2xvYmFsIHZhcmlhYmxlcyBiZSAoIzYxNzApCgkJCQkJaWYgKCBvbnR5cGUgJiYgZWxlbVsgdHlwZSBdICYmICFqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSApIHsKCgkJCQkJCS8vIERvbid0IHJlLXRyaWdnZXIgYW4gb25GT08gZXZlbnQgd2hlbiB3ZSBjYWxsIGl0cyBGT08oKSBtZXRob2QKCQkJCQkJdG1wID0gZWxlbVsgb250eXBlIF07CgoJCQkJCQlpZiAoIHRtcCApIHsKCQkJCQkJCWVsZW1bIG9udHlwZSBdID0gbnVsbDsKCQkJCQkJfQoKCQkJCQkJLy8gUHJldmVudCByZS10cmlnZ2VyaW5nIG9mIHRoZSBzYW1lIGV2ZW50LCBzaW5jZSB3ZSBhbHJlYWR5IGJ1YmJsZWQgaXQgYWJvdmUKCQkJCQkJalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCA9IHR5cGU7CgkJCQkJCXRyeSB7CgkJCQkJCQllbGVtWyB0eXBlIF0oKTsKCQkJCQkJfSBjYXRjaCAoIGUgKSB7CgkJCQkJCQkvLyBJRTw5IGRpZXMgb24gZm9jdXMvYmx1ciB0byBoaWRkZW4gZWxlbWVudCAoIzE0ODYsIzEyNTE4KQoJCQkJCQkJLy8gb25seSByZXByb2R1Y2libGUgb24gd2luWFAgSUU4IG5hdGl2ZSwgbm90IElFOSBpbiBJRTggbW9kZQoJCQkJCQl9CgkJCQkJCWpRdWVyeS5ldmVudC50cmlnZ2VyZWQgPSB1bmRlZmluZWQ7CgoJCQkJCQlpZiAoIHRtcCApIHsKCQkJCQkJCWVsZW1bIG9udHlwZSBdID0gdG1wOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gZXZlbnQucmVzdWx0OwoJCX0sCgoJCWRpc3BhdGNoOiBmdW5jdGlvbiggZXZlbnQgKSB7CgoJCQkvLyBNYWtlIGEgd3JpdGFibGUgalF1ZXJ5LkV2ZW50IGZyb20gdGhlIG5hdGl2ZSBldmVudCBvYmplY3QKCQkJZXZlbnQgPSBqUXVlcnkuZXZlbnQuZml4KCBldmVudCApOwoKCQkJdmFyIGksIHJldCwgaGFuZGxlT2JqLCBtYXRjaGVkLCBqLAoJCQkJaGFuZGxlclF1ZXVlID0gW10sCgkJCQlhcmdzID0gc2xpY2UuY2FsbCggYXJndW1lbnRzICksCgkJCQloYW5kbGVycyA9ICggalF1ZXJ5Ll9kYXRhKCB0aGlzLCAiZXZlbnRzIiApIHx8IHt9IClbIGV2ZW50LnR5cGUgXSB8fCBbXSwKCQkJCXNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFsgZXZlbnQudHlwZSBdIHx8IHt9OwoKCQkJLy8gVXNlIHRoZSBmaXgtZWQgalF1ZXJ5LkV2ZW50IHJhdGhlciB0aGFuIHRoZSAocmVhZC1vbmx5KSBuYXRpdmUgZXZlbnQKCQkJYXJnc1swXSA9IGV2ZW50OwoJCQlldmVudC5kZWxlZ2F0ZVRhcmdldCA9IHRoaXM7CgoJCQkvLyBDYWxsIHRoZSBwcmVEaXNwYXRjaCBob29rIGZvciB0aGUgbWFwcGVkIHR5cGUsIGFuZCBsZXQgaXQgYmFpbCBpZiBkZXNpcmVkCgkJCWlmICggc3BlY2lhbC5wcmVEaXNwYXRjaCAmJiBzcGVjaWFsLnByZURpc3BhdGNoLmNhbGwoIHRoaXMsIGV2ZW50ICkgPT09IGZhbHNlICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBEZXRlcm1pbmUgaGFuZGxlcnMKCQkJaGFuZGxlclF1ZXVlID0galF1ZXJ5LmV2ZW50LmhhbmRsZXJzLmNhbGwoIHRoaXMsIGV2ZW50LCBoYW5kbGVycyApOwoKCQkJLy8gUnVuIGRlbGVnYXRlcyBmaXJzdDsgdGhleSBtYXkgd2FudCB0byBzdG9wIHByb3BhZ2F0aW9uIGJlbmVhdGggdXMKCQkJaSA9IDA7CgkJCXdoaWxlICggKG1hdGNoZWQgPSBoYW5kbGVyUXVldWVbIGkrKyBdKSAmJiAhZXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSApIHsKCQkJCWV2ZW50LmN1cnJlbnRUYXJnZXQgPSBtYXRjaGVkLmVsZW07CgoJCQkJaiA9IDA7CgkJCQl3aGlsZSAoIChoYW5kbGVPYmogPSBtYXRjaGVkLmhhbmRsZXJzWyBqKysgXSkgJiYgIWV2ZW50LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkgKSB7CgoJCQkJCS8vIFRyaWdnZXJlZCBldmVudCBtdXN0IGVpdGhlciAxKSBoYXZlIG5vIG5hbWVzcGFjZSwgb3IKCQkJCQkvLyAyKSBoYXZlIG5hbWVzcGFjZShzKSBhIHN1YnNldCBvciBlcXVhbCB0byB0aG9zZSBpbiB0aGUgYm91bmQgZXZlbnQgKGJvdGggY2FuIGhhdmUgbm8gbmFtZXNwYWNlKS4KCQkJCQlpZiAoICFldmVudC5uYW1lc3BhY2VfcmUgfHwgZXZlbnQubmFtZXNwYWNlX3JlLnRlc3QoIGhhbmRsZU9iai5uYW1lc3BhY2UgKSApIHsKCgkJCQkJCWV2ZW50LmhhbmRsZU9iaiA9IGhhbmRsZU9iajsKCQkJCQkJZXZlbnQuZGF0YSA9IGhhbmRsZU9iai5kYXRhOwoKCQkJCQkJcmV0ID0gKCAoalF1ZXJ5LmV2ZW50LnNwZWNpYWxbIGhhbmRsZU9iai5vcmlnVHlwZSBdIHx8IHt9KS5oYW5kbGUgfHwgaGFuZGxlT2JqLmhhbmRsZXIgKQoJCQkJCQkJCS5hcHBseSggbWF0Y2hlZC5lbGVtLCBhcmdzICk7CgoJCQkJCQlpZiAoIHJldCAhPT0gdW5kZWZpbmVkICkgewoJCQkJCQkJaWYgKCAoZXZlbnQucmVzdWx0ID0gcmV0KSA9PT0gZmFsc2UgKSB7CgkJCQkJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJCQkJCQlldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJLy8gQ2FsbCB0aGUgcG9zdERpc3BhdGNoIGhvb2sgZm9yIHRoZSBtYXBwZWQgdHlwZQoJCQlpZiAoIHNwZWNpYWwucG9zdERpc3BhdGNoICkgewoJCQkJc3BlY2lhbC5wb3N0RGlzcGF0Y2guY2FsbCggdGhpcywgZXZlbnQgKTsKCQkJfQoKCQkJcmV0dXJuIGV2ZW50LnJlc3VsdDsKCQl9LAoKCQloYW5kbGVyczogZnVuY3Rpb24oIGV2ZW50LCBoYW5kbGVycyApIHsKCQkJdmFyIHNlbCwgaGFuZGxlT2JqLCBtYXRjaGVzLCBpLAoJCQkJaGFuZGxlclF1ZXVlID0gW10sCgkJCQlkZWxlZ2F0ZUNvdW50ID0gaGFuZGxlcnMuZGVsZWdhdGVDb3VudCwKCQkJCWN1ciA9IGV2ZW50LnRhcmdldDsKCgkJCS8vIEZpbmQgZGVsZWdhdGUgaGFuZGxlcnMKCQkJLy8gQmxhY2staG9sZSBTVkcgPHVzZT4gaW5zdGFuY2UgdHJlZXMgKCMxMzE4MCkKCQkJLy8gQXZvaWQgbm9uLWxlZnQtY2xpY2sgYnViYmxpbmcgaW4gRmlyZWZveCAoIzM4NjEpCgkJCWlmICggZGVsZWdhdGVDb3VudCAmJiBjdXIubm9kZVR5cGUgJiYgKCFldmVudC5idXR0b24gfHwgZXZlbnQudHlwZSAhPT0gImNsaWNrIikgKSB7CgoJCQkJLyoganNoaW50IGVxZXFlcTogZmFsc2UgKi8KCQkJCWZvciAoIDsgY3VyICE9IHRoaXM7IGN1ciA9IGN1ci5wYXJlbnROb2RlIHx8IHRoaXMgKSB7CgkJCQkJLyoganNoaW50IGVxZXFlcTogdHJ1ZSAqLwoKCQkJCQkvLyBEb24ndCBjaGVjayBub24tZWxlbWVudHMgKCMxMzIwOCkKCQkJCQkvLyBEb24ndCBwcm9jZXNzIGNsaWNrcyBvbiBkaXNhYmxlZCBlbGVtZW50cyAoIzY5MTEsICM4MTY1LCAjMTEzODIsICMxMTc2NCkKCQkJCQlpZiAoIGN1ci5ub2RlVHlwZSA9PT0gMSAmJiAoY3VyLmRpc2FibGVkICE9PSB0cnVlIHx8IGV2ZW50LnR5cGUgIT09ICJjbGljayIpICkgewoJCQkJCQltYXRjaGVzID0gW107CgkJCQkJCWZvciAoIGkgPSAwOyBpIDwgZGVsZWdhdGVDb3VudDsgaSsrICkgewoJCQkJCQkJaGFuZGxlT2JqID0gaGFuZGxlcnNbIGkgXTsKCgkJCQkJCQkvLyBEb24ndCBjb25mbGljdCB3aXRoIE9iamVjdC5wcm90b3R5cGUgcHJvcGVydGllcyAoIzEzMjAzKQoJCQkJCQkJc2VsID0gaGFuZGxlT2JqLnNlbGVjdG9yICsgIiAiOwoKCQkJCQkJCWlmICggbWF0Y2hlc1sgc2VsIF0gPT09IHVuZGVmaW5lZCApIHsKCQkJCQkJCQltYXRjaGVzWyBzZWwgXSA9IGhhbmRsZU9iai5uZWVkc0NvbnRleHQgPwoJCQkJCQkJCQlqUXVlcnkoIHNlbCwgdGhpcyApLmluZGV4KCBjdXIgKSA+PSAwIDoKCQkJCQkJCQkJalF1ZXJ5LmZpbmQoIHNlbCwgdGhpcywgbnVsbCwgWyBjdXIgXSApLmxlbmd0aDsKCQkJCQkJCX0KCQkJCQkJCWlmICggbWF0Y2hlc1sgc2VsIF0gKSB7CgkJCQkJCQkJbWF0Y2hlcy5wdXNoKCBoYW5kbGVPYmogKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQlpZiAoIG1hdGNoZXMubGVuZ3RoICkgewoJCQkJCQkJaGFuZGxlclF1ZXVlLnB1c2goeyBlbGVtOiBjdXIsIGhhbmRsZXJzOiBtYXRjaGVzIH0pOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBBZGQgdGhlIHJlbWFpbmluZyAoZGlyZWN0bHktYm91bmQpIGhhbmRsZXJzCgkJCWlmICggZGVsZWdhdGVDb3VudCA8IGhhbmRsZXJzLmxlbmd0aCApIHsKCQkJCWhhbmRsZXJRdWV1ZS5wdXNoKHsgZWxlbTogdGhpcywgaGFuZGxlcnM6IGhhbmRsZXJzLnNsaWNlKCBkZWxlZ2F0ZUNvdW50ICkgfSk7CgkJCX0KCgkJCXJldHVybiBoYW5kbGVyUXVldWU7CgkJfSwKCgkJZml4OiBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCWlmICggZXZlbnRbIGpRdWVyeS5leHBhbmRvIF0gKSB7CgkJCQlyZXR1cm4gZXZlbnQ7CgkJCX0KCgkJCS8vIENyZWF0ZSBhIHdyaXRhYmxlIGNvcHkgb2YgdGhlIGV2ZW50IG9iamVjdCBhbmQgbm9ybWFsaXplIHNvbWUgcHJvcGVydGllcwoJCQl2YXIgaSwgcHJvcCwgY29weSwKCQkJCXR5cGUgPSBldmVudC50eXBlLAoJCQkJb3JpZ2luYWxFdmVudCA9IGV2ZW50LAoJCQkJZml4SG9vayA9IHRoaXMuZml4SG9va3NbIHR5cGUgXTsKCgkJCWlmICggIWZpeEhvb2sgKSB7CgkJCQl0aGlzLmZpeEhvb2tzWyB0eXBlIF0gPSBmaXhIb29rID0KCQkJCQlybW91c2VFdmVudC50ZXN0KCB0eXBlICkgPyB0aGlzLm1vdXNlSG9va3MgOgoJCQkJCXJrZXlFdmVudC50ZXN0KCB0eXBlICkgPyB0aGlzLmtleUhvb2tzIDoKCQkJCQl7fTsKCQkJfQoJCQljb3B5ID0gZml4SG9vay5wcm9wcyA/IHRoaXMucHJvcHMuY29uY2F0KCBmaXhIb29rLnByb3BzICkgOiB0aGlzLnByb3BzOwoKCQkJZXZlbnQgPSBuZXcgalF1ZXJ5LkV2ZW50KCBvcmlnaW5hbEV2ZW50ICk7CgoJCQlpID0gY29weS5sZW5ndGg7CgkJCXdoaWxlICggaS0tICkgewoJCQkJcHJvcCA9IGNvcHlbIGkgXTsKCQkJCWV2ZW50WyBwcm9wIF0gPSBvcmlnaW5hbEV2ZW50WyBwcm9wIF07CgkJCX0KCgkJCS8vIFN1cHBvcnQ6IElFPDkKCQkJLy8gRml4IHRhcmdldCBwcm9wZXJ0eSAoIzE5MjUpCgkJCWlmICggIWV2ZW50LnRhcmdldCApIHsKCQkJCWV2ZW50LnRhcmdldCA9IG9yaWdpbmFsRXZlbnQuc3JjRWxlbWVudCB8fCBkb2N1bWVudDsKCQkJfQoKCQkJLy8gU3VwcG9ydDogQ2hyb21lIDIzKywgU2FmYXJpPwoJCQkvLyBUYXJnZXQgc2hvdWxkIG5vdCBiZSBhIHRleHQgbm9kZSAoIzUwNCwgIzEzMTQzKQoJCQlpZiAoIGV2ZW50LnRhcmdldC5ub2RlVHlwZSA9PT0gMyApIHsKCQkJCWV2ZW50LnRhcmdldCA9IGV2ZW50LnRhcmdldC5wYXJlbnROb2RlOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCS8vIEZvciBtb3VzZS9rZXkgZXZlbnRzLCBtZXRhS2V5PT1mYWxzZSBpZiBpdCdzIHVuZGVmaW5lZCAoIzMzNjgsICMxMTMyOCkKCQkJZXZlbnQubWV0YUtleSA9ICEhZXZlbnQubWV0YUtleTsKCgkJCXJldHVybiBmaXhIb29rLmZpbHRlciA/IGZpeEhvb2suZmlsdGVyKCBldmVudCwgb3JpZ2luYWxFdmVudCApIDogZXZlbnQ7CgkJfSwKCgkJLy8gSW5jbHVkZXMgc29tZSBldmVudCBwcm9wcyBzaGFyZWQgYnkgS2V5RXZlbnQgYW5kIE1vdXNlRXZlbnQKCQlwcm9wczogImFsdEtleSBidWJibGVzIGNhbmNlbGFibGUgY3RybEtleSBjdXJyZW50VGFyZ2V0IGV2ZW50UGhhc2UgbWV0YUtleSByZWxhdGVkVGFyZ2V0IHNoaWZ0S2V5IHRhcmdldCB0aW1lU3RhbXAgdmlldyB3aGljaCIuc3BsaXQoIiAiKSwKCgkJZml4SG9va3M6IHt9LAoKCQlrZXlIb29rczogewoJCQlwcm9wczogImNoYXIgY2hhckNvZGUga2V5IGtleUNvZGUiLnNwbGl0KCIgIiksCgkJCWZpbHRlcjogZnVuY3Rpb24oIGV2ZW50LCBvcmlnaW5hbCApIHsKCgkJCQkvLyBBZGQgd2hpY2ggZm9yIGtleSBldmVudHMKCQkJCWlmICggZXZlbnQud2hpY2ggPT0gbnVsbCApIHsKCQkJCQlldmVudC53aGljaCA9IG9yaWdpbmFsLmNoYXJDb2RlICE9IG51bGwgPyBvcmlnaW5hbC5jaGFyQ29kZSA6IG9yaWdpbmFsLmtleUNvZGU7CgkJCQl9CgoJCQkJcmV0dXJuIGV2ZW50OwoJCQl9CgkJfSwKCgkJbW91c2VIb29rczogewoJCQlwcm9wczogImJ1dHRvbiBidXR0b25zIGNsaWVudFggY2xpZW50WSBmcm9tRWxlbWVudCBvZmZzZXRYIG9mZnNldFkgcGFnZVggcGFnZVkgc2NyZWVuWCBzY3JlZW5ZIHRvRWxlbWVudCIuc3BsaXQoIiAiKSwKCQkJZmlsdGVyOiBmdW5jdGlvbiggZXZlbnQsIG9yaWdpbmFsICkgewoJCQkJdmFyIGJvZHksIGV2ZW50RG9jLCBkb2MsCgkJCQkJYnV0dG9uID0gb3JpZ2luYWwuYnV0dG9uLAoJCQkJCWZyb21FbGVtZW50ID0gb3JpZ2luYWwuZnJvbUVsZW1lbnQ7CgoJCQkJLy8gQ2FsY3VsYXRlIHBhZ2VYL1kgaWYgbWlzc2luZyBhbmQgY2xpZW50WC9ZIGF2YWlsYWJsZQoJCQkJaWYgKCBldmVudC5wYWdlWCA9PSBudWxsICYmIG9yaWdpbmFsLmNsaWVudFggIT0gbnVsbCApIHsKCQkJCQlldmVudERvYyA9IGV2ZW50LnRhcmdldC5vd25lckRvY3VtZW50IHx8IGRvY3VtZW50OwoJCQkJCWRvYyA9IGV2ZW50RG9jLmRvY3VtZW50RWxlbWVudDsKCQkJCQlib2R5ID0gZXZlbnREb2MuYm9keTsKCgkJCQkJZXZlbnQucGFnZVggPSBvcmlnaW5hbC5jbGllbnRYICsgKCBkb2MgJiYgZG9jLnNjcm9sbExlZnQgfHwgYm9keSAmJiBib2R5LnNjcm9sbExlZnQgfHwgMCApIC0gKCBkb2MgJiYgZG9jLmNsaWVudExlZnQgfHwgYm9keSAmJiBib2R5LmNsaWVudExlZnQgfHwgMCApOwoJCQkJCWV2ZW50LnBhZ2VZID0gb3JpZ2luYWwuY2xpZW50WSArICggZG9jICYmIGRvYy5zY3JvbGxUb3AgIHx8IGJvZHkgJiYgYm9keS5zY3JvbGxUb3AgIHx8IDAgKSAtICggZG9jICYmIGRvYy5jbGllbnRUb3AgIHx8IGJvZHkgJiYgYm9keS5jbGllbnRUb3AgIHx8IDAgKTsKCQkJCX0KCgkJCQkvLyBBZGQgcmVsYXRlZFRhcmdldCwgaWYgbmVjZXNzYXJ5CgkJCQlpZiAoICFldmVudC5yZWxhdGVkVGFyZ2V0ICYmIGZyb21FbGVtZW50ICkgewoJCQkJCWV2ZW50LnJlbGF0ZWRUYXJnZXQgPSBmcm9tRWxlbWVudCA9PT0gZXZlbnQudGFyZ2V0ID8gb3JpZ2luYWwudG9FbGVtZW50IDogZnJvbUVsZW1lbnQ7CgkJCQl9CgoJCQkJLy8gQWRkIHdoaWNoIGZvciBjbGljazogMSA9PT0gbGVmdDsgMiA9PT0gbWlkZGxlOyAzID09PSByaWdodAoJCQkJLy8gTm90ZTogYnV0dG9uIGlzIG5vdCBub3JtYWxpemVkLCBzbyBkb24ndCB1c2UgaXQKCQkJCWlmICggIWV2ZW50LndoaWNoICYmIGJ1dHRvbiAhPT0gdW5kZWZpbmVkICkgewoJCQkJCWV2ZW50LndoaWNoID0gKCBidXR0b24gJiAxID8gMSA6ICggYnV0dG9uICYgMiA/IDMgOiAoIGJ1dHRvbiAmIDQgPyAyIDogMCApICkgKTsKCQkJCX0KCgkJCQlyZXR1cm4gZXZlbnQ7CgkJCX0KCQl9LAoKCQlzcGVjaWFsOiB7CgkJCWxvYWQ6IHsKCQkJCS8vIFByZXZlbnQgdHJpZ2dlcmVkIGltYWdlLmxvYWQgZXZlbnRzIGZyb20gYnViYmxpbmcgdG8gd2luZG93LmxvYWQKCQkJCW5vQnViYmxlOiB0cnVlCgkJCX0sCgkJCWZvY3VzOiB7CgkJCQkvLyBGaXJlIG5hdGl2ZSBldmVudCBpZiBwb3NzaWJsZSBzbyBibHVyL2ZvY3VzIHNlcXVlbmNlIGlzIGNvcnJlY3QKCQkJCXRyaWdnZXI6IGZ1bmN0aW9uKCkgewoJCQkJCWlmICggdGhpcyAhPT0gc2FmZUFjdGl2ZUVsZW1lbnQoKSAmJiB0aGlzLmZvY3VzICkgewoJCQkJCQl0cnkgewoJCQkJCQkJdGhpcy5mb2N1cygpOwoJCQkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJCQl9IGNhdGNoICggZSApIHsKCQkJCQkJCS8vIFN1cHBvcnQ6IElFPDkKCQkJCQkJCS8vIElmIHdlIGVycm9yIG9uIGZvY3VzIHRvIGhpZGRlbiBlbGVtZW50ICgjMTQ4NiwgIzEyNTE4KSwKCQkJCQkJCS8vIGxldCAudHJpZ2dlcigpIHJ1biB0aGUgaGFuZGxlcnMKCQkJCQkJfQoJCQkJCX0KCQkJCX0sCgkJCQlkZWxlZ2F0ZVR5cGU6ICJmb2N1c2luIgoJCQl9LAoJCQlibHVyOiB7CgkJCQl0cmlnZ2VyOiBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIHRoaXMgPT09IHNhZmVBY3RpdmVFbGVtZW50KCkgJiYgdGhpcy5ibHVyICkgewoJCQkJCQl0aGlzLmJsdXIoKTsKCQkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJCX0KCQkJCX0sCgkJCQlkZWxlZ2F0ZVR5cGU6ICJmb2N1c291dCIKCQkJfSwKCQkJY2xpY2s6IHsKCQkJCS8vIEZvciBjaGVja2JveCwgZmlyZSBuYXRpdmUgZXZlbnQgc28gY2hlY2tlZCBzdGF0ZSB3aWxsIGJlIHJpZ2h0CgkJCQl0cmlnZ2VyOiBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIGpRdWVyeS5ub2RlTmFtZSggdGhpcywgImlucHV0IiApICYmIHRoaXMudHlwZSA9PT0gImNoZWNrYm94IiAmJiB0aGlzLmNsaWNrICkgewoJCQkJCQl0aGlzLmNsaWNrKCk7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9LAoKCQkJCS8vIEZvciBjcm9zcy1icm93c2VyIGNvbnNpc3RlbmN5LCBkb24ndCBmaXJlIG5hdGl2ZSAuY2xpY2soKSBvbiBsaW5rcwoJCQkJX2RlZmF1bHQ6IGZ1bmN0aW9uKCBldmVudCApIHsKCQkJCQlyZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKCBldmVudC50YXJnZXQsICJhIiApOwoJCQkJfQoJCQl9LAoKCQkJYmVmb3JldW5sb2FkOiB7CgkJCQlwb3N0RGlzcGF0Y2g6IGZ1bmN0aW9uKCBldmVudCApIHsKCgkJCQkJLy8gU3VwcG9ydDogRmlyZWZveCAyMCsKCQkJCQkvLyBGaXJlZm94IGRvZXNuJ3QgYWxlcnQgaWYgdGhlIHJldHVyblZhbHVlIGZpZWxkIGlzIG5vdCBzZXQuCgkJCQkJaWYgKCBldmVudC5yZXN1bHQgIT09IHVuZGVmaW5lZCAmJiBldmVudC5vcmlnaW5hbEV2ZW50ICkgewoJCQkJCQlldmVudC5vcmlnaW5hbEV2ZW50LnJldHVyblZhbHVlID0gZXZlbnQucmVzdWx0OwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0sCgoJCXNpbXVsYXRlOiBmdW5jdGlvbiggdHlwZSwgZWxlbSwgZXZlbnQsIGJ1YmJsZSApIHsKCQkJLy8gUGlnZ3liYWNrIG9uIGEgZG9ub3IgZXZlbnQgdG8gc2ltdWxhdGUgYSBkaWZmZXJlbnQgb25lLgoJCQkvLyBGYWtlIG9yaWdpbmFsRXZlbnQgdG8gYXZvaWQgZG9ub3IncyBzdG9wUHJvcGFnYXRpb24sIGJ1dCBpZiB0aGUKCQkJLy8gc2ltdWxhdGVkIGV2ZW50IHByZXZlbnRzIGRlZmF1bHQgdGhlbiB3ZSBkbyB0aGUgc2FtZSBvbiB0aGUgZG9ub3IuCgkJCXZhciBlID0galF1ZXJ5LmV4dGVuZCgKCQkJCW5ldyBqUXVlcnkuRXZlbnQoKSwKCQkJCWV2ZW50LAoJCQkJewoJCQkJCXR5cGU6IHR5cGUsCgkJCQkJaXNTaW11bGF0ZWQ6IHRydWUsCgkJCQkJb3JpZ2luYWxFdmVudDoge30KCQkJCX0KCQkJKTsKCQkJaWYgKCBidWJibGUgKSB7CgkJCQlqUXVlcnkuZXZlbnQudHJpZ2dlciggZSwgbnVsbCwgZWxlbSApOwoJCQl9IGVsc2UgewoJCQkJalF1ZXJ5LmV2ZW50LmRpc3BhdGNoLmNhbGwoIGVsZW0sIGUgKTsKCQkJfQoJCQlpZiAoIGUuaXNEZWZhdWx0UHJldmVudGVkKCkgKSB7CgkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQl9CgkJfQoJfTsKCglqUXVlcnkucmVtb3ZlRXZlbnQgPSBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyID8KCQlmdW5jdGlvbiggZWxlbSwgdHlwZSwgaGFuZGxlICkgewoJCQlpZiAoIGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lciApIHsKCQkJCWVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lciggdHlwZSwgaGFuZGxlLCBmYWxzZSApOwoJCQl9CgkJfSA6CgkJZnVuY3Rpb24oIGVsZW0sIHR5cGUsIGhhbmRsZSApIHsKCQkJdmFyIG5hbWUgPSAib24iICsgdHlwZTsKCgkJCWlmICggZWxlbS5kZXRhY2hFdmVudCApIHsKCgkJCQkvLyAjODU0NSwgIzcwNTQsIHByZXZlbnRpbmcgbWVtb3J5IGxlYWtzIGZvciBjdXN0b20gZXZlbnRzIGluIElFNi04CgkJCQkvLyBkZXRhY2hFdmVudCBuZWVkZWQgcHJvcGVydHkgb24gZWxlbWVudCwgYnkgbmFtZSBvZiB0aGF0IGV2ZW50LCB0byBwcm9wZXJseSBleHBvc2UgaXQgdG8gR0MKCQkJCWlmICggdHlwZW9mIGVsZW1bIG5hbWUgXSA9PT0gc3RydW5kZWZpbmVkICkgewoJCQkJCWVsZW1bIG5hbWUgXSA9IG51bGw7CgkJCQl9CgoJCQkJZWxlbS5kZXRhY2hFdmVudCggbmFtZSwgaGFuZGxlICk7CgkJCX0KCQl9OwoKCWpRdWVyeS5FdmVudCA9IGZ1bmN0aW9uKCBzcmMsIHByb3BzICkgewoJCS8vIEFsbG93IGluc3RhbnRpYXRpb24gd2l0aG91dCB0aGUgJ25ldycga2V5d29yZAoJCWlmICggISh0aGlzIGluc3RhbmNlb2YgalF1ZXJ5LkV2ZW50KSApIHsKCQkJcmV0dXJuIG5ldyBqUXVlcnkuRXZlbnQoIHNyYywgcHJvcHMgKTsKCQl9CgoJCS8vIEV2ZW50IG9iamVjdAoJCWlmICggc3JjICYmIHNyYy50eXBlICkgewoJCQl0aGlzLm9yaWdpbmFsRXZlbnQgPSBzcmM7CgkJCXRoaXMudHlwZSA9IHNyYy50eXBlOwoKCQkJLy8gRXZlbnRzIGJ1YmJsaW5nIHVwIHRoZSBkb2N1bWVudCBtYXkgaGF2ZSBiZWVuIG1hcmtlZCBhcyBwcmV2ZW50ZWQKCQkJLy8gYnkgYSBoYW5kbGVyIGxvd2VyIGRvd24gdGhlIHRyZWU7IHJlZmxlY3QgdGhlIGNvcnJlY3QgdmFsdWUuCgkJCXRoaXMuaXNEZWZhdWx0UHJldmVudGVkID0gc3JjLmRlZmF1bHRQcmV2ZW50ZWQgfHwKCQkJCQlzcmMuZGVmYXVsdFByZXZlbnRlZCA9PT0gdW5kZWZpbmVkICYmCgkJCQkJLy8gU3VwcG9ydDogSUUgPCA5LCBBbmRyb2lkIDwgNC4wCgkJCQkJc3JjLnJldHVyblZhbHVlID09PSBmYWxzZSA/CgkJCQlyZXR1cm5UcnVlIDoKCQkJCXJldHVybkZhbHNlOwoKCQkvLyBFdmVudCB0eXBlCgkJfSBlbHNlIHsKCQkJdGhpcy50eXBlID0gc3JjOwoJCX0KCgkJLy8gUHV0IGV4cGxpY2l0bHkgcHJvdmlkZWQgcHJvcGVydGllcyBvbnRvIHRoZSBldmVudCBvYmplY3QKCQlpZiAoIHByb3BzICkgewoJCQlqUXVlcnkuZXh0ZW5kKCB0aGlzLCBwcm9wcyApOwoJCX0KCgkJLy8gQ3JlYXRlIGEgdGltZXN0YW1wIGlmIGluY29taW5nIGV2ZW50IGRvZXNuJ3QgaGF2ZSBvbmUKCQl0aGlzLnRpbWVTdGFtcCA9IHNyYyAmJiBzcmMudGltZVN0YW1wIHx8IGpRdWVyeS5ub3coKTsKCgkJLy8gTWFyayBpdCBhcyBmaXhlZAoJCXRoaXNbIGpRdWVyeS5leHBhbmRvIF0gPSB0cnVlOwoJfTsKCgkvLyBqUXVlcnkuRXZlbnQgaXMgYmFzZWQgb24gRE9NMyBFdmVudHMgYXMgc3BlY2lmaWVkIGJ5IHRoZSBFQ01BU2NyaXB0IExhbmd1YWdlIEJpbmRpbmcKCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDMvV0QtRE9NLUxldmVsLTMtRXZlbnRzLTIwMDMwMzMxL2VjbWEtc2NyaXB0LWJpbmRpbmcuaHRtbAoJalF1ZXJ5LkV2ZW50LnByb3RvdHlwZSA9IHsKCQlpc0RlZmF1bHRQcmV2ZW50ZWQ6IHJldHVybkZhbHNlLAoJCWlzUHJvcGFnYXRpb25TdG9wcGVkOiByZXR1cm5GYWxzZSwKCQlpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDogcmV0dXJuRmFsc2UsCgoJCXByZXZlbnREZWZhdWx0OiBmdW5jdGlvbigpIHsKCQkJdmFyIGUgPSB0aGlzLm9yaWdpbmFsRXZlbnQ7CgoJCQl0aGlzLmlzRGVmYXVsdFByZXZlbnRlZCA9IHJldHVyblRydWU7CgkJCWlmICggIWUgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIElmIHByZXZlbnREZWZhdWx0IGV4aXN0cywgcnVuIGl0IG9uIHRoZSBvcmlnaW5hbCBldmVudAoJCQlpZiAoIGUucHJldmVudERlZmF1bHQgKSB7CgkJCQllLnByZXZlbnREZWZhdWx0KCk7CgoJCQkvLyBTdXBwb3J0OiBJRQoJCQkvLyBPdGhlcndpc2Ugc2V0IHRoZSByZXR1cm5WYWx1ZSBwcm9wZXJ0eSBvZiB0aGUgb3JpZ2luYWwgZXZlbnQgdG8gZmFsc2UKCQkJfSBlbHNlIHsKCQkJCWUucmV0dXJuVmFsdWUgPSBmYWxzZTsKCQkJfQoJCX0sCgkJc3RvcFByb3BhZ2F0aW9uOiBmdW5jdGlvbigpIHsKCQkJdmFyIGUgPSB0aGlzLm9yaWdpbmFsRXZlbnQ7CgoJCQl0aGlzLmlzUHJvcGFnYXRpb25TdG9wcGVkID0gcmV0dXJuVHJ1ZTsKCQkJaWYgKCAhZSApIHsKCQkJCXJldHVybjsKCQkJfQoJCQkvLyBJZiBzdG9wUHJvcGFnYXRpb24gZXhpc3RzLCBydW4gaXQgb24gdGhlIG9yaWdpbmFsIGV2ZW50CgkJCWlmICggZS5zdG9wUHJvcGFnYXRpb24gKSB7CgkJCQllLnN0b3BQcm9wYWdhdGlvbigpOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRQoJCQkvLyBTZXQgdGhlIGNhbmNlbEJ1YmJsZSBwcm9wZXJ0eSBvZiB0aGUgb3JpZ2luYWwgZXZlbnQgdG8gdHJ1ZQoJCQllLmNhbmNlbEJ1YmJsZSA9IHRydWU7CgkJfSwKCQlzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246IGZ1bmN0aW9uKCkgewoJCQl2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsKCgkJCXRoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSByZXR1cm5UcnVlOwoKCQkJaWYgKCBlICYmIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uICkgewoJCQkJZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTsKCQkJfQoKCQkJdGhpcy5zdG9wUHJvcGFnYXRpb24oKTsKCQl9Cgl9OwoKCS8vIENyZWF0ZSBtb3VzZWVudGVyL2xlYXZlIGV2ZW50cyB1c2luZyBtb3VzZW92ZXIvb3V0IGFuZCBldmVudC10aW1lIGNoZWNrcwoJalF1ZXJ5LmVhY2goewoJCW1vdXNlZW50ZXI6ICJtb3VzZW92ZXIiLAoJCW1vdXNlbGVhdmU6ICJtb3VzZW91dCIsCgkJcG9pbnRlcmVudGVyOiAicG9pbnRlcm92ZXIiLAoJCXBvaW50ZXJsZWF2ZTogInBvaW50ZXJvdXQiCgl9LCBmdW5jdGlvbiggb3JpZywgZml4ICkgewoJCWpRdWVyeS5ldmVudC5zcGVjaWFsWyBvcmlnIF0gPSB7CgkJCWRlbGVnYXRlVHlwZTogZml4LAoJCQliaW5kVHlwZTogZml4LAoKCQkJaGFuZGxlOiBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQl2YXIgcmV0LAoJCQkJCXRhcmdldCA9IHRoaXMsCgkJCQkJcmVsYXRlZCA9IGV2ZW50LnJlbGF0ZWRUYXJnZXQsCgkJCQkJaGFuZGxlT2JqID0gZXZlbnQuaGFuZGxlT2JqOwoKCQkJCS8vIEZvciBtb3VzZW50ZXIvbGVhdmUgY2FsbCB0aGUgaGFuZGxlciBpZiByZWxhdGVkIGlzIG91dHNpZGUgdGhlIHRhcmdldC4KCQkJCS8vIE5COiBObyByZWxhdGVkVGFyZ2V0IGlmIHRoZSBtb3VzZSBsZWZ0L2VudGVyZWQgdGhlIGJyb3dzZXIgd2luZG93CgkJCQlpZiAoICFyZWxhdGVkIHx8IChyZWxhdGVkICE9PSB0YXJnZXQgJiYgIWpRdWVyeS5jb250YWlucyggdGFyZ2V0LCByZWxhdGVkICkpICkgewoJCQkJCWV2ZW50LnR5cGUgPSBoYW5kbGVPYmoub3JpZ1R5cGU7CgkJCQkJcmV0ID0gaGFuZGxlT2JqLmhhbmRsZXIuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOwoJCQkJCWV2ZW50LnR5cGUgPSBmaXg7CgkJCQl9CgkJCQlyZXR1cm4gcmV0OwoJCQl9CgkJfTsKCX0pOwoKCS8vIElFIHN1Ym1pdCBkZWxlZ2F0aW9uCglpZiAoICFzdXBwb3J0LnN1Ym1pdEJ1YmJsZXMgKSB7CgoJCWpRdWVyeS5ldmVudC5zcGVjaWFsLnN1Ym1pdCA9IHsKCQkJc2V0dXA6IGZ1bmN0aW9uKCkgewoJCQkJLy8gT25seSBuZWVkIHRoaXMgZm9yIGRlbGVnYXRlZCBmb3JtIHN1Ym1pdCBldmVudHMKCQkJCWlmICggalF1ZXJ5Lm5vZGVOYW1lKCB0aGlzLCAiZm9ybSIgKSApIHsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgoJCQkJLy8gTGF6eS1hZGQgYSBzdWJtaXQgaGFuZGxlciB3aGVuIGEgZGVzY2VuZGFudCBmb3JtIG1heSBwb3RlbnRpYWxseSBiZSBzdWJtaXR0ZWQKCQkJCWpRdWVyeS5ldmVudC5hZGQoIHRoaXMsICJjbGljay5fc3VibWl0IGtleXByZXNzLl9zdWJtaXQiLCBmdW5jdGlvbiggZSApIHsKCQkJCQkvLyBOb2RlIG5hbWUgY2hlY2sgYXZvaWRzIGEgVk1MLXJlbGF0ZWQgY3Jhc2ggaW4gSUUgKCM5ODA3KQoJCQkJCXZhciBlbGVtID0gZS50YXJnZXQsCgkJCQkJCWZvcm0gPSBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJpbnB1dCIgKSB8fCBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJidXR0b24iICkgPyBlbGVtLmZvcm0gOiB1bmRlZmluZWQ7CgkJCQkJaWYgKCBmb3JtICYmICFqUXVlcnkuX2RhdGEoIGZvcm0sICJzdWJtaXRCdWJibGVzIiApICkgewoJCQkJCQlqUXVlcnkuZXZlbnQuYWRkKCBmb3JtLCAic3VibWl0Ll9zdWJtaXQiLCBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQkJCQlldmVudC5fc3VibWl0X2J1YmJsZSA9IHRydWU7CgkJCQkJCX0pOwoJCQkJCQlqUXVlcnkuX2RhdGEoIGZvcm0sICJzdWJtaXRCdWJibGVzIiwgdHJ1ZSApOwoJCQkJCX0KCQkJCX0pOwoJCQkJLy8gcmV0dXJuIHVuZGVmaW5lZCBzaW5jZSB3ZSBkb24ndCBuZWVkIGFuIGV2ZW50IGxpc3RlbmVyCgkJCX0sCgoJCQlwb3N0RGlzcGF0Y2g6IGZ1bmN0aW9uKCBldmVudCApIHsKCQkJCS8vIElmIGZvcm0gd2FzIHN1Ym1pdHRlZCBieSB0aGUgdXNlciwgYnViYmxlIHRoZSBldmVudCB1cCB0aGUgdHJlZQoJCQkJaWYgKCBldmVudC5fc3VibWl0X2J1YmJsZSApIHsKCQkJCQlkZWxldGUgZXZlbnQuX3N1Ym1pdF9idWJibGU7CgkJCQkJaWYgKCB0aGlzLnBhcmVudE5vZGUgJiYgIWV2ZW50LmlzVHJpZ2dlciApIHsKCQkJCQkJalF1ZXJ5LmV2ZW50LnNpbXVsYXRlKCAic3VibWl0IiwgdGhpcy5wYXJlbnROb2RlLCBldmVudCwgdHJ1ZSApOwoJCQkJCX0KCQkJCX0KCQkJfSwKCgkJCXRlYXJkb3duOiBmdW5jdGlvbigpIHsKCQkJCS8vIE9ubHkgbmVlZCB0aGlzIGZvciBkZWxlZ2F0ZWQgZm9ybSBzdWJtaXQgZXZlbnRzCgkJCQlpZiAoIGpRdWVyeS5ub2RlTmFtZSggdGhpcywgImZvcm0iICkgKSB7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoKCQkJCS8vIFJlbW92ZSBkZWxlZ2F0ZWQgaGFuZGxlcnM7IGNsZWFuRGF0YSBldmVudHVhbGx5IHJlYXBzIHN1Ym1pdCBoYW5kbGVycyBhdHRhY2hlZCBhYm92ZQoJCQkJalF1ZXJ5LmV2ZW50LnJlbW92ZSggdGhpcywgIi5fc3VibWl0IiApOwoJCQl9CgkJfTsKCX0KCgkvLyBJRSBjaGFuZ2UgZGVsZWdhdGlvbiBhbmQgY2hlY2tib3gvcmFkaW8gZml4CglpZiAoICFzdXBwb3J0LmNoYW5nZUJ1YmJsZXMgKSB7CgoJCWpRdWVyeS5ldmVudC5zcGVjaWFsLmNoYW5nZSA9IHsKCgkJCXNldHVwOiBmdW5jdGlvbigpIHsKCgkJCQlpZiAoIHJmb3JtRWxlbXMudGVzdCggdGhpcy5ub2RlTmFtZSApICkgewoJCQkJCS8vIElFIGRvZXNuJ3QgZmlyZSBjaGFuZ2Ugb24gYSBjaGVjay9yYWRpbyB1bnRpbCBibHVyOyB0cmlnZ2VyIGl0IG9uIGNsaWNrCgkJCQkJLy8gYWZ0ZXIgYSBwcm9wZXJ0eWNoYW5nZS4gRWF0IHRoZSBibHVyLWNoYW5nZSBpbiBzcGVjaWFsLmNoYW5nZS5oYW5kbGUuCgkJCQkJLy8gVGhpcyBzdGlsbCBmaXJlcyBvbmNoYW5nZSBhIHNlY29uZCB0aW1lIGZvciBjaGVjay9yYWRpbyBhZnRlciBibHVyLgoJCQkJCWlmICggdGhpcy50eXBlID09PSAiY2hlY2tib3giIHx8IHRoaXMudHlwZSA9PT0gInJhZGlvIiApIHsKCQkJCQkJalF1ZXJ5LmV2ZW50LmFkZCggdGhpcywgInByb3BlcnR5Y2hhbmdlLl9jaGFuZ2UiLCBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQkJCQlpZiAoIGV2ZW50Lm9yaWdpbmFsRXZlbnQucHJvcGVydHlOYW1lID09PSAiY2hlY2tlZCIgKSB7CgkJCQkJCQkJdGhpcy5fanVzdF9jaGFuZ2VkID0gdHJ1ZTsKCQkJCQkJCX0KCQkJCQkJfSk7CgkJCQkJCWpRdWVyeS5ldmVudC5hZGQoIHRoaXMsICJjbGljay5fY2hhbmdlIiwgZnVuY3Rpb24oIGV2ZW50ICkgewoJCQkJCQkJaWYgKCB0aGlzLl9qdXN0X2NoYW5nZWQgJiYgIWV2ZW50LmlzVHJpZ2dlciApIHsKCQkJCQkJCQl0aGlzLl9qdXN0X2NoYW5nZWQgPSBmYWxzZTsKCQkJCQkJCX0KCQkJCQkJCS8vIEFsbG93IHRyaWdnZXJlZCwgc2ltdWxhdGVkIGNoYW5nZSBldmVudHMgKCMxMTUwMCkKCQkJCQkJCWpRdWVyeS5ldmVudC5zaW11bGF0ZSggImNoYW5nZSIsIHRoaXMsIGV2ZW50LCB0cnVlICk7CgkJCQkJCX0pOwoJCQkJCX0KCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCQkvLyBEZWxlZ2F0ZWQgZXZlbnQ7IGxhenktYWRkIGEgY2hhbmdlIGhhbmRsZXIgb24gZGVzY2VuZGFudCBpbnB1dHMKCQkJCWpRdWVyeS5ldmVudC5hZGQoIHRoaXMsICJiZWZvcmVhY3RpdmF0ZS5fY2hhbmdlIiwgZnVuY3Rpb24oIGUgKSB7CgkJCQkJdmFyIGVsZW0gPSBlLnRhcmdldDsKCgkJCQkJaWYgKCByZm9ybUVsZW1zLnRlc3QoIGVsZW0ubm9kZU5hbWUgKSAmJiAhalF1ZXJ5Ll9kYXRhKCBlbGVtLCAiY2hhbmdlQnViYmxlcyIgKSApIHsKCQkJCQkJalF1ZXJ5LmV2ZW50LmFkZCggZWxlbSwgImNoYW5nZS5fY2hhbmdlIiwgZnVuY3Rpb24oIGV2ZW50ICkgewoJCQkJCQkJaWYgKCB0aGlzLnBhcmVudE5vZGUgJiYgIWV2ZW50LmlzU2ltdWxhdGVkICYmICFldmVudC5pc1RyaWdnZXIgKSB7CgkJCQkJCQkJalF1ZXJ5LmV2ZW50LnNpbXVsYXRlKCAiY2hhbmdlIiwgdGhpcy5wYXJlbnROb2RlLCBldmVudCwgdHJ1ZSApOwoJCQkJCQkJfQoJCQkJCQl9KTsKCQkJCQkJalF1ZXJ5Ll9kYXRhKCBlbGVtLCAiY2hhbmdlQnViYmxlcyIsIHRydWUgKTsKCQkJCQl9CgkJCQl9KTsKCQkJfSwKCgkJCWhhbmRsZTogZnVuY3Rpb24oIGV2ZW50ICkgewoJCQkJdmFyIGVsZW0gPSBldmVudC50YXJnZXQ7CgoJCQkJLy8gU3dhbGxvdyBuYXRpdmUgY2hhbmdlIGV2ZW50cyBmcm9tIGNoZWNrYm94L3JhZGlvLCB3ZSBhbHJlYWR5IHRyaWdnZXJlZCB0aGVtIGFib3ZlCgkJCQlpZiAoIHRoaXMgIT09IGVsZW0gfHwgZXZlbnQuaXNTaW11bGF0ZWQgfHwgZXZlbnQuaXNUcmlnZ2VyIHx8IChlbGVtLnR5cGUgIT09ICJyYWRpbyIgJiYgZWxlbS50eXBlICE9PSAiY2hlY2tib3giKSApIHsKCQkJCQlyZXR1cm4gZXZlbnQuaGFuZGxlT2JqLmhhbmRsZXIuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOwoJCQkJfQoJCQl9LAoKCQkJdGVhcmRvd246IGZ1bmN0aW9uKCkgewoJCQkJalF1ZXJ5LmV2ZW50LnJlbW92ZSggdGhpcywgIi5fY2hhbmdlIiApOwoKCQkJCXJldHVybiAhcmZvcm1FbGVtcy50ZXN0KCB0aGlzLm5vZGVOYW1lICk7CgkJCX0KCQl9OwoJfQoKCS8vIENyZWF0ZSAiYnViYmxpbmciIGZvY3VzIGFuZCBibHVyIGV2ZW50cwoJaWYgKCAhc3VwcG9ydC5mb2N1c2luQnViYmxlcyApIHsKCQlqUXVlcnkuZWFjaCh7IGZvY3VzOiAiZm9jdQ==", "base64"));
  res.write(new Buffer("c2luIiwgYmx1cjogImZvY3Vzb3V0IiB9LCBmdW5jdGlvbiggb3JpZywgZml4ICkgewoKCQkJLy8gQXR0YWNoIGEgc2luZ2xlIGNhcHR1cmluZyBoYW5kbGVyIG9uIHRoZSBkb2N1bWVudCB3aGlsZSBzb21lb25lIHdhbnRzIGZvY3VzaW4vZm9jdXNvdXQKCQkJdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQkJalF1ZXJ5LmV2ZW50LnNpbXVsYXRlKCBmaXgsIGV2ZW50LnRhcmdldCwgalF1ZXJ5LmV2ZW50LmZpeCggZXZlbnQgKSwgdHJ1ZSApOwoJCQkJfTsKCgkJCWpRdWVyeS5ldmVudC5zcGVjaWFsWyBmaXggXSA9IHsKCQkJCXNldHVwOiBmdW5jdGlvbigpIHsKCQkJCQl2YXIgZG9jID0gdGhpcy5vd25lckRvY3VtZW50IHx8IHRoaXMsCgkJCQkJCWF0dGFjaGVzID0galF1ZXJ5Ll9kYXRhKCBkb2MsIGZpeCApOwoKCQkJCQlpZiAoICFhdHRhY2hlcyApIHsKCQkJCQkJZG9jLmFkZEV2ZW50TGlzdGVuZXIoIG9yaWcsIGhhbmRsZXIsIHRydWUgKTsKCQkJCQl9CgkJCQkJalF1ZXJ5Ll9kYXRhKCBkb2MsIGZpeCwgKCBhdHRhY2hlcyB8fCAwICkgKyAxICk7CgkJCQl9LAoJCQkJdGVhcmRvd246IGZ1bmN0aW9uKCkgewoJCQkJCXZhciBkb2MgPSB0aGlzLm93bmVyRG9jdW1lbnQgfHwgdGhpcywKCQkJCQkJYXR0YWNoZXMgPSBqUXVlcnkuX2RhdGEoIGRvYywgZml4ICkgLSAxOwoKCQkJCQlpZiAoICFhdHRhY2hlcyApIHsKCQkJCQkJZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoIG9yaWcsIGhhbmRsZXIsIHRydWUgKTsKCQkJCQkJalF1ZXJ5Ll9yZW1vdmVEYXRhKCBkb2MsIGZpeCApOwoJCQkJCX0gZWxzZSB7CgkJCQkJCWpRdWVyeS5fZGF0YSggZG9jLCBmaXgsIGF0dGFjaGVzICk7CgkJCQkJfQoJCQkJfQoJCQl9OwoJCX0pOwoJfQoKCWpRdWVyeS5mbi5leHRlbmQoewoKCQlvbjogZnVuY3Rpb24oIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4sIC8qSU5URVJOQUwqLyBvbmUgKSB7CgkJCXZhciB0eXBlLCBvcmlnRm47CgoJCQkvLyBUeXBlcyBjYW4gYmUgYSBtYXAgb2YgdHlwZXMvaGFuZGxlcnMKCQkJaWYgKCB0eXBlb2YgdHlwZXMgPT09ICJvYmplY3QiICkgewoJCQkJLy8gKCB0eXBlcy1PYmplY3QsIHNlbGVjdG9yLCBkYXRhICkKCQkJCWlmICggdHlwZW9mIHNlbGVjdG9yICE9PSAic3RyaW5nIiApIHsKCQkJCQkvLyAoIHR5cGVzLU9iamVjdCwgZGF0YSApCgkJCQkJZGF0YSA9IGRhdGEgfHwgc2VsZWN0b3I7CgkJCQkJc2VsZWN0b3IgPSB1bmRlZmluZWQ7CgkJCQl9CgkJCQlmb3IgKCB0eXBlIGluIHR5cGVzICkgewoJCQkJCXRoaXMub24oIHR5cGUsIHNlbGVjdG9yLCBkYXRhLCB0eXBlc1sgdHlwZSBdLCBvbmUgKTsKCQkJCX0KCQkJCXJldHVybiB0aGlzOwoJCQl9CgoJCQlpZiAoIGRhdGEgPT0gbnVsbCAmJiBmbiA9PSBudWxsICkgewoJCQkJLy8gKCB0eXBlcywgZm4gKQoJCQkJZm4gPSBzZWxlY3RvcjsKCQkJCWRhdGEgPSBzZWxlY3RvciA9IHVuZGVmaW5lZDsKCQkJfSBlbHNlIGlmICggZm4gPT0gbnVsbCApIHsKCQkJCWlmICggdHlwZW9mIHNlbGVjdG9yID09PSAic3RyaW5nIiApIHsKCQkJCQkvLyAoIHR5cGVzLCBzZWxlY3RvciwgZm4gKQoJCQkJCWZuID0gZGF0YTsKCQkJCQlkYXRhID0gdW5kZWZpbmVkOwoJCQkJfSBlbHNlIHsKCQkJCQkvLyAoIHR5cGVzLCBkYXRhLCBmbiApCgkJCQkJZm4gPSBkYXRhOwoJCQkJCWRhdGEgPSBzZWxlY3RvcjsKCQkJCQlzZWxlY3RvciA9IHVuZGVmaW5lZDsKCQkJCX0KCQkJfQoJCQlpZiAoIGZuID09PSBmYWxzZSApIHsKCQkJCWZuID0gcmV0dXJuRmFsc2U7CgkJCX0gZWxzZSBpZiAoICFmbiApIHsKCQkJCXJldHVybiB0aGlzOwoJCQl9CgoJCQlpZiAoIG9uZSA9PT0gMSApIHsKCQkJCW9yaWdGbiA9IGZuOwoJCQkJZm4gPSBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQkJLy8gQ2FuIHVzZSBhbiBlbXB0eSBzZXQsIHNpbmNlIGV2ZW50IGNvbnRhaW5zIHRoZSBpbmZvCgkJCQkJalF1ZXJ5KCkub2ZmKCBldmVudCApOwoJCQkJCXJldHVybiBvcmlnRm4uYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOwoJCQkJfTsKCQkJCS8vIFVzZSBzYW1lIGd1aWQgc28gY2FsbGVyIGNhbiByZW1vdmUgdXNpbmcgb3JpZ0ZuCgkJCQlmbi5ndWlkID0gb3JpZ0ZuLmd1aWQgfHwgKCBvcmlnRm4uZ3VpZCA9IGpRdWVyeS5ndWlkKysgKTsKCQkJfQoJCQlyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsKCQkJCWpRdWVyeS5ldmVudC5hZGQoIHRoaXMsIHR5cGVzLCBmbiwgZGF0YSwgc2VsZWN0b3IgKTsKCQkJfSk7CgkJfSwKCQlvbmU6IGZ1bmN0aW9uKCB0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuICkgewoJCQlyZXR1cm4gdGhpcy5vbiggdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiwgMSApOwoJCX0sCgkJb2ZmOiBmdW5jdGlvbiggdHlwZXMsIHNlbGVjdG9yLCBmbiApIHsKCQkJdmFyIGhhbmRsZU9iaiwgdHlwZTsKCQkJaWYgKCB0eXBlcyAmJiB0eXBlcy5wcmV2ZW50RGVmYXVsdCAmJiB0eXBlcy5oYW5kbGVPYmogKSB7CgkJCQkvLyAoIGV2ZW50ICkgIGRpc3BhdGNoZWQgalF1ZXJ5LkV2ZW50CgkJCQloYW5kbGVPYmogPSB0eXBlcy5oYW5kbGVPYmo7CgkJCQlqUXVlcnkoIHR5cGVzLmRlbGVnYXRlVGFyZ2V0ICkub2ZmKAoJCQkJCWhhbmRsZU9iai5uYW1lc3BhY2UgPyBoYW5kbGVPYmoub3JpZ1R5cGUgKyAiLiIgKyBoYW5kbGVPYmoubmFtZXNwYWNlIDogaGFuZGxlT2JqLm9yaWdUeXBlLAoJCQkJCWhhbmRsZU9iai5zZWxlY3RvciwKCQkJCQloYW5kbGVPYmouaGFuZGxlcgoJCQkJKTsKCQkJCXJldHVybiB0aGlzOwoJCQl9CgkJCWlmICggdHlwZW9mIHR5cGVzID09PSAib2JqZWN0IiApIHsKCQkJCS8vICggdHlwZXMtb2JqZWN0IFssIHNlbGVjdG9yXSApCgkJCQlmb3IgKCB0eXBlIGluIHR5cGVzICkgewoJCQkJCXRoaXMub2ZmKCB0eXBlLCBzZWxlY3RvciwgdHlwZXNbIHR5cGUgXSApOwoJCQkJfQoJCQkJcmV0dXJuIHRoaXM7CgkJCX0KCQkJaWYgKCBzZWxlY3RvciA9PT0gZmFsc2UgfHwgdHlwZW9mIHNlbGVjdG9yID09PSAiZnVuY3Rpb24iICkgewoJCQkJLy8gKCB0eXBlcyBbLCBmbl0gKQoJCQkJZm4gPSBzZWxlY3RvcjsKCQkJCXNlbGVjdG9yID0gdW5kZWZpbmVkOwoJCQl9CgkJCWlmICggZm4gPT09IGZhbHNlICkgewoJCQkJZm4gPSByZXR1cm5GYWxzZTsKCQkJfQoJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJalF1ZXJ5LmV2ZW50LnJlbW92ZSggdGhpcywgdHlwZXMsIGZuLCBzZWxlY3RvciApOwoJCQl9KTsKCQl9LAoKCQl0cmlnZ2VyOiBmdW5jdGlvbiggdHlwZSwgZGF0YSApIHsKCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQkJCWpRdWVyeS5ldmVudC50cmlnZ2VyKCB0eXBlLCBkYXRhLCB0aGlzICk7CgkJCX0pOwoJCX0sCgkJdHJpZ2dlckhhbmRsZXI6IGZ1bmN0aW9uKCB0eXBlLCBkYXRhICkgewoJCQl2YXIgZWxlbSA9IHRoaXNbMF07CgkJCWlmICggZWxlbSApIHsKCQkJCXJldHVybiBqUXVlcnkuZXZlbnQudHJpZ2dlciggdHlwZSwgZGF0YSwgZWxlbSwgdHJ1ZSApOwoJCQl9CgkJfQoJfSk7CgoKCWZ1bmN0aW9uIGNyZWF0ZVNhZmVGcmFnbWVudCggZG9jdW1lbnQgKSB7CgkJdmFyIGxpc3QgPSBub2RlTmFtZXMuc3BsaXQoICJ8IiApLAoJCQlzYWZlRnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTsKCgkJaWYgKCBzYWZlRnJhZy5jcmVhdGVFbGVtZW50ICkgewoJCQl3aGlsZSAoIGxpc3QubGVuZ3RoICkgewoJCQkJc2FmZUZyYWcuY3JlYXRlRWxlbWVudCgKCQkJCQlsaXN0LnBvcCgpCgkJCQkpOwoJCQl9CgkJfQoJCXJldHVybiBzYWZlRnJhZzsKCX0KCgl2YXIgbm9kZU5hbWVzID0gImFiYnJ8YXJ0aWNsZXxhc2lkZXxhdWRpb3xiZGl8Y2FudmFzfGRhdGF8ZGF0YWxpc3R8ZGV0YWlsc3xmaWdjYXB0aW9ufGZpZ3VyZXxmb290ZXJ8IiArCgkJCSJoZWFkZXJ8aGdyb3VwfG1hcmt8bWV0ZXJ8bmF2fG91dHB1dHxwcm9ncmVzc3xzZWN0aW9ufHN1bW1hcnl8dGltZXx2aWRlbyIsCgkJcmlubGluZWpRdWVyeSA9IC8galF1ZXJ5XGQrPSIoPzpudWxsfFxkKykiL2csCgkJcm5vc2hpbWNhY2hlID0gbmV3IFJlZ0V4cCgiPCg/OiIgKyBub2RlTmFtZXMgKyAiKVtcXHMvPl0iLCAiaSIpLAoJCXJsZWFkaW5nV2hpdGVzcGFjZSA9IC9eXHMrLywKCQlyeGh0bWxUYWcgPSAvPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1ldGF8cGFyYW0pKChbXHc6XSspW14+XSopXC8+L2dpLAoJCXJ0YWdOYW1lID0gLzwoW1x3Ol0rKS8sCgkJcnRib2R5ID0gLzx0Ym9keS9pLAoJCXJodG1sID0gLzx8JiM/XHcrOy8sCgkJcm5vSW5uZXJodG1sID0gLzwoPzpzY3JpcHR8c3R5bGV8bGluaykvaSwKCQkvLyBjaGVja2VkPSJjaGVja2VkIiBvciBjaGVja2VkCgkJcmNoZWNrZWQgPSAvY2hlY2tlZFxzKig/OltePV18PVxzKi5jaGVja2VkLikvaSwKCQlyc2NyaXB0VHlwZSA9IC9eJHxcLyg/OmphdmF8ZWNtYSlzY3JpcHQvaSwKCQlyc2NyaXB0VHlwZU1hc2tlZCA9IC9edHJ1ZVwvKC4qKS8sCgkJcmNsZWFuU2NyaXB0ID0gL15ccyo8ISg/OlxbQ0RBVEFcW3wtLSl8KD86XF1cXXwtLSk+XHMqJC9nLAoKCQkvLyBXZSBoYXZlIHRvIGNsb3NlIHRoZXNlIHRhZ3MgdG8gc3VwcG9ydCBYSFRNTCAoIzEzMjAwKQoJCXdyYXBNYXAgPSB7CgkJCW9wdGlvbjogWyAxLCAiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPiIsICI8L3NlbGVjdD4iIF0sCgkJCWxlZ2VuZDogWyAxLCAiPGZpZWxkc2V0PiIsICI8L2ZpZWxkc2V0PiIgXSwKCQkJYXJlYTogWyAxLCAiPG1hcD4iLCAiPC9tYXA+IiBdLAoJCQlwYXJhbTogWyAxLCAiPG9iamVjdD4iLCAiPC9vYmplY3Q+IiBdLAoJCQl0aGVhZDogWyAxLCAiPHRhYmxlPiIsICI8L3RhYmxlPiIgXSwKCQkJdHI6IFsgMiwgIjx0YWJsZT48dGJvZHk+IiwgIjwvdGJvZHk+PC90YWJsZT4iIF0sCgkJCWNvbDogWyAyLCAiPHRhYmxlPjx0Ym9keT48L3Rib2R5Pjxjb2xncm91cD4iLCAiPC9jb2xncm91cD48L3RhYmxlPiIgXSwKCQkJdGQ6IFsgMywgIjx0YWJsZT48dGJvZHk+PHRyPiIsICI8L3RyPjwvdGJvZHk+PC90YWJsZT4iIF0sCgoJCQkvLyBJRTYtOCBjYW4ndCBzZXJpYWxpemUgbGluaywgc2NyaXB0LCBzdHlsZSwgb3IgYW55IGh0bWw1IChOb1Njb3BlKSB0YWdzLAoJCQkvLyB1bmxlc3Mgd3JhcHBlZCBpbiBhIGRpdiB3aXRoIG5vbi1icmVha2luZyBjaGFyYWN0ZXJzIGluIGZyb250IG9mIGl0LgoJCQlfZGVmYXVsdDogc3VwcG9ydC5odG1sU2VyaWFsaXplID8gWyAwLCAiIiwgIiIgXSA6IFsgMSwgIlg8ZGl2PiIsICI8L2Rpdj4iICBdCgkJfSwKCQlzYWZlRnJhZ21lbnQgPSBjcmVhdGVTYWZlRnJhZ21lbnQoIGRvY3VtZW50ICksCgkJZnJhZ21lbnREaXYgPSBzYWZlRnJhZ21lbnQuYXBwZW5kQ2hpbGQoIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpICk7CgoJd3JhcE1hcC5vcHRncm91cCA9IHdyYXBNYXAub3B0aW9uOwoJd3JhcE1hcC50Ym9keSA9IHdyYXBNYXAudGZvb3QgPSB3cmFwTWFwLmNvbGdyb3VwID0gd3JhcE1hcC5jYXB0aW9uID0gd3JhcE1hcC50aGVhZDsKCXdyYXBNYXAudGggPSB3cmFwTWFwLnRkOwoKCWZ1bmN0aW9uIGdldEFsbCggY29udGV4dCwgdGFnICkgewoJCXZhciBlbGVtcywgZWxlbSwKCQkJaSA9IDAsCgkJCWZvdW5kID0gdHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgIT09IHN0cnVuZGVmaW5lZCA/IGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIHRhZyB8fCAiKiIgKSA6CgkJCQl0eXBlb2YgY29udGV4dC5xdWVyeVNlbGVjdG9yQWxsICE9PSBzdHJ1bmRlZmluZWQgPyBjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoIHRhZyB8fCAiKiIgKSA6CgkJCQl1bmRlZmluZWQ7CgoJCWlmICggIWZvdW5kICkgewoJCQlmb3IgKCBmb3VuZCA9IFtdLCBlbGVtcyA9IGNvbnRleHQuY2hpbGROb2RlcyB8fCBjb250ZXh0OyAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKysgKSB7CgkJCQlpZiAoICF0YWcgfHwgalF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCB0YWcgKSApIHsKCQkJCQlmb3VuZC5wdXNoKCBlbGVtICk7CgkJCQl9IGVsc2UgewoJCQkJCWpRdWVyeS5tZXJnZSggZm91bmQsIGdldEFsbCggZWxlbSwgdGFnICkgKTsKCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIHRhZyA9PT0gdW5kZWZpbmVkIHx8IHRhZyAmJiBqUXVlcnkubm9kZU5hbWUoIGNvbnRleHQsIHRhZyApID8KCQkJalF1ZXJ5Lm1lcmdlKCBbIGNvbnRleHQgXSwgZm91bmQgKSA6CgkJCWZvdW5kOwoJfQoKCS8vIFVzZWQgaW4gYnVpbGRGcmFnbWVudCwgZml4ZXMgdGhlIGRlZmF1bHRDaGVja2VkIHByb3BlcnR5CglmdW5jdGlvbiBmaXhEZWZhdWx0Q2hlY2tlZCggZWxlbSApIHsKCQlpZiAoIHJjaGVja2FibGVUeXBlLnRlc3QoIGVsZW0udHlwZSApICkgewoJCQllbGVtLmRlZmF1bHRDaGVja2VkID0gZWxlbS5jaGVja2VkOwoJCX0KCX0KCgkvLyBTdXBwb3J0OiBJRTw4CgkvLyBNYW5pcHVsYXRpbmcgdGFibGVzIHJlcXVpcmVzIGEgdGJvZHkKCWZ1bmN0aW9uIG1hbmlwdWxhdGlvblRhcmdldCggZWxlbSwgY29udGVudCApIHsKCQlyZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCAidGFibGUiICkgJiYKCQkJalF1ZXJ5Lm5vZGVOYW1lKCBjb250ZW50Lm5vZGVUeXBlICE9PSAxMSA/IGNvbnRlbnQgOiBjb250ZW50LmZpcnN0Q2hpbGQsICJ0ciIgKSA/CgoJCQllbGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpWzBdIHx8CgkJCQllbGVtLmFwcGVuZENoaWxkKCBlbGVtLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGJvZHkiKSApIDoKCQkJZWxlbTsKCX0KCgkvLyBSZXBsYWNlL3Jlc3RvcmUgdGhlIHR5cGUgYXR0cmlidXRlIG9mIHNjcmlwdCBlbGVtZW50cyBmb3Igc2FmZSBET00gbWFuaXB1bGF0aW9uCglmdW5jdGlvbiBkaXNhYmxlU2NyaXB0KCBlbGVtICkgewoJCWVsZW0udHlwZSA9IChqUXVlcnkuZmluZC5hdHRyKCBlbGVtLCAidHlwZSIgKSAhPT0gbnVsbCkgKyAiLyIgKyBlbGVtLnR5cGU7CgkJcmV0dXJuIGVsZW07Cgl9CglmdW5jdGlvbiByZXN0b3JlU2NyaXB0KCBlbGVtICkgewoJCXZhciBtYXRjaCA9IHJzY3JpcHRUeXBlTWFza2VkLmV4ZWMoIGVsZW0udHlwZSApOwoJCWlmICggbWF0Y2ggKSB7CgkJCWVsZW0udHlwZSA9IG1hdGNoWzFdOwoJCX0gZWxzZSB7CgkJCWVsZW0ucmVtb3ZlQXR0cmlidXRlKCJ0eXBlIik7CgkJfQoJCXJldHVybiBlbGVtOwoJfQoKCS8vIE1hcmsgc2NyaXB0cyBhcyBoYXZpbmcgYWxyZWFkeSBiZWVuIGV2YWx1YXRlZAoJZnVuY3Rpb24gc2V0R2xvYmFsRXZhbCggZWxlbXMsIHJlZkVsZW1lbnRzICkgewoJCXZhciBlbGVtLAoJCQlpID0gMDsKCQlmb3IgKCA7IChlbGVtID0gZWxlbXNbaV0pICE9IG51bGw7IGkrKyApIHsKCQkJalF1ZXJ5Ll9kYXRhKCBlbGVtLCAiZ2xvYmFsRXZhbCIsICFyZWZFbGVtZW50cyB8fCBqUXVlcnkuX2RhdGEoIHJlZkVsZW1lbnRzW2ldLCAiZ2xvYmFsRXZhbCIgKSApOwoJCX0KCX0KCglmdW5jdGlvbiBjbG9uZUNvcHlFdmVudCggc3JjLCBkZXN0ICkgewoKCQlpZiAoIGRlc3Qubm9kZVR5cGUgIT09IDEgfHwgIWpRdWVyeS5oYXNEYXRhKCBzcmMgKSApIHsKCQkJcmV0dXJuOwoJCX0KCgkJdmFyIHR5cGUsIGksIGwsCgkJCW9sZERhdGEgPSBqUXVlcnkuX2RhdGEoIHNyYyApLAoJCQljdXJEYXRhID0galF1ZXJ5Ll9kYXRhKCBkZXN0LCBvbGREYXRhICksCgkJCWV2ZW50cyA9IG9sZERhdGEuZXZlbnRzOwoKCQlpZiAoIGV2ZW50cyApIHsKCQkJZGVsZXRlIGN1ckRhdGEuaGFuZGxlOwoJCQljdXJEYXRhLmV2ZW50cyA9IHt9OwoKCQkJZm9yICggdHlwZSBpbiBldmVudHMgKSB7CgkJCQlmb3IgKCBpID0gMCwgbCA9IGV2ZW50c1sgdHlwZSBdLmxlbmd0aDsgaSA8IGw7IGkrKyApIHsKCQkJCQlqUXVlcnkuZXZlbnQuYWRkKCBkZXN0LCB0eXBlLCBldmVudHNbIHR5cGUgXVsgaSBdICk7CgkJCQl9CgkJCX0KCQl9CgoJCS8vIG1ha2UgdGhlIGNsb25lZCBwdWJsaWMgZGF0YSBvYmplY3QgYSBjb3B5IGZyb20gdGhlIG9yaWdpbmFsCgkJaWYgKCBjdXJEYXRhLmRhdGEgKSB7CgkJCWN1ckRhdGEuZGF0YSA9IGpRdWVyeS5leHRlbmQoIHt9LCBjdXJEYXRhLmRhdGEgKTsKCQl9Cgl9CgoJZnVuY3Rpb24gZml4Q2xvbmVOb2RlSXNzdWVzKCBzcmMsIGRlc3QgKSB7CgkJdmFyIG5vZGVOYW1lLCBlLCBkYXRhOwoKCQkvLyBXZSBkbyBub3QgbmVlZCB0byBkbyBhbnl0aGluZyBmb3Igbm9uLUVsZW1lbnRzCgkJaWYgKCBkZXN0Lm5vZGVUeXBlICE9PSAxICkgewoJCQlyZXR1cm47CgkJfQoKCQlub2RlTmFtZSA9IGRlc3Qubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCgkJLy8gSUU2LTggY29waWVzIGV2ZW50cyBib3VuZCB2aWEgYXR0YWNoRXZlbnQgd2hlbiB1c2luZyBjbG9uZU5vZGUuCgkJaWYgKCAhc3VwcG9ydC5ub0Nsb25lRXZlbnQgJiYgZGVzdFsgalF1ZXJ5LmV4cGFuZG8gXSApIHsKCQkJZGF0YSA9IGpRdWVyeS5fZGF0YSggZGVzdCApOwoKCQkJZm9yICggZSBpbiBkYXRhLmV2ZW50cyApIHsKCQkJCWpRdWVyeS5yZW1vdmVFdmVudCggZGVzdCwgZSwgZGF0YS5oYW5kbGUgKTsKCQkJfQoKCQkJLy8gRXZlbnQgZGF0YSBnZXRzIHJlZmVyZW5jZWQgaW5zdGVhZCBvZiBjb3BpZWQgaWYgdGhlIGV4cGFuZG8gZ2V0cyBjb3BpZWQgdG9vCgkJCWRlc3QucmVtb3ZlQXR0cmlidXRlKCBqUXVlcnkuZXhwYW5kbyApOwoJCX0KCgkJLy8gSUUgYmxhbmtzIGNvbnRlbnRzIHdoZW4gY2xvbmluZyBzY3JpcHRzLCBhbmQgdHJpZXMgdG8gZXZhbHVhdGUgbmV3bHktc2V0IHRleHQKCQlpZiAoIG5vZGVOYW1lID09PSAic2NyaXB0IiAmJiBkZXN0LnRleHQgIT09IHNyYy50ZXh0ICkgewoJCQlkaXNhYmxlU2NyaXB0KCBkZXN0ICkudGV4dCA9IHNyYy50ZXh0OwoJCQlyZXN0b3JlU2NyaXB0KCBkZXN0ICk7CgoJCS8vIElFNi0xMCBpbXByb3Blcmx5IGNsb25lcyBjaGlsZHJlbiBvZiBvYmplY3QgZWxlbWVudHMgdXNpbmcgY2xhc3NpZC4KCQkvLyBJRTEwIHRocm93cyBOb01vZGlmaWNhdGlvbkFsbG93ZWRFcnJvciBpZiBwYXJlbnQgaXMgbnVsbCwgIzEyMTMyLgoJCX0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSAib2JqZWN0IiApIHsKCQkJaWYgKCBkZXN0LnBhcmVudE5vZGUgKSB7CgkJCQlkZXN0Lm91dGVySFRNTCA9IHNyYy5vdXRlckhUTUw7CgkJCX0KCgkJCS8vIFRoaXMgcGF0aCBhcHBlYXJzIHVuYXZvaWRhYmxlIGZvciBJRTkuIFdoZW4gY2xvbmluZyBhbiBvYmplY3QKCQkJLy8gZWxlbWVudCBpbiBJRTksIHRoZSBvdXRlckhUTUwgc3RyYXRlZ3kgYWJvdmUgaXMgbm90IHN1ZmZpY2llbnQuCgkJCS8vIElmIHRoZSBzcmMgaGFzIGlubmVySFRNTCBhbmQgdGhlIGRlc3RpbmF0aW9uIGRvZXMgbm90LAoJCQkvLyBjb3B5IHRoZSBzcmMuaW5uZXJIVE1MIGludG8gdGhlIGRlc3QuaW5uZXJIVE1MLiAjMTAzMjQKCQkJaWYgKCBzdXBwb3J0Lmh0bWw1Q2xvbmUgJiYgKCBzcmMuaW5uZXJIVE1MICYmICFqUXVlcnkudHJpbShkZXN0LmlubmVySFRNTCkgKSApIHsKCQkJCWRlc3QuaW5uZXJIVE1MID0gc3JjLmlubmVySFRNTDsKCQkJfQoKCQl9IGVsc2UgaWYgKCBub2RlTmFtZSA9PT0gImlucHV0IiAmJiByY2hlY2thYmxlVHlwZS50ZXN0KCBzcmMudHlwZSApICkgewoJCQkvLyBJRTYtOCBmYWlscyB0byBwZXJzaXN0IHRoZSBjaGVja2VkIHN0YXRlIG9mIGEgY2xvbmVkIGNoZWNrYm94CgkJCS8vIG9yIHJhZGlvIGJ1dHRvbi4gV29yc2UsIElFNi03IGZhaWwgdG8gZ2l2ZSB0aGUgY2xvbmVkIGVsZW1lbnQKCQkJLy8gYSBjaGVja2VkIGFwcGVhcmFuY2UgaWYgdGhlIGRlZmF1bHRDaGVja2VkIHZhbHVlIGlzbid0IGFsc28gc2V0CgoJCQlkZXN0LmRlZmF1bHRDaGVja2VkID0gZGVzdC5jaGVja2VkID0gc3JjLmNoZWNrZWQ7CgoJCQkvLyBJRTYtNyBnZXQgY29uZnVzZWQgYW5kIGVuZCB1cCBzZXR0aW5nIHRoZSB2YWx1ZSBvZiBhIGNsb25lZAoJCQkvLyBjaGVja2JveC9yYWRpbyBidXR0b24gdG8gYW4gZW1wdHkgc3RyaW5nIGluc3RlYWQgb2YgIm9uIgoJCQlpZiAoIGRlc3QudmFsdWUgIT09IHNyYy52YWx1ZSApIHsKCQkJCWRlc3QudmFsdWUgPSBzcmMudmFsdWU7CgkJCX0KCgkJLy8gSUU2LTggZmFpbHMgdG8gcmV0dXJuIHRoZSBzZWxlY3RlZCBvcHRpb24gdG8gdGhlIGRlZmF1bHQgc2VsZWN0ZWQKCQkvLyBzdGF0ZSB3aGVuIGNsb25pbmcgb3B0aW9ucwoJCX0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSAib3B0aW9uIiApIHsKCQkJZGVzdC5kZWZhdWx0U2VsZWN0ZWQgPSBkZXN0LnNlbGVjdGVkID0gc3JjLmRlZmF1bHRTZWxlY3RlZDsKCgkJLy8gSUU2LTggZmFpbHMgdG8gc2V0IHRoZSBkZWZhdWx0VmFsdWUgdG8gdGhlIGNvcnJlY3QgdmFsdWUgd2hlbgoJCS8vIGNsb25pbmcgb3RoZXIgdHlwZXMgb2YgaW5wdXQgZmllbGRzCgkJfSBlbHNlIGlmICggbm9kZU5hbWUgPT09ICJpbnB1dCIgfHwgbm9kZU5hbWUgPT09ICJ0ZXh0YXJlYSIgKSB7CgkJCWRlc3QuZGVmYXVsdFZhbHVlID0gc3JjLmRlZmF1bHRWYWx1ZTsKCQl9Cgl9CgoJalF1ZXJ5LmV4dGVuZCh7CgkJY2xvbmU6IGZ1bmN0aW9uKCBlbGVtLCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cyApIHsKCQkJdmFyIGRlc3RFbGVtZW50cywgbm9kZSwgY2xvbmUsIGksIHNyY0VsZW1lbnRzLAoJCQkJaW5QYWdlID0galF1ZXJ5LmNvbnRhaW5zKCBlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0gKTsKCgkJCWlmICggc3VwcG9ydC5odG1sNUNsb25lIHx8IGpRdWVyeS5pc1hNTERvYyhlbGVtKSB8fCAhcm5vc2hpbWNhY2hlLnRlc3QoICI8IiArIGVsZW0ubm9kZU5hbWUgKyAiPiIgKSApIHsKCQkJCWNsb25lID0gZWxlbS5jbG9uZU5vZGUoIHRydWUgKTsKCgkJCS8vIElFPD04IGRvZXMgbm90IHByb3Blcmx5IGNsb25lIGRldGFjaGVkLCB1bmtub3duIGVsZW1lbnQgbm9kZXMKCQkJfSBlbHNlIHsKCQkJCWZyYWdtZW50RGl2LmlubmVySFRNTCA9IGVsZW0ub3V0ZXJIVE1MOwoJCQkJZnJhZ21lbnREaXYucmVtb3ZlQ2hpbGQoIGNsb25lID0gZnJhZ21lbnREaXYuZmlyc3RDaGlsZCApOwoJCQl9CgoJCQlpZiAoICghc3VwcG9ydC5ub0Nsb25lRXZlbnQgfHwgIXN1cHBvcnQubm9DbG9uZUNoZWNrZWQpICYmCgkJCQkJKGVsZW0ubm9kZVR5cGUgPT09IDEgfHwgZWxlbS5ub2RlVHlwZSA9PT0gMTEpICYmICFqUXVlcnkuaXNYTUxEb2MoZWxlbSkgKSB7CgoJCQkJLy8gV2UgZXNjaGV3IFNpenpsZSBoZXJlIGZvciBwZXJmb3JtYW5jZSByZWFzb25zOiBodHRwOi8vanNwZXJmLmNvbS9nZXRhbGwtdnMtc2l6emxlLzIKCQkJCWRlc3RFbGVtZW50cyA9IGdldEFsbCggY2xvbmUgKTsKCQkJCXNyY0VsZW1lbnRzID0gZ2V0QWxsKCBlbGVtICk7CgoJCQkJLy8gRml4IGFsbCBJRSBjbG9uaW5nIGlzc3VlcwoJCQkJZm9yICggaSA9IDA7IChub2RlID0gc3JjRWxlbWVudHNbaV0pICE9IG51bGw7ICsraSApIHsKCQkJCQkvLyBFbnN1cmUgdGhhdCB0aGUgZGVzdGluYXRpb24gbm9kZSBpcyBub3QgbnVsbDsgRml4ZXMgIzk1ODcKCQkJCQlpZiAoIGRlc3RFbGVtZW50c1tpXSApIHsKCQkJCQkJZml4Q2xvbmVOb2RlSXNzdWVzKCBub2RlLCBkZXN0RWxlbWVudHNbaV0gKTsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCS8vIENvcHkgdGhlIGV2ZW50cyBmcm9tIHRoZSBvcmlnaW5hbCB0byB0aGUgY2xvbmUKCQkJaWYgKCBkYXRhQW5kRXZlbnRzICkgewoJCQkJaWYgKCBkZWVwRGF0YUFuZEV2ZW50cyApIHsKCQkJCQlzcmNFbGVtZW50cyA9IHNyY0VsZW1lbnRzIHx8IGdldEFsbCggZWxlbSApOwoJCQkJCWRlc3RFbGVtZW50cyA9IGRlc3RFbGVtZW50cyB8fCBnZXRBbGwoIGNsb25lICk7CgoJCQkJCWZvciAoIGkgPSAwOyAobm9kZSA9IHNyY0VsZW1lbnRzW2ldKSAhPSBudWxsOyBpKysgKSB7CgkJCQkJCWNsb25lQ29weUV2ZW50KCBub2RlLCBkZXN0RWxlbWVudHNbaV0gKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCWNsb25lQ29weUV2ZW50KCBlbGVtLCBjbG9uZSApOwoJCQkJfQoJCQl9CgoJCQkvLyBQcmVzZXJ2ZSBzY3JpcHQgZXZhbHVhdGlvbiBoaXN0b3J5CgkJCWRlc3RFbGVtZW50cyA9IGdldEFsbCggY2xvbmUsICJzY3JpcHQiICk7CgkJCWlmICggZGVzdEVsZW1lbnRzLmxlbmd0aCA+IDAgKSB7CgkJCQlzZXRHbG9iYWxFdmFsKCBkZXN0RWxlbWVudHMsICFpblBhZ2UgJiYgZ2V0QWxsKCBlbGVtLCAic2NyaXB0IiApICk7CgkJCX0KCgkJCWRlc3RFbGVtZW50cyA9IHNyY0VsZW1lbnRzID0gbm9kZSA9IG51bGw7CgoJCQkvLyBSZXR1cm4gdGhlIGNsb25lZCBzZXQKCQkJcmV0dXJuIGNsb25lOwoJCX0sCgoJCWJ1aWxkRnJhZ21lbnQ6IGZ1bmN0aW9uKCBlbGVtcywgY29udGV4dCwgc2NyaXB0cywgc2VsZWN0aW9uICkgewoJCQl2YXIgaiwgZWxlbSwgY29udGFpbnMsCgkJCQl0bXAsIHRhZywgdGJvZHksIHdyYXAsCgkJCQlsID0gZWxlbXMubGVuZ3RoLAoKCQkJCS8vIEVuc3VyZSBhIHNhZmUgZnJhZ21lbnQKCQkJCXNhZmUgPSBjcmVhdGVTYWZlRnJhZ21lbnQoIGNvbnRleHQgKSwKCgkJCQlub2RlcyA9IFtdLAoJCQkJaSA9IDA7CgoJCQlmb3IgKCA7IGkgPCBsOyBpKysgKSB7CgkJCQllbGVtID0gZWxlbXNbIGkgXTsKCgkJCQlpZiAoIGVsZW0gfHwgZWxlbSA9PT0gMCApIHsKCgkJCQkJLy8gQWRkIG5vZGVzIGRpcmVjdGx5CgkJCQkJaWYgKCBqUXVlcnkudHlwZSggZWxlbSApID09PSAib2JqZWN0IiApIHsKCQkJCQkJalF1ZXJ5Lm1lcmdlKCBub2RlcywgZWxlbS5ub2RlVHlwZSA/IFsgZWxlbSBdIDogZWxlbSApOwoKCQkJCQkvLyBDb252ZXJ0IG5vbi1odG1sIGludG8gYSB0ZXh0IG5vZGUKCQkJCQl9IGVsc2UgaWYgKCAhcmh0bWwudGVzdCggZWxlbSApICkgewoJCQkJCQlub2Rlcy5wdXNoKCBjb250ZXh0LmNyZWF0ZVRleHROb2RlKCBlbGVtICkgKTsKCgkJCQkJLy8gQ29udmVydCBodG1sIGludG8gRE9NIG5vZGVzCgkJCQkJfSBlbHNlIHsKCQkJCQkJdG1wID0gdG1wIHx8IHNhZmUuYXBwZW5kQ2hpbGQoIGNvbnRleHQuY3JlYXRlRWxlbWVudCgiZGl2IikgKTsKCgkJCQkJCS8vIERlc2VyaWFsaXplIGEgc3RhbmRhcmQgcmVwcmVzZW50YXRpb24KCQkJCQkJdGFnID0gKHJ0YWdOYW1lLmV4ZWMoIGVsZW0gKSB8fCBbICIiLCAiIiBdKVsgMSBdLnRvTG93ZXJDYXNlKCk7CgkJCQkJCXdyYXAgPSB3cmFwTWFwWyB0YWcgXSB8fCB3cmFwTWFwLl9kZWZhdWx0OwoKCQkJCQkJdG1wLmlubmVySFRNTCA9IHdyYXBbMV0gKyBlbGVtLnJlcGxhY2UoIHJ4aHRtbFRhZywgIjwkMT48LyQyPiIgKSArIHdyYXBbMl07CgoJCQkJCQkvLyBEZXNjZW5kIHRocm91Z2ggd3JhcHBlcnMgdG8gdGhlIHJpZ2h0IGNvbnRlbnQKCQkJCQkJaiA9IHdyYXBbMF07CgkJCQkJCXdoaWxlICggai0tICkgewoJCQkJCQkJdG1wID0gdG1wLmxhc3RDaGlsZDsKCQkJCQkJfQoKCQkJCQkJLy8gTWFudWFsbHkgYWRkIGxlYWRpbmcgd2hpdGVzcGFjZSByZW1vdmVkIGJ5IElFCgkJCQkJCWlmICggIXN1cHBvcnQubGVhZGluZ1doaXRlc3BhY2UgJiYgcmxlYWRpbmdXaGl0ZXNwYWNlLnRlc3QoIGVsZW0gKSApIHsKCQkJCQkJCW5vZGVzLnB1c2goIGNvbnRleHQuY3JlYXRlVGV4dE5vZGUoIHJsZWFkaW5nV2hpdGVzcGFjZS5leGVjKCBlbGVtIClbMF0gKSApOwoJCQkJCQl9CgoJCQkJCQkvLyBSZW1vdmUgSUUncyBhdXRvaW5zZXJ0ZWQgPHRib2R5PiBmcm9tIHRhYmxlIGZyYWdtZW50cwoJCQkJCQlpZiAoICFzdXBwb3J0LnRib2R5ICkgewoKCQkJCQkJCS8vIFN0cmluZyB3YXMgYSA8dGFibGU+LCAqbWF5KiBoYXZlIHNwdXJpb3VzIDx0Ym9keT4KCQkJCQkJCWVsZW0gPSB0YWcgPT09ICJ0YWJsZSIgJiYgIXJ0Ym9keS50ZXN0KCBlbGVtICkgPwoJCQkJCQkJCXRtcC5maXJzdENoaWxkIDoKCgkJCQkJCQkJLy8gU3RyaW5nIHdhcyBhIGJhcmUgPHRoZWFkPiBvciA8dGZvb3Q+CgkJCQkJCQkJd3JhcFsxXSA9PT0gIjx0YWJsZT4iICYmICFydGJvZHkudGVzdCggZWxlbSApID8KCQkJCQkJCQkJdG1wIDoKCQkJCQkJCQkJMDsKCgkJCQkJCQlqID0gZWxlbSAmJiBlbGVtLmNoaWxkTm9kZXMubGVuZ3RoOwoJCQkJCQkJd2hpbGUgKCBqLS0gKSB7CgkJCQkJCQkJaWYgKCBqUXVlcnkubm9kZU5hbWUoICh0Ym9keSA9IGVsZW0uY2hpbGROb2Rlc1tqXSksICJ0Ym9keSIgKSAmJiAhdGJvZHkuY2hpbGROb2Rlcy5sZW5ndGggKSB7CgkJCQkJCQkJCWVsZW0ucmVtb3ZlQ2hpbGQoIHRib2R5ICk7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgoJCQkJCQlqUXVlcnkubWVyZ2UoIG5vZGVzLCB0bXAuY2hpbGROb2RlcyApOwoKCQkJCQkJLy8gRml4ICMxMjM5MiBmb3IgV2ViS2l0IGFuZCBJRSA+IDkKCQkJCQkJdG1wLnRleHRDb250ZW50ID0gIiI7CgoJCQkJCQkvLyBGaXggIzEyMzkyIGZvciBvbGRJRQoJCQkJCQl3aGlsZSAoIHRtcC5maXJzdENoaWxkICkgewoJCQkJCQkJdG1wLnJlbW92ZUNoaWxkKCB0bXAuZmlyc3RDaGlsZCApOwoJCQkJCQl9CgoJCQkJCQkvLyBSZW1lbWJlciB0aGUgdG9wLWxldmVsIGNvbnRhaW5lciBmb3IgcHJvcGVyIGNsZWFudXAKCQkJCQkJdG1wID0gc2FmZS5sYXN0Q2hpbGQ7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBGaXggIzExMzU2OiBDbGVhciBlbGVtZW50cyBmcm9tIGZyYWdtZW50CgkJCWlmICggdG1wICkgewoJCQkJc2FmZS5yZW1vdmVDaGlsZCggdG1wICk7CgkJCX0KCgkJCS8vIFJlc2V0IGRlZmF1bHRDaGVja2VkIGZvciBhbnkgcmFkaW9zIGFuZCBjaGVja2JveGVzCgkJCS8vIGFib3V0IHRvIGJlIGFwcGVuZGVkIHRvIHRoZSBET00gaW4gSUUgNi83ICgjODA2MCkKCQkJaWYgKCAhc3VwcG9ydC5hcHBlbmRDaGVja2VkICkgewoJCQkJalF1ZXJ5LmdyZXAoIGdldEFsbCggbm9kZXMsICJpbnB1dCIgKSwgZml4RGVmYXVsdENoZWNrZWQgKTsKCQkJfQoKCQkJaSA9IDA7CgkJCXdoaWxlICggKGVsZW0gPSBub2Rlc1sgaSsrIF0pICkgewoKCQkJCS8vICM0MDg3IC0gSWYgb3JpZ2luIGFuZCBkZXN0aW5hdGlvbiBlbGVtZW50cyBhcmUgdGhlIHNhbWUsIGFuZCB0aGlzIGlzCgkJCQkvLyB0aGF0IGVsZW1lbnQsIGRvIG5vdCBkbyBhbnl0aGluZwoJCQkJaWYgKCBzZWxlY3Rpb24gJiYgalF1ZXJ5LmluQXJyYXkoIGVsZW0sIHNlbGVjdGlvbiApICE9PSAtMSApIHsKCQkJCQljb250aW51ZTsKCQkJCX0KCgkJCQljb250YWlucyA9IGpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICk7CgoJCQkJLy8gQXBwZW5kIHRvIGZyYWdtZW50CgkJCQl0bXAgPSBnZXRBbGwoIHNhZmUuYXBwZW5kQ2hpbGQoIGVsZW0gKSwgInNjcmlwdCIgKTsKCgkJCQkvLyBQcmVzZXJ2ZSBzY3JpcHQgZXZhbHVhdGlvbiBoaXN0b3J5CgkJCQlpZiAoIGNvbnRhaW5zICkgewoJCQkJCXNldEdsb2JhbEV2YWwoIHRtcCApOwoJCQkJfQoKCQkJCS8vIENhcHR1cmUgZXhlY3V0YWJsZXMKCQkJCWlmICggc2NyaXB0cyApIHsKCQkJCQlqID0gMDsKCQkJCQl3aGlsZSAoIChlbGVtID0gdG1wWyBqKysgXSkgKSB7CgkJCQkJCWlmICggcnNjcmlwdFR5cGUudGVzdCggZWxlbS50eXBlIHx8ICIiICkgKSB7CgkJCQkJCQlzY3JpcHRzLnB1c2goIGVsZW0gKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJdG1wID0gbnVsbDsKCgkJCXJldHVybiBzYWZlOwoJCX0sCgoJCWNsZWFuRGF0YTogZnVuY3Rpb24oIGVsZW1zLCAvKiBpbnRlcm5hbCAqLyBhY2NlcHREYXRhICkgewoJCQl2YXIgZWxlbSwgdHlwZSwgaWQsIGRhdGEsCgkJCQlpID0gMCwKCQkJCWludGVybmFsS2V5ID0galF1ZXJ5LmV4cGFuZG8sCgkJCQljYWNoZSA9IGpRdWVyeS5jYWNoZSwKCQkJCWRlbGV0ZUV4cGFuZG8gPSBzdXBwb3J0LmRlbGV0ZUV4cGFuZG8sCgkJCQlzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWw7CgoJCQlmb3IgKCA7IChlbGVtID0gZWxlbXNbaV0pICE9IG51bGw7IGkrKyApIHsKCQkJCWlmICggYWNjZXB0RGF0YSB8fCBqUXVlcnkuYWNjZXB0RGF0YSggZWxlbSApICkgewoKCQkJCQlpZCA9IGVsZW1bIGludGVybmFsS2V5IF07CgkJCQkJZGF0YSA9IGlkICYmIGNhY2hlWyBpZCBdOwoKCQkJCQlpZiAoIGRhdGEgKSB7CgkJCQkJCWlmICggZGF0YS5ldmVudHMgKSB7CgkJCQkJCQlmb3IgKCB0eXBlIGluIGRhdGEuZXZlbnRzICkgewoJCQkJCQkJCWlmICggc3BlY2lhbFsgdHlwZSBdICkgewoJCQkJCQkJCQlqUXVlcnkuZXZlbnQucmVtb3ZlKCBlbGVtLCB0eXBlICk7CgoJCQkJCQkJCS8vIFRoaXMgaXMgYSBzaG9ydGN1dCB0byBhdm9pZCBqUXVlcnkuZXZlbnQucmVtb3ZlJ3Mgb3ZlcmhlYWQKCQkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCQlqUXVlcnkucmVtb3ZlRXZlbnQoIGVsZW0sIHR5cGUsIGRhdGEuaGFuZGxlICk7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgoJCQkJCQkvLyBSZW1vdmUgY2FjaGUgb25seSBpZiBpdCB3YXMgbm90IGFscmVhZHkgcmVtb3ZlZCBieSBqUXVlcnkuZXZlbnQucmVtb3ZlCgkJCQkJCWlmICggY2FjaGVbIGlkIF0gKSB7CgoJCQkJCQkJZGVsZXRlIGNhY2hlWyBpZCBdOwoKCQkJCQkJCS8vIElFIGRvZXMgbm90IGFsbG93IHVzIHRvIGRlbGV0ZSBleHBhbmRvIHByb3BlcnRpZXMgZnJvbSBub2RlcywKCQkJCQkJCS8vIG5vciBkb2VzIGl0IGhhdmUgYSByZW1vdmVBdHRyaWJ1dGUgZnVuY3Rpb24gb24gRG9jdW1lbnQgbm9kZXM7CgkJCQkJCQkvLyB3ZSBtdXN0IGhhbmRsZSBhbGwgb2YgdGhlc2UgY2FzZXMKCQkJCQkJCWlmICggZGVsZXRlRXhwYW5kbyApIHsKCQkJCQkJCQlkZWxldGUgZWxlbVsgaW50ZXJuYWxLZXkgXTsKCgkJCQkJCQl9IGVsc2UgaWYgKCB0eXBlb2YgZWxlbS5yZW1vdmVBdHRyaWJ1dGUgIT09IHN0cnVuZGVmaW5lZCApIHsKCQkJCQkJCQllbGVtLnJlbW92ZUF0dHJpYnV0ZSggaW50ZXJuYWxLZXkgKTsKCgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCWVsZW1bIGludGVybmFsS2V5IF0gPSBudWxsOwoJCQkJCQkJfQoKCQkJCQkJCWRlbGV0ZWRJZHMucHVzaCggaWQgKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCX0pOwoKCWpRdWVyeS5mbi5leHRlbmQoewoJCXRleHQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJcmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIHZhbHVlICkgewoJCQkJcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQgPwoJCQkJCWpRdWVyeS50ZXh0KCB0aGlzICkgOgoJCQkJCXRoaXMuZW1wdHkoKS5hcHBlbmQoICggdGhpc1swXSAmJiB0aGlzWzBdLm93bmVyRG9jdW1lbnQgfHwgZG9jdW1lbnQgKS5jcmVhdGVUZXh0Tm9kZSggdmFsdWUgKSApOwoJCQl9LCBudWxsLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCApOwoJCX0sCgoJCWFwcGVuZDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLmRvbU1hbmlwKCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJaWYgKCB0aGlzLm5vZGVUeXBlID09PSAxIHx8IHRoaXMubm9kZVR5cGUgPT09IDExIHx8IHRoaXMubm9kZVR5cGUgPT09IDkgKSB7CgkJCQkJdmFyIHRhcmdldCA9IG1hbmlwdWxhdGlvblRhcmdldCggdGhpcywgZWxlbSApOwoJCQkJCXRhcmdldC5hcHBlbmRDaGlsZCggZWxlbSApOwoJCQkJfQoJCQl9KTsKCQl9LAoKCQlwcmVwZW5kOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMuZG9tTWFuaXAoIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlpZiAoIHRoaXMubm9kZVR5cGUgPT09IDEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gMTEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gOSApIHsKCQkJCQl2YXIgdGFyZ2V0ID0gbWFuaXB1bGF0aW9uVGFyZ2V0KCB0aGlzLCBlbGVtICk7CgkJCQkJdGFyZ2V0Lmluc2VydEJlZm9yZSggZWxlbSwgdGFyZ2V0LmZpcnN0Q2hpbGQgKTsKCQkJCX0KCQkJfSk7CgkJfSwKCgkJYmVmb3JlOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMuZG9tTWFuaXAoIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlpZiAoIHRoaXMucGFyZW50Tm9kZSApIHsKCQkJCQl0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKCBlbGVtLCB0aGlzICk7CgkJCQl9CgkJCX0pOwoJCX0sCgoJCWFmdGVyOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMuZG9tTWFuaXAoIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlpZiAoIHRoaXMucGFyZW50Tm9kZSApIHsKCQkJCQl0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKCBlbGVtLCB0aGlzLm5leHRTaWJsaW5nICk7CgkJCQl9CgkJCX0pOwoJCX0sCgoJCXJlbW92ZTogZnVuY3Rpb24oIHNlbGVjdG9yLCBrZWVwRGF0YSAvKiBJbnRlcm5hbCBVc2UgT25seSAqLyApIHsKCQkJdmFyIGVsZW0sCgkJCQllbGVtcyA9IHNlbGVjdG9yID8galF1ZXJ5LmZpbHRlciggc2VsZWN0b3IsIHRoaXMgKSA6IHRoaXMsCgkJCQlpID0gMDsKCgkJCWZvciAoIDsgKGVsZW0gPSBlbGVtc1tpXSkgIT0gbnVsbDsgaSsrICkgewoKCQkJCWlmICggIWtlZXBEYXRhICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJalF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCBlbGVtICkgKTsKCQkJCX0KCgkJCQlpZiAoIGVsZW0ucGFyZW50Tm9kZSApIHsKCQkJCQlpZiAoIGtlZXBEYXRhICYmIGpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICkgKSB7CgkJCQkJCXNldEdsb2JhbEV2YWwoIGdldEFsbCggZWxlbSwgInNjcmlwdCIgKSApOwoJCQkJCX0KCQkJCQllbGVtLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIGVsZW0gKTsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIHRoaXM7CgkJfSwKCgkJZW1wdHk6IGZ1bmN0aW9uKCkgewoJCQl2YXIgZWxlbSwKCQkJCWkgPSAwOwoKCQkJZm9yICggOyAoZWxlbSA9IHRoaXNbaV0pICE9IG51bGw7IGkrKyApIHsKCQkJCS8vIFJlbW92ZSBlbGVtZW50IG5vZGVzIGFuZCBwcmV2ZW50IG1lbW9yeSBsZWFrcwoJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICkgewoJCQkJCWpRdWVyeS5jbGVhbkRhdGEoIGdldEFsbCggZWxlbSwgZmFsc2UgKSApOwoJCQkJfQoKCQkJCS8vIFJlbW92ZSBhbnkgcmVtYWluaW5nIG5vZGVzCgkJCQl3aGlsZSAoIGVsZW0uZmlyc3RDaGlsZCApIHsKCQkJCQllbGVtLnJlbW92ZUNoaWxkKCBlbGVtLmZpcnN0Q2hpbGQgKTsKCQkJCX0KCgkJCQkvLyBJZiB0aGlzIGlzIGEgc2VsZWN0LCBlbnN1cmUgdGhhdCBpdCBkaXNwbGF5cyBlbXB0eSAoIzEyMzM2KQoJCQkJLy8gU3VwcG9ydDogSUU8OQoJCQkJaWYgKCBlbGVtLm9wdGlvbnMgJiYgalF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCAic2VsZWN0IiApICkgewoJCQkJCWVsZW0ub3B0aW9ucy5sZW5ndGggPSAwOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gdGhpczsKCQl9LAoKCQljbG9uZTogZnVuY3Rpb24oIGRhdGFBbmRFdmVudHMsIGRlZXBEYXRhQW5kRXZlbnRzICkgewoJCQlkYXRhQW5kRXZlbnRzID0gZGF0YUFuZEV2ZW50cyA9PSBudWxsID8gZmFsc2UgOiBkYXRhQW5kRXZlbnRzOwoJCQlkZWVwRGF0YUFuZEV2ZW50cyA9IGRlZXBEYXRhQW5kRXZlbnRzID09IG51bGwgPyBkYXRhQW5kRXZlbnRzIDogZGVlcERhdGFBbmRFdmVudHM7CgoJCQlyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKSB7CgkJCQlyZXR1cm4galF1ZXJ5LmNsb25lKCB0aGlzLCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cyApOwoJCQl9KTsKCQl9LAoKCQlodG1sOiBmdW5jdGlvbiggdmFsdWUgKSB7CgkJCXJldHVybiBhY2Nlc3MoIHRoaXMsIGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJCXZhciBlbGVtID0gdGhpc1sgMCBdIHx8IHt9LAoJCQkJCWkgPSAwLAoJCQkJCWwgPSB0aGlzLmxlbmd0aDsKCgkJCQlpZiAoIHZhbHVlID09PSB1bmRlZmluZWQgKSB7CgkJCQkJcmV0dXJuIGVsZW0ubm9kZVR5cGUgPT09IDEgPwoJCQkJCQllbGVtLmlubmVySFRNTC5yZXBsYWNlKCByaW5saW5lalF1ZXJ5LCAiIiApIDoKCQkJCQkJdW5kZWZpbmVkOwoJCQkJfQoKCQkJCS8vIFNlZSBpZiB3ZSBjYW4gdGFrZSBhIHNob3J0Y3V0IGFuZCBqdXN0IHVzZSBpbm5lckhUTUwKCQkJCWlmICggdHlwZW9mIHZhbHVlID09PSAic3RyaW5nIiAmJiAhcm5vSW5uZXJodG1sLnRlc3QoIHZhbHVlICkgJiYKCQkJCQkoIHN1cHBvcnQuaHRtbFNlcmlhbGl6ZSB8fCAhcm5vc2hpbWNhY2hlLnRlc3QoIHZhbHVlICkgICkgJiYKCQkJCQkoIHN1cHBvcnQubGVhZGluZ1doaXRlc3BhY2UgfHwgIXJsZWFkaW5nV2hpdGVzcGFjZS50ZXN0KCB2YWx1ZSApICkgJiYKCQkJCQkhd3JhcE1hcFsgKHJ0YWdOYW1lLmV4ZWMoIHZhbHVlICkgfHwgWyAiIiwgIiIgXSlbIDEgXS50b0xvd2VyQ2FzZSgpIF0gKSB7CgoJCQkJCXZhbHVlID0gdmFsdWUucmVwbGFjZSggcnhodG1sVGFnLCAiPCQxPjwvJDI+IiApOwoKCQkJCQl0cnkgewoJCQkJCQlmb3IgKDsgaSA8IGw7IGkrKyApIHsKCQkJCQkJCS8vIFJlbW92ZSBlbGVtZW50IG5vZGVzIGFuZCBwcmV2ZW50IG1lbW9yeSBsZWFrcwoJCQkJCQkJZWxlbSA9IHRoaXNbaV0gfHwge307CgkJCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJCQkJalF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCBlbGVtLCBmYWxzZSApICk7CgkJCQkJCQkJZWxlbS5pbm5lckhUTUwgPSB2YWx1ZTsKCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJZWxlbSA9IDA7CgoJCQkJCS8vIElmIHVzaW5nIGlubmVySFRNTCB0aHJvd3MgYW4gZXhjZXB0aW9uLCB1c2UgdGhlIGZhbGxiYWNrIG1ldGhvZAoJCQkJCX0gY2F0Y2goZSkge30KCQkJCX0KCgkJCQlpZiAoIGVsZW0gKSB7CgkJCQkJdGhpcy5lbXB0eSgpLmFwcGVuZCggdmFsdWUgKTsKCQkJCX0KCQkJfSwgbnVsbCwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggKTsKCQl9LAoKCQlyZXBsYWNlV2l0aDogZnVuY3Rpb24oKSB7CgkJCXZhciBhcmcgPSBhcmd1bWVudHNbIDAgXTsKCgkJCS8vIE1ha2UgdGhlIGNoYW5nZXMsIHJlcGxhY2luZyBlYWNoIGNvbnRleHQgZWxlbWVudCB3aXRoIHRoZSBuZXcgY29udGVudAoJCQl0aGlzLmRvbU1hbmlwKCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJYXJnID0gdGhpcy5wYXJlbnROb2RlOwoKCQkJCWpRdWVyeS5jbGVhbkRhdGEoIGdldEFsbCggdGhpcyApICk7CgoJCQkJaWYgKCBhcmcgKSB7CgkJCQkJYXJnLnJlcGxhY2VDaGlsZCggZWxlbSwgdGhpcyApOwoJCQkJfQoJCQl9KTsKCgkJCS8vIEZvcmNlIHJlbW92YWwgaWYgdGhlcmUgd2FzIG5vIG5ldyBjb250ZW50IChlLmcuLCBmcm9tIGVtcHR5IGFyZ3VtZW50cykKCQkJcmV0dXJuIGFyZyAmJiAoYXJnLmxlbmd0aCB8fCBhcmcubm9kZVR5cGUpID8gdGhpcyA6IHRoaXMucmVtb3ZlKCk7CgkJfSwKCgkJZGV0YWNoOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXJldHVybiB0aGlzLnJlbW92ZSggc2VsZWN0b3IsIHRydWUgKTsKCQl9LAoKCQlkb21NYW5pcDogZnVuY3Rpb24oIGFyZ3MsIGNhbGxiYWNrICkgewoKCQkJLy8gRmxhdHRlbiBhbnkgbmVzdGVkIGFycmF5cwoJCQlhcmdzID0gY29uY2F0LmFwcGx5KCBbXSwgYXJncyApOwoKCQkJdmFyIGZpcnN0LCBub2RlLCBoYXNTY3JpcHRzLAoJCQkJc2NyaXB0cywgZG9jLCBmcmFnbWVudCwKCQkJCWkgPSAwLAoJCQkJbCA9IHRoaXMubGVuZ3RoLAoJCQkJc2V0ID0gdGhpcywKCQkJCWlOb0Nsb25lID0gbCAtIDEsCgkJCQl2YWx1ZSA9IGFyZ3NbMF0sCgkJCQlpc0Z1bmN0aW9uID0galF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICk7CgoJCQkvLyBXZSBjYW4ndCBjbG9uZU5vZGUgZnJhZ21lbnRzIHRoYXQgY29udGFpbiBjaGVja2VkLCBpbiBXZWJLaXQKCQkJaWYgKCBpc0Z1bmN0aW9uIHx8CgkJCQkJKCBsID4gMSAmJiB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICYmCgkJCQkJCSFzdXBwb3J0LmNoZWNrQ2xvbmUgJiYgcmNoZWNrZWQudGVzdCggdmFsdWUgKSApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaW5kZXggKSB7CgkJCQkJdmFyIHNlbGYgPSBzZXQuZXEoIGluZGV4ICk7CgkJCQkJaWYgKCBpc0Z1bmN0aW9uICkgewoJCQkJCQlhcmdzWzBdID0gdmFsdWUuY2FsbCggdGhpcywgaW5kZXgsIHNlbGYuaHRtbCgpICk7CgkJCQkJfQoJCQkJCXNlbGYuZG9tTWFuaXAoIGFyZ3MsIGNhbGxiYWNrICk7CgkJCQl9KTsKCQkJfQoKCQkJaWYgKCBsICkgewoJCQkJZnJhZ21lbnQgPSBqUXVlcnkuYnVpbGRGcmFnbWVudCggYXJncywgdGhpc1sgMCBdLm93bmVyRG9jdW1lbnQsIGZhbHNlLCB0aGlzICk7CgkJCQlmaXJzdCA9IGZyYWdtZW50LmZpcnN0Q2hpbGQ7CgoJCQkJaWYgKCBmcmFnbWVudC5jaGlsZE5vZGVzLmxlbmd0aCA9PT0gMSApIHsKCQkJCQlmcmFnbWVudCA9IGZpcnN0OwoJCQkJfQoKCQkJCWlmICggZmlyc3QgKSB7CgkJCQkJc2NyaXB0cyA9IGpRdWVyeS5tYXAoIGdldEFsbCggZnJhZ21lbnQsICJzY3JpcHQiICksIGRpc2FibGVTY3JpcHQgKTsKCQkJCQloYXNTY3JpcHRzID0gc2NyaXB0cy5sZW5ndGg7CgoJCQkJCS8vIFVzZSB0aGUgb3JpZ2luYWwgZnJhZ21lbnQgZm9yIHRoZSBsYXN0IGl0ZW0gaW5zdGVhZCBvZiB0aGUgZmlyc3QgYmVjYXVzZSBpdCBjYW4gZW5kIHVwCgkJCQkJLy8gYmVpbmcgZW1wdGllZCBpbmNvcnJlY3RseSBpbiBjZXJ0YWluIHNpdHVhdGlvbnMgKCM4MDcwKS4KCQkJCQlmb3IgKCA7IGkgPCBsOyBpKysgKSB7CgkJCQkJCW5vZGUgPSBmcmFnbWVudDsKCgkJCQkJCWlmICggaSAhPT0gaU5vQ2xvbmUgKSB7CgkJCQkJCQlub2RlID0galF1ZXJ5LmNsb25lKCBub2RlLCB0cnVlLCB0cnVlICk7CgoJCQkJCQkJLy8gS2VlcCByZWZlcmVuY2VzIHRvIGNsb25lZCBzY3JpcHRzIGZvciBsYXRlciByZXN0b3JhdGlvbgoJCQkJCQkJaWYgKCBoYXNTY3JpcHRzICkgewoJCQkJCQkJCWpRdWVyeS5tZXJnZSggc2NyaXB0cywgZ2V0QWxsKCBub2RlLCAic2NyaXB0IiApICk7CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCWNhbGxiYWNrLmNhbGwoIHRoaXNbaV0sIG5vZGUsIGkgKTsKCQkJCQl9CgoJCQkJCWlmICggaGFzU2NyaXB0cyApIHsKCQkJCQkJZG9jID0gc2NyaXB0c1sgc2NyaXB0cy5sZW5ndGggLSAxIF0ub3duZXJEb2N1bWVudDsKCgkJCQkJCS8vIFJlZW5hYmxlIHNjcmlwdHMKCQkJCQkJalF1ZXJ5Lm1hcCggc2NyaXB0cywgcmVzdG9yZVNjcmlwdCApOwoKCQkJCQkJLy8gRXZhbHVhdGUgZXhlY3V0YWJsZSBzY3JpcHRzIG9uIGZpcnN0IGRvY3VtZW50IGluc2VydGlvbgoJCQkJCQlmb3IgKCBpID0gMDsgaSA8IGhhc1NjcmlwdHM7IGkrKyApIHsKCQkJCQkJCW5vZGUgPSBzY3JpcHRzWyBpIF07CgkJCQkJCQlpZiAoIHJzY3JpcHRUeXBlLnRlc3QoIG5vZGUudHlwZSB8fCAiIiApICYmCgkJCQkJCQkJIWpRdWVyeS5fZGF0YSggbm9kZSwgImdsb2JhbEV2YWwiICkgJiYgalF1ZXJ5LmNvbnRhaW5zKCBkb2MsIG5vZGUgKSApIHsKCgkJCQkJCQkJaWYgKCBub2RlLnNyYyApIHsKCQkJCQkJCQkJLy8gT3B0aW9uYWwgQUpBWCBkZXBlbmRlbmN5LCBidXQgd29uJ3QgcnVuIHNjcmlwdHMgaWYgbm90IHByZXNlbnQKCQkJCQkJCQkJaWYgKCBqUXVlcnkuX2V2YWxVcmwgKSB7CgkJCQkJCQkJCQlqUXVlcnkuX2V2YWxVcmwoIG5vZGUuc3JjICk7CgkJCQkJCQkJCX0KCQkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCQlqUXVlcnkuZ2xvYmFsRXZhbCggKCBub2RlLnRleHQgfHwgbm9kZS50ZXh0Q29udGVudCB8fCBub2RlLmlubmVySFRNTCB8fCAiIiApLnJlcGxhY2UoIHJjbGVhblNjcmlwdCwgIiIgKSApOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCgkJCQkJLy8gRml4ICMxMTgwOTogQXZvaWQgbGVha2luZyBtZW1vcnkKCQkJCQlmcmFnbWVudCA9IGZpcnN0ID0gbnVsbDsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIHRoaXM7CgkJfQoJfSk7CgoJalF1ZXJ5LmVhY2goewoJCWFwcGVuZFRvOiAiYXBwZW5kIiwKCQlwcmVwZW5kVG86ICJwcmVwZW5kIiwKCQlpbnNlcnRCZWZvcmU6ICJiZWZvcmUiLAoJCWluc2VydEFmdGVyOiAiYWZ0ZXIiLAoJCXJlcGxhY2VBbGw6ICJyZXBsYWNlV2l0aCIKCX0sIGZ1bmN0aW9uKCBuYW1lLCBvcmlnaW5hbCApIHsKCQlqUXVlcnkuZm5bIG5hbWUgXSA9IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQkJdmFyIGVsZW1zLAoJCQkJaSA9IDAsCgkJCQlyZXQgPSBbXSwKCQkJCWluc2VydCA9IGpRdWVyeSggc2VsZWN0b3IgKSwKCQkJCWxhc3QgPSBpbnNlcnQubGVuZ3RoIC0gMTsKCgkJCWZvciAoIDsgaSA8PSBsYXN0OyBpKysgKSB7CgkJCQllbGVtcyA9IGkgPT09IGxhc3QgPyB0aGlzIDogdGhpcy5jbG9uZSh0cnVlKTsKCQkJCWpRdWVyeSggaW5zZXJ0W2ldIClbIG9yaWdpbmFsIF0oIGVsZW1zICk7CgoJCQkJLy8gTW9kZXJuIGJyb3dzZXJzIGNhbiBhcHBseSBqUXVlcnkgY29sbGVjdGlvbnMgYXMgYXJyYXlzLCBidXQgb2xkSUUgbmVlZHMgYSAuZ2V0KCkKCQkJCXB1c2guYXBwbHkoIHJldCwgZWxlbXMuZ2V0KCkgKTsKCQkJfQoKCQkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCByZXQgKTsKCQl9OwoJfSk7CgoKCXZhciBpZnJhbWUsCgkJZWxlbWRpc3BsYXkgPSB7fTsKCgkvKioKCSAqIFJldHJpZXZlIHRoZSBhY3R1YWwgZGlzcGxheSBvZiBhIGVsZW1lbnQKCSAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIG5vZGVOYW1lIG9mIHRoZSBlbGVtZW50CgkgKiBAcGFyYW0ge09iamVjdH0gZG9jIERvY3VtZW50IG9iamVjdAoJICovCgkvLyBDYWxsZWQgb25seSBmcm9tIHdpdGhpbiBkZWZhdWx0RGlzcGxheQoJZnVuY3Rpb24gYWN0dWFsRGlzcGxheSggbmFtZSwgZG9jICkgewoJCXZhciBzdHlsZSwKCQkJZWxlbSA9IGpRdWVyeSggZG9jLmNyZWF0ZUVsZW1lbnQoIG5hbWUgKSApLmFwcGVuZFRvKCBkb2MuYm9keSApLAoKCQkJLy8gZ2V0RGVmYXVsdENvbXB1dGVkU3R5bGUgbWlnaHQgYmUgcmVsaWFibHkgdXNlZCBvbmx5IG9uIGF0dGFjaGVkIGVsZW1lbnQKCQkJZGlzcGxheSA9IHdpbmRvdy5nZXREZWZhdWx0Q29tcHV0ZWRTdHlsZSAmJiAoIHN0eWxlID0gd2luZG93LmdldERlZmF1bHRDb21wdXRlZFN0eWxlKCBlbGVtWyAwIF0gKSApID8KCgkJCQkvLyBVc2Ugb2YgdGhpcyBtZXRob2QgaXMgYSB0ZW1wb3JhcnkgZml4IChtb3JlIGxpa2Ugb3B0bWl6YXRpb24pIHVudGlsIHNvbWV0aGluZyBiZXR0ZXIgY29tZXMgYWxvbmcsCgkJCQkvLyBzaW5jZSBpdCB3YXMgcmVtb3ZlZCBmcm9tIHNwZWNpZmljYXRpb24gYW5kIHN1cHBvcnRlZCBvbmx5IGluIEZGCgkJCQlzdHlsZS5kaXNwbGF5IDogalF1ZXJ5LmNzcyggZWxlbVsgMCBdLCAiZGlzcGxheSIgKTsKCgkJLy8gV2UgZG9uJ3QgaGF2ZSBhbnkgZGF0YSBzdG9yZWQgb24gdGhlIGVsZW1lbnQsCgkJLy8gc28gdXNlICJkZXRhY2giIG1ldGhvZCBhcyBmYXN0IHdheSB0byBnZXQgcmlkIG9mIHRoZSBlbGVtZW50CgkJZWxlbS5kZXRhY2goKTsKCgkJcmV0dXJuIGRpc3BsYXk7Cgl9CgoJLyoqCgkgKiBUcnkgdG8gZGV0ZXJtaW5lIHRoZSBkZWZhdWx0IGRpc3BsYXkgdmFsdWUgb2YgYW4gZWxlbWVudAoJICogQHBhcmFtIHtTdHJpbmd9IG5vZGVOYW1lCgkgKi8KCWZ1bmN0aW9uIGRlZmF1bHREaXNwbGF5KCBub2RlTmFtZSApIHsKCQl2YXIgZG9jID0gZG9jdW1lbnQsCgkJCWRpc3BsYXkgPSBlbGVtZGlzcGxheVsgbm9kZU5hbWUgXTsKCgkJaWYgKCAhZGlzcGxheSApIHsKCQkJZGlzcGxheSA9IGFjdHVhbERpc3BsYXkoIG5vZGVOYW1lLCBkb2MgKTsKCgkJCS8vIElmIHRoZSBzaW1wbGUgd2F5IGZhaWxzLCByZWFkIGZyb20gaW5zaWRlIGFuIGlmcmFtZQoJCQlpZiAoIGRpc3BsYXkgPT09ICJub25lIiB8fCAhZGlzcGxheSApIHsKCgkJCQkvLyBVc2UgdGhlIGFscmVhZHktY3JlYXRlZCBpZnJhbWUgaWYgcG9zc2libGUKCQkJCWlmcmFtZSA9IChpZnJhbWUgfHwgalF1ZXJ5KCAiPGlmcmFtZSBmcmFtZWJvcmRlcj0nMCcgd2lkdGg9JzAnIGhlaWdodD0nMCcvPiIgKSkuYXBwZW5kVG8oIGRvYy5kb2N1bWVudEVsZW1lbnQgKTsKCgkJCQkvLyBBbHdheXMgd3JpdGUgYSBuZXcgSFRNTCBza2VsZXRvbiBzbyBXZWJraXQgYW5kIEZpcmVmb3ggZG9uJ3QgY2hva2Ugb24gcmV1c2UKCQkJCWRvYyA9ICggaWZyYW1lWyAwIF0uY29udGVudFdpbmRvdyB8fCBpZnJhbWVbIDAgXS5jb250ZW50RG9jdW1lbnQgKS5kb2N1bWVudDsKCgkJCQkvLyBTdXBwb3J0OiBJRQoJCQkJZG9jLndyaXRlKCk7CgkJCQlkb2MuY2xvc2UoKTsKCgkJCQlkaXNwbGF5ID0gYWN0dWFsRGlzcGxheSggbm9kZU5hbWUsIGRvYyApOwoJCQkJaWZyYW1lLmRldGFjaCgpOwoJCQl9CgoJCQkvLyBTdG9yZSB0aGUgY29ycmVjdCBkZWZhdWx0IGRpc3BsYXkKCQkJZWxlbWRpc3BsYXlbIG5vZGVOYW1lIF0gPSBkaXNwbGF5OwoJCX0KCgkJcmV0dXJuIGRpc3BsYXk7Cgl9CgoKCShmdW5jdGlvbigpIHsKCQl2YXIgc2hyaW5rV3JhcEJsb2Nrc1ZhbDsKCgkJc3VwcG9ydC5zaHJpbmtXcmFwQmxvY2tzID0gZnVuY3Rpb24oKSB7CgkJCWlmICggc2hyaW5rV3JhcEJsb2Nrc1ZhbCAhPSBudWxsICkgewoJCQkJcmV0dXJuIHNocmlua1dyYXBCbG9ja3NWYWw7CgkJCX0KCgkJCS8vIFdpbGwgYmUgY2hhbmdlZCBsYXRlciBpZiBuZWVkZWQuCgkJCXNocmlua1dyYXBCbG9ja3NWYWwgPSBmYWxzZTsKCgkJCS8vIE1pbmlmaWVkOiB2YXIgYixjLGQKCQkJdmFyIGRpdiwgYm9keSwgY29udGFpbmVyOwoKCQkJYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAiYm9keSIgKVsgMCBdOwoJCQlpZiAoICFib2R5IHx8ICFib2R5LnN0eWxlICkgewoJCQkJLy8gVGVzdCBmaXJlZCB0b28gZWFybHkgb3IgaW4gYW4gdW5zdXBwb3J0ZWQgZW52aXJvbm1lbnQsIGV4aXQuCgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIFNldHVwCgkJCWRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICk7CgkJCWNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICk7CgkJCWNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gInBvc2l0aW9uOmFic29sdXRlO2JvcmRlcjowO3dpZHRoOjA7aGVpZ2h0OjA7dG9wOjA7bGVmdDotOTk5OXB4IjsKCQkJYm9keS5hcHBlbmRDaGlsZCggY29udGFpbmVyICkuYXBwZW5kQ2hpbGQoIGRpdiApOwoKCQkJLy8gU3VwcG9ydDogSUU2CgkJCS8vIENoZWNrIGlmIGVsZW1lbnRzIHdpdGggbGF5b3V0IHNocmluay13cmFwIHRoZWlyIGNoaWxkcmVuCgkJCWlmICggdHlwZW9mIGRpdi5zdHlsZS56b29tICE9PSBzdHJ1bmRlZmluZWQgKSB7CgkJCQkvLyBSZXNldCBDU1M6IGJveC1zaXppbmc7IGRpc3BsYXk7IG1hcmdpbjsgYm9yZGVyCgkJCQlkaXYuc3R5bGUuY3NzVGV4dCA9CgkJCQkJLy8gU3VwcG9ydDogRmlyZWZveDwyOSwgQW5kcm9pZCAyLjMKCQkJCQkvLyBWZW5kb3ItcHJlZml4IGJveC1zaXppbmcKCQkJCQkiLXdlYmtpdC1ib3gtc2l6aW5nOmNvbnRlbnQtYm94Oy1tb3otYm94LXNpemluZzpjb250ZW50LWJveDsiICsKCQkJCQkiYm94LXNpemluZzpjb250ZW50LWJveDtkaXNwbGF5OmJsb2NrO21hcmdpbjowO2JvcmRlcjowOyIgKwoJCQkJCSJwYWRkaW5nOjFweDt3aWR0aDoxcHg7em9vbToxIjsKCQkJCWRpdi5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKSApLnN0eWxlLndpZHRoID0gIjVweCI7CgkJCQlzaHJpbmtXcmFwQmxvY2tzVmFsID0gZGl2Lm9mZnNldFdpZHRoICE9PSAzOwoJCQl9CgoJCQlib2R5LnJlbW92ZUNoaWxkKCBjb250YWluZXIgKTsKCgkJCXJldHVybiBzaHJpbmtXcmFwQmxvY2tzVmFsOwoJCX07CgoJfSkoKTsKCXZhciBybWFyZ2luID0gKC9ebWFyZ2luLyk7CgoJdmFyIHJudW1ub25weCA9IG5ldyBSZWdFeHAoICJeKCIgKyBwbnVtICsgIikoPyFweClbYS16JV0rJCIsICJpIiApOwoKCgoJdmFyIGdldFN0eWxlcywgY3VyQ1NTLAoJCXJwb3NpdGlvbiA9IC9eKHRvcHxyaWdodHxib3R0b218bGVmdCkkLzsKCglpZiAoIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlICkgewoJCWdldFN0eWxlcyA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkvLyBTdXBwb3J0OiBJRTw9MTErLCBGaXJlZm94PD0zMCsgKCMxNTA5OCwgIzE0MTUwKQoJCQkvLyBJRSB0aHJvd3Mgb24gZWxlbWVudHMgY3JlYXRlZCBpbiBwb3B1cHMKCQkJLy8gRkYgbWVhbndoaWxlIHRocm93cyBvbiBmcmFtZSBlbGVtZW50cyB0aHJvdWdoICJkZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlIgoJCQlpZiAoIGVsZW0ub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5vcGVuZXIgKSB7CgkJCQlyZXR1cm4gZWxlbS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoIGVsZW0sIG51bGwgKTsKCQkJfQoKCQkJcmV0dXJuIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKCBlbGVtLCBudWxsICk7CgkJfTsKCgkJY3VyQ1NTID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGNvbXB1dGVkICkgewoJCQl2YXIgd2lkdGgsIG1pbldpZHRoLCBtYXhXaWR0aCwgcmV0LAoJCQkJc3R5bGUgPSBlbGVtLnN0eWxlOwoKCQkJY29tcHV0ZWQgPSBjb21wdXRlZCB8fCBnZXRTdHlsZXMoIGVsZW0gKTsKCgkJCS8vIGdldFByb3BlcnR5VmFsdWUgaXMgb25seSBuZWVkZWQgZm9yIC5jc3MoJ2ZpbHRlcicpIGluIElFOSwgc2VlICMxMjUzNwoJCQlyZXQgPSBjb21wdXRlZCA/IGNvbXB1dGVkLmdldFByb3BlcnR5VmFsdWUoIG5hbWUgKSB8fCBjb21wdXRlZFsgbmFtZSBdIDogdW5kZWZpbmVkOwoKCQkJaWYgKCBjb21wdXRlZCApIHsKCgkJCQlpZiAoIHJldCA9PT0gIiIgJiYgIWpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICkgKSB7CgkJCQkJcmV0ID0galF1ZXJ5LnN0eWxlKCBlbGVtLCBuYW1lICk7CgkJCQl9CgoJCQkJLy8gQSB0cmlidXRlIHRvIHRoZSAiYXdlc29tZSBoYWNrIGJ5IERlYW4gRWR3YXJkcyIKCQkJCS8vIENocm9tZSA8IDE3IGFuZCBTYWZhcmkgNS4wIHVzZXMgImNvbXB1dGVkIHZhbHVlIiBpbnN0ZWFkIG9mICJ1c2VkIHZhbHVlIiBmb3IgbWFyZ2luLXJpZ2h0CgkJCQkvLyBTYWZhcmkgNS4xLjcgKGF0IGxlYXN0KSByZXR1cm5zIHBlcmNlbnRhZ2UgZm9yIGEgbGFyZ2VyIHNldCBvZiB2YWx1ZXMsIGJ1dCB3aWR0aCBzZWVtcyB0byBiZSByZWxpYWJseSBwaXhlbHMKCQkJCS8vIHRoaXMgaXMgYWdhaW5zdCB0aGUgQ1NTT00gZHJhZnQgc3BlYzogaHR0cDovL2Rldi53My5vcmcvY3Nzd2cvY3Nzb20vI3Jlc29sdmVkLXZhbHVlcwoJCQkJaWYgKCBybnVtbm9ucHgudGVzdCggcmV0ICkgJiYgcm1hcmdpbi50ZXN0KCBuYW1lICkgKSB7CgoJCQkJCS8vIFJlbWVtYmVyIHRoZSBvcmlnaW5hbCB2YWx1ZXMKCQkJCQl3aWR0aCA9IHN0eWxlLndpZHRoOwoJCQkJCW1pbldpZHRoID0gc3R5bGUubWluV2lkdGg7CgkJCQkJbWF4V2lkdGggPSBzdHlsZS5tYXhXaWR0aDsKCgkJCQkJLy8gUHV0IGluIHRoZSBuZXcgdmFsdWVzIHRvIGdldCBhIGNvbXB1dGVkIHZhbHVlIG91dAoJCQkJCXN0eWxlLm1pbldpZHRoID0gc3R5bGUubWF4V2lkdGggPSBzdHlsZS53aWR0aCA9IHJldDsKCQkJCQlyZXQgPSBjb21wdXRlZC53aWR0aDsKCgkJCQkJLy8gUmV2ZXJ0IHRoZSBjaGFuZ2VkIHZhbHVlcwoJCQkJCXN0eWxlLndpZHRoID0gd2lkdGg7CgkJCQkJc3R5bGUubWluV2lkdGggPSBtaW5XaWR0aDsKCQkJCQlzdHlsZS5tYXhXaWR0aCA9IG1heFdpZHRoOwoJCQkJfQoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRQoJCQkvLyBJRSByZXR1cm5zIHpJbmRleCB2YWx1ZSBhcyBhbiBpbnRlZ2VyLgoJCQlyZXR1cm4gcmV0ID09PSB1bmRlZmluZWQgPwoJCQkJcmV0IDoKCQkJCXJldCArICIiOwoJCX07Cgl9IGVsc2UgaWYgKCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY3VycmVudFN0eWxlICkgewoJCWdldFN0eWxlcyA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gZWxlbS5jdXJyZW50U3R5bGU7CgkJfTsKCgkJY3VyQ1NTID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGNvbXB1dGVkICkgewoJCQl2YXIgbGVmdCwgcnMsIHJzTGVmdCwgcmV0LAoJCQkJc3R5bGUgPSBlbGVtLnN0eWxlOwoKCQkJY29tcHV0ZWQgPSBjb21wdXRlZCB8fCBnZXRTdHlsZXMoIGVsZW0gKTsKCQkJcmV0ID0gY29tcHV0ZWQgPyBjb21wdXRlZFsgbmFtZSBdIDogdW5kZWZpbmVkOwoKCQkJLy8gQXZvaWQgc2V0dGluZyByZXQgdG8gZW1wdHkgc3RyaW5nIGhlcmUKCQkJLy8gc28gd2UgZG9uJ3QgZGVmYXVsdCB0byBhdXRvCgkJCWlmICggcmV0ID09IG51bGwgJiYgc3R5bGUgJiYgc3R5bGVbIG5hbWUgXSApIHsKCQkJCXJldCA9IHN0eWxlWyBuYW1lIF07CgkJCX0KCgkJCS8vIEZyb20gdGhlIGF3ZXNvbWUgaGFjayBieSBEZWFuIEVkd2FyZHMKCQkJLy8gaHR0cDovL2VyaWsuZWFlLm5ldC9hcmNoaXZlcy8yMDA3LzA3LzI3LzE4LjU0LjE1LyNjb21tZW50LTEwMjI5MQoKCQkJLy8gSWYgd2UncmUgbm90IGRlYWxpbmcgd2l0aCBhIHJlZ3VsYXIgcGl4ZWwgbnVtYmVyCgkJCS8vIGJ1dCBhIG51bWJlciB0aGF0IGhhcyBhIHdlaXJkIGVuZGluZywgd2UgbmVlZCB0byBjb252ZXJ0IGl0IHRvIHBpeGVscwoJCQkvLyBidXQgbm90IHBvc2l0aW9uIGNzcyBhdHRyaWJ1dGVzLCBhcyB0aG9zZSBhcmUgcHJvcG9ydGlvbmFsIHRvIHRoZSBwYXJlbnQgZWxlbWVudCBpbnN0ZWFkCgkJCS8vIGFuZCB3ZSBjYW4ndCBtZWFzdXJlIHRoZSBwYXJlbnQgaW5zdGVhZCBiZWNhdXNlIGl0IG1pZ2h0IHRyaWdnZXIgYSAic3RhY2tpbmcgZG9sbHMiIHByb2JsZW0KCQkJaWYgKCBybnVtbm9ucHgudGVzdCggcmV0ICkgJiYgIXJwb3NpdGlvbi50ZXN0KCBuYW1lICkgKSB7CgoJCQkJLy8gUmVtZW1iZXIgdGhlIG9yaWdpbmFsIHZhbHVlcwoJCQkJbGVmdCA9IHN0eWxlLmxlZnQ7CgkJCQlycyA9IGVsZW0ucnVudGltZVN0eWxlOwoJCQkJcnNMZWZ0ID0gcnMgJiYgcnMubGVmdDsKCgkJCQkvLyBQdXQgaW4gdGhlIG5ldyB2YWx1ZXMgdG8gZ2V0IGEgY29tcHV0ZWQgdmFsdWUgb3V0CgkJCQlpZiAoIHJzTGVmdCApIHsKCQkJCQlycy5sZWZ0ID0gZWxlbS5jdXJyZW50U3R5bGUubGVmdDsKCQkJCX0KCQkJCXN0eWxlLmxlZnQgPSBuYW1lID09PSAiZm9udFNpemUiID8gIjFlbSIgOiByZXQ7CgkJCQlyZXQgPSBzdHlsZS5waXhlbExlZnQgKyAicHgiOwoKCQkJCS8vIFJldmVydCB0aGUgY2hhbmdlZCB2YWx1ZXMKCQkJCXN0eWxlLmxlZnQgPSBsZWZ0OwoJCQkJaWYgKCByc0xlZnQgKSB7CgkJCQkJcnMubGVmdCA9IHJzTGVmdDsKCQkJCX0KCQkJfQoKCQkJLy8gU3VwcG9ydDogSUUKCQkJLy8gSUUgcmV0dXJucyB6SW5kZXggdmFsdWUgYXMgYW4gaW50ZWdlci4KCQkJcmV0dXJuIHJldCA9PT0gdW5kZWZpbmVkID8KCQkJCXJldCA6CgkJCQlyZXQgKyAiIiB8fCAiYXV0byI7CgkJfTsKCX0KCgoKCglmdW5jdGlvbiBhZGRHZXRIb29rSWYoIGNvbmRpdGlvbkZuLCBob29rRm4gKSB7CgkJLy8gRGVmaW5lIHRoZSBob29rLCB3ZSdsbCBjaGVjayBvbiB0aGUgZmlyc3QgcnVuIGlmIGl0J3MgcmVhbGx5IG5lZWRlZC4KCQlyZXR1cm4gewoJCQlnZXQ6IGZ1bmN0aW9uKCkgewoJCQkJdmFyIGNvbmRpdGlvbiA9IGNvbmRpdGlvbkZuKCk7CgoJCQkJaWYgKCBjb25kaXRpb24gPT0gbnVsbCApIHsKCQkJCQkvLyBUaGUgdGVzdCB3YXMgbm90IHJlYWR5IGF0IHRoaXMgcG9pbnQ7IHNjcmV3IHRoZSBob29rIHRoaXMgdGltZQoJCQkJCS8vIGJ1dCBjaGVjayBhZ2FpbiB3aGVuIG5lZWRlZCBuZXh0IHRpbWUuCgkJCQkJcmV0dXJuOwoJCQkJfQoKCQkJCWlmICggY29uZGl0aW9uICkgewoJCQkJCS8vIEhvb2sgbm90IG5lZWRlZCAob3IgaXQncyBub3QgcG9zc2libGUgdG8gdXNlIGl0IGR1ZSB0byBtaXNzaW5nIGRlcGVuZGVuY3kpLAoJCQkJCS8vIHJlbW92ZSBpdC4KCQkJCQkvLyBTaW5jZSB0aGVyZSBhcmUgbm8gb3RoZXIgaG9va3MgZm9yIG1hcmdpblJpZ2h0LCByZW1vdmUgdGhlIHdob2xlIG9iamVjdC4KCQkJCQlkZWxldGUgdGhpcy5nZXQ7CgkJCQkJcmV0dXJuOwoJCQkJfQoKCQkJCS8vIEhvb2sgbmVlZGVkOyByZWRlZmluZSBpdCBzbyB0aGF0IHRoZSBzdXBwb3J0IHRlc3QgaXMgbm90IGV4ZWN1dGVkIGFnYWluLgoKCQkJCXJldHVybiAodGhpcy5nZXQgPSBob29rRm4pLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTsKCQkJfQoJCX07Cgl9CgoKCShmdW5jdGlvbigpIHsKCQkvLyBNaW5pZmllZDogdmFyIGIsYyxkLGUsZixnLCBoLGkKCQl2YXIgZGl2LCBzdHlsZSwgYSwgcGl4ZWxQb3NpdGlvblZhbCwgYm94U2l6aW5nUmVsaWFibGVWYWwsCgkJCXJlbGlhYmxlSGlkZGVuT2Zmc2V0c1ZhbCwgcmVsaWFibGVNYXJnaW5SaWdodFZhbDsKCgkJLy8gU2V0dXAKCQlkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApOwoJCWRpdi5pbm5lckhUTUwgPSAiICA8bGluay8+PHRhYmxlPjwvdGFibGU+PGEgaHJlZj0nL2EnPmE8L2E+PGlucHV0IHR5cGU9J2NoZWNrYm94Jy8+IjsKCQlhID0gZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAiYSIgKVsgMCBdOwoJCXN0eWxlID0gYSAmJiBhLnN0eWxlOwoKCQkvLyBGaW5pc2ggZWFybHkgaW4gbGltaXRlZCAobm9uLWJyb3dzZXIpIGVudmlyb25tZW50cwoJCWlmICggIXN0eWxlICkgewoJCQlyZXR1cm47CgkJfQoKCQlzdHlsZS5jc3NUZXh0ID0gImZsb2F0OmxlZnQ7b3BhY2l0eTouNSI7CgoJCS8vIFN1cHBvcnQ6IElFPDkKCQkvLyBNYWtlIHN1cmUgdGhhdCBlbGVtZW50IG9wYWNpdHkgZXhpc3RzIChhcyBvcHBvc2VkIHRvIGZpbHRlcikKCQlzdXBwb3J0Lm9wYWNpdHkgPSBzdHlsZS5vcGFjaXR5ID09PSAiMC41IjsKCgkJLy8gVmVyaWZ5IHN0eWxlIGZsb2F0IGV4aXN0ZW5jZQoJCS8vIChJRSB1c2VzIHN0eWxlRmxvYXQgaW5zdGVhZCBvZiBjc3NGbG9hdCkKCQlzdXBwb3J0LmNzc0Zsb2F0ID0gISFzdHlsZS5jc3NGbG9hdDsKCgkJZGl2LnN0eWxlLmJhY2tncm91bmRDbGlwID0gImNvbnRlbnQtYm94IjsKCQlkaXYuY2xvbmVOb2RlKCB0cnVlICkuc3R5bGUuYmFja2dyb3VuZENsaXAgPSAiIjsKCQlzdXBwb3J0LmNsZWFyQ2xvbmVTdHlsZSA9IGRpdi5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9PT0gImNvbnRlbnQtYm94IjsKCgkJLy8gU3VwcG9ydDogRmlyZWZveDwyOSwgQW5kcm9pZCAyLjMKCQkvLyBWZW5kb3ItcHJlZml4IGJveC1zaXppbmcKCQlzdXBwb3J0LmJveFNpemluZyA9IHN0eWxlLmJveFNpemluZyA9PT0gIiIgfHwgc3R5bGUuTW96Qm94U2l6aW5nID09PSAiIiB8fAoJCQlzdHlsZS5XZWJraXRCb3hTaXppbmcgPT09ICIiOwoKCQlqUXVlcnkuZXh0ZW5kKHN1cHBvcnQsIHsKCQkJcmVsaWFibGVIaWRkZW5PZmZzZXRzOiBmdW5jdGlvbigpIHsKCQkJCWlmICggcmVsaWFibGVIaWRkZW5PZmZzZXRzVmFsID09IG51bGwgKSB7CgkJCQkJY29tcHV0ZVN0eWxlVGVzdHMoKTsKCQkJCX0KCQkJCXJldHVybiByZWxpYWJsZUhpZGRlbk9mZnNldHNWYWw7CgkJCX0sCgoJCQlib3hTaXppbmdSZWxpYWJsZTogZnVuY3Rpb24oKSB7CgkJCQlpZiAoIGJveFNpemluZ1JlbGlhYmxlVmFsID09IG51bGwgKSB7CgkJCQkJY29tcHV0ZVN0eWxlVGVzdHMoKTsKCQkJCX0KCQkJCXJldHVybiBib3hTaXppbmdSZWxpYWJsZVZhbDsKCQkJfSwKCgkJCXBpeGVsUG9zaXRpb246IGZ1bmN0aW9uKCkgewoJCQkJaWYgKCBwaXhlbFBvc2l0aW9uVmFsID09IG51bGwgKSB7CgkJCQkJY29tcHV0ZVN0eWxlVGVzdHMoKTsKCQkJCX0KCQkJCXJldHVybiBwaXhlbFBvc2l0aW9uVmFsOwoJCQl9LAoKCQkJLy8gU3VwcG9ydDogQW5kcm9pZCAyLjMKCQkJcmVsaWFibGVNYXJnaW5SaWdodDogZnVuY3Rpb24oKSB7CgkJCQlpZiAoIHJlbGlhYmxlTWFyZ2luUmlnaHRWYWwgPT0gbnVsbCApIHsKCQkJCQljb21wdXRlU3R5bGVUZXN0cygpOwoJCQkJfQoJCQkJcmV0dXJuIHJlbGlhYmxlTWFyZ2luUmlnaHRWYWw7CgkJCX0KCQl9KTsKCgkJZnVuY3Rpb24gY29tcHV0ZVN0eWxlVGVzdHMoKSB7CgkJCS8vIE1pbmlmaWVkOiB2YXIgYixjLGQsagoJCQl2YXIgZGl2LCBib2R5LCBjb250YWluZXIsIGNvbnRlbnRzOwoKCQkJYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAiYm9keSIgKVsgMCBdOwoJCQlpZiAoICFib2R5IHx8ICFib2R5LnN0eWxlICkgewoJCQkJLy8gVGVzdCBmaXJlZCB0b28gZWFybHkgb3IgaW4gYW4gdW5zdXBwb3J0ZWQgZW52aXJvbm1lbnQsIGV4aXQuCgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIFNldHVwCgkJCWRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICk7CgkJCWNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICk7CgkJCWNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gInBvc2l0aW9uOmFic29sdXRlO2JvcmRlcjowO3dpZHRoOjA7aGVpZ2h0OjA7dG9wOjA7bGVmdDotOTk5OXB4IjsKCQkJYm9keS5hcHBlbmRDaGlsZCggY29udGFpbmVyICkuYXBwZW5kQ2hpbGQoIGRpdiApOwoKCQkJZGl2LnN0eWxlLmNzc1RleHQgPQoJCQkJLy8gU3VwcG9ydDogRmlyZWZveDwyOSwgQW5kcm9pZCAyLjMKCQkJCS8vIFZlbmRvci1wcmVmaXggYm94LXNpemluZwoJCQkJIi13ZWJraXQtYm94LXNpemluZzpib3JkZXItYm94Oy1tb3otYm94LXNpemluZzpib3JkZXItYm94OyIgKwoJCQkJImJveC1zaXppbmc6Ym9yZGVyLWJveDtkaXNwbGF5OmJsb2NrO21hcmdpbi10b3A6MSU7dG9wOjElOyIgKwoJCQkJImJvcmRlcjoxcHg7cGFkZGluZzoxcHg7d2lkdGg6NHB4O3Bvc2l0aW9uOmFic29sdXRlIjsKCgkJCS8vIFN1cHBvcnQ6IElFPDkKCQkJLy8gQXNzdW1lIHJlYXNvbmFibGUgdmFsdWVzIGluIHRoZSBhYnNlbmNlIG9mIGdldENvbXB1dGVkU3R5bGUKCQkJcGl4ZWxQb3NpdGlvblZhbCA9IGJveFNpemluZ1JlbGlhYmxlVmFsID0gZmFsc2U7CgkJCXJlbGlhYmxlTWFyZ2luUmlnaHRWYWwgPSB0cnVlOwoKCQkJLy8gQ2hlY2sgZm9yIGdldENvbXB1dGVkU3R5bGUgc28gdGhhdCB0aGlzIGNvZGUgaXMgbm90IHJ1biBpbiBJRTw5LgoJCQlpZiAoIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlICkgewoJCQkJcGl4ZWxQb3NpdGlvblZhbCA9ICggd2luZG93LmdldENvbXB1dGVkU3R5bGUoIGRpdiwgbnVsbCApIHx8IHt9ICkudG9wICE9PSAiMSUiOwoJCQkJYm94U2l6aW5nUmVsaWFibGVWYWwgPQoJCQkJCSggd2luZG93LmdldENvbXB1dGVkU3R5bGUoIGRpdiwgbnVsbCApIHx8IHsgd2lkdGg6ICI0cHgiIH0gKS53aWR0aCA9PT0gIjRweCI7CgoJCQkJLy8gU3VwcG9ydDogQW5kcm9pZCAyLjMKCQkJCS8vIERpdiB3aXRoIGV4cGxpY2l0IHdpZHRoIGFuZCBubyBtYXJnaW4tcmlnaHQgaW5jb3JyZWN0bHkKCQkJCS8vIGdldHMgY29tcHV0ZWQgbWFyZ2luLXJpZ2h0IGJhc2VkIG9uIHdpZHRoIG9mIGNvbnRhaW5lciAoIzMzMzMpCgkJCQkvLyBXZWJLaXQgQnVnIDEzMzQzIC0gZ2V0Q29tcHV0ZWRTdHlsZSByZXR1cm5zIHdyb25nIHZhbHVlIGZvciBtYXJnaW4tcmlnaHQKCQkJCWNvbnRlbnRzID0gZGl2LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApICk7CgoJCQkJLy8gUmVzZXQgQ1NTOiBib3gtc2l6aW5nOyBkaXNwbGF5OyBtYXJnaW47IGJvcmRlcjsgcGFkZGluZwoJCQkJY29udGVudHMuc3R5bGUuY3NzVGV4dCA9IGRpdi5zdHlsZS5jc3NUZXh0ID0KCQkJCQkvLyBTdXBwb3J0OiBGaXJlZm94PDI5LCBBbmRyb2lkIDIuMwoJCQkJCS8vIFZlbmRvci1wcmVmaXggYm94LXNpemluZwoJCQkJCSItd2Via2l0LWJveC1zaXppbmc6Y29udGVudC1ib3g7LW1vei1ib3gtc2l6aW5nOmNvbnRlbnQtYm94OyIgKwoJCQkJCSJib3gtc2l6aW5nOmNvbnRlbnQtYm94O2Rpc3BsYXk6YmxvY2s7bWFyZ2luOjA7Ym9yZGVyOjA7cGFkZGluZzowIjsKCQkJCWNvbnRlbnRzLnN0eWxlLm1hcmdpblJpZ2h0ID0gY29udGVudHMuc3R5bGUud2lkdGggPSAiMCI7CgkJCQlkaXYuc3R5bGUud2lkdGggPSAiMXB4IjsKCgkJCQlyZWxpYWJsZU1hcmdpblJpZ2h0VmFsID0KCQkJCQkhcGFyc2VGbG9hdCggKCB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSggY29udGVudHMsIG51bGwgKSB8fCB7fSApLm1hcmdpblJpZ2h0ICk7CgoJCQkJZGl2LnJlbW92ZUNoaWxkKCBjb250ZW50cyApOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRTgKCQkJLy8gQ2hlY2sgaWYgdGFibGUgY2VsbHMgc3RpbGwgaGF2ZSBvZmZzZXRXaWR0aC9IZWlnaHQgd2hlbiB0aGV5IGFyZSBzZXQKCQkJLy8gdG8gZGlzcGxheTpub25lIGFuZCB0aGVyZSBhcmUgc3RpbGwgb3RoZXIgdmlzaWJsZSB0YWJsZSBjZWxscyBpbiBhCgkJCS8vIHRhYmxlIHJvdzsgaWYgc28sIG9mZnNldFdpZHRoL0hlaWdodCBhcmUgbm90IHJlbGlhYmxlIGZvciB1c2Ugd2hlbgoJCQkvLyBkZXRlcm1pbmluZyBpZiBhbiBlbGVtZW50IGhhcyBiZWVuIGhpZGRlbiBkaXJlY3RseSB1c2luZwoJCQkvLyBkaXNwbGF5Om5vbmUgKGl0IGlzIHN0aWxsIHNhZmUgdG8gdXNlIG9mZnNldHMgaWYgYSBwYXJlbnQgZWxlbWVudCBpcwoJCQkvLyBoaWRkZW47IGRvbiBzYWZldHkgZ29nZ2xlcyBhbmQgc2VlIGJ1ZyAjNDUxMiBmb3IgbW9yZSBpbmZvcm1hdGlvbikuCgkJCWRpdi5pbm5lckhUTUwgPSAiPHRhYmxlPjx0cj48dGQ+PC90ZD48dGQ+dDwvdGQ+PC90cj48L3RhYmxlPiI7CgkJCWNvbnRlbnRzID0gZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAidGQiICk7CgkJCWNvbnRlbnRzWyAwIF0uc3R5bGUuY3NzVGV4dCA9ICJtYXJnaW46MDtib3JkZXI6MDtwYWRkaW5nOjA7ZGlzcGxheTpub25lIjsKCQkJcmVsaWFibGVIaWRkZW5PZmZzZXRzVmFsID0gY29udGVudHNbIDAgXS5vZmZzZXRIZWlnaHQgPT09IDA7CgkJCWlmICggcmVsaWFibGVIaWRkZW5PZmZzZXRzVmFsICkgewoJCQkJY29udGVudHNbIDAgXS5zdHlsZS5kaXNwbGF5ID0gIiI7CgkJCQljb250ZW50c1sgMSBdLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CgkJCQlyZWxpYWJsZUhpZGRlbk9mZnNldHNWYWwgPSBjb250ZW50c1sgMCBdLm9mZnNldEhlaWdodCA9PT0gMDsKCQkJfQoKCQkJYm9keS5yZW1vdmVDaGlsZCggY29udGFpbmVyICk7CgkJfQoKCX0pKCk7CgoKCS8vIEEgbWV0aG9kIGZvciBxdWlja2x5IHN3YXBwaW5nIGluL291dCBDU1MgcHJvcGVydGllcyB0byBnZXQgY29ycmVjdCBjYWxjdWxhdGlvbnMuCglqUXVlcnkuc3dhcCA9IGZ1bmN0aW9uKCBlbGVtLCBvcHRpb25zLCBjYWxsYmFjaywgYXJncyApIHsKCQl2YXIgcmV0LCBuYW1lLAoJCQlvbGQgPSB7fTsKCgkJLy8gUmVtZW1iZXIgdGhlIG9sZCB2YWx1ZXMsIGFuZCBpbnNlcnQgdGhlIG5ldyBvbmVzCgkJZm9yICggbmFtZSBpbiBvcHRpb25zICkgewoJCQlvbGRbIG5hbWUgXSA9IGVsZW0uc3R5bGVbIG5hbWUgXTsKCQkJZWxlbS5zdHlsZVsgbmFtZSBdID0gb3B0aW9uc1sgbmFtZSBdOwoJCX0KCgkJcmV0ID0gY2FsbGJhY2suYXBwbHkoIGVsZW0sIGFyZ3MgfHwgW10gKTsKCgkJLy8gUmV2ZXJ0IHRoZSBvbGQgdmFsdWVzCgkJZm9yICggbmFtZSBpbiBvcHRpb25zICkgewoJCQllbGVtLnN0eWxlWyBuYW1lIF0gPSBvbGRbIG5hbWUgXTsKCQl9CgoJCXJldHVybiByZXQ7Cgl9OwoKCgl2YXIKCQkJcmFscGhhID0gL2FscGhhXChbXildKlwpL2ksCgkJcm9wYWNpdHkgPSAvb3BhY2l0eVxzKj1ccyooW14pXSopLywKCgkJLy8gc3dhcHBhYmxlIGlmIGRpc3BsYXkgaXMgbm9uZSBvciBzdGFydHMgd2l0aCB0YWJsZSBleGNlcHQgInRhYmxlIiwgInRhYmxlLWNlbGwiLCBvciAidGFibGUtY2FwdGlvbiIKCQkvLyBzZWUgaGVyZSBmb3IgZGlzcGxheSB2YWx1ZXM6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvQ1NTL2Rpc3BsYXkKCQlyZGlzcGxheXN3YXAgPSAvXihub25lfHRhYmxlKD8hLWNbZWFdKS4rKS8sCgkJcm51bXNwbGl0ID0gbmV3IFJlZ0V4cCggIl4oIiArIHBudW0gKyAiKSguKikkIiwgImkiICksCgkJcnJlbE51bSA9IG5ldyBSZWdFeHAoICJeKFsrLV0pPSgiICsgcG51bSArICIpIiwgImkiICksCgoJCWNzc1Nob3cgPSB7IHBvc2l0aW9uOiAiYWJzb2x1dGUiLCB2aXNpYmlsaXR5OiAiaGlkZGVuIiwgZGlzcGxheTogImJsb2NrIiB9LAoJCWNzc05vcm1hbFRyYW5zZm9ybSA9IHsKCQkJbGV0dGVyU3BhY2luZzogIjAiLAoJCQlmb250V2VpZ2h0OiAiNDAwIgoJCX0sCgoJCWNzc1ByZWZpeGVzID0gWyAiV2Via2l0IiwgIk8iLCAiTW96IiwgIm1zIiBdOwoKCgkvLyByZXR1cm4gYSBjc3MgcHJvcGVydHkgbWFwcGVkIHRvIGEgcG90ZW50aWFsbHkgdmVuZG9yIHByZWZpeGVkIHByb3BlcnR5CglmdW5jdGlvbiB2ZW5kb3JQcm9wTmFtZSggc3R5bGUsIG5hbWUgKSB7CgoJCS8vIHNob3J0Y3V0IGZvciBuYW1lcyB0aGF0IGFyZSBub3QgdmVuZG9yIHByZWZpeGVkCgkJaWYgKCBuYW1lIGluIHN0eWxlICkgewoJCQlyZXR1cm4gbmFtZTsKCQl9CgoJCS8vIGNoZWNrIGZvciB2ZW5kb3IgcHJlZml4ZWQgbmFtZXMKCQl2YXIgY2FwTmFtZSA9IG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpLAoJCQlvcmlnTmFtZSA9IG5hbWUsCgkJCWkgPSBjc3NQcmVmaXhlcy5sZW5ndGg7CgoJCXdoaWxlICggaS0tICkgewoJCQluYW1lID0gY3NzUHJlZml4ZXNbIGkgXSArIGNhcE5hbWU7CgkJCWlmICggbmFtZSBpbiBzdHlsZSApIHsKCQkJCXJldHVybiBuYW1lOwoJCQl9CgkJfQoKCQlyZXR1cm4gb3JpZ05hbWU7Cgl9CgoJZnVuY3Rpb24gc2hvd0hpZGUoIGVsZW1lbnRzLCBzaG93ICkgewoJCXZhciBkaXNwbGF5LCBlbGVtLCBoaWRkZW4sCgkJCXZhbHVlcyA9IFtdLAoJCQlpbmRleCA9IDAsCgkJCWxlbmd0aCA9IGVsZW1lbnRzLmxlbmd0aDsKCgkJZm9yICggOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKyApIHsKCQkJZWxlbSA9IGVsZW1lbnRzWyBpbmRleCBdOwoJCQlpZiAoICFlbGVtLnN0eWxlICkgewoJCQkJY29udGludWU7CgkJCX0KCgkJCXZhbHVlc1sgaW5kZXggXSA9IGpRdWVyeS5fZGF0YSggZWxlbSwgIm9sZGRpc3BsYXkiICk7CgkJCWRpc3BsYXkgPSBlbGVtLnN0eWxlLmRpc3BsYXk7CgkJCWlmICggc2hvdyApIHsKCQkJCS8vIFJlc2V0IHRoZSBpbmxpbmUgZGlzcGxheSBvZiB0aGlzIGVsZW1lbnQgdG8gbGVhcm4gaWYgaXQgaXMKCQkJCS8vIGJlaW5nIGhpZGRlbiBieSBjYXNjYWRlZCBydWxlcyBvciBub3QKCQkJCWlmICggIXZhbHVlc1sgaW5kZXggXSAmJiBkaXNwbGF5ID09PSAibm9uZSIgKSB7CgkJCQkJZWxlbS5zdHlsZS5kaXNwbGF5ID0gIiI7CgkJCQl9CgoJCQkJLy8gU2V0IGVsZW1lbnRzIHdoaWNoIGhhdmUgYmVlbiBvdmVycmlkZGVuIHdpdGggZGlzcGxheTogbm9uZQoJCQkJLy8gaW4gYSBzdHlsZXNoZWV0IHRvIHdoYXRldmVyIHRoZSBkZWZhdWx0IGJyb3dzZXIgc3R5bGUgaXMKCQkJCS8vIGZvciBzdWNoIGFuIGVsZW1lbnQKCQkJCWlmICggZWxlbS5zdHlsZS5kaXNwbGF5ID09PSAiIiAmJiBpc0hpZGRlbiggZWxlbSApICkgewoJCQkJCXZhbHVlc1sgaW5kZXggXSA9IGpRdWVyeS5fZGF0YSggZWxlbSwgIm9sZGRpc3BsYXkiLCBkZWZhdWx0RGlzcGxheShlbGVtLm5vZGVOYW1lKSApOwoJCQkJfQoJCQl9IGVsc2UgewoJCQkJaGlkZGVuID0gaXNIaWRkZW4oIGVsZW0gKTsKCgkJCQlpZiAoIGRpc3BsYXkgJiYgZGlzcGxheSAhPT0gIm5vbmUiIHx8ICFoaWRkZW4gKSB7CgkJCQkJalF1ZXJ5Ll9kYXRhKCBlbGVtLCAib2xkZGlzcGxheSIsIGhpZGRlbiA/IGRpc3BsYXkgOiBqUXVlcnkuY3NzKCBlbGVtLCAiZGlzcGxheSIgKSApOwoJCQkJfQoJCQl9CgkJfQoKCQkvLyBTZXQgdGhlIGRpc3BsYXkgb2YgbW9zdCBvZiB0aGUgZWxlbWVudHMgaW4gYSBzZWNvbmQgbG9vcAoJCS8vIHRvIGF2b2lkIHRoZSBjb25zdGFudCByZWZsb3cKCQlmb3IgKCBpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrICkgewoJCQllbGVtID0gZWxlbWVudHNbIGluZGV4IF07CgkJCWlmICggIWVsZW0uc3R5bGUgKSB7CgkJCQljb250aW51ZTsKCQkJfQoJCQlpZiAoICFzaG93IHx8IGVsZW0uc3R5bGUuZGlzcGxheSA9PT0gIm5vbmUiIHx8IGVsZW0uc3R5bGUuZGlzcGxheSA9PT0gIiIgKSB7CgkJCQllbGVtLnN0eWxlLmRpc3BsYXkgPSBzaG93ID8gdmFsdWVzWyBpbmRleCBdIHx8ICIiIDogIm5vbmUiOwoJCQl9CgkJfQoKCQlyZXR1cm4gZWxlbWVudHM7Cgl9CgoJZnVuY3Rpb24gc2V0UG9zaXRpdmVOdW1iZXIoIGVsZW0sIHZhbHVlLCBzdWJ0cmFjdCApIHsKCQl2YXIgbWF0Y2hlcyA9IHJudW1zcGxpdC5leGVjKCB2YWx1ZSApOwoJCXJldHVybiBtYXRjaGVzID8KCQkJLy8gR3VhcmQgYWdhaW5zdCB1bmRlZmluZWQgInN1YnRyYWN0IiwgZS5nLiwgd2hlbiB1c2VkIGFzIGluIGNzc0hvb2tzCgkJCU1hdGgubWF4KCAwLCBtYXRjaGVzWyAxIF0gLSAoIHN1YnRyYWN0IHx8IDAgKSApICsgKCBtYXRjaGVzWyAyIF0gfHwgInB4IiApIDoKCQkJdmFsdWU7Cgl9CgoJZnVuY3Rpb24gYXVnbWVudFdpZHRoT3JIZWlnaHQoIGVsZW0sIG5hbWUsIGV4dHJhLCBpc0JvcmRlckJveCwgc3R5bGVzICkgewoJCXZhciBpID0gZXh0cmEgPT09ICggaXNCb3JkZXJCb3ggPyAiYm9yZGVyIiA6ICJjb250ZW50IiApID8KCQkJLy8gSWYgd2UgYWxyZWFkeSBoYXZlIHRoZSByaWdodCBtZWFzdXJlbWVudCwgYXZvaWQgYXVnbWVudGF0aW9uCgkJCTQgOgoJCQkvLyBPdGhlcndpc2UgaW5pdGlhbGl6ZSBmb3IgaG9yaXpvbnRhbCBvciB2ZXJ0aWNhbCBwcm9wZXJ0aWVzCgkJCW5hbWUgPT09ICJ3aWR0aCIgPyAxIDogMCwKCgkJCXZhbCA9IDA7CgoJCWZvciAoIDsgaSA8IDQ7IGkgKz0gMiApIHsKCQkJLy8gYm90aCBib3ggbW9kZWxzIGV4Y2x1ZGUgbWFyZ2luLCBzbyBhZGQgaXQgaWYgd2Ugd2FudCBpdAoJCQlpZiAoIGV4dHJhID09PSAibWFyZ2luIiApIHsKCQkJCXZhbCArPSBqUXVlcnkuY3NzKCBlbGVtLCBleHRyYSArIGNzc0V4cGFuZFsgaSBdLCB0cnVlLCBzdHlsZXMgKTsKCQkJfQoKCQkJaWYgKCBpc0JvcmRlckJveCApIHsKCQkJCS8vIGJvcmRlci1ib3ggaW5jbHVkZXMgcGFkZGluZywgc28gcmVtb3ZlIGl0IGlmIHdlIHdhbnQgY29udGVudAoJCQkJaWYgKCBleHRyYSA9PT0gImNvbnRlbnQiICkgewoJCQkJCXZhbCAtPSBqUXVlcnkuY3NzKCBlbGVtLCAicGFkZGluZyIgKyBjc3NFeHBhbmRbIGkgXSwgdHJ1ZSwgc3R5bGVzICk7CgkJCQl9CgoJCQkJLy8gYXQgdGhpcyBwb2ludCwgZXh0cmEgaXNuJ3QgYm9yZGVyIG5vciBtYXJnaW4sIHNvIHJlbW92ZSBib3JkZXIKCQkJCWlmICggZXh0cmEgIT09ICJtYXJnaW4iICkgewoJCQkJCXZhbCAtPSBqUXVlcnkuY3NzKCBlbGVtLCAiYm9yZGVyIiArIGNzc0V4cGFuZFsgaSBdICsgIldpZHRoIiwgdHJ1ZSwgc3R5bGVzICk7CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQkvLyBhdCB0aGlzIHBvaW50LCBleHRyYSBpc24ndCBjb250ZW50LCBzbyBhZGQgcGFkZGluZwoJCQkJdmFsICs9IGpRdWVyeS5jc3MoIGVsZW0sICJwYWRkaW5nIiArIGNzc0V4cGFuZFsgaSBdLCB0cnVlLCBzdHlsZXMgKTsKCgkJCQkvLyBhdCB0aGlzIHBvaW50LCBleHRyYSBpc24ndCBjb250ZW50IG5vciBwYWRkaW5nLCBzbyBhZGQgYm9yZGVyCgkJCQlpZiAoIGV4dHJhICE9PSAicGFkZGluZyIgKSB7CgkJCQkJdmFsICs9IGpRdWVyeS5jc3MoIGVsZW0sICJib3JkZXIiICsgY3NzRXhwYW5kWyBpIF0gKyAiV2lkdGgiLCB0cnVlLCBzdHlsZXMgKTsKCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIHZhbDsKCX0KCglmdW5jdGlvbiBnZXRXaWR0aE9ySGVpZ2h0KCBlbGVtLCBuYW1lLCBleHRyYSApIHsKCgkJLy8gU3RhcnQgd2l0aCBvZmZzZXQgcHJvcGVydHksIHdoaWNoIGlzIGVxdWl2YWxlbnQgdG8gdGhlIGJvcmRlci1ib3ggdmFsdWUKCQl2YXIgdmFsdWVJc0JvcmRlckJveCA9IHRydWUsCgkJCXZhbCA9IG5hbWUgPT09ICJ3aWR0aCIgPyBlbGVtLm9mZnNldFdpZHRoIDogZWxlbS5vZmZzZXRIZWlnaHQsCgkJCXN0eWxlcyA9IGdldFN0eWxlcyggZWxlbSApLAoJCQlpc0JvcmRlckJveCA9IHN1cHBvcnQuYm94U2l6aW5nICYmIGpRdWVyeS5jc3MoIGVsZW0sICJib3hTaXppbmciLCBmYWxzZSwgc3R5bGVzICkgPT09ICJib3JkZXItYm94IjsKCgkJLy8gc29tZSBub24taHRtbCBlbGVtZW50cyByZXR1cm4gdW5kZWZpbmVkIGZvciBvZmZzZXRXaWR0aCwgc28gY2hlY2sgZm9yIG51bGwvdW5kZWZpbmVkCgkJLy8gc3ZnIC0gaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NjQ5Mjg1CgkJLy8gTWF0aE1MIC0gaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NDkxNjY4CgkJaWYgKCB2YWwgPD0gMCB8fCB2YWwgPT0gbnVsbCApIHsKCQkJLy8gRmFsbCBiYWNrIHRvIGNvbXB1dGVkIHRoZW4gdW5jb21wdXRlZCBjc3MgaWYgbmVjZXNzYXJ5CgkJCXZhbCA9IGN1ckNTUyggZWxlbSwgbmFtZSwgc3R5bGVzICk7CgkJCWlmICggdmFsIDwgMCB8fCB2YWwgPT0gbnVsbCApIHsKCQkJCXZhbCA9IGVsZW0uc3R5bGVbIG5hbWUgXTsKCQkJfQoKCQkJLy8gQ29tcHV0ZWQgdW5pdCBpcyBub3QgcGl4ZWxzLiBTdG9wIGhlcmUgYW5kIHJldHVybi4KCQkJaWYgKCBybnVtbm9ucHgudGVzdCh2YWwpICkgewoJCQkJcmV0dXJuIHZhbDsKCQkJfQoKCQkJLy8gd2UgbmVlZCB0aGUgY2hlY2sgZm9yIHN0eWxlIGluIGNhc2UgYSBicm93c2VyIHdoaWNoIHJldHVybnMgdW5yZWxpYWJsZSB2YWx1ZXMKCQkJLy8gZm9yIGdldENvbXB1dGVkU3R5bGUgc2lsZW50bHkgZmFsbHMgYmFjayB0byB0aGUgcmVsaWFibGUgZWxlbS5zdHlsZQoJCQl2YWx1ZUlzQm9yZGVyQm94ID0gaXNCb3JkZXJCb3ggJiYgKCBzdXBwb3J0LmJveFNpemluZ1JlbGlhYmxlKCkgfHwgdmFsID09PSBlbGVtLnN0eWxlWyBuYW1lIF0gKTsKCgkJCS8vIE5vcm1hbGl6ZSAiIiwgYXV0bywgYW5kIHByZXBhcmUgZm9yIGV4dHJhCgkJCXZhbCA9IHBhcnNlRmxvYXQoIHZhbCApIHx8IDA7CgkJfQoKCQkvLyB1c2UgdGhlIGFjdGl2ZSBib3gtc2l6aW5nIG1vZGVsIHRvIGFkZC9zdWJ0cmFjdCBpcnJlbGV2YW50IHN0eWxlcwoJCXJldHVybiAoIHZhbCArCgkJCWF1Z21lbnRXaWR0aE9ySGVpZ2h0KAoJCQkJZWxlbSwKCQkJCW5hbWUsCgkJCQlleHRyYSB8fCAoIGlzQm9yZGVyQm94ID8gImJvcmRlciIgOiAiY29udGVudCIgKSwKCQkJCXZhbHVlSXNCb3JkZXJCb3gsCgkJCQlzdHlsZXMKCQkJKQoJCSkgKyAicHgiOwoJfQoKCWpRdWVyeS5leHRlbmQoewoJCS8vIEFkZCBpbiBzdHlsZSBwcm9wZXJ0eSBob29rcyBmb3Igb3ZlcnJpZGluZyB0aGUgZGVmYXVsdAoJCS8vIGJlaGF2aW9yIG9mIGdldHRpbmcgYW5kIHNldHRpbmcgYSBzdHlsZSBwcm9wZXJ0eQoJCWNzc0hvb2tzOiB7CgkJCW9wYWNpdHk6IHsKCQkJCWdldDogZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkICkgewoJCQkJCWlmICggY29tcHV0ZWQgKSB7CgkJCQkJCS8vIFdlIHNob3VsZCBhbHdheXMgZ2V0IGEgbnVtYmVyIGJhY2sgZnJvbSBvcGFjaXR5CgkJCQkJCXZhciByZXQgPSBjdXJDU1MoIGVsZW0sICJvcGFjaXR5IiApOwoJCQkJCQlyZXR1cm4gcmV0ID09PSAiIiA/ICIxIiA6IHJldDsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9LAoKCQkvLyBEb24ndCBhdXRvbWF0aWNhbGx5IGFkZCAicHgiIHRvIHRoZXNlIHBvc3NpYmx5LXVuaXRsZXNzIHByb3BlcnRpZXMKCQljc3NOdW1iZXI6IHsKCQkJImNvbHVtbkNvdW50IjogdHJ1ZSwKCQkJImZpbGxPcGFjaXR5IjogdHJ1ZSwKCQkJImZsZXhHcm93IjogdHJ1ZSwKCQkJImZsZXhTaHJpbmsiOiB0cnVlLAoJCQkiZm9udFdlaWdodCI6IHRydWUsCgkJCSJsaW5lSGVpZ2h0IjogdHJ1ZSwKCQkJIm9wYWNpdHkiOiB0cnVlLAoJCQkib3JkZXIiOiB0cnVlLAoJCQkib3JwaGFucyI6IHRydWUsCgkJCSJ3aWRvd3MiOiB0cnVlLAoJCQkiekluZGV4IjogdHJ1ZSwKCQkJInpvb20iOiB0cnVlCgkJfSwKCgkJLy8gQWRkIGluIHByb3BlcnRpZXMgd2hvc2UgbmFtZXMgeW91IHdpc2ggdG8gZml4IGJlZm9yZQoJCS8vIHNldHRpbmcgb3IgZ2V0dGluZyB0aGUgdmFsdWUKCQljc3NQcm9wczogewoJCQkvLyBub3JtYWxpemUgZmxvYXQgY3NzIHByb3BlcnR5CgkJCSJmbG9hdCI6IHN1cHBvcnQuY3NzRmxvYXQgPyAiY3NzRmxvYXQiIDogInN0eWxlRmxvYXQiCgkJfSwKCgkJLy8gR2V0IGFuZCBzZXQgdGhlIHN0eWxlIHByb3BlcnR5IG9uIGEgRE9NIE5vZGUKCQlzdHlsZTogZnVuY3Rpb24oIGVsZW0sIG5hbWUsIHZhbHVlLCBleHRyYSApIHsKCQkJLy8gRG9uJ3Qgc2V0IHN0eWxlcyBvbiB0ZXh0IGFuZCBjb21tZW50IG5vZGVzCgkJCWlmICggIWVsZW0gfHwgZWxlbS5ub2RlVHlwZSA9PT0gMyB8fCBlbGVtLm5vZGVUeXBlID09PSA4IHx8ICFlbGVtLnN0eWxlICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBNYWtlIHN1cmUgdGhhdCB3ZSdyZSB3b3JraW5nIHdpdGggdGhlIHJpZ2h0IG5hbWUKCQkJdmFyIHJldCwgdHlwZSwgaG9va3MsCgkJCQlvcmlnTmFtZSA9IGpRdWVyeS5jYW1lbENhc2UoIG5hbWUgKSwKCQkJCXN0eWxlID0gZWxlbS5zdHlsZTsKCgkJCW5hbWUgPSBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gfHwgKCBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gPSB2ZW5kb3JQcm9wTmFtZSggc3R5bGUsIG9yaWdOYW1lICkgKTsKCgkJCS8vIGdldHMgaG9vayBmb3IgdGhlIHByZWZpeGVkIHZlcnNpb24KCQkJLy8gZm9sbG93ZWQgYnkgdGhlIHVucHJlZml4ZWQgdmVyc2lvbgoJCQlob29rcyA9IGpRdWVyeS5jc3NIb29rc1sgbmFtZSBdIHx8IGpRdWVyeS5jc3NIb29rc1sgb3JpZ05hbWUgXTsKCgkJCS8vIENoZWNrIGlmIHdlJ3JlIHNldHRpbmcgYSB2YWx1ZQoJCQlpZiAoIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7CgkJCQl0eXBlID0gdHlwZW9mIHZhbHVlOwoKCQkJCS8vIGNvbnZlcnQgcmVsYXRpdmUgbnVtYmVyIHN0cmluZ3MgKCs9IG9yIC09KSB0byByZWxhdGl2ZSBudW1iZXJzLiAjNzM0NQoJCQkJaWYgKCB0eXBlID09PSAic3RyaW5nIiAmJiAocmV0ID0gcnJlbE51bS5leGVjKCB2YWx1ZSApKSApIHsKCQkJCQl2YWx1ZSA9ICggcmV0WzFdICsgMSApICogcmV0WzJdICsgcGFyc2VGbG9hdCggalF1ZXJ5LmNzcyggZWxlbSwgbmFtZSApICk7CgkJCQkJLy8gRml4ZXMgYnVnICM5MjM3CgkJCQkJdHlwZSA9ICJudW1iZXIiOwoJCQkJfQoKCQkJCS8vIE1ha2Ugc3VyZSB0aGF0IG51bGwgYW5kIE5hTiB2YWx1ZXMgYXJlbid0IHNldC4gU2VlOiAjNzExNgoJCQkJaWYgKCB2YWx1ZSA9PSBudWxsIHx8IHZhbHVlICE9PSB2YWx1ZSApIHsKCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJLy8gSWYgYSBudW1iZXIgd2FzIHBhc3NlZCBpbiwgYWRkICdweCcgdG8gdGhlIChleGNlcHQgZm9yIGNlcnRhaW4gQ1NTIHByb3BlcnRpZXMpCgkJCQlpZiAoIHR5cGUgPT09ICJudW1iZXIiICYmICFqUXVlcnkuY3NzTnVtYmVyWyBvcmlnTmFtZSBdICkgewoJCQkJCXZhbHVlICs9ICJweCI7CgkJCQl9CgoJCQkJLy8gRml4ZXMgIzg5MDgsIGl0IGNhbiBiZSBkb25lIG1vcmUgY29ycmVjdGx5IGJ5IHNwZWNpZmluZyBzZXR0ZXJzIGluIGNzc0hvb2tzLAoJCQkJLy8gYnV0IGl0IHdvdWxkIG1lYW4gdG8gZGVmaW5lIGVpZ2h0IChmb3IgZXZlcnkgcHJvYmxlbWF0aWMgcHJvcGVydHkpIGlkZW50aWNhbCBmdW5jdGlvbnMKCQkJCWlmICggIXN1cHBvcnQuY2xlYXJDbG9uZVN0eWxlICYmIHZhbHVlID09PSAiIiAmJiBuYW1lLmluZGV4T2YoImJhY2tncm91bmQiKSA9PT0gMCApIHsKCQkJCQlzdHlsZVsgbmFtZSBdID0gImluaGVyaXQiOwoJCQkJfQoKCQkJCS8vIElmIGEgaG9vayB3YXMgcHJvdmlkZWQsIHVzZSB0aGF0IHZhbHVlLCBvdGhlcndpc2UganVzdCBzZXQgdGhlIHNwZWNpZmllZCB2YWx1ZQoJCQkJaWYgKCAhaG9va3MgfHwgISgic2V0IiBpbiBob29rcykgfHwgKHZhbHVlID0gaG9va3Muc2V0KCBlbGVtLCB2YWx1ZSwgZXh0cmEgKSkgIT09IHVuZGVmaW5lZCApIHsKCgkJCQkJLy8gU3VwcG9ydDogSUUKCQkJCQkvLyBTd2FsbG93IGVycm9ycyBmcm9tICdpbnZhbGlkJyBDU1MgdmFsdWVzICgjNTUwOSkKCQkJCQl0cnkgewoJCQkJCQlzdHlsZVsgbmFtZSBdID0gdmFsdWU7CgkJCQkJfSBjYXRjaChlKSB7fQoJCQkJfQoKCQkJfSBlbHNlIHsKCQkJCS8vIElmIGEgaG9vayB3YXMgcHJvdmlkZWQgZ2V0IHRoZSBub24tY29tcHV0ZWQgdmFsdWUgZnJvbSB0aGVyZQoJCQkJaWYgKCBob29rcyAmJiAiZ2V0IiBpbiBob29rcyAmJiAocmV0ID0gaG9va3MuZ2V0KCBlbGVtLCBmYWxzZSwgZXh0cmEgKSkgIT09IHVuZGVmaW5lZCApIHsKCQkJCQlyZXR1cm4gcmV0OwoJCQkJfQoKCQkJCS8vIE90aGVyd2lzZSBqdXN0IGdldCB0aGUgdmFsdWUgZnJvbSB0aGUgc3R5bGUgb2JqZWN0CgkJCQlyZXR1cm4gc3R5bGVbIG5hbWUgXTsKCQkJfQoJCX0sCgoJCWNzczogZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGV4dHJhLCBzdHlsZXMgKSB7CgkJCXZhciBudW0sIHZhbCwgaG9va3MsCgkJCQlvcmlnTmFtZSA9IGpRdWVyeS5jYW1lbENhc2UoIG5hbWUgKTsKCgkJCS8vIE1ha2Ugc3VyZSB0aGF0IHdlJ3JlIHdvcmtpbmcgd2l0aCB0aGUgcmlnaHQgbmFtZQoJCQluYW1lID0galF1ZXJ5LmNzc1Byb3BzWyBvcmlnTmFtZSBdIHx8ICggalF1ZXJ5LmNzc1Byb3BzWyBvcmlnTmFtZSBdID0gdmVuZG9yUHJvcE5hbWUoIGVsZW0uc3R5bGUsIG9yaWdOYW1lICkgKTsKCgkJCS8vIGdldHMgaG9vayBmb3IgdGhlIHByZWZpeGVkIHZlcnNpb24KCQkJLy8gZm9sbG93ZWQgYnkgdGhlIHVucHJlZml4ZWQgdmVyc2lvbgoJCQlob29rcyA9IGpRdWVyeS5jc3NIb29rc1sgbmFtZSBdIHx8IGpRdWVyeS5jc3NIb29rc1sgb3JpZ05hbWUgXTsKCgkJCS8vIElmIGEgaG9vayB3YXMgcHJvdmlkZWQgZ2V0IHRoZSBjb21wdXRlZCB2YWx1ZSBmcm9tIHRoZXJlCgkJCWlmICggaG9va3MgJiYgImdldCIgaW4gaG9va3MgKSB7CgkJCQl2YWwgPSBob29rcy5nZXQoIGVsZW0sIHRydWUsIGV4dHJhICk7CgkJCX0KCgkJCS8vIE90aGVyd2lzZSwgaWYgYSB3YXkgdG8gZ2V0IHRoZSBjb21wdXRlZCB2YWx1ZSBleGlzdHMsIHVzZSB0aGF0CgkJCWlmICggdmFsID09PSB1bmRlZmluZWQgKSB7CgkJCQl2YWwgPSBjdXJDU1MoIGVsZW0sIG5hbWUsIHN0eWxlcyApOwoJCQl9CgoJCQkvL2NvbnZlcnQgIm5vcm1hbCIgdG8gY29tcHV0ZWQgdmFsdWUKCQkJaWYgKCB2YWwgPT09ICJub3JtYWwiICYmIG5hbWUgaW4gY3NzTm9ybWFsVHJhbnNmb3JtICkgewoJCQkJdmFsID0gY3NzTm9ybWFsVHJhbnNmb3JtWyBuYW1lIF07CgkJCX0KCgkJCS8vIFJldHVybiwgY29udmVydGluZyB0byBudW1iZXIgaWYgZm9yY2VkIG9yIGEgcXVhbGlmaWVyIHdhcyBwcm92aWRlZCBhbmQgdmFsIGxvb2tzIG51bWVyaWMKCQkJaWYgKCBleHRyYSA9PT0gIiIgfHwgZXh0cmEgKSB7CgkJCQludW0gPSBwYXJzZUZsb2F0KCB2YWwgKTsKCQkJCXJldHVybiBleHRyYSA9PT0gdHJ1ZSB8fCBqUXVlcnkuaXNOdW1lcmljKCBudW0gKSA/IG51bSB8fCAwIDogdmFsOwoJCQl9CgkJCXJldHVybiB2YWw7CgkJfQoJfSk7CgoJalF1ZXJ5LmVhY2goWyAiaGVpZ2h0IiwgIndpZHRoIiBdLCBmdW5jdGlvbiggaSwgbmFtZSApIHsKCQlqUXVlcnkuY3NzSG9va3NbIG5hbWUgXSA9IHsKCQkJZ2V0OiBmdW5jdGlvbiggZWxlbSwgY29tcHV0ZWQsIGV4dHJhICkgewoJCQkJaWYgKCBjb21wdXRlZCApIHsKCQkJCQkvLyBjZXJ0YWluIGVsZW1lbnRzIGNhbiBoYXZlIGRpbWVuc2lvbiBpbmZvIGlmIHdlIGludmlzaWJseSBzaG93IHRoZW0KCQkJCQkvLyBob3dldmVyLCBpdCBtdXN0IGhhdmUgYSBjdXJyZW50IGRpc3BsYXkgc3R5bGUgdGhhdCB3b3VsZCBiZW5lZml0IGZyb20gdGhpcwoJCQkJCXJldHVybiByZGlzcGxheXN3YXAudGVzdCggalF1ZXJ5LmNzcyggZWxlbSwgImRpc3BsYXkiICkgKSAmJiBlbGVtLm9mZnNldFdpZHRoID09PSAwID8KCQkJCQkJalF1ZXJ5LnN3YXAoIGVsZW0sIGNzc1Nob3csIGZ1bmN0aW9uKCkgewoJCQkJCQkJcmV0dXJuIGdldFdpZHRoT3JIZWlnaHQoIGVsZW0sIG5hbWUsIGV4dHJhICk7CgkJCQkJCX0pIDoKCQkJCQkJZ2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKTsKCQkJCX0KCQkJfSwKCgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlLCBleHRyYSApIHsKCQkJCXZhciBzdHlsZXMgPSBleHRyYSAmJiBnZXRTdHlsZXMoIGVsZW0gKTsKCQkJCXJldHVybiBzZXRQb3NpdGl2ZU51bWJlciggZWxlbSwgdmFsdWUsIGV4dHJhID8KCQkJCQlhdWdtZW50V2lkdGhPckhlaWdodCgKCQkJCQkJZWxlbSwKCQkJCQkJbmFtZSwKCQkJCQkJZXh0cmEsCgkJCQkJCXN1cHBvcnQuYm94U2l6aW5nICYmIGpRdWVyeS5jc3MoIGVsZW0sICJib3hTaXppbmciLCBmYWxzZSwgc3R5bGVzICkgPT09ICJib3JkZXItYm94IiwKCQkJCQkJc3R5bGVzCgkJCQkJKSA6IDAKCQkJCSk7CgkJCX0KCQl9OwoJfSk7CgoJaWYgKCAhc3VwcG9ydC5vcGFjaXR5ICkgewoJCWpRdWVyeS5jc3NIb29rcy5vcGFjaXR5ID0gewoJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCApIHsKCQkJCS8vIElFIHVzZXMgZmlsdGVycyBmb3Igb3BhY2l0eQoJCQkJcmV0dXJuIHJvcGFjaXR5LnRlc3QoIChjb21wdXRlZCAmJiBlbGVtLmN1cnJlbnRTdHlsZSA/IGVsZW0uY3VycmVudFN0eWxlLmZpbHRlciA6IGVsZW0uc3R5bGUuZmlsdGVyKSB8fCAiIiApID8KCQkJCQkoIDAuMDEgKiBwYXJzZUZsb2F0KCBSZWdFeHAuJDEgKSApICsgIiIgOgoJCQkJCWNvbXB1dGVkID8gIjEiIDogIiI7CgkJCX0sCgoJCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHsKCQkJCXZhciBzdHlsZSA9IGVsZW0uc3R5bGUsCgkJCQkJY3VycmVudFN0eWxlID0gZWxlbS5jdXJyZW50U3R5bGUsCgkJCQkJb3BhY2l0eSA9IGpRdWVyeS5pc051bWVyaWMoIHZhbHVlICkgPyAiYWxwaGEob3BhY2l0eT0iICsgdmFsdWUgKiAxMDAgKyAiKSIgOiAiIiwKCQkJCQlmaWx0ZXIgPSBjdXJyZW50U3R5bGUgJiYgY3VycmVudFN0eWxlLmZpbHRlciB8fCBzdHlsZS5maWx0ZXIgfHwgIiI7CgoJCQkJLy8gSUUgaGFzIHRyb3VibGUgd2l0aCBvcGFjaXR5IGlmIGl0IGRvZXMgbm90IGhhdmUgbGF5b3V0CgkJCQkvLyBGb3JjZSBpdCBieSBzZXR0aW5nIHRoZSB6b29tIGxldmVsCgkJCQlzdHlsZS56b29tID0gMTsKCgkJCQkvLyBpZiBzZXR0aW5nIG9wYWNpdHkgdG8gMSwgYW5kIG5vIG90aGVyIGZpbHRlcnMgZXhpc3QgLSBhdHRlbXB0IHRvIHJlbW92ZSBmaWx0ZXIgYXR0cmlidXRlICM2NjUyCgkJCQkvLyBpZiB2YWx1ZSA9PT0gIiIsIHRoZW4gcmVtb3ZlIGlubGluZSBvcGFjaXR5ICMxMjY4NQoJCQkJaWYgKCAoIHZhbHVlID49IDEgfHwgdmFsdWUgPT09ICIiICkgJiYKCQkJCQkJalF1ZXJ5LnRyaW0oIGZpbHRlci5yZXBsYWNlKCByYWxwaGEsICIiICkgKSA9PT0gIiIgJiYKCQkJCQkJc3R5bGUucmVtb3ZlQXR0cmlidXRlICkgewoKCQkJCQkvLyBTZXR0aW5nIHN0eWxlLmZpbHRlciB0byBudWxsLCAiIiAmICIgIiBzdGlsbCBsZWF2ZSAiZmlsdGVyOiIgaW4gdGhlIGNzc1RleHQKCQkJCQkvLyBpZiAiZmlsdGVyOiIgaXMgcHJlc2VudCBhdCBhbGwsIGNsZWFyVHlwZSBpcyBkaXNhYmxlZCwgd2Ugd2FudCB0byBhdm9pZCB0aGlzCgkJCQkJLy8gc3R5bGUucmVtb3ZlQXR0cmlidXRlIGlzIElFIE9ubHksIGJ1dCBzbyBhcHBhcmVudGx5IGlzIHRoaXMgY29kZSBwYXRoLi4uCgkJCQkJc3R5bGUucmVtb3ZlQXR0cmlidXRlKCAiZmlsdGVyIiApOwoKCQkJCQkvLyBpZiB0aGVyZSBpcyBubyBmaWx0ZXIgc3R5bGUgYXBwbGllZCBpbiBhIGNzcyBydWxlIG9yIHVuc2V0IGlubGluZSBvcGFjaXR5LCB3ZSBhcmUgZG9uZQoJCQkJCWlmICggdmFsdWUgPT09ICIiIHx8IGN1cnJlbnRTdHlsZSAmJiAhY3VycmVudFN0eWxlLmZpbHRlciApIHsKCQkJCQkJcmV0dXJuOwoJCQkJCX0KCQkJCX0KCgkJCQkvLyBvdGhlcndpc2UsIHNldCBuZXcgZmlsdGVyIHZhbHVlcwoJCQkJc3R5bGUuZmlsdGVyID0gcmFscGhhLnRlc3QoIGZpbHRlciApID8KCQkJCQlmaWx0ZXIucmVwbGFjZSggcmFscGhhLCBvcGFjaXR5ICkgOgoJCQkJCWZpbHRlciArICIgIiArIG9wYWNpdHk7CgkJCX0KCQl9OwoJfQoKCWpRdWVyeS5jc3NIb29rcy5tYXJnaW5SaWdodCA9IGFkZEdldEhvb2tJZiggc3VwcG9ydC5yZWxpYWJsZU1hcmdpblJpZ2h0LAoJCWZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCApIHsKCQkJaWYgKCBjb21wdXRlZCApIHsKCQkJCS8vIFdlYktpdCBCdWcgMTMzNDMgLSBnZXRDb21wdXRlZFN0eWxlIHJldHVybnMgd3JvbmcgdmFsdWUgZm9yIG1hcmdpbi1yaWdodAoJCQkJLy8gV29yayBhcm91bmQgYnkgdGVtcG9yYXJpbHkgc2V0dGluZyBlbGVtZW50IGRpc3BsYXkgdG8gaW5saW5lLWJsb2NrCgkJCQlyZXR1cm4galF1ZXJ5LnN3YXAoIGVsZW0sIHsgImRpc3BsYXkiOiAiaW5saW5lLWJsb2NrIiB9LAoJCQkJCWN1ckNTUywgWyBlbGVtLCAibWFyZ2luUmlnaHQiIF0gKTsKCQkJfQoJCX0KCSk7CgoJLy8gVGhlc2UgaG9va3MgYXJlIHVzZWQgYnkgYW5pbWF0ZSB0byBleHBhbmQgcHJvcGVydGllcwoJalF1ZXJ5LmVhY2goewoJCW1hcmdpbjogIiIsCgkJcGFkZGluZzogIiIsCgkJYm9yZGVyOiAiV2lkdGgiCgl9LCBmdW5jdGlvbiggcHJlZml4LCBzdWZmaXggKSB7CgkJalF1ZXJ5LmNzc0hvb2tzWyBwcmVmaXggKyBzdWZmaXggXSA9IHsKCQkJZXhwYW5kOiBmdW5jdGlvbiggdmFsdWUgKSB7CgkJCQl2YXIgaSA9IDAsCgkJCQkJZXhwYW5kZWQgPSB7fSwKCgkJCQkJLy8gYXNzdW1lcyBhIHNpbmdsZSBudW1iZXIgaWYgbm90IGEgc3RyaW5nCgkJCQkJcGFydHMgPSB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciID8gdmFsdWUuc3BsaXQoIiAiKSA6IFsgdmFsdWUgXTsKCgkJCQlmb3IgKCA7IGkgPCA0OyBpKysgKSB7CgkJCQkJZXhwYW5kZWRbIHByZWZpeCArIGNzc0V4cGFuZFsgaSBdICsgc3VmZml4IF0gPQoJCQkJCQlwYXJ0c1sgaSBdIHx8IHBhcnRzWyBpIC0gMiBdIHx8IHBhcnRzWyAwIF07CgkJCQl9CgoJCQkJcmV0dXJuIGV4cGFuZGVkOwoJCQl9CgkJfTsKCgkJaWYgKCAhcm1hcmdpbi50ZXN0KCBwcmVmaXggKSApIHsKCQkJalF1ZXJ5LmNzc0hvb2tzWyBwcmVmaXggKyBzdWZmaXggXS5zZXQgPSBzZXRQb3NpdGl2ZU51bWJlcjsKCQl9Cgl9KTsKCglqUXVlcnkuZm4uZXh0ZW5kKHsKCQljc3M6IGZ1bmN0aW9uKCBuYW1lLCB2YWx1ZSApIHsKCQkJcmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIGVsZW0sIG5hbWUsIHZhbHVlICkgewoJCQkJdmFyIHN0eWxlcywgbGVuLAoJCQkJCW1hcCA9IHt9LAoJCQkJCWkgPSAwOwoKCQkJCWlmICggalF1ZXJ5LmlzQXJyYXkoIG5hbWUgKSApIHsKCQkJCQlzdHlsZXMgPSBnZXRTdHlsZXMoIGVsZW0gKTsKCQkJCQlsZW4gPSBuYW1lLmxlbmd0aDsKCgkJCQkJZm9yICggOyBpIDwgbGVuOyBpKysgKSB7CgkJCQkJCW1hcFsgbmFtZVsgaSBdIF0gPSBqUXVlcnkuY3NzKCBlbGVtLCBuYW1lWyBpIF0sIGZhbHNlLCBzdHlsZXMgKTsKCQkJCQl9CgoJCQkJCXJldHVybiBtYXA7CgkJCQl9CgoJCQkJcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgPwoJCQkJCWpRdWVyeS5zdHlsZSggZWxlbSwgbmFtZSwgdmFsdWUgKSA6CgkJCQkJalF1ZXJ5LmNzcyggZWxlbSwgbmFtZSApOwoJCQl9LCBuYW1lLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgKTsKCQl9LAoJCXNob3c6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gc2hvd0hpZGUoIHRoaXMsIHRydWUgKTsKCQl9LAoJCWhpZGU6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gc2hvd0hpZGUoIHRoaXMgKTsKCQl9LAoJCXRvZ2dsZTogZnVuY3Rpb24oIHN0YXRlICkgewoJCQlpZiAoIHR5cGVvZiBzdGF0ZSA9PT0gImJvb2xlYW4iICkgewoJCQkJcmV0dXJuIHN0YXRlID8gdGhpcy5zaG93KCkgOiB0aGlzLmhpZGUoKTsKCQkJfQoKCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQkJCWlmICggaXNIaWRkZW4oIHRoaXMgKSApIHsKCQkJCQlqUXVlcnkoIHRoaXMgKS5zaG93KCk7CgkJCQl9IGVsc2UgewoJCQkJCWpRdWVyeSggdGhpcyApLmhpZGUoKTsKCQkJCX0KCQkJfSk7CgkJfQoJfSk7CgoKCWZ1bmN0aW9uIFR3ZWVuKCBlbGVtLCBvcHRpb25zLCBwcm9wLCBlbmQsIGVhc2luZyApIHsKCQlyZXR1cm4gbmV3IFR3ZWVuLnByb3RvdHlwZS5pbml0KCBlbGVtLCBvcHRpb25zLCBwcm9wLCBlbmQsIGVhc2luZyApOwoJfQoJalF1ZXJ5LlR3ZWVuID0gVHdlZW47CgoJVHdlZW4ucHJvdG90eXBlID0gewoJCWNvbnN0cnVjdG9yOiBUd2VlbiwKCQlpbml0OiBmdW5jdGlvbiggZWxlbSwgb3B0aW9ucywgcHJvcCwgZW5kLCBlYXNpbmcsIHVuaXQgKSB7CgkJCXRoaXMuZWxlbSA9IGVsZW07CgkJCXRoaXMucHJvcCA9IHByb3A7CgkJCXRoaXMuZWFzaW5nID0gZWFzaW5nIHx8ICJzd2luZyI7CgkJCXRoaXMub3B0aW9ucyA9IG9wdGlvbnM7CgkJCXRoaXMuc3RhcnQgPSB0aGlzLm5vdyA9IHRoaXMuY3VyKCk7CgkJCXRoaXMuZW5kID0gZW5kOwoJCQl0aGlzLnVuaXQgPSB1bml0IHx8ICggalF1ZXJ5LmNzc051bWJlclsgcHJvcCBdID8gIiIgOiAicHgiICk7CgkJfSwKCQljdXI6IGZ1bmN0aW9uKCkgewoJCQl2YXIgaG9va3MgPSBUd2Vlbi5wcm9wSG9va3NbIHRoaXMucHJvcCBdOwoKCQkJcmV0dXJuIGhvb2tzICYmIGhvb2tzLmdldCA/CgkJCQlob29rcy5nZXQoIHRoaXMgKSA6CgkJCQlUd2Vlbi5wcm9wSG9va3MuX2RlZmF1bHQuZ2V0KCB0aGlzICk7CgkJfSwKCQlydW46IGZ1bmN0aW9uKCBwZXJjZW50ICkgewoJCQl2YXIgZWFzZWQsCgkJCQlob29rcyA9IFR3ZWVuLnByb3BIb29rc1sgdGhpcy5wcm9wIF07CgoJCQlpZiAoIHRoaXMub3B0aW9ucy5kdXJhdGlvbiApIHsKCQkJCXRoaXMucG9zID0gZWFzZWQgPSBqUXVlcnkuZWFzaW5nWyB0aGlzLmVhc2luZyBdKAoJCQkJCXBlcmNlbnQsIHRoaXMub3B0aW9ucy5kdXJhdGlvbiAqIHBlcmNlbnQsIDAsIDEsIHRoaXMub3B0aW9ucy5kdXJhdGlvbgoJCQkJKTsKCQkJfSBlbHNlIHsKCQkJCXRoaXMucG9zID0gZWFzZWQgPSBwZXJjZW50OwoJCQl9CgkJCXRoaXMubm93ID0gKCB0aGlzLmVuZCAtIHRoaXMuc3RhcnQgKSAqIGVhc2VkICsgdGhpcy5zdGFydDsKCgkJCWlmICggdGhpcy5vcHRpb25zLnN0ZXAgKSB7CgkJCQl0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKCB0aGlzLmVsZW0sIHRoaXMubm93LCB0aGlzICk7CgkJCX0KCgkJCWlmICggaG9va3MgJiYgaG9va3Muc2V0ICkgewoJCQkJaG9va3Muc2V0KCB0aGlzICk7CgkJCX0gZWxzZSB7CgkJCQlUd2Vlbi5wcm9wSG9va3MuX2RlZmF1bHQuc2V0KCB0aGlzICk7CgkJCX0KCQkJcmV0dXJuIHRoaXM7CgkJfQoJfTsKCglUd2Vlbi5wcm90b3R5cGUuaW5pdC5wcm90b3R5cGUgPSBUd2Vlbi5wcm90b3R5cGU7CgoJVHdlZW4ucHJvcEhvb2tzID0gewoJCV9kZWZhdWx0OiB7CgkJCWdldDogZnVuY3Rpb24oIHR3ZWVuICkgewoJCQkJdmFyIHJlc3VsdDsKCgkJCQlpZiAoIHR3ZWVuLmVsZW1bIHR3ZWVuLnByb3AgXSAhPSBudWxsICYmCgkJCQkJKCF0d2Vlbi5lbGVtLnN0eWxlIHx8IHR3ZWVuLmVsZW0uc3R5bGVbIHR3ZWVuLnByb3AgXSA9PSBudWxsKSApIHsKCQkJCQlyZXR1cm4gdHdlZW4uZWxlbVsgdHdlZW4ucHJvcCBdOwoJCQkJfQoKCQkJCS8vIHBhc3NpbmcgYW4gZW1wdHkgc3RyaW5nIGFzIGEgM3JkIHBhcmFtZXRlciB0byAuY3NzIHdpbGwgYXV0b21hdGljYWxseQoJCQkJLy8gYXR0ZW1wdCBhIHBhcnNlRmxvYXQgYW5kIGZhbGxiYWNrIHRvIGEgc3RyaW5nIGlmIHRoZSBwYXJzZSBmYWlscwoJCQkJLy8gc28sIHNpbXBsZSB2YWx1ZXMgc3VjaCBhcyAiMTBweCIgYXJlIHBhcnNlZCB0byBGbG9hdC4KCQkJCS8vIGNvbXBsZXggdmFsdWVzIHN1Y2ggYXMgInJvdGF0ZSgxcmFkKSIgYXJlIHJldHVybmVkIGFzIGlzLgoJCQkJcmVzdWx0ID0galF1ZXJ5LmNzcyggdHdlZW4uZWxlbSwgdHdlZW4ucHJvcCwgIiIgKTsKCQkJCS8vIEVtcHR5IHN0cmluZ3MsIG51bGwsIHVuZGVmaW5lZCBhbmQgImF1dG8iIGFyZSBjb252ZXJ0ZWQgdG8gMC4KCQkJCXJldHVybiAhcmVzdWx0IHx8IHJlc3VsdCA9PT0gImF1dG8iID8gMCA6IHJlc3VsdDsKCQkJfSwKCQkJc2V0OiBmdW5jdGlvbiggdHdlZW4gKSB7CgkJCQkvLyB1c2Ugc3RlcCBob29rIGZvciBiYWNrIGNvbXBhdCAtIHVzZSBjc3NIb29rIGlmIGl0cyB0aGVyZSAtIHVzZSAuc3R5bGUgaWYgaXRzCgkJCQkvLyBhdmFpbGFibGUgYW5kIHVzZSBwbGFpbiBwcm9wZXJ0aWVzIHdoZXJlIGF2YWlsYWJsZQoJCQkJaWYgKCBqUXVlcnkuZnguc3RlcFsgdHdlZW4ucHJvcCBdICkgewoJCQkJCWpRdWVyeS5meC5zdGVwWyB0d2Vlbi5wcm9wIF0oIHR3ZWVuICk7CgkJCQl9IGVsc2UgaWYgKCB0d2Vlbi5lbGVtLnN0eWxlICYmICggdHdlZW4uZWxlbS5zdHlsZVsgalF1ZXJ5LmNzc1Byb3BzWyB0d2Vlbi5wcm9wIF0gXSAhPSBudWxsIHx8IGpRdWVyeS5jc3NIb29rc1sgdHdlZW4ucHJvcCBdICkgKSB7CgkJCQkJalF1ZXJ5LnN0eWxlKCB0d2Vlbi5lbGVtLCB0d2Vlbi5wcm9wLCB0d2Vlbi5ub3cgKyB0d2Vlbi51bml0ICk7CgkJCQl9IGVsc2UgewoJCQkJCXR3ZWVuLmVsZW1bIHR3ZWVuLnByb3AgXSA9IHR3ZWVuLm5vdzsKCQkJCX0KCQkJfQoJCX0KCX07CgoJLy8gU3VwcG9ydDogSUUgPD05CgkvLyBQYW5pYyBiYXNlZCBhcHByb2FjaCB0byBzZXR0aW5nIHRoaW5ncyBvbiBkaXNjb25uZWN0ZWQgbm9kZXMKCglUd2Vlbi5wcm9wSG9va3Muc2Nyb2xsVG9wID0gVHdlZW4ucHJvcEhvb2tzLnNjcm9sbExlZnQgPSB7CgkJc2V0OiBmdW5jdGlvbiggdHdlZW4gKSB7CgkJCWlmICggdHdlZW4uZWxlbS5ub2RlVHlwZSAmJiB0d2Vlbi5lbGVtLnBhcmVudE5vZGUgKSB7CgkJCQl0d2Vlbi5lbGVtWyB0d2Vlbi5wcm9wIF0gPSB0d2Vlbi5ub3c7CgkJCX0KCQl9Cgl9OwoKCWpRdWVyeS5lYXNpbmcgPSB7CgkJbGluZWFyOiBmdW5jdGlvbiggcCApIHsKCQkJcmV0dXJuIHA7CgkJfSwKCQlzd2luZzogZnVuY3Rpb24oIHAgKSB7CgkJCXJldHVybiAwLjUgLSBNYXRoLmNvcyggcCAqIE1hdGguUEkgKSAvIDI7CgkJfQoJfTsKCglqUXVlcnkuZnggPSBUd2Vlbi5wcm90b3R5cGUuaW5pdDsKCgkvLyBCYWNrIENvbXBhdCA8MS44IGV4dGVuc2lvbiBwb2ludAoJalF1ZXJ5LmZ4LnN0ZXAgPSB7fTsKCgoKCgl2YXIKCQlmeE5vdywgdGltZXJJZCwKCQlyZnh0eXBlcyA9IC9eKD86dG9nZ2xlfHNob3d8aGlkZSkkLywKCQlyZnhudW0gPSBuZXcgUmVnRXhwKCAiXig/OihbKy1dKT18KSgiICsgcG51bSArICIpKFthLXolXSopJCIsICJpIiApLAoJCXJydW4gPSAvcXVldWVIb29rcyQvLAoJCWFuaW1hdGlvblByZWZpbHRlcnMgPSBbIGRlZmF1bHRQcmVmaWx0ZXIgXSwKCQl0d2VlbmVycyA9IHsKCQkJIioiOiBbIGZ1bmN0aW9uKCBwcm9wLCB2YWx1ZSApIHsKCQkJCXZhciB0d2VlbiA9IHRoaXMuY3JlYXRlVHdlZW4oIHByb3AsIHZhbHVlICksCgkJCQkJdGFyZ2V0ID0gdHdlZW4uY3VyKCksCgkJCQkJcGFydHMgPSByZnhudW0uZXhlYyggdmFsdWUgKSwKCQkJCQl1bml0ID0gcGFydHMgJiYgcGFydHNbIDMgXSB8fCAoIGpRdWVyeS5jc3NOdW1iZXJbIHByb3AgXSA/ICIiIDogInB4IiApLAoKCQkJCQkvLyBTdGFydGluZyB2YWx1ZSBjb21wdXRhdGlvbiBpcyByZXF1aXJlZCBmb3IgcG90ZW50aWFsIHVuaXQgbWlzbWF0Y2hlcwoJCQkJCXN0YXJ0ID0gKCBqUXVlcnkuY3NzTnVtYmVyWyBwcm9wIF0gfHwgdW5pdCAhPT0gInB4IiAmJiArdGFyZ2V0ICkgJiYKCQkJCQkJcmZ4bnVtLmV4ZWMoIGpRdWVyeS5jc3MoIHR3ZWVuLmVsZW0sIHByb3AgKSApLAoJCQkJCXNjYWxlID0gMSwKCQkJCQltYXhJdGVyYXRpb25zID0gMjA7CgoJCQkJaWYgKCBzdGFydCAmJiBzdGFydFsgMyBdICE9PSB1bml0ICkgewoJCQkJCS8vIFRydXN0IHVuaXRzIHJlcG9ydGVkIGJ5IGpRdWVyeS5jc3MKCQkJCQl1bml0ID0gdW5pdCB8fCBzdGFydFsgMyBdOwoKCQkJCQkvLyBNYWtlIHN1cmUgd2UgdXBkYXRlIHRoZSB0d2VlbiBwcm9wZXJ0aWVzIGxhdGVyIG9uCgkJCQkJcGFydHMgPSBwYXJ0cyB8fCBbXTsKCgkJCQkJLy8gSXRlcmF0aXZlbHkgYXBwcm94aW1hdGUgZnJvbSBhIG5vbnplcm8gc3RhcnRpbmcgcG9pbnQKCQkJCQlzdGFydCA9ICt0YXJnZXQgfHwgMTsKCgkJCQkJZG8gewoJCQkJCQkvLyBJZiBwcmV2aW91cyBpdGVyYXRpb24gemVyb2VkIG91dCwgZG91YmxlIHVudGlsIHdlIGdldCAqc29tZXRoaW5nKgoJCQkJCQkvLyBVc2UgYSBzdHJpbmcgZm9yIGRvdWJsaW5nIGZhY3RvciBzbyB3ZSBkb24ndCBhY2NpZGVudGFsbHkgc2VlIHNjYWxlIGFzIHVuY2hhbmdlZCBiZWxvdwoJCQkJCQlzY2FsZSA9IHNjYWxlIHx8ICIuNSI7CgoJCQkJCQkvLyBBZGp1c3QgYW5kIGFwcGx5CgkJCQkJCXN0YXJ0ID0gc3RhcnQgLyBzY2FsZTsKCQkJCQkJalF1ZXJ5LnN0eWxlKCB0d2Vlbi5lbGVtLCBwcm9wLCBzdGFydCArIHVuaXQgKTsKCgkJCQkJLy8gVXBkYXRlIHNjYWxlLCB0b2xlcmF0aW5nIHplcm8gb3IgTmFOIGZyb20gdHdlZW4uY3VyKCkKCQkJCQkvLyBBbmQgYnJlYWtpbmcgdGhlIGxvb3AgaWYgc2NhbGUgaXMgdW5jaGFuZ2VkIG9yIHBlcmZlY3QsIG9yIGlmIHdlJ3ZlIGp1c3QgaGFkIGVub3VnaAoJCQkJCX0gd2hpbGUgKCBzY2FsZSAhPT0gKHNjYWxlID0gdHdlZW4uY3VyKCkgLyB0YXJnZXQpICYmIHNjYWxlICE9PSAxICYmIC0tbWF4SXRlcmF0aW9ucyApOwoJCQkJfQoKCQkJCS8vIFVwZGF0ZSB0d2VlbiBwcm9wZXJ0aWVzCgkJCQlpZiAoIHBhcnRzICkgewoJCQkJCXN0YXJ0ID0gdHdlZW4uc3RhcnQgPSArc3RhcnQgfHwgK3RhcmdldCB8fCAwOwoJCQkJCXR3ZWVuLnVuaXQgPSB1bml0OwoJCQkJCS8vIElmIGEgKz0vLT0gdG9rZW4gd2FzIHByb3ZpZGVkLCB3ZSdyZSBkb2luZyBhIHJlbGF0aXZlIGFuaW1hdGlvbgoJCQkJCXR3ZWVuLmVuZCA9IHBhcnRzWyAxIF0gPwoJCQkJCQlzdGFydCArICggcGFydHNbIDEgXSArIDEgKSAqIHBhcnRzWyAyIF0gOgoJCQkJCQkrcGFydHNbIDIgXTsKCQkJCX0KCgkJCQlyZXR1cm4gdHdlZW47CgkJCX0gXQoJCX07CgoJLy8gQW5pbWF0aW9ucyBjcmVhdGVkIHN5bmNocm9ub3VzbHkgd2lsbCBydW4gc3luY2hyb25vdXNseQoJZnVuY3Rpb24gY3JlYXRlRnhOb3coKSB7CgkJc2V0VGltZW91dChmdW5jdGlvbigpIHsKCQkJZnhOb3cgPSB1bmRlZmluZWQ7CgkJfSk7CgkJcmV0dXJuICggZnhOb3cgPSBqUXVlcnkubm93KCkgKTsKCX0KCgkvLyBHZW5lcmF0ZSBwYXJhbWV0ZXJzIHRvIGNyZWF0ZSBhIHN0YW5kYXJkIGFuaW1hdGlvbgoJZnVuY3Rpb24gZ2VuRngoIHR5cGUsIGluY2x1ZGVXaWR0aCApIHsKCQl2YXIgd2hpY2gsCgkJCWF0dHJzID0geyBoZWlnaHQ6IHR5cGUgfSwKCQkJaSA9IDA7CgoJCS8vIGlmIHdlIGluY2x1ZGUgd2lkdGgsIHN0ZXAgdmFsdWUgaXMgMSB0byBkbyBhbGwgY3NzRXhwYW5kIHZhbHVlcywKCQkvLyBpZiB3ZSBkb24ndCBpbmNsdWRlIHdpZHRoLCBzdGVwIHZhbHVlIGlzIDIgdG8gc2tpcCBvdmVyIExlZnQgYW5kIFJpZ2h0CgkJaW5jbHVkZVdpZHRoID0gaW5jbHVkZVdpZHRoID8gMSA6IDA7CgkJZm9yICggOyBpIDwgNCA7IGkgKz0gMiAtIGluY2x1ZGVXaWR0aCApIHsKCQkJd2hpY2ggPSBjc3NFeHBhbmRbIGkgXTsKCQkJYXR0cnNbICJtYXJnaW4iICsgd2hpY2ggXSA9IGF0dHJzWyAicGFkZGluZyIgKyB3aGljaCBdID0gdHlwZTsKCQl9CgoJCWlmICggaW5jbHVkZVdpZHRoICkgewoJCQlhdHRycy5vcGFjaXR5ID0gYXR0cnMud2lkdGggPSB0eXBlOwoJCX0KCgkJcmV0dXJuIGF0dHJzOwoJfQoKCWZ1bmN0aW9uIGNyZWF0ZVR3ZWVuKCB2YWx1ZSwgcHJvcCwgYW5pbWF0aW9uICkgewoJCXZhciB0d2VlbiwKCQkJY29sbGVjdGlvbiA9ICggdHdlZW5lcnNbIHByb3AgXSB8fCBbXSApLmNvbmNhdCggdHdlZW5lcnNbICIqIiBdICksCgkJCWluZGV4ID0gMCwKCQkJbGVuZ3RoID0gY29sbGVjdGlvbi5sZW5ndGg7CgkJZm9yICggOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKyApIHsKCQkJaWYgKCAodHdlZW4gPSBjb2xsZWN0aW9uWyBpbmRleCBdLmNhbGwoIGFuaW1hdGlvbiwgcHJvcCwgdmFsdWUgKSkgKSB7CgoJCQkJLy8gd2UncmUgZG9uZSB3aXRoIHRoaXMgcHJvcGVydHkKCQkJCXJldHVybiB0d2VlbjsKCQkJfQoJCX0KCX0KCglmdW5jdGlvbiBkZWZhdWx0UHJlZmlsdGVyKCBlbGVtLCBwcm9wcywgb3B0cyApIHsKCQkvKiBqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovCgkJdmFyIHByb3AsIHZhbHVlLCB0b2dnbGUsIHR3ZWVuLCBob29rcywgb2xkZmlyZSwgZGlzcGxheSwgY2hlY2tEaXNwbGF5LAoJCQlhbmltID0gdGhpcywKCQkJb3JpZyA9IHt9LAoJCQlzdHlsZSA9IGVsZW0uc3R5bGUsCgkJCWhpZGRlbiA9IGVsZW0ubm9kZVR5cGUgJiYgaXNIaWRkZW4oIGVsZW0gKSwKCQkJZGF0YVNob3cgPSBqUXVlcnkuX2RhdGEoIGVsZW0sICJmeHNob3ciICk7CgoJCS8vIGhhbmRsZSBxdWV1ZTogZmFsc2UgcHJvbWlzZXMKCQlpZiAoICFvcHRzLnF1ZXVlICkgewoJCQlob29rcyA9IGpRdWVyeS5fcXVldWVIb29rcyggZWxlbSwgImZ4IiApOwoJCQlpZiAoIGhvb2tzLnVucXVldWVkID09IG51bGwgKSB7CgkJCQlob29rcy51bnF1ZXVlZCA9IDA7CgkJCQlvbGRmaXJlID0gaG9va3MuZW1wdHkuZmlyZTsKCQkJCWhvb2tzLmVtcHR5LmZpcmUgPSBmdW5jdGlvbigpIHsKCQkJCQlpZiAoICFob29rcy51bnF1ZXVlZCApIHsKCQkJCQkJb2xkZmlyZSgpOwoJCQkJCX0KCQkJCX07CgkJCX0KCQkJaG9va3MudW5xdWV1ZWQrKzsKCgkJCWFuaW0uYWx3YXlzKGZ1bmN0aW9uKCkgewoJCQkJLy8gZG9pbmcgdGhpcyBtYWtlcyBzdXJlIHRoYXQgdGhlIGNvbXBsZXRlIGhhbmRsZXIgd2lsbCBiZSBjYWxsZWQKCQkJCS8vIGJlZm9yZSB0aGlzIGNvbXBsZXRlcwoJCQkJYW5pbS5hbHdheXMoZnVuY3Rpb24oKSB7CgkJCQkJaG9va3MudW5xdWV1ZWQtLTsKCQkJCQlpZiAoICFqUXVlcnkucXVldWUoIGVsZW0sICJmeCIgKS5sZW5ndGggKSB7CgkJCQkJCWhvb2tzLmVtcHR5LmZpcmUoKTsKCQkJCQl9CgkJCQl9KTsKCQkJfSk7CgkJfQoKCQkvLyBoZWlnaHQvd2lkdGggb3ZlcmZsb3cgcGFzcwoJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiAoICJoZWlnaHQiIGluIHByb3BzIHx8ICJ3aWR0aCIgaW4gcHJvcHMgKSApIHsKCQkJLy8gTWFrZSBzdXJlIHRoYXQgbm90aGluZyBzbmVha3Mgb3V0CgkJCS8vIFJlY29yZCBhbGwgMyBvdmVyZmxvdyBhdHRyaWJ1dGVzIGJlY2F1c2UgSUUgZG9lcyBub3QKCQkJLy8gY2hhbmdlIHRoZSBvdmVyZmxvdyBhdHRyaWJ1dGUgd2hlbiBvdmVyZmxvd1ggYW5kCgkJCS8vIG92ZXJmbG93WSBhcmUgc2V0IHRvIHRoZSBzYW1lIHZhbHVlCgkJCW9wdHMub3ZlcmZsb3cgPSBbIHN0eWxlLm92ZXJmbG93LCBzdHlsZS5vdmVyZmxvd1gsIHN0eWxlLm92ZXJmbG93WSBdOwoKCQkJLy8gU2V0IGRpc3BsYXkgcHJvcGVydHkgdG8gaW5saW5lLWJsb2NrIGZvciBoZWlnaHQvd2lkdGgKCQkJLy8gYW5pbWF0aW9ucyBvbiBpbmxpbmUgZWxlbWVudHMgdGhhdCBhcmUgaGF2aW5nIHdpZHRoL2hlaWdodCBhbmltYXRlZAoJCQlkaXNwbGF5ID0galF1ZXJ5LmNzcyggZWxlbSwgImRpc3BsYXkiICk7CgoJCQkvLyBUZXN0IGRlZmF1bHQgZGlzcGxheSBpZiBkaXNwbGF5IGlzIGN1cnJlbnRseSAibm9uZSIKCQkJY2hlY2tEaXNwbGF5ID0gZGlzcGxheSA9PT0gIm5vbmUiID8KCQkJCWpRdWVyeS5fZGF0YSggZWxlbSwgIm9sZGRpc3BsYXkiICkgfHwgZGVmYXVsdERpc3BsYXkoIGVsZW0ubm9kZU5hbWUgKSA6IGRpc3BsYXk7CgoJCQlpZiAoIGNoZWNrRGlzcGxheSA9PT0gImlubGluZSIgJiYgalF1ZXJ5LmNzcyggZWxlbSwgImZsb2F0IiApID09PSAibm9uZSIgKSB7CgoJCQkJLy8gaW5saW5lLWxldmVsIGVsZW1lbnRzIGFjY2VwdCBpbmxpbmUtYmxvY2s7CgkJCQkvLyBibG9jay1sZXZlbCBlbGVtZW50cyBuZWVkIHRvIGJlIGlubGluZSB3aXRoIGxheW91dAoJCQkJaWYgKCAhc3VwcG9ydC5pbmxpbmVCbG9ja05lZWRzTGF5b3V0IHx8IGRlZmF1bHREaXNwbGF5KCBlbGVtLm5vZGVOYW1lICkgPT09ICJpbmxpbmUiICkgewoJCQkJCXN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIjsKCQkJCX0gZWxzZSB7CgkJCQkJc3R5bGUuem9vbSA9IDE7CgkJCQl9CgkJCX0KCQl9CgoJCWlmICggb3B0cy5vdmVyZmxvdyApIHsKCQkJc3R5bGUub3ZlcmZsb3cgPSAiaGlkZGVuIjsKCQkJaWYgKCAhc3VwcG9ydC5zaHJpbmtXcmFwQmxvY2tzKCkgKSB7CgkJCQlhbmltLmFsd2F5cyhmdW5jdGlvbigpIHsKCQkJCQlzdHlsZS5vdmVyZmxvdyA9IG9wdHMub3ZlcmZsb3dbIDAgXTsKCQkJCQlzdHlsZS5vdmVyZmxvd1ggPSBvcHRzLm92ZXJmbG93WyAxIF07CgkJCQkJc3R5bGUub3ZlcmZsb3dZID0gb3B0cy5vdmVyZmxvd1sgMiBdOwoJCQkJfSk7CgkJCX0KCQl9CgoJCS8vIHNob3cvaGlkZSBwYXNzCgkJZm9yICggcHJvcCBpbiBwcm9wcyApIHsKCQkJdmFsdWUgPSBwcm9wc1sgcHJvcCBdOwoJCQlpZiAoIHJmeHR5cGVzLmV4ZWMoIHZhbHVlICkgKSB7CgkJCQlkZWxldGUgcHJvcHNbIHByb3AgXTsKCQkJCXRvZ2dsZSA9IHRvZ2dsZSB8fCB2YWx1ZSA9PT0gInRvZ2dsZSI7CgkJCQlpZiAoIHZhbHVlID09PSAoIGhpZGRlbiA/ICJoaWRlIiA6ICJzaG93IiApICkgewoKCQkJCQkvLyBJZiB0aGVyZSBpcyBkYXRhU2hvdyBsZWZ0IG92ZXIgZnJvbSBhIHN0b3BwZWQgaGlkZSBvciBzaG93IGFuZCB3ZSBhcmUgZ29pbmcgdG8gcHJvY2VlZCB3aXRoIHNob3csIHdlIHNob3VsZCBwcmV0ZW5kIHRvIGJlIGhpZGRlbgoJCQkJCWlmICggdmFsdWUgPT09ICJzaG93IiAmJiBkYXRhU2hvdyAmJiBkYXRhU2hvd1sgcHJvcCBdICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJCWhpZGRlbiA9IHRydWU7CgkJCQkJfSBlbHNlIHsKCQkJCQkJY29udGludWU7CgkJCQkJfQoJCQkJfQoJCQkJb3JpZ1sgcHJvcCBdID0gZGF0YVNob3cgJiYgZGF0YVNob3dbIHByb3AgXSB8fCBqUXVlcnkuc3R5bGUoIGVsZW0sIHByb3AgKTsKCgkJCS8vIEFueSBub24tZnggdmFsdWUgc3RvcHMgdXMgZnJvbSByZXN0b3JpbmcgdGhlIG9yaWdpbmFsIGRpc3BsYXkgdmFsdWUKCQkJfSBlbHNlIHsKCQkJCWRpc3BsYXkgPSB1bmRlZmluZWQ7CgkJCX0KCQl9CgoJCWlmICggIWpRdWVyeS5pc0VtcHR5T2JqZWN0KCBvcmlnICkgKSB7CgkJCWlmICggZGF0YVNob3cgKSB7CgkJCQlpZiAoICJoaWRkZW4iIGluIGRhdGFTaG93ICkgewoJCQkJCWhpZGRlbiA9IGRhdGFTaG93LmhpZGRlbjsKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCWRhdGFTaG93ID0galF1ZXJ5Ll9kYXRhKCBlbGVtLCAiZnhzaG93Iiwge30gKTsKCQkJfQoKCQkJLy8gc3RvcmUgc3RhdGUgaWYgaXRzIHRvZ2dsZSAtIGVuYWJsZXMgLnN0b3AoKS50b2dnbGUoKSB0byAicmV2ZXJzZSIKCQkJaWYgKCB0b2dnbGUgKSB7CgkJCQlkYXRhU2hvdy5oaWRkZW4gPSAhaGlkZGVuOwoJCQl9CgkJCWlmICggaGlkZGVuICkgewoJCQkJalF1ZXJ5KCBlbGVtICkuc2hvdygpOwoJCQl9IGVsc2UgewoJCQkJYW5pbS5kb25lKGZ1bmN0aW9uKCkgewoJCQkJCWpRdWVyeSggZWxlbSApLmhpZGUoKTsKCQkJCX0pOwoJCQl9CgkJCWFuaW0uZG9uZShmdW5jdGlvbigpIHsKCQkJCXZhciBwcm9wOwoJCQkJalF1ZXJ5Ll9yZW1vdmVEYXRhKCBlbGVtLCAiZnhzaG93IiApOwoJCQkJZm9yICggcHJvcCBpbiBvcmlnICkgewoJCQkJCWpRdWVyeS5zdHlsZSggZWxlbSwgcHJvcCwgb3JpZ1sgcHJvcCBdICk7CgkJCQl9CgkJCX0pOwoJCQlmb3IgKCBwcm9wIGluIG9yaWcgKSB7CgkJCQl0d2VlbiA9IGNyZWF0ZVR3ZWVuKCBoaWRkZW4gPyBkYXRhU2hvd1sgcHJvcCBdIDogMCwgcHJvcCwgYW5pbSApOwoKCQkJCWlmICggISggcHJvcCBpbiBkYXRhU2hvdyApICkgewoJCQkJCWRhdGFTaG93WyBwcm9wIF0gPSB0d2Vlbi5zdGFydDsKCQkJCQlpZiAoIGhpZGRlbiApIHsKCQkJCQkJdHdlZW4uZW5kID0gdHdlZW4uc3RhcnQ7CgkJCQkJCXR3ZWVuLnN0YXJ0ID0gcHJvcCA9PT0gIndpZHRoIiB8fCBwcm9wID09PSAiaGVpZ2h0IiA/IDEgOiAwOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkvLyBJZiB0aGlzIGlzIGEgbm9vcCBsaWtlIC5oaWRlKCkuaGlkZSgpLCByZXN0b3JlIGFuIG92ZXJ3cml0dGVuIGRpc3BsYXkgdmFsdWUKCQl9IGVsc2UgaWYgKCAoZGlzcGxheSA9PT0gIm5vbmUiID8gZGVmYXVsdERpc3BsYXkoIGVsZW0ubm9kZU5hbWUgKSA6IGRpc3BsYXkpID09PSAiaW5saW5lIiApIHsKCQkJc3R5bGUuZGlzcGxheSA9IGRpc3BsYXk7CgkJfQoJfQoKCWZ1bmN0aW9uIHByb3BGaWx0ZXIoIHByb3BzLCBzcGVjaWFsRWFzaW5nICkgewoJCXZhciBpbmRleCwgbmFtZSwgZWFzaW5nLCB2YWx1ZSwgaG9va3M7CgoJCS8vIGNhbWVsQ2FzZSwgc3BlY2lhbEVhc2luZyBhbmQgZXhwYW5kIGNzc0hvb2sgcGFzcwoJCWZvciAoIGluZGV4IGluIHByb3BzICkgewoJCQluYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggaW5kZXggKTsKCQkJZWFzaW5nID0gc3BlY2lhbEVhc2luZ1sgbmFtZSBdOwoJCQl2YWx1ZSA9IHByb3BzWyBpbmRleCBdOwoJCQlpZiAoIGpRdWVyeS5pc0FycmF5KCB2YWx1ZSApICkgewoJCQkJZWFzaW5nID0gdmFsdWVbIDEgXTsKCQkJCXZhbHVlID0gcHJvcHNbIGluZGV4IF0gPSB2YWx1ZVsgMCBdOwoJCQl9CgoJCQlpZiAoIGluZGV4ICE9PSBuYW1lICkgewoJCQkJcHJvcHNbIG5hbWUgXSA9IHZhbHVlOwoJCQkJZGVsZXRlIHByb3BzWyBpbmRleCBdOwoJCQl9CgoJCQlob29rcyA9IGpRdWVyeS5jc3NIb29rc1sgbmFtZSBdOwoJCQlpZiAoIGhvb2tzICYmICJleHBhbmQiIGluIGhvb2tzICkgewoJCQkJdmFsdWUgPSBob29rcy5leHBhbmQoIHZhbHVlICk7CgkJCQlkZWxldGUgcHJvcHNbIG5hbWUgXTsKCgkJCQkvLyBub3QgcXVpdGUgJC5leHRlbmQsIHRoaXMgd29udCBvdmVyd3JpdGUga2V5cyBhbHJlYWR5IHByZXNlbnQuCgkJCQkvLyBhbHNvIC0gcmV1c2luZyAnaW5kZXgnIGZyb20gYWJvdmUgYmVjYXVzZSB3ZSBoYXZlIHRoZSBjb3JyZWN0ICJuYW1lIgoJCQkJZm9yICggaW5kZXggaW4gdmFsdWUgKSB7CgkJCQkJaWYgKCAhKCBpbmRleCBpbiBwcm9wcyApICkgewoJCQkJCQlwcm9wc1sgaW5kZXggXSA9IHZhbHVlWyBpbmRleCBdOwoJCQkJCQlzcGVjaWFsRWFzaW5nWyBpbmRleCBdID0gZWFzaW5nOwoJCQkJCX0KCQkJCX0KCQkJfSBlbHNlIHsKCQkJCXNwZWNpYWxFYXNpbmdbIG5hbWUgXSA9IGVhc2luZzsKCQkJfQoJCX0KCX0KCglmdW5jdGlvbiBBbmltYXRpb24oIGVsZW0sIHByb3BlcnRpZXMsIG9wdGlvbnMgKSB7CgkJdmFyIHJlc3VsdCwKCQkJc3RvcHBlZCwKCQkJaW5kZXggPSAwLAoJCQlsZW5ndGggPSBhbmltYXRpb25QcmVmaWx0ZXJzLmxlbmd0aCwKCQkJZGVmZXJyZWQgPSBqUXVlcnkuRGVmZXJyZWQoKS5hbHdheXMoIGZ1bmN0aW9uKCkgewoJCQkJLy8gZG9uJ3QgbWF0Y2ggZWxlbSBpbiB0aGUgOmFuaW1hdGVkIHNlbGVjdG9yCgkJCQlkZWxldGUgdGljay5lbGVtOwoJCQl9KSwKCQkJdGljayA9IGZ1bmN0aW9uKCkgewoJCQkJaWYgKCBzdG9wcGVkICkgewoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0KCQkJCXZhciBjdXJyZW50VGltZSA9IGZ4Tm93IHx8IGNyZWF0ZUZ4Tm93KCksCgkJCQkJcmVtYWluaW5nID0gTWF0aC5tYXgoIDAsIGFuaW1hdGlvbi5zdGFydFRpbWUgKyBhbmltYXRpb24uZHVyYXRpb24gLSBjdXJyZW50VGltZSApLAoJCQkJCS8vIGFyY2hhaWMgY3Jhc2ggYnVnIHdvbid0IGFsbG93IHVzIHRvIHVzZSAxIC0gKCAwLjUgfHwgMCApICgjMTI0OTcpCgkJCQkJdGVtcCA9IHJlbWFpbmluZyAvIGFuaW1hdGlvbi5kdXJhdGlvbiB8fCAwLAoJCQkJCXBlcmNlbnQgPSAxIC0gdGVtcCwKCQkJCQlpbmRleCA9IDAsCgkJCQkJbGVuZ3RoID0gYW5pbWF0aW9uLnR3ZWVucy5sZW5ndGg7CgoJCQkJZm9yICggOyBpbmRleCA8IGxlbmd0aCA7IGluZGV4KysgKSB7CgkJCQkJYW5pbWF0aW9uLnR3ZWVuc1sgaW5kZXggXS5ydW4oIHBlcmNlbnQgKTsKCQkJCX0KCgkJCQlkZWZlcnJlZC5ub3RpZnlXaXRoKCBlbGVtLCBbIGFuaW1hdGlvbiwgcGVyY2VudCwgcmVtYWluaW5nIF0pOwoKCQkJCWlmICggcGVyY2VudCA8IDEgJiYgbGVuZ3RoICkgewoJCQkJCXJldHVybiByZW1haW5pbmc7CgkJCQl9IGVsc2UgewoJCQkJCWRlZmVycmVkLnJlc29sdmVXaXRoKCBlbGVtLCBbIGFuaW1hdGlvbiBdICk7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQl9LAoJCQlhbmltYXRpb24gPSBkZWZlcnJlZC5wcm9taXNlKHsKCQkJCWVsZW06IGVsZW0sCgkJCQlwcm9wczogalF1ZXJ5LmV4dGVuZCgge30sIHByb3BlcnRpZXMgKSwKCQkJCW9wdHM6IGpRdWVyeS5leHRlbmQoIHRydWUsIHsgc3BlY2lhbEVhc2luZzoge30gfSwgb3B0aW9ucyApLAoJCQkJb3JpZ2luYWxQcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLAoJCQkJb3JpZ2luYWxPcHRpb25zOiBvcHRpb25zLAoJCQkJc3RhcnRUaW1lOiBmeE5vdyB8fCBjcmVhdGVGeE5vdygpLAoJCQkJZHVyYXRpb246IG9wdGlvbnMuZHVyYXRpb24sCgkJCQl0d2VlbnM6IFtdLAoJCQkJY3JlYXRlVHdlZW46IGZ1bmN0aW9uKCBwcm9wLCBlbmQgKSB7CgkJCQkJdmFyIHR3ZWVuID0galF1ZXJ5LlR3ZWVuKCBlbGVtLCBhbmltYXRpb24ub3B0cywgcHJvcCwgZW5kLAoJCQkJCQkJYW5pbWF0aW9uLm9wdHMuc3BlY2lhbEVhc2luZ1sgcHJvcCBdIHx8IGFuaW1hdGlvbi5vcHRzLmVhc2luZyApOwoJCQkJCWFuaW1hdGlvbi50d2VlbnMucHVzaCggdHdlZW4gKTsKCQkJCQlyZXR1cm4gdHdlZW47CgkJCQl9LAoJCQkJc3RvcDogZnVuY3Rpb24oIGdvdG9FbmQgKSB7CgkJCQkJdmFyIGluZGV4ID0gMCwKCQkJCQkJLy8gaWYgd2UgYXJlIGdvaW5nIHRvIHRoZSBlbmQsIHdlIHdhbnQgdG8gcnVuIGFsbCB0aGUgdHdlZW5zCgkJCQkJCS8vIG90aGVyd2lzZSB3ZSBza2lwIHRoaXMgcGFydAoJCQkJCQlsZW5ndGggPSBnb3RvRW5kID8gYW5pbWF0aW9uLnR3ZWVucy5sZW5ndGggOiAwOwoJCQkJCWlmICggc3RvcHBlZCApIHsKCQkJCQkJcmV0dXJuIHRoaXM7CgkJCQkJfQoJCQkJCXN0b3BwZWQgPSB0cnVlOwoJCQkJCWZvciAoIDsgaW5kZXggPCBsZW5ndGggOyBpbmRleCsrICkgewoJCQkJCQlhbmltYXRpb24udHdlZW5zWyBpbmRleCBdLnJ1biggMSApOwoJCQkJCX0KCgkJCQkJLy8gcmVzb2x2ZSB3aGVuIHdlIHBsYXllZCB0aGUgbGFzdCBmcmFtZQoJCQkJCS8vIG90aGVyd2lzZSwgcmVqZWN0CgkJCQkJaWYgKCBnb3RvRW5kICkgewoJCQkJCQlkZWZlcnJlZC5yZXNvbHZlV2l0aCggZWxlbSwgWyBhbmltYXRpb24sIGdvdG9FbmQgXSApOwoJCQkJCX0gZWxzZSB7CgkJCQkJCWRlZmVycmVkLnJlamVjdFdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uLCBnb3RvRW5kIF0gKTsKCQkJCQl9CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9CgkJCX0pLAoJCQlwcm9wcyA9IGFuaW1hdGlvbi5wcm9wczsKCgkJcHJvcEZpbHRlciggcHJvcHMsIGFuaW1hdGlvbi5vcHRzLnNwZWNpYWxFYXNpbmcgKTsKCgkJZm9yICggOyBpbmRleCA8IGxlbmd0aCA7IGluZGV4KysgKSB7CgkJCXJlc3VsdCA9IGFuaW1hdGlvblByZWZpbHRlcnNbIGluZGV4IF0uY2FsbCggYW5pbWF0aW9uLCBlbGVtLCBwcm9wcywgYW5pbWF0aW9uLm9wdHMgKTsKCQkJaWYgKCByZXN1bHQgKSB7CgkJCQlyZXR1cm4gcmVzdWx0OwoJCQl9CgkJfQoKCQlqUXVlcnkubWFwKCBwcm9wcywgY3JlYXRlVHdlZW4sIGFuaW1hdGlvbiApOwoKCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBhbmltYXRpb24ub3B0cy5zdGFydCApICkgewoJCQlhbmltYXRpb24ub3B0cy5zdGFydC5jYWxsKCBlbGVtLCBhbmltYXRpb24gKTsKCQl9CgoJCWpRdWVyeS5meC50aW1lcg==", "base64"));
  res.write(new Buffer("KAoJCQlqUXVlcnkuZXh0ZW5kKCB0aWNrLCB7CgkJCQllbGVtOiBlbGVtLAoJCQkJYW5pbTogYW5pbWF0aW9uLAoJCQkJcXVldWU6IGFuaW1hdGlvbi5vcHRzLnF1ZXVlCgkJCX0pCgkJKTsKCgkJLy8gYXR0YWNoIGNhbGxiYWNrcyBmcm9tIG9wdGlvbnMKCQlyZXR1cm4gYW5pbWF0aW9uLnByb2dyZXNzKCBhbmltYXRpb24ub3B0cy5wcm9ncmVzcyApCgkJCS5kb25lKCBhbmltYXRpb24ub3B0cy5kb25lLCBhbmltYXRpb24ub3B0cy5jb21wbGV0ZSApCgkJCS5mYWlsKCBhbmltYXRpb24ub3B0cy5mYWlsICkKCQkJLmFsd2F5cyggYW5pbWF0aW9uLm9wdHMuYWx3YXlzICk7Cgl9CgoJalF1ZXJ5LkFuaW1hdGlvbiA9IGpRdWVyeS5leHRlbmQoIEFuaW1hdGlvbiwgewoJCXR3ZWVuZXI6IGZ1bmN0aW9uKCBwcm9wcywgY2FsbGJhY2sgKSB7CgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHByb3BzICkgKSB7CgkJCQljYWxsYmFjayA9IHByb3BzOwoJCQkJcHJvcHMgPSBbICIqIiBdOwoJCQl9IGVsc2UgewoJCQkJcHJvcHMgPSBwcm9wcy5zcGxpdCgiICIpOwoJCQl9CgoJCQl2YXIgcHJvcCwKCQkJCWluZGV4ID0gMCwKCQkJCWxlbmd0aCA9IHByb3BzLmxlbmd0aDsKCgkJCWZvciAoIDsgaW5kZXggPCBsZW5ndGggOyBpbmRleCsrICkgewoJCQkJcHJvcCA9IHByb3BzWyBpbmRleCBdOwoJCQkJdHdlZW5lcnNbIHByb3AgXSA9IHR3ZWVuZXJzWyBwcm9wIF0gfHwgW107CgkJCQl0d2VlbmVyc1sgcHJvcCBdLnVuc2hpZnQoIGNhbGxiYWNrICk7CgkJCX0KCQl9LAoKCQlwcmVmaWx0ZXI6IGZ1bmN0aW9uKCBjYWxsYmFjaywgcHJlcGVuZCApIHsKCQkJaWYgKCBwcmVwZW5kICkgewoJCQkJYW5pbWF0aW9uUHJlZmlsdGVycy51bnNoaWZ0KCBjYWxsYmFjayApOwoJCQl9IGVsc2UgewoJCQkJYW5pbWF0aW9uUHJlZmlsdGVycy5wdXNoKCBjYWxsYmFjayApOwoJCQl9CgkJfQoJfSk7CgoJalF1ZXJ5LnNwZWVkID0gZnVuY3Rpb24oIHNwZWVkLCBlYXNpbmcsIGZuICkgewoJCXZhciBvcHQgPSBzcGVlZCAmJiB0eXBlb2Ygc3BlZWQgPT09ICJvYmplY3QiID8galF1ZXJ5LmV4dGVuZCgge30sIHNwZWVkICkgOiB7CgkJCWNvbXBsZXRlOiBmbiB8fCAhZm4gJiYgZWFzaW5nIHx8CgkJCQlqUXVlcnkuaXNGdW5jdGlvbiggc3BlZWQgKSAmJiBzcGVlZCwKCQkJZHVyYXRpb246IHNwZWVkLAoJCQllYXNpbmc6IGZuICYmIGVhc2luZyB8fCBlYXNpbmcgJiYgIWpRdWVyeS5pc0Z1bmN0aW9uKCBlYXNpbmcgKSAmJiBlYXNpbmcKCQl9OwoKCQlvcHQuZHVyYXRpb24gPSBqUXVlcnkuZngub2ZmID8gMCA6IHR5cGVvZiBvcHQuZHVyYXRpb24gPT09ICJudW1iZXIiID8gb3B0LmR1cmF0aW9uIDoKCQkJb3B0LmR1cmF0aW9uIGluIGpRdWVyeS5meC5zcGVlZHMgPyBqUXVlcnkuZnguc3BlZWRzWyBvcHQuZHVyYXRpb24gXSA6IGpRdWVyeS5meC5zcGVlZHMuX2RlZmF1bHQ7CgoJCS8vIG5vcm1hbGl6ZSBvcHQucXVldWUgLSB0cnVlL3VuZGVmaW5lZC9udWxsIC0+ICJmeCIKCQlpZiAoIG9wdC5xdWV1ZSA9PSBudWxsIHx8IG9wdC5xdWV1ZSA9PT0gdHJ1ZSApIHsKCQkJb3B0LnF1ZXVlID0gImZ4IjsKCQl9CgoJCS8vIFF1ZXVlaW5nCgkJb3B0Lm9sZCA9IG9wdC5jb21wbGV0ZTsKCgkJb3B0LmNvbXBsZXRlID0gZnVuY3Rpb24oKSB7CgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIG9wdC5vbGQgKSApIHsKCQkJCW9wdC5vbGQuY2FsbCggdGhpcyApOwoJCQl9CgoJCQlpZiAoIG9wdC5xdWV1ZSApIHsKCQkJCWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCBvcHQucXVldWUgKTsKCQkJfQoJCX07CgoJCXJldHVybiBvcHQ7Cgl9OwoKCWpRdWVyeS5mbi5leHRlbmQoewoJCWZhZGVUbzogZnVuY3Rpb24oIHNwZWVkLCB0bywgZWFzaW5nLCBjYWxsYmFjayApIHsKCgkJCS8vIHNob3cgYW55IGhpZGRlbiBlbGVtZW50cyBhZnRlciBzZXR0aW5nIG9wYWNpdHkgdG8gMAoJCQlyZXR1cm4gdGhpcy5maWx0ZXIoIGlzSGlkZGVuICkuY3NzKCAib3BhY2l0eSIsIDAgKS5zaG93KCkKCgkJCQkvLyBhbmltYXRlIHRvIHRoZSB2YWx1ZSBzcGVjaWZpZWQKCQkJCS5lbmQoKS5hbmltYXRlKHsgb3BhY2l0eTogdG8gfSwgc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKTsKCQl9LAoJCWFuaW1hdGU6IGZ1bmN0aW9uKCBwcm9wLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApIHsKCQkJdmFyIGVtcHR5ID0galF1ZXJ5LmlzRW1wdHlPYmplY3QoIHByb3AgKSwKCQkJCW9wdGFsbCA9IGpRdWVyeS5zcGVlZCggc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKSwKCQkJCWRvQW5pbWF0aW9uID0gZnVuY3Rpb24oKSB7CgkJCQkJLy8gT3BlcmF0ZSBvbiBhIGNvcHkgb2YgcHJvcCBzbyBwZXItcHJvcGVydHkgZWFzaW5nIHdvbid0IGJlIGxvc3QKCQkJCQl2YXIgYW5pbSA9IEFuaW1hdGlvbiggdGhpcywgalF1ZXJ5LmV4dGVuZCgge30sIHByb3AgKSwgb3B0YWxsICk7CgoJCQkJCS8vIEVtcHR5IGFuaW1hdGlvbnMsIG9yIGZpbmlzaGluZyByZXNvbHZlcyBpbW1lZGlhdGVseQoJCQkJCWlmICggZW1wdHkgfHwgalF1ZXJ5Ll9kYXRhKCB0aGlzLCAiZmluaXNoIiApICkgewoJCQkJCQlhbmltLnN0b3AoIHRydWUgKTsKCQkJCQl9CgkJCQl9OwoJCQkJZG9BbmltYXRpb24uZmluaXNoID0gZG9BbmltYXRpb247CgoJCQlyZXR1cm4gZW1wdHkgfHwgb3B0YWxsLnF1ZXVlID09PSBmYWxzZSA/CgkJCQl0aGlzLmVhY2goIGRvQW5pbWF0aW9uICkgOgoJCQkJdGhpcy5xdWV1ZSggb3B0YWxsLnF1ZXVlLCBkb0FuaW1hdGlvbiApOwoJCX0sCgkJc3RvcDogZnVuY3Rpb24oIHR5cGUsIGNsZWFyUXVldWUsIGdvdG9FbmQgKSB7CgkJCXZhciBzdG9wUXVldWUgPSBmdW5jdGlvbiggaG9va3MgKSB7CgkJCQl2YXIgc3RvcCA9IGhvb2tzLnN0b3A7CgkJCQlkZWxldGUgaG9va3Muc3RvcDsKCQkJCXN0b3AoIGdvdG9FbmQgKTsKCQkJfTsKCgkJCWlmICggdHlwZW9mIHR5cGUgIT09ICJzdHJpbmciICkgewoJCQkJZ290b0VuZCA9IGNsZWFyUXVldWU7CgkJCQljbGVhclF1ZXVlID0gdHlwZTsKCQkJCXR5cGUgPSB1bmRlZmluZWQ7CgkJCX0KCQkJaWYgKCBjbGVhclF1ZXVlICYmIHR5cGUgIT09IGZhbHNlICkgewoJCQkJdGhpcy5xdWV1ZSggdHlwZSB8fCAiZngiLCBbXSApOwoJCQl9CgoJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJdmFyIGRlcXVldWUgPSB0cnVlLAoJCQkJCWluZGV4ID0gdHlwZSAhPSBudWxsICYmIHR5cGUgKyAicXVldWVIb29rcyIsCgkJCQkJdGltZXJzID0galF1ZXJ5LnRpbWVycywKCQkJCQlkYXRhID0galF1ZXJ5Ll9kYXRhKCB0aGlzICk7CgoJCQkJaWYgKCBpbmRleCApIHsKCQkJCQlpZiAoIGRhdGFbIGluZGV4IF0gJiYgZGF0YVsgaW5kZXggXS5zdG9wICkgewoJCQkJCQlzdG9wUXVldWUoIGRhdGFbIGluZGV4IF0gKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCWZvciAoIGluZGV4IGluIGRhdGEgKSB7CgkJCQkJCWlmICggZGF0YVsgaW5kZXggXSAmJiBkYXRhWyBpbmRleCBdLnN0b3AgJiYgcnJ1bi50ZXN0KCBpbmRleCApICkgewoJCQkJCQkJc3RvcFF1ZXVlKCBkYXRhWyBpbmRleCBdICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJZm9yICggaW5kZXggPSB0aW1lcnMubGVuZ3RoOyBpbmRleC0tOyApIHsKCQkJCQlpZiAoIHRpbWVyc1sgaW5kZXggXS5lbGVtID09PSB0aGlzICYmICh0eXBlID09IG51bGwgfHwgdGltZXJzWyBpbmRleCBdLnF1ZXVlID09PSB0eXBlKSApIHsKCQkJCQkJdGltZXJzWyBpbmRleCBdLmFuaW0uc3RvcCggZ290b0VuZCApOwoJCQkJCQlkZXF1ZXVlID0gZmFsc2U7CgkJCQkJCXRpbWVycy5zcGxpY2UoIGluZGV4LCAxICk7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIHN0YXJ0IHRoZSBuZXh0IGluIHRoZSBxdWV1ZSBpZiB0aGUgbGFzdCBzdGVwIHdhc24ndCBmb3JjZWQKCQkJCS8vIHRpbWVycyBjdXJyZW50bHkgd2lsbCBjYWxsIHRoZWlyIGNvbXBsZXRlIGNhbGxiYWNrcywgd2hpY2ggd2lsbCBkZXF1ZXVlCgkJCQkvLyBidXQgb25seSBpZiB0aGV5IHdlcmUgZ290b0VuZAoJCQkJaWYgKCBkZXF1ZXVlIHx8ICFnb3RvRW5kICkgewoJCQkJCWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCB0eXBlICk7CgkJCQl9CgkJCX0pOwoJCX0sCgkJZmluaXNoOiBmdW5jdGlvbiggdHlwZSApIHsKCQkJaWYgKCB0eXBlICE9PSBmYWxzZSApIHsKCQkJCXR5cGUgPSB0eXBlIHx8ICJmeCI7CgkJCX0KCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQkJCXZhciBpbmRleCwKCQkJCQlkYXRhID0galF1ZXJ5Ll9kYXRhKCB0aGlzICksCgkJCQkJcXVldWUgPSBkYXRhWyB0eXBlICsgInF1ZXVlIiBdLAoJCQkJCWhvb2tzID0gZGF0YVsgdHlwZSArICJxdWV1ZUhvb2tzIiBdLAoJCQkJCXRpbWVycyA9IGpRdWVyeS50aW1lcnMsCgkJCQkJbGVuZ3RoID0gcXVldWUgPyBxdWV1ZS5sZW5ndGggOiAwOwoKCQkJCS8vIGVuYWJsZSBmaW5pc2hpbmcgZmxhZyBvbiBwcml2YXRlIGRhdGEKCQkJCWRhdGEuZmluaXNoID0gdHJ1ZTsKCgkJCQkvLyBlbXB0eSB0aGUgcXVldWUgZmlyc3QKCQkJCWpRdWVyeS5xdWV1ZSggdGhpcywgdHlwZSwgW10gKTsKCgkJCQlpZiAoIGhvb2tzICYmIGhvb2tzLnN0b3AgKSB7CgkJCQkJaG9va3Muc3RvcC5jYWxsKCB0aGlzLCB0cnVlICk7CgkJCQl9CgoJCQkJLy8gbG9vayBmb3IgYW55IGFjdGl2ZSBhbmltYXRpb25zLCBhbmQgZmluaXNoIHRoZW0KCQkJCWZvciAoIGluZGV4ID0gdGltZXJzLmxlbmd0aDsgaW5kZXgtLTsgKSB7CgkJCQkJaWYgKCB0aW1lcnNbIGluZGV4IF0uZWxlbSA9PT0gdGhpcyAmJiB0aW1lcnNbIGluZGV4IF0ucXVldWUgPT09IHR5cGUgKSB7CgkJCQkJCXRpbWVyc1sgaW5kZXggXS5hbmltLnN0b3AoIHRydWUgKTsKCQkJCQkJdGltZXJzLnNwbGljZSggaW5kZXgsIDEgKTsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gbG9vayBmb3IgYW55IGFuaW1hdGlvbnMgaW4gdGhlIG9sZCBxdWV1ZSBhbmQgZmluaXNoIHRoZW0KCQkJCWZvciAoIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KysgKSB7CgkJCQkJaWYgKCBxdWV1ZVsgaW5kZXggXSAmJiBxdWV1ZVsgaW5kZXggXS5maW5pc2ggKSB7CgkJCQkJCXF1ZXVlWyBpbmRleCBdLmZpbmlzaC5jYWxsKCB0aGlzICk7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIHR1cm4gb2ZmIGZpbmlzaGluZyBmbGFnCgkJCQlkZWxldGUgZGF0YS5maW5pc2g7CgkJCX0pOwoJCX0KCX0pOwoKCWpRdWVyeS5lYWNoKFsgInRvZ2dsZSIsICJzaG93IiwgImhpZGUiIF0sIGZ1bmN0aW9uKCBpLCBuYW1lICkgewoJCXZhciBjc3NGbiA9IGpRdWVyeS5mblsgbmFtZSBdOwoJCWpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICkgewoJCQlyZXR1cm4gc3BlZWQgPT0gbnVsbCB8fCB0eXBlb2Ygc3BlZWQgPT09ICJib29sZWFuIiA/CgkJCQljc3NGbi5hcHBseSggdGhpcywgYXJndW1lbnRzICkgOgoJCQkJdGhpcy5hbmltYXRlKCBnZW5GeCggbmFtZSwgdHJ1ZSApLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApOwoJCX07Cgl9KTsKCgkvLyBHZW5lcmF0ZSBzaG9ydGN1dHMgZm9yIGN1c3RvbSBhbmltYXRpb25zCglqUXVlcnkuZWFjaCh7CgkJc2xpZGVEb3duOiBnZW5GeCgic2hvdyIpLAoJCXNsaWRlVXA6IGdlbkZ4KCJoaWRlIiksCgkJc2xpZGVUb2dnbGU6IGdlbkZ4KCJ0b2dnbGUiKSwKCQlmYWRlSW46IHsgb3BhY2l0eTogInNob3ciIH0sCgkJZmFkZU91dDogeyBvcGFjaXR5OiAiaGlkZSIgfSwKCQlmYWRlVG9nZ2xlOiB7IG9wYWNpdHk6ICJ0b2dnbGUiIH0KCX0sIGZ1bmN0aW9uKCBuYW1lLCBwcm9wcyApIHsKCQlqUXVlcnkuZm5bIG5hbWUgXSA9IGZ1bmN0aW9uKCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApIHsKCQkJcmV0dXJuIHRoaXMuYW5pbWF0ZSggcHJvcHMsIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICk7CgkJfTsKCX0pOwoKCWpRdWVyeS50aW1lcnMgPSBbXTsKCWpRdWVyeS5meC50aWNrID0gZnVuY3Rpb24oKSB7CgkJdmFyIHRpbWVyLAoJCQl0aW1lcnMgPSBqUXVlcnkudGltZXJzLAoJCQlpID0gMDsKCgkJZnhOb3cgPSBqUXVlcnkubm93KCk7CgoJCWZvciAoIDsgaSA8IHRpbWVycy5sZW5ndGg7IGkrKyApIHsKCQkJdGltZXIgPSB0aW1lcnNbIGkgXTsKCQkJLy8gQ2hlY2tzIHRoZSB0aW1lciBoYXMgbm90IGFscmVhZHkgYmVlbiByZW1vdmVkCgkJCWlmICggIXRpbWVyKCkgJiYgdGltZXJzWyBpIF0gPT09IHRpbWVyICkgewoJCQkJdGltZXJzLnNwbGljZSggaS0tLCAxICk7CgkJCX0KCQl9CgoJCWlmICggIXRpbWVycy5sZW5ndGggKSB7CgkJCWpRdWVyeS5meC5zdG9wKCk7CgkJfQoJCWZ4Tm93ID0gdW5kZWZpbmVkOwoJfTsKCglqUXVlcnkuZngudGltZXIgPSBmdW5jdGlvbiggdGltZXIgKSB7CgkJalF1ZXJ5LnRpbWVycy5wdXNoKCB0aW1lciApOwoJCWlmICggdGltZXIoKSApIHsKCQkJalF1ZXJ5LmZ4LnN0YXJ0KCk7CgkJfSBlbHNlIHsKCQkJalF1ZXJ5LnRpbWVycy5wb3AoKTsKCQl9Cgl9OwoKCWpRdWVyeS5meC5pbnRlcnZhbCA9IDEzOwoKCWpRdWVyeS5meC5zdGFydCA9IGZ1bmN0aW9uKCkgewoJCWlmICggIXRpbWVySWQgKSB7CgkJCXRpbWVySWQgPSBzZXRJbnRlcnZhbCggalF1ZXJ5LmZ4LnRpY2ssIGpRdWVyeS5meC5pbnRlcnZhbCApOwoJCX0KCX07CgoJalF1ZXJ5LmZ4LnN0b3AgPSBmdW5jdGlvbigpIHsKCQljbGVhckludGVydmFsKCB0aW1lcklkICk7CgkJdGltZXJJZCA9IG51bGw7Cgl9OwoKCWpRdWVyeS5meC5zcGVlZHMgPSB7CgkJc2xvdzogNjAwLAoJCWZhc3Q6IDIwMCwKCQkvLyBEZWZhdWx0IHNwZWVkCgkJX2RlZmF1bHQ6IDQwMAoJfTsKCgoJLy8gQmFzZWQgb2ZmIG9mIHRoZSBwbHVnaW4gYnkgQ2xpbnQgSGVsZmVycywgd2l0aCBwZXJtaXNzaW9uLgoJLy8gaHR0cDovL2JsaW5kc2lnbmFscy5jb20vaW5kZXgucGhwLzIwMDkvMDcvanF1ZXJ5LWRlbGF5LwoJalF1ZXJ5LmZuLmRlbGF5ID0gZnVuY3Rpb24oIHRpbWUsIHR5cGUgKSB7CgkJdGltZSA9IGpRdWVyeS5meCA/IGpRdWVyeS5meC5zcGVlZHNbIHRpbWUgXSB8fCB0aW1lIDogdGltZTsKCQl0eXBlID0gdHlwZSB8fCAiZngiOwoKCQlyZXR1cm4gdGhpcy5xdWV1ZSggdHlwZSwgZnVuY3Rpb24oIG5leHQsIGhvb2tzICkgewoJCQl2YXIgdGltZW91dCA9IHNldFRpbWVvdXQoIG5leHQsIHRpbWUgKTsKCQkJaG9va3Muc3RvcCA9IGZ1bmN0aW9uKCkgewoJCQkJY2xlYXJUaW1lb3V0KCB0aW1lb3V0ICk7CgkJCX07CgkJfSk7Cgl9OwoKCgkoZnVuY3Rpb24oKSB7CgkJLy8gTWluaWZpZWQ6IHZhciBhLGIsYyxkLGUKCQl2YXIgaW5wdXQsIGRpdiwgc2VsZWN0LCBhLCBvcHQ7CgoJCS8vIFNldHVwCgkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCQlkaXYuc2V0QXR0cmlidXRlKCAiY2xhc3NOYW1lIiwgInQiICk7CgkJZGl2LmlubmVySFRNTCA9ICIgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYSc+YTwvYT48aW5wdXQgdHlwZT0nY2hlY2tib3gnLz4iOwoJCWEgPSBkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImEiKVsgMCBdOwoKCQkvLyBGaXJzdCBiYXRjaCBvZiB0ZXN0cy4KCQlzZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzZWxlY3QiKTsKCQlvcHQgPSBzZWxlY3QuYXBwZW5kQ2hpbGQoIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpICk7CgkJaW5wdXQgPSBkaXYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImlucHV0IilbIDAgXTsKCgkJYS5zdHlsZS5jc3NUZXh0ID0gInRvcDoxcHgiOwoKCQkvLyBUZXN0IHNldEF0dHJpYnV0ZSBvbiBjYW1lbENhc2UgY2xhc3MuIElmIGl0IHdvcmtzLCB3ZSBuZWVkIGF0dHJGaXhlcyB3aGVuIGRvaW5nIGdldC9zZXRBdHRyaWJ1dGUgKGllNi83KQoJCXN1cHBvcnQuZ2V0U2V0QXR0cmlidXRlID0gZGl2LmNsYXNzTmFtZSAhPT0gInQiOwoKCQkvLyBHZXQgdGhlIHN0eWxlIGluZm9ybWF0aW9uIGZyb20gZ2V0QXR0cmlidXRlCgkJLy8gKElFIHVzZXMgLmNzc1RleHQgaW5zdGVhZCkKCQlzdXBwb3J0LnN0eWxlID0gL3RvcC8udGVzdCggYS5nZXRBdHRyaWJ1dGUoInN0eWxlIikgKTsKCgkJLy8gTWFrZSBzdXJlIHRoYXQgVVJMcyBhcmVuJ3QgbWFuaXB1bGF0ZWQKCQkvLyAoSUUgbm9ybWFsaXplcyBpdCBieSBkZWZhdWx0KQoJCXN1cHBvcnQuaHJlZk5vcm1hbGl6ZWQgPSBhLmdldEF0dHJpYnV0ZSgiaHJlZiIpID09PSAiL2EiOwoKCQkvLyBDaGVjayB0aGUgZGVmYXVsdCBjaGVja2JveC9yYWRpbyB2YWx1ZSAoIiIgb24gV2ViS2l0OyAib24iIGVsc2V3aGVyZSkKCQlzdXBwb3J0LmNoZWNrT24gPSAhIWlucHV0LnZhbHVlOwoKCQkvLyBNYWtlIHN1cmUgdGhhdCBhIHNlbGVjdGVkLWJ5LWRlZmF1bHQgb3B0aW9uIGhhcyBhIHdvcmtpbmcgc2VsZWN0ZWQgcHJvcGVydHkuCgkJLy8gKFdlYktpdCBkZWZhdWx0cyB0byBmYWxzZSBpbnN0ZWFkIG9mIHRydWUsIElFIHRvbywgaWYgaXQncyBpbiBhbiBvcHRncm91cCkKCQlzdXBwb3J0Lm9wdFNlbGVjdGVkID0gb3B0LnNlbGVjdGVkOwoKCQkvLyBUZXN0cyBmb3IgZW5jdHlwZSBzdXBwb3J0IG9uIGEgZm9ybSAoIzY3NDMpCgkJc3VwcG9ydC5lbmN0eXBlID0gISFkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJmb3JtIikuZW5jdHlwZTsKCgkJLy8gTWFrZSBzdXJlIHRoYXQgdGhlIG9wdGlvbnMgaW5zaWRlIGRpc2FibGVkIHNlbGVjdHMgYXJlbid0IG1hcmtlZCBhcyBkaXNhYmxlZAoJCS8vIChXZWJLaXQgbWFya3MgdGhlbSBhcyBkaXNhYmxlZCkKCQlzZWxlY3QuZGlzYWJsZWQgPSB0cnVlOwoJCXN1cHBvcnQub3B0RGlzYWJsZWQgPSAhb3B0LmRpc2FibGVkOwoKCQkvLyBTdXBwb3J0OiBJRTggb25seQoJCS8vIENoZWNrIGlmIHdlIGNhbiB0cnVzdCBnZXRBdHRyaWJ1dGUoInZhbHVlIikKCQlpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJpbnB1dCIgKTsKCQlpbnB1dC5zZXRBdHRyaWJ1dGUoICJ2YWx1ZSIsICIiICk7CgkJc3VwcG9ydC5pbnB1dCA9IGlucHV0LmdldEF0dHJpYnV0ZSggInZhbHVlIiApID09PSAiIjsKCgkJLy8gQ2hlY2sgaWYgYW4gaW5wdXQgbWFpbnRhaW5zIGl0cyB2YWx1ZSBhZnRlciBiZWNvbWluZyBhIHJhZGlvCgkJaW5wdXQudmFsdWUgPSAidCI7CgkJaW5wdXQuc2V0QXR0cmlidXRlKCAidHlwZSIsICJyYWRpbyIgKTsKCQlzdXBwb3J0LnJhZGlvVmFsdWUgPSBpbnB1dC52YWx1ZSA9PT0gInQiOwoJfSkoKTsKCgoJdmFyIHJyZXR1cm4gPSAvXHIvZzsKCglqUXVlcnkuZm4uZXh0ZW5kKHsKCQl2YWw6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJdmFyIGhvb2tzLCByZXQsIGlzRnVuY3Rpb24sCgkJCQllbGVtID0gdGhpc1swXTsKCgkJCWlmICggIWFyZ3VtZW50cy5sZW5ndGggKSB7CgkJCQlpZiAoIGVsZW0gKSB7CgkJCQkJaG9va3MgPSBqUXVlcnkudmFsSG9va3NbIGVsZW0udHlwZSBdIHx8IGpRdWVyeS52YWxIb29rc1sgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpIF07CgoJCQkJCWlmICggaG9va3MgJiYgImdldCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLmdldCggZWxlbSwgInZhbHVlIiApKSAhPT0gdW5kZWZpbmVkICkgewoJCQkJCQlyZXR1cm4gcmV0OwoJCQkJCX0KCgkJCQkJcmV0ID0gZWxlbS52YWx1ZTsKCgkJCQkJcmV0dXJuIHR5cGVvZiByZXQgPT09ICJzdHJpbmciID8KCQkJCQkJLy8gaGFuZGxlIG1vc3QgY29tbW9uIHN0cmluZyBjYXNlcwoJCQkJCQlyZXQucmVwbGFjZShycmV0dXJuLCAiIikgOgoJCQkJCQkvLyBoYW5kbGUgY2FzZXMgd2hlcmUgdmFsdWUgaXMgbnVsbC91bmRlZiBvciBudW1iZXIKCQkJCQkJcmV0ID09IG51bGwgPyAiIiA6IHJldDsKCQkJCX0KCgkJCQlyZXR1cm47CgkJCX0KCgkJCWlzRnVuY3Rpb24gPSBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKTsKCgkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGkgKSB7CgkJCQl2YXIgdmFsOwoKCQkJCWlmICggdGhpcy5ub2RlVHlwZSAhPT0gMSApIHsKCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJaWYgKCBpc0Z1bmN0aW9uICkgewoJCQkJCXZhbCA9IHZhbHVlLmNhbGwoIHRoaXMsIGksIGpRdWVyeSggdGhpcyApLnZhbCgpICk7CgkJCQl9IGVsc2UgewoJCQkJCXZhbCA9IHZhbHVlOwoJCQkJfQoKCQkJCS8vIFRyZWF0IG51bGwvdW5kZWZpbmVkIGFzICIiOyBjb252ZXJ0IG51bWJlcnMgdG8gc3RyaW5nCgkJCQlpZiAoIHZhbCA9PSBudWxsICkgewoJCQkJCXZhbCA9ICIiOwoJCQkJfSBlbHNlIGlmICggdHlwZW9mIHZhbCA9PT0gIm51bWJlciIgKSB7CgkJCQkJdmFsICs9ICIiOwoJCQkJfSBlbHNlIGlmICggalF1ZXJ5LmlzQXJyYXkoIHZhbCApICkgewoJCQkJCXZhbCA9IGpRdWVyeS5tYXAoIHZhbCwgZnVuY3Rpb24oIHZhbHVlICkgewoJCQkJCQlyZXR1cm4gdmFsdWUgPT0gbnVsbCA/ICIiIDogdmFsdWUgKyAiIjsKCQkJCQl9KTsKCQkJCX0KCgkJCQlob29rcyA9IGpRdWVyeS52YWxIb29rc1sgdGhpcy50eXBlIF0gfHwgalF1ZXJ5LnZhbEhvb2tzWyB0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgXTsKCgkJCQkvLyBJZiBzZXQgcmV0dXJucyB1bmRlZmluZWQsIGZhbGwgYmFjayB0byBub3JtYWwgc2V0dGluZwoJCQkJaWYgKCAhaG9va3MgfHwgISgic2V0IiBpbiBob29rcykgfHwgaG9va3Muc2V0KCB0aGlzLCB2YWwsICJ2YWx1ZSIgKSA9PT0gdW5kZWZpbmVkICkgewoJCQkJCXRoaXMudmFsdWUgPSB2YWw7CgkJCQl9CgkJCX0pOwoJCX0KCX0pOwoKCWpRdWVyeS5leHRlbmQoewoJCXZhbEhvb2tzOiB7CgkJCW9wdGlvbjogewoJCQkJZ2V0OiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCQl2YXIgdmFsID0galF1ZXJ5LmZpbmQuYXR0ciggZWxlbSwgInZhbHVlIiApOwoJCQkJCXJldHVybiB2YWwgIT0gbnVsbCA/CgkJCQkJCXZhbCA6CgkJCQkJCS8vIFN1cHBvcnQ6IElFMTAtMTErCgkJCQkJCS8vIG9wdGlvbi50ZXh0IHRocm93cyBleGNlcHRpb25zICgjMTQ2ODYsICMxNDg1OCkKCQkJCQkJalF1ZXJ5LnRyaW0oIGpRdWVyeS50ZXh0KCBlbGVtICkgKTsKCQkJCX0KCQkJfSwKCQkJc2VsZWN0OiB7CgkJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCXZhciB2YWx1ZSwgb3B0aW9uLAoJCQkJCQlvcHRpb25zID0gZWxlbS5vcHRpb25zLAoJCQkJCQlpbmRleCA9IGVsZW0uc2VsZWN0ZWRJbmRleCwKCQkJCQkJb25lID0gZWxlbS50eXBlID09PSAic2VsZWN0LW9uZSIgfHwgaW5kZXggPCAwLAoJCQkJCQl2YWx1ZXMgPSBvbmUgPyBudWxsIDogW10sCgkJCQkJCW1heCA9IG9uZSA/IGluZGV4ICsgMSA6IG9wdGlvbnMubGVuZ3RoLAoJCQkJCQlpID0gaW5kZXggPCAwID8KCQkJCQkJCW1heCA6CgkJCQkJCQlvbmUgPyBpbmRleCA6IDA7CgoJCQkJCS8vIExvb3AgdGhyb3VnaCBhbGwgdGhlIHNlbGVjdGVkIG9wdGlvbnMKCQkJCQlmb3IgKCA7IGkgPCBtYXg7IGkrKyApIHsKCQkJCQkJb3B0aW9uID0gb3B0aW9uc1sgaSBdOwoKCQkJCQkJLy8gb2xkSUUgZG9lc24ndCB1cGRhdGUgc2VsZWN0ZWQgYWZ0ZXIgZm9ybSByZXNldCAoIzI1NTEpCgkJCQkJCWlmICggKCBvcHRpb24uc2VsZWN0ZWQgfHwgaSA9PT0gaW5kZXggKSAmJgoJCQkJCQkJCS8vIERvbid0IHJldHVybiBvcHRpb25zIHRoYXQgYXJlIGRpc2FibGVkIG9yIGluIGEgZGlzYWJsZWQgb3B0Z3JvdXAKCQkJCQkJCQkoIHN1cHBvcnQub3B0RGlzYWJsZWQgPyAhb3B0aW9uLmRpc2FibGVkIDogb3B0aW9uLmdldEF0dHJpYnV0ZSgiZGlzYWJsZWQiKSA9PT0gbnVsbCApICYmCgkJCQkJCQkJKCAhb3B0aW9uLnBhcmVudE5vZGUuZGlzYWJsZWQgfHwgIWpRdWVyeS5ub2RlTmFtZSggb3B0aW9uLnBhcmVudE5vZGUsICJvcHRncm91cCIgKSApICkgewoKCQkJCQkJCS8vIEdldCB0aGUgc3BlY2lmaWMgdmFsdWUgZm9yIHRoZSBvcHRpb24KCQkJCQkJCXZhbHVlID0galF1ZXJ5KCBvcHRpb24gKS52YWwoKTsKCgkJCQkJCQkvLyBXZSBkb24ndCBuZWVkIGFuIGFycmF5IGZvciBvbmUgc2VsZWN0cwoJCQkJCQkJaWYgKCBvbmUgKSB7CgkJCQkJCQkJcmV0dXJuIHZhbHVlOwoJCQkJCQkJfQoKCQkJCQkJCS8vIE11bHRpLVNlbGVjdHMgcmV0dXJuIGFuIGFycmF5CgkJCQkJCQl2YWx1ZXMucHVzaCggdmFsdWUgKTsKCQkJCQkJfQoJCQkJCX0KCgkJCQkJcmV0dXJuIHZhbHVlczsKCQkJCX0sCgoJCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUgKSB7CgkJCQkJdmFyIG9wdGlvblNldCwgb3B0aW9uLAoJCQkJCQlvcHRpb25zID0gZWxlbS5vcHRpb25zLAoJCQkJCQl2YWx1ZXMgPSBqUXVlcnkubWFrZUFycmF5KCB2YWx1ZSApLAoJCQkJCQlpID0gb3B0aW9ucy5sZW5ndGg7CgoJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQlvcHRpb24gPSBvcHRpb25zWyBpIF07CgoJCQkJCQlpZiAoIGpRdWVyeS5pbkFycmF5KCBqUXVlcnkudmFsSG9va3Mub3B0aW9uLmdldCggb3B0aW9uICksIHZhbHVlcyApID49IDAgKSB7CgoJCQkJCQkJLy8gU3VwcG9ydDogSUU2CgkJCQkJCQkvLyBXaGVuIG5ldyBvcHRpb24gZWxlbWVudCBpcyBhZGRlZCB0byBzZWxlY3QgYm94IHdlIG5lZWQgdG8KCQkJCQkJCS8vIGZvcmNlIHJlZmxvdyBvZiBuZXdseSBhZGRlZCBub2RlIGluIG9yZGVyIHRvIHdvcmthcm91bmQgZGVsYXkKCQkJCQkJCS8vIG9mIGluaXRpYWxpemF0aW9uIHByb3BlcnRpZXMKCQkJCQkJCXRyeSB7CgkJCQkJCQkJb3B0aW9uLnNlbGVjdGVkID0gb3B0aW9uU2V0ID0gdHJ1ZTsKCgkJCQkJCQl9IGNhdGNoICggXyApIHsKCgkJCQkJCQkJLy8gV2lsbCBiZSBleGVjdXRlZCBvbmx5IGluIElFNgoJCQkJCQkJCW9wdGlvbi5zY3JvbGxIZWlnaHQ7CgkJCQkJCQl9CgoJCQkJCQl9IGVsc2UgewoJCQkJCQkJb3B0aW9uLnNlbGVjdGVkID0gZmFsc2U7CgkJCQkJCX0KCQkJCQl9CgoJCQkJCS8vIEZvcmNlIGJyb3dzZXJzIHRvIGJlaGF2ZSBjb25zaXN0ZW50bHkgd2hlbiBub24tbWF0Y2hpbmcgdmFsdWUgaXMgc2V0CgkJCQkJaWYgKCAhb3B0aW9uU2V0ICkgewoJCQkJCQllbGVtLnNlbGVjdGVkSW5kZXggPSAtMTsKCQkJCQl9CgoJCQkJCXJldHVybiBvcHRpb25zOwoJCQkJfQoJCQl9CgkJfQoJfSk7CgoJLy8gUmFkaW9zIGFuZCBjaGVja2JveGVzIGdldHRlci9zZXR0ZXIKCWpRdWVyeS5lYWNoKFsgInJhZGlvIiwgImNoZWNrYm94IiBdLCBmdW5jdGlvbigpIHsKCQlqUXVlcnkudmFsSG9va3NbIHRoaXMgXSA9IHsKCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUgKSB7CgkJCQlpZiAoIGpRdWVyeS5pc0FycmF5KCB2YWx1ZSApICkgewoJCQkJCXJldHVybiAoIGVsZW0uY2hlY2tlZCA9IGpRdWVyeS5pbkFycmF5KCBqUXVlcnkoZWxlbSkudmFsKCksIHZhbHVlICkgPj0gMCApOwoJCQkJfQoJCQl9CgkJfTsKCQlpZiAoICFzdXBwb3J0LmNoZWNrT24gKSB7CgkJCWpRdWVyeS52YWxIb29rc1sgdGhpcyBdLmdldCA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJLy8gU3VwcG9ydDogV2Via2l0CgkJCQkvLyAiIiBpcyByZXR1cm5lZCBpbnN0ZWFkIG9mICJvbiIgaWYgYSB2YWx1ZSBpc24ndCBzcGVjaWZpZWQKCQkJCXJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSgidmFsdWUiKSA9PT0gbnVsbCA/ICJvbiIgOiBlbGVtLnZhbHVlOwoJCQl9OwoJCX0KCX0pOwoKCgoKCXZhciBub2RlSG9vaywgYm9vbEhvb2ssCgkJYXR0ckhhbmRsZSA9IGpRdWVyeS5leHByLmF0dHJIYW5kbGUsCgkJcnVzZURlZmF1bHQgPSAvXig/OmNoZWNrZWR8c2VsZWN0ZWQpJC9pLAoJCWdldFNldEF0dHJpYnV0ZSA9IHN1cHBvcnQuZ2V0U2V0QXR0cmlidXRlLAoJCWdldFNldElucHV0ID0gc3VwcG9ydC5pbnB1dDsKCglqUXVlcnkuZm4uZXh0ZW5kKHsKCQlhdHRyOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7CgkJCXJldHVybiBhY2Nlc3MoIHRoaXMsIGpRdWVyeS5hdHRyLCBuYW1lLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgKTsKCQl9LAoKCQlyZW1vdmVBdHRyOiBmdW5jdGlvbiggbmFtZSApIHsKCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKCQkJCWpRdWVyeS5yZW1vdmVBdHRyKCB0aGlzLCBuYW1lICk7CgkJCX0pOwoJCX0KCX0pOwoKCWpRdWVyeS5leHRlbmQoewoJCWF0dHI6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSApIHsKCQkJdmFyIGhvb2tzLCByZXQsCgkJCQluVHlwZSA9IGVsZW0ubm9kZVR5cGU7CgoJCQkvLyBkb24ndCBnZXQvc2V0IGF0dHJpYnV0ZXMgb24gdGV4dCwgY29tbWVudCBhbmQgYXR0cmlidXRlIG5vZGVzCgkJCWlmICggIWVsZW0gfHwgblR5cGUgPT09IDMgfHwgblR5cGUgPT09IDggfHwgblR5cGUgPT09IDIgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIEZhbGxiYWNrIHRvIHByb3Agd2hlbiBhdHRyaWJ1dGVzIGFyZSBub3Qgc3VwcG9ydGVkCgkJCWlmICggdHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlID09PSBzdHJ1bmRlZmluZWQgKSB7CgkJCQlyZXR1cm4galF1ZXJ5LnByb3AoIGVsZW0sIG5hbWUsIHZhbHVlICk7CgkJCX0KCgkJCS8vIEFsbCBhdHRyaWJ1dGVzIGFyZSBsb3dlcmNhc2UKCQkJLy8gR3JhYiBuZWNlc3NhcnkgaG9vayBpZiBvbmUgaXMgZGVmaW5lZAoJCQlpZiAoIG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoIGVsZW0gKSApIHsKCQkJCW5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7CgkJCQlob29rcyA9IGpRdWVyeS5hdHRySG9va3NbIG5hbWUgXSB8fAoJCQkJCSggalF1ZXJ5LmV4cHIubWF0Y2guYm9vbC50ZXN0KCBuYW1lICkgPyBib29sSG9vayA6IG5vZGVIb29rICk7CgkJCX0KCgkJCWlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHsKCgkJCQlpZiAoIHZhbHVlID09PSBudWxsICkgewoJCQkJCWpRdWVyeS5yZW1vdmVBdHRyKCBlbGVtLCBuYW1lICk7CgoJCQkJfSBlbHNlIGlmICggaG9va3MgJiYgInNldCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLnNldCggZWxlbSwgdmFsdWUsIG5hbWUgKSkgIT09IHVuZGVmaW5lZCApIHsKCQkJCQlyZXR1cm4gcmV0OwoKCQkJCX0gZWxzZSB7CgkJCQkJZWxlbS5zZXRBdHRyaWJ1dGUoIG5hbWUsIHZhbHVlICsgIiIgKTsKCQkJCQlyZXR1cm4gdmFsdWU7CgkJCQl9CgoJCQl9IGVsc2UgaWYgKCBob29rcyAmJiAiZ2V0IiBpbiBob29rcyAmJiAocmV0ID0gaG9va3MuZ2V0KCBlbGVtLCBuYW1lICkpICE9PSBudWxsICkgewoJCQkJcmV0dXJuIHJldDsKCgkJCX0gZWxzZSB7CgkJCQlyZXQgPSBqUXVlcnkuZmluZC5hdHRyKCBlbGVtLCBuYW1lICk7CgoJCQkJLy8gTm9uLWV4aXN0ZW50IGF0dHJpYnV0ZXMgcmV0dXJuIG51bGwsIHdlIG5vcm1hbGl6ZSB0byB1bmRlZmluZWQKCQkJCXJldHVybiByZXQgPT0gbnVsbCA/CgkJCQkJdW5kZWZpbmVkIDoKCQkJCQlyZXQ7CgkJCX0KCQl9LAoKCQlyZW1vdmVBdHRyOiBmdW5jdGlvbiggZWxlbSwgdmFsdWUgKSB7CgkJCXZhciBuYW1lLCBwcm9wTmFtZSwKCQkJCWkgPSAwLAoJCQkJYXR0ck5hbWVzID0gdmFsdWUgJiYgdmFsdWUubWF0Y2goIHJub3R3aGl0ZSApOwoKCQkJaWYgKCBhdHRyTmFtZXMgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSApIHsKCQkJCXdoaWxlICggKG5hbWUgPSBhdHRyTmFtZXNbaSsrXSkgKSB7CgkJCQkJcHJvcE5hbWUgPSBqUXVlcnkucHJvcEZpeFsgbmFtZSBdIHx8IG5hbWU7CgoJCQkJCS8vIEJvb2xlYW4gYXR0cmlidXRlcyBnZXQgc3BlY2lhbCB0cmVhdG1lbnQgKCMxMDg3MCkKCQkJCQlpZiAoIGpRdWVyeS5leHByLm1hdGNoLmJvb2wudGVzdCggbmFtZSApICkgewoJCQkJCQkvLyBTZXQgY29ycmVzcG9uZGluZyBwcm9wZXJ0eSB0byBmYWxzZQoJCQkJCQlpZiAoIGdldFNldElucHV0ICYmIGdldFNldEF0dHJpYnV0ZSB8fCAhcnVzZURlZmF1bHQudGVzdCggbmFtZSApICkgewoJCQkJCQkJZWxlbVsgcHJvcE5hbWUgXSA9IGZhbHNlOwoJCQkJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCQkJCS8vIEFsc28gY2xlYXIgZGVmYXVsdENoZWNrZWQvZGVmYXVsdFNlbGVjdGVkIChpZiBhcHByb3ByaWF0ZSkKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCWVsZW1bIGpRdWVyeS5jYW1lbENhc2UoICJkZWZhdWx0LSIgKyBuYW1lICkgXSA9CgkJCQkJCQkJZWxlbVsgcHJvcE5hbWUgXSA9IGZhbHNlOwoJCQkJCQl9CgoJCQkJCS8vIFNlZSAjOTY5OSBmb3IgZXhwbGFuYXRpb24gb2YgdGhpcyBhcHByb2FjaCAoc2V0dGluZyBmaXJzdCwgdGhlbiByZW1vdmFsKQoJCQkJCX0gZWxzZSB7CgkJCQkJCWpRdWVyeS5hdHRyKCBlbGVtLCBuYW1lLCAiIiApOwoJCQkJCX0KCgkJCQkJZWxlbS5yZW1vdmVBdHRyaWJ1dGUoIGdldFNldEF0dHJpYnV0ZSA/IG5hbWUgOiBwcm9wTmFtZSApOwoJCQkJfQoJCQl9CgkJfSwKCgkJYXR0ckhvb2tzOiB7CgkJCXR5cGU6IHsKCQkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCQkJCWlmICggIXN1cHBvcnQucmFkaW9WYWx1ZSAmJiB2YWx1ZSA9PT0gInJhZGlvIiAmJiBqUXVlcnkubm9kZU5hbWUoZWxlbSwgImlucHV0IikgKSB7CgkJCQkJCS8vIFNldHRpbmcgdGhlIHR5cGUgb24gYSByYWRpbyBidXR0b24gYWZ0ZXIgdGhlIHZhbHVlIHJlc2V0cyB0aGUgdmFsdWUgaW4gSUU2LTkKCQkJCQkJLy8gUmVzZXQgdmFsdWUgdG8gZGVmYXVsdCBpbiBjYXNlIHR5cGUgaXMgc2V0IGFmdGVyIHZhbHVlIGR1cmluZyBjcmVhdGlvbgoJCQkJCQl2YXIgdmFsID0gZWxlbS52YWx1ZTsKCQkJCQkJZWxlbS5zZXRBdHRyaWJ1dGUoICJ0eXBlIiwgdmFsdWUgKTsKCQkJCQkJaWYgKCB2YWwgKSB7CgkJCQkJCQllbGVtLnZhbHVlID0gdmFsOwoJCQkJCQl9CgkJCQkJCXJldHVybiB2YWx1ZTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9Cgl9KTsKCgkvLyBIb29rIGZvciBib29sZWFuIGF0dHJpYnV0ZXMKCWJvb2xIb29rID0gewoJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlLCBuYW1lICkgewoJCQlpZiAoIHZhbHVlID09PSBmYWxzZSApIHsKCQkJCS8vIFJlbW92ZSBib29sZWFuIGF0dHJpYnV0ZXMgd2hlbiBzZXQgdG8gZmFsc2UKCQkJCWpRdWVyeS5yZW1vdmVBdHRyKCBlbGVtLCBuYW1lICk7CgkJCX0gZWxzZSBpZiAoIGdldFNldElucHV0ICYmIGdldFNldEF0dHJpYnV0ZSB8fCAhcnVzZURlZmF1bHQudGVzdCggbmFtZSApICkgewoJCQkJLy8gSUU8OCBuZWVkcyB0aGUgKnByb3BlcnR5KiBuYW1lCgkJCQllbGVtLnNldEF0dHJpYnV0ZSggIWdldFNldEF0dHJpYnV0ZSAmJiBqUXVlcnkucHJvcEZpeFsgbmFtZSBdIHx8IG5hbWUsIG5hbWUgKTsKCgkJCS8vIFVzZSBkZWZhdWx0Q2hlY2tlZCBhbmQgZGVmYXVsdFNlbGVjdGVkIGZvciBvbGRJRQoJCQl9IGVsc2UgewoJCQkJZWxlbVsgalF1ZXJ5LmNhbWVsQ2FzZSggImRlZmF1bHQtIiArIG5hbWUgKSBdID0gZWxlbVsgbmFtZSBdID0gdHJ1ZTsKCQkJfQoKCQkJcmV0dXJuIG5hbWU7CgkJfQoJfTsKCgkvLyBSZXRyaWV2ZSBib29sZWFucyBzcGVjaWFsbHkKCWpRdWVyeS5lYWNoKCBqUXVlcnkuZXhwci5tYXRjaC5ib29sLnNvdXJjZS5tYXRjaCggL1x3Ky9nICksIGZ1bmN0aW9uKCBpLCBuYW1lICkgewoKCQl2YXIgZ2V0dGVyID0gYXR0ckhhbmRsZVsgbmFtZSBdIHx8IGpRdWVyeS5maW5kLmF0dHI7CgoJCWF0dHJIYW5kbGVbIG5hbWUgXSA9IGdldFNldElucHV0ICYmIGdldFNldEF0dHJpYnV0ZSB8fCAhcnVzZURlZmF1bHQudGVzdCggbmFtZSApID8KCQkJZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkgewoJCQkJdmFyIHJldCwgaGFuZGxlOwoJCQkJaWYgKCAhaXNYTUwgKSB7CgkJCQkJLy8gQXZvaWQgYW4gaW5maW5pdGUgbG9vcCBieSB0ZW1wb3JhcmlseSByZW1vdmluZyB0aGlzIGZ1bmN0aW9uIGZyb20gdGhlIGdldHRlcgoJCQkJCWhhbmRsZSA9IGF0dHJIYW5kbGVbIG5hbWUgXTsKCQkJCQlhdHRySGFuZGxlWyBuYW1lIF0gPSByZXQ7CgkJCQkJcmV0ID0gZ2V0dGVyKCBlbGVtLCBuYW1lLCBpc1hNTCApICE9IG51bGwgPwoJCQkJCQluYW1lLnRvTG93ZXJDYXNlKCkgOgoJCQkJCQludWxsOwoJCQkJCWF0dHJIYW5kbGVbIG5hbWUgXSA9IGhhbmRsZTsKCQkJCX0KCQkJCXJldHVybiByZXQ7CgkJCX0gOgoJCQlmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7CgkJCQlpZiAoICFpc1hNTCApIHsKCQkJCQlyZXR1cm4gZWxlbVsgalF1ZXJ5LmNhbWVsQ2FzZSggImRlZmF1bHQtIiArIG5hbWUgKSBdID8KCQkJCQkJbmFtZS50b0xvd2VyQ2FzZSgpIDoKCQkJCQkJbnVsbDsKCQkJCX0KCQkJfTsKCX0pOwoKCS8vIGZpeCBvbGRJRSBhdHRyb3BlcnRpZXMKCWlmICggIWdldFNldElucHV0IHx8ICFnZXRTZXRBdHRyaWJ1dGUgKSB7CgkJalF1ZXJ5LmF0dHJIb29rcy52YWx1ZSA9IHsKCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIG5hbWUgKSB7CgkJCQlpZiAoIGpRdWVyeS5ub2RlTmFtZSggZWxlbSwgImlucHV0IiApICkgewoJCQkJCS8vIERvZXMgbm90IHJldHVybiBzbyB0aGF0IHNldEF0dHJpYnV0ZSBpcyBhbHNvIHVzZWQKCQkJCQllbGVtLmRlZmF1bHRWYWx1ZSA9IHZhbHVlOwoJCQkJfSBlbHNlIHsKCQkJCQkvLyBVc2Ugbm9kZUhvb2sgaWYgZGVmaW5lZCAoIzE5NTQpOyBvdGhlcndpc2Ugc2V0QXR0cmlidXRlIGlzIGZpbmUKCQkJCQlyZXR1cm4gbm9kZUhvb2sgJiYgbm9kZUhvb2suc2V0KCBlbGVtLCB2YWx1ZSwgbmFtZSApOwoJCQkJfQoJCQl9CgkJfTsKCX0KCgkvLyBJRTYvNyBkbyBub3Qgc3VwcG9ydCBnZXR0aW5nL3NldHRpbmcgc29tZSBhdHRyaWJ1dGVzIHdpdGggZ2V0L3NldEF0dHJpYnV0ZQoJaWYgKCAhZ2V0U2V0QXR0cmlidXRlICkgewoKCQkvLyBVc2UgdGhpcyBmb3IgYW55IGF0dHJpYnV0ZSBpbiBJRTYvNwoJCS8vIFRoaXMgZml4ZXMgYWxtb3N0IGV2ZXJ5IElFNi83IGlzc3VlCgkJbm9kZUhvb2sgPSB7CgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlLCBuYW1lICkgewoJCQkJLy8gU2V0IHRoZSBleGlzdGluZyBvciBjcmVhdGUgYSBuZXcgYXR0cmlidXRlIG5vZGUKCQkJCXZhciByZXQgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoIG5hbWUgKTsKCQkJCWlmICggIXJldCApIHsKCQkJCQllbGVtLnNldEF0dHJpYnV0ZU5vZGUoCgkJCQkJCShyZXQgPSBlbGVtLm93bmVyRG9jdW1lbnQuY3JlYXRlQXR0cmlidXRlKCBuYW1lICkpCgkJCQkJKTsKCQkJCX0KCgkJCQlyZXQudmFsdWUgPSB2YWx1ZSArPSAiIjsKCgkJCQkvLyBCcmVhayBhc3NvY2lhdGlvbiB3aXRoIGNsb25lZCBlbGVtZW50cyBieSBhbHNvIHVzaW5nIHNldEF0dHJpYnV0ZSAoIzk2NDYpCgkJCQlpZiAoIG5hbWUgPT09ICJ2YWx1ZSIgfHwgdmFsdWUgPT09IGVsZW0uZ2V0QXR0cmlidXRlKCBuYW1lICkgKSB7CgkJCQkJcmV0dXJuIHZhbHVlOwoJCQkJfQoJCQl9CgkJfTsKCgkJLy8gU29tZSBhdHRyaWJ1dGVzIGFyZSBjb25zdHJ1Y3RlZCB3aXRoIGVtcHR5LXN0cmluZyB2YWx1ZXMgd2hlbiBub3QgZGVmaW5lZAoJCWF0dHJIYW5kbGUuaWQgPSBhdHRySGFuZGxlLm5hbWUgPSBhdHRySGFuZGxlLmNvb3JkcyA9CgkJCWZ1bmN0aW9uKCBlbGVtLCBuYW1lLCBpc1hNTCApIHsKCQkJCXZhciByZXQ7CgkJCQlpZiAoICFpc1hNTCApIHsKCQkJCQlyZXR1cm4gKHJldCA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZSggbmFtZSApKSAmJiByZXQudmFsdWUgIT09ICIiID8KCQkJCQkJcmV0LnZhbHVlIDoKCQkJCQkJbnVsbDsKCQkJCX0KCQkJfTsKCgkJLy8gRml4aW5nIHZhbHVlIHJldHJpZXZhbCBvbiBhIGJ1dHRvbiByZXF1aXJlcyB0aGlzIG1vZHVsZQoJCWpRdWVyeS52YWxIb29rcy5idXR0b24gPSB7CgkJCWdldDogZnVuY3Rpb24oIGVsZW0sIG5hbWUgKSB7CgkJCQl2YXIgcmV0ID0gZWxlbS5nZXRBdHRyaWJ1dGVOb2RlKCBuYW1lICk7CgkJCQlpZiAoIHJldCAmJiByZXQuc3BlY2lmaWVkICkgewoJCQkJCXJldHVybiByZXQudmFsdWU7CgkJCQl9CgkJCX0sCgkJCXNldDogbm9kZUhvb2suc2V0CgkJfTsKCgkJLy8gU2V0IGNvbnRlbnRlZGl0YWJsZSB0byBmYWxzZSBvbiByZW1vdmFscygjMTA0MjkpCgkJLy8gU2V0dGluZyB0byBlbXB0eSBzdHJpbmcgdGhyb3dzIGFuIGVycm9yIGFzIGFuIGludmFsaWQgdmFsdWUKCQlqUXVlcnkuYXR0ckhvb2tzLmNvbnRlbnRlZGl0YWJsZSA9IHsKCQkJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIG5hbWUgKSB7CgkJCQlub2RlSG9vay5zZXQoIGVsZW0sIHZhbHVlID09PSAiIiA/IGZhbHNlIDogdmFsdWUsIG5hbWUgKTsKCQkJfQoJCX07CgoJCS8vIFNldCB3aWR0aCBhbmQgaGVpZ2h0IHRvIGF1dG8gaW5zdGVhZCBvZiAwIG9uIGVtcHR5IHN0cmluZyggQnVnICM4MTUwICkKCQkvLyBUaGlzIGlzIGZvciByZW1vdmFscwoJCWpRdWVyeS5lYWNoKFsgIndpZHRoIiwgImhlaWdodCIgXSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7CgkJCWpRdWVyeS5hdHRySG9va3NbIG5hbWUgXSA9IHsKCQkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCQkJCWlmICggdmFsdWUgPT09ICIiICkgewoJCQkJCQllbGVtLnNldEF0dHJpYnV0ZSggbmFtZSwgImF1dG8iICk7CgkJCQkJCXJldHVybiB2YWx1ZTsKCQkJCQl9CgkJCQl9CgkJCX07CgkJfSk7Cgl9CgoJaWYgKCAhc3VwcG9ydC5zdHlsZSApIHsKCQlqUXVlcnkuYXR0ckhvb2tzLnN0eWxlID0gewoJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJLy8gUmV0dXJuIHVuZGVmaW5lZCBpbiB0aGUgY2FzZSBvZiBlbXB0eSBzdHJpbmcKCQkJCS8vIE5vdGU6IElFIHVwcGVyY2FzZXMgY3NzIHByb3BlcnR5IG5hbWVzLCBidXQgaWYgd2Ugd2VyZSB0byAudG9Mb3dlckNhc2UoKQoJCQkJLy8gLmNzc1RleHQsIHRoYXQgd291bGQgZGVzdHJveSBjYXNlIHNlbnN0aXRpdml0eSBpbiBVUkwncywgbGlrZSBpbiAiYmFja2dyb3VuZCIKCQkJCXJldHVybiBlbGVtLnN0eWxlLmNzc1RleHQgfHwgdW5kZWZpbmVkOwoJCQl9LAoJCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHsKCQkJCXJldHVybiAoIGVsZW0uc3R5bGUuY3NzVGV4dCA9IHZhbHVlICsgIiIgKTsKCQkJfQoJCX07Cgl9CgoKCgoJdmFyIHJmb2N1c2FibGUgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b258b2JqZWN0KSQvaSwKCQlyY2xpY2thYmxlID0gL14oPzphfGFyZWEpJC9pOwoKCWpRdWVyeS5mbi5leHRlbmQoewoJCXByb3A6IGZ1bmN0aW9uKCBuYW1lLCB2YWx1ZSApIHsKCQkJcmV0dXJuIGFjY2VzcyggdGhpcywgalF1ZXJ5LnByb3AsIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSApOwoJCX0sCgoJCXJlbW92ZVByb3A6IGZ1bmN0aW9uKCBuYW1lICkgewoJCQluYW1lID0galF1ZXJ5LnByb3BGaXhbIG5hbWUgXSB8fCBuYW1lOwoJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJLy8gdHJ5L2NhdGNoIGhhbmRsZXMgY2FzZXMgd2hlcmUgSUUgYmFsa3MgKHN1Y2ggYXMgcmVtb3ZpbmcgYSBwcm9wZXJ0eSBvbiB3aW5kb3cpCgkJCQl0cnkgewoJCQkJCXRoaXNbIG5hbWUgXSA9IHVuZGVmaW5lZDsKCQkJCQlkZWxldGUgdGhpc1sgbmFtZSBdOwoJCQkJfSBjYXRjaCggZSApIHt9CgkJCX0pOwoJCX0KCX0pOwoKCWpRdWVyeS5leHRlbmQoewoJCXByb3BGaXg6IHsKCQkJImZvciI6ICJodG1sRm9yIiwKCQkJImNsYXNzIjogImNsYXNzTmFtZSIKCQl9LAoKCQlwcm9wOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUgKSB7CgkJCXZhciByZXQsIGhvb2tzLCBub3R4bWwsCgkJCQluVHlwZSA9IGVsZW0ubm9kZVR5cGU7CgoJCQkvLyBkb24ndCBnZXQvc2V0IHByb3BlcnRpZXMgb24gdGV4dCwgY29tbWVudCBhbmQgYXR0cmlidXRlIG5vZGVzCgkJCWlmICggIWVsZW0gfHwgblR5cGUgPT09IDMgfHwgblR5cGUgPT09IDggfHwgblR5cGUgPT09IDIgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCW5vdHhtbCA9IG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoIGVsZW0gKTsKCgkJCWlmICggbm90eG1sICkgewoJCQkJLy8gRml4IG5hbWUgYW5kIGF0dGFjaCBob29rcwoJCQkJbmFtZSA9IGpRdWVyeS5wcm9wRml4WyBuYW1lIF0gfHwgbmFtZTsKCQkJCWhvb2tzID0galF1ZXJ5LnByb3BIb29rc1sgbmFtZSBdOwoJCQl9CgoJCQlpZiAoIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7CgkJCQlyZXR1cm4gaG9va3MgJiYgInNldCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLnNldCggZWxlbSwgdmFsdWUsIG5hbWUgKSkgIT09IHVuZGVmaW5lZCA/CgkJCQkJcmV0IDoKCQkJCQkoIGVsZW1bIG5hbWUgXSA9IHZhbHVlICk7CgoJCQl9IGVsc2UgewoJCQkJcmV0dXJuIGhvb2tzICYmICJnZXQiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5nZXQoIGVsZW0sIG5hbWUgKSkgIT09IG51bGwgPwoJCQkJCXJldCA6CgkJCQkJZWxlbVsgbmFtZSBdOwoJCQl9CgkJfSwKCgkJcHJvcEhvb2tzOiB7CgkJCXRhYkluZGV4OiB7CgkJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCS8vIGVsZW0udGFiSW5kZXggZG9lc24ndCBhbHdheXMgcmV0dXJuIHRoZSBjb3JyZWN0IHZhbHVlIHdoZW4gaXQgaGFzbid0IGJlZW4gZXhwbGljaXRseSBzZXQKCQkJCQkvLyBodHRwOi8vZmx1aWRwcm9qZWN0Lm9yZy9ibG9nLzIwMDgvMDEvMDkvZ2V0dGluZy1zZXR0aW5nLWFuZC1yZW1vdmluZy10YWJpbmRleC12YWx1ZXMtd2l0aC1qYXZhc2NyaXB0LwoJCQkJCS8vIFVzZSBwcm9wZXIgYXR0cmlidXRlIHJldHJpZXZhbCgjMTIwNzIpCgkJCQkJdmFyIHRhYmluZGV4ID0galF1ZXJ5LmZpbmQuYXR0ciggZWxlbSwgInRhYmluZGV4IiApOwoKCQkJCQlyZXR1cm4gdGFiaW5kZXggPwoJCQkJCQlwYXJzZUludCggdGFiaW5kZXgsIDEwICkgOgoJCQkJCQlyZm9jdXNhYmxlLnRlc3QoIGVsZW0ubm9kZU5hbWUgKSB8fCByY2xpY2thYmxlLnRlc3QoIGVsZW0ubm9kZU5hbWUgKSAmJiBlbGVtLmhyZWYgPwoJCQkJCQkJMCA6CgkJCQkJCQktMTsKCQkJCX0KCQkJfQoJCX0KCX0pOwoKCS8vIFNvbWUgYXR0cmlidXRlcyByZXF1aXJlIGEgc3BlY2lhbCBjYWxsIG9uIElFCgkvLyBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvbXM1MzY0MjklMjhWUy44NSUyOS5hc3B4CglpZiAoICFzdXBwb3J0LmhyZWZOb3JtYWxpemVkICkgewoJCS8vIGhyZWYvc3JjIHByb3BlcnR5IHNob3VsZCBnZXQgdGhlIGZ1bGwgbm9ybWFsaXplZCBVUkwgKCMxMDI5OS8jMTI5MTUpCgkJalF1ZXJ5LmVhY2goWyAiaHJlZiIsICJzcmMiIF0sIGZ1bmN0aW9uKCBpLCBuYW1lICkgewoJCQlqUXVlcnkucHJvcEhvb2tzWyBuYW1lIF0gPSB7CgkJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCXJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSggbmFtZSwgNCApOwoJCQkJfQoJCQl9OwoJCX0pOwoJfQoKCS8vIFN1cHBvcnQ6IFNhZmFyaSwgSUU5KwoJLy8gbWlzLXJlcG9ydHMgdGhlIGRlZmF1bHQgc2VsZWN0ZWQgcHJvcGVydHkgb2YgYW4gb3B0aW9uCgkvLyBBY2Nlc3NpbmcgdGhlIHBhcmVudCdzIHNlbGVjdGVkSW5kZXggcHJvcGVydHkgZml4ZXMgaXQKCWlmICggIXN1cHBvcnQub3B0U2VsZWN0ZWQgKSB7CgkJalF1ZXJ5LnByb3BIb29rcy5zZWxlY3RlZCA9IHsKCQkJZ2V0OiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXZhciBwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGU7CgoJCQkJaWYgKCBwYXJlbnQgKSB7CgkJCQkJcGFyZW50LnNlbGVjdGVkSW5kZXg7CgoJCQkJCS8vIE1ha2Ugc3VyZSB0aGF0IGl0IGFsc28gd29ya3Mgd2l0aCBvcHRncm91cHMsIHNlZSAjNTcwMQoJCQkJCWlmICggcGFyZW50LnBhcmVudE5vZGUgKSB7CgkJCQkJCXBhcmVudC5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXg7CgkJCQkJfQoJCQkJfQoJCQkJcmV0dXJuIG51bGw7CgkJCX0KCQl9OwoJfQoKCWpRdWVyeS5lYWNoKFsKCQkidGFiSW5kZXgiLAoJCSJyZWFkT25seSIsCgkJIm1heExlbmd0aCIsCgkJImNlbGxTcGFjaW5nIiwKCQkiY2VsbFBhZGRpbmciLAoJCSJyb3dTcGFuIiwKCQkiY29sU3BhbiIsCgkJInVzZU1hcCIsCgkJImZyYW1lQm9yZGVyIiwKCQkiY29udGVudEVkaXRhYmxlIgoJXSwgZnVuY3Rpb24oKSB7CgkJalF1ZXJ5LnByb3BGaXhbIHRoaXMudG9Mb3dlckNhc2UoKSBdID0gdGhpczsKCX0pOwoKCS8vIElFNi83IGNhbGwgZW5jdHlwZSBlbmNvZGluZwoJaWYgKCAhc3VwcG9ydC5lbmN0eXBlICkgewoJCWpRdWVyeS5wcm9wRml4LmVuY3R5cGUgPSAiZW5jb2RpbmciOwoJfQoKCgoKCXZhciByY2xhc3MgPSAvW1x0XHJcblxmXS9nOwoKCWpRdWVyeS5mbi5leHRlbmQoewoJCWFkZENsYXNzOiBmdW5jdGlvbiggdmFsdWUgKSB7CgkJCXZhciBjbGFzc2VzLCBlbGVtLCBjdXIsIGNsYXp6LCBqLCBmaW5hbFZhbHVlLAoJCQkJaSA9IDAsCgkJCQlsZW4gPSB0aGlzLmxlbmd0aCwKCQkJCXByb2NlZWQgPSB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICYmIHZhbHVlOwoKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHsKCQkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGogKSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkuYWRkQ2xhc3MoIHZhbHVlLmNhbGwoIHRoaXMsIGosIHRoaXMuY2xhc3NOYW1lICkgKTsKCQkJCX0pOwoJCQl9CgoJCQlpZiAoIHByb2NlZWQgKSB7CgkJCQkvLyBUaGUgZGlzanVuY3Rpb24gaGVyZSBpcyBmb3IgYmV0dGVyIGNvbXByZXNzaWJpbGl0eSAoc2VlIHJlbW92ZUNsYXNzKQoJCQkJY2xhc3NlcyA9ICggdmFsdWUgfHwgIiIgKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgW107CgoJCQkJZm9yICggOyBpIDwgbGVuOyBpKysgKSB7CgkJCQkJZWxlbSA9IHRoaXNbIGkgXTsKCQkJCQljdXIgPSBlbGVtLm5vZGVUeXBlID09PSAxICYmICggZWxlbS5jbGFzc05hbWUgPwoJCQkJCQkoICIgIiArIGVsZW0uY2xhc3NOYW1lICsgIiAiICkucmVwbGFjZSggcmNsYXNzLCAiICIgKSA6CgkJCQkJCSIgIgoJCQkJCSk7CgoJCQkJCWlmICggY3VyICkgewoJCQkJCQlqID0gMDsKCQkJCQkJd2hpbGUgKCAoY2xhenogPSBjbGFzc2VzW2orK10pICkgewoJCQkJCQkJaWYgKCBjdXIuaW5kZXhPZiggIiAiICsgY2xhenogKyAiICIgKSA8IDAgKSB7CgkJCQkJCQkJY3VyICs9IGNsYXp6ICsgIiAiOwoJCQkJCQkJfQoJCQkJCQl9CgoJCQkJCQkvLyBvbmx5IGFzc2lnbiBpZiBkaWZmZXJlbnQgdG8gYXZvaWQgdW5uZWVkZWQgcmVuZGVyaW5nLgoJCQkJCQlmaW5hbFZhbHVlID0galF1ZXJ5LnRyaW0oIGN1ciApOwoJCQkJCQlpZiAoIGVsZW0uY2xhc3NOYW1lICE9PSBmaW5hbFZhbHVlICkgewoJCQkJCQkJZWxlbS5jbGFzc05hbWUgPSBmaW5hbFZhbHVlOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gdGhpczsKCQl9LAoKCQlyZW1vdmVDbGFzczogZnVuY3Rpb24oIHZhbHVlICkgewoJCQl2YXIgY2xhc3NlcywgZWxlbSwgY3VyLCBjbGF6eiwgaiwgZmluYWxWYWx1ZSwKCQkJCWkgPSAwLAoJCQkJbGVuID0gdGhpcy5sZW5ndGgsCgkJCQlwcm9jZWVkID0gYXJndW1lbnRzLmxlbmd0aCA9PT0gMCB8fCB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICYmIHZhbHVlOwoKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHsKCQkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGogKSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkucmVtb3ZlQ2xhc3MoIHZhbHVlLmNhbGwoIHRoaXMsIGosIHRoaXMuY2xhc3NOYW1lICkgKTsKCQkJCX0pOwoJCQl9CgkJCWlmICggcHJvY2VlZCApIHsKCQkJCWNsYXNzZXMgPSAoIHZhbHVlIHx8ICIiICkubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdOwoKCQkJCWZvciAoIDsgaSA8IGxlbjsgaSsrICkgewoJCQkJCWVsZW0gPSB0aGlzWyBpIF07CgkJCQkJLy8gVGhpcyBleHByZXNzaW9uIGlzIGhlcmUgZm9yIGJldHRlciBjb21wcmVzc2liaWxpdHkgKHNlZSBhZGRDbGFzcykKCQkJCQljdXIgPSBlbGVtLm5vZGVUeXBlID09PSAxICYmICggZWxlbS5jbGFzc05hbWUgPwoJCQkJCQkoICIgIiArIGVsZW0uY2xhc3NOYW1lICsgIiAiICkucmVwbGFjZSggcmNsYXNzLCAiICIgKSA6CgkJCQkJCSIiCgkJCQkJKTsKCgkJCQkJaWYgKCBjdXIgKSB7CgkJCQkJCWogPSAwOwoJCQkJCQl3aGlsZSAoIChjbGF6eiA9IGNsYXNzZXNbaisrXSkgKSB7CgkJCQkJCQkvLyBSZW1vdmUgKmFsbCogaW5zdGFuY2VzCgkJCQkJCQl3aGlsZSAoIGN1ci5pbmRleE9mKCAiICIgKyBjbGF6eiArICIgIiApID49IDAgKSB7CgkJCQkJCQkJY3VyID0gY3VyLnJlcGxhY2UoICIgIiArIGNsYXp6ICsgIiAiLCAiICIgKTsKCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJLy8gb25seSBhc3NpZ24gaWYgZGlmZmVyZW50IHRvIGF2b2lkIHVubmVlZGVkIHJlbmRlcmluZy4KCQkJCQkJZmluYWxWYWx1ZSA9IHZhbHVlID8galF1ZXJ5LnRyaW0oIGN1ciApIDogIiI7CgkJCQkJCWlmICggZWxlbS5jbGFzc05hbWUgIT09IGZpbmFsVmFsdWUgKSB7CgkJCQkJCQllbGVtLmNsYXNzTmFtZSA9IGZpbmFsVmFsdWU7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCgkJCXJldHVybiB0aGlzOwoJCX0sCgoJCXRvZ2dsZUNsYXNzOiBmdW5jdGlvbiggdmFsdWUsIHN0YXRlVmFsICkgewoJCQl2YXIgdHlwZSA9IHR5cGVvZiB2YWx1ZTsKCgkJCWlmICggdHlwZW9mIHN0YXRlVmFsID09PSAiYm9vbGVhbiIgJiYgdHlwZSA9PT0gInN0cmluZyIgKSB7CgkJCQlyZXR1cm4gc3RhdGVWYWwgPyB0aGlzLmFkZENsYXNzKCB2YWx1ZSApIDogdGhpcy5yZW1vdmVDbGFzcyggdmFsdWUgKTsKCQkJfQoKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHsKCQkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGkgKSB7CgkJCQkJalF1ZXJ5KCB0aGlzICkudG9nZ2xlQ2xhc3MoIHZhbHVlLmNhbGwodGhpcywgaSwgdGhpcy5jbGFzc05hbWUsIHN0YXRlVmFsKSwgc3RhdGVWYWwgKTsKCQkJCX0pOwoJCQl9CgoJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJaWYgKCB0eXBlID09PSAic3RyaW5nIiApIHsKCQkJCQkvLyB0b2dnbGUgaW5kaXZpZHVhbCBjbGFzcyBuYW1lcwoJCQkJCXZhciBjbGFzc05hbWUsCgkJCQkJCWkgPSAwLAoJCQkJCQlzZWxmID0galF1ZXJ5KCB0aGlzICksCgkJCQkJCWNsYXNzTmFtZXMgPSB2YWx1ZS5tYXRjaCggcm5vdHdoaXRlICkgfHwgW107CgoJCQkJCXdoaWxlICggKGNsYXNzTmFtZSA9IGNsYXNzTmFtZXNbIGkrKyBdKSApIHsKCQkJCQkJLy8gY2hlY2sgZWFjaCBjbGFzc05hbWUgZ2l2ZW4sIHNwYWNlIHNlcGFyYXRlZCBsaXN0CgkJCQkJCWlmICggc2VsZi5oYXNDbGFzcyggY2xhc3NOYW1lICkgKSB7CgkJCQkJCQlzZWxmLnJlbW92ZUNsYXNzKCBjbGFzc05hbWUgKTsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCXNlbGYuYWRkQ2xhc3MoIGNsYXNzTmFtZSApOwoJCQkJCQl9CgkJCQkJfQoKCQkJCS8vIFRvZ2dsZSB3aG9sZSBjbGFzcyBuYW1lCgkJCQl9IGVsc2UgaWYgKCB0eXBlID09PSBzdHJ1bmRlZmluZWQgfHwgdHlwZSA9PT0gImJvb2xlYW4iICkgewoJCQkJCWlmICggdGhpcy5jbGFzc05hbWUgKSB7CgkJCQkJCS8vIHN0b3JlIGNsYXNzTmFtZSBpZiBzZXQKCQkJCQkJalF1ZXJ5Ll9kYXRhKCB0aGlzLCAiX19jbGFzc05hbWVfXyIsIHRoaXMuY2xhc3NOYW1lICk7CgkJCQkJfQoKCQkJCQkvLyBJZiB0aGUgZWxlbWVudCBoYXMgYSBjbGFzcyBuYW1lIG9yIGlmIHdlJ3JlIHBhc3NlZCAiZmFsc2UiLAoJCQkJCS8vIHRoZW4gcmVtb3ZlIHRoZSB3aG9sZSBjbGFzc25hbWUgKGlmIHRoZXJlIHdhcyBvbmUsIHRoZSBhYm92ZSBzYXZlZCBpdCkuCgkJCQkJLy8gT3RoZXJ3aXNlIGJyaW5nIGJhY2sgd2hhdGV2ZXIgd2FzIHByZXZpb3VzbHkgc2F2ZWQgKGlmIGFueXRoaW5nKSwKCQkJCQkvLyBmYWxsaW5nIGJhY2sgdG8gdGhlIGVtcHR5IHN0cmluZyBpZiBub3RoaW5nIHdhcyBzdG9yZWQuCgkJCQkJdGhpcy5jbGFzc05hbWUgPSB0aGlzLmNsYXNzTmFtZSB8fCB2YWx1ZSA9PT0gZmFsc2UgPyAiIiA6IGpRdWVyeS5fZGF0YSggdGhpcywgIl9fY2xhc3NOYW1lX18iICkgfHwgIiI7CgkJCQl9CgkJCX0pOwoJCX0sCgoJCWhhc0NsYXNzOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXZhciBjbGFzc05hbWUgPSAiICIgKyBzZWxlY3RvciArICIgIiwKCQkJCWkgPSAwLAoJCQkJbCA9IHRoaXMubGVuZ3RoOwoJCQlmb3IgKCA7IGkgPCBsOyBpKysgKSB7CgkJCQlpZiAoIHRoaXNbaV0ubm9kZVR5cGUgPT09IDEgJiYgKCIgIiArIHRoaXNbaV0uY2xhc3NOYW1lICsgIiAiKS5yZXBsYWNlKHJjbGFzcywgIiAiKS5pbmRleE9mKCBjbGFzc05hbWUgKSA+PSAwICkgewoJCQkJCXJldHVybiB0cnVlOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJfSk7CgoKCgoJLy8gUmV0dXJuIGpRdWVyeSBmb3IgYXR0cmlidXRlcy1vbmx5IGluY2x1c2lvbgoKCglqUXVlcnkuZWFjaCggKCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgbG9hZCByZXNpemUgc2Nyb2xsIHVubG9hZCBjbGljayBkYmxjbGljayAiICsKCQkibW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgIiArCgkJImNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgZXJyb3IgY29udGV4dG1lbnUiKS5zcGxpdCgiICIpLCBmdW5jdGlvbiggaSwgbmFtZSApIHsKCgkJLy8gSGFuZGxlIGV2ZW50IGJpbmRpbmcKCQlqUXVlcnkuZm5bIG5hbWUgXSA9IGZ1bmN0aW9uKCBkYXRhLCBmbiApIHsKCQkJcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPiAwID8KCQkJCXRoaXMub24oIG5hbWUsIG51bGwsIGRhdGEsIGZuICkgOgoJCQkJdGhpcy50cmlnZ2VyKCBuYW1lICk7CgkJfTsKCX0pOwoKCWpRdWVyeS5mbi5leHRlbmQoewoJCWhvdmVyOiBmdW5jdGlvbiggZm5PdmVyLCBmbk91dCApIHsKCQkJcmV0dXJuIHRoaXMubW91c2VlbnRlciggZm5PdmVyICkubW91c2VsZWF2ZSggZm5PdXQgfHwgZm5PdmVyICk7CgkJfSwKCgkJYmluZDogZnVuY3Rpb24oIHR5cGVzLCBkYXRhLCBmbiApIHsKCQkJcmV0dXJuIHRoaXMub24oIHR5cGVzLCBudWxsLCBkYXRhLCBmbiApOwoJCX0sCgkJdW5iaW5kOiBmdW5jdGlvbiggdHlwZXMsIGZuICkgewoJCQlyZXR1cm4gdGhpcy5vZmYoIHR5cGVzLCBudWxsLCBmbiApOwoJCX0sCgoJCWRlbGVnYXRlOiBmdW5jdGlvbiggc2VsZWN0b3IsIHR5cGVzLCBkYXRhLCBmbiApIHsKCQkJcmV0dXJuIHRoaXMub24oIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4gKTsKCQl9LAoJCXVuZGVsZWdhdGU6IGZ1bmN0aW9uKCBzZWxlY3RvciwgdHlwZXMsIGZuICkgewoJCQkvLyAoIG5hbWVzcGFjZSApIG9yICggc2VsZWN0b3IsIHR5cGVzIFssIGZuXSApCgkJCXJldHVybiBhcmd1bWVudHMubGVuZ3RoID09PSAxID8gdGhpcy5vZmYoIHNlbGVjdG9yLCAiKioiICkgOiB0aGlzLm9mZiggdHlwZXMsIHNlbGVjdG9yIHx8ICIqKiIsIGZuICk7CgkJfQoJfSk7CgoKCXZhciBub25jZSA9IGpRdWVyeS5ub3coKTsKCgl2YXIgcnF1ZXJ5ID0gKC9cPy8pOwoKCgoJdmFyIHJ2YWxpZHRva2VucyA9IC8oLCl8KFxbfHspfCh9fF0pfCIoPzpbXiJcXFxyXG5dfFxcWyJcXFwvYmZucnRdfFxcdVtcZGEtZkEtRl17NH0pKiJccyo6P3x0cnVlfGZhbHNlfG51bGx8LT8oPyEwXGQpXGQrKD86XC5cZCt8KSg/OltlRV1bKy1dP1xkK3wpL2c7CgoJalF1ZXJ5LnBhcnNlSlNPTiA9IGZ1bmN0aW9uKCBkYXRhICkgewoJCS8vIEF0dGVtcHQgdG8gcGFyc2UgdXNpbmcgdGhlIG5hdGl2ZSBKU09OIHBhcnNlciBmaXJzdAoJCWlmICggd2luZG93LkpTT04gJiYgd2luZG93LkpTT04ucGFyc2UgKSB7CgkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zCgkJCS8vIFdvcmthcm91bmQgZmFpbHVyZSB0byBzdHJpbmctY2FzdCBudWxsIGlucHV0CgkJCXJldHVybiB3aW5kb3cuSlNPTi5wYXJzZSggZGF0YSArICIiICk7CgkJfQoKCQl2YXIgcmVxdWlyZU5vbkNvbW1hLAoJCQlkZXB0aCA9IG51bGwsCgkJCXN0ciA9IGpRdWVyeS50cmltKCBkYXRhICsgIiIgKTsKCgkJLy8gR3VhcmQgYWdhaW5zdCBpbnZhbGlkIChhbmQgcG9zc2libHkgZGFuZ2Vyb3VzKSBpbnB1dCBieSBlbnN1cmluZyB0aGF0IG5vdGhpbmcgcmVtYWlucwoJCS8vIGFmdGVyIHJlbW92aW5nIHZhbGlkIHRva2VucwoJCXJldHVybiBzdHIgJiYgIWpRdWVyeS50cmltKCBzdHIucmVwbGFjZSggcnZhbGlkdG9rZW5zLCBmdW5jdGlvbiggdG9rZW4sIGNvbW1hLCBvcGVuLCBjbG9zZSApIHsKCgkJCS8vIEZvcmNlIHRlcm1pbmF0aW9uIGlmIHdlIHNlZSBhIG1pc3BsYWNlZCBjb21tYQoJCQlpZiAoIHJlcXVpcmVOb25Db21tYSAmJiBjb21tYSApIHsKCQkJCWRlcHRoID0gMDsKCQkJfQoKCQkJLy8gUGVyZm9ybSBubyBtb3JlIHJlcGxhY2VtZW50cyBhZnRlciByZXR1cm5pbmcgdG8gb3V0ZXJtb3N0IGRlcHRoCgkJCWlmICggZGVwdGggPT09IDAgKSB7CgkJCQlyZXR1cm4gdG9rZW47CgkJCX0KCgkJCS8vIENvbW1hcyBtdXN0IG5vdCBmb2xsb3cgIlsiLCAieyIsIG9yICIsIgoJCQlyZXF1aXJlTm9uQ29tbWEgPSBvcGVuIHx8IGNvbW1hOwoKCQkJLy8gRGV0ZXJtaW5lIG5ldyBkZXB0aAoJCQkvLyBhcnJheS9vYmplY3Qgb3BlbiAoIlsiIG9yICJ7Iik6IGRlcHRoICs9IHRydWUgLSBmYWxzZSAoaW5jcmVtZW50KQoJCQkvLyBhcnJheS9vYmplY3QgY2xvc2UgKCJdIiBvciAifSIpOiBkZXB0aCArPSBmYWxzZSAtIHRydWUgKGRlY3JlbWVudCkKCQkJLy8gb3RoZXIgY2FzZXMgKCIsIiBvciBwcmltaXRpdmUpOiBkZXB0aCArPSB0cnVlIC0gdHJ1ZSAobnVtZXJpYyBjYXN0KQoJCQlkZXB0aCArPSAhY2xvc2UgLSAhb3BlbjsKCgkJCS8vIFJlbW92ZSB0aGlzIHRva2VuCgkJCXJldHVybiAiIjsKCQl9KSApID8KCQkJKCBGdW5jdGlvbiggInJldHVybiAiICsgc3RyICkgKSgpIDoKCQkJalF1ZXJ5LmVycm9yKCAiSW52YWxpZCBKU09OOiAiICsgZGF0YSApOwoJfTsKCgoJLy8gQ3Jvc3MtYnJvd3NlciB4bWwgcGFyc2luZwoJalF1ZXJ5LnBhcnNlWE1MID0gZnVuY3Rpb24oIGRhdGEgKSB7CgkJdmFyIHhtbCwgdG1wOwoJCWlmICggIWRhdGEgfHwgdHlwZW9mIGRhdGEgIT09ICJzdHJpbmciICkgewoJCQlyZXR1cm4gbnVsbDsKCQl9CgkJdHJ5IHsKCQkJaWYgKCB3aW5kb3cuRE9NUGFyc2VyICkgeyAvLyBTdGFuZGFyZAoJCQkJdG1wID0gbmV3IERPTVBhcnNlcigpOwoJCQkJeG1sID0gdG1wLnBhcnNlRnJvbVN0cmluZyggZGF0YSwgInRleHQveG1sIiApOwoJCQl9IGVsc2UgeyAvLyBJRQoJCQkJeG1sID0gbmV3IEFjdGl2ZVhPYmplY3QoICJNaWNyb3NvZnQuWE1MRE9NIiApOwoJCQkJeG1sLmFzeW5jID0gImZhbHNlIjsKCQkJCXhtbC5sb2FkWE1MKCBkYXRhICk7CgkJCX0KCQl9IGNhdGNoKCBlICkgewoJCQl4bWwgPSB1bmRlZmluZWQ7CgkJfQoJCWlmICggIXhtbCB8fCAheG1sLmRvY3VtZW50RWxlbWVudCB8fCB4bWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICJwYXJzZXJlcnJvciIgKS5sZW5ndGggKSB7CgkJCWpRdWVyeS5lcnJvciggIkludmFsaWQgWE1MOiAiICsgZGF0YSApOwoJCX0KCQlyZXR1cm4geG1sOwoJfTsKCgoJdmFyCgkJLy8gRG9jdW1lbnQgbG9jYXRpb24KCQlhamF4TG9jUGFydHMsCgkJYWpheExvY2F0aW9uLAoKCQlyaGFzaCA9IC8jLiokLywKCQlydHMgPSAvKFs/Jl0pXz1bXiZdKi8sCgkJcmhlYWRlcnMgPSAvXiguKj8pOlsgXHRdKihbXlxyXG5dKilccj8kL21nLCAvLyBJRSBsZWF2ZXMgYW4gXHIgY2hhcmFjdGVyIGF0IEVPTAoJCS8vICM3NjUzLCAjODEyNSwgIzgxNTI6IGxvY2FsIHByb3RvY29sIGRldGVjdGlvbgoJCXJsb2NhbFByb3RvY29sID0gL14oPzphYm91dHxhcHB8YXBwLXN0b3JhZ2V8ListZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8sCgkJcm5vQ29udGVudCA9IC9eKD86R0VUfEhFQUQpJC8sCgkJcnByb3RvY29sID0gL15cL1wvLywKCQlydXJsID0gL14oW1x3ListXSs6KSg/OlwvXC8oPzpbXlwvPyNdKkB8KShbXlwvPyM6XSopKD86OihcZCspfCl8KS8sCgoJCS8qIFByZWZpbHRlcnMKCQkgKiAxKSBUaGV5IGFyZSB1c2VmdWwgdG8gaW50cm9kdWNlIGN1c3RvbSBkYXRhVHlwZXMgKHNlZSBhamF4L2pzb25wLmpzIGZvciBhbiBleGFtcGxlKQoJCSAqIDIpIFRoZXNlIGFyZSBjYWxsZWQ6CgkJICogICAgLSBCRUZPUkUgYXNraW5nIGZvciBhIHRyYW5zcG9ydAoJCSAqICAgIC0gQUZURVIgcGFyYW0gc2VyaWFsaXphdGlvbiAocy5kYXRhIGlzIGEgc3RyaW5nIGlmIHMucHJvY2Vzc0RhdGEgaXMgdHJ1ZSkKCQkgKiAzKSBrZXkgaXMgdGhlIGRhdGFUeXBlCgkJICogNCkgdGhlIGNhdGNoYWxsIHN5bWJvbCAiKiIgY2FuIGJlIHVzZWQKCQkgKiA1KSBleGVjdXRpb24gd2lsbCBzdGFydCB3aXRoIHRyYW5zcG9ydCBkYXRhVHlwZSBhbmQgVEhFTiBjb250aW51ZSBkb3duIHRvICIqIiBpZiBuZWVkZWQKCQkgKi8KCQlwcmVmaWx0ZXJzID0ge30sCgoJCS8qIFRyYW5zcG9ydHMgYmluZGluZ3MKCQkgKiAxKSBrZXkgaXMgdGhlIGRhdGFUeXBlCgkJICogMikgdGhlIGNhdGNoYWxsIHN5bWJvbCAiKiIgY2FuIGJlIHVzZWQKCQkgKiAzKSBzZWxlY3Rpb24gd2lsbCBzdGFydCB3aXRoIHRyYW5zcG9ydCBkYXRhVHlwZSBhbmQgVEhFTiBnbyB0byAiKiIgaWYgbmVlZGVkCgkJICovCgkJdHJhbnNwb3J0cyA9IHt9LAoKCQkvLyBBdm9pZCBjb21tZW50LXByb2xvZyBjaGFyIHNlcXVlbmNlICgjMTAwOTgpOyBtdXN0IGFwcGVhc2UgbGludCBhbmQgZXZhZGUgY29tcHJlc3Npb24KCQlhbGxUeXBlcyA9ICIqLyIuY29uY2F0KCIqIik7CgoJLy8gIzgxMzgsIElFIG1heSB0aHJvdyBhbiBleGNlcHRpb24gd2hlbiBhY2Nlc3NpbmcKCS8vIGEgZmllbGQgZnJvbSB3aW5kb3cubG9jYXRpb24gaWYgZG9jdW1lbnQuZG9tYWluIGhhcyBiZWVuIHNldAoJdHJ5IHsKCQlhamF4TG9jYXRpb24gPSBsb2NhdGlvbi5ocmVmOwoJfSBjYXRjaCggZSApIHsKCQkvLyBVc2UgdGhlIGhyZWYgYXR0cmlidXRlIG9mIGFuIEEgZWxlbWVudAoJCS8vIHNpbmNlIElFIHdpbGwgbW9kaWZ5IGl0IGdpdmVuIGRvY3VtZW50LmxvY2F0aW9uCgkJYWpheExvY2F0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImEiICk7CgkJYWpheExvY2F0aW9uLmhyZWYgPSAiIjsKCQlhamF4TG9jYXRpb24gPSBhamF4TG9jYXRpb24uaHJlZjsKCX0KCgkvLyBTZWdtZW50IGxvY2F0aW9uIGludG8gcGFydHMKCWFqYXhMb2NQYXJ0cyA9IHJ1cmwuZXhlYyggYWpheExvY2F0aW9uLnRvTG93ZXJDYXNlKCkgKSB8fCBbXTsKCgkvLyBCYXNlICJjb25zdHJ1Y3RvciIgZm9yIGpRdWVyeS5hamF4UHJlZmlsdGVyIGFuZCBqUXVlcnkuYWpheFRyYW5zcG9ydAoJZnVuY3Rpb24gYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCBzdHJ1Y3R1cmUgKSB7CgoJCS8vIGRhdGFUeXBlRXhwcmVzc2lvbiBpcyBvcHRpb25hbCBhbmQgZGVmYXVsdHMgdG8gIioiCgkJcmV0dXJuIGZ1bmN0aW9uKCBkYXRhVHlwZUV4cHJlc3Npb24sIGZ1bmMgKSB7CgoJCQlpZiAoIHR5cGVvZiBkYXRhVHlwZUV4cHJlc3Npb24gIT09ICJzdHJpbmciICkgewoJCQkJZnVuYyA9IGRhdGFUeXBlRXhwcmVzc2lvbjsKCQkJCWRhdGFUeXBlRXhwcmVzc2lvbiA9ICIqIjsKCQkJfQoKCQkJdmFyIGRhdGFUeXBlLAoJCQkJaSA9IDAsCgkJCQlkYXRhVHlwZXMgPSBkYXRhVHlwZUV4cHJlc3Npb24udG9Mb3dlckNhc2UoKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgW107CgoJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBmdW5jICkgKSB7CgkJCQkvLyBGb3IgZWFjaCBkYXRhVHlwZSBpbiB0aGUgZGF0YVR5cGVFeHByZXNzaW9uCgkJCQl3aGlsZSAoIChkYXRhVHlwZSA9IGRhdGFUeXBlc1tpKytdKSApIHsKCQkJCQkvLyBQcmVwZW5kIGlmIHJlcXVlc3RlZAoJCQkJCWlmICggZGF0YVR5cGUuY2hhckF0KCAwICkgPT09ICIrIiApIHsKCQkJCQkJZGF0YVR5cGUgPSBkYXRhVHlwZS5zbGljZSggMSApIHx8ICIqIjsKCQkJCQkJKHN0cnVjdHVyZVsgZGF0YVR5cGUgXSA9IHN0cnVjdHVyZVsgZGF0YVR5cGUgXSB8fCBbXSkudW5zaGlmdCggZnVuYyApOwoKCQkJCQkvLyBPdGhlcndpc2UgYXBwZW5kCgkJCQkJfSBlbHNlIHsKCQkJCQkJKHN0cnVjdHVyZVsgZGF0YVR5cGUgXSA9IHN0cnVjdHVyZVsgZGF0YVR5cGUgXSB8fCBbXSkucHVzaCggZnVuYyApOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX07Cgl9CgoJLy8gQmFzZSBpbnNwZWN0aW9uIGZ1bmN0aW9uIGZvciBwcmVmaWx0ZXJzIGFuZCB0cmFuc3BvcnRzCglmdW5jdGlvbiBpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyggc3RydWN0dXJlLCBvcHRpb25zLCBvcmlnaW5hbE9wdGlvbnMsIGpxWEhSICkgewoKCQl2YXIgaW5zcGVjdGVkID0ge30sCgkJCXNlZWtpbmdUcmFuc3BvcnQgPSAoIHN0cnVjdHVyZSA9PT0gdHJhbnNwb3J0cyApOwoKCQlmdW5jdGlvbiBpbnNwZWN0KCBkYXRhVHlwZSApIHsKCQkJdmFyIHNlbGVjdGVkOwoJCQlpbnNwZWN0ZWRbIGRhdGFUeXBlIF0gPSB0cnVlOwoJCQlqUXVlcnkuZWFjaCggc3RydWN0dXJlWyBkYXRhVHlwZSBdIHx8IFtdLCBmdW5jdGlvbiggXywgcHJlZmlsdGVyT3JGYWN0b3J5ICkgewoJCQkJdmFyIGRhdGFUeXBlT3JUcmFuc3BvcnQgPSBwcmVmaWx0ZXJPckZhY3RvcnkoIG9wdGlvbnMsIG9yaWdpbmFsT3B0aW9ucywganFYSFIgKTsKCQkJCWlmICggdHlwZW9mIGRhdGFUeXBlT3JUcmFuc3BvcnQgPT09ICJzdHJpbmciICYmICFzZWVraW5nVHJhbnNwb3J0ICYmICFpbnNwZWN0ZWRbIGRhdGFUeXBlT3JUcmFuc3BvcnQgXSApIHsKCQkJCQlvcHRpb25zLmRhdGFUeXBlcy51bnNoaWZ0KCBkYXRhVHlwZU9yVHJhbnNwb3J0ICk7CgkJCQkJaW5zcGVjdCggZGF0YVR5cGVPclRyYW5zcG9ydCApOwoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0gZWxzZSBpZiAoIHNlZWtpbmdUcmFuc3BvcnQgKSB7CgkJCQkJcmV0dXJuICEoIHNlbGVjdGVkID0gZGF0YVR5cGVPclRyYW5zcG9ydCApOwoJCQkJfQoJCQl9KTsKCQkJcmV0dXJuIHNlbGVjdGVkOwoJCX0KCgkJcmV0dXJuIGluc3BlY3QoIG9wdGlvbnMuZGF0YVR5cGVzWyAwIF0gKSB8fCAhaW5zcGVjdGVkWyAiKiIgXSAmJiBpbnNwZWN0KCAiKiIgKTsKCX0KCgkvLyBBIHNwZWNpYWwgZXh0ZW5kIGZvciBhamF4IG9wdGlvbnMKCS8vIHRoYXQgdGFrZXMgImZsYXQiIG9wdGlvbnMgKG5vdCB0byBiZSBkZWVwIGV4dGVuZGVkKQoJLy8gRml4ZXMgIzk4ODcKCWZ1bmN0aW9uIGFqYXhFeHRlbmQoIHRhcmdldCwgc3JjICkgewoJCXZhciBkZWVwLCBrZXksCgkJCWZsYXRPcHRpb25zID0galF1ZXJ5LmFqYXhTZXR0aW5ncy5mbGF0T3B0aW9ucyB8fCB7fTsKCgkJZm9yICgga2V5IGluIHNyYyApIHsKCQkJaWYgKCBzcmNbIGtleSBdICE9PSB1bmRlZmluZWQgKSB7CgkJCQkoIGZsYXRPcHRpb25zWyBrZXkgXSA/IHRhcmdldCA6ICggZGVlcCB8fCAoZGVlcCA9IHt9KSApIClbIGtleSBdID0gc3JjWyBrZXkgXTsKCQkJfQoJCX0KCQlpZiAoIGRlZXAgKSB7CgkJCWpRdWVyeS5leHRlbmQoIHRydWUsIHRhcmdldCwgZGVlcCApOwoJCX0KCgkJcmV0dXJuIHRhcmdldDsKCX0KCgkvKiBIYW5kbGVzIHJlc3BvbnNlcyB0byBhbiBhamF4IHJlcXVlc3Q6CgkgKiAtIGZpbmRzIHRoZSByaWdodCBkYXRhVHlwZSAobWVkaWF0ZXMgYmV0d2VlbiBjb250ZW50LXR5cGUgYW5kIGV4cGVjdGVkIGRhdGFUeXBlKQoJICogLSByZXR1cm5zIHRoZSBjb3JyZXNwb25kaW5nIHJlc3BvbnNlCgkgKi8KCWZ1bmN0aW9uIGFqYXhIYW5kbGVSZXNwb25zZXMoIHMsIGpxWEhSLCByZXNwb25zZXMgKSB7CgkJdmFyIGZpcnN0RGF0YVR5cGUsIGN0LCBmaW5hbERhdGFUeXBlLCB0eXBlLAoJCQljb250ZW50cyA9IHMuY29udGVudHMsCgkJCWRhdGFUeXBlcyA9IHMuZGF0YVR5cGVzOwoKCQkvLyBSZW1vdmUgYXV0byBkYXRhVHlwZSBhbmQgZ2V0IGNvbnRlbnQtdHlwZSBpbiB0aGUgcHJvY2VzcwoJCXdoaWxlICggZGF0YVR5cGVzWyAwIF0gPT09ICIqIiApIHsKCQkJZGF0YVR5cGVzLnNoaWZ0KCk7CgkJCWlmICggY3QgPT09IHVuZGVmaW5lZCApIHsKCQkJCWN0ID0gcy5taW1lVHlwZSB8fCBqcVhIUi5nZXRSZXNwb25zZUhlYWRlcigiQ29udGVudC1UeXBlIik7CgkJCX0KCQl9CgoJCS8vIENoZWNrIGlmIHdlJ3JlIGRlYWxpbmcgd2l0aCBhIGtub3duIGNvbnRlbnQtdHlwZQoJCWlmICggY3QgKSB7CgkJCWZvciAoIHR5cGUgaW4gY29udGVudHMgKSB7CgkJCQlpZiAoIGNvbnRlbnRzWyB0eXBlIF0gJiYgY29udGVudHNbIHR5cGUgXS50ZXN0KCBjdCApICkgewoJCQkJCWRhdGFUeXBlcy51bnNoaWZ0KCB0eXBlICk7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCX0KCQl9CgoJCS8vIENoZWNrIHRvIHNlZSBpZiB3ZSBoYXZlIGEgcmVzcG9uc2UgZm9yIHRoZSBleHBlY3RlZCBkYXRhVHlwZQoJCWlmICggZGF0YVR5cGVzWyAwIF0gaW4gcmVzcG9uc2VzICkgewoJCQlmaW5hbERhdGFUeXBlID0gZGF0YVR5cGVzWyAwIF07CgkJfSBlbHNlIHsKCQkJLy8gVHJ5IGNvbnZlcnRpYmxlIGRhdGFUeXBlcwoJCQlmb3IgKCB0eXBlIGluIHJlc3BvbnNlcyApIHsKCQkJCWlmICggIWRhdGFUeXBlc1sgMCBdIHx8IHMuY29udmVydGVyc1sgdHlwZSArICIgIiArIGRhdGFUeXBlc1swXSBdICkgewoJCQkJCWZpbmFsRGF0YVR5cGUgPSB0eXBlOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJaWYgKCAhZmlyc3REYXRhVHlwZSApIHsKCQkJCQlmaXJzdERhdGFUeXBlID0gdHlwZTsKCQkJCX0KCQkJfQoJCQkvLyBPciBqdXN0IHVzZSBmaXJzdCBvbmUKCQkJZmluYWxEYXRhVHlwZSA9IGZpbmFsRGF0YVR5cGUgfHwgZmlyc3REYXRhVHlwZTsKCQl9CgoJCS8vIElmIHdlIGZvdW5kIGEgZGF0YVR5cGUKCQkvLyBXZSBhZGQgdGhlIGRhdGFUeXBlIHRvIHRoZSBsaXN0IGlmIG5lZWRlZAoJCS8vIGFuZCByZXR1cm4gdGhlIGNvcnJlc3BvbmRpbmcgcmVzcG9uc2UKCQlpZiAoIGZpbmFsRGF0YVR5cGUgKSB7CgkJCWlmICggZmluYWxEYXRhVHlwZSAhPT0gZGF0YVR5cGVzWyAwIF0gKSB7CgkJCQlkYXRhVHlwZXMudW5zaGlmdCggZmluYWxEYXRhVHlwZSApOwoJCQl9CgkJCXJldHVybiByZXNwb25zZXNbIGZpbmFsRGF0YVR5cGUgXTsKCQl9Cgl9CgoJLyogQ2hhaW4gY29udmVyc2lvbnMgZ2l2ZW4gdGhlIHJlcXVlc3QgYW5kIHRoZSBvcmlnaW5hbCByZXNwb25zZQoJICogQWxzbyBzZXRzIHRoZSByZXNwb25zZVhYWCBmaWVsZHMgb24gdGhlIGpxWEhSIGluc3RhbmNlCgkgKi8KCWZ1bmN0aW9uIGFqYXhDb252ZXJ0KCBzLCByZXNwb25zZSwganFYSFIsIGlzU3VjY2VzcyApIHsKCQl2YXIgY29udjIsIGN1cnJlbnQsIGNvbnYsIHRtcCwgcHJldiwKCQkJY29udmVydGVycyA9IHt9LAoJCQkvLyBXb3JrIHdpdGggYSBjb3B5IG9mIGRhdGFUeXBlcyBpbiBjYXNlIHdlIG5lZWQgdG8gbW9kaWZ5IGl0IGZvciBjb252ZXJzaW9uCgkJCWRhdGFUeXBlcyA9IHMuZGF0YVR5cGVzLnNsaWNlKCk7CgoJCS8vIENyZWF0ZSBjb252ZXJ0ZXJzIG1hcCB3aXRoIGxvd2VyY2FzZWQga2V5cwoJCWlmICggZGF0YVR5cGVzWyAxIF0gKSB7CgkJCWZvciAoIGNvbnYgaW4gcy5jb252ZXJ0ZXJzICkgewoJCQkJY29udmVydGVyc1sgY29udi50b0xvd2VyQ2FzZSgpIF0gPSBzLmNvbnZlcnRlcnNbIGNvbnYgXTsKCQkJfQoJCX0KCgkJY3VycmVudCA9IGRhdGFUeXBlcy5zaGlmdCgpOwoKCQkvLyBDb252ZXJ0IHRvIGVhY2ggc2VxdWVudGlhbCBkYXRhVHlwZQoJCXdoaWxlICggY3VycmVudCApIHsKCgkJCWlmICggcy5yZXNwb25zZUZpZWxkc1sgY3VycmVudCBdICkgewoJCQkJanFYSFJbIHMucmVzcG9uc2VGaWVsZHNbIGN1cnJlbnQgXSBdID0gcmVzcG9uc2U7CgkJCX0KCgkJCS8vIEFwcGx5IHRoZSBkYXRhRmlsdGVyIGlmIHByb3ZpZGVkCgkJCWlmICggIXByZXYgJiYgaXNTdWNjZXNzICYmIHMuZGF0YUZpbHRlciApIHsKCQkJCXJlc3BvbnNlID0gcy5kYXRhRmlsdGVyKCByZXNwb25zZSwgcy5kYXRhVHlwZSApOwoJCQl9CgoJCQlwcmV2ID0gY3VycmVudDsKCQkJY3VycmVudCA9IGRhdGFUeXBlcy5zaGlmdCgpOwoKCQkJaWYgKCBjdXJyZW50ICkgewoKCQkJCS8vIFRoZXJlJ3Mgb25seSB3b3JrIHRvIGRvIGlmIGN1cnJlbnQgZGF0YVR5cGUgaXMgbm9uLWF1dG8KCQkJCWlmICggY3VycmVudCA9PT0gIioiICkgewoKCQkJCQljdXJyZW50ID0gcHJldjsKCgkJCQkvLyBDb252ZXJ0IHJlc3BvbnNlIGlmIHByZXYgZGF0YVR5cGUgaXMgbm9uLWF1dG8gYW5kIGRpZmZlcnMgZnJvbSBjdXJyZW50CgkJCQl9IGVsc2UgaWYgKCBwcmV2ICE9PSAiKiIgJiYgcHJldiAhPT0gY3VycmVudCApIHsKCgkJCQkJLy8gU2VlayBhIGRpcmVjdCBjb252ZXJ0ZXIKCQkJCQljb252ID0gY29udmVydGVyc1sgcHJldiArICIgIiArIGN1cnJlbnQgXSB8fCBjb252ZXJ0ZXJzWyAiKiAiICsgY3VycmVudCBdOwoKCQkJCQkvLyBJZiBub25lIGZvdW5kLCBzZWVrIGEgcGFpcgoJCQkJCWlmICggIWNvbnYgKSB7CgkJCQkJCWZvciAoIGNvbnYyIGluIGNvbnZlcnRlcnMgKSB7CgoJCQkJCQkJLy8gSWYgY29udjIgb3V0cHV0cyBjdXJyZW50CgkJCQkJCQl0bXAgPSBjb252Mi5zcGxpdCggIiAiICk7CgkJCQkJCQlpZiAoIHRtcFsgMSBdID09PSBjdXJyZW50ICkgewoKCQkJCQkJCQkvLyBJZiBwcmV2IGNhbiBiZSBjb252ZXJ0ZWQgdG8gYWNjZXB0ZWQgaW5wdXQKCQkJCQkJCQljb252ID0gY29udmVydGVyc1sgcHJldiArICIgIiArIHRtcFsgMCBdIF0gfHwKCQkJCQkJCQkJY29udmVydGVyc1sgIiogIiArIHRtcFsgMCBdIF07CgkJCQkJCQkJaWYgKCBjb252ICkgewoJCQkJCQkJCQkvLyBDb25kZW5zZSBlcXVpdmFsZW5jZSBjb252ZXJ0ZXJzCgkJCQkJCQkJCWlmICggY29udiA9PT0gdHJ1ZSApIHsKCQkJCQkJCQkJCWNvbnYgPSBjb252ZXJ0ZXJzWyBjb252MiBdOwoKCQkJCQkJCQkJLy8gT3RoZXJ3aXNlLCBpbnNlcnQgdGhlIGludGVybWVkaWF0ZSBkYXRhVHlwZQoJCQkJCQkJCQl9IGVsc2UgaWYgKCBjb252ZXJ0ZXJzWyBjb252MiBdICE9PSB0cnVlICkgewoJCQkJCQkJCQkJY3VycmVudCA9IHRtcFsgMCBdOwoJCQkJCQkJCQkJZGF0YVR5cGVzLnVuc2hpZnQoIHRtcFsgMSBdICk7CgkJCQkJCQkJCX0KCQkJCQkJCQkJYnJlYWs7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoKCQkJCQkvLyBBcHBseSBjb252ZXJ0ZXIgKGlmIG5vdCBhbiBlcXVpdmFsZW5jZSkKCQkJCQlpZiAoIGNvbnYgIT09IHRydWUgKSB7CgoJCQkJCQkvLyBVbmxlc3MgZXJyb3JzIGFyZSBhbGxvd2VkIHRvIGJ1YmJsZSwgY2F0Y2ggYW5kIHJldHVybiB0aGVtCgkJCQkJCWlmICggY29udiAmJiBzWyAidGhyb3dzIiBdICkgewoJCQkJCQkJcmVzcG9uc2UgPSBjb252KCByZXNwb25zZSApOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJdHJ5IHsKCQkJCQkJCQlyZXNwb25zZSA9IGNvbnYoIHJlc3BvbnNlICk7CgkJCQkJCQl9IGNhdGNoICggZSApIHsKCQkJCQkJCQlyZXR1cm4geyBzdGF0ZTogInBhcnNlcmVycm9yIiwgZXJyb3I6IGNvbnYgPyBlIDogIk5vIGNvbnZlcnNpb24gZnJvbSAiICsgcHJldiArICIgdG8gIiArIGN1cnJlbnQgfTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIHsgc3RhdGU6ICJzdWNjZXNzIiwgZGF0YTogcmVzcG9uc2UgfTsKCX0KCglqUXVlcnkuZXh0ZW5kKHsKCgkJLy8gQ291bnRlciBmb3IgaG9sZGluZyB0aGUgbnVtYmVyIG9mIGFjdGl2ZSBxdWVyaWVzCgkJYWN0aXZlOiAwLAoKCQkvLyBMYXN0LU1vZGlmaWVkIGhlYWRlciBjYWNoZSBmb3IgbmV4dCByZXF1ZXN0CgkJbGFzdE1vZGlmaWVkOiB7fSwKCQlldGFnOiB7fSwKCgkJYWpheFNldHRpbmdzOiB7CgkJCXVybDogYWpheExvY2F0aW9uLAoJCQl0eXBlOiAiR0VUIiwKCQkJaXNMb2NhbDogcmxvY2FsUHJvdG9jb2wudGVzdCggYWpheExvY1BhcnRzWyAxIF0gKSwKCQkJZ2xvYmFsOiB0cnVlLAoJCQlwcm9jZXNzRGF0YTogdHJ1ZSwKCQkJYXN5bmM6IHRydWUsCgkJCWNvbnRlbnRUeXBlOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IiwKCQkJLyoKCQkJdGltZW91dDogMCwKCQkJZGF0YTogbnVsbCwKCQkJZGF0YVR5cGU6IG51bGwsCgkJCXVzZXJuYW1lOiBudWxsLAoJCQlwYXNzd29yZDogbnVsbCwKCQkJY2FjaGU6IG51bGwsCgkJCXRocm93czogZmFsc2UsCgkJCXRyYWRpdGlvbmFsOiBmYWxzZSwKCQkJaGVhZGVyczoge30sCgkJCSovCgoJCQlhY2NlcHRzOiB7CgkJCQkiKiI6IGFsbFR5cGVzLAoJCQkJdGV4dDogInRleHQvcGxhaW4iLAoJCQkJaHRtbDogInRleHQvaHRtbCIsCgkJCQl4bWw6ICJhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sIiwKCQkJCWpzb246ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQiCgkJCX0sCgoJCQljb250ZW50czogewoJCQkJeG1sOiAveG1sLywKCQkJCWh0bWw6IC9odG1sLywKCQkJCWpzb246IC9qc29uLwoJCQl9LAoKCQkJcmVzcG9uc2VGaWVsZHM6IHsKCQkJCXhtbDogInJlc3BvbnNlWE1MIiwKCQkJCXRleHQ6ICJyZXNwb25zZVRleHQiLAoJCQkJanNvbjogInJlc3BvbnNlSlNPTiIKCQkJfSwKCgkJCS8vIERhdGEgY29udmVydGVycwoJCQkvLyBLZXlzIHNlcGFyYXRlIHNvdXJjZSAob3IgY2F0Y2hhbGwgIioiKSBhbmQgZGVzdGluYXRpb24gdHlwZXMgd2l0aCBhIHNpbmdsZSBzcGFjZQoJCQljb252ZXJ0ZXJzOiB7CgoJCQkJLy8gQ29udmVydCBhbnl0aGluZyB0byB0ZXh0CgkJCQkiKiB0ZXh0IjogU3RyaW5nLAoKCQkJCS8vIFRleHQgdG8gaHRtbCAodHJ1ZSA9IG5vIHRyYW5zZm9ybWF0aW9uKQoJCQkJInRleHQgaHRtbCI6IHRydWUsCgoJCQkJLy8gRXZhbHVhdGUgdGV4dCBhcyBhIGpzb24gZXhwcmVzc2lvbgoJCQkJInRleHQganNvbiI6IGpRdWVyeS5wYXJzZUpTT04sCgoJCQkJLy8gUGFyc2UgdGV4dCBhcyB4bWwKCQkJCSJ0ZXh0IHhtbCI6IGpRdWVyeS5wYXJzZVhNTAoJCQl9LAoKCQkJLy8gRm9yIG9wdGlvbnMgdGhhdCBzaG91bGRuJ3QgYmUgZGVlcCBleHRlbmRlZDoKCQkJLy8geW91IGNhbiBhZGQgeW91ciBvd24gY3VzdG9tIG9wdGlvbnMgaGVyZSBpZgoJCQkvLyBhbmQgd2hlbiB5b3UgY3JlYXRlIG9uZSB0aGF0IHNob3VsZG4ndCBiZQoJCQkvLyBkZWVwIGV4dGVuZGVkIChzZWUgYWpheEV4dGVuZCkKCQkJZmxhdE9wdGlvbnM6IHsKCQkJCXVybDogdHJ1ZSwKCQkJCWNvbnRleHQ6IHRydWUKCQkJfQoJCX0sCgoJCS8vIENyZWF0ZXMgYSBmdWxsIGZsZWRnZWQgc2V0dGluZ3Mgb2JqZWN0IGludG8gdGFyZ2V0CgkJLy8gd2l0aCBib3RoIGFqYXhTZXR0aW5ncyBhbmQgc2V0dGluZ3MgZmllbGRzLgoJCS8vIElmIHRhcmdldCBpcyBvbWl0dGVkLCB3cml0ZXMgaW50byBhamF4U2V0dGluZ3MuCgkJYWpheFNldHVwOiBmdW5jdGlvbiggdGFyZ2V0LCBzZXR0aW5ncyApIHsKCQkJcmV0dXJuIHNldHRpbmdzID8KCgkJCQkvLyBCdWlsZGluZyBhIHNldHRpbmdzIG9iamVjdAoJCQkJYWpheEV4dGVuZCggYWpheEV4dGVuZCggdGFyZ2V0LCBqUXVlcnkuYWpheFNldHRpbmdzICksIHNldHRpbmdzICkgOgoKCQkJCS8vIEV4dGVuZGluZyBhamF4U2V0dGluZ3MKCQkJCWFqYXhFeHRlbmQoIGpRdWVyeS5hamF4U2V0dGluZ3MsIHRhcmdldCApOwoJCX0sCgoJCWFqYXhQcmVmaWx0ZXI6IGFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyggcHJlZmlsdGVycyApLAoJCWFqYXhUcmFuc3BvcnQ6IGFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyggdHJhbnNwb3J0cyApLAoKCQkvLyBNYWluIG1ldGhvZAoJCWFqYXg6IGZ1bmN0aW9uKCB1cmwsIG9wdGlvbnMgKSB7CgoJCQkvLyBJZiB1cmwgaXMgYW4gb2JqZWN0LCBzaW11bGF0ZSBwcmUtMS41IHNpZ25hdHVyZQoJCQlpZiAoIHR5cGVvZiB1cmwgPT09ICJvYmplY3QiICkgewoJCQkJb3B0aW9ucyA9IHVybDsKCQkJCXVybCA9IHVuZGVmaW5lZDsKCQkJfQoKCQkJLy8gRm9yY2Ugb3B0aW9ucyB0byBiZSBhbiBvYmplY3QKCQkJb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CgoJCQl2YXIgLy8gQ3Jvc3MtZG9tYWluIGRldGVjdGlvbiB2YXJzCgkJCQlwYXJ0cywKCQkJCS8vIExvb3AgdmFyaWFibGUKCQkJCWksCgkJCQkvLyBVUkwgd2l0aG91dCBhbnRpLWNhY2hlIHBhcmFtCgkJCQljYWNoZVVSTCwKCQkJCS8vIFJlc3BvbnNlIGhlYWRlcnMgYXMgc3RyaW5nCgkJCQlyZXNwb25zZUhlYWRlcnNTdHJpbmcsCgkJCQkvLyB0aW1lb3V0IGhhbmRsZQoJCQkJdGltZW91dFRpbWVyLAoKCQkJCS8vIFRvIGtub3cgaWYgZ2xvYmFsIGV2ZW50cyBhcmUgdG8gYmUgZGlzcGF0Y2hlZAoJCQkJZmlyZUdsb2JhbHMsCgoJCQkJdHJhbnNwb3J0LAoJCQkJLy8gUmVzcG9uc2UgaGVhZGVycwoJCQkJcmVzcG9uc2VIZWFkZXJzLAoJCQkJLy8gQ3JlYXRlIHRoZSBmaW5hbCBvcHRpb25zIG9iamVjdAoJCQkJcyA9IGpRdWVyeS5hamF4U2V0dXAoIHt9LCBvcHRpb25zICksCgkJCQkvLyBDYWxsYmFja3MgY29udGV4dAoJCQkJY2FsbGJhY2tDb250ZXh0ID0gcy5jb250ZXh0IHx8IHMsCgkJCQkvLyBDb250ZXh0IGZvciBnbG9iYWwgZXZlbnRzIGlzIGNhbGxiYWNrQ29udGV4dCBpZiBpdCBpcyBhIERPTSBub2RlIG9yIGpRdWVyeSBjb2xsZWN0aW9uCgkJCQlnbG9iYWxFdmVudENvbnRleHQgPSBzLmNvbnRleHQgJiYgKCBjYWxsYmFja0NvbnRleHQubm9kZVR5cGUgfHwgY2FsbGJhY2tDb250ZXh0LmpxdWVyeSApID8KCQkJCQlqUXVlcnkoIGNhbGxiYWNrQ29udGV4dCApIDoKCQkJCQlqUXVlcnkuZXZlbnQsCgkJCQkvLyBEZWZlcnJlZHMKCQkJCWRlZmVycmVkID0galF1ZXJ5LkRlZmVycmVkKCksCgkJCQljb21wbGV0ZURlZmVycmVkID0galF1ZXJ5LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwKCQkJCS8vIFN0YXR1cy1kZXBlbmRlbnQgY2FsbGJhY2tzCgkJCQlzdGF0dXNDb2RlID0gcy5zdGF0dXNDb2RlIHx8IHt9LAoJCQkJLy8gSGVhZGVycyAodGhleSBhcmUgc2VudCBhbGwgYXQgb25jZSkKCQkJCXJlcXVlc3RIZWFkZXJzID0ge30sCgkJCQlyZXF1ZXN0SGVhZGVyc05hbWVzID0ge30sCgkJCQkvLyBUaGUganFYSFIgc3RhdGUKCQkJCXN0YXRlID0gMCwKCQkJCS8vIERlZmF1bHQgYWJvcnQgbWVzc2FnZQoJCQkJc3RyQWJvcnQgPSAiY2FuY2VsZWQiLAoJCQkJLy8gRmFrZSB4aHIKCQkJCWpxWEhSID0gewoJCQkJCXJlYWR5U3RhdGU6IDAsCgoJCQkJCS8vIEJ1aWxkcyBoZWFkZXJzIGhhc2h0YWJsZSBpZiBuZWVkZWQKCQkJCQlnZXRSZXNwb25zZUhlYWRlcjogZnVuY3Rpb24oIGtleSApIHsKCQkJCQkJdmFyIG1hdGNoOwoJCQkJCQlpZiAoIHN0YXRlID09PSAyICkgewoJCQkJCQkJaWYgKCAhcmVzcG9uc2VIZWFkZXJzICkgewoJCQkJCQkJCXJlc3BvbnNlSGVhZGVycyA9IHt9OwoJCQkJCQkJCXdoaWxlICggKG1hdGNoID0gcmhlYWRlcnMuZXhlYyggcmVzcG9uc2VIZWFkZXJzU3RyaW5nICkpICkgewoJCQkJCQkJCQlyZXNwb25zZUhlYWRlcnNbIG1hdGNoWzFdLnRvTG93ZXJDYXNlKCkgXSA9IG1hdGNoWyAyIF07CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQkJbWF0Y2ggPSByZXNwb25zZUhlYWRlcnNbIGtleS50b0xvd2VyQ2FzZSgpIF07CgkJCQkJCX0KCQkJCQkJcmV0dXJuIG1hdGNoID09IG51bGwgPyBudWxsIDogbWF0Y2g7CgkJCQkJfSwKCgkJCQkJLy8gUmF3IHN0cmluZwoJCQkJCWdldEFsbFJlc3BvbnNlSGVhZGVyczogZnVuY3Rpb24oKSB7CgkJCQkJCXJldHVybiBzdGF0ZSA9PT0gMiA/IHJlc3BvbnNlSGVhZGVyc1N0cmluZyA6IG51bGw7CgkJCQkJfSwKCgkJCQkJLy8gQ2FjaGVzIHRoZSBoZWFkZXIKCQkJCQlzZXRSZXF1ZXN0SGVhZGVyOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7CgkJCQkJCXZhciBsbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKCQkJCQkJaWYgKCAhc3RhdGUgKSB7CgkJCQkJCQluYW1lID0gcmVxdWVzdEhlYWRlcnNOYW1lc1sgbG5hbWUgXSA9IHJlcXVlc3RIZWFkZXJzTmFtZXNbIGxuYW1lIF0gfHwgbmFtZTsKCQkJCQkJCXJlcXVlc3RIZWFkZXJzWyBuYW1lIF0gPSB2YWx1ZTsKCQkJCQkJfQoJCQkJCQlyZXR1cm4gdGhpczsKCQkJCQl9LAoKCQkJCQkvLyBPdmVycmlkZXMgcmVzcG9uc2UgY29udGVudC10eXBlIGhlYWRlcgoJCQkJCW92ZXJyaWRlTWltZVR5cGU6IGZ1bmN0aW9uKCB0eXBlICkgewoJCQkJCQlpZiAoICFzdGF0ZSApIHsKCQkJCQkJCXMubWltZVR5cGUgPSB0eXBlOwoJCQkJCQl9CgkJCQkJCXJldHVybiB0aGlzOwoJCQkJCX0sCgoJCQkJCS8vIFN0YXR1cy1kZXBlbmRlbnQgY2FsbGJhY2tzCgkJCQkJc3RhdHVzQ29kZTogZnVuY3Rpb24oIG1hcCApIHsKCQkJCQkJdmFyIGNvZGU7CgkJCQkJCWlmICggbWFwICkgewoJCQkJCQkJaWYgKCBzdGF0ZSA8IDIgKSB7CgkJCQkJCQkJZm9yICggY29kZSBpbiBtYXAgKSB7CgkJCQkJCQkJCS8vIExhenktYWRkIHRoZSBuZXcgY2FsbGJhY2sgaW4gYSB3YXkgdGhhdCBwcmVzZXJ2ZXMgb2xkIG9uZXMKCQkJCQkJCQkJc3RhdHVzQ29kZVsgY29kZSBdID0gWyBzdGF0dXNDb2RlWyBjb2RlIF0sIG1hcFsgY29kZSBdIF07CgkJCQkJCQkJfQoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkvLyBFeGVjdXRlIHRoZSBhcHByb3ByaWF0ZSBjYWxsYmFja3MKCQkJCQkJCQlqcVhIUi5hbHdheXMoIG1hcFsganFYSFIuc3RhdHVzIF0gKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQlyZXR1cm4gdGhpczsKCQkJCQl9LAoKCQkJCQkvLyBDYW5jZWwgdGhlIHJlcXVlc3QKCQkJCQlhYm9ydDogZnVuY3Rpb24oIHN0YXR1c1RleHQgKSB7CgkJCQkJCXZhciBmaW5hbFRleHQgPSBzdGF0dXNUZXh0IHx8IHN0ckFib3J0OwoJCQkJCQlpZiAoIHRyYW5zcG9ydCApIHsKCQkJCQkJCXRyYW5zcG9ydC5hYm9ydCggZmluYWxUZXh0ICk7CgkJCQkJCX0KCQkJCQkJZG9uZSggMCwgZmluYWxUZXh0ICk7CgkJCQkJCXJldHVybiB0aGlzOwoJCQkJCX0KCQkJCX07CgoJCQkvLyBBdHRhY2ggZGVmZXJyZWRzCgkJCWRlZmVycmVkLnByb21pc2UoIGpxWEhSICkuY29tcGxldGUgPSBjb21wbGV0ZURlZmVycmVkLmFkZDsKCQkJanFYSFIuc3VjY2VzcyA9IGpxWEhSLmRvbmU7CgkJCWpxWEhSLmVycm9yID0ganFYSFIuZmFpbDsKCgkJCS8vIFJlbW92ZSBoYXNoIGNoYXJhY3RlciAoIzc1MzE6IGFuZCBzdHJpbmcgcHJvbW90aW9uKQoJCQkvLyBBZGQgcHJvdG9jb2wgaWYgbm90IHByb3ZpZGVkICgjNTg2NjogSUU3IGlzc3VlIHdpdGggcHJvdG9jb2wtbGVzcyB1cmxzKQoJCQkvLyBIYW5kbGUgZmFsc3kgdXJsIGluIHRoZSBzZXR0aW5ncyBvYmplY3QgKCMxMDA5MzogY29uc2lzdGVuY3kgd2l0aCBvbGQgc2lnbmF0dXJlKQoJCQkvLyBXZSBhbHNvIHVzZSB0aGUgdXJsIHBhcmFtZXRlciBpZiBhdmFpbGFibGUKCQkJcy51cmwgPSAoICggdXJsIHx8IHMudXJsIHx8IGFqYXhMb2NhdGlvbiApICsgIiIgKS5yZXBsYWNlKCByaGFzaCwgIiIgKS5yZXBsYWNlKCBycHJvdG9jb2wsIGFqYXhMb2NQYXJ0c1sgMSBdICsgIi8vIiApOwoKCQkJLy8gQWxpYXMgbWV0aG9kIG9wdGlvbiB0byB0eXBlIGFzIHBlciB0aWNrZXQgIzEyMDA0CgkJCXMudHlwZSA9IG9wdGlvbnMubWV0aG9kIHx8IG9wdGlvbnMudHlwZSB8fCBzLm1ldGhvZCB8fCBzLnR5cGU7CgoJCQkvLyBFeHRyYWN0IGRhdGFUeXBlcyBsaXN0CgkJCXMuZGF0YVR5cGVzID0galF1ZXJ5LnRyaW0oIHMuZGF0YVR5cGUgfHwgIioiICkudG9Mb3dlckNhc2UoKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgWyAiIiBdOwoKCQkJLy8gQSBjcm9zcy1kb21haW4gcmVxdWVzdCBpcyBpbiBvcmRlciB3aGVuIHdlIGhhdmUgYSBwcm90b2NvbDpob3N0OnBvcnQgbWlzbWF0Y2gKCQkJaWYgKCBzLmNyb3NzRG9tYWluID09IG51bGwgKSB7CgkJCQlwYXJ0cyA9IHJ1cmwuZXhlYyggcy51cmwudG9Mb3dlckNhc2UoKSApOwoJCQkJcy5jcm9zc0RvbWFpbiA9ICEhKCBwYXJ0cyAmJgoJCQkJCSggcGFydHNbIDEgXSAhPT0gYWpheExvY1BhcnRzWyAxIF0gfHwgcGFydHNbIDIgXSAhPT0gYWpheExvY1BhcnRzWyAyIF0gfHwKCQkJCQkJKCBwYXJ0c1sgMyBdIHx8ICggcGFydHNbIDEgXSA9PT0gImh0dHA6IiA/ICI4MCIgOiAiNDQzIiApICkgIT09CgkJCQkJCQkoIGFqYXhMb2NQYXJ0c1sgMyBdIHx8ICggYWpheExvY1BhcnRzWyAxIF0gPT09ICJodHRwOiIgPyAiODAiIDogIjQ0MyIgKSApICkKCQkJCSk7CgkJCX0KCgkJCS8vIENvbnZlcnQgZGF0YSBpZiBub3QgYWxyZWFkeSBhIHN0cmluZwoJCQlpZiAoIHMuZGF0YSAmJiBzLnByb2Nlc3NEYXRhICYmIHR5cGVvZiBzLmRhdGEgIT09ICJzdHJpbmciICkgewoJCQkJcy5kYXRhID0galF1ZXJ5LnBhcmFtKCBzLmRhdGEsIHMudHJhZGl0aW9uYWwgKTsKCQkJfQoKCQkJLy8gQXBwbHkgcHJlZmlsdGVycwoJCQlpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyggcHJlZmlsdGVycywgcywgb3B0aW9ucywganFYSFIgKTsKCgkJCS8vIElmIHJlcXVlc3Qgd2FzIGFib3J0ZWQgaW5zaWRlIGEgcHJlZmlsdGVyLCBzdG9wIHRoZXJlCgkJCWlmICggc3RhdGUgPT09IDIgKSB7CgkJCQlyZXR1cm4ganFYSFI7CgkJCX0KCgkJCS8vIFdlIGNhbiBmaXJlIGdsb2JhbCBldmVudHMgYXMgb2Ygbm93IGlmIGFza2VkIHRvCgkJCS8vIERvbid0IGZpcmUgZXZlbnRzIGlmIGpRdWVyeS5ldmVudCBpcyB1bmRlZmluZWQgaW4gYW4gQU1ELXVzYWdlIHNjZW5hcmlvICgjMTUxMTgpCgkJCWZpcmVHbG9iYWxzID0galF1ZXJ5LmV2ZW50ICYmIHMuZ2xvYmFsOwoKCQkJLy8gV2F0Y2ggZm9yIGEgbmV3IHNldCBvZiByZXF1ZXN0cwoJCQlpZiAoIGZpcmVHbG9iYWxzICYmIGpRdWVyeS5hY3RpdmUrKyA9PT0gMCApIHsKCQkJCWpRdWVyeS5ldmVudC50cmlnZ2VyKCJhamF4U3RhcnQiKTsKCQkJfQoKCQkJLy8gVXBwZXJjYXNlIHRoZSB0eXBlCgkJCXMudHlwZSA9IHMudHlwZS50b1VwcGVyQ2FzZSgpOwoKCQkJLy8gRGV0ZXJtaW5lIGlmIHJlcXVlc3QgaGFzIGNvbnRlbnQKCQkJcy5oYXNDb250ZW50ID0gIXJub0NvbnRlbnQudGVzdCggcy50eXBlICk7CgoJCQkvLyBTYXZlIHRoZSBVUkwgaW4gY2FzZSB3ZSdyZSB0b3lpbmcgd2l0aCB0aGUgSWYtTW9kaWZpZWQtU2luY2UKCQkJLy8gYW5kL29yIElmLU5vbmUtTWF0Y2ggaGVhZGVyIGxhdGVyIG9uCgkJCWNhY2hlVVJMID0gcy51cmw7CgoJCQkvLyBNb3JlIG9wdGlvbnMgaGFuZGxpbmcgZm9yIHJlcXVlc3RzIHdpdGggbm8gY29udGVudAoJCQlpZiAoICFzLmhhc0NvbnRlbnQgKSB7CgoJCQkJLy8gSWYgZGF0YSBpcyBhdmFpbGFibGUsIGFwcGVuZCBkYXRhIHRvIHVybAoJCQkJaWYgKCBzLmRhdGEgKSB7CgkJCQkJY2FjaGVVUkwgPSAoIHMudXJsICs9ICggcnF1ZXJ5LnRlc3QoIGNhY2hlVVJMICkgPyAiJiIgOiAiPyIgKSArIHMuZGF0YSApOwoJCQkJCS8vICM5NjgyOiByZW1vdmUgZGF0YSBzbyB0aGF0IGl0J3Mgbm90IHVzZWQgaW4gYW4gZXZlbnR1YWwgcmV0cnkKCQkJCQlkZWxldGUgcy5kYXRhOwoJCQkJfQoKCQkJCS8vIEFkZCBhbnRpLWNhY2hlIGluIHVybCBpZiBuZWVkZWQKCQkJCWlmICggcy5jYWNoZSA9PT0gZmFsc2UgKSB7CgkJCQkJcy51cmwgPSBydHMudGVzdCggY2FjaGVVUkwgKSA/CgoJCQkJCQkvLyBJZiB0aGVyZSBpcyBhbHJlYWR5IGEgJ18nIHBhcmFtZXRlciwgc2V0IGl0cyB2YWx1ZQoJCQkJCQljYWNoZVVSTC5yZXBsYWNlKCBydHMsICIkMV89IiArIG5vbmNlKysgKSA6CgoJCQkJCQkvLyBPdGhlcndpc2UgYWRkIG9uZSB0byB0aGUgZW5kCgkJCQkJCWNhY2hlVVJMICsgKCBycXVlcnkudGVzdCggY2FjaGVVUkwgKSA/ICImIiA6ICI/IiApICsgIl89IiArIG5vbmNlKys7CgkJCQl9CgkJCX0KCgkJCS8vIFNldCB0aGUgSWYtTW9kaWZpZWQtU2luY2UgYW5kL29yIElmLU5vbmUtTWF0Y2ggaGVhZGVyLCBpZiBpbiBpZk1vZGlmaWVkIG1vZGUuCgkJCWlmICggcy5pZk1vZGlmaWVkICkgewoJCQkJaWYgKCBqUXVlcnkubGFzdE1vZGlmaWVkWyBjYWNoZVVSTCBdICkgewoJCQkJCWpxWEhSLnNldFJlcXVlc3RIZWFkZXIoICJJZi1Nb2RpZmllZC1TaW5jZSIsIGpRdWVyeS5sYXN0TW9kaWZpZWRbIGNhY2hlVVJMIF0gKTsKCQkJCX0KCQkJCWlmICggalF1ZXJ5LmV0YWdbIGNhY2hlVVJMIF0gKSB7CgkJCQkJanFYSFIuc2V0UmVxdWVzdEhlYWRlciggIklmLU5vbmUtTWF0Y2giLCBqUXVlcnkuZXRhZ1sgY2FjaGVVUkwgXSApOwoJCQkJfQoJCQl9CgoJCQkvLyBTZXQgdGhlIGNvcnJlY3QgaGVhZGVyLCBpZiBkYXRhIGlzIGJlaW5nIHNlbnQKCQkJaWYgKCBzLmRhdGEgJiYgcy5oYXNDb250ZW50ICYmIHMuY29udGVudFR5cGUgIT09IGZhbHNlIHx8IG9wdGlvbnMuY29udGVudFR5cGUgKSB7CgkJCQlqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCAiQ29udGVudC1UeXBlIiwgcy5jb250ZW50VHlwZSApOwoJCQl9CgoJCQkvLyBTZXQgdGhlIEFjY2VwdHMgaGVhZGVyIGZvciB0aGUgc2VydmVyLCBkZXBlbmRpbmcgb24gdGhlIGRhdGFUeXBlCgkJCWpxWEhSLnNldFJlcXVlc3RIZWFkZXIoCgkJCQkiQWNjZXB0IiwKCQkJCXMuZGF0YVR5cGVzWyAwIF0gJiYgcy5hY2NlcHRzWyBzLmRhdGFUeXBlc1swXSBdID8KCQkJCQlzLmFjY2VwdHNbIHMuZGF0YVR5cGVzWzBdIF0gKyAoIHMuZGF0YVR5cGVzWyAwIF0gIT09ICIqIiA/ICIsICIgKyBhbGxUeXBlcyArICI7IHE9MC4wMSIgOiAiIiApIDoKCQkJCQlzLmFjY2VwdHNbICIqIiBdCgkJCSk7CgoJCQkvLyBDaGVjayBmb3IgaGVhZGVycyBvcHRpb24KCQkJZm9yICggaSBpbiBzLmhlYWRlcnMgKSB7CgkJCQlqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCBpLCBzLmhlYWRlcnNbIGkgXSApOwoJCQl9CgoJCQkvLyBBbGxvdyBjdXN0b20gaGVhZGVycy9taW1ldHlwZXMgYW5kIGVhcmx5IGFib3J0CgkJCWlmICggcy5iZWZvcmVTZW5kICYmICggcy5iZWZvcmVTZW5kLmNhbGwoIGNhbGxiYWNrQ29udGV4dCwganFYSFIsIHMgKSA9PT0gZmFsc2UgfHwgc3RhdGUgPT09IDIgKSApIHsKCQkJCS8vIEFib3J0IGlmIG5vdCBkb25lIGFscmVhZHkgYW5kIHJldHVybgoJCQkJcmV0dXJuIGpxWEhSLmFib3J0KCk7CgkJCX0KCgkJCS8vIGFib3J0aW5nIGlzIG5vIGxvbmdlciBhIGNhbmNlbGxhdGlvbgoJCQlzdHJBYm9ydCA9ICJhYm9ydCI7CgoJCQkvLyBJbnN0YWxsIGNhbGxiYWNrcyBvbiBkZWZlcnJlZHMKCQkJZm9yICggaSBpbiB7IHN1Y2Nlc3M6IDEsIGVycm9yOiAxLCBjb21wbGV0ZTogMSB9ICkgewoJCQkJanFYSFJbIGkgXSggc1sgaSBdICk7CgkJCX0KCgkJCS8vIEdldCB0cmFuc3BvcnQKCQkJdHJhbnNwb3J0ID0gaW5zcGVjdFByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHRyYW5zcG9ydHMsIHMsIG9wdGlvbnMsIGpxWEhSICk7CgoJCQkvLyBJZiBubyB0cmFuc3BvcnQsIHdlIGF1dG8tYWJvcnQKCQkJaWYgKCAhdHJhbnNwb3J0ICkgewoJCQkJZG9uZSggLTEsICJObyBUcmFuc3BvcnQiICk7CgkJCX0gZWxzZSB7CgkJCQlqcVhIUi5yZWFkeVN0YXRlID0gMTsKCgkJCQkvLyBTZW5kIGdsb2JhbCBldmVudAoJCQkJaWYgKCBmaXJlR2xvYmFscyApIHsKCQkJCQlnbG9iYWxFdmVudENvbnRleHQudHJpZ2dlciggImFqYXhTZW5kIiwgWyBqcVhIUiwgcyBdICk7CgkJCQl9CgkJCQkvLyBUaW1lb3V0CgkJCQlpZiAoIHMuYXN5bmMgJiYgcy50aW1lb3V0ID4gMCApIHsKCQkJCQl0aW1lb3V0VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewoJCQkJCQlqcVhIUi5hYm9ydCgidGltZW91dCIpOwoJCQkJCX0sIHMudGltZW91dCApOwoJCQkJfQoKCQkJCXRyeSB7CgkJCQkJc3RhdGUgPSAxOwoJCQkJCXRyYW5zcG9ydC5zZW5kKCByZXF1ZXN0SGVhZGVycywgZG9uZSApOwoJCQkJfSBjYXRjaCAoIGUgKSB7CgkJCQkJLy8gUHJvcGFnYXRlIGV4Y2VwdGlvbiBhcyBlcnJvciBpZiBub3QgZG9uZQoJCQkJCWlmICggc3RhdGUgPCAyICkgewoJCQkJCQlkb25lKCAtMSwgZSApOwoJCQkJCS8vIFNpbXBseSByZXRocm93IG90aGVyd2lzZQoJCQkJCX0gZWxzZSB7CgkJCQkJCXRocm93IGU7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBDYWxsYmFjayBmb3Igd2hlbiBldmVyeXRoaW5nIGlzIGRvbmUKCQkJZnVuY3Rpb24gZG9uZSggc3RhdHVzLCBuYXRpdmVTdGF0dXNUZXh0LCByZXNwb25zZXMsIGhlYWRlcnMgKSB7CgkJCQl2YXIgaXNTdWNjZXNzLCBzdWNjZXNzLCBlcnJvciwgcmVzcG9uc2UsIG1vZGlmaWVkLAoJCQkJCXN0YXR1c1RleHQgPSBuYXRpdmVTdGF0dXNUZXh0OwoKCQkJCS8vIENhbGxlZCBvbmNlCgkJCQlpZiAoIHN0YXRlID09PSAyICkgewoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQkvLyBTdGF0ZSBpcyAiZG9uZSIgbm93CgkJCQlzdGF0ZSA9IDI7CgoJCQkJLy8gQ2xlYXIgdGltZW91dCBpZiBpdCBleGlzdHMKCQkJCWlmICggdGltZW91dFRpbWVyICkgewoJCQkJCWNsZWFyVGltZW91dCggdGltZW91dFRpbWVyICk7CgkJCQl9CgoJCQkJLy8gRGVyZWZlcmVuY2UgdHJhbnNwb3J0IGZvciBlYXJseSBnYXJiYWdlIGNvbGxlY3Rpb24KCQkJCS8vIChubyBtYXR0ZXIgaG93IGxvbmcgdGhlIGpxWEhSIG9iamVjdCB3aWxsIGJlIHVzZWQpCgkJCQl0cmFuc3BvcnQgPSB1bmRlZmluZWQ7CgoJCQkJLy8gQ2FjaGUgcmVzcG9uc2UgaGVhZGVycwoJCQkJcmVzcG9uc2VIZWFkZXJzU3RyaW5nID0gaGVhZGVycyB8fCAiIjsKCgkJCQkvLyBTZXQgcmVhZHlTdGF0ZQoJCQkJanFYSFIucmVhZHlTdGF0ZSA9IHN0YXR1cyA+IDAgPyA0IDogMDsKCgkJCQkvLyBEZXRlcm1pbmUgaWYgc3VjY2Vzc2Z1bAoJCQkJaXNTdWNjZXNzID0gc3RhdHVzID49IDIwMCAmJiBzdGF0dXMgPCAzMDAgfHwgc3RhdHVzID09PSAzMDQ7CgoJCQkJLy8gR2V0IHJlc3BvbnNlIGRhdGEKCQkJCWlmICggcmVzcG9uc2VzICkgewoJCQkJCXJlc3BvbnNlID0gYWpheEhhbmRsZVJlc3BvbnNlcyggcywganFYSFIsIHJlc3BvbnNlcyApOwoJCQkJfQoKCQkJCS8vIENvbnZlcnQgbm8gbWF0dGVyIHdoYXQgKHRoYXQgd2F5IHJlc3BvbnNlWFhYIGZpZWxkcyBhcmUgYWx3YXlzIHNldCkKCQkJCXJlc3BvbnNlID0gYWpheENvbnZlcnQoIHMsIHJlc3BvbnNlLCBqcVhIUiwgaXNTdWNjZXNzICk7CgoJCQkJLy8gSWYgc3VjY2Vzc2Z1bCwgaGFuZGxlIHR5cGUgY2hhaW5pbmcKCQkJCWlmICggaXNTdWNjZXNzICkgewoKCQkJCQkvLyBTZXQgdGhlIElmLU1vZGlmaWVkLVNpbmNlIGFuZC9vciBJZi1Ob25lLU1hdGNoIGhlYWRlciwgaWYgaW4gaWZNb2RpZmllZCBtb2RlLgoJCQkJCWlmICggcy5pZk1vZGlmaWVkICkgewoJCQkJCQltb2RpZmllZCA9IGpxWEhSLmdldFJlc3BvbnNlSGVhZGVyKCJMYXN0LU1vZGlmaWVkIik7CgkJCQkJCWlmICggbW9kaWZpZWQgKSB7CgkJCQkJCQlqUXVlcnkubGFzdE1vZGlmaWVkWyBjYWNoZVVSTCBdID0gbW9kaWZpZWQ7CgkJCQkJCX0KCQkJCQkJbW9kaWZpZWQgPSBqcVhIUi5nZXRSZXNwb25zZUhlYWRlcigiZXRhZyIpOwoJCQkJCQlpZiAoIG1vZGlmaWVkICkgewoJCQkJCQkJalF1ZXJ5LmV0YWdbIGNhY2hlVVJMIF0gPSBtb2RpZmllZDsKCQkJCQkJfQoJCQkJCX0KCgkJCQkJLy8gaWYgbm8gY29udGVudAoJCQkJCWlmICggc3RhdHVzID09PSAyMDQgfHwgcy50eXBlID09PSAiSEVBRCIgKSB7CgkJCQkJCXN0YXR1c1RleHQgPSAibm9jb250ZW50IjsKCgkJCQkJLy8gaWYgbm90IG1vZGlmaWVkCgkJCQkJfSBlbHNlIGlmICggc3RhdHVzID09PSAzMDQgKSB7CgkJCQkJCXN0YXR1c1RleHQgPSAibm90bW9kaWZpZWQiOwoKCQkJCQkvLyBJZiB3ZSBoYXZlIGRhdGEsIGxldCdzIGNvbnZlcnQgaXQKCQkJCQl9IGVsc2UgewoJCQkJCQlzdGF0dXNUZXh0ID0gcmVzcG9uc2Uuc3RhdGU7CgkJCQkJCXN1Y2Nlc3MgPSByZXNwb25zZS5kYXRhOwoJCQkJCQllcnJvciA9IHJlc3BvbnNlLmVycm9yOwoJCQkJCQlpc1N1Y2Nlc3MgPSAhZXJyb3I7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQkvLyBXZSBleHRyYWN0IGVycm9yIGZyb20gc3RhdHVzVGV4dAoJCQkJCS8vIHRoZW4gbm9ybWFsaXplIHN0YXR1c1RleHQgYW5kIHN0YXR1cyBmb3Igbm9uLWFib3J0cwoJCQkJCWVycm9yID0gc3RhdHVzVGV4dDsKCQkJCQlpZiAoIHN0YXR1cyB8fCAhc3RhdHVzVGV4dCApIHsKCQkJCQkJc3RhdHVzVGV4dCA9ICJlcnJvciI7CgkJCQkJCWlmICggc3RhdHVzIDwgMCApIHsKCQkJCQkJCXN0YXR1cyA9IDA7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJLy8gU2V0IGRhdGEgZm9yIHRoZSBmYWtlIHhociBvYmplY3QKCQkJCWpxWEhSLnN0YXR1cyA9IHN0YXR1czsKCQkJCWpxWEhSLnN0YXR1c1RleHQgPSAoIG5hdGl2ZVN0YXR1c1RleHQgfHwgc3RhdHVzVGV4dCApICsgIiI7CgoJCQkJLy8gU3VjY2Vzcy9FcnJvcgoJCQkJaWYgKCBpc1N1Y2Nlc3MgKSB7CgkJCQkJZGVmZXJyZWQucmVzb2x2ZVdpdGgoIGNhbGxiYWNrQ29udGV4dCwgWyBzdWNjZXNzLCBzdGF0dXNUZXh0LCBqcVhIUiBdICk7CgkJCQl9IGVsc2UgewoJCQkJCWRlZmVycmVkLnJlamVjdFdpdGgoIGNhbGxiYWNrQ29udGV4dCwgWyBqcVhIUiwgc3RhdHVzVGV4dCwgZXJyb3IgXSApOwoJCQkJfQoKCQkJCS8vIFN0YXR1cy1kZXBlbmRlbnQgY2FsbGJhY2tzCgkJCQlqcVhIUi5zdGF0dXNDb2RlKCBzdGF0dXNDb2RlICk7CgkJCQlzdGF0dXNDb2RlID0gdW5kZWZpbmVkOwoKCQkJCWlmICggZmlyZUdsb2JhbHMgKSB7CgkJCQkJZ2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIoIGlzU3VjY2VzcyA/ICJhamF4U3VjY2VzcyIgOiAiYWpheEVycm9yIiwKCQkJCQkJWyBqcVhIUiwgcywgaXNTdWNjZXNzID8gc3VjY2VzcyA6IGVycm9yIF0gKTsKCQkJCX0KCgkJCQkvLyBDb21wbGV0ZQoJCQkJY29tcGxldGVEZWZlcnJlZC5maXJlV2l0aCggY2FsbGJhY2tDb250ZXh0LCBbIGpxWEhSLCBzdGF0dXNUZXh0IF0gKTsKCgkJCQlpZiAoIGZpcmVHbG9iYWxzICkgewoJCQkJCWdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCAiYWpheENvbXBsZXRlIiwgWyBqcVhIUiwgcyBdICk7CgkJCQkJLy8gSGFuZGxlIHRoZSBnbG9iYWwgQUpBWCBjb3VudGVyCgkJCQkJaWYgKCAhKCAtLWpRdWVyeS5hY3RpdmUgKSApIHsKCQkJCQkJalF1ZXJ5LmV2ZW50LnRyaWdnZXIoImFqYXhTdG9wIik7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlyZXR1cm4ganFYSFI7CgkJfSwKCgkJZ2V0SlNPTjogZnVuY3Rpb24oIHVybCwgZGF0YSwgY2FsbGJhY2sgKSB7CgkJCXJldHVybiBqUXVlcnkuZ2V0KCB1cmwsIGRhdGEsIGNhbGxiYWNrLCAianNvbiIgKTsKCQl9LAoKCQlnZXRTY3JpcHQ6IGZ1bmN0aW9uKCB1cmwsIGNhbGxiYWNrICkgewoJCQlyZXR1cm4galF1ZXJ5LmdldCggdXJsLCB1bmRlZmluZWQsIGNhbGxiYWNrLCAic2NyaXB0IiApOwoJCX0KCX0pOwoKCWpRdWVyeS5lYWNoKCBbICJnZXQiLCAicG9zdCIgXSwgZnVuY3Rpb24oIGksIG1ldGhvZCApIHsKCQlqUXVlcnlbIG1ldGhvZCBdID0gZnVuY3Rpb24oIHVybCwgZGF0YSwgY2FsbGJhY2ssIHR5cGUgKSB7CgkJCS8vIHNoaWZ0IGFyZ3VtZW50cyBpZiBkYXRhIGFyZ3VtZW50IHdhcyBvbWl0dGVkCgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGRhdGEgKSApIHsKCQkJCXR5cGUgPSB0eXBlIHx8IGNhbGxiYWNrOwoJCQkJY2FsbGJhY2sgPSBkYXRhOwoJCQkJZGF0YSA9IHVuZGVmaW5lZDsKCQkJfQoKCQkJcmV0dXJuIGpRdWVyeS5hamF4KHsKCQkJCXVybDogdXJsLAoJCQkJdHlwZTogbWV0aG9kLAoJCQkJZGF0YVR5cGU6IHR5cGUsCgkJCQlkYXRhOiBkYXRhLAoJCQkJc3VjY2VzczogY2FsbGJhY2sKCQkJfSk7CgkJfTsKCX0pOwoKCglqUXVlcnkuX2V2YWxVcmwgPSBmdW5jdGlvbiggdXJsICkgewoJCXJldHVybiBqUXVlcnkuYWpheCh7CgkJCXVybDogdXJsLAoJCQl0eXBlOiAiR0VUIiwKCQkJZGF0YVR5cGU6ICJzY3JpcHQiLAoJCQlhc3luYzogZmFsc2UsCgkJCWdsb2JhbDogZmFsc2UsCgkJCSJ0aHJvd3MiOiB0cnVlCgkJfSk7Cgl9OwoKCglqUXVlcnkuZm4uZXh0ZW5kKHsKCQl3cmFwQWxsOiBmdW5jdGlvbiggaHRtbCApIHsKCQkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggaHRtbCApICkgewoJCQkJcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpKSB7CgkJCQkJalF1ZXJ5KHRoaXMpLndyYXBBbGwoIGh0bWwuY2FsbCh0aGlzLCBpKSApOwoJCQkJfSk7CgkJCX0KCgkJCWlmICggdGhpc1swXSApIHsKCQkJCS8vIFRoZSBlbGVtZW50cyB0byB3cmFwIHRoZSB0YXJnZXQgYXJvdW5kCgkJCQl2YXIgd3JhcCA9IGpRdWVyeSggaHRtbCwgdGhpc1swXS5vd25lckRvY3VtZW50ICkuZXEoMCkuY2xvbmUodHJ1ZSk7CgoJCQkJaWYgKCB0aGlzWzBdLnBhcmVudE5vZGUgKSB7CgkJCQkJd3JhcC5pbnNlcnRCZWZvcmUoIHRoaXNbMF0gKTsKCQkJCX0KCgkJCQl3cmFwLm1hcChmdW5jdGlvbigpIHsKCQkJCQl2YXIgZWxlbSA9IHRoaXM7CgoJCQkJCXdoaWxlICggZWxlbS5maXJzdENoaWxkICYmIGVsZW0uZmlyc3RDaGlsZC5ub2RlVHlwZSA9PT0gMSApIHsKCQkJCQkJZWxlbSA9IGVsZW0uZmlyc3RDaGlsZDsKCQkJCQl9CgoJCQkJCXJldHVybiBlbGVtOwoJCQkJfSkuYXBwZW5kKCB0aGlzICk7CgkJCX0KCgkJCXJldHVybiB0aGlzOwoJCX0sCgoJCXdyYXBJbm5lcjogZnVuY3Rpb24oIGh0bWwgKSB7CgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGh0bWwgKSApIHsKCQkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaSkgewoJCQkJCWpRdWVyeSh0aGlzKS53cmFwSW5uZXIoIGh0bWwuY2FsbCh0aGlzLCBpKSApOwoJCQkJfSk7CgkJCX0KCgkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CgkJCQl2YXIgc2VsZiA9IGpRdWVyeSggdGhpcyApLAoJCQkJCWNvbnRlbnRzID0gc2VsZi5jb250ZW50cygpOwoKCQkJCWlmICggY29udGVudHMubGVuZ3RoICkgewoJCQkJCWNvbnRlbnRzLndyYXBBbGwoIGh0bWwgKTsKCgkJCQl9IGVsc2UgewoJCQkJCXNlbGYuYXBwZW5kKCBodG1sICk7CgkJCQl9CgkJCX0pOwoJCX0sCgoJCXdyYXA6IGZ1bmN0aW9uKCBodG1sICkgewoJCQl2YXIgaXNGdW5jdGlvbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKCBodG1sICk7CgoJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGkpIHsKCQkJCWpRdWVyeSggdGhpcyApLndyYXBBbGwoIGlzRnVuY3Rpb24gPyBodG1sLmNhbGwodGhpcywgaSkgOiBodG1sICk7CgkJCX0pOwoJCX0sCgoJCXVud3JhcDogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLnBhcmVudCgpLmVhY2goZnVuY3Rpb24oKSB7CgkJCQlpZiAoICFqUXVlcnkubm9kZU5hbWUoIHRoaXMsICJib2R5IiApICkgewoJCQkJCWpRdWVyeSggdGhpcyApLnJlcGxhY2VXaXRoKCB0aGlzLmNoaWxkTm9kZXMgKTsKCQkJCX0KCQkJfSkuZW5kKCk7CgkJfQoJfSk7CgoKCWpRdWVyeS5leHByLmZpbHRlcnMuaGlkZGVuID0gZnVuY3Rpb24oIGVsZW0gKSB7CgkJLy8gU3VwcG9ydDogT3BlcmEgPD0gMTIuMTIKCQkvLyBPcGVyYSByZXBvcnRzIG9mZnNldFdpZHRocyBhbmQgb2Zmc2V0SGVpZ2h0cyBsZXNzIHRoYW4gemVybyBvbiBzb21lIGVsZW1lbnRzCgkJcmV0dXJuIGVsZW0ub2Zmc2V0V2lkdGggPD0gMCAmJiBlbGVtLm9mZnNldEhlaWdodCA8PSAwIHx8CgkJCSghc3VwcG9ydC5yZWxpYWJsZUhpZGRlbk9mZnNldHMoKSAmJgoJCQkJKChlbGVtLnN0eWxlICYmIGVsZW0uc3R5bGUuZGlzcGxheSkgfHwgalF1ZXJ5LmNzcyggZWxlbSwgImRpc3BsYXkiICkpID09PSAibm9uZSIpOwoJfTsKCglqUXVlcnkuZXhwci5maWx0ZXJzLnZpc2libGUgPSBmdW5jdGlvbiggZWxlbSApIHsKCQlyZXR1cm4gIWpRdWVyeS5leHByLmZpbHRlcnMuaGlkZGVuKCBlbGVtICk7Cgl9OwoKCgoKCXZhciByMjAgPSAvJTIwL2csCgkJcmJyYWNrZXQgPSAvXFtcXSQvLAoJCXJDUkxGID0gL1xyP1xuL2csCgkJcnN1Ym1pdHRlclR5cGVzID0gL14oPzpzdWJtaXR8YnV0dG9ufGltYWdlfHJlc2V0fGZpbGUpJC9pLAoJCXJzdWJtaXR0YWJsZSA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGtleWdlbikvaTsKCglmdW5jdGlvbiBidWlsZFBhcmFtcyggcHJlZml4LCBvYmosIHRyYWRpdGlvbmFsLCBhZGQgKSB7CgkJdmFyIG5hbWU7CgoJCWlmICggalF1ZXJ5LmlzQXJyYXkoIG9iaiApICkgewoJCQkvLyBTZXJpYWxpemUgYXJyYXkgaXRlbS4KCQkJalF1ZXJ5LmVhY2goIG9iaiwgZnVuY3Rpb24oIGksIHYgKSB7CgkJCQlpZiAoIHRyYWRpdGlvbmFsIHx8IHJicmFja2V0LnRlc3QoIHByZWZpeCApICkgewoJCQkJCS8vIFRyZWF0IGVhY2ggYXJyYXkgaXRlbSBhcyBhIHNjYWxhci4KCQkJCQlhZGQoIHByZWZpeCwgdiApOwoKCQkJCX0gZWxzZSB7CgkJCQkJLy8gSXRlbSBpcyBub24tc2NhbGFyIChhcnJheSBvciBvYmplY3QpLCBlbmNvZGUgaXRzIG51bWVyaWMgaW5kZXguCgkJCQkJYnVpbGRQYXJhbXMoIHByZWZpeCArICJbIiArICggdHlwZW9mIHYgPT09ICJvYmplY3QiID8gaSA6ICIiICkgKyAiXSIsIHYsIHRyYWRpdGlvbmFsLCBhZGQgKTsKCQkJCX0KCQkJfSk7CgoJCX0gZWxzZSBpZiAoICF0cmFkaXRpb25hbCAmJiBqUXVlcnkudHlwZSggb2JqICkgPT09ICJvYmplY3QiICkgewoJCQkvLyBTZXJpYWxpemUgb2JqZWN0IGl0ZW0uCgkJCWZvciAoIG5hbWUgaW4gb2JqICkgewoJCQkJYnVpbGRQYXJhbXMoIHByZWZpeCArICJbIiArIG5hbWUgKyAiXSIsIG9ialsgbmFtZSBdLCB0cmFkaXRpb25hbCwgYWRkICk7CgkJCX0KCgkJfSBlbHNlIHsKCQkJLy8gU2VyaWFsaXplIHNjYWxhciBpdGVtLgoJCQlhZGQoIHByZWZpeCwgb2JqICk7CgkJfQoJfQoKCS8vIFNlcmlhbGl6ZSBhbiBhcnJheSBvZiBmb3JtIGVsZW1lbnRzIG9yIGEgc2V0IG9mCgkvLyBrZXkvdmFsdWVzIGludG8gYSBxdWVyeSBzdHJpbmcKCWpRdWVyeS5wYXJhbSA9IGZ1bmN0aW9uKCBhLCB0cmFkaXRpb25hbCApIHsKCQl2YXIgcHJlZml4LAoJCQlzID0gW10sCgkJCWFkZCA9IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkgewoJCQkJLy8gSWYgdmFsdWUgaXMgYSBmdW5jdGlvbiwgaW52b2tlIGl0IGFuZCByZXR1cm4gaXRzIHZhbHVlCgkJCQl2YWx1ZSA9IGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApID8gdmFsdWUoKSA6ICggdmFsdWUgPT0gbnVsbCA/ICIiIDogdmFsdWUgKTsKCQkJCXNbIHMubGVuZ3RoIF0gPSBlbmNvZGVVUklDb21wb25lbnQoIGtleSApICsgIj0iICsgZW5jb2RlVVJJQ29tcG9uZW50KCB2YWx1ZSApOwoJCQl9OwoKCQkvLyBTZXQgdHJhZGl0aW9uYWwgdG8gdHJ1ZSBmb3IgalF1ZXJ5IDw9IDEuMy4yIGJlaGF2aW9yLgoJCWlmICggdHJhZGl0aW9uYWwgPT09IHVuZGVmaW5lZCApIHsKCQkJdHJhZGl0aW9uYWwgPSBqUXVlcnkuYWpheFNldHRpbmdzICYmIGpRdWVyeS5hamF4U2V0dGluZ3MudHJhZGl0aW9uYWw7CgkJfQoKCQkvLyBJZiBhbiBhcnJheSB3YXMgcGFzc2VkIGluLCBhc3N1bWUgdGhhdCBpdCBpcyBhbiBhcnJheSBvZiBmb3JtIGVsZW1lbnRzLgoJCWlmICggalF1ZXJ5LmlzQXJyYXkoIGEgKSB8fCAoIGEuanF1ZXJ5ICYmICFqUXVlcnkuaXNQbGFpbk9iamVjdCggYSApICkgKSB7CgkJCS8vIFNlcmlhbGl6ZSB0aGUgZm9ybSBlbGVtZW50cwoJCQlqUXVlcnkuZWFjaCggYSwgZnVuY3Rpb24oKSB7CgkJCQlhZGQoIHRoaXMubmFtZSwgdGhpcy52YWx1ZSApOwoJCQl9KTsKCgkJfSBlbHNlIHsKCQkJLy8gSWYgdHJhZGl0aW9uYWwsIGVuY29kZSB0aGUgIm9sZCIgd2F5ICh0aGUgd2F5IDEuMy4yIG9yIG9sZGVyCgkJCS8vIGRpZCBpdCksIG90aGVyd2lzZSBlbmNvZGUgcGFyYW1zIHJlY3Vyc2l2ZWx5LgoJCQlmb3IgKCBwcmVmaXggaW4gYSApIHsKCQkJCWJ1aWxkUGFyYW1zKCBwcmVmaXgsIGFbIHByZWZpeCBdLCB0cmFkaXRpb25hbCwgYWRkICk7CgkJCX0KCQl9CgoJCS8vIFJldHVybiB0aGUgcmVzdWx0aW5nIHNlcmlhbGl6YXRpb24KCQlyZXR1cm4gcy5qb2luKCAiJiIgKS5yZXBsYWNlKCByMjAsICIrIiApOwoJfTsKCglqUXVlcnkuZm4uZXh0ZW5kKHsKCQlzZXJpYWxpemU6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4galF1ZXJ5LnBhcmFtKCB0aGlzLnNlcmlhbGl6ZUFycmF5KCkgKTsKCQl9LAoJCXNlcmlhbGl6ZUFycmF5OiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCkgewoJCQkJLy8gQ2FuIGFkZCBwcm9wSG9vayBmb3IgImVsZW1lbnRzIiB0byBmaWx0ZXIgb3IgYWRkIGZvcm0gZWxlbWVudHMKCQkJCXZhciBlbGVtZW50cyA9IGpRdWVyeS5wcm9wKCB0aGlzLCAiZWxlbWVudHMiICk7CgkJCQlyZXR1cm4gZWxlbWVudHMgPyBqUXVlcnkubWFrZUFycmF5KCBlbGVtZW50cyApIDogdGhpczsKCQkJfSkKCQkJLmZpbHRlcihmdW5jdGlvbigpIHsKCQkJCXZhciB0eXBlID0gdGhpcy50eXBlOwoJCQkJLy8gVXNlIC5pcygiOmRpc2FibGVkIikgc28gdGhhdCBmaWVsZHNldFtkaXNhYmxlZF0gd29ya3MKCQkJCXJldHVybiB0aGlzLm5hbWUgJiYgIWpRdWVyeSggdGhpcyApLmlzKCAiOmRpc2FibGVkIiApICYmCgkJCQkJcnN1Ym1pdHRhYmxlLnRlc3QoIHRoaXMubm9kZU5hbWUgKSAmJiAhcnN1Ym1pdHRlclR5cGVzLnRlc3QoIHR5cGUgKSAmJgoJCQkJCSggdGhpcy5jaGVja2VkIHx8ICFyY2hlY2thYmxlVHlwZS50ZXN0KCB0eXBlICkgKTsKCQkJfSkKCQkJLm1hcChmdW5jdGlvbiggaSwgZWxlbSApIHsKCQkJCXZhciB2YWwgPSBqUXVlcnkoIHRoaXMgKS52YWwoKTsKCgkJCQlyZXR1cm4gdmFsID09IG51bGwgPwoJCQkJCW51bGwgOgoJCQkJCWpRdWVyeS5pc0FycmF5KCB2YWwgKSA/CgkJCQkJCWpRdWVyeS5tYXAoIHZhbCwgZnVuY3Rpb24oIHZhbCApIHsKCQkJCQkJCXJldHVybiB7IG5hbWU6IGVsZW0ubmFtZSwgdmFsdWU6IHZhbC5yZXBsYWNlKCByQ1JMRiwgIlxyXG4iICkgfTsKCQkJCQkJfSkgOgoJCQkJCQl7IG5hbWU6IGVsZW0ubmFtZSwgdmFsdWU6IHZhbC5yZXBsYWNlKCByQ1JMRiwgIlxyXG4iICkgfTsKCQkJfSkuZ2V0KCk7CgkJfQoJfSk7CgoKCS8vIENyZWF0ZSB0aGUgcmVxdWVzdCBvYmplY3QKCS8vIChUaGlzIGlzIHN0aWxsIGF0dGFjaGVkIHRvIGFqYXhTZXR0aW5ncyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSkKCWpRdWVyeS5hamF4U2V0dGluZ3MueGhyID0gd2luZG93LkFjdGl2ZVhPYmplY3QgIT09IHVuZGVmaW5lZCA/CgkJLy8gU3VwcG9ydDogSUU2KwoJCWZ1bmN0aW9uKCkgewoKCQkJLy8gWEhSIGNhbm5vdCBhY2Nlc3MgbG9jYWwgZmlsZXMsIGFsd2F5cyB1c2UgQWN0aXZlWCBmb3IgdGhhdCBjYXNlCgkJCXJldHVybiAhdGhpcy5pc0xvY2FsICYmCgoJCQkJLy8gU3VwcG9ydDogSUU3LTgKCQkJCS8vIG9sZElFIFhIUiBkb2VzIG5vdCBzdXBwb3J0IG5vbi1SRkMyNjE2IG1ldGhvZHMgKCMxMzI0MCkKCQkJCS8vIFNlZSBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvaWUvbXM1MzY2NDgodj12cy44NSkuYXNweAoJCQkJLy8gYW5kIGh0dHA6Ly93d3cudzMub3JnL1Byb3RvY29scy9yZmMyNjE2L3JmYzI2MTYtc2VjOS5odG1sI3NlYzkKCQkJCS8vIEFsdGhvdWdoIHRoaXMgY2hlY2sgZm9yIHNpeCBtZXRob2RzIGluc3RlYWQgb2YgZWlnaHQKCQkJCS8vIHNpbmNlIElFIGFsc28gZG9lcyBub3Qgc3VwcG9ydCAidHJhY2UiIGFuZCAiY29ubmVjdCIKCQkJCS9eKGdldHxwb3N0fGhlYWR8cHV0fGRlbGV0ZXxvcHRpb25zKSQvaS50ZXN0KCB0aGlzLnR5cGUgKSAmJgoKCQkJCWNyZWF0ZVN0YW5kYXJkWEhSKCkgfHwgY3JlYXRlQWN0aXZlWEhSKCk7CgkJfSA6CgkJLy8gRm9yIGFsbCBvdGhlciBicm93c2VycywgdXNlIHRoZSBzdGFuZGFyZCBYTUxIdHRwUmVxdWVzdCBvYmplY3QKCQljcmVhdGVTdGFuZGFyZFhIUjsKCgl2YXIgeGhySWQgPSAwLAoJCXhockNhbGxiYWNrcyA9IHt9LAoJCXhoclN1cHBvcnRlZCA9IGpRdWVyeS5hamF4U2V0dGluZ3MueGhyKCk7CgoJLy8gU3VwcG9ydDogSUU8MTAKCS8vIE9wZW4gcmVxdWVzdHMgbXVzdCBiZSBtYW51YWxseSBhYm9ydGVkIG9uIHVubG9hZCAoIzUyODApCgkvLyBTZWUgaHR0cHM6Ly9zdXBwb3J0Lm1pY3Jvc29mdC5jb20va2IvMjg1Njc0NiBmb3IgbW9yZSBpbmZvCglpZiAoIHdpbmRvdy5hdHRhY2hFdmVudCApIHsKCQl3aW5kb3cuYXR0YWNoRXZlbnQoICJvbnVubG9hZCIsIGZ1bmN0aW9uKCkgewoJCQlmb3IgKCB2YXIga2V5IGluIHhockNhbGxiYWNrcyApIHsKCQkJCXhockNhbGxiYWNrc1sga2V5IF0oIHVuZGVmaW5lZCwgdHJ1ZSApOwoJCQl9CgkJfSk7Cgl9CgoJLy8gRGV0ZXJtaW5lIHN1cHBvcnQgcHJvcGVydGllcwoJc3VwcG9ydC5jb3JzID0gISF4aHJTdXBwb3J0ZWQgJiYgKCAid2l0aENyZWRlbnRpYWxzIiBpbiB4aHJTdXBwb3J0ZWQgKTsKCXhoclN1cHBvcnRlZCA9IHN1cHBvcnQuYWpheCA9ICEheGhyU3VwcG9ydGVkOwoKCS8vIENyZWF0ZSB0cmFuc3BvcnQgaWYgdGhlIGJyb3dzZXIgY2FuIHByb3ZpZGUgYW4geGhyCglpZiAoIHhoclN1cHBvcnRlZCApIHsKCgkJalF1ZXJ5LmFqYXhUcmFuc3BvcnQoZnVuY3Rpb24oIG9wdGlvbnMgKSB7CgkJCS8vIENyb3NzIGRvbWFpbiBvbmx5IGFsbG93ZWQgaWYgc3VwcG9ydGVkIHRocm91Z2ggWE1MSHR0cFJlcXVlc3QKCQkJaWYgKCAhb3B0aW9ucy5jcm9zc0RvbWFpbiB8fCBzdXBwb3J0LmNvcnMgKSB7CgoJCQkJdmFyIGNhbGxiYWNrOwoKCQkJCXJldHVybiB7CgkJCQkJc2VuZDogZnVuY3Rpb24oIGhlYWRlcnMsIGNvbXBsZXRlICkgewoJCQkJCQl2YXIgaSwKCQkJCQkJCXhociA9IG9wdGlvbnMueGhyKCksCgkJCQkJCQlpZCA9ICsreGhySWQ7CgoJCQkJCQkvLyBPcGVuIHRoZSBzb2NrZXQKCQkJCQkJeGhyLm9wZW4oIG9wdGlvbnMudHlwZSwgb3B0aW9ucy51cmwsIG9wdGlvbnMuYXN5bmMsIG9wdGlvbnMudXNlcm5hbWUsIG9wdGlvbnMucGFzc3dvcmQgKTsKCgkJCQkJCS8vIEFwcGx5IGN1c3RvbSBmaWVsZHMgaWYgcHJvdmlkZWQKCQkJCQkJaWYgKCBvcHRpb25zLnhockZpZWxkcyApIHsKCQkJCQkJCWZvciAoIGkgaW4gb3B0aW9ucy54aHJGaWVsZHMgKSB7CgkJCQkJCQkJeGhyWyBpIF0gPSBvcHRpb25zLnhockZpZWxkc1sgaSBdOwoJCQkJCQkJfQoJCQkJCQl9CgoJCQkJCQkvLyBPdmVycmlkZSBtaW1lIHR5cGUgaWYgbmVlZGVkCgkJCQkJCWlmICggb3B0aW9ucy5taW1lVHlwZSAmJiB4aHIub3ZlcnJpZGVNaW1lVHlwZSApIHsKCQkJCQkJCXhoci5vdmVycmlkZU1pbWVUeXBlKCBvcHRpb25zLm1pbWVUeXBlICk7CgkJCQkJCX0KCgkJCQkJCS8vIFgtUmVxdWVzdGVkLVdpdGggaGVhZGVyCgkJCQkJCS8vIEZvciBjcm9zcy1kb21haW4gcmVxdWVzdHMsIHNlZWluZyBhcyBjb25kaXRpb25zIGZvciBhIHByZWZsaWdodCBhcmUKCQkJCQkJLy8gYWtpbiB0byBhIGppZ3NhdyBwdXp6bGUsIHdlIHNpbXBseSBuZXZlciBzZXQgaXQgdG8gYmUgc3VyZS4KCQkJCQkJLy8gKGl0IGNhbiBhbHdheXMgYmUgc2V0IG9uIGEgcGVyLXJlcXVlc3QgYmFzaXMgb3IgZXZlbiB1c2luZyBhamF4U2V0dXApCgkJCQkJCS8vIEZvciBzYW1lLWRvbWFpbiByZXF1ZXN0cywgd29uJ3QgY2hhbmdlIGhlYWRlciBpZiBhbHJlYWR5IHByb3ZpZGVkLgoJCQkJCQlpZiAoICFvcHRpb25zLmNyb3NzRG9tYWluICYmICFoZWFkZXJzWyJYLVJlcXVlc3RlZC1XaXRoIl0gKSB7CgkJCQkJCQloZWFkZXJzWyJYLVJlcXVlc3RlZC1XaXRoIl0gPSAiWE1MSHR0cFJlcXVlc3QiOwoJCQkJCQl9CgoJCQkJCQkvLyBTZXQgaGVhZGVycwoJCQkJCQlmb3IgKCBpIGluIGhlYWRlcnMgKSB7CgkJCQkJCQkvLyBTdXBwb3J0OiBJRTw5CgkJCQkJCQkvLyBJRSdzIEFjdGl2ZVhPYmplY3QgdGhyb3dzIGEgJ1R5cGUgTWlzbWF0Y2gnIGV4Y2VwdGlvbiB3aGVuIHNldHRpbmcKCQkJCQkJCS8vIHJlcXVlc3QgaGVhZGVyIHRvIGEgbnVsbC12YWx1ZS4KCQkJCQkJCS8v", "base64"));
  res.write(new Buffer("CgkJCQkJCQkvLyBUbyBrZWVwIGNvbnNpc3RlbnQgd2l0aCBvdGhlciBYSFIgaW1wbGVtZW50YXRpb25zLCBjYXN0IHRoZSB2YWx1ZQoJCQkJCQkJLy8gdG8gc3RyaW5nIGFuZCBpZ25vcmUgYHVuZGVmaW5lZGAuCgkJCQkJCQlpZiAoIGhlYWRlcnNbIGkgXSAhPT0gdW5kZWZpbmVkICkgewoJCQkJCQkJCXhoci5zZXRSZXF1ZXN0SGVhZGVyKCBpLCBoZWFkZXJzWyBpIF0gKyAiIiApOwoJCQkJCQkJfQoJCQkJCQl9CgoJCQkJCQkvLyBEbyBzZW5kIHRoZSByZXF1ZXN0CgkJCQkJCS8vIFRoaXMgbWF5IHJhaXNlIGFuIGV4Y2VwdGlvbiB3aGljaCBpcyBhY3R1YWxseQoJCQkJCQkvLyBoYW5kbGVkIGluIGpRdWVyeS5hamF4IChzbyBubyB0cnkvY2F0Y2ggaGVyZSkKCQkJCQkJeGhyLnNlbmQoICggb3B0aW9ucy5oYXNDb250ZW50ICYmIG9wdGlvbnMuZGF0YSApIHx8IG51bGwgKTsKCgkJCQkJCS8vIExpc3RlbmVyCgkJCQkJCWNhbGxiYWNrID0gZnVuY3Rpb24oIF8sIGlzQWJvcnQgKSB7CgkJCQkJCQl2YXIgc3RhdHVzLCBzdGF0dXNUZXh0LCByZXNwb25zZXM7CgoJCQkJCQkJLy8gV2FzIG5ldmVyIGNhbGxlZCBhbmQgaXMgYWJvcnRlZCBvciBjb21wbGV0ZQoJCQkJCQkJaWYgKCBjYWxsYmFjayAmJiAoIGlzQWJvcnQgfHwgeGhyLnJlYWR5U3RhdGUgPT09IDQgKSApIHsKCQkJCQkJCQkvLyBDbGVhbiB1cAoJCQkJCQkJCWRlbGV0ZSB4aHJDYWxsYmFja3NbIGlkIF07CgkJCQkJCQkJY2FsbGJhY2sgPSB1bmRlZmluZWQ7CgkJCQkJCQkJeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGpRdWVyeS5ub29wOwoKCQkJCQkJCQkvLyBBYm9ydCBtYW51YWxseSBpZiBuZWVkZWQKCQkJCQkJCQlpZiAoIGlzQWJvcnQgKSB7CgkJCQkJCQkJCWlmICggeGhyLnJlYWR5U3RhdGUgIT09IDQgKSB7CgkJCQkJCQkJCQl4aHIuYWJvcnQoKTsKCQkJCQkJCQkJfQoJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCXJlc3BvbnNlcyA9IHt9OwoJCQkJCQkJCQlzdGF0dXMgPSB4aHIuc3RhdHVzOwoKCQkJCQkJCQkJLy8gU3VwcG9ydDogSUU8MTAKCQkJCQkJCQkJLy8gQWNjZXNzaW5nIGJpbmFyeS1kYXRhIHJlc3BvbnNlVGV4dCB0aHJvd3MgYW4gZXhjZXB0aW9uCgkJCQkJCQkJCS8vICgjMTE0MjYpCgkJCQkJCQkJCWlmICggdHlwZW9mIHhoci5yZXNwb25zZVRleHQgPT09ICJzdHJpbmciICkgewoJCQkJCQkJCQkJcmVzcG9uc2VzLnRleHQgPSB4aHIucmVzcG9uc2VUZXh0OwoJCQkJCQkJCQl9CgoJCQkJCQkJCQkvLyBGaXJlZm94IHRocm93cyBhbiBleGNlcHRpb24gd2hlbiBhY2Nlc3NpbmcKCQkJCQkJCQkJLy8gc3RhdHVzVGV4dCBmb3IgZmF1bHR5IGNyb3NzLWRvbWFpbiByZXF1ZXN0cwoJCQkJCQkJCQl0cnkgewoJCQkJCQkJCQkJc3RhdHVzVGV4dCA9IHhoci5zdGF0dXNUZXh0OwoJCQkJCQkJCQl9IGNhdGNoKCBlICkgewoJCQkJCQkJCQkJLy8gV2Ugbm9ybWFsaXplIHdpdGggV2Via2l0IGdpdmluZyBhbiBlbXB0eSBzdGF0dXNUZXh0CgkJCQkJCQkJCQlzdGF0dXNUZXh0ID0gIiI7CgkJCQkJCQkJCX0KCgkJCQkJCQkJCS8vIEZpbHRlciBzdGF0dXMgZm9yIG5vbiBzdGFuZGFyZCBiZWhhdmlvcnMKCgkJCQkJCQkJCS8vIElmIHRoZSByZXF1ZXN0IGlzIGxvY2FsIGFuZCB3ZSBoYXZlIGRhdGE6IGFzc3VtZSBhIHN1Y2Nlc3MKCQkJCQkJCQkJLy8gKHN1Y2Nlc3Mgd2l0aCBubyBkYXRhIHdvbid0IGdldCBub3RpZmllZCwgdGhhdCdzIHRoZSBiZXN0IHdlCgkJCQkJCQkJCS8vIGNhbiBkbyBnaXZlbiBjdXJyZW50IGltcGxlbWVudGF0aW9ucykKCQkJCQkJCQkJaWYgKCAhc3RhdHVzICYmIG9wdGlvbnMuaXNMb2NhbCAmJiAhb3B0aW9ucy5jcm9zc0RvbWFpbiApIHsKCQkJCQkJCQkJCXN0YXR1cyA9IHJlc3BvbnNlcy50ZXh0ID8gMjAwIDogNDA0OwoJCQkJCQkJCQkvLyBJRSAtICMxNDUwOiBzb21ldGltZXMgcmV0dXJucyAxMjIzIHdoZW4gaXQgc2hvdWxkIGJlIDIwNAoJCQkJCQkJCQl9IGVsc2UgaWYgKCBzdGF0dXMgPT09IDEyMjMgKSB7CgkJCQkJCQkJCQlzdGF0dXMgPSAyMDQ7CgkJCQkJCQkJCX0KCQkJCQkJCQl9CgkJCQkJCQl9CgoJCQkJCQkJLy8gQ2FsbCBjb21wbGV0ZSBpZiBuZWVkZWQKCQkJCQkJCWlmICggcmVzcG9uc2VzICkgewoJCQkJCQkJCWNvbXBsZXRlKCBzdGF0dXMsIHN0YXR1c1RleHQsIHJlc3BvbnNlcywgeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpICk7CgkJCQkJCQl9CgkJCQkJCX07CgoJCQkJCQlpZiAoICFvcHRpb25zLmFzeW5jICkgewoJCQkJCQkJLy8gaWYgd2UncmUgaW4gc3luYyBtb2RlIHdlIGZpcmUgdGhlIGNhbGxiYWNrCgkJCQkJCQljYWxsYmFjaygpOwoJCQkJCQl9IGVsc2UgaWYgKCB4aHIucmVhZHlTdGF0ZSA9PT0gNCApIHsKCQkJCQkJCS8vIChJRTYgJiBJRTcpIGlmIGl0J3MgaW4gY2FjaGUgYW5kIGhhcyBiZWVuCgkJCQkJCQkvLyByZXRyaWV2ZWQgZGlyZWN0bHkgd2UgbmVlZCB0byBmaXJlIHRoZSBjYWxsYmFjawoJCQkJCQkJc2V0VGltZW91dCggY2FsbGJhY2sgKTsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCS8vIEFkZCB0byB0aGUgbGlzdCBvZiBhY3RpdmUgeGhyIGNhbGxiYWNrcwoJCQkJCQkJeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IHhockNhbGxiYWNrc1sgaWQgXSA9IGNhbGxiYWNrOwoJCQkJCQl9CgkJCQkJfSwKCgkJCQkJYWJvcnQ6IGZ1bmN0aW9uKCkgewoJCQkJCQlpZiAoIGNhbGxiYWNrICkgewoJCQkJCQkJY2FsbGJhY2soIHVuZGVmaW5lZCwgdHJ1ZSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfTsKCQkJfQoJCX0pOwoJfQoKCS8vIEZ1bmN0aW9ucyB0byBjcmVhdGUgeGhycwoJZnVuY3Rpb24gY3JlYXRlU3RhbmRhcmRYSFIoKSB7CgkJdHJ5IHsKCQkJcmV0dXJuIG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTsKCQl9IGNhdGNoKCBlICkge30KCX0KCglmdW5jdGlvbiBjcmVhdGVBY3RpdmVYSFIoKSB7CgkJdHJ5IHsKCQkJcmV0dXJuIG5ldyB3aW5kb3cuQWN0aXZlWE9iamVjdCggIk1pY3Jvc29mdC5YTUxIVFRQIiApOwoJCX0gY2F0Y2goIGUgKSB7fQoJfQoKCgoKCS8vIEluc3RhbGwgc2NyaXB0IGRhdGFUeXBlCglqUXVlcnkuYWpheFNldHVwKHsKCQlhY2NlcHRzOiB7CgkJCXNjcmlwdDogInRleHQvamF2YXNjcmlwdCwgYXBwbGljYXRpb24vamF2YXNjcmlwdCwgYXBwbGljYXRpb24vZWNtYXNjcmlwdCwgYXBwbGljYXRpb24veC1lY21hc2NyaXB0IgoJCX0sCgkJY29udGVudHM6IHsKCQkJc2NyaXB0OiAvKD86amF2YXxlY21hKXNjcmlwdC8KCQl9LAoJCWNvbnZlcnRlcnM6IHsKCQkJInRleHQgc2NyaXB0IjogZnVuY3Rpb24oIHRleHQgKSB7CgkJCQlqUXVlcnkuZ2xvYmFsRXZhbCggdGV4dCApOwoJCQkJcmV0dXJuIHRleHQ7CgkJCX0KCQl9Cgl9KTsKCgkvLyBIYW5kbGUgY2FjaGUncyBzcGVjaWFsIGNhc2UgYW5kIGdsb2JhbAoJalF1ZXJ5LmFqYXhQcmVmaWx0ZXIoICJzY3JpcHQiLCBmdW5jdGlvbiggcyApIHsKCQlpZiAoIHMuY2FjaGUgPT09IHVuZGVmaW5lZCApIHsKCQkJcy5jYWNoZSA9IGZhbHNlOwoJCX0KCQlpZiAoIHMuY3Jvc3NEb21haW4gKSB7CgkJCXMudHlwZSA9ICJHRVQiOwoJCQlzLmdsb2JhbCA9IGZhbHNlOwoJCX0KCX0pOwoKCS8vIEJpbmQgc2NyaXB0IHRhZyBoYWNrIHRyYW5zcG9ydAoJalF1ZXJ5LmFqYXhUcmFuc3BvcnQoICJzY3JpcHQiLCBmdW5jdGlvbihzKSB7CgoJCS8vIFRoaXMgdHJhbnNwb3J0IG9ubHkgZGVhbHMgd2l0aCBjcm9zcyBkb21haW4gcmVxdWVzdHMKCQlpZiAoIHMuY3Jvc3NEb21haW4gKSB7CgoJCQl2YXIgc2NyaXB0LAoJCQkJaGVhZCA9IGRvY3VtZW50LmhlYWQgfHwgalF1ZXJ5KCJoZWFkIilbMF0gfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoKCQkJcmV0dXJuIHsKCgkJCQlzZW5kOiBmdW5jdGlvbiggXywgY2FsbGJhY2sgKSB7CgoJCQkJCXNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpOwoKCQkJCQlzY3JpcHQuYXN5bmMgPSB0cnVlOwoKCQkJCQlpZiAoIHMuc2NyaXB0Q2hhcnNldCApIHsKCQkJCQkJc2NyaXB0LmNoYXJzZXQgPSBzLnNjcmlwdENoYXJzZXQ7CgkJCQkJfQoKCQkJCQlzY3JpcHQuc3JjID0gcy51cmw7CgoJCQkJCS8vIEF0dGFjaCBoYW5kbGVycyBmb3IgYWxsIGJyb3dzZXJzCgkJCQkJc2NyaXB0Lm9ubG9hZCA9IHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiggXywgaXNBYm9ydCApIHsKCgkJCQkJCWlmICggaXNBYm9ydCB8fCAhc2NyaXB0LnJlYWR5U3RhdGUgfHwgL2xvYWRlZHxjb21wbGV0ZS8udGVzdCggc2NyaXB0LnJlYWR5U3RhdGUgKSApIHsKCgkJCQkJCQkvLyBIYW5kbGUgbWVtb3J5IGxlYWsgaW4gSUUKCQkJCQkJCXNjcmlwdC5vbmxvYWQgPSBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDsKCgkJCQkJCQkvLyBSZW1vdmUgdGhlIHNjcmlwdAoJCQkJCQkJaWYgKCBzY3JpcHQucGFyZW50Tm9kZSApIHsKCQkJCQkJCQlzY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggc2NyaXB0ICk7CgkJCQkJCQl9CgoJCQkJCQkJLy8gRGVyZWZlcmVuY2UgdGhlIHNjcmlwdAoJCQkJCQkJc2NyaXB0ID0gbnVsbDsKCgkJCQkJCQkvLyBDYWxsYmFjayBpZiBub3QgYWJvcnQKCQkJCQkJCWlmICggIWlzQWJvcnQgKSB7CgkJCQkJCQkJY2FsbGJhY2soIDIwMCwgInN1Y2Nlc3MiICk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9OwoKCQkJCQkvLyBDaXJjdW12ZW50IElFNiBidWdzIHdpdGggYmFzZSBlbGVtZW50cyAoIzI3MDkgYW5kICM0Mzc4KSBieSBwcmVwZW5kaW5nCgkJCQkJLy8gVXNlIG5hdGl2ZSBET00gbWFuaXB1bGF0aW9uIHRvIGF2b2lkIG91ciBkb21NYW5pcCBBSkFYIHRyaWNrZXJ5CgkJCQkJaGVhZC5pbnNlcnRCZWZvcmUoIHNjcmlwdCwgaGVhZC5maXJzdENoaWxkICk7CgkJCQl9LAoKCQkJCWFib3J0OiBmdW5jdGlvbigpIHsKCQkJCQlpZiAoIHNjcmlwdCApIHsKCQkJCQkJc2NyaXB0Lm9ubG9hZCggdW5kZWZpbmVkLCB0cnVlICk7CgkJCQkJfQoJCQkJfQoJCQl9OwoJCX0KCX0pOwoKCgoKCXZhciBvbGRDYWxsYmFja3MgPSBbXSwKCQlyanNvbnAgPSAvKD0pXD8oPz0mfCQpfFw/XD8vOwoKCS8vIERlZmF1bHQganNvbnAgc2V0dGluZ3MKCWpRdWVyeS5hamF4U2V0dXAoewoJCWpzb25wOiAiY2FsbGJhY2siLAoJCWpzb25wQ2FsbGJhY2s6IGZ1bmN0aW9uKCkgewoJCQl2YXIgY2FsbGJhY2sgPSBvbGRDYWxsYmFja3MucG9wKCkgfHwgKCBqUXVlcnkuZXhwYW5kbyArICJfIiArICggbm9uY2UrKyApICk7CgkJCXRoaXNbIGNhbGxiYWNrIF0gPSB0cnVlOwoJCQlyZXR1cm4gY2FsbGJhY2s7CgkJfQoJfSk7CgoJLy8gRGV0ZWN0LCBub3JtYWxpemUgb3B0aW9ucyBhbmQgaW5zdGFsbCBjYWxsYmFja3MgZm9yIGpzb25wIHJlcXVlc3RzCglqUXVlcnkuYWpheFByZWZpbHRlciggImpzb24ganNvbnAiLCBmdW5jdGlvbiggcywgb3JpZ2luYWxTZXR0aW5ncywganFYSFIgKSB7CgoJCXZhciBjYWxsYmFja05hbWUsIG92ZXJ3cml0dGVuLCByZXNwb25zZUNvbnRhaW5lciwKCQkJanNvblByb3AgPSBzLmpzb25wICE9PSBmYWxzZSAmJiAoIHJqc29ucC50ZXN0KCBzLnVybCApID8KCQkJCSJ1cmwiIDoKCQkJCXR5cGVvZiBzLmRhdGEgPT09ICJzdHJpbmciICYmICEoIHMuY29udGVudFR5cGUgfHwgIiIgKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSAmJiByanNvbnAudGVzdCggcy5kYXRhICkgJiYgImRhdGEiCgkJCSk7CgoJCS8vIEhhbmRsZSBpZmYgdGhlIGV4cGVjdGVkIGRhdGEgdHlwZSBpcyAianNvbnAiIG9yIHdlIGhhdmUgYSBwYXJhbWV0ZXIgdG8gc2V0CgkJaWYgKCBqc29uUHJvcCB8fCBzLmRhdGFUeXBlc1sgMCBdID09PSAianNvbnAiICkgewoKCQkJLy8gR2V0IGNhbGxiYWNrIG5hbWUsIHJlbWVtYmVyaW5nIHByZWV4aXN0aW5nIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCBpdAoJCQljYWxsYmFja05hbWUgPSBzLmpzb25wQ2FsbGJhY2sgPSBqUXVlcnkuaXNGdW5jdGlvbiggcy5qc29ucENhbGxiYWNrICkgPwoJCQkJcy5qc29ucENhbGxiYWNrKCkgOgoJCQkJcy5qc29ucENhbGxiYWNrOwoKCQkJLy8gSW5zZXJ0IGNhbGxiYWNrIGludG8gdXJsIG9yIGZvcm0gZGF0YQoJCQlpZiAoIGpzb25Qcm9wICkgewoJCQkJc1sganNvblByb3AgXSA9IHNbIGpzb25Qcm9wIF0ucmVwbGFjZSggcmpzb25wLCAiJDEiICsgY2FsbGJhY2tOYW1lICk7CgkJCX0gZWxzZSBpZiAoIHMuanNvbnAgIT09IGZhbHNlICkgewoJCQkJcy51cmwgKz0gKCBycXVlcnkudGVzdCggcy51cmwgKSA/ICImIiA6ICI/IiApICsgcy5qc29ucCArICI9IiArIGNhbGxiYWNrTmFtZTsKCQkJfQoKCQkJLy8gVXNlIGRhdGEgY29udmVydGVyIHRvIHJldHJpZXZlIGpzb24gYWZ0ZXIgc2NyaXB0IGV4ZWN1dGlvbgoJCQlzLmNvbnZlcnRlcnNbInNjcmlwdCBqc29uIl0gPSBmdW5jdGlvbigpIHsKCQkJCWlmICggIXJlc3BvbnNlQ29udGFpbmVyICkgewoJCQkJCWpRdWVyeS5lcnJvciggY2FsbGJhY2tOYW1lICsgIiB3YXMgbm90IGNhbGxlZCIgKTsKCQkJCX0KCQkJCXJldHVybiByZXNwb25zZUNvbnRhaW5lclsgMCBdOwoJCQl9OwoKCQkJLy8gZm9yY2UganNvbiBkYXRhVHlwZQoJCQlzLmRhdGFUeXBlc1sgMCBdID0gImpzb24iOwoKCQkJLy8gSW5zdGFsbCBjYWxsYmFjawoJCQlvdmVyd3JpdHRlbiA9IHdpbmRvd1sgY2FsbGJhY2tOYW1lIF07CgkJCXdpbmRvd1sgY2FsbGJhY2tOYW1lIF0gPSBmdW5jdGlvbigpIHsKCQkJCXJlc3BvbnNlQ29udGFpbmVyID0gYXJndW1lbnRzOwoJCQl9OwoKCQkJLy8gQ2xlYW4tdXAgZnVuY3Rpb24gKGZpcmVzIGFmdGVyIGNvbnZlcnRlcnMpCgkJCWpxWEhSLmFsd2F5cyhmdW5jdGlvbigpIHsKCQkJCS8vIFJlc3RvcmUgcHJlZXhpc3RpbmcgdmFsdWUKCQkJCXdpbmRvd1sgY2FsbGJhY2tOYW1lIF0gPSBvdmVyd3JpdHRlbjsKCgkJCQkvLyBTYXZlIGJhY2sgYXMgZnJlZQoJCQkJaWYgKCBzWyBjYWxsYmFja05hbWUgXSApIHsKCQkJCQkvLyBtYWtlIHN1cmUgdGhhdCByZS11c2luZyB0aGUgb3B0aW9ucyBkb2Vzbid0IHNjcmV3IHRoaW5ncyBhcm91bmQKCQkJCQlzLmpzb25wQ2FsbGJhY2sgPSBvcmlnaW5hbFNldHRpbmdzLmpzb25wQ2FsbGJhY2s7CgoJCQkJCS8vIHNhdmUgdGhlIGNhbGxiYWNrIG5hbWUgZm9yIGZ1dHVyZSB1c2UKCQkJCQlvbGRDYWxsYmFja3MucHVzaCggY2FsbGJhY2tOYW1lICk7CgkJCQl9CgoJCQkJLy8gQ2FsbCBpZiBpdCB3YXMgYSBmdW5jdGlvbiBhbmQgd2UgaGF2ZSBhIHJlc3BvbnNlCgkJCQlpZiAoIHJlc3BvbnNlQ29udGFpbmVyICYmIGpRdWVyeS5pc0Z1bmN0aW9uKCBvdmVyd3JpdHRlbiApICkgewoJCQkJCW92ZXJ3cml0dGVuKCByZXNwb25zZUNvbnRhaW5lclsgMCBdICk7CgkJCQl9CgoJCQkJcmVzcG9uc2VDb250YWluZXIgPSBvdmVyd3JpdHRlbiA9IHVuZGVmaW5lZDsKCQkJfSk7CgoJCQkvLyBEZWxlZ2F0ZSB0byBzY3JpcHQKCQkJcmV0dXJuICJzY3JpcHQiOwoJCX0KCX0pOwoKCgoKCS8vIGRhdGE6IHN0cmluZyBvZiBodG1sCgkvLyBjb250ZXh0IChvcHRpb25hbCk6IElmIHNwZWNpZmllZCwgdGhlIGZyYWdtZW50IHdpbGwgYmUgY3JlYXRlZCBpbiB0aGlzIGNvbnRleHQsIGRlZmF1bHRzIHRvIGRvY3VtZW50CgkvLyBrZWVwU2NyaXB0cyAob3B0aW9uYWwpOiBJZiB0cnVlLCB3aWxsIGluY2x1ZGUgc2NyaXB0cyBwYXNzZWQgaW4gdGhlIGh0bWwgc3RyaW5nCglqUXVlcnkucGFyc2VIVE1MID0gZnVuY3Rpb24oIGRhdGEsIGNvbnRleHQsIGtlZXBTY3JpcHRzICkgewoJCWlmICggIWRhdGEgfHwgdHlwZW9mIGRhdGEgIT09ICJzdHJpbmciICkgewoJCQlyZXR1cm4gbnVsbDsKCQl9CgkJaWYgKCB0eXBlb2YgY29udGV4dCA9PT0gImJvb2xlYW4iICkgewoJCQlrZWVwU2NyaXB0cyA9IGNvbnRleHQ7CgkJCWNvbnRleHQgPSBmYWxzZTsKCQl9CgkJY29udGV4dCA9IGNvbnRleHQgfHwgZG9jdW1lbnQ7CgoJCXZhciBwYXJzZWQgPSByc2luZ2xlVGFnLmV4ZWMoIGRhdGEgKSwKCQkJc2NyaXB0cyA9ICFrZWVwU2NyaXB0cyAmJiBbXTsKCgkJLy8gU2luZ2xlIHRhZwoJCWlmICggcGFyc2VkICkgewoJCQlyZXR1cm4gWyBjb250ZXh0LmNyZWF0ZUVsZW1lbnQoIHBhcnNlZFsxXSApIF07CgkJfQoKCQlwYXJzZWQgPSBqUXVlcnkuYnVpbGRGcmFnbWVudCggWyBkYXRhIF0sIGNvbnRleHQsIHNjcmlwdHMgKTsKCgkJaWYgKCBzY3JpcHRzICYmIHNjcmlwdHMubGVuZ3RoICkgewoJCQlqUXVlcnkoIHNjcmlwdHMgKS5yZW1vdmUoKTsKCQl9CgoJCXJldHVybiBqUXVlcnkubWVyZ2UoIFtdLCBwYXJzZWQuY2hpbGROb2RlcyApOwoJfTsKCgoJLy8gS2VlcCBhIGNvcHkgb2YgdGhlIG9sZCBsb2FkIG1ldGhvZAoJdmFyIF9sb2FkID0galF1ZXJ5LmZuLmxvYWQ7CgoJLyoqCgkgKiBMb2FkIGEgdXJsIGludG8gYSBwYWdlCgkgKi8KCWpRdWVyeS5mbi5sb2FkID0gZnVuY3Rpb24oIHVybCwgcGFyYW1zLCBjYWxsYmFjayApIHsKCQlpZiAoIHR5cGVvZiB1cmwgIT09ICJzdHJpbmciICYmIF9sb2FkICkgewoJCQlyZXR1cm4gX2xvYWQuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOwoJCX0KCgkJdmFyIHNlbGVjdG9yLCByZXNwb25zZSwgdHlwZSwKCQkJc2VsZiA9IHRoaXMsCgkJCW9mZiA9IHVybC5pbmRleE9mKCIgIik7CgoJCWlmICggb2ZmID49IDAgKSB7CgkJCXNlbGVjdG9yID0galF1ZXJ5LnRyaW0oIHVybC5zbGljZSggb2ZmLCB1cmwubGVuZ3RoICkgKTsKCQkJdXJsID0gdXJsLnNsaWNlKCAwLCBvZmYgKTsKCQl9CgoJCS8vIElmIGl0J3MgYSBmdW5jdGlvbgoJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHBhcmFtcyApICkgewoKCQkJLy8gV2UgYXNzdW1lIHRoYXQgaXQncyB0aGUgY2FsbGJhY2sKCQkJY2FsbGJhY2sgPSBwYXJhbXM7CgkJCXBhcmFtcyA9IHVuZGVmaW5lZDsKCgkJLy8gT3RoZXJ3aXNlLCBidWlsZCBhIHBhcmFtIHN0cmluZwoJCX0gZWxzZSBpZiAoIHBhcmFtcyAmJiB0eXBlb2YgcGFyYW1zID09PSAib2JqZWN0IiApIHsKCQkJdHlwZSA9ICJQT1NUIjsKCQl9CgoJCS8vIElmIHdlIGhhdmUgZWxlbWVudHMgdG8gbW9kaWZ5LCBtYWtlIHRoZSByZXF1ZXN0CgkJaWYgKCBzZWxmLmxlbmd0aCA+IDAgKSB7CgkJCWpRdWVyeS5hamF4KHsKCQkJCXVybDogdXJsLAoKCQkJCS8vIGlmICJ0eXBlIiB2YXJpYWJsZSBpcyB1bmRlZmluZWQsIHRoZW4gIkdFVCIgbWV0aG9kIHdpbGwgYmUgdXNlZAoJCQkJdHlwZTogdHlwZSwKCQkJCWRhdGFUeXBlOiAiaHRtbCIsCgkJCQlkYXRhOiBwYXJhbXMKCQkJfSkuZG9uZShmdW5jdGlvbiggcmVzcG9uc2VUZXh0ICkgewoKCQkJCS8vIFNhdmUgcmVzcG9uc2UgZm9yIHVzZSBpbiBjb21wbGV0ZSBjYWxsYmFjawoJCQkJcmVzcG9uc2UgPSBhcmd1bWVudHM7CgoJCQkJc2VsZi5odG1sKCBzZWxlY3RvciA/CgoJCQkJCS8vIElmIGEgc2VsZWN0b3Igd2FzIHNwZWNpZmllZCwgbG9jYXRlIHRoZSByaWdodCBlbGVtZW50cyBpbiBhIGR1bW15IGRpdgoJCQkJCS8vIEV4Y2x1ZGUgc2NyaXB0cyB0byBhdm9pZCBJRSAnUGVybWlzc2lvbiBEZW5pZWQnIGVycm9ycwoJCQkJCWpRdWVyeSgiPGRpdj4iKS5hcHBlbmQoIGpRdWVyeS5wYXJzZUhUTUwoIHJlc3BvbnNlVGV4dCApICkuZmluZCggc2VsZWN0b3IgKSA6CgoJCQkJCS8vIE90aGVyd2lzZSB1c2UgdGhlIGZ1bGwgcmVzdWx0CgkJCQkJcmVzcG9uc2VUZXh0ICk7CgoJCQl9KS5jb21wbGV0ZSggY2FsbGJhY2sgJiYgZnVuY3Rpb24oIGpxWEhSLCBzdGF0dXMgKSB7CgkJCQlzZWxmLmVhY2goIGNhbGxiYWNrLCByZXNwb25zZSB8fCBbIGpxWEhSLnJlc3BvbnNlVGV4dCwgc3RhdHVzLCBqcVhIUiBdICk7CgkJCX0pOwoJCX0KCgkJcmV0dXJuIHRoaXM7Cgl9OwoKCgoKCS8vIEF0dGFjaCBhIGJ1bmNoIG9mIGZ1bmN0aW9ucyBmb3IgaGFuZGxpbmcgY29tbW9uIEFKQVggZXZlbnRzCglqUXVlcnkuZWFjaCggWyAiYWpheFN0YXJ0IiwgImFqYXhTdG9wIiwgImFqYXhDb21wbGV0ZSIsICJhamF4RXJyb3IiLCAiYWpheFN1Y2Nlc3MiLCAiYWpheFNlbmQiIF0sIGZ1bmN0aW9uKCBpLCB0eXBlICkgewoJCWpRdWVyeS5mblsgdHlwZSBdID0gZnVuY3Rpb24oIGZuICkgewoJCQlyZXR1cm4gdGhpcy5vbiggdHlwZSwgZm4gKTsKCQl9OwoJfSk7CgoKCgoJalF1ZXJ5LmV4cHIuZmlsdGVycy5hbmltYXRlZCA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCXJldHVybiBqUXVlcnkuZ3JlcChqUXVlcnkudGltZXJzLCBmdW5jdGlvbiggZm4gKSB7CgkJCXJldHVybiBlbGVtID09PSBmbi5lbGVtOwoJCX0pLmxlbmd0aDsKCX07CgoKCgoKCXZhciBkb2NFbGVtID0gd2luZG93LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCgkvKioKCSAqIEdldHMgYSB3aW5kb3cgZnJvbSBhbiBlbGVtZW50CgkgKi8KCWZ1bmN0aW9uIGdldFdpbmRvdyggZWxlbSApIHsKCQlyZXR1cm4galF1ZXJ5LmlzV2luZG93KCBlbGVtICkgPwoJCQllbGVtIDoKCQkJZWxlbS5ub2RlVHlwZSA9PT0gOSA/CgkJCQllbGVtLmRlZmF1bHRWaWV3IHx8IGVsZW0ucGFyZW50V2luZG93IDoKCQkJCWZhbHNlOwoJfQoKCWpRdWVyeS5vZmZzZXQgPSB7CgkJc2V0T2Zmc2V0OiBmdW5jdGlvbiggZWxlbSwgb3B0aW9ucywgaSApIHsKCQkJdmFyIGN1clBvc2l0aW9uLCBjdXJMZWZ0LCBjdXJDU1NUb3AsIGN1clRvcCwgY3VyT2Zmc2V0LCBjdXJDU1NMZWZ0LCBjYWxjdWxhdGVQb3NpdGlvbiwKCQkJCXBvc2l0aW9uID0galF1ZXJ5LmNzcyggZWxlbSwgInBvc2l0aW9uIiApLAoJCQkJY3VyRWxlbSA9IGpRdWVyeSggZWxlbSApLAoJCQkJcHJvcHMgPSB7fTsKCgkJCS8vIHNldCBwb3NpdGlvbiBmaXJzdCwgaW4tY2FzZSB0b3AvbGVmdCBhcmUgc2V0IGV2ZW4gb24gc3RhdGljIGVsZW0KCQkJaWYgKCBwb3NpdGlvbiA9PT0gInN0YXRpYyIgKSB7CgkJCQllbGVtLnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZlIjsKCQkJfQoKCQkJY3VyT2Zmc2V0ID0gY3VyRWxlbS5vZmZzZXQoKTsKCQkJY3VyQ1NTVG9wID0galF1ZXJ5LmNzcyggZWxlbSwgInRvcCIgKTsKCQkJY3VyQ1NTTGVmdCA9IGpRdWVyeS5jc3MoIGVsZW0sICJsZWZ0IiApOwoJCQljYWxjdWxhdGVQb3NpdGlvbiA9ICggcG9zaXRpb24gPT09ICJhYnNvbHV0ZSIgfHwgcG9zaXRpb24gPT09ICJmaXhlZCIgKSAmJgoJCQkJalF1ZXJ5LmluQXJyYXkoImF1dG8iLCBbIGN1ckNTU1RvcCwgY3VyQ1NTTGVmdCBdICkgPiAtMTsKCgkJCS8vIG5lZWQgdG8gYmUgYWJsZSB0byBjYWxjdWxhdGUgcG9zaXRpb24gaWYgZWl0aGVyIHRvcCBvciBsZWZ0IGlzIGF1dG8gYW5kIHBvc2l0aW9uIGlzIGVpdGhlciBhYnNvbHV0ZSBvciBmaXhlZAoJCQlpZiAoIGNhbGN1bGF0ZVBvc2l0aW9uICkgewoJCQkJY3VyUG9zaXRpb24gPSBjdXJFbGVtLnBvc2l0aW9uKCk7CgkJCQljdXJUb3AgPSBjdXJQb3NpdGlvbi50b3A7CgkJCQljdXJMZWZ0ID0gY3VyUG9zaXRpb24ubGVmdDsKCQkJfSBlbHNlIHsKCQkJCWN1clRvcCA9IHBhcnNlRmxvYXQoIGN1ckNTU1RvcCApIHx8IDA7CgkJCQljdXJMZWZ0ID0gcGFyc2VGbG9hdCggY3VyQ1NTTGVmdCApIHx8IDA7CgkJCX0KCgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIG9wdGlvbnMgKSApIHsKCQkJCW9wdGlvbnMgPSBvcHRpb25zLmNhbGwoIGVsZW0sIGksIGN1ck9mZnNldCApOwoJCQl9CgoJCQlpZiAoIG9wdGlvbnMudG9wICE9IG51bGwgKSB7CgkJCQlwcm9wcy50b3AgPSAoIG9wdGlvbnMudG9wIC0gY3VyT2Zmc2V0LnRvcCApICsgY3VyVG9wOwoJCQl9CgkJCWlmICggb3B0aW9ucy5sZWZ0ICE9IG51bGwgKSB7CgkJCQlwcm9wcy5sZWZ0ID0gKCBvcHRpb25zLmxlZnQgLSBjdXJPZmZzZXQubGVmdCApICsgY3VyTGVmdDsKCQkJfQoKCQkJaWYgKCAidXNpbmciIGluIG9wdGlvbnMgKSB7CgkJCQlvcHRpb25zLnVzaW5nLmNhbGwoIGVsZW0sIHByb3BzICk7CgkJCX0gZWxzZSB7CgkJCQljdXJFbGVtLmNzcyggcHJvcHMgKTsKCQkJfQoJCX0KCX07CgoJalF1ZXJ5LmZuLmV4dGVuZCh7CgkJb2Zmc2V0OiBmdW5jdGlvbiggb3B0aW9ucyApIHsKCQkJaWYgKCBhcmd1bWVudHMubGVuZ3RoICkgewoJCQkJcmV0dXJuIG9wdGlvbnMgPT09IHVuZGVmaW5lZCA/CgkJCQkJdGhpcyA6CgkJCQkJdGhpcy5lYWNoKGZ1bmN0aW9uKCBpICkgewoJCQkJCQlqUXVlcnkub2Zmc2V0LnNldE9mZnNldCggdGhpcywgb3B0aW9ucywgaSApOwoJCQkJCX0pOwoJCQl9CgoJCQl2YXIgZG9jRWxlbSwgd2luLAoJCQkJYm94ID0geyB0b3A6IDAsIGxlZnQ6IDAgfSwKCQkJCWVsZW0gPSB0aGlzWyAwIF0sCgkJCQlkb2MgPSBlbGVtICYmIGVsZW0ub3duZXJEb2N1bWVudDsKCgkJCWlmICggIWRvYyApIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJZG9jRWxlbSA9IGRvYy5kb2N1bWVudEVsZW1lbnQ7CgoJCQkvLyBNYWtlIHN1cmUgaXQncyBub3QgYSBkaXNjb25uZWN0ZWQgRE9NIG5vZGUKCQkJaWYgKCAhalF1ZXJ5LmNvbnRhaW5zKCBkb2NFbGVtLCBlbGVtICkgKSB7CgkJCQlyZXR1cm4gYm94OwoJCQl9CgoJCQkvLyBJZiB3ZSBkb24ndCBoYXZlIGdCQ1IsIGp1c3QgdXNlIDAsMCByYXRoZXIgdGhhbiBlcnJvcgoJCQkvLyBCbGFja0JlcnJ5IDUsIGlPUyAzIChvcmlnaW5hbCBpUGhvbmUpCgkJCWlmICggdHlwZW9mIGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0ICE9PSBzdHJ1bmRlZmluZWQgKSB7CgkJCQlib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwoJCQl9CgkJCXdpbiA9IGdldFdpbmRvdyggZG9jICk7CgkJCXJldHVybiB7CgkJCQl0b3A6IGJveC50b3AgICsgKCB3aW4ucGFnZVlPZmZzZXQgfHwgZG9jRWxlbS5zY3JvbGxUb3AgKSAgLSAoIGRvY0VsZW0uY2xpZW50VG9wICB8fCAwICksCgkJCQlsZWZ0OiBib3gubGVmdCArICggd2luLnBhZ2VYT2Zmc2V0IHx8IGRvY0VsZW0uc2Nyb2xsTGVmdCApIC0gKCBkb2NFbGVtLmNsaWVudExlZnQgfHwgMCApCgkJCX07CgkJfSwKCgkJcG9zaXRpb246IGZ1bmN0aW9uKCkgewoJCQlpZiAoICF0aGlzWyAwIF0gKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCXZhciBvZmZzZXRQYXJlbnQsIG9mZnNldCwKCQkJCXBhcmVudE9mZnNldCA9IHsgdG9wOiAwLCBsZWZ0OiAwIH0sCgkJCQllbGVtID0gdGhpc1sgMCBdOwoKCQkJLy8gZml4ZWQgZWxlbWVudHMgYXJlIG9mZnNldCBmcm9tIHdpbmRvdyAocGFyZW50T2Zmc2V0ID0ge3RvcDowLCBsZWZ0OiAwfSwgYmVjYXVzZSBpdCBpcyBpdHMgb25seSBvZmZzZXQgcGFyZW50CgkJCWlmICggalF1ZXJ5LmNzcyggZWxlbSwgInBvc2l0aW9uIiApID09PSAiZml4ZWQiICkgewoJCQkJLy8gd2UgYXNzdW1lIHRoYXQgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGlzIGF2YWlsYWJsZSB3aGVuIGNvbXB1dGVkIHBvc2l0aW9uIGlzIGZpeGVkCgkJCQlvZmZzZXQgPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwoJCQl9IGVsc2UgewoJCQkJLy8gR2V0ICpyZWFsKiBvZmZzZXRQYXJlbnQKCQkJCW9mZnNldFBhcmVudCA9IHRoaXMub2Zmc2V0UGFyZW50KCk7CgoJCQkJLy8gR2V0IGNvcnJlY3Qgb2Zmc2V0cwoJCQkJb2Zmc2V0ID0gdGhpcy5vZmZzZXQoKTsKCQkJCWlmICggIWpRdWVyeS5ub2RlTmFtZSggb2Zmc2V0UGFyZW50WyAwIF0sICJodG1sIiApICkgewoJCQkJCXBhcmVudE9mZnNldCA9IG9mZnNldFBhcmVudC5vZmZzZXQoKTsKCQkJCX0KCgkJCQkvLyBBZGQgb2Zmc2V0UGFyZW50IGJvcmRlcnMKCQkJCXBhcmVudE9mZnNldC50b3AgICs9IGpRdWVyeS5jc3MoIG9mZnNldFBhcmVudFsgMCBdLCAiYm9yZGVyVG9wV2lkdGgiLCB0cnVlICk7CgkJCQlwYXJlbnRPZmZzZXQubGVmdCArPSBqUXVlcnkuY3NzKCBvZmZzZXRQYXJlbnRbIDAgXSwgImJvcmRlckxlZnRXaWR0aCIsIHRydWUgKTsKCQkJfQoKCQkJLy8gU3VidHJhY3QgcGFyZW50IG9mZnNldHMgYW5kIGVsZW1lbnQgbWFyZ2lucwoJCQkvLyBub3RlOiB3aGVuIGFuIGVsZW1lbnQgaGFzIG1hcmdpbjogYXV0byB0aGUgb2Zmc2V0TGVmdCBhbmQgbWFyZ2luTGVmdAoJCQkvLyBhcmUgdGhlIHNhbWUgaW4gU2FmYXJpIGNhdXNpbmcgb2Zmc2V0LmxlZnQgdG8gaW5jb3JyZWN0bHkgYmUgMAoJCQlyZXR1cm4gewoJCQkJdG9wOiAgb2Zmc2V0LnRvcCAgLSBwYXJlbnRPZmZzZXQudG9wIC0galF1ZXJ5LmNzcyggZWxlbSwgIm1hcmdpblRvcCIsIHRydWUgKSwKCQkJCWxlZnQ6IG9mZnNldC5sZWZ0IC0gcGFyZW50T2Zmc2V0LmxlZnQgLSBqUXVlcnkuY3NzKCBlbGVtLCAibWFyZ2luTGVmdCIsIHRydWUpCgkJCX07CgkJfSwKCgkJb2Zmc2V0UGFyZW50OiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCkgewoJCQkJdmFyIG9mZnNldFBhcmVudCA9IHRoaXMub2Zmc2V0UGFyZW50IHx8IGRvY0VsZW07CgoJCQkJd2hpbGUgKCBvZmZzZXRQYXJlbnQgJiYgKCAhalF1ZXJ5Lm5vZGVOYW1lKCBvZmZzZXRQYXJlbnQsICJodG1sIiApICYmIGpRdWVyeS5jc3MoIG9mZnNldFBhcmVudCwgInBvc2l0aW9uIiApID09PSAic3RhdGljIiApICkgewoJCQkJCW9mZnNldFBhcmVudCA9IG9mZnNldFBhcmVudC5vZmZzZXRQYXJlbnQ7CgkJCQl9CgkJCQlyZXR1cm4gb2Zmc2V0UGFyZW50IHx8IGRvY0VsZW07CgkJCX0pOwoJCX0KCX0pOwoKCS8vIENyZWF0ZSBzY3JvbGxMZWZ0IGFuZCBzY3JvbGxUb3AgbWV0aG9kcwoJalF1ZXJ5LmVhY2goIHsgc2Nyb2xsTGVmdDogInBhZ2VYT2Zmc2V0Iiwgc2Nyb2xsVG9wOiAicGFnZVlPZmZzZXQiIH0sIGZ1bmN0aW9uKCBtZXRob2QsIHByb3AgKSB7CgkJdmFyIHRvcCA9IC9ZLy50ZXN0KCBwcm9wICk7CgoJCWpRdWVyeS5mblsgbWV0aG9kIF0gPSBmdW5jdGlvbiggdmFsICkgewoJCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggZWxlbSwgbWV0aG9kLCB2YWwgKSB7CgkJCQl2YXIgd2luID0gZ2V0V2luZG93KCBlbGVtICk7CgoJCQkJaWYgKCB2YWwgPT09IHVuZGVmaW5lZCApIHsKCQkJCQlyZXR1cm4gd2luID8gKHByb3AgaW4gd2luKSA/IHdpblsgcHJvcCBdIDoKCQkJCQkJd2luLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFsgbWV0aG9kIF0gOgoJCQkJCQllbGVtWyBtZXRob2QgXTsKCQkJCX0KCgkJCQlpZiAoIHdpbiApIHsKCQkJCQl3aW4uc2Nyb2xsVG8oCgkJCQkJCSF0b3AgPyB2YWwgOiBqUXVlcnkoIHdpbiApLnNjcm9sbExlZnQoKSwKCQkJCQkJdG9wID8gdmFsIDogalF1ZXJ5KCB3aW4gKS5zY3JvbGxUb3AoKQoJCQkJCSk7CgoJCQkJfSBlbHNlIHsKCQkJCQllbGVtWyBtZXRob2QgXSA9IHZhbDsKCQkJCX0KCQkJfSwgbWV0aG9kLCB2YWwsIGFyZ3VtZW50cy5sZW5ndGgsIG51bGwgKTsKCQl9OwoJfSk7CgoJLy8gQWRkIHRoZSB0b3AvbGVmdCBjc3NIb29rcyB1c2luZyBqUXVlcnkuZm4ucG9zaXRpb24KCS8vIFdlYmtpdCBidWc6IGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0yOTA4NAoJLy8gZ2V0Q29tcHV0ZWRTdHlsZSByZXR1cm5zIHBlcmNlbnQgd2hlbiBzcGVjaWZpZWQgZm9yIHRvcC9sZWZ0L2JvdHRvbS9yaWdodAoJLy8gcmF0aGVyIHRoYW4gbWFrZSB0aGUgY3NzIG1vZHVsZSBkZXBlbmQgb24gdGhlIG9mZnNldCBtb2R1bGUsIHdlIGp1c3QgY2hlY2sgZm9yIGl0IGhlcmUKCWpRdWVyeS5lYWNoKCBbICJ0b3AiLCAibGVmdCIgXSwgZnVuY3Rpb24oIGksIHByb3AgKSB7CgkJalF1ZXJ5LmNzc0hvb2tzWyBwcm9wIF0gPSBhZGRHZXRIb29rSWYoIHN1cHBvcnQucGl4ZWxQb3NpdGlvbiwKCQkJZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkICkgewoJCQkJaWYgKCBjb21wdXRlZCApIHsKCQkJCQljb21wdXRlZCA9IGN1ckNTUyggZWxlbSwgcHJvcCApOwoJCQkJCS8vIGlmIGN1ckNTUyByZXR1cm5zIHBlcmNlbnRhZ2UsIGZhbGxiYWNrIHRvIG9mZnNldAoJCQkJCXJldHVybiBybnVtbm9ucHgudGVzdCggY29tcHV0ZWQgKSA/CgkJCQkJCWpRdWVyeSggZWxlbSApLnBvc2l0aW9uKClbIHByb3AgXSArICJweCIgOgoJCQkJCQljb21wdXRlZDsKCQkJCX0KCQkJfQoJCSk7Cgl9KTsKCgoJLy8gQ3JlYXRlIGlubmVySGVpZ2h0LCBpbm5lcldpZHRoLCBoZWlnaHQsIHdpZHRoLCBvdXRlckhlaWdodCBhbmQgb3V0ZXJXaWR0aCBtZXRob2RzCglqUXVlcnkuZWFjaCggeyBIZWlnaHQ6ICJoZWlnaHQiLCBXaWR0aDogIndpZHRoIiB9LCBmdW5jdGlvbiggbmFtZSwgdHlwZSApIHsKCQlqUXVlcnkuZWFjaCggeyBwYWRkaW5nOiAiaW5uZXIiICsgbmFtZSwgY29udGVudDogdHlwZSwgIiI6ICJvdXRlciIgKyBuYW1lIH0sIGZ1bmN0aW9uKCBkZWZhdWx0RXh0cmEsIGZ1bmNOYW1lICkgewoJCQkvLyBtYXJnaW4gaXMgb25seSBmb3Igb3V0ZXJIZWlnaHQsIG91dGVyV2lkdGgKCQkJalF1ZXJ5LmZuWyBmdW5jTmFtZSBdID0gZnVuY3Rpb24oIG1hcmdpbiwgdmFsdWUgKSB7CgkJCQl2YXIgY2hhaW5hYmxlID0gYXJndW1lbnRzLmxlbmd0aCAmJiAoIGRlZmF1bHRFeHRyYSB8fCB0eXBlb2YgbWFyZ2luICE9PSAiYm9vbGVhbiIgKSwKCQkJCQlleHRyYSA9IGRlZmF1bHRFeHRyYSB8fCAoIG1hcmdpbiA9PT0gdHJ1ZSB8fCB2YWx1ZSA9PT0gdHJ1ZSA/ICJtYXJnaW4iIDogImJvcmRlciIgKTsKCgkJCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggZWxlbSwgdHlwZSwgdmFsdWUgKSB7CgkJCQkJdmFyIGRvYzsKCgkJCQkJaWYgKCBqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSApIHsKCQkJCQkJLy8gQXMgb2YgNS84LzIwMTIgdGhpcyB3aWxsIHlpZWxkIGluY29ycmVjdCByZXN1bHRzIGZvciBNb2JpbGUgU2FmYXJpLCBidXQgdGhlcmUKCQkJCQkJLy8gaXNuJ3QgYSB3aG9sZSBsb3Qgd2UgY2FuIGRvLiBTZWUgcHVsbCByZXF1ZXN0IGF0IHRoaXMgVVJMIGZvciBkaXNjdXNzaW9uOgoJCQkJCQkvLyBodHRwczovL2dpdGh1Yi5jb20vanF1ZXJ5L2pxdWVyeS9wdWxsLzc2NAoJCQkJCQlyZXR1cm4gZWxlbS5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbICJjbGllbnQiICsgbmFtZSBdOwoJCQkJCX0KCgkJCQkJLy8gR2V0IGRvY3VtZW50IHdpZHRoIG9yIGhlaWdodAoJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gOSApIHsKCQkJCQkJZG9jID0gZWxlbS5kb2N1bWVudEVsZW1lbnQ7CgoJCQkJCQkvLyBFaXRoZXIgc2Nyb2xsW1dpZHRoL0hlaWdodF0gb3Igb2Zmc2V0W1dpZHRoL0hlaWdodF0gb3IgY2xpZW50W1dpZHRoL0hlaWdodF0sIHdoaWNoZXZlciBpcyBncmVhdGVzdAoJCQkJCQkvLyB1bmZvcnR1bmF0ZWx5LCB0aGlzIGNhdXNlcyBidWcgIzM4MzggaW4gSUU2Lzggb25seSwgYnV0IHRoZXJlIGlzIGN1cnJlbnRseSBubyBnb29kLCBzbWFsbCB3YXkgdG8gZml4IGl0LgoJCQkJCQlyZXR1cm4gTWF0aC5tYXgoCgkJCQkJCQllbGVtLmJvZHlbICJzY3JvbGwiICsgbmFtZSBdLCBkb2NbICJzY3JvbGwiICsgbmFtZSBdLAoJCQkJCQkJZWxlbS5ib2R5WyAib2Zmc2V0IiArIG5hbWUgXSwgZG9jWyAib2Zmc2V0IiArIG5hbWUgXSwKCQkJCQkJCWRvY1sgImNsaWVudCIgKyBuYW1lIF0KCQkJCQkJKTsKCQkJCQl9CgoJCQkJCXJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkID8KCQkJCQkJLy8gR2V0IHdpZHRoIG9yIGhlaWdodCBvbiB0aGUgZWxlbWVudCwgcmVxdWVzdGluZyBidXQgbm90IGZvcmNpbmcgcGFyc2VGbG9hdAoJCQkJCQlqUXVlcnkuY3NzKCBlbGVtLCB0eXBlLCBleHRyYSApIDoKCgkJCQkJCS8vIFNldCB3aWR0aCBvciBoZWlnaHQgb24gdGhlIGVsZW1lbnQKCQkJCQkJalF1ZXJ5LnN0eWxlKCBlbGVtLCB0eXBlLCB2YWx1ZSwgZXh0cmEgKTsKCQkJCX0sIHR5cGUsIGNoYWluYWJsZSA/IG1hcmdpbiA6IHVuZGVmaW5lZCwgY2hhaW5hYmxlLCBudWxsICk7CgkJCX07CgkJfSk7Cgl9KTsKCgoJLy8gVGhlIG51bWJlciBvZiBlbGVtZW50cyBjb250YWluZWQgaW4gdGhlIG1hdGNoZWQgZWxlbWVudCBzZXQKCWpRdWVyeS5mbi5zaXplID0gZnVuY3Rpb24oKSB7CgkJcmV0dXJuIHRoaXMubGVuZ3RoOwoJfTsKCglqUXVlcnkuZm4uYW5kU2VsZiA9IGpRdWVyeS5mbi5hZGRCYWNrOwoKCgoKCS8vIFJlZ2lzdGVyIGFzIGEgbmFtZWQgQU1EIG1vZHVsZSwgc2luY2UgalF1ZXJ5IGNhbiBiZSBjb25jYXRlbmF0ZWQgd2l0aCBvdGhlcgoJLy8gZmlsZXMgdGhhdCBtYXkgdXNlIGRlZmluZSwgYnV0IG5vdCB2aWEgYSBwcm9wZXIgY29uY2F0ZW5hdGlvbiBzY3JpcHQgdGhhdAoJLy8gdW5kZXJzdGFuZHMgYW5vbnltb3VzIEFNRCBtb2R1bGVzLiBBIG5hbWVkIEFNRCBpcyBzYWZlc3QgYW5kIG1vc3Qgcm9idXN0CgkvLyB3YXkgdG8gcmVnaXN0ZXIuIExvd2VyY2FzZSBqcXVlcnkgaXMgdXNlZCBiZWNhdXNlIEFNRCBtb2R1bGUgbmFtZXMgYXJlCgkvLyBkZXJpdmVkIGZyb20gZmlsZSBuYW1lcywgYW5kIGpRdWVyeSBpcyBub3JtYWxseSBkZWxpdmVyZWQgaW4gYSBsb3dlcmNhc2UKCS8vIGZpbGUgbmFtZS4gRG8gdGhpcyBhZnRlciBjcmVhdGluZyB0aGUgZ2xvYmFsIHNvIHRoYXQgaWYgYW4gQU1EIG1vZHVsZSB3YW50cwoJLy8gdG8gY2FsbCBub0NvbmZsaWN0IHRvIGhpZGUgdGhpcyB2ZXJzaW9uIG9mIGpRdWVyeSwgaXQgd2lsbCB3b3JrLgoKCS8vIE5vdGUgdGhhdCBmb3IgbWF4aW11bSBwb3J0YWJpbGl0eSwgbGlicmFyaWVzIHRoYXQgYXJlIG5vdCBqUXVlcnkgc2hvdWxkCgkvLyBkZWNsYXJlIHRoZW1zZWx2ZXMgYXMgYW5vbnltb3VzIG1vZHVsZXMsIGFuZCBhdm9pZCBzZXR0aW5nIGEgZ2xvYmFsIGlmIGFuCgkvLyBBTUQgbG9hZGVyIGlzIHByZXNlbnQuIGpRdWVyeSBpcyBhIHNwZWNpYWwgY2FzZS4gRm9yIG1vcmUgaW5mb3JtYXRpb24sIHNlZQoJLy8gaHR0cHM6Ly9naXRodWIuY29tL2pyYnVya2UvcmVxdWlyZWpzL3dpa2kvVXBkYXRpbmctZXhpc3RpbmctbGlicmFyaWVzI3dpa2ktYW5vbgoKCWlmICggdHJ1ZSApIHsKCQkhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbXSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIGpRdWVyeTsKCQl9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7Cgl9CgoKCgoJdmFyCgkJLy8gTWFwIG92ZXIgalF1ZXJ5IGluIGNhc2Ugb2Ygb3ZlcndyaXRlCgkJX2pRdWVyeSA9IHdpbmRvdy5qUXVlcnksCgoJCS8vIE1hcCBvdmVyIHRoZSAkIGluIGNhc2Ugb2Ygb3ZlcndyaXRlCgkJXyQgPSB3aW5kb3cuJDsKCglqUXVlcnkubm9Db25mbGljdCA9IGZ1bmN0aW9uKCBkZWVwICkgewoJCWlmICggd2luZG93LiQgPT09IGpRdWVyeSApIHsKCQkJd2luZG93LiQgPSBfJDsKCQl9CgoJCWlmICggZGVlcCAmJiB3aW5kb3cualF1ZXJ5ID09PSBqUXVlcnkgKSB7CgkJCXdpbmRvdy5qUXVlcnkgPSBfalF1ZXJ5OwoJCX0KCgkJcmV0dXJuIGpRdWVyeTsKCX07CgoJLy8gRXhwb3NlIGpRdWVyeSBhbmQgJCBpZGVudGlmaWVycywgZXZlbiBpbgoJLy8gQU1EICgjNzEwMiNjb21tZW50OjEwLCBodHRwczovL2dpdGh1Yi5jb20vanF1ZXJ5L2pxdWVyeS9wdWxsLzU1NykKCS8vIGFuZCBDb21tb25KUyBmb3IgYnJvd3NlciBlbXVsYXRvcnMgKCMxMzU2NikKCWlmICggdHlwZW9mIG5vR2xvYmFsID09PSBzdHJ1bmRlZmluZWQgKSB7CgkJd2luZG93LmpRdWVyeSA9IHdpbmRvdy4kID0galF1ZXJ5OwoJfQoKCgoKCXJldHVybiBqUXVlcnk7CgoJfSkpOwoKCi8qKiovIH0sCi8qIDUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyoqIQoKCSBAbGljZW5zZQoJIGhhbmRsZWJhcnMgdjQuMC42CgoJQ29weXJpZ2h0IChDKSAyMDExLTIwMTYgYnkgWWVodWRhIEthdHoKCglQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5CglvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbAoJaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cwoJdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbAoJY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCglmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgoKCVRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCglhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCglUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgoJSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCglGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUKCUFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKCUxJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sCglPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOCglUSEUgU09GVFdBUkUuCgoJKi8KCS8qKiEKCgkgQGxpY2Vuc2UKCSBoYW5kbGViYXJzIHY0LjAuNgoKCUNvcHlyaWdodCAoQykgMjAxMS0yMDE2IGJ5IFllaHVkYSBLYXR6CgoJUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weQoJb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksIHRvIGRlYWwKCWluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMKCXRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwKCWNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcwoJZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKCglUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgoJYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgoJVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKCUlNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAoJRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFCglBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCglMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLAoJT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTgoJVEhFIFNPRlRXQVJFLgoKCSovCgkvKiohCgoJIEBsaWNlbnNlCgkgaGFuZGxlYmFycyB2NC4wLjYKCglDb3B5cmlnaHQgKEMpIDIwMTEtMjAxNiBieSBZZWh1ZGEgS2F0egoKCVBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKCW9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLCB0byBkZWFsCglpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzCgl0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCgljb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMKCWZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CgoJVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KCWFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgoKCVRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCglJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKCUZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRQoJQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUgoJTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKCU9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4KCVRIRSBTT0ZUV0FSRS4KCgkqLwoJKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCQlpZih0cnVlKQoJCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCQllbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkKCQkJZGVmaW5lKFtdLCBmYWN0b3J5KTsKCQllbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JykKCQkJZXhwb3J0c1siSGFuZGxlYmFycyJdID0gZmFjdG9yeSgpOwoJCWVsc2UKCQkJcm9vdFsiSGFuZGxlYmFycyJdID0gZmFjdG9yeSgpOwoJfSkodGhpcywgZnVuY3Rpb24oKSB7CglyZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcAoJLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKCS8qKioqKiovIAl2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9OwoKCS8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgoJLyoqKioqKi8gCWZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHsKCgkvKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQoJLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKCS8qKioqKiovIAkJCXJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzOwoKCS8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKCS8qKioqKiovIAkJdmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0gewoJLyoqKioqKi8gCQkJZXhwb3J0czoge30sCgkvKioqKioqLyAJCQlpZDogbW9kdWxlSWQsCgkvKioqKioqLyAJCQlsb2FkZWQ6IGZhbHNlCgkvKioqKioqLyAJCX07CgoJLyoqKioqKi8gCQkvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb24KCS8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7CgoJLyoqKioqKi8gCQkvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkCgkvKioqKioqLyAJCW1vZHVsZS5sb2FkZWQgPSB0cnVlOwoKCS8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKCS8qKioqKiovIAkJcmV0dXJuIG1vZHVsZS5leHBvcnRzOwoJLyoqKioqKi8gCX0KCgoJLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlczsKCgkvKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGUKCS8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwoKCS8qKioqKiovIAkvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfXwoJLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ucCA9ICIiOwoKCS8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKCS8qKioqKiovIAlyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKCS8qKioqKiovIH0pCgkvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoJLyoqKioqKi8gKFsKCS8qIDAgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCQl2YXIgX2hhbmRsZWJhcnNSdW50aW1lID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTsKCgkJdmFyIF9oYW5kbGViYXJzUnVudGltZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYW5kbGViYXJzUnVudGltZSk7CgoJCS8vIENvbXBpbGVyIGltcG9ydHMKCgkJdmFyIF9oYW5kbGViYXJzQ29tcGlsZXJBc3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKCgkJdmFyIF9oYW5kbGViYXJzQ29tcGlsZXJBc3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGFuZGxlYmFyc0NvbXBpbGVyQXN0KTsKCgkJdmFyIF9oYW5kbGViYXJzQ29tcGlsZXJCYXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSk7CgoJCXZhciBfaGFuZGxlYmFyc0NvbXBpbGVyQ29tcGlsZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKTsKCgkJdmFyIF9oYW5kbGViYXJzQ29tcGlsZXJKYXZhc2NyaXB0Q29tcGlsZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCgkJdmFyIF9oYW5kbGViYXJzQ29tcGlsZXJKYXZhc2NyaXB0Q29tcGlsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGFuZGxlYmFyc0NvbXBpbGVySmF2YXNjcmlwdENvbXBpbGVyKTsKCgkJdmFyIF9oYW5kbGViYXJzQ29tcGlsZXJWaXNpdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCk7CgoJCXZhciBfaGFuZGxlYmFyc0NvbXBpbGVyVmlzaXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYW5kbGViYXJzQ29tcGlsZXJWaXNpdG9yKTsKCgkJdmFyIF9oYW5kbGViYXJzTm9Db25mbGljdCA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpOwoKCQl2YXIgX2hhbmRsZWJhcnNOb0NvbmZsaWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhbmRsZWJhcnNOb0NvbmZsaWN0KTsKCgkJdmFyIF9jcmVhdGUgPSBfaGFuZGxlYmFyc1J1bnRpbWUyWydkZWZhdWx0J10uY3JlYXRlOwoJCWZ1bmN0aW9uIGNyZWF0ZSgpIHsKCQkgIHZhciBoYiA9IF9jcmVhdGUoKTsKCgkJICBoYi5jb21waWxlID0gZnVuY3Rpb24gKGlucHV0LCBvcHRpb25zKSB7CgkJICAgIHJldHVybiBfaGFuZGxlYmFyc0NvbXBpbGVyQ29tcGlsZXIuY29tcGlsZShpbnB1dCwgb3B0aW9ucywgaGIpOwoJCSAgfTsKCQkgIGhiLnByZWNvbXBpbGUgPSBmdW5jdGlvbiAoaW5wdXQsIG9wdGlvbnMpIHsKCQkgICAgcmV0dXJuIF9oYW5kbGViYXJzQ29tcGlsZXJDb21waWxlci5wcmVjb21waWxlKGlucHV0LCBvcHRpb25zLCBoYik7CgkJICB9OwoKCQkgIGhiLkFTVCA9IF9oYW5kbGViYXJzQ29tcGlsZXJBc3QyWydkZWZhdWx0J107CgkJICBoYi5Db21waWxlciA9IF9oYW5kbGViYXJzQ29tcGlsZXJDb21waWxlci5Db21waWxlcjsKCQkgIGhiLkphdmFTY3JpcHRDb21waWxlciA9IF9oYW5kbGViYXJzQ29tcGlsZXJKYXZhc2NyaXB0Q29tcGlsZXIyWydkZWZhdWx0J107CgkJICBoYi5QYXJzZXIgPSBfaGFuZGxlYmFyc0NvbXBpbGVyQmFzZS5wYXJzZXI7CgkJICBoYi5wYXJzZSA9IF9oYW5kbGViYXJzQ29tcGlsZXJCYXNlLnBhcnNlOwoKCQkgIHJldHVybiBoYjsKCQl9CgoJCXZhciBpbnN0ID0gY3JlYXRlKCk7CgkJaW5zdC5jcmVhdGUgPSBjcmVhdGU7CgoJCV9oYW5kbGViYXJzTm9Db25mbGljdDJbJ2RlZmF1bHQnXShpbnN0KTsKCgkJaW5zdC5WaXNpdG9yID0gX2hhbmRsZWJhcnNDb21waWxlclZpc2l0b3IyWydkZWZhdWx0J107CgoJCWluc3RbJ2RlZmF1bHQnXSA9IGluc3Q7CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IGluc3Q7CgkJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSwKCS8qIDEgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCQkidXNlIHN0cmljdCI7CgoJCWV4cG9ydHNbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChvYmopIHsKCQkgIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7CgkJICAgICJkZWZhdWx0Ijogb2JqCgkJICB9OwoJCX07CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJLyoqKi8gfSwKCS8qIDIgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCXZhciBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCA9IF9fd2VicGFja19yZXF1aXJlX18oMylbJ2RlZmF1bHQnXTsKCgkJdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpWydkZWZhdWx0J107CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJCXZhciBfaGFuZGxlYmFyc0Jhc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpOwoKCQl2YXIgYmFzZSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9oYW5kbGViYXJzQmFzZSk7CgoJCS8vIEVhY2ggb2YgdGhlc2UgYXVnbWVudCB0aGUgSGFuZGxlYmFycyBvYmplY3QuIE5vIG5lZWQgdG8gc2V0dXAgaGVyZS4KCQkvLyAoVGhpcyBpcyBkb25lIHRvIGVhc2lseSBzaGFyZSBjb2RlIGJldHdlZW4gY29tbW9uanMgYW5kIGJyb3dzZSBlbnZzKQoKCQl2YXIgX2hhbmRsZWJhcnNTYWZlU3RyaW5nID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSk7CgoJCXZhciBfaGFuZGxlYmFyc1NhZmVTdHJpbmcyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGFuZGxlYmFyc1NhZmVTdHJpbmcpOwoKCQl2YXIgX2hhbmRsZWJhcnNFeGNlcHRpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwoKCQl2YXIgX2hhbmRsZWJhcnNFeGNlcHRpb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGFuZGxlYmFyc0V4Y2VwdGlvbik7CgoJCXZhciBfaGFuZGxlYmFyc1V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKCgkJdmFyIFV0aWxzID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX2hhbmRsZWJhcnNVdGlscyk7CgoJCXZhciBfaGFuZGxlYmFyc1J1bnRpbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKTsKCgkJdmFyIHJ1bnRpbWUgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfaGFuZGxlYmFyc1J1bnRpbWUpOwoKCQl2YXIgX2hhbmRsZWJhcnNOb0NvbmZsaWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMyk7CgoJCXZhciBfaGFuZGxlYmFyc05vQ29uZmxpY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGFuZGxlYmFyc05vQ29uZmxpY3QpOwoKCQkvLyBGb3IgY29tcGF0aWJpbGl0eSBhbmQgdXNhZ2Ugb3V0c2lkZSBvZiBtb2R1bGUgc3lzdGVtcywgbWFrZSB0aGUgSGFuZGxlYmFycyBvYmplY3QgYSBuYW1lc3BhY2UKCQlmdW5jdGlvbiBjcmVhdGUoKSB7CgkJICB2YXIgaGIgPSBuZXcgYmFzZS5IYW5kbGViYXJzRW52aXJvbm1lbnQoKTsKCgkJICBVdGlscy5leHRlbmQoaGIsIGJhc2UpOwoJCSAgaGIuU2FmZVN0cmluZyA9IF9oYW5kbGViYXJzU2FmZVN0cmluZzJbJ2RlZmF1bHQnXTsKCQkgIGhiLkV4Y2VwdGlvbiA9IF9oYW5kbGViYXJzRXhjZXB0aW9uMlsnZGVmYXVsdCddOwoJCSAgaGIuVXRpbHMgPSBVdGlsczsKCQkgIGhiLmVzY2FwZUV4cHJlc3Npb24gPSBVdGlscy5lc2NhcGVFeHByZXNzaW9uOwoKCQkgIGhiLlZNID0gcnVudGltZTsKCQkgIGhiLnRlbXBsYXRlID0gZnVuY3Rpb24gKHNwZWMpIHsKCQkgICAgcmV0dXJuIHJ1bnRpbWUudGVtcGxhdGUoc3BlYywgaGIpOwoJCSAgfTsKCgkJICByZXR1cm4gaGI7CgkJfQoKCQl2YXIgaW5zdCA9IGNyZWF0ZSgpOwoJCWluc3QuY3JlYXRlID0gY3JlYXRlOwoKCQlfaGFuZGxlYmFyc05vQ29uZmxpY3QyWydkZWZhdWx0J10oaW5zdCk7CgoJCWluc3RbJ2RlZmF1bHQnXSA9IGluc3Q7CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IGluc3Q7CgkJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSwKCS8qIDMgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCQkidXNlIHN0cmljdCI7CgoJCWV4cG9ydHNbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChvYmopIHsKCQkgIGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsKCQkgICAgcmV0dXJuIG9iajsKCQkgIH0gZWxzZSB7CgkJICAgIHZhciBuZXdPYmogPSB7fTsKCgkJICAgIGlmIChvYmogIT0gbnVsbCkgewoJCSAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKCQkgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOwoJCSAgICAgIH0KCQkgICAgfQoKCQkgICAgbmV3T2JqWyJkZWZhdWx0Il0gPSBvYmo7CgkJICAgIHJldHVybiBuZXdPYmo7CgkJICB9CgkJfTsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgkvKioqLyB9LAoJLyogNCAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCSd1c2Ugc3RyaWN0JzsKCgkJdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpWydkZWZhdWx0J107CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgkJZXhwb3J0cy5IYW5kbGViYXJzRW52aXJvbm1lbnQgPSBIYW5kbGViYXJzRW52aXJvbm1lbnQ7CgoJCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwoKCQl2YXIgX2V4Y2VwdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oNik7CgoJCXZhciBfZXhjZXB0aW9uMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4Y2VwdGlvbik7CgoJCXZhciBfaGVscGVycyA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKCQl2YXIgX2RlY29yYXRvcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTsKCgkJdmFyIF9sb2dnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKTsKCgkJdmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTsKCgkJdmFyIFZFUlNJT04gPSAnNC4wLjUnOwoJCWV4cG9ydHMuVkVSU0lPTiA9IFZFUlNJT047CgkJdmFyIENPTVBJTEVSX1JFVklTSU9OID0gNzsKCgkJZXhwb3J0cy5DT01QSUxFUl9SRVZJU0lPTiA9IENPTVBJTEVSX1JFVklTSU9OOwoJCXZhciBSRVZJU0lPTl9DSEFOR0VTID0gewoJCSAgMTogJzw9IDEuMC5yYy4yJywgLy8gMS4wLnJjLjIgaXMgYWN0dWFsbHkgcmV2MiBidXQgZG9lc24ndCByZXBvcnQgaXQKCQkgIDI6ICc9PSAxLjAuMC1yYy4zJywKCQkgIDM6ICc9PSAxLjAuMC1yYy40JywKCQkgIDQ6ICc9PSAxLngueCcsCgkJICA1OiAnPT0gMi4wLjAtYWxwaGEueCcsCgkJICA2OiAnPj0gMi4wLjAtYmV0YS4xJywKCQkgIDc6ICc+PSA0LjAuMCcKCQl9OwoKCQlleHBvcnRzLlJFVklTSU9OX0NIQU5HRVMgPSBSRVZJU0lPTl9DSEFOR0VTOwoJCXZhciBvYmplY3RUeXBlID0gJ1tvYmplY3QgT2JqZWN0XSc7CgoJCWZ1bmN0aW9uIEhhbmRsZWJhcnNFbnZpcm9ubWVudChoZWxwZXJzLCBwYXJ0aWFscywgZGVjb3JhdG9ycykgewoJCSAgdGhpcy5oZWxwZXJzID0gaGVscGVycyB8fCB7fTsKCQkgIHRoaXMucGFydGlhbHMgPSBwYXJ0aWFscyB8fCB7fTsKCQkgIHRoaXMuZGVjb3JhdG9ycyA9IGRlY29yYXRvcnMgfHwge307CgoJCSAgX2hlbHBlcnMucmVnaXN0ZXJEZWZhdWx0SGVscGVycyh0aGlzKTsKCQkgIF9kZWNvcmF0b3JzLnJlZ2lzdGVyRGVmYXVsdERlY29yYXRvcnModGhpcyk7CgkJfQoKCQlIYW5kbGViYXJzRW52aXJvbm1lbnQucHJvdG90eXBlID0gewoJCSAgY29uc3RydWN0b3I6IEhhbmRsZWJhcnNFbnZpcm9ubWVudCwKCgkJICBsb2dnZXI6IF9sb2dnZXIyWydkZWZhdWx0J10sCgkJICBsb2c6IF9sb2dnZXIyWydkZWZhdWx0J10ubG9nLAoKCQkgIHJlZ2lzdGVySGVscGVyOiBmdW5jdGlvbiByZWdpc3RlckhlbHBlcihuYW1lLCBmbikgewoJCSAgICBpZiAoX3V0aWxzLnRvU3RyaW5nLmNhbGwobmFtZSkgPT09IG9iamVjdFR5cGUpIHsKCQkgICAgICBpZiAoZm4pIHsKCQkgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdBcmcgbm90IHN1cHBvcnRlZCB3aXRoIG11bHRpcGxlIGhlbHBlcnMnKTsKCQkgICAgICB9CgkJICAgICAgX3V0aWxzLmV4dGVuZCh0aGlzLmhlbHBlcnMsIG5hbWUpOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHRoaXMuaGVscGVyc1tuYW1lXSA9IGZuOwoJCSAgICB9CgkJICB9LAoJCSAgdW5yZWdpc3RlckhlbHBlcjogZnVuY3Rpb24gdW5yZWdpc3RlckhlbHBlcihuYW1lKSB7CgkJICAgIGRlbGV0ZSB0aGlzLmhlbHBlcnNbbmFtZV07CgkJICB9LAoKCQkgIHJlZ2lzdGVyUGFydGlhbDogZnVuY3Rpb24gcmVnaXN0ZXJQYXJ0aWFsKG5hbWUsIHBhcnRpYWwpIHsKCQkgICAgaWYgKF91dGlscy50b1N0cmluZy5jYWxsKG5hbWUpID09PSBvYmplY3RUeXBlKSB7CgkJICAgICAgX3V0aWxzLmV4dGVuZCh0aGlzLnBhcnRpYWxzLCBuYW1lKTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICBpZiAodHlwZW9mIHBhcnRpYWwgPT09ICd1bmRlZmluZWQnKSB7CgkJICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnQXR0ZW1wdGluZyB0byByZWdpc3RlciBhIHBhcnRpYWwgY2FsbGVkICInICsgbmFtZSArICciIGFzIHVuZGVmaW5lZCcpOwoJCSAgICAgIH0KCQkgICAgICB0aGlzLnBhcnRpYWxzW25hbWVdID0gcGFydGlhbDsKCQkgICAgfQoJCSAgfSwKCQkgIHVucmVnaXN0ZXJQYXJ0aWFsOiBmdW5jdGlvbiB1bnJlZ2lzdGVyUGFydGlhbChuYW1lKSB7CgkJICAgIGRlbGV0ZSB0aGlzLnBhcnRpYWxzW25hbWVdOwoJCSAgfSwKCgkJICByZWdpc3RlckRlY29yYXRvcjogZnVuY3Rpb24gcmVnaXN0ZXJEZWNvcmF0b3IobmFtZSwgZm4pIHsKCQkgICAgaWYgKF91dGlscy50b1N0cmluZy5jYWxsKG5hbWUpID09PSBvYmplY3RUeXBlKSB7CgkJICAgICAgaWYgKGZuKSB7CgkJICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnQXJnIG5vdCBzdXBwb3J0ZWQgd2l0aCBtdWx0aXBsZSBkZWNvcmF0b3JzJyk7CgkJICAgICAgfQoJCSAgICAgIF91dGlscy5leHRlbmQodGhpcy5kZWNvcmF0b3JzLCBuYW1lKTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICB0aGlzLmRlY29yYXRvcnNbbmFtZV0gPSBmbjsKCQkgICAgfQoJCSAgfSwKCQkgIHVucmVnaXN0ZXJEZWNvcmF0b3I6IGZ1bmN0aW9uIHVucmVnaXN0ZXJEZWNvcmF0b3IobmFtZSkgewoJCSAgICBkZWxldGUgdGhpcy5kZWNvcmF0b3JzW25hbWVdOwoJCSAgfQoJCX07CgoJCXZhciBsb2cgPSBfbG9nZ2VyMlsnZGVmYXVsdCddLmxvZzsKCgkJZXhwb3J0cy5sb2cgPSBsb2c7CgkJZXhwb3J0cy5jcmVhdGVGcmFtZSA9IF91dGlscy5jcmVhdGVGcmFtZTsKCQlleHBvcnRzLmxvZ2dlciA9IF9sb2dnZXIyWydkZWZhdWx0J107CgoJLyoqKi8gfSwKCS8qIDUgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCQkndXNlIHN0cmljdCc7CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgkJZXhwb3J0cy5leHRlbmQgPSBleHRlbmQ7CgkJZXhwb3J0cy5pbmRleE9mID0gaW5kZXhPZjsKCQlleHBvcnRzLmVzY2FwZUV4cHJlc3Npb24gPSBlc2NhcGVFeHByZXNzaW9uOwoJCWV4cG9ydHMuaXNFbXB0eSA9IGlzRW1wdHk7CgkJZXhwb3J0cy5jcmVhdGVGcmFtZSA9IGNyZWF0ZUZyYW1lOwoJCWV4cG9ydHMuYmxvY2tQYXJhbXMgPSBibG9ja1BhcmFtczsKCQlleHBvcnRzLmFwcGVuZENvbnRleHRQYXRoID0gYXBwZW5kQ29udGV4dFBhdGg7CgkJdmFyIGVzY2FwZSA9IHsKCQkgICcmJzogJyZhbXA7JywKCQkgICc8JzogJyZsdDsnLAoJCSAgJz4nOiAnJmd0OycsCgkJICAnIic6ICcmcXVvdDsnLAoJCSAgIiciOiAnJiN4Mjc7JywKCQkgICdgJzogJyYjeDYwOycsCgkJICAnPSc6ICcmI3gzRDsnCgkJfTsKCgkJdmFyIGJhZENoYXJzID0gL1smPD4iJ2A9XS9nLAoJCSAgICBwb3NzaWJsZSA9IC9bJjw+IidgPV0vOwoKCQlmdW5jdGlvbiBlc2NhcGVDaGFyKGNocikgewoJCSAgcmV0dXJuIGVzY2FwZVtjaHJdOwoJCX0KCgkJZnVuY3Rpb24gZXh0ZW5kKG9iaiAvKiAsIC4uLnNvdXJjZSAqLykgewoJCSAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKCQkgICAgZm9yICh2YXIga2V5IGluIGFyZ3VtZW50c1tpXSkgewoJCSAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYXJndW1lbnRzW2ldLCBrZXkpKSB7CgkJICAgICAgICBvYmpba2V5XSA9IGFyZ3VtZW50c1tpXVtrZXldOwoJCSAgICAgIH0KCQkgICAgfQoJCSAgfQoKCQkgIHJldHVybiBvYmo7CgkJfQoKCQl2YXIgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nOwoKCQlleHBvcnRzLnRvU3RyaW5nID0gdG9TdHJpbmc7CgkJLy8gU291cmNlZCBmcm9tIGxvZGFzaAoJCS8vIGh0dHBzOi8vZ2l0aHViLmNvbS9iZXN0aWVqcy9sb2Rhc2gvYmxvYi9tYXN0ZXIvTElDRU5TRS50eHQKCQkvKiBlc2xpbnQtZGlzYWJsZSBmdW5jLXN0eWxlICovCgkJdmFyIGlzRnVuY3Rpb24gPSBmdW5jdGlvbiBpc0Z1bmN0aW9uKHZhbHVlKSB7CgkJICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nOwoJCX07CgkJLy8gZmFsbGJhY2sgZm9yIG9sZGVyIHZlcnNpb25zIG9mIENocm9tZSBhbmQgU2FmYXJpCgkJLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KCQlpZiAoaXNGdW5jdGlvbigveC8pKSB7CgkJICBleHBvcnRzLmlzRnVuY3Rpb24gPSBpc0Z1bmN0aW9uID0gZnVuY3Rpb24gKHZhbHVlKSB7CgkJICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicgJiYgdG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7CgkJICB9OwoJCX0KCQlleHBvcnRzLmlzRnVuY3Rpb24gPSBpc0Z1bmN0aW9uOwoKCQkvKiBlc2xpbnQtZW5hYmxlIGZ1bmMtc3R5bGUgKi8KCgkJLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KCQl2YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKHZhbHVlKSB7CgkJICByZXR1cm4gdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyA/IHRvU3RyaW5nLmNhbGwodmFsdWUpID09PSAnW29iamVjdCBBcnJheV0nIDogZmFsc2U7CgkJfTsKCgkJZXhwb3J0cy5pc0FycmF5ID0gaXNBcnJheTsKCQkvLyBPbGRlciBJRSB2ZXJzaW9ucyBkbyBub3QgZGlyZWN0bHkgc3VwcG9ydCBpbmRleE9mIHNvIHdlIG11c3QgaW1wbGVtZW50IG91ciBvd24sIHNhZGx5LgoKCQlmdW5jdGlvbiBpbmRleE9mKGFycmF5LCB2YWx1ZSkgewoJCSAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFycmF5Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CgkJICAgIGlmIChhcnJheVtpXSA9PT0gdmFsdWUpIHsKCQkgICAgICByZXR1cm4gaTsKCQkgICAgfQoJCSAgfQoJCSAgcmV0dXJuIC0xOwoJCX0KCgkJZnVuY3Rpb24gZXNjYXBlRXhwcmVzc2lvbihzdHJpbmcpIHsKCQkgIGlmICh0eXBlb2Ygc3RyaW5nICE9PSAnc3RyaW5nJykgewoJCSAgICAvLyBkb24ndCBlc2NhcGUgU2FmZVN0cmluZ3MsIHNpbmNlIHRoZXkncmUgYWxyZWFkeSBzYWZlCgkJICAgIGlmIChzdHJpbmcgJiYgc3RyaW5nLnRvSFRNTCkgewoJCSAgICAgIHJldHVybiBzdHJpbmcudG9IVE1MKCk7CgkJICAgIH0gZWxzZSBpZiAoc3RyaW5nID09IG51bGwpIHsKCQkgICAgICByZXR1cm4gJyc7CgkJICAgIH0gZWxzZSBpZiAoIXN0cmluZykgewoJCSAgICAgIHJldHVybiBzdHJpbmcgKyAnJzsKCQkgICAgfQoKCQkgICAgLy8gRm9yY2UgYSBzdHJpbmcgY29udmVyc2lvbiBhcyB0aGlzIHdpbGwgYmUgZG9uZSBieSB0aGUgYXBwZW5kIHJlZ2FyZGxlc3MgYW5kCgkJICAgIC8vIHRoZSByZWdleCB0ZXN0IHdpbGwgZG8gdGhpcyB0cmFuc3BhcmVudGx5IGJlaGluZCB0aGUgc2NlbmVzLCBjYXVzaW5nIGlzc3VlcyBpZgoJCSAgICAvLyBhbiBvYmplY3QncyB0byBzdHJpbmcgaGFzIGVzY2FwZWQgY2hhcmFjdGVycyBpbiBpdC4KCQkgICAgc3RyaW5nID0gJycgKyBzdHJpbmc7CgkJICB9CgoJCSAgaWYgKCFwb3NzaWJsZS50ZXN0KHN0cmluZykpIHsKCQkgICAgcmV0dXJuIHN0cmluZzsKCQkgIH0KCQkgIHJldHVybiBzdHJpbmcucmVwbGFjZShiYWRDaGFycywgZXNjYXBlQ2hhcik7CgkJfQoKCQlmdW5jdGlvbiBpc0VtcHR5KHZhbHVlKSB7CgkJICBpZiAoIXZhbHVlICYmIHZhbHVlICE9PSAwKSB7CgkJICAgIHJldHVybiB0cnVlOwoJCSAgfSBlbHNlIGlmIChpc0FycmF5KHZhbHVlKSAmJiB2YWx1ZS5sZW5ndGggPT09IDApIHsKCQkgICAgcmV0dXJuIHRydWU7CgkJICB9IGVsc2UgewoJCSAgICByZXR1cm4gZmFsc2U7CgkJICB9CgkJfQoKCQlmdW5jdGlvbiBjcmVhdGVGcmFtZShvYmplY3QpIHsKCQkgIHZhciBmcmFtZSA9IGV4dGVuZCh7fSwgb2JqZWN0KTsKCQkgIGZyYW1lLl9wYXJlbnQgPSBvYmplY3Q7CgkJICByZXR1cm4gZnJhbWU7CgkJfQoKCQlmdW5jdGlvbiBibG9ja1BhcmFtcyhwYXJhbXMsIGlkcykgewoJCSAgcGFyYW1zLnBhdGggPSBpZHM7CgkJICByZXR1cm4gcGFyYW1zOwoJCX0KCgkJZnVuY3Rpb24gYXBwZW5kQ29udGV4dFBhdGgoY29udGV4dFBhdGgsIGlkKSB7CgkJICByZXR1cm4gKGNvbnRleHRQYXRoID8gY29udGV4dFBhdGggKyAnLicgOiAnJykgKyBpZDsKCQl9CgoJLyoqKi8gfSwKCS8qIDYgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCXZhciBfT2JqZWN0JGRlZmluZVByb3BlcnR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KVsnZGVmYXVsdCddOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCQl2YXIgZXJyb3JQcm9wcyA9IFsnZGVzY3JpcHRpb24nLCAnZmlsZU5hbWUnLCAnbGluZU51bWJlcicsICdtZXNzYWdlJywgJ25hbWUnLCAnbnVtYmVyJywgJ3N0YWNrJ107CgoJCWZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlLCBub2RlKSB7CgkJICB2YXIgbG9jID0gbm9kZSAmJiBub2RlLmxvYywKCQkgICAgICBsaW5lID0gdW5kZWZpbmVkLAoJCSAgICAgIGNvbHVtbiA9IHVuZGVmaW5lZDsKCQkgIGlmIChsb2MpIHsKCQkgICAgbGluZSA9IGxvYy5zdGFydC5saW5lOwoJCSAgICBjb2x1bW4gPSBsb2Muc3RhcnQuY29sdW1uOwoKCQkgICAgbWVzc2FnZSArPSAnIC0gJyArIGxpbmUgKyAnOicgKyBjb2x1bW47CgkJICB9CgoJCSAgdmFyIHRtcCA9IEVycm9yLnByb3RvdHlwZS5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIG1lc3NhZ2UpOwoKCQkgIC8vIFVuZm9ydHVuYXRlbHkgZXJyb3JzIGFyZSBub3QgZW51bWVyYWJsZSBpbiBDaHJvbWUgKGF0IGxlYXN0KSwgc28gYGZvciBwcm9wIGluIHRtcGAgZG9lc24ndCB3b3JrLgoJCSAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgZXJyb3JQcm9wcy5sZW5ndGg7IGlkeCsrKSB7CgkJICAgIHRoaXNbZXJyb3JQcm9wc1tpZHhdXSA9IHRtcFtlcnJvclByb3BzW2lkeF1dOwoJCSAgfQoKCQkgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovCgkJICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHsKCQkgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgRXhjZXB0aW9uKTsKCQkgIH0KCgkJICB0cnkgewoJCSAgICBpZiAobG9jKSB7CgkJICAgICAgdGhpcy5saW5lTnVtYmVyID0gbGluZTsKCgkJICAgICAgLy8gV29yayBhcm91bmQgaXNzdWUgdW5kZXIgc2FmYXJpIHdoZXJlIHdlIGNhbid0IGRpcmVjdGx5IHNldCB0aGUgY29sdW1uIHZhbHVlCgkJICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KCQkgICAgICBpZiAoX09iamVjdCRkZWZpbmVQcm9wZXJ0eSkgewoJCSAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdjb2x1bW4nLCB7IHZhbHVlOiBjb2x1bW4gfSk7CgkJICAgICAgfSBlbHNlIHsKCQkgICAgICAgIHRoaXMuY29sdW1uID0gY29sdW1uOwoJCSAgICAgIH0KCQkgICAgfQoJCSAgfSBjYXRjaCAobm9wKSB7CgkJICAgIC8qIElnbm9yZSBpZiB0aGUgYnJvd3NlciBpcyB2ZXJ5IHBhcnRpY3VsYXIgKi8KCQkgIH0KCQl9CgoJCUV4Y2VwdGlvbi5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTsKCgkJZXhwb3J0c1snZGVmYXVsdCddID0gRXhjZXB0aW9uOwoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiA3ICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKCS8qKiovIH0sCgkvKiA4ICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJdmFyICQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoJCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYyl7CgkJICByZXR1cm4gJC5zZXREZXNjKGl0LCBrZXksIGRlc2MpOwoJCX07CgoJLyoqKi8gfSwKCS8qIDkgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCQl2YXIgJE9iamVjdCA9IE9iamVjdDsKCQltb2R1bGUuZXhwb3J0cyA9IHsKCQkgIGNyZWF0ZTogICAgICRPYmplY3QuY3JlYXRlLAoJCSAgZ2V0UHJvdG86ICAgJE9iamVjdC5nZXRQcm90b3R5cGVPZiwKCQkgIGlzRW51bTogICAgIHt9LnByb3BlcnR5SXNFbnVtZXJhYmxlLAoJCSAgZ2V0RGVzYzogICAgJE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsCgkJICBzZXREZXNjOiAgICAkT2JqZWN0LmRlZmluZVByb3BlcnR5LAoJCSAgc2V0RGVzY3M6ICAgJE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzLAoJCSAgZ2V0S2V5czogICAgJE9iamVjdC5rZXlzLAoJCSAgZ2V0TmFtZXM6ICAgJE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzLAoJCSAgZ2V0U3ltYm9sczogJE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMsCgkJICBlYWNoOiAgICAgICBbXS5mb3JFYWNoCgkJfTsKCgkvKioqLyB9LAoJLyogMTAgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoJCWV4cG9ydHMucmVnaXN0ZXJEZWZhdWx0SGVscGVycyA9IHJlZ2lzdGVyRGVmYXVsdEhlbHBlcnM7CgoJCXZhciBfaGVscGVyc0Jsb2NrSGVscGVyTWlzc2luZyA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpOwoKCQl2YXIgX2hlbHBlcnNCbG9ja0hlbHBlck1pc3NpbmcyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGVscGVyc0Jsb2NrSGVscGVyTWlzc2luZyk7CgoJCXZhciBfaGVscGVyc0VhY2ggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKTsKCgkJdmFyIF9oZWxwZXJzRWFjaDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oZWxwZXJzRWFjaCk7CgoJCXZhciBfaGVscGVyc0hlbHBlck1pc3NpbmcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKTsKCgkJdmFyIF9oZWxwZXJzSGVscGVyTWlzc2luZzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oZWxwZXJzSGVscGVyTWlzc2luZyk7CgoJCXZhciBfaGVscGVyc0lmID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7CgoJCXZhciBfaGVscGVyc0lmMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hlbHBlcnNJZik7CgoJCXZhciBfaGVscGVyc0xvZyA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpOwoKCQl2YXIgX2hlbHBlcnNMb2cyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGVscGVyc0xvZyk7CgoJCXZhciBfaGVscGVyc0xvb2t1cCA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpOwoKCQl2YXIgX2hlbHBlcnNMb29rdXAyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGVscGVyc0xvb2t1cCk7CgoJCXZhciBfaGVscGVyc1dpdGggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKCgkJdmFyIF9oZWxwZXJzV2l0aDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oZWxwZXJzV2l0aCk7CgoJCWZ1bmN0aW9uIHJlZ2lzdGVyRGVmYXVsdEhlbHBlcnMoaW5zdGFuY2UpIHsKCQkgIF9oZWxwZXJzQmxvY2tIZWxwZXJNaXNzaW5nMlsnZGVmYXVsdCddKGluc3RhbmNlKTsKCQkgIF9oZWxwZXJzRWFjaDJbJ2RlZmF1bHQnXShpbnN0YW5jZSk7CgkJICBfaGVscGVyc0hlbHBlck1pc3NpbmcyWydkZWZhdWx0J10oaW5zdGFuY2UpOwoJCSAgX2hlbHBlcnNJZjJbJ2RlZmF1bHQnXShpbnN0YW5jZSk7CgkJICBfaGVscGVyc0xvZzJbJ2RlZmF1bHQnXShpbnN0YW5jZSk7CgkJICBfaGVscGVyc0xvb2t1cDJbJ2RlZmF1bHQnXShpbnN0YW5jZSk7CgkJICBfaGVscGVyc1dpdGgyWydkZWZhdWx0J10oaW5zdGFuY2UpOwoJCX0KCgkvKioqLyB9LAoJLyogMTEgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwoKCQlleHBvcnRzWydkZWZhdWx0J10gPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHsKCQkgIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCdibG9ja0hlbHBlck1pc3NpbmcnLCBmdW5jdGlvbiAoY29udGV4dCwgb3B0aW9ucykgewoJCSAgICB2YXIgaW52ZXJzZSA9IG9wdGlvbnMuaW52ZXJzZSwKCQkgICAgICAgIGZuID0gb3B0aW9ucy5mbjsKCgkJICAgIGlmIChjb250ZXh0ID09PSB0cnVlKSB7CgkJICAgICAgcmV0dXJuIGZuKHRoaXMpOwoJCSAgICB9IGVsc2UgaWYgKGNvbnRleHQgPT09IGZhbHNlIHx8IGNvbnRleHQgPT0gbnVsbCkgewoJCSAgICAgIHJldHVybiBpbnZlcnNlKHRoaXMpOwoJCSAgICB9IGVsc2UgaWYgKF91dGlscy5pc0FycmF5KGNvbnRleHQpKSB7CgkJICAgICAgaWYgKGNvbnRleHQubGVuZ3RoID4gMCkgewoJCSAgICAgICAgaWYgKG9wdGlvbnMuaWRzKSB7CgkJICAgICAgICAgIG9wdGlvbnMuaWRzID0gW29wdGlvbnMubmFtZV07CgkJICAgICAgICB9CgoJCSAgICAgICAgcmV0dXJuIGluc3RhbmNlLmhlbHBlcnMuZWFjaChjb250ZXh0LCBvcHRpb25zKTsKCQkgICAgICB9IGVsc2UgewoJCSAgICAgICAgcmV0dXJuIGludmVyc2UodGhpcyk7CgkJICAgICAgfQoJCSAgICB9IGVsc2UgewoJCSAgICAgIGlmIChvcHRpb25zLmRhdGEgJiYgb3B0aW9ucy5pZHMpIHsKCQkgICAgICAgIHZhciBkYXRhID0gX3V0aWxzLmNyZWF0ZUZyYW1lKG9wdGlvbnMuZGF0YSk7CgkJICAgICAgICBkYXRhLmNvbnRleHRQYXRoID0gX3V0aWxzLmFwcGVuZENvbnRleHRQYXRoKG9wdGlvbnMuZGF0YS5jb250ZXh0UGF0aCwgb3B0aW9ucy5uYW1lKTsKCQkgICAgICAgIG9wdGlvbnMgPSB7IGRhdGE6IGRhdGEgfTsKCQkgICAgICB9CgoJCSAgICAgIHJldHVybiBmbihjb250ZXh0LCBvcHRpb25zKTsKCQkgICAgfQoJCSAgfSk7CgkJfTsKCgkJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSwKCS8qIDEyICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgkJdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CgoJCXZhciBfZXhjZXB0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKCgkJdmFyIF9leGNlcHRpb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhjZXB0aW9uKTsKCgkJZXhwb3J0c1snZGVmYXVsdCddID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7CgkJICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignZWFjaCcsIGZ1bmN0aW9uIChjb250ZXh0LCBvcHRpb25zKSB7CgkJICAgIGlmICghb3B0aW9ucykgewoJCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdNdXN0IHBhc3MgaXRlcmF0b3IgdG8gI2VhY2gnKTsKCQkgICAgfQoKCQkgICAgdmFyIGZuID0gb3B0aW9ucy5mbiwKCQkgICAgICAgIGludmVyc2UgPSBvcHRpb25zLmludmVyc2UsCgkJICAgICAgICBpID0gMCwKCQkgICAgICAgIHJldCA9ICcnLAoJCSAgICAgICAgZGF0YSA9IHVuZGVmaW5lZCwKCQkgICAgICAgIGNvbnRleHRQYXRoID0gdW5kZWZpbmVkOwoKCQkgICAgaWYgKG9wdGlvbnMuZGF0YSAmJiBvcHRpb25zLmlkcykgewoJCSAgICAgIGNvbnRleHRQYXRoID0gX3V0aWxzLmFwcGVuZENvbnRleHRQYXRoKG9wdGlvbnMuZGF0YS5jb250ZXh0UGF0aCwgb3B0aW9ucy5pZHNbMF0pICsgJy4nOwoJCSAgICB9CgoJCSAgICBpZiAoX3V0aWxzLmlzRnVuY3Rpb24oY29udGV4dCkpIHsKCQkgICAgICBjb250ZXh0ID0gY29udGV4dC5jYWxsKHRoaXMpOwoJCSAgICB9CgoJCSAgICBpZiAob3B0aW9ucy5kYXRhKSB7CgkJICAgICAgZGF0YSA9IF91dGlscy5jcmVhdGVGcmFtZShvcHRpb25zLmRhdGEpOwoJCSAgICB9CgoJCSAgICBmdW5jdGlvbiBleGVjSXRlcmF0aW9uKGZpZWxkLCBpbmRleCwgbGFzdCkgewoJCSAgICAgIGlmIChkYXRhKSB7CgkJICAgICAgICBkYXRhLmtleSA9IGZpZWxkOwoJCSAgICAgICAgZGF0YS5pbmRleCA9IGluZGV4OwoJCSAgICAgICAgZGF0YS5maXJzdCA9IGluZGV4ID09PSAwOwoJCSAgICAgICAgZGF0YS5sYXN0ID0gISFsYXN0OwoKCQkgICAgICAgIGlmIChjb250ZXh0UGF0aCkgewoJCSAgICAgICAgICBkYXRhLmNvbnRleHRQYXRoID0gY29udGV4dFBhdGggKyBmaWVsZDsKCQkgICAgICAgIH0KCQkgICAgICB9CgoJCSAgICAgIHJldCA9IHJldCArIGZuKGNvbnRleHRbZmllbGRdLCB7CgkJICAgICAgICBkYXRhOiBkYXRhLAoJCSAgICAgICAgYmxvY2tQYXJhbXM6IF91dGlscy5ibG9ja1BhcmFtcyhbY29udGV4dFtmaWVsZF0sIGZpZWxkXSwgW2NvbnRleHRQYXRoICsgZmllbGQsIG51bGxdKQoJCSAgICAgIH0pOwoJCSAgICB9CgoJCSAgICBpZiAoY29udGV4dCAmJiB0eXBlb2YgY29udGV4dCA9PT0gJ29iamVjdCcpIHsKCQkgICAgICBpZiAoX3V0aWxzLmlzQXJyYXkoY29udGV4dCkpIHsKCQkgICAgICAgIGZvciAodmFyIGogPSBjb250ZXh0Lmxlbmd0aDsgaSA8IGo7IGkrKykgewoJCSAgICAgICAgICBpZiAoaSBpbiBjb250ZXh0KSB7CgkJICAgICAgICAgICAgZXhlY0l0ZXJhdGlvbihpLCBpLCBpID09PSBjb250ZXh0Lmxlbmd0aCAtIDEpOwoJCSAgICAgICAgICB9CgkJICAgICAgICB9CgkJICAgICAgfSBlbHNlIHsKCQkgICAgICAgIHZhciBwcmlvcktleSA9IHVuZGVmaW5lZDsKCgkJICAgICAgICBmb3IgKHZhciBrZXkgaW4gY29udGV4dCkgewoJCSAgICAgICAgICBpZiAoY29udGV4dC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CgkJICAgICAgICAgICAgLy8gV2UncmUgcnVubmluZyB0aGUgaXRlcmF0aW9ucyBvbmUgc3RlcCBvdXQgb2Ygc3luYyBzbyB3ZSBjYW4gZGV0ZWN0CgkJICAgICAgICAgICAgLy8gdGhlIGxhc3QgaXRlcmF0aW9uIHdpdGhvdXQgaGF2ZSB0byBzY2FuIHRoZSBvYmplY3QgdHdpY2UgYW5kIGNyZWF0ZQoJCSAgICAgICAgICAgIC8vIGFuIGl0ZXJtZWRpYXRlIGtleXMgYXJyYXkuCgkJICAgICAgICAgICAgaWYgKHByaW9yS2V5ICE9PSB1bmRlZmluZWQpIHsKCQkgICAgICAgICAgICAgIGV4ZWNJdGVyYXRpb24ocHJpb3JLZXksIGkgLSAxKTsKCQkgICAgICAgICAgICB9CgkJICAgICAgICAgICAgcHJpb3JLZXkgPSBrZXk7CgkJICAgICAgICAgICAgaSsrOwoJCSAgICAgICAgICB9CgkJICAgICAgICB9CgkJICAgICAgICBpZiAocHJpb3JLZXkgIT09IHVuZGVmaW5lZCkgewoJCSAgICAgICAgICBleGVjSXRlcmF0aW9uKHByaW9yS2V5LCBpIC0gMSwgdHJ1ZSk7CgkJICAgICAgICB9CgkJICAgICAgfQoJCSAgICB9CgoJCSAgICBpZiAoaSA9PT0gMCkgewoJCSAgICAgIHJldCA9IGludmVyc2UodGhpcyk7CgkJICAgIH0KCgkJICAgIHJldHVybiByZXQ7CgkJICB9KTsKCQl9OwoKCQltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9LAoJLyogMTMgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCQl2YXIgX2V4Y2VwdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oNik7CgoJCXZhciBfZXhjZXB0aW9uMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4Y2VwdGlvbik7CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IGZ1bmN0aW9uIChpbnN0YW5jZSkgewoJCSAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ2hlbHBlck1pc3NpbmcnLCBmdW5jdGlvbiAoKSAvKiBbYXJncywgXW9wdGlvbnMgKi97CgkJICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7CgkJICAgICAgLy8gQSBtaXNzaW5nIGZpZWxkIGluIGEge3tmb299fSBjb25zdHJ1Y3QuCgkJICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKCQkgICAgfSBlbHNlIHsKCQkgICAgICAvLyBTb21lb25lIGlzIGFjdHVhbGx5IHRyeWluZyB0byBjYWxsIHNvbWV0aGluZywgYmxvdyB1cC4KCQkgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnTWlzc2luZyBoZWxwZXI6ICInICsgYXJndW1lbnRzW2FyZ3VtZW50cy5sZW5ndGggLSAxXS5uYW1lICsgJyInKTsKCQkgICAgfQoJCSAgfSk7CgkJfTsKCgkJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSwKCS8qIDE0ICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCQl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKCgkJZXhwb3J0c1snZGVmYXVsdCddID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7CgkJICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignaWYnLCBmdW5jdGlvbiAoY29uZGl0aW9uYWwsIG9wdGlvbnMpIHsKCQkgICAgaWYgKF91dGlscy5pc0Z1bmN0aW9uKGNvbmRpdGlvbmFsKSkgewoJCSAgICAgIGNvbmRpdGlvbmFsID0gY29uZGl0aW9uYWwuY2FsbCh0aGlzKTsKCQkgICAgfQoKCQkgICAgLy8gRGVmYXVsdCBiZWhhdmlvciBpcyB0byByZW5kZXIgdGhlIHBvc2l0aXZlIHBhdGggaWYgdGhlIHZhbHVlIGlzIHRydXRoeSBhbmQgbm90IGVtcHR5LgoJCSAgICAvLyBUaGUgYGluY2x1ZGVaZXJvYCBvcHRpb24gbWF5IGJlIHNldCB0byB0cmVhdCB0aGUgY29uZHRpb25hbCBhcyBwdXJlbHkgbm90IGVtcHR5IGJhc2VkIG9uIHRoZQoJCSAgICAvLyBiZWhhdmlvciBvZiBpc0VtcHR5LiBFZmZlY3RpdmVseSB0aGlzIGRldGVybWluZXMgaWYgMCBpcyBoYW5kbGVkIGJ5IHRoZSBwb3NpdGl2ZSBwYXRoIG9yIG5lZ2F0aXZlLgoJCSAgICBpZiAoIW9wdGlvbnMuaGFzaC5pbmNsdWRlWmVybyAmJiAhY29uZGl0aW9uYWwgfHwgX3V0aWxzLmlzRW1wdHkoY29uZGl0aW9uYWwpKSB7CgkJICAgICAgcmV0dXJuIG9wdGlvbnMuaW52ZXJzZSh0aGlzKTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICByZXR1cm4gb3B0aW9ucy5mbih0aGlzKTsKCQkgICAgfQoJCSAgfSk7CgoJCSAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ3VubGVzcycsIGZ1bmN0aW9uIChjb25kaXRpb25hbCwgb3B0aW9ucykgewoJCSAgICByZXR1cm4gaW5zdGFuY2UuaGVscGVyc1snaWYnXS5jYWxsKHRoaXMsIGNvbmRpdGlvbmFsLCB7IGZuOiBvcHRpb25zLmludmVyc2UsIGludmVyc2U6IG9wdGlvbnMuZm4sIGhhc2g6IG9wdGlvbnMuaGFzaCB9KTsKCQkgIH0pOwoJCX07CgoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiAxNSAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJCSd1c2Ugc3RyaWN0JzsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgkJZXhwb3J0c1snZGVmYXVsdCddID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7CgkJICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignbG9nJywgZnVuY3Rpb24gKCkgLyogbWVzc2FnZSwgb3B0aW9ucyAqL3sKCQkgICAgdmFyIGFyZ3MgPSBbdW5kZWZpbmVkXSwKCQkgICAgICAgIG9wdGlvbnMgPSBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdOwoJCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGggLSAxOyBpKyspIHsKCQkgICAgICBhcmdzLnB1c2goYXJndW1lbnRzW2ldKTsKCQkgICAgfQoKCQkgICAgdmFyIGxldmVsID0gMTsKCQkgICAgaWYgKG9wdGlvbnMuaGFzaC5sZXZlbCAhPSBudWxsKSB7CgkJICAgICAgbGV2ZWwgPSBvcHRpb25zLmhhc2gubGV2ZWw7CgkJICAgIH0gZWxzZSBpZiAob3B0aW9ucy5kYXRhICYmIG9wdGlvbnMuZGF0YS5sZXZlbCAhPSBudWxsKSB7CgkJICAgICAgbGV2ZWwgPSBvcHRpb25zLmRhdGEubGV2ZWw7CgkJICAgIH0KCQkgICAgYXJnc1swXSA9IGxldmVsOwoKCQkgICAgaW5zdGFuY2UubG9nLmFwcGx5KGluc3RhbmNlLCBhcmdzKTsKCQkgIH0pOwoJCX07CgoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiAxNiAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJCSd1c2Ugc3RyaWN0JzsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgkJZXhwb3J0c1snZGVmYXVsdCddID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7CgkJICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignbG9va3VwJywgZnVuY3Rpb24gKG9iaiwgZmllbGQpIHsKCQkgICAgcmV0dXJuIG9iaiAmJiBvYmpbZmllbGRdOwoJCSAgfSk7CgkJfTsKCgkJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSwKCS8qIDE3ICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCQl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKCgkJZXhwb3J0c1snZGVmYXVsdCddID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7CgkJICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignd2l0aCcsIGZ1bmN0aW9uIChjb250ZXh0LCBvcHRpb25zKSB7CgkJICAgIGlmIChfdXRpbHMuaXNGdW5jdGlvbihjb250ZXh0KSkgewoJCSAgICAgIGNvbnRleHQgPSBjb250ZXh0LmNhbGwodGhpcyk7CgkJICAgIH0KCgkJICAgIHZhciBmbiA9IG9wdGlvbnMuZm47CgoJCSAgICBpZiAoIV91dGlscy5pc0VtcHR5KGNvbnRleHQpKSB7CgkJICAgICAgdmFyIGRhdGEgPSBvcHRpb25zLmRhdGE7CgkJICAgICAgaWYgKG9wdGlvbnMuZGF0YSAmJiBvcHRpb25zLmlkcykgewoJCSAgICAgICAgZGF0YSA9IF91dGlscy5jcmVhdGVGcmFtZShvcHRpb25zLmRhdGEpOwoJCSAgICAgICAgZGF0YS5jb250ZXh0UGF0aCA9IF91dGlscy5hcHBlbmRDb250ZXh0UGF0aChvcHRpb25zLmRhdGEuY29udGV4dFBhdGgsIG9wdGlvbnMuaWRzWzBdKTsKCQkgICAgICB9CgoJCSAgICAgIHJldHVybiBmbihjb250ZXh0LCB7CgkJICAgICAgICBkYXRhOiBkYXRhLAoJCSAgICAgICAgYmxvY2tQYXJhbXM6IF91dGlscy5ibG9ja1BhcmFtcyhbY29udGV4dF0sIFtkYXRhICYmIGRhdGEuY29udGV4dFBhdGhdKQoJCSAgICAgIH0pOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHJldHVybiBvcHRpb25zLmludmVyc2UodGhpcyk7CgkJICAgIH0KCQkgIH0pOwoJCX07CgoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiAxOCAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCSd1c2Ugc3RyaWN0JzsKCgkJdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpWydkZWZhdWx0J107CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgkJZXhwb3J0cy5yZWdpc3RlckRlZmF1bHREZWNvcmF0b3JzID0gcmVnaXN0ZXJEZWZhdWx0RGVjb3JhdG9yczsKCgkJdmFyIF9kZWNvcmF0b3JzSW5saW5lID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSk7CgoJCXZhciBfZGVjb3JhdG9yc0lubGluZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZWNvcmF0b3JzSW5saW5lKTsKCgkJZnVuY3Rpb24gcmVnaXN0ZXJEZWZhdWx0RGVjb3JhdG9ycyhpbnN0YW5jZSkgewoJCSAgX2RlY29yYXRvcnNJbmxpbmUyWydkZWZhdWx0J10oaW5zdGFuY2UpOwoJCX0KCgkvKioqLyB9LAoJLyogMTkgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwoKCQlleHBvcnRzWydkZWZhdWx0J10gPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHsKCQkgIGluc3RhbmNlLnJlZ2lzdGVyRGVjb3JhdG9yKCdpbmxpbmUnLCBmdW5jdGlvbiAoZm4sIHByb3BzLCBjb250YWluZXIsIG9wdGlvbnMpIHsKCQkgICAgdmFyIHJldCA9IGZuOwoJCSAgICBpZiAoIXByb3BzLnBhcnRpYWxzKSB7CgkJICAgICAgcHJvcHMucGFydGlhbHMgPSB7fTsKCQkgICAgICByZXQgPSBmdW5jdGlvbiAoY29udGV4dCwgb3B0aW9ucykgewoJCSAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IHBhcnRpYWxzIHN0YWNrIGZyYW1lIHByaW9yIHRvIGV4ZWMuCgkJICAgICAgICB2YXIgb3JpZ2luYWwgPSBjb250YWluZXIucGFydGlhbHM7CgkJICAgICAgICBjb250YWluZXIucGFydGlhbHMgPSBfdXRpbHMuZXh0ZW5kKHt9LCBvcmlnaW5hbCwgcHJvcHMucGFydGlhbHMpOwoJCSAgICAgICAgdmFyIHJldCA9IGZuKGNvbnRleHQsIG9wdGlvbnMpOwoJCSAgICAgICAgY29udGFpbmVyLnBhcnRpYWxzID0gb3JpZ2luYWw7CgkJICAgICAgICByZXR1cm4gcmV0OwoJCSAgICAgIH07CgkJICAgIH0KCgkJICAgIHByb3BzLnBhcnRpYWxzW29wdGlvbnMuYXJnc1swXV0gPSBvcHRpb25zLmZuOwoKCQkgICAgcmV0dXJuIHJldDsKCQkgIH0pOwoJCX07CgoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiAyMCAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCSd1c2Ugc3RyaWN0JzsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgkJdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CgoJCXZhciBsb2dnZXIgPSB7CgkJICBtZXRob2RNYXA6IFsnZGVidWcnLCAnaW5mbycsICd3YXJuJywgJ2Vycm9yJ10sCgkJICBsZXZlbDogJ2luZm8nLAoKCQkgIC8vIE1hcHMgYSBnaXZlbiBsZXZlbCB2YWx1ZSB0byB0aGUgYG1ldGhvZE1hcGAgaW5kZXhlcyBhYm92ZS4KCQkgIGxvb2t1cExldmVsOiBmdW5jdGlvbiBsb29rdXBMZXZlbChsZXZlbCkgewoJCSAgICBpZiAodHlwZW9mIGxldmVsID09PSAnc3RyaW5nJykgewoJCSAgICAgIHZhciBsZXZlbE1hcCA9IF91dGlscy5pbmRleE9mKGxvZ2dlci5tZXRob2RNYXAsIGxldmVsLnRvTG93ZXJDYXNlKCkpOwoJCSAgICAgIGlmIChsZXZlbE1hcCA+PSAwKSB7CgkJICAgICAgICBsZXZlbCA9IGxldmVsTWFwOwoJCSAgICAgIH0gZWxzZSB7CgkJICAgICAgICBsZXZlbCA9IHBhcnNlSW50KGxldmVsLCAxMCk7CgkJICAgICAgfQoJCSAgICB9CgoJCSAgICByZXR1cm4gbGV2ZWw7CgkJICB9LAoKCQkgIC8vIENhbiBiZSBvdmVycmlkZGVuIGluIHRoZSBob3N0IGVudmlyb25tZW50CgkJICBsb2c6IGZ1bmN0aW9uIGxvZyhsZXZlbCkgewoJCSAgICBsZXZlbCA9IGxvZ2dlci5sb29rdXBMZXZlbChsZXZlbCk7CgoJCSAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIGxvZ2dlci5sb29rdXBMZXZlbChsb2dnZXIubGV2ZWwpIDw9IGxldmVsKSB7CgkJICAgICAgdmFyIG1ldGhvZCA9IGxvZ2dlci5tZXRob2RNYXBbbGV2ZWxdOwoJCSAgICAgIGlmICghY29uc29sZVttZXRob2RdKSB7CgkJICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGUKCQkgICAgICAgIG1ldGhvZCA9ICdsb2cnOwoJCSAgICAgIH0KCgkJICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIG1lc3NhZ2UgPSBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CgkJICAgICAgICBtZXNzYWdlW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTsKCQkgICAgICB9CgoJCSAgICAgIGNvbnNvbGVbbWV0aG9kXS5hcHBseShjb25zb2xlLCBtZXNzYWdlKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlCgkJICAgIH0KCQkgIH0KCQl9OwoKCQlleHBvcnRzWydkZWZhdWx0J10gPSBsb2dnZXI7CgkJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSwKCS8qIDIxICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkJLy8gQnVpbGQgb3V0IG91ciBiYXNpYyBTYWZlU3RyaW5nIHR5cGUKCQkndXNlIHN0cmljdCc7CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgkJZnVuY3Rpb24gU2FmZVN0cmluZyhzdHJpbmcpIHsKCQkgIHRoaXMuc3RyaW5nID0gc3RyaW5nOwoJCX0KCgkJU2FmZVN0cmluZy5wcm90b3R5cGUudG9TdHJpbmcgPSBTYWZlU3RyaW5nLnByb3RvdHlwZS50b0hUTUwgPSBmdW5jdGlvbiAoKSB7CgkJICByZXR1cm4gJycgKyB0aGlzLnN0cmluZzsKCQl9OwoKCQlleHBvcnRzWydkZWZhdWx0J10gPSBTYWZlU3RyaW5nOwoJCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0sCgkvKiAyMiAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCSd1c2Ugc3RyaWN0JzsKCgkJdmFyIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKVsnZGVmYXVsdCddOwoKCQl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCQlleHBvcnRzLmNoZWNrUmV2aXNpb24gPSBjaGVja1JldmlzaW9uOwoJCWV4cG9ydHMudGVtcGxhdGUgPSB0ZW1wbGF0ZTsKCQlleHBvcnRzLndyYXBQcm9ncmFtID0gd3JhcFByb2dyYW07CgkJZXhwb3J0cy5yZXNvbHZlUGFydGlhbCA9IHJlc29sdmVQYXJ0aWFsOwoJCWV4cG9ydHMuaW52b2tlUGFydGlhbCA9IGludm9rZVBhcnRpYWw7CgkJZXhwb3J0cy5ub29wID0gbm9vcDsKCgkJdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CgoJCXZhciBVdGlscyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF91dGlscyk7CgoJCXZhciBfZXhjZXB0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKCgkJdmFyIF9leGNlcHRpb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhjZXB0aW9uKTsKCgkJdmFyIF9iYXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTsKCgkJZnVuY3Rpb24gY2hlY2tSZXZpc2lvbihjb21waWxlckluZm8pIHsKCQkgIHZhciBjb21waWxlclJldmlzaW9uID0gY29tcGlsZXJJbmZvICYmIGNvbXBpbGVySW5mb1swXSB8fCAxLAoJCSAgICAgIGN1cnJlbnRSZXZpc2lvbiA9IF9iYXNlLkNPTVBJTEVSX1JFVklTSU9OOwoKCQkgIGlmIChjb21waWxlclJldmlzaW9uICE9PSBjdXJyZW50UmV2aXNpb24pIHsKCQkgICAgaWYgKGNvbXBpbGVyUmV2aXNpb24gPCBjdXJyZW50UmV2aXNpb24pIHsKCQkgICAgICB2YXIgcnVudGltZVZlcnNpb25zID0gX2Jhc2UuUkVWSVNJT05fQ0hBTkdFU1tjdXJyZW50UmV2aXNpb25dLAoJCSAgICAgICAgICBjb21waWxlclZlcnNpb25zID0gX2Jhc2UuUkVWSVNJT05fQ0hBTkdFU1tjb21waWxlclJldmlzaW9uXTsKCQkgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnVGVtcGxhdGUgd2FzIHByZWNvbXBpbGVkIHdpdGggYW4gb2xkZXIgdmVyc2lvbiBvZiBIYW5kbGViYXJzIHRoYW4gdGhlIGN1cnJlbnQgcnVudGltZS4gJyArICdQbGVhc2UgdXBkYXRlIHlvdXIgcHJlY29tcGlsZXIgdG8gYSBuZXdlciB2ZXJzaW9uICgnICsgcnVudGltZVZlcnNpb25zICsgJykgb3IgZG93bmdyYWRlIHlvdXIgcnVudGltZSB0byBhbiBvbGRlciB2ZXJzaW9uICgnICsgY29tcGlsZXJWZXJzaW9ucyArICcpLicpOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIC8vIFVzZSB0aGUgZW1iZWRkZWQgdmVyc2lvbiBpbmZvIHNpbmNlIHRoZSBydW50aW1lIGRvZXNuJ3Qga25vdyBhYm91dCB0aGlzIHJldmlzaW9uIHlldAoJCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdUZW1wbGF0ZSB3YXMgcHJlY29tcGlsZWQgd2l0aCBhIG5ld2VyIHZlcnNpb24gb2YgSGFuZGxlYmFycyB0aGFuIHRoZSBjdXJyZW50IHJ1bnRpbWUuICcgKyAnUGxlYXNlIHVwZGF0ZSB5b3VyIHJ1bnRpbWUgdG8gYSBuZXdlciB2ZXJzaW9uICgnICsgY29tcGlsZXJJbmZvWzFdICsgJykuJyk7CgkJICAgIH0KCQkgIH0KCQl9CgoJCWZ1bmN0aW9uIHRlbXBsYXRlKHRlbXBsYXRlU3BlYywgZW52KSB7CgkJICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoJCSAgaWYgKCFlbnYpIHsKCQkgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ05vIGVudmlyb25tZW50IHBhc3NlZCB0byB0ZW1wbGF0ZScpOwoJCSAgfQoJCSAgaWYgKCF0ZW1wbGF0ZVNwZWMgfHwgIXRlbXBsYXRlU3BlYy5tYWluKSB7CgkJICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdVbmtub3duIHRlbXBsYXRlIG9iamVjdDogJyArIHR5cGVvZiB0ZW1wbGF0ZVNwZWMpOwoJCSAgfQoKCQkgIHRlbXBsYXRlU3BlYy5tYWluLmRlY29yYXRvciA9IHRlbXBsYXRlU3BlYy5tYWluX2Q7CgoJCSAgLy8gTm90ZTogVXNpbmcgZW52LlZNIHJlZmVyZW5jZXMgcmF0aGVyIHRoYW4gbG9jYWwgdmFyIHJlZmVyZW5jZXMgdGhyb3VnaG91dCB0aGlzIHNlY3Rpb24gdG8gYWxsb3cKCQkgIC8vIGZvciBleHRlcm5hbCB1c2VycyB0byBvdmVycmlkZSB0aGVzZSBhcyBwc3VlZG8tc3VwcG9ydGVkIEFQSXMuCgkJICBlbnYuVk0uY2hlY2tSZXZpc2lvbih0ZW1wbGF0ZVNwZWMuY29tcGlsZXIpOwoKCQkgIGZ1bmN0aW9uIGludm9rZVBhcnRpYWxXcmFwcGVyKHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpIHsKCQkgICAgaWYgKG9wdGlvbnMuaGFzaCkgewoJCSAgICAgIGNvbnRleHQgPSBVdGlscy5leHRlbmQoe30sIGNvbnRleHQsIG9wdGlvbnMuaGFzaCk7CgkJICAgICAgaWYgKG9wdGlvbnMuaWRzKSB7CgkJICAgICAgICBvcHRpb25zLmlkc1swXSA9IHRydWU7CgkJICAgICAgfQoJCSAgICB9CgoJCSAgICBwYXJ0aWFsID0gZW52LlZNLnJlc29sdmVQYXJ0aWFsLmNhbGwodGhpcywgcGFydGlhbCwgY29udGV4dCwgb3B0aW9ucyk7CgkJICAgIHZhciByZXN1bHQgPSBlbnYuVk0uaW52b2tlUGFydGlhbC5jYWxsKHRoaXMsIHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpOwoKCQkgICAgaWYgKHJlc3VsdCA9PSBudWxsICYmIGVudi5jb21waWxlKSB7CgkJICAgICAgb3B0aW9ucy5wYXJ0aWFsc1tvcHRpb25zLm5hbWVdID0gZW52LmNvbXBpbGUocGFydGlhbCwgdGVtcGxhdGVTcGVjLmNvbXBpbGVyT3B0aW9ucywgZW52KTsKCQkgICAgICByZXN1bHQgPSBvcHRpb25zLnBhcnRpYWxzW29wdGlvbnMubmFtZV0oY29udGV4dCwgb3B0aW9ucyk7CgkJICAgIH0KCQkgICAgaWYgKHJlc3VsdCAhPSBudWxsKSB7CgkJICAgICAgaWYgKG9wdGlvbnMuaW5kZW50KSB7CgkJICAgICAgICB2YXIgbGluZXMgPSByZXN1bHQuc3BsaXQoJ1xuJyk7CgkJICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGxpbmVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewoJCSAgICAgICAgICBpZiAoIWxpbmVzW2ldICYmIGkgKyAxID09PSBsKSB7CgkJICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgIH0KCgkJICAgICAgICAgIGxpbmVzW2ldID0gb3B0aW9ucy5pbmRlbnQgKyBsaW5lc1tpXTsKCQkgICAgICAgIH0KCQkgICAgICAgIHJlc3VsdCA9IGxpbmVzLmpvaW4oJ1xuJyk7CgkJICAgICAgfQoJCSAgICAgIHJldHVybiByZXN1bHQ7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ1RoZSBwYXJ0aWFsICcgKyBvcHRpb25zLm5hbWUgKyAnIGNvdWxkIG5vdCBiZSBjb21waWxlZCB3aGVuIHJ1bm5pbmcgaW4gcnVudGltZS1vbmx5IG1vZGUnKTsKCQkgICAgfQoJCSAgfQoKCQkgIC8vIEp1c3QgYWRkIHdhdGVyCgkJICB2YXIgY29udGFpbmVyID0gewoJCSAgICBzdHJpY3Q6IGZ1bmN0aW9uIHN0cmljdChvYmosIG5hbWUpIHsKCQkgICAgICBpZiAoIShuYW1lIGluIG9iaikpIHsKCQkgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCciJyArIG5hbWUgKyAnIiBub3QgZGVmaW5lZCBpbiAnICsgb2JqKTsKCQkgICAgICB9CgkJICAgICAgcmV0dXJuIG9ialtuYW1lXTsKCQkgICAgfSwKCQkgICAgbG9va3VwOiBmdW5jdGlvbiBsb29rdXAoZGVwdGhzLCBuYW1lKSB7CgkJICAgICAgdmFyIGxlbiA9IGRlcHRocy5sZW5ndGg7CgkJICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgewoJCSAgICAgICAgaWYgKGRlcHRoc1tpXSAmJiBkZXB0aHNbaV1bbmFtZV0gIT0gbnVsbCkgewoJCSAgICAgICAgICByZXR1cm4gZGVwdGhzW2ldW25hbWVdOwoJCSAgICAgICAgfQoJCSAgICAgIH0KCQkgICAgfSwKCQkgICAgbGFtYmRhOiBmdW5jdGlvbiBsYW1iZGEoY3VycmVudCwgY29udGV4dCkgewoJCSAgICAgIHJldHVybiB0eXBlb2YgY3VycmVudCA9PT0gJ2Z1bmN0aW9uJyA/IGN1cnJlbnQuY2FsbChjb250ZXh0KSA6IGN1cnJlbnQ7CgkJICAgIH0sCgoJCSAgICBlc2NhcGVFeHByZXNzaW9uOiBVdGlscy5lc2NhcGVFeHByZXNzaW9uLAoJCSAgICBpbnZva2VQYXJ0aWFsOiBpbnZva2VQYXJ0aWFsV3JhcHBlciwKCgkJICAgIGZuOiBmdW5jdGlvbiBmbihpKSB7CgkJICAgICAgdmFyIHJldCA9IHRlbXBsYXRlU3BlY1tpXTsKCQkgICAgICByZXQuZGVjb3JhdG9yID0gdGVtcGxhdGVTcGVjW2kgKyAnX2QnXTsKCQkgICAgICByZXR1cm4gcmV0OwoJCSAgICB9LAoKCQkgICAgcHJvZ3JhbXM6IFtdLAoJCSAgICBwcm9ncmFtOiBmdW5jdGlvbiBwcm9ncmFtKGksIGRhdGEsIGRlY2xhcmVkQmxvY2tQYXJhbXMsIGJsb2NrUGFyYW1zLCBkZXB0aHMpIHsKCQkgICAgICB2YXIgcHJvZ3JhbVdyYXBwZXIgPSB0aGlzLnByb2dyYW1zW2ldLAoJCSAgICAgICAgICBmbiA9IHRoaXMuZm4oaSk7CgkJICAgICAgaWYgKGRhdGEgfHwgZGVwdGhzIHx8IGJsb2NrUGFyYW1zIHx8IGRlY2xhcmVkQmxvY2tQYXJhbXMpIHsKCQkgICAgICAgIHByb2dyYW1XcmFwcGVyID0gd3JhcFByb2dyYW0odGhpcywgaSwgZm4sIGRhdGEsIGRlY2xhcmVkQmxvY2tQYXJhbXMsIGJsb2NrUGFyYW1zLCBkZXB0aHMpOwoJCSAgICAgIH0gZWxzZSBpZiAoIXByb2dyYW1XcmFwcGVyKSB7CgkJICAgICAgICBwcm9ncmFtV3JhcHBlciA9IHRoaXMucHJvZ3JhbXNbaV0gPSB3cmFwUHJvZ3JhbSh0aGlzLCBpLCBmbik7CgkJICAgICAgfQoJCSAgICAgIHJldHVybiBwcm9ncmFtV3JhcHBlcjsKCQkgICAgfSwKCgkJICAgIGRhdGE6IGZ1bmN0aW9uIGRhdGEodmFsdWUsIGRlcHRoKSB7CgkJICAgICAgd2hpbGUgKHZhbHVlICYmIGRlcHRoLS0pIHsKCQkgICAgICAgIHZhbHVlID0gdmFsdWUuX3BhcmVudDsKCQkgICAgICB9CgkJICAgICAgcmV0dXJuIHZhbHVlOwoJCSAgICB9LAoJCSAgICBtZXJnZTogZnVuY3Rpb24gbWVyZ2UocGFyYW0sIGNvbW1vbikgewoJCSAgICAgIHZhciBvYmogPSBwYXJhbSB8fCBjb21tb247CgoJCSAgICAgIGlmIChwYXJhbSAmJiBjb21tb24gJiYgcGFyYW0gIT09IGNvbW1vbikgewoJCSAgICAgICAgb2JqID0gVXRpbHMuZXh0ZW5kKHt9LCBjb21tb24sIHBhcmFtKTsKCQkgICAgICB9CgoJCSAgICAgIHJldHVybiBvYmo7CgkJICAgIH0sCgoJCSAgICBub29wOiBlbnYuVk0ubm9vcCwKCQkgICAgY29tcGlsZXJJbmZvOiB0ZW1wbGF0ZVNwZWMuY29tcGlsZXIKCQkgIH07CgoJCSAgZnVuY3Rpb24gcmV0KGNvbnRleHQpIHsKCQkgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1sxXTsKCgkJICAgIHZhciBkYXRhID0gb3B0aW9ucy5kYXRhOwoKCQkgICAgcmV0Ll9zZXR1cChvcHRpb25zKTsKCQkgICAgaWYgKCFvcHRpb25zLnBhcnRpYWwgJiYgdGVtcGxhdGVTcGVjLnVzZURhdGEpIHsKCQkgICAgICBkYXRhID0gaW5pdERhdGEoY29udGV4dCwgZGF0YSk7CgkJICAgIH0KCQkgICAgdmFyIGRlcHRocyA9IHVuZGVmaW5lZCwKCQkgICAgICAgIGJsb2NrUGFyYW1zID0gdGVtcGxhdGVTcGVjLnVzZUJsb2NrUGFyYW1zID8gW10gOiB1bmRlZmluZWQ7CgkJICAgIGlmICh0ZW1wbGF0ZVNwZWMudXNlRGVwdGhzKSB7CgkJICAgICAgaWYgKG9wdGlvbnMuZGVwdGhzKSB7CgkJICAgICAgICBkZXB0aHMgPSBjb250ZXh0ICE9IG9wdGlvbnMuZGVwdGhzWzBdID8gW2NvbnRleHRdLmNvbmNhdChvcHRpb25zLmRlcHRocykgOiBvcHRpb25zLmRlcHRoczsKCQkgICAgICB9IGVsc2UgewoJCSAgICAgICAgZGVwdGhzID0gW2NvbnRleHRdOwoJCSAgICAgIH0KCQkgICAgfQoKCQkgICAgZnVuY3Rpb24gbWFpbihjb250ZXh0IC8qLCBvcHRpb25zKi8pIHsKCQkgICAgICByZXR1cm4gJycgKyB0ZW1wbGF0ZVNwZWMubWFpbihjb250YWluZXIsIGNvbnRleHQsIGNvbnRhaW5lci5oZWxwZXJzLCBjb250YWluZXIucGFydGlhbHMsIGRhdGEsIGJsb2NrUGFyYW1zLCBkZXB0aHMpOwoJCSAgICB9CgkJICAgIG1haW4gPSBleGVjdXRlRGVjb3JhdG9ycyh0ZW1wbGF0ZVNwZWMubWFpbiwgbWFpbiwgY29udGFpbmVyLCBvcHRpb25zLmRlcHRocyB8fCBbXSwgZGF0YSwgYmxvY2tQYXJhbXMpOwoJCSAgICByZXR1cm4gbWFpbihjb250ZXh0LCBvcHRpb25zKTsKCQkgIH0KCQkgIHJldC5pc1RvcCA9IHRydWU7CgoJCSAgcmV0Ll9zZXR1cCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7CgkJICAgIGlmICghb3B0aW9ucy5wYXJ0aWFsKSB7CgkJICAgICAgY29udGFpbmVyLmhlbHBlcnMgPSBjb250YWluZXIubWVyZ2Uob3B0aW9ucy5oZWxwZXJzLCBlbnYuaGVscGVycyk7CgoJCSAgICAgIGlmICh0ZW1wbGF0ZVNwZWMudXNlUGFydGlhbCkgewoJCSAgICAgICAgY29udGFpbmVyLnBhcnRpYWxzID0gY29udGFpbmVyLm1lcmdlKG9wdGlvbnMucGFydGlhbHMsIGVudi5wYXJ0aWFscyk7CgkJICAgICAgfQoJCSAgICAgIGlmICh0ZW1wbGF0ZVNwZWMudXNlUGFydGlhbCB8fCB0ZW1wbGF0ZVNwZWMudXNlRGVjb3JhdG9ycykgewoJCSAgICAgICAgY29udGFpbmVyLmRlY29yYXRvcnMgPSBjb250YWluZXIubWVyZ2Uob3B0aW9ucy5kZWNvcmF0b3JzLCBlbnYuZGVjb3JhdG9ycyk7CgkJICAgICAgfQoJCSAgICB9IGVsc2UgewoJCSAgICAgIGNvbnRhaW5lci5oZWxwZXJzID0gb3B0aW9ucy5oZWxwZXJzOwoJCSAgICAgIGNvbnRhaW5lci5wYXJ0aWFscyA9IG9wdGlvbnMucGFydGlhbHM7CgkJICAgICAgY29udGFpbmVyLmRlY29yYXRvcnMgPSBvcHRpb25zLmRlY29yYXRvcnM7CgkJICAgIH0KCQkgIH07CgoJCSAgcmV0Ll9jaGlsZCA9IGZ1bmN0aW9uIChpLCBkYXRhLCBibG9ja1BhcmFtcywgZGVwdGhzKSB7CgkJICAgIGlmICh0ZW1wbGF0ZVNwZWMudXNlQmxvY2tQYXJhbXMgJiYgIWJsb2NrUGFyYW1zKSB7CgkJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ211c3QgcGFzcyBibG9jayBwYXJhbXMnKTsKCQkgICAgfQoJCSAgICBpZiAodGVtcGxhdGVTcGVjLnVzZURlcHRocyAmJiAhZGVwdGhzKSB7CgkJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ211c3QgcGFzcyBwYXJlbnQgZGVwdGhzJyk7CgkJICAgIH0KCgkJICAgIHJldHVybiB3cmFwUHJvZ3JhbShjb250YWluZXIsIGksIHRlbXBsYXRlU3BlY1tpXSwgZGF0YSwgMCwgYmxvY2tQYXJhbXMsIGRlcHRocyk7CgkJICB9OwoJCSAgcmV0dXJuIHJldDsKCQl9CgoJCWZ1bmN0aW9uIHdyYXBQcm9ncmFtKGNvbnRhaW5lciwgaSwgZm4sIGRhdGEsIGRlY2xhcmVkQmxvY2tQYXJhbXMsIGJsb2NrUGFyYW1zLCBkZXB0aHMpIHsKCQkgIGZ1bmN0aW9uIHByb2coY29udGV4dCkgewoJCSAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzFdOwoKCQkgICAgdmFyIGN1cnJlbnREZXB0aHMgPSBkZXB0aHM7CgkJICAgIGlmIChkZXB0aHMgJiYgY29udGV4dCAhPSBkZXB0aHNbMF0pIHsKCQkgICAgICBjdXJyZW50RGVwdGhzID0gW2NvbnRleHRdLmNvbmNhdChkZXB0aHMpOwoJCSAgICB9CgoJCSAgICByZXR1cm4gZm4oY29udGFpbmVyLCBjb250ZXh0LCBjb250YWluZXIuaGVscGVycywgY29udGFpbmVyLnBhcnRpYWxzLCBvcHRpb25zLmRhdGEgfHwgZGF0YSwgYmxvY2tQYXJhbXMgJiYgW29wdGlvbnMuYmxvY2tQYXJhbXNdLmNvbmNhdChibG9ja1BhcmFtcyksIGN1cnJlbnREZXB0aHMpOwoJCSAgfQoKCQkgIHByb2cgPSBleGVjdXRlRGVjb3JhdG9ycyhmbiwgcHJvZywgY29udGFpbmVyLCBkZXB0aHMsIGRhdGEsIGJsb2NrUGFyYW1zKTsKCgkJICBwcm9nLnByb2dyYW0gPSBpOwoJCSAgcHJvZy5kZXB0aCA9IGRlcHRocyA/IGRlcHRocy5sZW5ndGggOiAwOwoJCSAgcHJvZy5ibG9ja1BhcmFtcyA9IGRlY2xhcmVkQmxvY2tQYXJhbXMgfHwgMDsKCQkgIHJldHVybiBwcm9nOwoJCX0KCgkJZnVuY3Rpb24gcmVzb2x2ZVBhcnRpYWwocGFydGlhbCwgY29udGV4dCwgb3B0aW9ucykgewoJCSAgaWYgKCFwYXJ0aWFsKSB7CgkJICAgIGlmIChvcHRpb25zLm5hbWUgPT09ICdAcGFydGlhbC1ibG9jaycpIHsKCQkgICAgICB2YXIgZGF0YSA9IG9wdGlvbnMuZGF0YTsKCQkgICAgICB3aGlsZSAoZGF0YVsncGFydGlhbC1ibG9jayddID09PSBub29wKSB7CgkJICAgICAgICBkYXRhID0gZGF0YS5fcGFyZW50OwoJCSAgICAgIH0KCQkgICAgICBwYXJ0aWFsID0gZGF0YVsncGFydGlhbC1ibG9jayddOwoJCSAgICAgIGRhdGFbJ3BhcnRpYWwtYmxvY2snXSA9IG5vb3A7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgcGFydGlhbCA9IG9wdGlvbnMucGFydGlhbHNbb3B0aW9ucy5uYW1lXTsKCQkgICAgfQoJCSAgfSBlbHNlIGlmICghcGFydGlhbC5jYWxsICYmICFvcHRpb25zLm5hbWUpIHsKCQkgICAgLy8gVGhpcyBpcyBhIGR5bmFtaWMgcGFydGlhbCB0aGF0IHJldHVybmVkIGEgc3RyaW5nCgkJICAgIG9wdGlvbnMubmFtZSA9IHBhcnRpYWw7CgkJICAgIHBhcnRpYWwgPSBvcHRpb25zLnBhcnRpYWxzW3BhcnRpYWxdOwoJCSAgfQoJCSAgcmV0dXJuIHBhcnRpYWw7CgkJfQoKCQlmdW5jdGlvbiBpbnZva2VQYXJ0aWFsKHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpIHsKCQkgIG9wdGlvbnMucGFydGlhbCA9IHRydWU7CgkJICBpZiAob3B0aW9ucy5pZHMpIHsKCQkgICAgb3B0aW9ucy5kYXRhLmNvbnRleHRQYXRoID0gb3B0aW9ucy5pZHNbMF0gfHwgb3B0aW9ucy5kYXRhLmNvbnRleHRQYXRoOwoJCSAgfQoKCQkgIHZhciBwYXJ0aWFsQmxvY2sgPSB1bmRlZmluZWQ7CgkJICBpZiAob3B0aW9ucy5mbiAmJiBvcHRpb25zLmZuICE9PSBub29wKSB7CgkJICAgIG9wdGlvbnMuZGF0YSA9IF9iYXNlLmNyZWF0ZUZyYW1lKG9wdGlvbnMuZGF0YSk7CgkJICAgIHBhcnRpYWxCbG9jayA9IG9wdGlvbnMuZGF0YVsncGFydGlhbC1ibG9jayddID0gb3B0aW9ucy5mbjsKCgkJICAgIGlmIChwYXJ0aWFsQmxvY2sucGFydGlhbHMpIHsKCQkgICAgICBvcHRpb25zLnBhcnRpYWxzID0gVXRpbHMuZXh0ZW5kKHt9LCBvcHRpb25zLnBhcnRpYWxzLCBwYXJ0aWFsQmxvY2sucGFydGlhbHMpOwoJCSAgICB9CgkJICB9CgoJCSAgaWYgKHBhcnRpYWwgPT09IHVuZGVmaW5lZCAmJiBwYXJ0aWFsQmxvY2spIHsKCQkgICAgcGFydGlhbCA9IHBhcnRpYWxCbG9jazsKCQkgIH0KCgkJICBpZiAocGFydGlhbCA9PT0gdW5kZWZpbmVkKSB7CgkJICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdUaGUgcGFydGlhbCAnICsgb3B0aW9ucy5uYW1lICsgJyBjb3VsZCBub3QgYmUgZm91bmQnKTsKCQkgIH0gZWxzZSBpZiAocGFydGlhbCBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CgkJICAgIHJldHVybiBwYXJ0aWFsKGNvbnRleHQsIG9wdGlvbnMpOwoJCSAgfQoJCX0KCgkJZnVuY3Rpb24gbm9vcCgpIHsKCQkgIHJldHVybiAnJzsKCQl9CgoJCWZ1bmN0aW9uIGluaXREYXRhKGNvbnRleHQsIGRhdGEpIHsKCQkgIGlmICghZGF0YSB8fCAhKCdyb290JyBpbiBkYXRhKSkgewoJCSAgICBkYXRhID0gZGF0YSA/IF9iYXNlLmNyZWF0ZUZyYW1lKGRhdGEpIDoge307CgkJICAgIGRhdGEucm9vdCA9IGNvbnRleHQ7CgkJICB9CgkJICByZXR1cm4gZGF0YTsKCQl9CgoJCWZ1bmN0aW9uIGV4ZWN1dGVEZWNvcmF0b3JzKGZuLCBwcm9nLCBjb250YWluZXIsIGRlcHRocywgZGF0YSwgYmxvY2tQYXJhbXMpIHsKCQkgIGlmIChmbi5kZWNvcmF0b3IpIHsKCQkgICAgdmFyIHByb3BzID0ge307CgkJICAgIHByb2cgPSBmbi5kZWNvcmF0b3IocHJvZywgcHJvcHMsIGNvbnRhaW5lciwgZGVwdGhzICYmIGRlcHRoc1swXSwgZGF0YSwgYmxvY2tQYXJhbXMsIGRlcHRocyk7CgkJICAgIFV0aWxzLmV4dGVuZChwcm9nLCBwcm9wcyk7CgkJICB9CgkJICByZXR1cm4gcHJvZzsKCQl9CgoJLyoqKi8gfSwKCS8qIDIzICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCkgey8qIGdsb2JhbCB3aW5kb3cgKi8KCQkndXNlIHN0cmljdCc7CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IGZ1bmN0aW9uIChIYW5kbGViYXJzKSB7CgkJICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoJCSAgdmFyIHJvb3QgPSB0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbCA6IHdpbmRvdywKCQkgICAgICAkSGFuZGxlYmFycyA9IHJvb3QuSGFuZGxlYmFyczsKCQkgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCgkJICBIYW5kbGViYXJzLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7CgkJICAgIGlmIChyb290LkhhbmRsZWJhcnMgPT09IEhhbmRsZWJhcnMpIHsKCQkgICAgICByb290LkhhbmRsZWJhcnMgPSAkSGFuZGxlYmFyczsKCQkgICAgfQoJCSAgICByZXR1cm4gSGFuZGxlYmFyczsKCQkgIH07CgkJfTsKCgkJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgkJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSkpKQoKCS8qKiovIH0sCgkvKiAyNCAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJCSd1c2Ugc3RyaWN0JzsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCQl2YXIgQVNUID0gewoJCSAgLy8gUHVibGljIEFQSSB1c2VkIHRvIGV2YWx1YXRlIGRlcml2ZWQgYXR0cmlidXRlcyByZWdhcmRpbmcgQVNUIG5vZGVzCgkJICBoZWxwZXJzOiB7CgkJICAgIC8vIGEgbXVzdGFjaGUgaXMgZGVmaW5pdGVseSBhIGhlbHBlciBpZjoKCQkgICAgLy8gKiBpdCBpcyBhbiBlbGlnaWJsZSBoZWxwZXIsIGFuZAoJCSAgICAvLyAqIGl0IGhhcyBhdCBsZWFzdCBvbmUgcGFyYW1ldGVyIG9yIGhhc2ggc2VnbWVudAoJCSAgICBoZWxwZXJFeHByZXNzaW9uOiBmdW5jdGlvbiBoZWxwZXJFeHByZXNzaW9uKG5vZGUpIHsKCQkgICAgICByZXR1cm4gbm9kZS50eXBlID09PSAnU3ViRXhwcmVzc2lvbicgfHwgKG5vZGUudHlwZSA9PT0gJ011c3RhY2hlU3RhdGVtZW50JyB8fCBub2RlLnR5cGUgPT09ICdCbG9ja1N0YXRlbWVudCcpICYmICEhKG5vZGUucGFyYW1zICYmIG5vZGUucGFyYW1zLmxlbmd0aCB8fCBub2RlLmhhc2gpOwoJCSAgICB9LAoKCQkgICAgc2NvcGVkSWQ6IGZ1bmN0aW9uIHNjb3BlZElkKHBhdGgpIHsKCQkgICAgICByZXR1cm4gKC9eXC58dGhpc1xiLy50ZXN0KHBhdGgub3JpZ2luYWwpCgkJICAgICAgKTsKCQkgICAgfSwKCgkJICAgIC8vIGFuIElEIGlzIHNpbXBsZSBpZiBpdCBvbmx5IGhhcyBvbmUgcGFydCwgYW5kIHRoYXQgcGFydCBpcyBub3QKCQkgICAgLy8gYC4uYCBvciBgdGhpc2AuCgkJICAgIHNpbXBsZUlkOiBmdW5jdGlvbiBzaW1wbGVJZChwYXRoKSB7CgkJICAgICAgcmV0dXJuIHBhdGgucGFydHMubGVuZ3RoID09PSAxICYmICFBU1QuaGVscGVycy5zY29wZWRJZChwYXRoKSAmJiAhcGF0aC5kZXB0aDsKCQkgICAgfQoJCSAgfQoJCX07CgoJCS8vIE11c3QgYmUgZXhwb3J0ZWQgYXMgYW4gb2JqZWN0IHJhdGhlciB0aGFuIHRoZSByb290IG9mIHRoZSBtb2R1bGUgYXMgdGhlIGppc29uIGxleGVyCgkJLy8gbXVzdCBtb2RpZnkgdGhlIG9iamVjdCB0byBvcGVyYXRlIHByb3Blcmx5LgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IEFTVDsKCQltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9LAoJLyogMjUgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOwoKCQl2YXIgX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpWydkZWZhdWx0J107CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgkJZXhwb3J0cy5wYXJzZSA9IHBhcnNlOwoKCQl2YXIgX3BhcnNlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpOwoKCQl2YXIgX3BhcnNlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wYXJzZXIpOwoKCQl2YXIgX3doaXRlc3BhY2VDb250cm9sID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNyk7CgoJCXZhciBfd2hpdGVzcGFjZUNvbnRyb2wyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfd2hpdGVzcGFjZUNvbnRyb2wpOwoKCQl2YXIgX2hlbHBlcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KTsKCgkJdmFyIEhlbHBlcnMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfaGVscGVycyk7CgoJCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwoKCQlleHBvcnRzLnBhcnNlciA9IF9wYXJzZXIyWydkZWZhdWx0J107CgoJCXZhciB5eSA9IHt9OwoJCV91dGlscy5leHRlbmQoeXksIEhlbHBlcnMpOwoKCQlmdW5jdGlvbiBwYXJzZShpbnB1dCwgb3B0aW9ucykgewoJCSAgLy8gSnVzdCByZXR1cm4gaWYgYW4gYWxyZWFkeS1jb21waWxlZCBBU1Qgd2FzIHBhc3NlZCBpbi4KCQkgIGlmIChpbnB1dC50eXBlID09PSAnUHJvZ3JhbScpIHsKCQkgICAgcmV0dXJuIGlucHV0OwoJCSAgfQoKCQkgIF9wYXJzZXIyWydkZWZhdWx0J10ueXkgPSB5eTsKCgkJICAvLyBBbHRlcmluZyB0aGUgc2hhcmVkIG9iamVjdCBoZXJlLCBidXQgdGhpcyBpcyBvayBhcyBwYXJzZXIgaXMgYSBzeW5jIG9wZXJhdGlvbgoJCSAgeXkubG9jSW5mbyA9IGZ1bmN0aW9uIChsb2NJbmZvKSB7CgkJICAgIHJldHVybiBuZXcgeXkuU291cmNlTG9jYXRpb24ob3B0aW9ucyAmJiBvcHRpb25zLnNyY05hbWUsIGxvY0luZm8pOwoJCSAgfTsKCgkJICB2YXIgc3RyaXAgPSBuZXcgX3doaXRlc3BhY2VDb250cm9sMlsnZGVmYXVsdCddKG9wdGlvbnMpOwoJCSAgcmV0dXJuIHN0cmlwLmFjY2VwdChfcGFyc2VyMlsnZGVmYXVsdCddLnBhcnNlKGlucHV0KSk7CgkJfQoKCS8qKiovIH0sCgkvKiAyNiAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJCS8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCgkJLyogSmlzb24gZ2VuZXJhdGVkIHBhcnNlciAqLwoJCSJ1c2Ugc3RyaWN0IjsKCgkJdmFyIGhhbmRsZWJhcnMgPSAoZnVuY3Rpb24gKCkgewoJCSAgICB2YXIgcGFyc2VyID0geyB0cmFjZTogZnVuY3Rpb24gdHJhY2UoKSB7fSwKCQkgICAgICAgIHl5OiB7fSwKCQkgICAgICAgIHN5bWJvbHNfOiB7ICJlcnJvciI6IDIsICJyb290IjogMywgInByb2dyYW0iOiA0LCAiRU9GIjogNSwgInByb2dyYW1fcmVwZXRpdGlvbjAiOiA2LCAic3RhdGVtZW50IjogNywgIm11c3RhY2hlIjogOCwgImJsb2NrIjogOSwgInJhd0Jsb2NrIjogMTAsICJwYXJ0aWFsIjogMTEsICJwYXJ0aWFsQmxvY2siOiAxMiwgImNvbnRlbnQiOiAxMywgIkNPTU1FTlQiOiAxNCwgIkNPTlRFTlQiOiAxNSwgIm9wZW5SYXdCbG9jayI6IDE2LCAicmF3QmxvY2tfcmVwZXRpdGlvbl9wbHVzMCI6IDE3LCAiRU5EX1JBV19CTE9DSyI6IDE4LCAiT1BFTl9SQVdfQkxPQ0siOiAxOSwgImhlbHBlck5hbWUiOiAyMCwgIm9wZW5SYXdCbG9ja19yZXBldGl0aW9uMCI6IDIxLCAib3BlblJhd0Jsb2NrX29wdGlvbjAiOiAyMiwgIkNMT1NFX1JBV19CTE9DSyI6IDIzLCAib3BlbkJsb2NrIjogMjQsICJibG9ja19vcHRpb24wIjogMjUsICJjbG9zZUJsb2NrIjogMjYsICJvcGVuSW52ZXJzZSI6IDI3LCAiYmxvY2tfb3B0aW9uMSI6IDI4LCAiT1BFTl9CTE9DSyI6IDI5LCAib3BlbkJsb2NrX3JlcGV0aXRpb24wIjogMzAsICJvcGVuQmxvY2tfb3B0aW9uMCI6IDMxLCAib3BlbkJsb2NrX29wdGlvbjEiOiAzMiwgIkNMT1NFIjogMzMsICJPUEVOX0lOVkVSU0UiOiAzNCwgIm9wZW5JbnZlcnNlX3JlcGV0aXRpb24wIjogMzUsICJvcGVuSW52ZXJzZV9vcHRpb24wIjogMzYsICJvcGVuSW52ZXJzZV9vcHRpb24xIjogMzcsICJvcGVuSW52ZXJzZUNoYWluIjogMzgsICJPUEVOX0lOVkVSU0VfQ0hBSU4iOiAzOSwgIm9wZW5JbnZlcnNlQ2hhaW5fcmVwZXRpdGlvbjAiOiA0MCwgIm9wZW5JbnZlcnNlQ2hhaW5fb3B0aW9uMCI6IDQxLCAib3BlbkludmVyc2VDaGFpbl9vcHRpb24xIjogNDIsICJpbnZlcnNlQW5kUHJvZ3JhbSI6IDQzLCAiSU5WRVJTRSI6IDQ0LCAiaW52ZXJzZUNoYWluIjogNDUsICJpbnZlcnNlQ2hhaW5fb3B0aW9uMCI6IDQ2LCAiT1BFTl9FTkRCTE9DSyI6IDQ3LCAiT1BFTiI6IDQ4LCAibXVzdGFjaGVfcmVwZXRpdGlvbjAiOiA0OSwgIm11c3RhY2hlX29wdGlvbjAiOiA1MCwgIk9QRU5fVU5FU0NBUEVEIjogNTEsICJtdXN0YWNoZV9yZXBldGl0aW9uMSI6IDUyLCAibXVzdGFjaGVfb3B0aW9uMSI6IDUzLCAiQ0xPU0VfVU5FU0NBUEVEIjogNTQsICJPUEVOX1BBUlRJQUwiOiA1NSwgInBhcnRpYWxOYW1lIjogNTYsICJwYXJ0aWFsX3JlcGV0aXRpb24wIjogNTcsICJwYXJ0aWFsX29wdGlvbjAiOiA1OCwgIm9wZW5QYXJ0aWFsQmxvY2siOiA1OSwgIk9QRU5fUEFSVElBTF9CTE9DSyI6IDYwLCAib3BlblBhcnRpYWxCbG9ja19yZXBldGl0aW9uMCI6IDYxLCAib3BlblBhcnRpYWxCbG9ja19vcHRpb24wIjogNjIsICJwYXJhbSI6IDYzLCAic2V4cHIiOiA2NCwgIk9QRU5fU0VYUFIiOiA2NSwgInNleHByX3JlcGV0aXRpb24wIjogNjYsICJzZXhwcl9vcHRpb24wIjogNjcsICJDTE9TRV9TRVhQUiI6IDY4LCAiaGFzaCI6IDY5LCAiaGFzaF9yZXBldGl0aW9uX3BsdXMwIjogNzAsICJoYXNoU2VnbWVudCI6IDcxLCAiSUQiOiA3MiwgIkVRVUFMUyI6IDczLCAiYmxvY2tQYXJhbXMiOiA3NCwgIk9QRU5fQkxPQ0tfUEFSQU1TIjogNzUsICJibG9ja1BhcmFtc19yZXBldGl0aW9uX3BsdXMwIjogNzYsICJDTE9TRV9CTE9DS19QQVJBTVMiOiA3NywgInBhdGgiOiA3OCwgImRhdGFOYW1lIjogNzksICJTVFJJTkciOiA4MCwgIk5VTUJFUiI6IDgxLCAiQk9PTEVBTiI6IDgyLCAiVU5ERUZJTkVEIjogODMsICJOVUxMIjogODQsICJEQVRBIjogODUsICJwYXRoU2VnbWVudHMiOiA4NiwgIlNFUCI6IDg3LCAiJGFjY2VwdCI6IDAsICIkZW5kIjogMSB9LAoJCSAgICAgICAgdGVybWluYWxzXzogeyAyOiAiZXJyb3IiLCA1OiAiRU9GIiwgMTQ6ICJDT01NRU5UIiwgMTU6ICJDT05URU5UIiwgMTg6ICJFTkRfUkFXX0JMT0NLIiwgMTk6ICJPUEVOX1JBV19CTE9DSyIsIDIzOiAiQ0xPU0VfUkFXX0JMT0NLIiwgMjk6ICJPUEVOX0JMT0NLIiwgMzM6ICJDTE9TRSIsIDM0OiAiT1BFTl9JTlZFUlNFIiwgMzk6ICJPUEVOX0lOVkVSU0VfQ0hBSU4iLCA0NDogIklOVkVSU0UiLCA0NzogIk9QRU5fRU5EQkxPQ0siLCA0ODogIk9QRU4iLCA1MTogIk9QRU5fVU5FU0NBUEVEIiwgNTQ6ICJDTE9TRV9VTkVTQ0FQRUQiLCA1NTogIk9QRU5fUEFSVElBTCIsIDYwOiAiT1BFTl9QQVJUSUFMX0JMT0NLIiwgNjU6ICJPUEVOX1NFWFBSIiwgNjg6ICJDTE9TRV9TRVhQUiIsIDcyOiAiSUQiLCA3MzogIkVRVUFMUyIsIDc1OiAiT1BFTl9CTE9DS19QQVJBTVMiLCA3NzogIkNMT1NFX0JMT0NLX1BBUkFNUyIsIDgwOiAiU1RSSU5HIiwgODE6ICJOVU1CRVIiLCA4MjogIkJPT0xFQU4iLCA4MzogIlVOREVGSU5FRCIsIDg0OiAiTlVMTCIsIDg1OiAiREFUQSIsIDg3OiAiU0VQIg==", "base64"));
  res.write(new Buffer("IH0sCgkJICAgICAgICBwcm9kdWN0aW9uc186IFswLCBbMywgMl0sIFs0LCAxXSwgWzcsIDFdLCBbNywgMV0sIFs3LCAxXSwgWzcsIDFdLCBbNywgMV0sIFs3LCAxXSwgWzcsIDFdLCBbMTMsIDFdLCBbMTAsIDNdLCBbMTYsIDVdLCBbOSwgNF0sIFs5LCA0XSwgWzI0LCA2XSwgWzI3LCA2XSwgWzM4LCA2XSwgWzQzLCAyXSwgWzQ1LCAzXSwgWzQ1LCAxXSwgWzI2LCAzXSwgWzgsIDVdLCBbOCwgNV0sIFsxMSwgNV0sIFsxMiwgM10sIFs1OSwgNV0sIFs2MywgMV0sIFs2MywgMV0sIFs2NCwgNV0sIFs2OSwgMV0sIFs3MSwgM10sIFs3NCwgM10sIFsyMCwgMV0sIFsyMCwgMV0sIFsyMCwgMV0sIFsyMCwgMV0sIFsyMCwgMV0sIFsyMCwgMV0sIFsyMCwgMV0sIFs1NiwgMV0sIFs1NiwgMV0sIFs3OSwgMl0sIFs3OCwgMV0sIFs4NiwgM10sIFs4NiwgMV0sIFs2LCAwXSwgWzYsIDJdLCBbMTcsIDFdLCBbMTcsIDJdLCBbMjEsIDBdLCBbMjEsIDJdLCBbMjIsIDBdLCBbMjIsIDFdLCBbMjUsIDBdLCBbMjUsIDFdLCBbMjgsIDBdLCBbMjgsIDFdLCBbMzAsIDBdLCBbMzAsIDJdLCBbMzEsIDBdLCBbMzEsIDFdLCBbMzIsIDBdLCBbMzIsIDFdLCBbMzUsIDBdLCBbMzUsIDJdLCBbMzYsIDBdLCBbMzYsIDFdLCBbMzcsIDBdLCBbMzcsIDFdLCBbNDAsIDBdLCBbNDAsIDJdLCBbNDEsIDBdLCBbNDEsIDFdLCBbNDIsIDBdLCBbNDIsIDFdLCBbNDYsIDBdLCBbNDYsIDFdLCBbNDksIDBdLCBbNDksIDJdLCBbNTAsIDBdLCBbNTAsIDFdLCBbNTIsIDBdLCBbNTIsIDJdLCBbNTMsIDBdLCBbNTMsIDFdLCBbNTcsIDBdLCBbNTcsIDJdLCBbNTgsIDBdLCBbNTgsIDFdLCBbNjEsIDBdLCBbNjEsIDJdLCBbNjIsIDBdLCBbNjIsIDFdLCBbNjYsIDBdLCBbNjYsIDJdLCBbNjcsIDBdLCBbNjcsIDFdLCBbNzAsIDFdLCBbNzAsIDJdLCBbNzYsIDFdLCBbNzYsIDJdXSwKCQkgICAgICAgIHBlcmZvcm1BY3Rpb246IGZ1bmN0aW9uIGFub255bW91cyh5eXRleHQsIHl5bGVuZywgeXlsaW5lbm8sIHl5LCB5eXN0YXRlLCAkJCwgXyQKCQkgICAgICAgIC8qKi8pIHsKCgkJICAgICAgICAgICAgdmFyICQwID0gJCQubGVuZ3RoIC0gMTsKCQkgICAgICAgICAgICBzd2l0Y2ggKHl5c3RhdGUpIHsKCQkgICAgICAgICAgICAgICAgY2FzZSAxOgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQkWyQwIC0gMV07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geXkucHJlcGFyZVByb2dyYW0oJCRbJDBdKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDM6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSAkJFskMF07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA0OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNToKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9ICQkWyQwXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDY6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSAkJFskMF07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA3OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgODoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9ICQkWyQwXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDk6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0NvbW1lbnRTdGF0ZW1lbnQnLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB5eS5zdHJpcENvbW1lbnQoJCRbJDBdKSwKCQkgICAgICAgICAgICAgICAgICAgICAgICBzdHJpcDogeXkuc3RyaXBGbGFncygkJFskMF0sICQkWyQwXSksCgkJICAgICAgICAgICAgICAgICAgICAgICAgbG9jOiB5eS5sb2NJbmZvKHRoaXMuXyQpCgkJICAgICAgICAgICAgICAgICAgICB9OwoKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDEwOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gewoJCSAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdDb250ZW50U3RhdGVtZW50JywKCQkgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbDogJCRbJDBdLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAkJFskMF0sCgkJICAgICAgICAgICAgICAgICAgICAgICAgbG9jOiB5eS5sb2NJbmZvKHRoaXMuXyQpCgkJICAgICAgICAgICAgICAgICAgICB9OwoKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDExOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geXkucHJlcGFyZVJhd0Jsb2NrKCQkWyQwIC0gMl0sICQkWyQwIC0gMV0sICQkWyQwXSwgdGhpcy5fJCk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxMjoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgcGF0aDogJCRbJDAgLSAzXSwgcGFyYW1zOiAkJFskMCAtIDJdLCBoYXNoOiAkJFskMCAtIDFdIH07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxMzoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHl5LnByZXBhcmVCbG9jaygkJFskMCAtIDNdLCAkJFskMCAtIDJdLCAkJFskMCAtIDFdLCAkJFskMF0sIGZhbHNlLCB0aGlzLl8kKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDE0OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geXkucHJlcGFyZUJsb2NrKCQkWyQwIC0gM10sICQkWyQwIC0gMl0sICQkWyQwIC0gMV0sICQkWyQwXSwgdHJ1ZSwgdGhpcy5fJCk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxNToKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgb3BlbjogJCRbJDAgLSA1XSwgcGF0aDogJCRbJDAgLSA0XSwgcGFyYW1zOiAkJFskMCAtIDNdLCBoYXNoOiAkJFskMCAtIDJdLCBibG9ja1BhcmFtczogJCRbJDAgLSAxXSwgc3RyaXA6IHl5LnN0cmlwRmxhZ3MoJCRbJDAgLSA1XSwgJCRbJDBdKSB9OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTY6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7IHBhdGg6ICQkWyQwIC0gNF0sIHBhcmFtczogJCRbJDAgLSAzXSwgaGFzaDogJCRbJDAgLSAyXSwgYmxvY2tQYXJhbXM6ICQkWyQwIC0gMV0sIHN0cmlwOiB5eS5zdHJpcEZsYWdzKCQkWyQwIC0gNV0sICQkWyQwXSkgfTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDE3OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyBwYXRoOiAkJFskMCAtIDRdLCBwYXJhbXM6ICQkWyQwIC0gM10sIGhhc2g6ICQkWyQwIC0gMl0sIGJsb2NrUGFyYW1zOiAkJFskMCAtIDFdLCBzdHJpcDogeXkuc3RyaXBGbGFncygkJFskMCAtIDVdLCAkJFskMF0pIH07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxODoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgc3RyaXA6IHl5LnN0cmlwRmxhZ3MoJCRbJDAgLSAxXSwgJCRbJDAgLSAxXSksIHByb2dyYW06ICQkWyQwXSB9OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTk6CgkJICAgICAgICAgICAgICAgICAgICB2YXIgaW52ZXJzZSA9IHl5LnByZXBhcmVCbG9jaygkJFskMCAtIDJdLCAkJFskMCAtIDFdLCAkJFskMF0sICQkWyQwXSwgZmFsc2UsIHRoaXMuXyQpLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIHByb2dyYW0gPSB5eS5wcmVwYXJlUHJvZ3JhbShbaW52ZXJzZV0sICQkWyQwIC0gMV0ubG9jKTsKCQkgICAgICAgICAgICAgICAgICAgIHByb2dyYW0uY2hhaW5lZCA9IHRydWU7CgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyBzdHJpcDogJCRbJDAgLSAyXS5zdHJpcCwgcHJvZ3JhbTogcHJvZ3JhbSwgY2hhaW46IHRydWUgfTsKCgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyMDoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9ICQkWyQwXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDIxOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyBwYXRoOiAkJFskMCAtIDFdLCBzdHJpcDogeXkuc3RyaXBGbGFncygkJFskMCAtIDJdLCAkJFskMF0pIH07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyMjoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHl5LnByZXBhcmVNdXN0YWNoZSgkJFskMCAtIDNdLCAkJFskMCAtIDJdLCAkJFskMCAtIDFdLCAkJFskMCAtIDRdLCB5eS5zdHJpcEZsYWdzKCQkWyQwIC0gNF0sICQkWyQwXSksIHRoaXMuXyQpOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMjM6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB5eS5wcmVwYXJlTXVzdGFjaGUoJCRbJDAgLSAzXSwgJCRbJDAgLSAyXSwgJCRbJDAgLSAxXSwgJCRbJDAgLSA0XSwgeXkuc3RyaXBGbGFncygkJFskMCAtIDRdLCAkJFskMF0pLCB0aGlzLl8kKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDI0OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gewoJCSAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdQYXJ0aWFsU3RhdGVtZW50JywKCQkgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAkJFskMCAtIDNdLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczogJCRbJDAgLSAyXSwKCQkgICAgICAgICAgICAgICAgICAgICAgICBoYXNoOiAkJFskMCAtIDFdLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIGluZGVudDogJycsCgkJICAgICAgICAgICAgICAgICAgICAgICAgc3RyaXA6IHl5LnN0cmlwRmxhZ3MoJCRbJDAgLSA0XSwgJCRbJDBdKSwKCQkgICAgICAgICAgICAgICAgICAgICAgICBsb2M6IHl5LmxvY0luZm8odGhpcy5fJCkKCQkgICAgICAgICAgICAgICAgICAgIH07CgoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMjU6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB5eS5wcmVwYXJlUGFydGlhbEJsb2NrKCQkWyQwIC0gMl0sICQkWyQwIC0gMV0sICQkWyQwXSwgdGhpcy5fJCk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyNjoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgcGF0aDogJCRbJDAgLSAzXSwgcGFyYW1zOiAkJFskMCAtIDJdLCBoYXNoOiAkJFskMCAtIDFdLCBzdHJpcDogeXkuc3RyaXBGbGFncygkJFskMCAtIDRdLCAkJFskMF0pIH07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyNzoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9ICQkWyQwXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDI4OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMjk6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1N1YkV4cHJlc3Npb24nLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6ICQkWyQwIC0gM10sCgkJICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiAkJFskMCAtIDJdLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIGhhc2g6ICQkWyQwIC0gMV0sCgkJICAgICAgICAgICAgICAgICAgICAgICAgbG9jOiB5eS5sb2NJbmZvKHRoaXMuXyQpCgkJICAgICAgICAgICAgICAgICAgICB9OwoKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDMwOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyB0eXBlOiAnSGFzaCcsIHBhaXJzOiAkJFskMF0sIGxvYzogeXkubG9jSW5mbyh0aGlzLl8kKSB9OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzE6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB7IHR5cGU6ICdIYXNoUGFpcicsIGtleTogeXkuaWQoJCRbJDAgLSAyXSksIHZhbHVlOiAkJFskMF0sIGxvYzogeXkubG9jSW5mbyh0aGlzLl8kKSB9OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzI6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSB5eS5pZCgkJFskMCAtIDFdKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDMzOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gJCRbJDBdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzQ6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSAkJFskMF07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAzNToKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgdHlwZTogJ1N0cmluZ0xpdGVyYWwnLCB2YWx1ZTogJCRbJDBdLCBvcmlnaW5hbDogJCRbJDBdLCBsb2M6IHl5LmxvY0luZm8odGhpcy5fJCkgfTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDM2OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyB0eXBlOiAnTnVtYmVyTGl0ZXJhbCcsIHZhbHVlOiBOdW1iZXIoJCRbJDBdKSwgb3JpZ2luYWw6IE51bWJlcigkJFskMF0pLCBsb2M6IHl5LmxvY0luZm8odGhpcy5fJCkgfTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDM3OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyB0eXBlOiAnQm9vbGVhbkxpdGVyYWwnLCB2YWx1ZTogJCRbJDBdID09PSAndHJ1ZScsIG9yaWdpbmFsOiAkJFskMF0gPT09ICd0cnVlJywgbG9jOiB5eS5sb2NJbmZvKHRoaXMuXyQpIH07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAzODoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IHsgdHlwZTogJ1VuZGVmaW5lZExpdGVyYWwnLCBvcmlnaW5hbDogdW5kZWZpbmVkLCB2YWx1ZTogdW5kZWZpbmVkLCBsb2M6IHl5LmxvY0luZm8odGhpcy5fJCkgfTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDM5OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geyB0eXBlOiAnTnVsbExpdGVyYWwnLCBvcmlnaW5hbDogbnVsbCwgdmFsdWU6IG51bGwsIGxvYzogeXkubG9jSW5mbyh0aGlzLl8kKSB9OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNDA6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSAkJFskMF07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA0MToKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9ICQkWyQwXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDQyOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geXkucHJlcGFyZVBhdGgodHJ1ZSwgJCRbJDBdLCB0aGlzLl8kKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDQzOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0geXkucHJlcGFyZVBhdGgoZmFsc2UsICQkWyQwXSwgdGhpcy5fJCk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA0NDoKCQkgICAgICAgICAgICAgICAgICAgICQkWyQwIC0gMl0ucHVzaCh7IHBhcnQ6IHl5LmlkKCQkWyQwXSksIG9yaWdpbmFsOiAkJFskMF0sIHNlcGFyYXRvcjogJCRbJDAgLSAxXSB9KTt0aGlzLiQgPSAkJFskMCAtIDJdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNDU6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSBbeyBwYXJ0OiB5eS5pZCgkJFskMF0pLCBvcmlnaW5hbDogJCRbJDBdIH1dOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNDY6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSBbXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDQ3OgoJCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA0ODoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFskJFskMF1dOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNDk6CgkJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDFdLnB1c2goJCRbJDBdKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDUwOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gW107CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA1MToKCQkgICAgICAgICAgICAgICAgICAgICQkWyQwIC0gMV0ucHVzaCgkJFskMF0pOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNTg6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSBbXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDU5OgoJCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA2NDoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFtdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNjU6CgkJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDFdLnB1c2goJCRbJDBdKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDcwOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gW107CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA3MToKCQkgICAgICAgICAgICAgICAgICAgICQkWyQwIC0gMV0ucHVzaCgkJFskMF0pOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNzg6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSBbXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDc5OgoJCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA4MjoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFtdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgODM6CgkJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDFdLnB1c2goJCRbJDBdKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDg2OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gW107CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA4NzoKCQkgICAgICAgICAgICAgICAgICAgICQkWyQwIC0gMV0ucHVzaCgkJFskMF0pOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgOTA6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSBbXTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDkxOgoJCSAgICAgICAgICAgICAgICAgICAgJCRbJDAgLSAxXS5wdXNoKCQkWyQwXSk7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA5NDoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuJCA9IFtdOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgOTU6CgkJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDFdLnB1c2goJCRbJDBdKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDk4OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gWyQkWyQwXV07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA5OToKCQkgICAgICAgICAgICAgICAgICAgICQkWyQwIC0gMV0ucHVzaCgkJFskMF0pOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTAwOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy4kID0gWyQkWyQwXV07CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxMDE6CgkJICAgICAgICAgICAgICAgICAgICAkJFskMCAtIDFdLnB1c2goJCRbJDBdKTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgIH0KCQkgICAgICAgIH0sCgkJICAgICAgICB0YWJsZTogW3sgMzogMSwgNDogMiwgNTogWzIsIDQ2XSwgNjogMywgMTQ6IFsyLCA0Nl0sIDE1OiBbMiwgNDZdLCAxOTogWzIsIDQ2XSwgMjk6IFsyLCA0Nl0sIDM0OiBbMiwgNDZdLCA0ODogWzIsIDQ2XSwgNTE6IFsyLCA0Nl0sIDU1OiBbMiwgNDZdLCA2MDogWzIsIDQ2XSB9LCB7IDE6IFszXSB9LCB7IDU6IFsxLCA0XSB9LCB7IDU6IFsyLCAyXSwgNzogNSwgODogNiwgOTogNywgMTA6IDgsIDExOiA5LCAxMjogMTAsIDEzOiAxMSwgMTQ6IFsxLCAxMl0sIDE1OiBbMSwgMjBdLCAxNjogMTcsIDE5OiBbMSwgMjNdLCAyNDogMTUsIDI3OiAxNiwgMjk6IFsxLCAyMV0sIDM0OiBbMSwgMjJdLCAzOTogWzIsIDJdLCA0NDogWzIsIDJdLCA0NzogWzIsIDJdLCA0ODogWzEsIDEzXSwgNTE6IFsxLCAxNF0sIDU1OiBbMSwgMThdLCA1OTogMTksIDYwOiBbMSwgMjRdIH0sIHsgMTogWzIsIDFdIH0sIHsgNTogWzIsIDQ3XSwgMTQ6IFsyLCA0N10sIDE1OiBbMiwgNDddLCAxOTogWzIsIDQ3XSwgMjk6IFsyLCA0N10sIDM0OiBbMiwgNDddLCAzOTogWzIsIDQ3XSwgNDQ6IFsyLCA0N10sIDQ3OiBbMiwgNDddLCA0ODogWzIsIDQ3XSwgNTE6IFsyLCA0N10sIDU1OiBbMiwgNDddLCA2MDogWzIsIDQ3XSB9LCB7IDU6IFsyLCAzXSwgMTQ6IFsyLCAzXSwgMTU6IFsyLCAzXSwgMTk6IFsyLCAzXSwgMjk6IFsyLCAzXSwgMzQ6IFsyLCAzXSwgMzk6IFsyLCAzXSwgNDQ6IFsyLCAzXSwgNDc6IFsyLCAzXSwgNDg6IFsyLCAzXSwgNTE6IFsyLCAzXSwgNTU6IFsyLCAzXSwgNjA6IFsyLCAzXSB9LCB7IDU6IFsyLCA0XSwgMTQ6IFsyLCA0XSwgMTU6IFsyLCA0XSwgMTk6IFsyLCA0XSwgMjk6IFsyLCA0XSwgMzQ6IFsyLCA0XSwgMzk6IFsyLCA0XSwgNDQ6IFsyLCA0XSwgNDc6IFsyLCA0XSwgNDg6IFsyLCA0XSwgNTE6IFsyLCA0XSwgNTU6IFsyLCA0XSwgNjA6IFsyLCA0XSB9LCB7IDU6IFsyLCA1XSwgMTQ6IFsyLCA1XSwgMTU6IFsyLCA1XSwgMTk6IFsyLCA1XSwgMjk6IFsyLCA1XSwgMzQ6IFsyLCA1XSwgMzk6IFsyLCA1XSwgNDQ6IFsyLCA1XSwgNDc6IFsyLCA1XSwgNDg6IFsyLCA1XSwgNTE6IFsyLCA1XSwgNTU6IFsyLCA1XSwgNjA6IFsyLCA1XSB9LCB7IDU6IFsyLCA2XSwgMTQ6IFsyLCA2XSwgMTU6IFsyLCA2XSwgMTk6IFsyLCA2XSwgMjk6IFsyLCA2XSwgMzQ6IFsyLCA2XSwgMzk6IFsyLCA2XSwgNDQ6IFsyLCA2XSwgNDc6IFsyLCA2XSwgNDg6IFsyLCA2XSwgNTE6IFsyLCA2XSwgNTU6IFsyLCA2XSwgNjA6IFsyLCA2XSB9LCB7IDU6IFsyLCA3XSwgMTQ6IFsyLCA3XSwgMTU6IFsyLCA3XSwgMTk6IFsyLCA3XSwgMjk6IFsyLCA3XSwgMzQ6IFsyLCA3XSwgMzk6IFsyLCA3XSwgNDQ6IFsyLCA3XSwgNDc6IFsyLCA3XSwgNDg6IFsyLCA3XSwgNTE6IFsyLCA3XSwgNTU6IFsyLCA3XSwgNjA6IFsyLCA3XSB9LCB7IDU6IFsyLCA4XSwgMTQ6IFsyLCA4XSwgMTU6IFsyLCA4XSwgMTk6IFsyLCA4XSwgMjk6IFsyLCA4XSwgMzQ6IFsyLCA4XSwgMzk6IFsyLCA4XSwgNDQ6IFsyLCA4XSwgNDc6IFsyLCA4XSwgNDg6IFsyLCA4XSwgNTE6IFsyLCA4XSwgNTU6IFsyLCA4XSwgNjA6IFsyLCA4XSB9LCB7IDU6IFsyLCA5XSwgMTQ6IFsyLCA5XSwgMTU6IFsyLCA5XSwgMTk6IFsyLCA5XSwgMjk6IFsyLCA5XSwgMzQ6IFsyLCA5XSwgMzk6IFsyLCA5XSwgNDQ6IFsyLCA5XSwgNDc6IFsyLCA5XSwgNDg6IFsyLCA5XSwgNTE6IFsyLCA5XSwgNTU6IFsyLCA5XSwgNjA6IFsyLCA5XSB9LCB7IDIwOiAyNSwgNzI6IFsxLCAzNV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAyMDogMzYsIDcyOiBbMSwgMzVdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgNDogMzcsIDY6IDMsIDE0OiBbMiwgNDZdLCAxNTogWzIsIDQ2XSwgMTk6IFsyLCA0Nl0sIDI5OiBbMiwgNDZdLCAzNDogWzIsIDQ2XSwgMzk6IFsyLCA0Nl0sIDQ0OiBbMiwgNDZdLCA0NzogWzIsIDQ2XSwgNDg6IFsyLCA0Nl0sIDUxOiBbMiwgNDZdLCA1NTogWzIsIDQ2XSwgNjA6IFsyLCA0Nl0gfSwgeyA0OiAzOCwgNjogMywgMTQ6IFsyLCA0Nl0sIDE1OiBbMiwgNDZdLCAxOTogWzIsIDQ2XSwgMjk6IFsyLCA0Nl0sIDM0OiBbMiwgNDZdLCA0NDogWzIsIDQ2XSwgNDc6IFsyLCA0Nl0sIDQ4OiBbMiwgNDZdLCA1MTogWzIsIDQ2XSwgNTU6IFsyLCA0Nl0sIDYwOiBbMiwgNDZdIH0sIHsgMTM6IDQwLCAxNTogWzEsIDIwXSwgMTc6IDM5IH0sIHsgMjA6IDQyLCA1NjogNDEsIDY0OiA0MywgNjU6IFsxLCA0NF0sIDcyOiBbMSwgMzVdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgNDogNDUsIDY6IDMsIDE0OiBbMiwgNDZdLCAxNTogWzIsIDQ2XSwgMTk6IFsyLCA0Nl0sIDI5OiBbMiwgNDZdLCAzNDogWzIsIDQ2XSwgNDc6IFsyLCA0Nl0sIDQ4OiBbMiwgNDZdLCA1MTogWzIsIDQ2XSwgNTU6IFsyLCA0Nl0sIDYwOiBbMiwgNDZdIH0sIHsgNTogWzIsIDEwXSwgMTQ6IFsyLCAxMF0sIDE1OiBbMiwgMTBdLCAxODogWzIsIDEwXSwgMTk6IFsyLCAxMF0sIDI5OiBbMiwgMTBdLCAzNDogWzIsIDEwXSwgMzk6IFsyLCAxMF0sIDQ0OiBbMiwgMTBdLCA0NzogWzIsIDEwXSwgNDg6IFsyLCAxMF0sIDUxOiBbMiwgMTBdLCA1NTogWzIsIDEwXSwgNjA6IFsyLCAxMF0gfSwgeyAyMDogNDYsIDcyOiBbMSwgMzVdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMjA6IDQ3LCA3MjogWzEsIDM1XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDIwOiA0OCwgNzI6IFsxLCAzNV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAyMDogNDIsIDU2OiA0OSwgNjQ6IDQzLCA2NTogWzEsIDQ0XSwgNzI6IFsxLCAzNV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAzMzogWzIsIDc4XSwgNDk6IDUwLCA2NTogWzIsIDc4XSwgNzI6IFsyLCA3OF0sIDgwOiBbMiwgNzhdLCA4MTogWzIsIDc4XSwgODI6IFsyLCA3OF0sIDgzOiBbMiwgNzhdLCA4NDogWzIsIDc4XSwgODU6IFsyLCA3OF0gfSwgeyAyMzogWzIsIDMzXSwgMzM6IFsyLCAzM10sIDU0OiBbMiwgMzNdLCA2NTogWzIsIDMzXSwgNjg6IFsyLCAzM10sIDcyOiBbMiwgMzNdLCA3NTogWzIsIDMzXSwgODA6IFsyLCAzM10sIDgxOiBbMiwgMzNdLCA4MjogWzIsIDMzXSwgODM6IFsyLCAzM10sIDg0OiBbMiwgMzNdLCA4NTogWzIsIDMzXSB9LCB7IDIzOiBbMiwgMzRdLCAzMzogWzIsIDM0XSwgNTQ6IFsyLCAzNF0sIDY1OiBbMiwgMzRdLCA2ODogWzIsIDM0XSwgNzI6IFsyLCAzNF0sIDc1OiBbMiwgMzRdLCA4MDogWzIsIDM0XSwgODE6IFsyLCAzNF0sIDgyOiBbMiwgMzRdLCA4MzogWzIsIDM0XSwgODQ6IFsyLCAzNF0sIDg1OiBbMiwgMzRdIH0sIHsgMjM6IFsyLCAzNV0sIDMzOiBbMiwgMzVdLCA1NDogWzIsIDM1XSwgNjU6IFsyLCAzNV0sIDY4OiBbMiwgMzVdLCA3MjogWzIsIDM1XSwgNzU6IFsyLCAzNV0sIDgwOiBbMiwgMzVdLCA4MTogWzIsIDM1XSwgODI6IFsyLCAzNV0sIDgzOiBbMiwgMzVdLCA4NDogWzIsIDM1XSwgODU6IFsyLCAzNV0gfSwgeyAyMzogWzIsIDM2XSwgMzM6IFsyLCAzNl0sIDU0OiBbMiwgMzZdLCA2NTogWzIsIDM2XSwgNjg6IFsyLCAzNl0sIDcyOiBbMiwgMzZdLCA3NTogWzIsIDM2XSwgODA6IFsyLCAzNl0sIDgxOiBbMiwgMzZdLCA4MjogWzIsIDM2XSwgODM6IFsyLCAzNl0sIDg0OiBbMiwgMzZdLCA4NTogWzIsIDM2XSB9LCB7IDIzOiBbMiwgMzddLCAzMzogWzIsIDM3XSwgNTQ6IFsyLCAzN10sIDY1OiBbMiwgMzddLCA2ODogWzIsIDM3XSwgNzI6IFsyLCAzN10sIDc1OiBbMiwgMzddLCA4MDogWzIsIDM3XSwgODE6IFsyLCAzN10sIDgyOiBbMiwgMzddLCA4MzogWzIsIDM3XSwgODQ6IFsyLCAzN10sIDg1OiBbMiwgMzddIH0sIHsgMjM6IFsyLCAzOF0sIDMzOiBbMiwgMzhdLCA1NDogWzIsIDM4XSwgNjU6IFsyLCAzOF0sIDY4OiBbMiwgMzhdLCA3MjogWzIsIDM4XSwgNzU6IFsyLCAzOF0sIDgwOiBbMiwgMzhdLCA4MTogWzIsIDM4XSwgODI6IFsyLCAzOF0sIDgzOiBbMiwgMzhdLCA4NDogWzIsIDM4XSwgODU6IFsyLCAzOF0gfSwgeyAyMzogWzIsIDM5XSwgMzM6IFsyLCAzOV0sIDU0OiBbMiwgMzldLCA2NTogWzIsIDM5XSwgNjg6IFsyLCAzOV0sIDcyOiBbMiwgMzldLCA3NTogWzIsIDM5XSwgODA6IFsyLCAzOV0sIDgxOiBbMiwgMzldLCA4MjogWzIsIDM5XSwgODM6IFsyLCAzOV0sIDg0OiBbMiwgMzldLCA4NTogWzIsIDM5XSB9LCB7IDIzOiBbMiwgNDNdLCAzMzogWzIsIDQzXSwgNTQ6IFsyLCA0M10sIDY1OiBbMiwgNDNdLCA2ODogWzIsIDQzXSwgNzI6IFsyLCA0M10sIDc1OiBbMiwgNDNdLCA4MDogWzIsIDQzXSwgODE6IFsyLCA0M10sIDgyOiBbMiwgNDNdLCA4MzogWzIsIDQzXSwgODQ6IFsyLCA0M10sIDg1OiBbMiwgNDNdLCA4NzogWzEsIDUxXSB9LCB7IDcyOiBbMSwgMzVdLCA4NjogNTIgfSwgeyAyMzogWzIsIDQ1XSwgMzM6IFsyLCA0NV0sIDU0OiBbMiwgNDVdLCA2NTogWzIsIDQ1XSwgNjg6IFsyLCA0NV0sIDcyOiBbMiwgNDVdLCA3NTogWzIsIDQ1XSwgODA6IFsyLCA0NV0sIDgxOiBbMiwgNDVdLCA4MjogWzIsIDQ1XSwgODM6IFsyLCA0NV0sIDg0OiBbMiwgNDVdLCA4NTogWzIsIDQ1XSwgODc6IFsyLCA0NV0gfSwgeyA1MjogNTMsIDU0OiBbMiwgODJdLCA2NTogWzIsIDgyXSwgNzI6IFsyLCA4Ml0sIDgwOiBbMiwgODJdLCA4MTogWzIsIDgyXSwgODI6IFsyLCA4Ml0sIDgzOiBbMiwgODJdLCA4NDogWzIsIDgyXSwgODU6IFsyLCA4Ml0gfSwgeyAyNTogNTQsIDM4OiA1NiwgMzk6IFsxLCA1OF0sIDQzOiA1NywgNDQ6IFsxLCA1OV0sIDQ1OiA1NSwgNDc6IFsyLCA1NF0gfSwgeyAyODogNjAsIDQzOiA2MSwgNDQ6IFsxLCA1OV0sIDQ3OiBbMiwgNTZdIH0sIHsgMTM6IDYzLCAxNTogWzEsIDIwXSwgMTg6IFsxLCA2Ml0gfSwgeyAxNTogWzIsIDQ4XSwgMTg6IFsyLCA0OF0gfSwgeyAzMzogWzIsIDg2XSwgNTc6IDY0LCA2NTogWzIsIDg2XSwgNzI6IFsyLCA4Nl0sIDgwOiBbMiwgODZdLCA4MTogWzIsIDg2XSwgODI6IFsyLCA4Nl0sIDgzOiBbMiwgODZdLCA4NDogWzIsIDg2XSwgODU6IFsyLCA4Nl0gfSwgeyAzMzogWzIsIDQwXSwgNjU6IFsyLCA0MF0sIDcyOiBbMiwgNDBdLCA4MDogWzIsIDQwXSwgODE6IFsyLCA0MF0sIDgyOiBbMiwgNDBdLCA4MzogWzIsIDQwXSwgODQ6IFsyLCA0MF0sIDg1OiBbMiwgNDBdIH0sIHsgMzM6IFsyLCA0MV0sIDY1OiBbMiwgNDFdLCA3MjogWzIsIDQxXSwgODA6IFsyLCA0MV0sIDgxOiBbMiwgNDFdLCA4MjogWzIsIDQxXSwgODM6IFsyLCA0MV0sIDg0OiBbMiwgNDFdLCA4NTogWzIsIDQxXSB9LCB7IDIwOiA2NSwgNzI6IFsxLCAzNV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAyNjogNjYsIDQ3OiBbMSwgNjddIH0sIHsgMzA6IDY4LCAzMzogWzIsIDU4XSwgNjU6IFsyLCA1OF0sIDcyOiBbMiwgNThdLCA3NTogWzIsIDU4XSwgODA6IFsyLCA1OF0sIDgxOiBbMiwgNThdLCA4MjogWzIsIDU4XSwgODM6IFsyLCA1OF0sIDg0OiBbMiwgNThdLCA4NTogWzIsIDU4XSB9LCB7IDMzOiBbMiwgNjRdLCAzNTogNjksIDY1OiBbMiwgNjRdLCA3MjogWzIsIDY0XSwgNzU6IFsyLCA2NF0sIDgwOiBbMiwgNjRdLCA4MTogWzIsIDY0XSwgODI6IFsyLCA2NF0sIDgzOiBbMiwgNjRdLCA4NDogWzIsIDY0XSwgODU6IFsyLCA2NF0gfSwgeyAyMTogNzAsIDIzOiBbMiwgNTBdLCA2NTogWzIsIDUwXSwgNzI6IFsyLCA1MF0sIDgwOiBbMiwgNTBdLCA4MTogWzIsIDUwXSwgODI6IFsyLCA1MF0sIDgzOiBbMiwgNTBdLCA4NDogWzIsIDUwXSwgODU6IFsyLCA1MF0gfSwgeyAzMzogWzIsIDkwXSwgNjE6IDcxLCA2NTogWzIsIDkwXSwgNzI6IFsyLCA5MF0sIDgwOiBbMiwgOTBdLCA4MTogWzIsIDkwXSwgODI6IFsyLCA5MF0sIDgzOiBbMiwgOTBdLCA4NDogWzIsIDkwXSwgODU6IFsyLCA5MF0gfSwgeyAyMDogNzUsIDMzOiBbMiwgODBdLCA1MDogNzIsIDYzOiA3MywgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNjk6IDc0LCA3MDogNzcsIDcxOiA3OCwgNzI6IFsxLCA3OV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyA3MjogWzEsIDgwXSB9LCB7IDIzOiBbMiwgNDJdLCAzMzogWzIsIDQyXSwgNTQ6IFsyLCA0Ml0sIDY1OiBbMiwgNDJdLCA2ODogWzIsIDQyXSwgNzI6IFsyLCA0Ml0sIDc1OiBbMiwgNDJdLCA4MDogWzIsIDQyXSwgODE6IFsyLCA0Ml0sIDgyOiBbMiwgNDJdLCA4MzogWzIsIDQyXSwgODQ6IFsyLCA0Ml0sIDg1OiBbMiwgNDJdLCA4NzogWzEsIDUxXSB9LCB7IDIwOiA3NSwgNTM6IDgxLCA1NDogWzIsIDg0XSwgNjM6IDgyLCA2NDogNzYsIDY1OiBbMSwgNDRdLCA2OTogODMsIDcwOiA3NywgNzE6IDc4LCA3MjogWzEsIDc5XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDI2OiA4NCwgNDc6IFsxLCA2N10gfSwgeyA0NzogWzIsIDU1XSB9LCB7IDQ6IDg1LCA2OiAzLCAxNDogWzIsIDQ2XSwgMTU6IFsyLCA0Nl0sIDE5OiBbMiwgNDZdLCAyOTogWzIsIDQ2XSwgMzQ6IFsyLCA0Nl0sIDM5OiBbMiwgNDZdLCA0NDogWzIsIDQ2XSwgNDc6IFsyLCA0Nl0sIDQ4OiBbMiwgNDZdLCA1MTogWzIsIDQ2XSwgNTU6IFsyLCA0Nl0sIDYwOiBbMiwgNDZdIH0sIHsgNDc6IFsyLCAyMF0gfSwgeyAyMDogODYsIDcyOiBbMSwgMzVdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgNDogODcsIDY6IDMsIDE0OiBbMiwgNDZdLCAxNTogWzIsIDQ2XSwgMTk6IFsyLCA0Nl0sIDI5OiBbMiwgNDZdLCAzNDogWzIsIDQ2XSwgNDc6IFsyLCA0Nl0sIDQ4OiBbMiwgNDZdLCA1MTogWzIsIDQ2XSwgNTU6IFsyLCA0Nl0sIDYwOiBbMiwgNDZdIH0sIHsgMjY6IDg4LCA0NzogWzEsIDY3XSB9LCB7IDQ3OiBbMiwgNTddIH0sIHsgNTogWzIsIDExXSwgMTQ6IFsyLCAxMV0sIDE1OiBbMiwgMTFdLCAxOTogWzIsIDExXSwgMjk6IFsyLCAxMV0sIDM0OiBbMiwgMTFdLCAzOTogWzIsIDExXSwgNDQ6IFsyLCAxMV0sIDQ3OiBbMiwgMTFdLCA0ODogWzIsIDExXSwgNTE6IFsyLCAxMV0sIDU1OiBbMiwgMTFdLCA2MDogWzIsIDExXSB9LCB7IDE1OiBbMiwgNDldLCAxODogWzIsIDQ5XSB9LCB7IDIwOiA3NSwgMzM6IFsyLCA4OF0sIDU4OiA4OSwgNjM6IDkwLCA2NDogNzYsIDY1OiBbMSwgNDRdLCA2OTogOTEsIDcwOiA3NywgNzE6IDc4LCA3MjogWzEsIDc5XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDY1OiBbMiwgOTRdLCA2NjogOTIsIDY4OiBbMiwgOTRdLCA3MjogWzIsIDk0XSwgODA6IFsyLCA5NF0sIDgxOiBbMiwgOTRdLCA4MjogWzIsIDk0XSwgODM6IFsyLCA5NF0sIDg0OiBbMiwgOTRdLCA4NTogWzIsIDk0XSB9LCB7IDU6IFsyLCAyNV0sIDE0OiBbMiwgMjVdLCAxNTogWzIsIDI1XSwgMTk6IFsyLCAyNV0sIDI5OiBbMiwgMjVdLCAzNDogWzIsIDI1XSwgMzk6IFsyLCAyNV0sIDQ0OiBbMiwgMjVdLCA0NzogWzIsIDI1XSwgNDg6IFsyLCAyNV0sIDUxOiBbMiwgMjVdLCA1NTogWzIsIDI1XSwgNjA6IFsyLCAyNV0gfSwgeyAyMDogOTMsIDcyOiBbMSwgMzVdLCA3ODogMjYsIDc5OiAyNywgODA6IFsxLCAyOF0sIDgxOiBbMSwgMjldLCA4MjogWzEsIDMwXSwgODM6IFsxLCAzMV0sIDg0OiBbMSwgMzJdLCA4NTogWzEsIDM0XSwgODY6IDMzIH0sIHsgMjA6IDc1LCAzMTogOTQsIDMzOiBbMiwgNjBdLCA2MzogOTUsIDY0OiA3NiwgNjU6IFsxLCA0NF0sIDY5OiA5NiwgNzA6IDc3LCA3MTogNzgsIDcyOiBbMSwgNzldLCA3NTogWzIsIDYwXSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDIwOiA3NSwgMzM6IFsyLCA2Nl0sIDM2OiA5NywgNjM6IDk4LCA2NDogNzYsIDY1OiBbMSwgNDRdLCA2OTogOTksIDcwOiA3NywgNzE6IDc4LCA3MjogWzEsIDc5XSwgNzU6IFsyLCA2Nl0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAyMDogNzUsIDIyOiAxMDAsIDIzOiBbMiwgNTJdLCA2MzogMTAxLCA2NDogNzYsIDY1OiBbMSwgNDRdLCA2OTogMTAyLCA3MDogNzcsIDcxOiA3OCwgNzI6IFsxLCA3OV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAyMDogNzUsIDMzOiBbMiwgOTJdLCA2MjogMTAzLCA2MzogMTA0LCA2NDogNzYsIDY1OiBbMSwgNDRdLCA2OTogMTA1LCA3MDogNzcsIDcxOiA3OCwgNzI6IFsxLCA3OV0sIDc4OiAyNiwgNzk6IDI3LCA4MDogWzEsIDI4XSwgODE6IFsxLCAyOV0sIDgyOiBbMSwgMzBdLCA4MzogWzEsIDMxXSwgODQ6IFsxLCAzMl0sIDg1OiBbMSwgMzRdLCA4NjogMzMgfSwgeyAzMzogWzEsIDEwNl0gfSwgeyAzMzogWzIsIDc5XSwgNjU6IFsyLCA3OV0sIDcyOiBbMiwgNzldLCA4MDogWzIsIDc5XSwgODE6IFsyLCA3OV0sIDgyOiBbMiwgNzldLCA4MzogWzIsIDc5XSwgODQ6IFsyLCA3OV0sIDg1OiBbMiwgNzldIH0sIHsgMzM6IFsyLCA4MV0gfSwgeyAyMzogWzIsIDI3XSwgMzM6IFsyLCAyN10sIDU0OiBbMiwgMjddLCA2NTogWzIsIDI3XSwgNjg6IFsyLCAyN10sIDcyOiBbMiwgMjddLCA3NTogWzIsIDI3XSwgODA6IFsyLCAyN10sIDgxOiBbMiwgMjddLCA4MjogWzIsIDI3XSwgODM6IFsyLCAyN10sIDg0OiBbMiwgMjddLCA4NTogWzIsIDI3XSB9LCB7IDIzOiBbMiwgMjhdLCAzMzogWzIsIDI4XSwgNTQ6IFsyLCAyOF0sIDY1OiBbMiwgMjhdLCA2ODogWzIsIDI4XSwgNzI6IFsyLCAyOF0sIDc1OiBbMiwgMjhdLCA4MDogWzIsIDI4XSwgODE6IFsyLCAyOF0sIDgyOiBbMiwgMjhdLCA4MzogWzIsIDI4XSwgODQ6IFsyLCAyOF0sIDg1OiBbMiwgMjhdIH0sIHsgMjM6IFsyLCAzMF0sIDMzOiBbMiwgMzBdLCA1NDogWzIsIDMwXSwgNjg6IFsyLCAzMF0sIDcxOiAxMDcsIDcyOiBbMSwgMTA4XSwgNzU6IFsyLCAzMF0gfSwgeyAyMzogWzIsIDk4XSwgMzM6IFsyLCA5OF0sIDU0OiBbMiwgOThdLCA2ODogWzIsIDk4XSwgNzI6IFsyLCA5OF0sIDc1OiBbMiwgOThdIH0sIHsgMjM6IFsyLCA0NV0sIDMzOiBbMiwgNDVdLCA1NDogWzIsIDQ1XSwgNjU6IFsyLCA0NV0sIDY4OiBbMiwgNDVdLCA3MjogWzIsIDQ1XSwgNzM6IFsxLCAxMDldLCA3NTogWzIsIDQ1XSwgODA6IFsyLCA0NV0sIDgxOiBbMiwgNDVdLCA4MjogWzIsIDQ1XSwgODM6IFsyLCA0NV0sIDg0OiBbMiwgNDVdLCA4NTogWzIsIDQ1XSwgODc6IFsyLCA0NV0gfSwgeyAyMzogWzIsIDQ0XSwgMzM6IFsyLCA0NF0sIDU0OiBbMiwgNDRdLCA2NTogWzIsIDQ0XSwgNjg6IFsyLCA0NF0sIDcyOiBbMiwgNDRdLCA3NTogWzIsIDQ0XSwgODA6IFsyLCA0NF0sIDgxOiBbMiwgNDRdLCA4MjogWzIsIDQ0XSwgODM6IFsyLCA0NF0sIDg0OiBbMiwgNDRdLCA4NTogWzIsIDQ0XSwgODc6IFsyLCA0NF0gfSwgeyA1NDogWzEsIDExMF0gfSwgeyA1NDogWzIsIDgzXSwgNjU6IFsyLCA4M10sIDcyOiBbMiwgODNdLCA4MDogWzIsIDgzXSwgODE6IFsyLCA4M10sIDgyOiBbMiwgODNdLCA4MzogWzIsIDgzXSwgODQ6IFsyLCA4M10sIDg1OiBbMiwgODNdIH0sIHsgNTQ6IFsyLCA4NV0gfSwgeyA1OiBbMiwgMTNdLCAxNDogWzIsIDEzXSwgMTU6IFsyLCAxM10sIDE5OiBbMiwgMTNdLCAyOTogWzIsIDEzXSwgMzQ6IFsyLCAxM10sIDM5OiBbMiwgMTNdLCA0NDogWzIsIDEzXSwgNDc6IFsyLCAxM10sIDQ4OiBbMiwgMTNdLCA1MTogWzIsIDEzXSwgNTU6IFsyLCAxM10sIDYwOiBbMiwgMTNdIH0sIHsgMzg6IDU2LCAzOTogWzEsIDU4XSwgNDM6IDU3LCA0NDogWzEsIDU5XSwgNDU6IDExMiwgNDY6IDExMSwgNDc6IFsyLCA3Nl0gfSwgeyAzMzogWzIsIDcwXSwgNDA6IDExMywgNjU6IFsyLCA3MF0sIDcyOiBbMiwgNzBdLCA3NTogWzIsIDcwXSwgODA6IFsyLCA3MF0sIDgxOiBbMiwgNzBdLCA4MjogWzIsIDcwXSwgODM6IFsyLCA3MF0sIDg0OiBbMiwgNzBdLCA4NTogWzIsIDcwXSB9LCB7IDQ3OiBbMiwgMThdIH0sIHsgNTogWzIsIDE0XSwgMTQ6IFsyLCAxNF0sIDE1OiBbMiwgMTRdLCAxOTogWzIsIDE0XSwgMjk6IFsyLCAxNF0sIDM0OiBbMiwgMTRdLCAzOTogWzIsIDE0XSwgNDQ6IFsyLCAxNF0sIDQ3OiBbMiwgMTRdLCA0ODogWzIsIDE0XSwgNTE6IFsyLCAxNF0sIDU1OiBbMiwgMTRdLCA2MDogWzIsIDE0XSB9LCB7IDMzOiBbMSwgMTE0XSB9LCB7IDMzOiBbMiwgODddLCA2NTogWzIsIDg3XSwgNzI6IFsyLCA4N10sIDgwOiBbMiwgODddLCA4MTogWzIsIDg3XSwgODI6IFsyLCA4N10sIDgzOiBbMiwgODddLCA4NDogWzIsIDg3XSwgODU6IFsyLCA4N10gfSwgeyAzMzogWzIsIDg5XSB9LCB7IDIwOiA3NSwgNjM6IDExNiwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNjc6IDExNSwgNjg6IFsyLCA5Nl0sIDY5OiAxMTcsIDcwOiA3NywgNzE6IDc4LCA3MjogWzEsIDc5XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDMzOiBbMSwgMTE4XSB9LCB7IDMyOiAxMTksIDMzOiBbMiwgNjJdLCA3NDogMTIwLCA3NTogWzEsIDEyMV0gfSwgeyAzMzogWzIsIDU5XSwgNjU6IFsyLCA1OV0sIDcyOiBbMiwgNTldLCA3NTogWzIsIDU5XSwgODA6IFsyLCA1OV0sIDgxOiBbMiwgNTldLCA4MjogWzIsIDU5XSwgODM6IFsyLCA1OV0sIDg0OiBbMiwgNTldLCA4NTogWzIsIDU5XSB9LCB7IDMzOiBbMiwgNjFdLCA3NTogWzIsIDYxXSB9LCB7IDMzOiBbMiwgNjhdLCAzNzogMTIyLCA3NDogMTIzLCA3NTogWzEsIDEyMV0gfSwgeyAzMzogWzIsIDY1XSwgNjU6IFsyLCA2NV0sIDcyOiBbMiwgNjVdLCA3NTogWzIsIDY1XSwgODA6IFsyLCA2NV0sIDgxOiBbMiwgNjVdLCA4MjogWzIsIDY1XSwgODM6IFsyLCA2NV0sIDg0OiBbMiwgNjVdLCA4NTogWzIsIDY1XSB9LCB7IDMzOiBbMiwgNjddLCA3NTogWzIsIDY3XSB9LCB7IDIzOiBbMSwgMTI0XSB9LCB7IDIzOiBbMiwgNTFdLCA2NTogWzIsIDUxXSwgNzI6IFsyLCA1MV0sIDgwOiBbMiwgNTFdLCA4MTogWzIsIDUxXSwgODI6IFsyLCA1MV0sIDgzOiBbMiwgNTFdLCA4NDogWzIsIDUxXSwgODU6IFsyLCA1MV0gfSwgeyAyMzogWzIsIDUzXSB9LCB7IDMzOiBbMSwgMTI1XSB9LCB7IDMzOiBbMiwgOTFdLCA2NTogWzIsIDkxXSwgNzI6IFsyLCA5MV0sIDgwOiBbMiwgOTFdLCA4MTogWzIsIDkxXSwgODI6IFsyLCA5MV0sIDgzOiBbMiwgOTFdLCA4NDogWzIsIDkxXSwgODU6IFsyLCA5MV0gfSwgeyAzMzogWzIsIDkzXSB9LCB7IDU6IFsyLCAyMl0sIDE0OiBbMiwgMjJdLCAxNTogWzIsIDIyXSwgMTk6IFsyLCAyMl0sIDI5OiBbMiwgMjJdLCAzNDogWzIsIDIyXSwgMzk6IFsyLCAyMl0sIDQ0OiBbMiwgMjJdLCA0NzogWzIsIDIyXSwgNDg6IFsyLCAyMl0sIDUxOiBbMiwgMjJdLCA1NTogWzIsIDIyXSwgNjA6IFsyLCAyMl0gfSwgeyAyMzogWzIsIDk5XSwgMzM6IFsyLCA5OV0sIDU0OiBbMiwgOTldLCA2ODogWzIsIDk5XSwgNzI6IFsyLCA5OV0sIDc1OiBbMiwgOTldIH0sIHsgNzM6IFsxLCAxMDldIH0sIHsgMjA6IDc1LCA2MzogMTI2LCA2NDogNzYsIDY1OiBbMSwgNDRdLCA3MjogWzEsIDM1XSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDU6IFsyLCAyM10sIDE0OiBbMiwgMjNdLCAxNTogWzIsIDIzXSwgMTk6IFsyLCAyM10sIDI5OiBbMiwgMjNdLCAzNDogWzIsIDIzXSwgMzk6IFsyLCAyM10sIDQ0OiBbMiwgMjNdLCA0NzogWzIsIDIzXSwgNDg6IFsyLCAyM10sIDUxOiBbMiwgMjNdLCA1NTogWzIsIDIzXSwgNjA6IFsyLCAyM10gfSwgeyA0NzogWzIsIDE5XSB9LCB7IDQ3OiBbMiwgNzddIH0sIHsgMjA6IDc1LCAzMzogWzIsIDcyXSwgNDE6IDEyNywgNjM6IDEyOCwgNjQ6IDc2LCA2NTogWzEsIDQ0XSwgNjk6IDEyOSwgNzA6IDc3LCA3MTogNzgsIDcyOiBbMSwgNzldLCA3NTogWzIsIDcyXSwgNzg6IDI2LCA3OTogMjcsIDgwOiBbMSwgMjhdLCA4MTogWzEsIDI5XSwgODI6IFsxLCAzMF0sIDgzOiBbMSwgMzFdLCA4NDogWzEsIDMyXSwgODU6IFsxLCAzNF0sIDg2OiAzMyB9LCB7IDU6IFsyLCAyNF0sIDE0OiBbMiwgMjRdLCAxNTogWzIsIDI0XSwgMTk6IFsyLCAyNF0sIDI5OiBbMiwgMjRdLCAzNDogWzIsIDI0XSwgMzk6IFsyLCAyNF0sIDQ0OiBbMiwgMjRdLCA0NzogWzIsIDI0XSwgNDg6IFsyLCAyNF0sIDUxOiBbMiwgMjRdLCA1NTogWzIsIDI0XSwgNjA6IFsyLCAyNF0gfSwgeyA2ODogWzEsIDEzMF0gfSwgeyA2NTogWzIsIDk1XSwgNjg6IFsyLCA5NV0sIDcyOiBbMiwgOTVdLCA4MDogWzIsIDk1XSwgODE6IFsyLCA5NV0sIDgyOiBbMiwgOTVdLCA4MzogWzIsIDk1XSwgODQ6IFsyLCA5NV0sIDg1OiBbMiwgOTVdIH0sIHsgNjg6IFsyLCA5N10gfSwgeyA1OiBbMiwgMjFdLCAxNDogWzIsIDIxXSwgMTU6IFsyLCAyMV0sIDE5OiBbMiwgMjFdLCAyOTogWzIsIDIxXSwgMzQ6IFsyLCAyMV0sIDM5OiBbMiwgMjFdLCA0NDogWzIsIDIxXSwgNDc6IFsyLCAyMV0sIDQ4OiBbMiwgMjFdLCA1MTogWzIsIDIxXSwgNTU6IFsyLCAyMV0sIDYwOiBbMiwgMjFdIH0sIHsgMzM6IFsxLCAxMzFdIH0sIHsgMzM6IFsyLCA2M10gfSwgeyA3MjogWzEsIDEzM10sIDc2OiAxMzIgfSwgeyAzMzogWzEsIDEzNF0gfSwgeyAzMzogWzIsIDY5XSB9LCB7IDE1OiBbMiwgMTJdIH0sIHsgMTQ6IFsyLCAyNl0sIDE1OiBbMiwgMjZdLCAxOTogWzIsIDI2XSwgMjk6IFsyLCAyNl0sIDM0OiBbMiwgMjZdLCA0NzogWzIsIDI2XSwgNDg6IFsyLCAyNl0sIDUxOiBbMiwgMjZdLCA1NTogWzIsIDI2XSwgNjA6IFsyLCAyNl0gfSwgeyAyMzogWzIsIDMxXSwgMzM6IFsyLCAzMV0sIDU0OiBbMiwgMzFdLCA2ODogWzIsIDMxXSwgNzI6IFsyLCAzMV0sIDc1OiBbMiwgMzFdIH0sIHsgMzM6IFsyLCA3NF0sIDQyOiAxMzUsIDc0OiAxMzYsIDc1OiBbMSwgMTIxXSB9LCB7IDMzOiBbMiwgNzFdLCA2NTogWzIsIDcxXSwgNzI6IFsyLCA3MV0sIDc1OiBbMiwgNzFdLCA4MDogWzIsIDcxXSwgODE6IFsyLCA3MV0sIDgyOiBbMiwgNzFdLCA4MzogWzIsIDcxXSwgODQ6IFsyLCA3MV0sIDg1OiBbMiwgNzFdIH0sIHsgMzM6IFsyLCA3M10sIDc1OiBbMiwgNzNdIH0sIHsgMjM6IFsyLCAyOV0sIDMzOiBbMiwgMjldLCA1NDogWzIsIDI5XSwgNjU6IFsyLCAyOV0sIDY4OiBbMiwgMjldLCA3MjogWzIsIDI5XSwgNzU6IFsyLCAyOV0sIDgwOiBbMiwgMjldLCA4MTogWzIsIDI5XSwgODI6IFsyLCAyOV0sIDgzOiBbMiwgMjldLCA4NDogWzIsIDI5XSwgODU6IFsyLCAyOV0gfSwgeyAxNDogWzIsIDE1XSwgMTU6IFsyLCAxNV0sIDE5OiBbMiwgMTVdLCAyOTogWzIsIDE1XSwgMzQ6IFsyLCAxNV0sIDM5OiBbMiwgMTVdLCA0NDogWzIsIDE1XSwgNDc6IFsyLCAxNV0sIDQ4OiBbMiwgMTVdLCA1MTogWzIsIDE1XSwgNTU6IFsyLCAxNV0sIDYwOiBbMiwgMTVdIH0sIHsgNzI6IFsxLCAxMzhdLCA3NzogWzEsIDEzN10gfSwgeyA3MjogWzIsIDEwMF0sIDc3OiBbMiwgMTAwXSB9LCB7IDE0OiBbMiwgMTZdLCAxNTogWzIsIDE2XSwgMTk6IFsyLCAxNl0sIDI5OiBbMiwgMTZdLCAzNDogWzIsIDE2XSwgNDQ6IFsyLCAxNl0sIDQ3OiBbMiwgMTZdLCA0ODogWzIsIDE2XSwgNTE6IFsyLCAxNl0sIDU1OiBbMiwgMTZdLCA2MDogWzIsIDE2XSB9LCB7IDMzOiBbMSwgMTM5XSB9LCB7IDMzOiBbMiwgNzVdIH0sIHsgMzM6IFsyLCAzMl0gfSwgeyA3MjogWzIsIDEwMV0sIDc3OiBbMiwgMTAxXSB9LCB7IDE0OiBbMiwgMTddLCAxNTogWzIsIDE3XSwgMTk6IFsyLCAxN10sIDI5OiBbMiwgMTddLCAzNDogWzIsIDE3XSwgMzk6IFsyLCAxN10sIDQ0OiBbMiwgMTddLCA0NzogWzIsIDE3XSwgNDg6IFsyLCAxN10sIDUxOiBbMiwgMTddLCA1NTogWzIsIDE3XSwgNjA6IFsyLCAxN10gfV0sCgkJICAgICAgICBkZWZhdWx0QWN0aW9uczogeyA0OiBbMiwgMV0sIDU1OiBbMiwgNTVdLCA1NzogWzIsIDIwXSwgNjE6IFsyLCA1N10sIDc0OiBbMiwgODFdLCA4MzogWzIsIDg1XSwgODc6IFsyLCAxOF0sIDkxOiBbMiwgODldLCAxMDI6IFsyLCA1M10sIDEwNTogWzIsIDkzXSwgMTExOiBbMiwgMTldLCAxMTI6IFsyLCA3N10sIDExNzogWzIsIDk3XSwgMTIwOiBbMiwgNjNdLCAxMjM6IFsyLCA2OV0sIDEyNDogWzIsIDEyXSwgMTM2OiBbMiwgNzVdLCAxMzc6IFsyLCAzMl0gfSwKCQkgICAgICAgIHBhcnNlRXJyb3I6IGZ1bmN0aW9uIHBhcnNlRXJyb3Ioc3RyLCBoYXNoKSB7CgkJICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHN0cik7CgkJICAgICAgICB9LAoJCSAgICAgICAgcGFyc2U6IGZ1bmN0aW9uIHBhcnNlKGlucHV0KSB7CgkJICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzLAoJCSAgICAgICAgICAgICAgICBzdGFjayA9IFswXSwKCQkgICAgICAgICAgICAgICAgdnN0YWNrID0gW251bGxdLAoJCSAgICAgICAgICAgICAgICBsc3RhY2sgPSBbXSwKCQkgICAgICAgICAgICAgICAgdGFibGUgPSB0aGlzLnRhYmxlLAoJCSAgICAgICAgICAgICAgICB5eXRleHQgPSAiIiwKCQkgICAgICAgICAgICAgICAgeXlsaW5lbm8gPSAwLAoJCSAgICAgICAgICAgICAgICB5eWxlbmcgPSAwLAoJCSAgICAgICAgICAgICAgICByZWNvdmVyaW5nID0gMCwKCQkgICAgICAgICAgICAgICAgVEVSUk9SID0gMiwKCQkgICAgICAgICAgICAgICAgRU9GID0gMTsKCQkgICAgICAgICAgICB0aGlzLmxleGVyLnNldElucHV0KGlucHV0KTsKCQkgICAgICAgICAgICB0aGlzLmxleGVyLnl5ID0gdGhpcy55eTsKCQkgICAgICAgICAgICB0aGlzLnl5LmxleGVyID0gdGhpcy5sZXhlcjsKCQkgICAgICAgICAgICB0aGlzLnl5LnBhcnNlciA9IHRoaXM7CgkJICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmxleGVyLnl5bGxvYyA9PSAidW5kZWZpbmVkIikgdGhpcy5sZXhlci55eWxsb2MgPSB7fTsKCQkgICAgICAgICAgICB2YXIgeXlsb2MgPSB0aGlzLmxleGVyLnl5bGxvYzsKCQkgICAgICAgICAgICBsc3RhY2sucHVzaCh5eWxvYyk7CgkJICAgICAgICAgICAgdmFyIHJhbmdlcyA9IHRoaXMubGV4ZXIub3B0aW9ucyAmJiB0aGlzLmxleGVyLm9wdGlvbnMucmFuZ2VzOwoJCSAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy55eS5wYXJzZUVycm9yID09PSAiZnVuY3Rpb24iKSB0aGlzLnBhcnNlRXJyb3IgPSB0aGlzLnl5LnBhcnNlRXJyb3I7CgkJICAgICAgICAgICAgZnVuY3Rpb24gcG9wU3RhY2sobikgewoJCSAgICAgICAgICAgICAgICBzdGFjay5sZW5ndGggPSBzdGFjay5sZW5ndGggLSAyICogbjsKCQkgICAgICAgICAgICAgICAgdnN0YWNrLmxlbmd0aCA9IHZzdGFjay5sZW5ndGggLSBuOwoJCSAgICAgICAgICAgICAgICBsc3RhY2subGVuZ3RoID0gbHN0YWNrLmxlbmd0aCAtIG47CgkJICAgICAgICAgICAgfQoJCSAgICAgICAgICAgIGZ1bmN0aW9uIGxleCgpIHsKCQkgICAgICAgICAgICAgICAgdmFyIHRva2VuOwoJCSAgICAgICAgICAgICAgICB0b2tlbiA9IHNlbGYubGV4ZXIubGV4KCkgfHwgMTsKCQkgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0b2tlbiAhPT0gIm51bWJlciIpIHsKCQkgICAgICAgICAgICAgICAgICAgIHRva2VuID0gc2VsZi5zeW1ib2xzX1t0b2tlbl0gfHwgdG9rZW47CgkJICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgcmV0dXJuIHRva2VuOwoJCSAgICAgICAgICAgIH0KCQkgICAgICAgICAgICB2YXIgc3ltYm9sLAoJCSAgICAgICAgICAgICAgICBwcmVFcnJvclN5bWJvbCwKCQkgICAgICAgICAgICAgICAgc3RhdGUsCgkJICAgICAgICAgICAgICAgIGFjdGlvbiwKCQkgICAgICAgICAgICAgICAgYSwKCQkgICAgICAgICAgICAgICAgciwKCQkgICAgICAgICAgICAgICAgeXl2YWwgPSB7fSwKCQkgICAgICAgICAgICAgICAgcCwKCQkgICAgICAgICAgICAgICAgbGVuLAoJCSAgICAgICAgICAgICAgICBuZXdTdGF0ZSwKCQkgICAgICAgICAgICAgICAgZXhwZWN0ZWQ7CgkJICAgICAgICAgICAgd2hpbGUgKHRydWUpIHsKCQkgICAgICAgICAgICAgICAgc3RhdGUgPSBzdGFja1tzdGFjay5sZW5ndGggLSAxXTsKCQkgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGVmYXVsdEFjdGlvbnNbc3RhdGVdKSB7CgkJICAgICAgICAgICAgICAgICAgICBhY3Rpb24gPSB0aGlzLmRlZmF1bHRBY3Rpb25zW3N0YXRlXTsKCQkgICAgICAgICAgICAgICAgfSBlbHNlIHsKCQkgICAgICAgICAgICAgICAgICAgIGlmIChzeW1ib2wgPT09IG51bGwgfHwgdHlwZW9mIHN5bWJvbCA9PSAidW5kZWZpbmVkIikgewoJCSAgICAgICAgICAgICAgICAgICAgICAgIHN5bWJvbCA9IGxleCgpOwoJCSAgICAgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICAgICAgYWN0aW9uID0gdGFibGVbc3RhdGVdICYmIHRhYmxlW3N0YXRlXVtzeW1ib2xdOwoJCSAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYWN0aW9uID09PSAidW5kZWZpbmVkIiB8fCAhYWN0aW9uLmxlbmd0aCB8fCAhYWN0aW9uWzBdKSB7CgkJICAgICAgICAgICAgICAgICAgICB2YXIgZXJyU3RyID0gIiI7CgkJICAgICAgICAgICAgICAgICAgICBpZiAoIXJlY292ZXJpbmcpIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3RlZCA9IFtdOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAocCBpbiB0YWJsZVtzdGF0ZV0pIGlmICh0aGlzLnRlcm1pbmFsc19bcF0gJiYgcCA+IDIpIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWQucHVzaCgiJyIgKyB0aGlzLnRlcm1pbmFsc19bcF0gKyAiJyIpOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5sZXhlci5zaG93UG9zaXRpb24pIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyU3RyID0gIlBhcnNlIGVycm9yIG9uIGxpbmUgIiArICh5eWxpbmVubyArIDEpICsgIjpcbiIgKyB0aGlzLmxleGVyLnNob3dQb3NpdGlvbigpICsgIlxuRXhwZWN0aW5nICIgKyBleHBlY3RlZC5qb2luKCIsICIpICsgIiwgZ290ICciICsgKHRoaXMudGVybWluYWxzX1tzeW1ib2xdIHx8IHN5bWJvbCkgKyAiJyI7CgkJICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyU3RyID0gIlBhcnNlIGVycm9yIG9uIGxpbmUgIiArICh5eWxpbmVubyArIDEpICsgIjogVW5leHBlY3RlZCAiICsgKHN5bWJvbCA9PSAxID8gImVuZCBvZiBpbnB1dCIgOiAiJyIgKyAodGhpcy50ZXJtaW5hbHNfW3N5bWJvbF0gfHwgc3ltYm9sKSArICInIik7CgkJICAgICAgICAgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VFcnJvcihlcnJTdHIsIHsgdGV4dDogdGhpcy5sZXhlci5tYXRjaCwgdG9rZW46IHRoaXMudGVybWluYWxzX1tzeW1ib2xdIHx8IHN5bWJvbCwgbGluZTogdGhpcy5sZXhlci55eWxpbmVubywgbG9jOiB5eWxvYywgZXhwZWN0ZWQ6IGV4cGVjdGVkIH0pOwoJCSAgICAgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgIGlmIChhY3Rpb25bMF0gaW5zdGFuY2VvZiBBcnJheSAmJiBhY3Rpb24ubGVuZ3RoID4gMSkgewoJCSAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJQYXJzZSBFcnJvcjogbXVsdGlwbGUgYWN0aW9ucyBwb3NzaWJsZSBhdCBzdGF0ZTogIiArIHN0YXRlICsgIiwgdG9rZW46ICIgKyBzeW1ib2wpOwoJCSAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgIHN3aXRjaCAoYWN0aW9uWzBdKSB7CgkJICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CgkJICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2sucHVzaChzeW1ib2wpOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIHZzdGFjay5wdXNoKHRoaXMubGV4ZXIueXl0ZXh0KTsKCQkgICAgICAgICAgICAgICAgICAgICAgICBsc3RhY2sucHVzaCh0aGlzLmxleGVyLnl5bGxvYyk7CgkJICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2sucHVzaChhY3Rpb25bMV0pOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIHN5bWJvbCA9IG51bGw7CgkJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwcmVFcnJvclN5bWJvbCkgewoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB5eWxlbmcgPSB0aGlzLmxleGVyLnl5bGVuZzsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgeXl0ZXh0ID0gdGhpcy5sZXhlci55eXRleHQ7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHl5bGluZW5vID0gdGhpcy5sZXhlci55eWxpbmVubzsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgeXlsb2MgPSB0aGlzLmxleGVyLnl5bGxvYzsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlY292ZXJpbmcgPiAwKSByZWNvdmVyaW5nLS07CgkJICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sID0gcHJlRXJyb3JTeW1ib2w7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZUVycm9yU3ltYm9sID0gbnVsbDsKCQkgICAgICAgICAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CgkJICAgICAgICAgICAgICAgICAgICAgICAgbGVuID0gdGhpcy5wcm9kdWN0aW9uc19bYWN0aW9uWzFdXVsxXTsKCQkgICAgICAgICAgICAgICAgICAgICAgICB5eXZhbC4kID0gdnN0YWNrW3ZzdGFjay5sZW5ndGggLSBsZW5dOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIHl5dmFsLl8kID0geyBmaXJzdF9saW5lOiBsc3RhY2tbbHN0YWNrLmxlbmd0aCAtIChsZW4gfHwgMSldLmZpcnN0X2xpbmUsIGxhc3RfbGluZTogbHN0YWNrW2xzdGFjay5sZW5ndGggLSAxXS5sYXN0X2xpbmUsIGZpcnN0X2NvbHVtbjogbHN0YWNrW2xzdGFjay5sZW5ndGggLSAobGVuIHx8IDEpXS5maXJzdF9jb2x1bW4sIGxhc3RfY29sdW1uOiBsc3RhY2tbbHN0YWNrLmxlbmd0aCAtIDFdLmxhc3RfY29sdW1uIH07CgkJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJhbmdlcykgewoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB5eXZhbC5fJC5yYW5nZSA9IFtsc3RhY2tbbHN0YWNrLmxlbmd0aCAtIChsZW4gfHwgMSldLnJhbmdlWzBdLCBsc3RhY2tbbHN0YWNrLmxlbmd0aCAtIDFdLnJhbmdlWzFdXTsKCQkgICAgICAgICAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgICAgICAgICAgciA9IHRoaXMucGVyZm9ybUFjdGlvbi5jYWxsKHl5dmFsLCB5eXRleHQsIHl5bGVuZywgeXlsaW5lbm8sIHRoaXMueXksIGFjdGlvblsxXSwgdnN0YWNrLCBsc3RhY2spOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgciAhPT0gInVuZGVmaW5lZCIpIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7CgkJICAgICAgICAgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsZW4pIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2sgPSBzdGFjay5zbGljZSgwLCAtMSAqIGxlbiAqIDIpOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB2c3RhY2sgPSB2c3RhY2suc2xpY2UoMCwgLTEgKiBsZW4pOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBsc3RhY2sgPSBsc3RhY2suc2xpY2UoMCwgLTEgKiBsZW4pOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgICAgICAgICBzdGFjay5wdXNoKHRoaXMucHJvZHVjdGlvbnNfW2FjdGlvblsxXV1bMF0pOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIHZzdGFjay5wdXNoKHl5dmFsLiQpOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIGxzdGFjay5wdXNoKHl5dmFsLl8kKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICBuZXdTdGF0ZSA9IHRhYmxlW3N0YWNrW3N0YWNrLmxlbmd0aCAtIDJdXVtzdGFja1tzdGFjay5sZW5ndGggLSAxXV07CgkJICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2sucHVzaChuZXdTdGF0ZSk7CgkJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CgkJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkJICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICB9CgkJICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkJICAgICAgICB9CgkJICAgIH07CgkJICAgIC8qIEppc29uIGdlbmVyYXRlZCBsZXhlciAqLwoJCSAgICB2YXIgbGV4ZXIgPSAoZnVuY3Rpb24gKCkgewoJCSAgICAgICAgdmFyIGxleGVyID0geyBFT0Y6IDEsCgkJICAgICAgICAgICAgcGFyc2VFcnJvcjogZnVuY3Rpb24gcGFyc2VFcnJvcihzdHIsIGhhc2gpIHsKCQkgICAgICAgICAgICAgICAgaWYgKHRoaXMueXkucGFyc2VyKSB7CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLnl5LnBhcnNlci5wYXJzZUVycm9yKHN0ciwgaGFzaCk7CgkJICAgICAgICAgICAgICAgIH0gZWxzZSB7CgkJICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3Ioc3RyKTsKCQkgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgIH0sCgkJICAgICAgICAgICAgc2V0SW5wdXQ6IGZ1bmN0aW9uIHNldElucHV0KGlucHV0KSB7CgkJICAgICAgICAgICAgICAgIHRoaXMuX2lucHV0ID0gaW5wdXQ7CgkJICAgICAgICAgICAgICAgIHRoaXMuX21vcmUgPSB0aGlzLl9sZXNzID0gdGhpcy5kb25lID0gZmFsc2U7CgkJICAgICAgICAgICAgICAgIHRoaXMueXlsaW5lbm8gPSB0aGlzLnl5bGVuZyA9IDA7CgkJICAgICAgICAgICAgICAgIHRoaXMueXl0ZXh0ID0gdGhpcy5tYXRjaGVkID0gdGhpcy5tYXRjaCA9ICcnOwoJCSAgICAgICAgICAgICAgICB0aGlzLmNvbmRpdGlvblN0YWNrID0gWydJTklUSUFMJ107CgkJICAgICAgICAgICAgICAgIHRoaXMueXlsbG9jID0geyBmaXJzdF9saW5lOiAxLCBmaXJzdF9jb2x1bW46IDAsIGxhc3RfbGluZTogMSwgbGFzdF9jb2x1bW46IDAgfTsKCQkgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5yYW5nZXMpIHRoaXMueXlsbG9jLnJhbmdlID0gWzAsIDBdOwoJCSAgICAgICAgICAgICAgICB0aGlzLm9mZnNldCA9IDA7CgkJICAgICAgICAgICAgICAgIHJldHVybiB0aGlzOwoJCSAgICAgICAgICAgIH0sCgkJICAgICAgICAgICAgaW5wdXQ6IGZ1bmN0aW9uIGlucHV0KCkgewoJCSAgICAgICAgICAgICAgICB2YXIgY2ggPSB0aGlzLl9pbnB1dFswXTsKCQkgICAgICAgICAgICAgICAgdGhpcy55eXRleHQgKz0gY2g7CgkJICAgICAgICAgICAgICAgIHRoaXMueXlsZW5nKys7CgkJICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0Kys7CgkJICAgICAgICAgICAgICAgIHRoaXMubWF0Y2ggKz0gY2g7CgkJICAgICAgICAgICAgICAgIHRoaXMubWF0Y2hlZCArPSBjaDsKCQkgICAgICAgICAgICAgICAgdmFyIGxpbmVzID0gY2gubWF0Y2goLyg/OlxyXG4/fFxuKS4qL2cpOwoJCSAgICAgICAgICAgICAgICBpZiAobGluZXMpIHsKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMueXlsaW5lbm8rKzsKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMueXlsbG9jLmxhc3RfbGluZSsrOwoJCSAgICAgICAgICAgICAgICB9IGVsc2UgewoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy55eWxsb2MubGFzdF9jb2x1bW4rKzsKCQkgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnJhbmdlcykgdGhpcy55eWxsb2MucmFuZ2VbMV0rKzsKCgkJICAgICAgICAgICAgICAgIHRoaXMuX2lucHV0ID0gdGhpcy5faW5wdXQuc2xpY2UoMSk7CgkJICAgICAgICAgICAgICAgIHJldHVybiBjaDsKCQkgICAgICAgICAgICB9LAoJCSAgICAgICAgICAgIHVucHV0OiBmdW5jdGlvbiB1bnB1dChjaCkgewoJCSAgICAgICAgICAgICAgICB2YXIgbGVuID0gY2gubGVuZ3RoOwoJCSAgICAgICAgICAgICAgICB2YXIgbGluZXMgPSBjaC5zcGxpdCgvKD86XHJcbj98XG4pL2cpOwoKCQkgICAgICAgICAgICAgICAgdGhpcy5faW5wdXQgPSBjaCArIHRoaXMuX2lucHV0OwoJCSAgICAgICAgICAgICAgICB0aGlzLnl5dGV4dCA9IHRoaXMueXl0ZXh0LnN1YnN0cigwLCB0aGlzLnl5dGV4dC5sZW5ndGggLSBsZW4gLSAxKTsKCQkgICAgICAgICAgICAgICAgLy90aGlzLnl5bGVuZyAtPSBsZW47CgkJICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0IC09IGxlbjsKCQkgICAgICAgICAgICAgICAgdmFyIG9sZExpbmVzID0gdGhpcy5tYXRjaC5zcGxpdCgvKD86XHJcbj98XG4pL2cpOwoJCSAgICAgICAgICAgICAgICB0aGlzLm1hdGNoID0gdGhpcy5tYXRjaC5zdWJzdHIoMCwgdGhpcy5tYXRjaC5sZW5ndGggLSAxKTsKCQkgICAgICAgICAgICAgICAgdGhpcy5tYXRjaGVkID0gdGhpcy5tYXRjaGVkLnN1YnN0cigwLCB0aGlzLm1hdGNoZWQubGVuZ3RoIC0gMSk7CgoJCSAgICAgICAgICAgICAgICBpZiAobGluZXMubGVuZ3RoIC0gMSkgdGhpcy55eWxpbmVubyAtPSBsaW5lcy5sZW5ndGggLSAxOwoJCSAgICAgICAgICAgICAgICB2YXIgciA9IHRoaXMueXlsbG9jLnJhbmdlOwoKCQkgICAgICAgICAgICAgICAgdGhpcy55eWxsb2MgPSB7IGZpcnN0X2xpbmU6IHRoaXMueXlsbG9jLmZpcnN0X2xpbmUsCgkJICAgICAgICAgICAgICAgICAgICBsYXN0X2xpbmU6IHRoaXMueXlsaW5lbm8gKyAxLAoJCSAgICAgICAgICAgICAgICAgICAgZmlyc3RfY29sdW1uOiB0aGlzLnl5bGxvYy5maXJzdF9jb2x1bW4sCgkJICAgICAgICAgICAgICAgICAgICBsYXN0X2NvbHVtbjogbGluZXMgPyAobGluZXMubGVuZ3RoID09PSBvbGRMaW5lcy5sZW5ndGggPyB0aGlzLnl5bGxvYy5maXJzdF9jb2x1bW4gOiAwKSArIG9sZExpbmVzW29sZExpbmVzLmxlbmd0aCAtIGxpbmVzLmxlbmd0aF0ubGVuZ3RoIC0gbGluZXNbMF0ubGVuZ3RoIDogdGhpcy55eWxsb2MuZmlyc3RfY29sdW1uIC0gbGVuCgkJICAgICAgICAgICAgICAgIH07CgoJCSAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnJhbmdlcykgewoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy55eWxsb2MucmFuZ2UgPSBbclswXSwgclswXSArIHRoaXMueXlsZW5nIC0gbGVuXTsKCQkgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKCQkgICAgICAgICAgICB9LAoJCSAgICAgICAgICAgIG1vcmU6IGZ1bmN0aW9uIG1vcmUoKSB7CgkJICAgICAgICAgICAgICAgIHRoaXMuX21vcmUgPSB0cnVlOwoJCSAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKCQkgICAgICAgICAgICB9LAoJCSAgICAgICAgICAgIGxlc3M6IGZ1bmN0aW9uIGxlc3MobikgewoJCSAgICAgICAgICAgICAgICB0aGlzLnVucHV0KHRoaXMubWF0Y2guc2xpY2UobikpOwoJCSAgICAgICAgICAgIH0sCgkJICAgICAgICAgICAgcGFzdElucHV0OiBmdW5jdGlvbiBwYXN0SW5wdXQoKSB7CgkJICAgICAgICAgICAgICAgIHZhciBwYXN0ID0gdGhpcy5tYXRjaGVkLnN1YnN0cigwLCB0aGlzLm1hdGNoZWQubGVuZ3RoIC0gdGhpcy5tYXRjaC5sZW5ndGgpOwoJCSAgICAgICAgICAgICAgICByZXR1cm4gKHBhc3QubGVuZ3RoID4gMjAgPyAnLi4uJyA6ICcnKSArIHBhc3Quc3Vic3RyKC0yMCkucmVwbGFjZSgvXG4vZywgIiIpOwoJCSAgICAgICAgICAgIH0sCgkJICAgICAgICAgICAgdXBjb21pbmdJbnB1dDogZnVuY3Rpb24gdXBjb21pbmdJbnB1dCgpIHsKCQkgICAgICAgICAgICAgICAgdmFyIG5leHQgPSB0aGlzLm1hdGNoOwoJCSAgICAgICAgICAgICAgICBpZiAobmV4dC5sZW5ndGggPCAyMCkgewoJCSAgICAgICAgICAgICAgICAgICAgbmV4dCArPSB0aGlzLl9pbnB1dC5zdWJzdHIoMCwgMjAgLSBuZXh0Lmxlbmd0aCk7CgkJICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgcmV0dXJuIChuZXh0LnN1YnN0cigwLCAyMCkgKyAobmV4dC5sZW5ndGggPiAyMCA/ICcuLi4nIDogJycpKS5yZXBsYWNlKC9cbi9nLCAiIik7CgkJICAgICAgICAgICAgfSwKCQkgICAgICAgICAgICBzaG93UG9zaXRpb246IGZ1bmN0aW9uIHNob3dQb3NpdGlvbigpIHsKCQkgICAgICAgICAgICAgICAgdmFyIHByZSA9IHRoaXMucGFzdElucHV0KCk7CgkJICAgICAgICAgICAgICAgIHZhciBjID0gbmV3IEFycmF5KHByZS5sZW5ndGggKyAxKS5qb2luKCItIik7CgkJICAgICAgICAgICAgICAgIHJldHVybiBwcmUgKyB0aGlzLnVwY29taW5nSW5wdXQoKSArICJcbiIgKyBjICsgIl4iOwoJCSAgICAgICAgICAgIH0sCgkJICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gbmV4dCgpIHsKCQkgICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9uZSkgewoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuRU9GOwoJCSAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgIGlmICghdGhpcy5faW5wdXQpIHRoaXMuZG9uZSA9IHRydWU7CgoJCSAgICAgICAgICAgICAgICB2YXIgdG9rZW4sIG1hdGNoLCB0ZW1wTWF0Y2gsIGluZGV4LCBjb2wsIGxpbmVzOwoJCSAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX21vcmUpIHsKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMueXl0ZXh0ID0gJyc7CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLm1hdGNoID0gJyc7CgkJICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgdmFyIHJ1bGVzID0gdGhpcy5fY3VycmVudFJ1bGVzKCk7CgkJICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcnVsZXMubGVuZ3RoOyBpKyspIHsKCQkgICAgICAgICAgICAgICAgICAgIHRlbXBNYXRjaCA9IHRoaXMuX2lucHV0Lm1hdGNoKHRoaXMucnVsZXNbcnVsZXNbaV1dKTsKCQkgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wTWF0Y2ggJiYgKCFtYXRjaCB8fCB0ZW1wTWF0Y2hbMF0ubGVuZ3RoID4gbWF0Y2hbMF0ubGVuZ3RoKSkgewoJCSAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoID0gdGVtcE1hdGNoOwoJCSAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gaTsKCQkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5mbGV4KSBicmVhazsKCQkgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHsKCQkgICAgICAgICAgICAgICAgICAgIGxpbmVzID0gbWF0Y2hbMF0ubWF0Y2goLyg/OlxyXG4/fFxuKS4qL2cpOwoJCSAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVzKSB0aGlzLnl5bGluZW5vICs9IGxpbmVzLmxlbmd0aDsKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMueXlsbG9jID0geyBmaXJzdF9saW5lOiB0aGlzLnl5bGxvYy5sYXN0X2xpbmUsCgkJICAgICAgICAgICAgICAgICAgICAgICAgbGFzdF9saW5lOiB0aGlzLnl5bGluZW5vICsgMSwKCQkgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdF9jb2x1bW46IHRoaXMueXlsbG9jLmxhc3RfY29sdW1uLAoJCSAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RfY29sdW1uOiBsaW5lcyA/IGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdLmxlbmd0aCAtIGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdLm1hdGNoKC9ccj9cbj8vKVswXS5sZW5ndGggOiB0aGlzLnl5bGxvYy5sYXN0X2NvbHVtbiArIG1hdGNoWzBdLmxlbmd0aCB9OwoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy55eXRleHQgKz0gbWF0Y2hbMF07CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLm1hdGNoICs9IG1hdGNoWzBdOwoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXRjaGVzID0gbWF0Y2g7CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLnl5bGVuZyA9IHRoaXMueXl0ZXh0Lmxlbmd0aDsKCQkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMucmFuZ2VzKSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy55eWxsb2MucmFuZ2UgPSBbdGhpcy5vZmZzZXQsIHRoaXMub2Zmc2V0ICs9IHRoaXMueXlsZW5nXTsKCQkgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuX21vcmUgPSBmYWxzZTsKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuX2lucHV0ID0gdGhpcy5faW5wdXQuc2xpY2UobWF0Y2hbMF0ubGVuZ3RoKTsKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMubWF0Y2hlZCArPSBtYXRjaFswXTsKCQkgICAgICAgICAgICAgICAgICAgIHRva2VuID0gdGhpcy5wZXJmb3JtQWN0aW9uLmNhbGwodGhpcywgdGhpcy55eSwgdGhpcywgcnVsZXNbaW5kZXhdLCB0aGlzLmNvbmRpdGlvblN0YWNrW3RoaXMuY29uZGl0aW9uU3RhY2subGVuZ3RoIC0gMV0pOwoJCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9uZSAmJiB0aGlzLl9pbnB1dCkgdGhpcy5kb25lID0gZmFsc2U7CgkJICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW4pIHJldHVybiB0b2tlbjtlbHNlIHJldHVybjsKCQkgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICBpZiAodGhpcy5faW5wdXQgPT09ICIiKSB7CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5FT0Y7CgkJICAgICAgICAgICAgICAgIH0gZWxzZSB7CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUVycm9yKCdMZXhpY2FsIGVycm9yIG9uIGxpbmUgJyArICh0aGlzLnl5bGluZW5vICsgMSkgKyAnLiBVbnJlY29nbml6ZWQgdGV4dC5cbicgKyB0aGlzLnNob3dQb3NpdGlvbigpLCB7IHRleHQ6ICIiLCB0b2tlbjogbnVsbCwgbGluZTogdGhpcy55eWxpbmVubyB9KTsKCQkgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgIH0sCgkJICAgICAgICAgICAgbGV4OiBmdW5jdGlvbiBsZXgoKSB7CgkJICAgICAgICAgICAgICAgIHZhciByID0gdGhpcy5uZXh0KCk7CgkJICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgciAhPT0gJ3VuZGVmaW5lZCcpIHsKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiByOwoJCSAgICAgICAgICAgICAgICB9IGVsc2UgewoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubGV4KCk7CgkJICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICB9LAoJCSAgICAgICAgICAgIGJlZ2luOiBmdW5jdGlvbiBiZWdpbihjb25kaXRpb24pIHsKCQkgICAgICAgICAgICAgICAgdGhpcy5jb25kaXRpb25TdGFjay5wdXNoKGNvbmRpdGlvbik7CgkJICAgICAgICAgICAgfSwKCQkgICAgICAgICAgICBwb3BTdGF0ZTogZnVuY3Rpb24gcG9wU3RhdGUoKSB7CgkJICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmRpdGlvblN0YWNrLnBvcCgpOwoJCSAgICAgICAgICAgIH0sCgkJICAgICAgICAgICAgX2N1cnJlbnRSdWxlczogZnVuY3Rpb24gX2N1cnJlbnRSdWxlcygpIHsKCQkgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uZGl0aW9uc1t0aGlzLmNvbmRpdGlvblN0YWNrW3RoaXMuY29uZGl0aW9uU3RhY2subGVuZ3RoIC0gMV1dLnJ1bGVzOwoJCSAgICAgICAgICAgIH0sCgkJICAgICAgICAgICAgdG9wU3RhdGU6IGZ1bmN0aW9uIHRvcFN0YXRlKCkgewoJCSAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aCAtIDJdOwoJCSAgICAgICAgICAgIH0sCgkJICAgICAgICAgICAgcHVzaFN0YXRlOiBmdW5jdGlvbiBiZWdpbihjb25kaXRpb24pIHsKCQkgICAgICAgICAgICAgICAgdGhpcy5iZWdpbihjb25kaXRpb24pOwoJCSAgICAgICAgICAgIH0gfTsKCQkgICAgICAgIGxleGVyLm9wdGlvbnMgPSB7fTsKCQkgICAgICAgIGxleGVyLnBlcmZvcm1BY3Rpb24gPSBmdW5jdGlvbiBhbm9ueW1vdXMoeXksIHl5XywgJGF2b2lkaW5nX25hbWVfY29sbGlzaW9ucywgWVlfU1RBUlQKCQkgICAgICAgIC8qKi8pIHsKCgkJICAgICAgICAgICAgZnVuY3Rpb24gc3RyaXAoc3RhcnQsIGVuZCkgewoJCSAgICAgICAgICAgICAgICByZXR1cm4geXlfLnl5dGV4dCA9IHl5Xy55eXRleHQuc3Vic3RyKHN0YXJ0LCB5eV8ueXlsZW5nIC0gZW5kKTsKCQkgICAgICAgICAgICB9CgoJCSAgICAgICAgICAgIHZhciBZWVNUQVRFID0gWVlfU1RBUlQ7CgkJICAgICAgICAgICAgc3dpdGNoICgkYXZvaWRpbmdfbmFtZV9jb2xsaXNpb25zKSB7CgkJICAgICAgICAgICAgICAgIGNhc2UgMDoKCQkgICAgICAgICAgICAgICAgICAgIGlmICh5eV8ueXl0ZXh0LnNsaWNlKC0yKSA9PT0gIlxcXFwiKSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgc3RyaXAoMCwgMSk7CgkJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZWdpbigibXUiKTsKCQkgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoeXlfLnl5dGV4dC5zbGljZSgtMSkgPT09ICJcXCIpIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICBzdHJpcCgwLCAxKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJlZ2luKCJlbXUiKTsKCQkgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZWdpbigibXUiKTsKCQkgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgICAgIGlmICh5eV8ueXl0ZXh0KSByZXR1cm4gMTU7CgoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMToKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiAxNTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDI6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcFN0YXRlKCk7CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTU7CgoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuYmVnaW4oJ3JhdycpO3JldHVybiAxNTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDQ6CgkJICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcFN0YXRlKCk7CgkJICAgICAgICAgICAgICAgICAgICAvLyBTaG91bGQgYmUgdXNpbmcgYHRoaXMudG9wU3RhdGUoKWAgYmVsb3csIGJ1dCBpdCBjdXJyZW50bHkKCQkgICAgICAgICAgICAgICAgICAgIC8vIHJldHVybnMgdGhlIHNlY29uZCB0b3AgaW5zdGVhZCBvZiB0aGUgZmlyc3QgdG9wLiBPcGVuZWQgYW4KCQkgICAgICAgICAgICAgICAgICAgIC8vIGlzc3VlIGFib3V0IGl0IGF0IGh0dHBzOi8vZ2l0aHViLmNvbS96YWFjaC9qaXNvbi9pc3N1ZXMvMjkxCgkJICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb25kaXRpb25TdGFja1t0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aCAtIDFdID09PSAncmF3JykgewoJCSAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxNTsKCQkgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgeXlfLnl5dGV4dCA9IHl5Xy55eXRleHQuc3Vic3RyKDUsIHl5Xy55eWxlbmcgLSA5KTsKCQkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ0VORF9SQVdfQkxPQ0snOwoJCSAgICAgICAgICAgICAgICAgICAgfQoKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDU6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTU7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA2OgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3BTdGF0ZSgpOwoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE0OwoKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDc6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gNjU7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA4OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDY4OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgOToKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDEwOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3BTdGF0ZSgpOwoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy5iZWdpbigncmF3Jyk7CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gMjM7CgoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTE6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gNTU7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxMjoKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiA2MDsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDEzOgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDI5OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTQ6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gNDc7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxNToKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMucG9wU3RhdGUoKTtyZXR1cm4gNDQ7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxNjoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMucG9wU3RhdGUoKTtyZXR1cm4gNDQ7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAxNzoKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiAzNDsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDE4OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDM5OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMTk6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gNTE7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyMDoKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiA0ODsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDIxOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy51bnB1dCh5eV8ueXl0ZXh0KTsKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMucG9wU3RhdGUoKTsKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMuYmVnaW4oJ2NvbScpOwoKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDIyOgoJCSAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3BTdGF0ZSgpOwoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE0OwoKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDIzOgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDQ4OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMjQ6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gNzM7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyNToKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiA3MjsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDI2OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDcyOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMjc6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gODc7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyODoKCQkgICAgICAgICAgICAgICAgICAgIC8vIGlnbm9yZSB3aGl0ZXNwYWNlCgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAyOToKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMucG9wU3RhdGUoKTtyZXR1cm4gNTQ7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAzMDoKCQkgICAgICAgICAgICAgICAgICAgIHRoaXMucG9wU3RhdGUoKTtyZXR1cm4gMzM7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAzMToKCQkgICAgICAgICAgICAgICAgICAgIHl5Xy55eXRleHQgPSBzdHJpcCgxLCAyKS5yZXBsYWNlKC9cXCIvZywgJyInKTtyZXR1cm4gODA7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAzMjoKCQkgICAgICAgICAgICAgICAgICAgIHl5Xy55eXRleHQgPSBzdHJpcCgxLCAyKS5yZXBsYWNlKC9cXCcvZywgIiciKTtyZXR1cm4gODA7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAzMzoKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiA4NTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDM0OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDgyOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzU6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gODI7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAzNjoKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiA4MzsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDM3OgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDg0OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgMzg6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gODE7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSAzOToKCQkgICAgICAgICAgICAgICAgICAgIHJldHVybiA3NTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgICAgICBjYXNlIDQwOgoJCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDc3OwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNDE6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gNzI7CgkJICAgICAgICAgICAgICAgICAgICBicmVhazsKCQkgICAgICAgICAgICAgICAgY2FzZSA0MjoKCQkgICAgICAgICAgICAgICAgICAgIHl5Xy55eXRleHQgPSB5eV8ueXl0ZXh0LnJlcGxhY2UoL1xcKFtcXFxdXSkvZywgJyQxJyk7cmV0dXJuIDcyOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNDM6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ0lOVkFMSUQnOwoJCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkJICAgICAgICAgICAgICAgIGNhc2UgNDQ6CgkJICAgICAgICAgICAgICAgICAgICByZXR1cm4gNTsKCQkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCSAgICAgICAgICAgIH0KCQkgICAgICAgIH07CgkJICAgICAgICBsZXhlci5ydWxlcyA9IFsvXig/OlteXHgwMF0qPyg/PShce1x7KSkpLywgL14oPzpbXlx4MDBdKykvLCAvXig/OlteXHgwMF17Mix9Pyg/PShce1x7fFxcXHtce3xcXFxcXHtce3wkKSkpLywgL14oPzpce1x7XHtceyg/PVteXC9dKSkvLCAvXig/Olx7XHtce1x7XC9bXlxzISIjJS0sXC5cLzstPkBcWy1cXmBcey1+XSsoPz1bPX1cc1wvLl0pXH1cfVx9XH0pLywgL14oPzpbXlx4MDBdKj8oPz0oXHtce1x7XHspKSkvLCAvXig/Oltcc1xTXSo/LS0ofik/XH1cfSkvLCAvXig/OlwoKS8sIC9eKD86XCkpLywgL14oPzpce1x7XHtceykvLCAvXig/Olx9XH1cfVx9KS8sIC9eKD86XHtceyh+KT8+KS8sIC9eKD86XHtceyh+KT8jPikvLCAvXig/Olx7XHsofik/I1wqPykvLCAvXig/Olx7XHsofik/XC8pLywgL14oPzpce1x7KH4pP1xeXHMqKH4pP1x9XH0pLywgL14oPzpce1x7KH4pP1xzKmVsc2Vccyoofik/XH1cfSkvLCAvXig/Olx7XHsofik/XF4pLywgL14oPzpce1x7KH4pP1xzKmVsc2VcYikvLCAvXig/Olx7XHsofik/XHspLywgL14oPzpce1x7KH4pPyYpLywgL14oPzpce1x7KH4pPyEtLSkvLCAvXig/Olx7XHsofik/IVtcc1xTXSo/XH1cfSkvLCAvXig/Olx7XHsofik/XCo/KS8sIC9eKD86PSkvLCAvXig/OlwuXC4pLywgL14oPzpcLig/PShbPX59XHNcLy4pfF0pKSkvLCAvXig/OltcLy5dKS8sIC9eKD86XHMrKS8sIC9eKD86XH0ofik/XH1cfSkvLCAvXig/Oih+KT9cfVx9KS8sIC9eKD86IihcXFsiXXxbXiJdKSoiKS8sIC9eKD86JyhcXFsnXXxbXiddKSonKS8sIC9eKD86QCkvLCAvXig/OnRydWUoPz0oW359XHMpXSkpKS8sIC9eKD86ZmFsc2UoPz0oW359XHMpXSkpKS8sIC9eKD86dW5kZWZpbmVkKD89KFt+fVxzKV0pKSkvLCAvXig/Om51bGwoPz0oW359XHMpXSkpKS8sIC9eKD86LT9bMC05XSsoPzpcLlswLTldKyk/KD89KFt+fVxzKV0pKSkvLCAvXig/OmFzXHMrXHwpLywgL14oPzpcfCkvLCAvXig/OihbXlxzISIjJS0sXC5cLzstPkBcWy1cXmBcey1+XSsoPz0oWz1+fVxzXC8uKXxdKSkpKS8sIC9eKD86XFsoXFxcXXxbXlxdXSkqXF0pLywgL14oPzouKS8sIC9eKD86JCkvXTsKCQkgICAgICAgIGxleGVyLmNvbmRpdGlvbnMgPSB7ICJtdSI6IHsgInJ1bGVzIjogWzcsIDgsIDksIDEwLCAxMSwgMTIsIDEzLCAxNCwgMTUsIDE2LCAxNywgMTgsIDE5LCAyMCwgMjEsIDIyLCAyMywgMjQsIDI1LCAyNiwgMjcsIDI4LCAyOSwgMzAsIDMxLCAzMiwgMzMsIDM0LCAzNSwgMzYsIDM3LCAzOCwgMzksIDQwLCA0MSwgNDIsIDQzLCA0NF0sICJpbmNsdXNpdmUiOiBmYWxzZSB9LCAiZW11IjogeyAicnVsZXMiOiBbMl0sICJpbmNsdXNpdmUiOiBmYWxzZSB9LCAiY29tIjogeyAicnVsZXMiOiBbNl0sICJpbmNsdXNpdmUiOiBmYWxzZSB9LCAicmF3IjogeyAicnVsZXMiOiBbMywgNCwgNV0sICJpbmNsdXNpdmUiOiBmYWxzZSB9LCAiSU5JVElBTCI6IHsgInJ1bGVzIjogWzAsIDEsIDQ0XSwgImluY2x1c2l2ZSI6IHRydWUgfSB9OwoJCSAgICAgICAgcmV0dXJuIGxleGVyOwoJCSAgICB9KSgpOwoJCSAgICBwYXJzZXIubGV4ZXIgPSBsZXhlcjsKCQkgICAgZnVuY3Rpb24gUGFyc2VyKCkgewoJCSAgICAgICAgdGhpcy55eSA9IHt9OwoJCSAgICB9UGFyc2VyLnByb3RvdHlwZSA9IHBhcnNlcjtwYXJzZXIuUGFyc2VyID0gUGFyc2VyOwoJCSAgICByZXR1cm4gbmV3IFBhcnNlcigpOwoJCX0pKCk7ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCQlleHBvcnRzWydkZWZhdWx0J10gPSBoYW5kbGViYXJzOwoKCS8qKiovIH0sCgkvKiAyNyAqLwoJLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCSd1c2Ugc3RyaWN0JzsKCgkJdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpWydkZWZhdWx0J107CgoJCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJCXZhciBfdmlzaXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpOwoKCQl2YXIgX3Zpc2l0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmlzaXRvcik7CgoJCWZ1bmN0aW9uIFdoaXRlc3BhY2VDb250cm9sKCkgewoJCSAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1swXTsKCgkJICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zOwoJCX0KCQlXaGl0ZXNwYWNlQ29udHJvbC5wcm90b3R5cGUgPSBuZXcgX3Zpc2l0b3IyWydkZWZhdWx0J10oKTsKCgkJV2hpdGVzcGFjZUNvbnRyb2wucHJvdG90eXBlLlByb2dyYW0gPSBmdW5jdGlvbiAocHJvZ3JhbSkgewoJCSAgdmFyIGRvU3RhbmRhbG9uZSA9ICF0aGlzLm9wdGlvbnMuaWdub3JlU3RhbmRhbG9uZTsKCgkJICB2YXIgaXNSb290ID0gIXRoaXMuaXNSb290U2VlbjsKCQkgIHRoaXMuaXNSb290U2VlbiA9IHRydWU7CgoJCSAgdmFyIGJvZHkgPSBwcm9ncmFtLmJvZHk7CgkJICBmb3IgKHZhciBpID0gMCwgbCA9IGJvZHkubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkJICAgIHZhciBjdXJyZW50ID0gYm9keVtpXSwKCQkgICAgICAgIHN0cmlwID0gdGhpcy5hY2NlcHQoY3VycmVudCk7CgoJCSAgICBpZiAoIXN0cmlwKSB7CgkJICAgICAgY29udGludWU7CgkJICAgIH0KCgkJICAgIHZhciBfaXNQcmV2V2hpdGVzcGFjZSA9IGlzUHJldldoaXRlc3BhY2UoYm9keSwgaSwgaXNSb290KSwKCQkgICAgICAgIF9pc05leHRXaGl0ZXNwYWNlID0gaXNOZXh0V2hpdGVzcGFjZShib2R5LCBpLCBpc1Jvb3QpLAoJCSAgICAgICAgb3BlblN0YW5kYWxvbmUgPSBzdHJpcC5vcGVuU3RhbmRhbG9uZSAmJiBfaXNQcmV2V2hpdGVzcGFjZSwKCQkgICAgICAgIGNsb3NlU3RhbmRhbG9uZSA9IHN0cmlwLmNsb3NlU3RhbmRhbG9uZSAmJiBfaXNOZXh0V2hpdGVzcGFjZSwKCQkgICAgICAgIGlubGluZVN0YW5kYWxvbmUgPSBzdHJpcC5pbmxpbmVTdGFuZGFsb25lICYmIF9pc1ByZXZXaGl0ZXNwYWNlICYmIF9pc05leHRXaGl0ZXNwYWNlOwoKCQkgICAgaWYgKHN0cmlwLmNsb3NlKSB7CgkJICAgICAgb21pdFJpZ2h0KGJvZHksIGksIHRydWUpOwoJCSAgICB9CgkJICAgIGlmIChzdHJpcC5vcGVuKSB7CgkJICAgICAgb21pdExlZnQoYm9keSwgaSwgdHJ1ZSk7CgkJICAgIH0KCgkJICAgIGlmIChkb1N0YW5kYWxvbmUgJiYgaW5saW5lU3RhbmRhbG9uZSkgewoJCSAgICAgIG9taXRSaWdodChib2R5LCBpKTsKCgkJICAgICAgaWYgKG9taXRMZWZ0KGJvZHksIGkpKSB7CgkJICAgICAgICAvLyBJZiB3ZSBhcmUgb24gYSBzdGFuZGFsb25lIG5vZGUsIHNhdmUgdGhlIGluZGVudCBpbmZvIGZvciBwYXJ0aWFscwoJCSAgICAgICAgaWYgKGN1cnJlbnQudHlwZSA9PT0gJ1BhcnRpYWxTdGF0ZW1lbnQnKSB7CgkJICAgICAgICAgIC8vIFB1bGwgb3V0IHRoZSB3aGl0ZXNwYWNlIGZyb20gdGhlIGZpbmFsIGxpbmUKCQkgICAgICAgICAgY3VycmVudC5pbmRlbnQgPSAvKFsgXHRdKyQpLy5leGVjKGJvZHlbaSAtIDFdLm9yaWdpbmFsKVsxXTsKCQkgICAgICAgIH0KCQkgICAgICB9CgkJICAgIH0KCQkgICAgaWYgKGRvU3RhbmRhbG9uZSAmJiBvcGVuU3RhbmRhbG9uZSkgewoJCSAgICAgIG9taXRSaWdodCgoY3VycmVudC5wcm9ncmFtIHx8IGN1cnJlbnQuaW52ZXJzZSkuYm9keSk7CgoJCSAgICAgIC8vIFN0cmlwIG91dCB0aGUgcHJldmlvdXMgY29udGVudCBub2RlIGlmIGl0J3Mgd2hpdGVzcGFjZSBvbmx5CgkJICAgICAgb21pdExlZnQoYm9keSwgaSk7CgkJICAgIH0KCQkgICAgaWYgKGRvU3RhbmRhbG9uZSAmJiBjbG9zZVN0YW5kYWxvbmUpIHsKCQkgICAgICAvLyBBbHdheXMgc3RyaXAgdGhlIG5leHQgbm9kZQoJCSAgICAgIG9taXRSaWdodChib2R5LCBpKTsKCgkJICAgICAgb21pdExlZnQoKGN1cnJlbnQuaW52ZXJzZSB8fCBjdXJyZW50LnByb2dyYW0pLmJvZHkpOwoJCSAgICB9CgkJICB9CgoJCSAgcmV0dXJuIHByb2dyYW07CgkJfTsKCgkJV2hpdGVzcGFjZUNvbnRyb2wucHJvdG90eXBlLkJsb2NrU3RhdGVtZW50ID0gV2hpdGVzcGFjZUNvbnRyb2wucHJvdG90eXBlLkRlY29yYXRvckJsb2NrID0gV2hpdGVzcGFjZUNvbnRyb2wucHJvdG90eXBlLlBhcnRpYWxCbG9ja1N0YXRlbWVudCA9IGZ1bmN0aW9uIChibG9jaykgewoJCSAgdGhpcy5hY2NlcHQoYmxvY2sucHJvZ3JhbSk7CgkJICB0aGlzLmFjY2VwdChibG9jay5pbnZlcnNlKTsKCgkJICAvLyBGaW5kIHRoZSBpbnZlcnNlIHByb2dyYW0gdGhhdCBpcyBpbnZvbGVkIHdpdGggd2hpdGVzcGFjZSBzdHJpcHBpbmcuCgkJICB2YXIgcHJvZ3JhbSA9IGJsb2NrLnByb2dyYW0gfHwgYmxvY2suaW52ZXJzZSwKCQkgICAgICBpbnZlcnNlID0gYmxvY2sucHJvZ3JhbSAmJiBibG9jay5pbnZlcnNlLAoJCSAgICAgIGZpcnN0SW52ZXJzZSA9IGludmVyc2UsCgkJICAgICAgbGFzdEludmVyc2UgPSBpbnZlcnNlOwoKCQkgIGlmIChpbnZlcnNlICYmIGludmVyc2UuY2hhaW5lZCkgewoJCSAgICBmaXJzdEludmVyc2UgPSBpbnZlcnNlLmJvZHlbMF0ucHJvZ3JhbTsKCgkJICAgIC8vIFdhbGsgdGhlIGludmVyc2UgY2hhaW4gdG8gZmluZCB0aGUgbGFzdCBpbnZlcnNlIHRoYXQgaXMgYWN0dWFsbHkgaW4gdGhlIGNoYWluLgoJCSAgICB3aGlsZSAobGFzdEludmVyc2UuY2hhaW5lZCkgewoJCSAgICAgIGxhc3RJbnZlcnNlID0gbGFzdEludmVyc2UuYm9keVtsYXN0SW52ZXJzZS5ib2R5Lmxlbmd0aCAtIDFdLnByb2dyYW07CgkJICAgIH0KCQkgIH0KCgkJICB2YXIgc3RyaXAgPSB7CgkJICAgIG9wZW46IGJsb2NrLm9wZW5TdHJpcC5vcGVuLAoJCSAgICBjbG9zZTogYmxvY2suY2xvc2VTdHJpcC5jbG9zZSwKCgkJICAgIC8vIERldGVybWluZSB0aGUgc3RhbmRhbG9uZSBjYW5kaWFjeS4gQmFzaWNhbGx5IGZsYWcgb3VyIGNvbnRlbnQgYXMgYmVpbmcgcG9zc2libHkgc3RhbmRhbG9uZQoJCSAgICAvLyBzbyBvdXIgcGFyZW50IGNhbiBkZXRlcm1pbmUgaWYgd2UgYWN0dWFsbHkgYXJlIHN0YW5kYWxvbmUKCQkgICAgb3BlblN0YW5kYWxvbmU6IGlzTmV4dFdoaXRlc3BhY2UocHJvZ3JhbS5ib2R5KSwKCQkgICAgY2xvc2VTdGFuZGFsb25lOiBpc1ByZXZXaGl0ZXNwYWNlKChmaXJzdEludmVyc2UgfHwgcHJvZ3JhbSkuYm9keSkKCQkgIH07CgoJCSAgaWYgKGJsb2NrLm9wZW5TdHJpcC5jbG9zZSkgewoJCSAgICBvbWl0UmlnaHQocHJvZ3JhbS5ib2R5LCBudWxsLCB0cnVlKTsKCQkgIH0KCgkJICBpZiAoaW52ZXJzZSkgewoJCSAgICB2YXIgaW52ZXJzZVN0cmlwID0gYmxvY2suaW52ZXJzZVN0cmlwOwoKCQkgICAgaWYgKGludmVyc2VTdHJpcC5vcGVuKSB7CgkJICAgICAgb21pdExlZnQocHJvZ3JhbS5ib2R5LCBudWxsLCB0cnVlKTsKCQkgICAgfQoKCQkgICAgaWYgKGludmVyc2VTdHJpcC5jbG9zZSkgewoJCSAgICAgIG9taXRSaWdodChmaXJzdEludmVyc2UuYm9keSwgbnVsbCwgdHJ1ZSk7CgkJICAgIH0KCQkgICAgaWYgKGJsb2NrLmNsb3NlU3RyaXAub3BlbikgewoJCSAgICAgIG9taXRMZWZ0KGxhc3RJbnZlcnNlLmJvZHksIG51bGwsIHRydWUpOwoJCSAgICB9CgoJCSAgICAvLyBGaW5kIHN0YW5kYWxvbmUgZWxzZSBzdGF0bWVudHMKCQkgICAgaWYgKCF0aGlzLm9wdGlvbnMuaWdub3JlU3RhbmRhbG9uZSAmJiBpc1ByZXZXaGl0ZXNwYWNlKHByb2dyYW0uYm9keSkgJiYgaXNOZXh0V2hpdGVzcGFjZShmaXJzdEludmVyc2UuYm9keSkpIHsKCQkgICAgICBvbWl0TGVmdChwcm9ncmFtLmJvZHkpOwoJCSAgICAgIG9taXRSaWdodChmaXJzdEludmVyc2UuYm9keSk7CgkJICAgIH0KCQkgIH0gZWxzZSBpZiAoYmxvY2suY2xvc2VTdHJpcC5vcGVuKSB7CgkJICAgIG9taXRMZWZ0KHByb2dyYW0uYm9keSwgbnVsbCwgdHJ1ZSk7CgkJICB9CgoJCSAgcmV0dXJuIHN0cmlwOwoJCX07CgoJCVdoaXRlc3BhY2VDb250cm9sLnByb3RvdHlwZS5EZWNvcmF0b3IgPSBXaGl0ZXNwYWNlQ29udHJvbC5wcm90b3R5cGUuTXVzdGFjaGVTdGF0ZW1lbnQgPSBmdW5jdGlvbiAobXVzdGFjaGUpIHsKCQkgIHJldHVybiBtdXN0YWNoZS5zdHJpcDsKCQl9OwoKCQlXaGl0ZXNwYWNlQ29udHJvbC5wcm90b3R5cGUuUGFydGlhbFN0YXRlbWVudCA9IFdoaXRlc3BhY2VDb250cm9sLnByb3RvdHlwZS5Db21tZW50U3RhdGVtZW50ID0gZnVuY3Rpb24gKG5vZGUpIHsKCQkgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCgkJICB2YXIgc3RyaXAgPSBub2RlLnN0cmlwIHx8IHt9OwoJCSAgcmV0dXJuIHsKCQkgICAgaW5saW5lU3RhbmRhbG9uZTogdHJ1ZSwKCQkgICAgb3Blbjogc3RyaXAub3BlbiwKCQkgICAgY2xvc2U6IHN0cmlwLmNsb3NlCgkJICB9OwoJCX07CgoJCWZ1bmN0aW9uIGlzUHJldldoaXRlc3BhY2UoYm9keSwgaSwgaXNSb290KSB7CgkJICBpZiAoaSA9PT0gdW5kZWZpbmVkKSB7CgkJICAgIGkgPSBib2R5Lmxlbmd0aDsKCQkgIH0KCgkJICAvLyBOb2RlcyB0aGF0IGVuZCB3aXRoIG5ld2xpbmVzIGFyZSBjb25zaWRlcmVkIHdoaXRlc3BhY2UgKGJ1dCBhcmUgc3BlY2lhbAoJCSAgLy8gY2FzZWQgZm9yIHN0cmlwIG9wZXJhdGlvbnMpCgkJICB2YXIgcHJldiA9IGJvZHlbaSAtIDFdLAoJCSAgICAgIHNpYmxpbmcgPSBib2R5W2kgLSAyXTsKCQkgIGlmICghcHJldikgewoJCSAgICByZXR1cm4gaXNSb290OwoJCSAgfQoKCQkgIGlmIChwcmV2LnR5cGUgPT09ICdDb250ZW50U3RhdGVtZW50JykgewoJCSAgICByZXR1cm4gKHNpYmxpbmcgfHwgIWlzUm9vdCA/IC9ccj9cblxzKj8kLyA6IC8oXnxccj9cbilccyo/JC8pLnRlc3QocHJldi5vcmlnaW5hbCk7CgkJICB9CgkJfQoJCWZ1bmN0aW9uIGlzTmV4dFdoaXRlc3BhY2UoYm9keSwgaSwgaXNSb290KSB7CgkJICBpZiAoaSA9PT0gdW5kZWZpbmVkKSB7CgkJICAgIGkgPSAtMTsKCQkgIH0KCgkJICB2YXIgbmV4dCA9IGJvZHlbaSArIDFdLAoJCSAgICAgIHNpYmxpbmcgPSBib2R5W2kgKyAyXTsKCQkgIGlmICghbmV4dCkgewoJCSAgICByZXR1cm4gaXNSb290OwoJCSAgfQoKCQkgIGlmIChuZXh0LnR5cGUgPT09ICdDb250ZW50U3RhdGVtZW50JykgewoJCSAgICByZXR1cm4gKHNpYmxpbmcgfHwgIWlzUm9vdCA/IC9eXHMqP1xyP1xuLyA6IC9eXHMqPyhccj9cbnwkKS8pLnRlc3QobmV4dC5vcmlnaW5hbCk7CgkJICB9CgkJfQoKCQkvLyBNYXJrcyB0aGUgbm9kZSB0byB0aGUgcmlnaHQgb2YgdGhlIHBvc2l0aW9uIGFzIG9taXR0ZWQuCgkJLy8gSS5lLiB7e2Zvb319JyAnIHdpbGwgbWFyayB0aGUgJyAnIG5vZGUgYXMgb21pdHRlZC4KCQkvLwoJCS8vIElmIGkgaXMgdW5kZWZpbmVkLCB0aGVuIHRoZSBmaXJzdCBjaGlsZCB3aWxsIGJlIG1hcmtlZCBhcyBzdWNoLgoJCS8vCgkJLy8gSWYgbXVsaXRwbGUgaXMgdHJ1dGh5IHRoZW4gYWxsIHdoaXRlc3BhY2Ugd2lsbCBiZSBzdHJpcHBlZCBvdXQgdW50aWwgbm9uLXdoaXRlc3BhY2UKCQkvLyBjb250ZW50IGlzIG1ldC4KCQlmdW5jdGlvbiBvbWl0UmlnaHQoYm9keSwgaSwgbXVsdGlwbGUpIHsKCQkgIHZhciBjdXJyZW50ID0gYm9keVtpID09IG51bGwgPyAwIDogaSArIDFdOwoJCSAgaWYgKCFjdXJyZW50IHx8IGN1cnJlbnQudHlwZSAhPT0gJ0NvbnRlbnRTdGF0ZW1lbnQnIHx8ICFtdWx0aXBsZSAmJiBjdXJyZW50LnJpZ2h0U3RyaXBwZWQpIHsKCQkgICAgcmV0dXJuOwoJCSAgfQoKCQkgIHZhciBvcmlnaW5hbCA9IGN1cnJlbnQudmFsdWU7CgkJICBjdXJyZW50LnZhbHVlID0gY3VycmVudC52YWx1ZS5yZXBsYWNlKG11bHRpcGxlID8gL15ccysvIDogL15bIFx0XSpccj9cbj8vLCAnJyk7CgkJICBjdXJyZW50LnJpZ2h0U3RyaXBwZWQgPSBjdXJyZW50LnZhbHVlICE9PSBvcmlnaW5hbDsKCQl9CgoJCS8vIE1hcmtzIHRoZSBub2RlIHRvIHRoZSBsZWZ0IG9mIHRoZSBwb3NpdGlvbiBhcyBvbWl0dGVkLgoJCS8vIEkuZS4gJyAne3tmb299fSB3aWxsIG1hcmsgdGhlICcgJyBub2RlIGFzIG9taXR0ZWQuCgkJLy8KCQkvLyBJZiBpIGlzIHVuZGVmaW5lZCB0aGVuIHRoZSBsYXN0IGNoaWxkIHdpbGwgYmUgbWFya2VkIGFzIHN1Y2guCgkJLy8KCQkvLyBJZiBtdWxpdHBsZSBpcyB0cnV0aHkgdGhlbiBhbGwgd2hpdGVzcGFjZSB3aWxsIGJlIHN0cmlwcGVkIG91dCB1bnRpbCBub24td2hpdGVzcGFjZQoJCS8vIGNvbnRlbnQgaXMgbWV0LgoJCWZ1bmN0aW9uIG9taXRMZWZ0KGJvZHksIGksIG11bHRpcGxlKSB7CgkJICB2YXIgY3VycmVudCA9IGJvZHlbaSA9PSBudWxsID8gYm9keS5sZW5ndGggLSAxIDogaSAtIDFdOwoJCSAgaWYgKCFjdXJyZW50IHx8IGN1cnJlbnQudHlwZSAhPT0gJ0NvbnRlbnRTdGF0ZW1lbnQnIHx8ICFtdWx0aXBsZSAmJiBjdXJyZW50LmxlZnRTdHJpcHBlZCkgewoJCSAgICByZXR1cm47CgkJICB9CgoJCSAgLy8gV2Ugb21pdCB0aGUgbGFzdCBub2RlIGlmIGl0J3Mgd2hpdGVzcGFjZSBvbmx5IGFuZCBub3QgcHJlY2VlZGVkIGJ5IGEgbm9uLWNvbnRlbnQgbm9kZS4KCQkgIHZhciBvcmlnaW5hbCA9IGN1cnJlbnQudmFsdWU7CgkJICBjdXJyZW50LnZhbHVlID0gY3VycmVudC52YWx1ZS5yZXBsYWNlKG11bHRpcGxlID8gL1xzKyQvIDogL1sgXHRdKyQvLCAnJyk7CgkJICBjdXJyZW50LmxlZnRTdHJpcHBlZCA9IGN1cnJlbnQudmFsdWUgIT09IG9yaWdpbmFsOwoJCSAgcmV0dXJuIGN1cnJlbnQubGVmdFN0cmlwcGVkOwoJCX0KCgkJZXhwb3J0c1snZGVmYXVsdCddID0gV2hpdGVzcGFjZUNvbnRyb2w7CgkJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSwKCS8qIDI4ICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgkJdmFyIF9leGNlcHRpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwoKCQl2YXIgX2V4Y2VwdGlvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGNlcHRpb24pOwoKCQlmdW5jdGlvbiBWaXNpdG9yKCkgewoJCSAgdGhpcy5wYXJlbnRzID0gW107CgkJfQoKCQlWaXNpdG9yLnByb3RvdHlwZSA9IHsKCQkgIGNvbnN0cnVjdG9yOiBWaXNpdG9yLAoJCSAgbXV0YXRpbmc6IGZhbHNlLAoKCQkgIC8vIFZpc2l0cyBhIGdpdmVuIHZhbHVlLiBJZiBtdXRhdGluZywgd2lsbCByZXBsYWNlIHRoZSB2YWx1ZSBpZiBuZWNlc3NhcnkuCgkJICBhY2NlcHRLZXk6IGZ1bmN0aW9uIGFjY2VwdEtleShub2RlLCBuYW1lKSB7CgkJICAgIHZhciB2YWx1ZSA9IHRoaXMuYWNjZXB0KG5vZGVbbmFtZV0pOwoJCSAgICBpZiAodGhpcy5tdXRhdGluZykgewoJCSAgICAgIC8vIEhhY2t5IHNhbml0eSBjaGVjazogVGhpcyBtYXkgaGF2ZSBhIGZldyBmYWxzZSBwb3NpdGl2ZXMgZm9yIHR5cGUgZm9yIHRoZSBoZWxwZXIKCQkgICAgICAvLyBtZXRob2RzIGJ1dCB3aWxsIGdlbmVyYWxseSBkbyB0aGUgcmlnaHQgdGhpbmcgd2l0aG91dCBhIGxvdCBvZiBvdmVyaGVhZC4KCQkgICAgICBpZiAodmFsdWUgJiYgIVZpc2l0b3IucHJvdG90eXBlW3ZhbHVlLnR5cGVdKSB7CgkJICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnVW5leHBlY3RlZCBub2RlIHR5cGUgIicgKyB2YWx1ZS50eXBlICsgJyIgZm91bmQgd2hlbiBhY2NlcHRpbmcgJyArIG5hbWUgKyAnIG9uICcgKyBub2RlLnR5cGUpOwoJCSAgICAgIH0KCQkgICAgICBub2RlW25hbWVdID0gdmFsdWU7CgkJICAgIH0KCQkgIH0sCgoJCSAgLy8gUGVyZm9ybXMgYW4gYWNjZXB0IG9wZXJhdGlvbiB3aXRoIGFkZGVkIHNhbml0eSBjaGVjayB0byBlbnN1cmUKCQkgIC8vIHJlcXVpcmVkIGtleXMgYXJlIG5vdCByZW1vdmVkLgoJCSAgYWNjZXB0UmVxdWlyZWQ6IGZ1bmN0aW9uIGFjY2VwdFJlcXVpcmVkKG5vZGUsIG5hbWUpIHsKCQkgICAgdGhpcy5hY2NlcHRLZXkobm9kZSwgbmFtZSk7CgoJCSAgICBpZiAoIW5vZGVbbmFtZV0pIHsKCQkgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXShub2RlLnR5cGUgKyAnIHJlcXVpcmVzICcgKyBuYW1lKTsKCQkgICAgfQoJCSAgfSwKCgkJICAvLyBUcmF2ZXJzZXMgYSBnaXZlbiBhcnJheS4gSWYgbXV0YXRpbmcsIGVtcHR5IHJlc3Buc2VzIHdpbGwgYmUgcmVtb3ZlZAoJCSAgLy8gZm9yIGNoaWxkIGVsZW1lbnRzLgoJCSAgYWNjZXB0QXJyYXk6IGZ1bmN0aW9uIGFjY2VwdEFycmF5KGFycmF5KSB7CgkJICAgIGZvciAodmFyIGkgPSAwLCBsID0gYXJyYXkubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkJICAgICAgdGhpcy5hY2NlcHRLZXkoYXJyYXksIGkpOwoKCQkgICAgICBpZiAoIWFycmF5W2ldKSB7CgkJICAgICAgICBhcnJheS5zcGxpY2UoaSwgMSk7CgkJICAgICAgICBpLS07CgkJICAgICAgICBsLS07CgkJICAgICAgfQoJCSAgICB9CgkJICB9LAoKCQkgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KG9iamVjdCkgewoJCSAgICBpZiAoIW9iamVjdCkgewoJCSAgICAgIHJldHVybjsKCQkgICAgfQoKCQkgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IFNhbml0eSBjb2RlICovCgkJICAgIGlmICghdGhpc1tvYmplY3QudHlwZV0pIHsKCQkgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnVW5rbm93biB0eXBlOiAnICsgb2JqZWN0LnR5cGUsIG9iamVjdCk7CgkJICAgIH0KCgkJICAgIGlmICh0aGlzLmN1cnJlbnQpIHsKCQkgICAgICB0aGlzLnBhcmVudHMudW5zaGlmdCh0aGlzLmN1cnJlbnQpOwoJCSAgICB9CgkJICAgIHRoaXMuY3VycmVudCA9IG9iamVjdDsKCgkJICAgIHZhciByZXQgPSB0aGlzW29iamVjdC50eXBlXShvYmplY3QpOwoKCQkgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5wYXJlbnRzLnNoaWZ0KCk7CgoJCSAgICBpZiAoIXRoaXMubXV0YXRpbmcgfHwgcmV0KSB7CgkJICAgICAgcmV0dXJuIHJldDsKCQkgICAgfSBlbHNlIGlmIChyZXQgIT09IGZhbHNlKSB7CgkJICAgICAgcmV0dXJuIG9iamVjdDsKCQkgICAgfQoJCSAgfSwKCgkJICBQcm9ncmFtOiBmdW5jdGlvbiBQcm9ncmFtKHByb2dyYW0pIHsKCQkgICAgdGhpcy5hY2NlcHRBcnJheShwcm9ncmFtLmJvZHkpOwoJCSAgfSwKCgkJICBNdXN0YWNoZVN0YXRlbWVudDogdmlzaXRTdWJFeHByZXNzaW9uLAoJCSAgRGVjb3JhdG9yOiB2aXNpdFN1YkV4cHJlc3Npb24sCgoJCSAgQmxvY2tTdGF0ZW1lbnQ6IHZpc2l0QmxvY2ssCgkJICBEZWNvcmF0b3JCbG9jazogdmlzaXRCbG9jaywKCgkJICBQYXJ0aWFsU3RhdGVtZW50OiB2aXNpdFBhcnRpYWwsCgkJICBQYXJ0aWFsQmxvY2tTdGF0ZW1lbnQ6IGZ1bmN0aW9uIFBhcnRpYWxCbG9ja1N0YXRlbWVudChwYXJ0aWFsKSB7CgkJICAgIHZpc2l0UGFydGlhbC5jYWxsKHRoaXMsIHBhcnRpYWwpOwoKCQkgICAgdGhpcy5hY2NlcHRLZXkocGFydGlhbCwgJ3Byb2dyYW0nKTsKCQkgIH0sCgoJCSAgQ29udGVudFN0YXRlbWVudDogZnVuY3Rpb24gQ29udGVudFN0YXRlbWVudCgpIC8qIGNvbnRlbnQgKi97fSwKCQkgIENvbW1lbnRTdGF0ZW1lbnQ6IGZ1bmN0aW9uIENvbW1lbnRTdGF0ZW1lbnQoKSAvKiBjb21tZW50ICove30sCgoJCSAgU3ViRXhwcmVzc2lvbjogdmlzaXRTdWJFeHByZXNzaW9uLAoKCQkgIFBhdGhFeHByZXNzaW9uOiBmdW5jdGlvbiBQYXRoRXhwcmVzc2lvbigpIC8qIHBhdGggKi97fSwKCgkJICBTdHJpbmdMaXRlcmFsOiBmdW5jdGlvbiBTdHJpbmdMaXRlcmFsKCkgLyogc3RyaW5nICove30sCgkJICBOdW1iZXJMaXRlcmFsOiBmdW5jdGlvbiBOdW1iZXJMaXRlcmFsKCkgLyogbnVtYmVyICove30sCgkJICBCb29sZWFuTGl0ZXJhbDogZnVuY3Rpb24gQm9vbGVhbkxpdGVyYWwoKSAvKiBib29sICove30sCgkJICBVbmRlZmluZWRMaXRlcmFsOiBmdW5jdGlvbiBVbmRlZmluZWRMaXRlcmFsKCkgLyogbGl0ZXJhbCAqL3t9LAoJCSAgTnVsbExpdGVyYWw6IGZ1bmN0aW9uIE51bGxMaXRlcmFsKCkgLyogbGl0ZXJhbCAqL3t9LAoKCQkgIEhhc2g6IGZ1bmN0aW9uIEhhc2goaGFzaCkgewoJCSAgICB0aGlzLmFjY2VwdEFycmF5KGhhc2gucGFpcnMpOwoJCSAgfSwKCQkgIEhhc2hQYWlyOiBmdW5jdGlvbiBIYXNoUGFpcihwYWlyKSB7CgkJICAgIHRoaXMuYWNjZXB0UmVxdWlyZWQocGFpciwgJ3ZhbHVlJyk7CgkJICB9CgkJfTsKCgkJZnVuY3Rpb24gdmlzaXRTdWJFeHByZXNzaW9uKG11c3RhY2hlKSB7CgkJICB0aGlzLmFjY2VwdFJlcXVpcmVkKG11c3RhY2hlLCAncGF0aCcpOwoJCSAgdGhpcy5hY2NlcHRBcnJheShtdXN0YWNoZS5wYXJhbXMpOwoJCSAgdGhpcy5hY2NlcHRLZXkobXVzdGFjaGUsICdoYXNoJyk7CgkJfQoJCWZ1bmN0aW9uIHZpc2l0QmxvY2soYmxvY2spIHsKCQkgIHZpc2l0U3ViRXhwcmVzc2lvbi5jYWxsKHRoaXMsIGJsb2NrKTsKCgkJICB0aGlzLmFjY2VwdEtleShibG9jaywgJ3Byb2dyYW0nKTsKCQkgIHRoaXMuYWNjZXB0S2V5KGJsb2NrLCAnaW52ZXJzZScpOwoJCX0KCQlmdW5jdGlvbiB2aXNpdFBhcnRpYWwocGFydGlhbCkgewoJCSAgdGhpcy5hY2NlcHRSZXF1aXJlZChwYXJ0aWFsLCAnbmFtZScpOwoJCSAgdGhpcy5hY2NlcHRBcnJheShwYXJ0aWFsLnBhcmFtcyk7CgkJICB0aGlzLmFjY2VwdEtleShwYXJ0aWFsLCAnaGFzaCcpOwoJCX0KCgkJZXhwb3J0c1snZGVmYXVsdCddID0gVmlzaXRvcjsKCQltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9LAoJLyogMjkgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkndXNlIHN0cmljdCc7CgoJCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoJCWV4cG9ydHMuU291cmNlTG9jYXRpb24gPSBTb3VyY2VMb2NhdGlvbjsKCQlleHBvcnRzLmlkID0gaWQ7CgkJZXhwb3J0cy5zdHJpcEZsYWdzID0gc3RyaXBGbGFnczsKCQlleHBvcnRzLnN0cmlwQ29tbWVudCA9IHN0cmlwQ29tbWVudDsKCQlleHBvcnRzLnByZXBhcmVQYXRoID0gcHJlcGFyZVBhdGg7CgkJZXhwb3J0cy5wcmVwYXJlTXVzdGFjaGUgPSBwcmVwYXJlTXVzdGFjaGU7CgkJZXhwb3J0cy5wcmVwYXJlUmF3QmxvY2sgPSBwcmVwYXJlUmF3QmxvY2s7CgkJZXhwb3J0cy5wcmVwYXJlQmxvY2sgPSBwcmVwYXJlQmxvY2s7CgkJZXhwb3J0cy5wcmVwYXJlUHJvZ3JhbSA9IHByZXBhcmVQcm9ncmFtOwoJCWV4cG9ydHMucHJlcGFyZVBhcnRpYWxCbG9jayA9IHByZXBhcmVQYXJ0aWFsQmxvY2s7CgoJCXZhciBfZXhjZXB0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKCgkJdmFyIF9leGNlcHRpb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhjZXB0aW9uKTsKCgkJZnVuY3Rpb24gdmFsaWRhdGVDbG9zZShvcGVuLCBjbG9zZSkgewoJCSAgY2xvc2UgPSBjbG9zZS5wYXRoID8gY2xvc2UucGF0aC5vcmlnaW5hbCA6IGNsb3NlOwoKCQkgIGlmIChvcGVuLnBhdGgub3JpZ2luYWwgIT09IGNsb3NlKSB7CgkJICAgIHZhciBlcnJvck5vZGUgPSB7IGxvYzogb3Blbi5wYXRoLmxvYyB9OwoKCQkgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10ob3Blbi5wYXRoLm9yaWdpbmFsICsgIiBkb2Vzbid0IG1hdGNoICIgKyBjbG9zZSwgZXJyb3JOb2RlKTsKCQkgIH0KCQl9CgoJCWZ1bmN0aW9uIFNvdXJjZUxvY2F0aW9uKHNvdXJjZSwgbG9jSW5mbykgewoJCSAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7CgkJICB0aGlzLnN0YXJ0ID0gewoJCSAgICBsaW5lOiBsb2NJbmZvLmZpcnN0X2xpbmUsCgkJICAgIGNvbHVtbjogbG9jSW5mby5maXJzdF9jb2x1bW4KCQkgIH07CgkJICB0aGlzLmVuZCA9IHsKCQkgICAgbGluZTogbG9jSW5mby5sYXN0X2xpbmUsCgkJICAgIGNvbHVtbjogbG9jSW5mby5sYXN0X2NvbHVtbgoJCSAgfTsKCQl9CgoJCWZ1bmN0aW9uIGlkKHRva2VuKSB7CgkJICBpZiAoL15cWy4qXF0kLy50ZXN0KHRva2VuKSkgewoJCSAgICByZXR1cm4gdG9rZW4uc3Vic3RyKDEsIHRva2VuLmxlbmd0aCAtIDIpOwoJCSAgfSBlbHNlIHsKCQkgICAgcmV0dXJuIHRva2VuOwoJCSAgfQoJCX0KCgkJZnVuY3Rpb24gc3RyaXBGbGFncyhvcGVuLCBjbG9zZSkgewoJCSAgcmV0dXJuIHsKCQkgICAgb3Blbjogb3Blbi5jaGFyQXQoMikgPT09ICd+JywKCQkgICAgY2xvc2U6IGNsb3NlLmNoYXJBdChjbG9zZS5sZW5ndGggLSAzKSA9PT0gJ34nCgkJICB9OwoJCX0KCgkJZnVuY3Rpb24gc3RyaXBDb21tZW50KGNvbW1lbnQpIHsKCQkgIHJldHVybiBjb21tZW50LnJlcGxhY2UoL15ce1x7fj9cIS0/LT8vLCAnJykucmVwbGFjZSgvLT8tP34/XH1cfSQvLCAnJyk7CgkJfQoKCQlmdW5jdGlvbiBwcmVwYXJlUGF0aChkYXRhLCBwYXJ0cywgbG9jKSB7CgkJICBsb2MgPSB0aGlzLmxvY0luZm8obG9jKTsKCgkJICB2YXIgb3JpZ2luYWwgPSBkYXRhID8gJ0AnIDogJycsCgkJICAgICAgZGlnID0gW10sCgkJICAgICAgZGVwdGggPSAwLAoJCSAgICAgIGRlcHRoU3RyaW5nID0gJyc7CgoJCSAgZm9yICh2YXIgaSA9IDAsIGwgPSBwYXJ0cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKCQkgICAgdmFyIHBhcnQgPSBwYXJ0c1tpXS5wYXJ0LAoKCQkgICAgLy8gSWYgd2UgaGF2ZSBbXSBzeW50YXggdGhlbiB3ZSBkbyBub3QgdHJlYXQgcGF0aCByZWZlcmVuY2VzIGFzIG9wZXJhdG9ycywKCQkgICAgLy8gaS5lLiBmb28uW3RoaXNdIHJlc29sdmVzIHRvIGFwcHJveGltYXRlbHkgY29udGV4dC5mb29bJ3RoaXMnXQoJCSAgICBpc0xpdGVyYWwgPSBwYXJ0c1tpXS5vcmlnaW5hbCAhPT0gcGFydDsKCQkgICAgb3JpZ2luYWwgKz0gKHBhcnRzW2ldLnNlcGFyYXRvciB8fCAnJykgKyBwYXJ0OwoKCQkgICAgaWYgKCFpc0xpdGVyYWwgJiYgKHBhcnQgPT09ICcuLicgfHwgcGFydCA9PT0gJy4nIHx8IHBhcnQgPT09ICd0aGlzJykpIHsKCQkgICAgICBpZiAoZGlnLmxlbmd0aCA+IDApIHsKCQkgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdJbnZhbGlkIHBhdGg6ICcgKyBvcmlnaW5hbCwgeyBsb2M6IGxvYyB9KTsKCQkgICAgICB9IGVsc2UgaWYgKHBhcnQgPT09ICcuLicpIHsKCQkgICAgICAgIGRlcHRoKys7CgkJICAgICAgICBkZXB0aFN0cmluZyArPSAnLi4vJzsKCQkgICAgICB9CgkJICAgIH0gZWxzZSB7CgkJICAgICAgZGlnLnB1c2gocGFydCk7CgkJICAgIH0KCQkgIH0KCgkJICByZXR1cm4gewoJCSAgICB0eXBlOiAnUGF0aEV4cHJlc3Npb24nLAoJCSAgICBkYXRhOiBkYXRhLAoJCSAgICBkZXB0aDogZGVwdGgsCgkJICAgIHBhcnRzOiBkaWcsCgkJICAgIG9yaWdpbmFsOiBvcmlnaW5hbCwKCQkgICAgbG9jOiBsb2MKCQkgIH07CgkJfQoKCQlmdW5jdGlvbiBwcmVwYXJlTXVzdGFjaGUocGF0aCwgcGFyYW1zLCBoYXNoLCBvcGVuLCBzdHJpcCwgbG9jSW5mbykgewoJCSAgLy8gTXVzdCB1c2UgY2hhckF0IHRvIHN1cHBvcnQgSUUgcHJlLTEwCgkJICB2YXIgZXNjYXBlRmxhZyA9IG9wZW4uY2hhckF0KDMpIHx8IG9wZW4uY2hhckF0KDIpLAoJCSAgICAgIGVzY2FwZWQgPSBlc2NhcGVGbGFnICE9PSAneycgJiYgZXNjYXBlRmxhZyAhPT0gJyYnOwoKCQkgIHZhciBkZWNvcmF0b3IgPSAvXCovLnRlc3Qob3Blbik7CgkJICByZXR1cm4gewoJCSAgICB0eXBlOiBkZWNvcmF0b3IgPyAnRGVjb3JhdG9yJyA6ICdNdXN0YWNoZVN0YXRlbWVudCcsCgkJICAgIHBhdGg6IHBhdGgsCgkJICAgIHBhcmFtczogcGFyYW1zLAoJCSAgICBoYXNoOiBoYXNoLAoJCSAgICBlc2NhcGVkOiBlc2NhcGVkLAoJCSAgICBzdHJpcDogc3RyaXAsCgkJICAgIGxvYzogdGhpcy5sb2NJbmZvKGxvY0luZm8pCgkJICB9OwoJCX0KCgkJZnVuY3Rpb24gcHJlcGFyZVJhd0Jsb2NrKG9wZW5SYXdCbG9jaywgY29udGVudHMsIGNsb3NlLCBsb2NJbmZvKSB7CgkJICB2YWxpZGF0ZUNsb3NlKG9wZW5SYXdCbG9jaywgY2xvc2UpOwoKCQkgIGxvY0luZm8gPSB0aGlzLmxvY0luZm8obG9jSW5mbyk7CgkJICB2YXIgcHJvZ3JhbSA9IHsKCQkgICAgdHlwZTogJ1Byb2dyYW0nLAoJCSAgICBib2R5OiBjb250ZW50cywKCQkgICAgc3RyaXA6IHt9LAoJCSAgICBsb2M6IGxvY0luZm8KCQkgIH07CgoJCSAgcmV0dXJuIHsKCQkgICAgdHlwZTogJ0Jsb2NrU3RhdGVtZW50JywKCQkgICAgcGF0aDogb3BlblJhd0Jsb2NrLnBhdGgsCgkJICAgIHBhcmFtczogb3BlblJhd0Jsb2NrLnBhcmFtcywKCQkgICAgaGFzaDogb3BlblJhd0Jsb2NrLmhhc2gsCgkJICAgIHByb2dyYW06IHByb2dyYW0sCgkJICAgIG9wZW5TdHJpcDoge30sCgkJICAgIGludmVyc2VTdHJpcDoge30sCgkJICAgIGNsb3NlU3RyaXA6IHt9LAoJCSAgICBsb2M6IGxvY0luZm8KCQkgIH07CgkJfQoKCQlmdW5jdGlvbiBwcmVwYXJlQmxvY2sob3BlbkJsb2NrLCBwcm9ncmFtLCBpbnZlcnNlQW5kUHJvZ3JhbSwgY2xvc2UsIGludmVydGVkLCBsb2NJbmZvKSB7CgkJICBpZiAoY2xvc2UgJiYgY2xvc2UucGF0aCkgewoJCSAgICB2YWxpZGF0ZUNsb3NlKG9wZW5CbG9jaywgY2xvc2UpOwoJCSAgfQoKCQkgIHZhciBkZWNvcmF0b3IgPSAvXCovLnRlc3Qob3BlbkJsb2NrLm9wZW4pOwoKCQkgIHByb2dyYW0uYmxvY2tQYXJhbXMgPSBvcGVuQmxvY2suYmxvY2tQYXJhbXM7CgoJCSAgdmFyIGludmVyc2UgPSB1bmRlZmluZWQsCgkJICAgICAgaW52ZXJzZVN0cmlwID0gdW5kZWZpbmVkOwoKCQkgIGlmIChpbnZlcnNlQW5kUHJvZ3JhbSkgewoJCSAgICBpZiAoZGVjb3JhdG9yKSB7CgkJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ1VuZXhwZWN0ZWQgaW52ZXJzZSBibG9jayBvbiBkZWNvcmF0b3InLCBpbnZlcnNlQW5kUHJvZ3JhbSk7CgkJICAgIH0KCgkJICAgIGlmIChpbnZlcnNlQW5kUHJvZ3JhbS5jaGFpbikgewoJCSAgICAgIGludmVyc2VBbmRQcm9ncmFtLnByb2dyYW0uYm9keVswXS5jbG9zZVN0cmlwID0gY2xvc2Uuc3RyaXA7CgkJICAgIH0KCgkJICAgIGludmVyc2VTdHJpcCA9IGludmVyc2VBbmRQcm9ncmFtLnN0cmlwOwoJCSAgICBpbnZlcnNlID0gaW52ZXJzZUFuZFByb2dyYW0ucHJvZ3JhbTsKCQkgIH0KCgkJICBpZiAoaW52ZXJ0ZWQpIHsKCQkgICAgaW52ZXJ0ZWQgPSBpbnZlcnNlOwoJCSAgICBpbnZlcnNlID0gcHJvZ3JhbTsKCQkgICAgcHJvZ3JhbSA9IGludmVydGVkOwoJCSAgfQoKCQkgIHJldHVybiB7CgkJICAgIHR5cGU6IGRlY29yYXRvciA/ICdEZWNvcmF0b3JCbG9jaycgOiAnQmxvY2tTdGF0ZW1lbnQnLAoJCSAgICBwYXRoOiBvcGVuQmxvY2sucGF0aCwKCQkgICAgcGFyYW1zOiBvcGVuQmxvY2sucGFyYW1zLAoJCSAgICBoYXNoOiBvcGVuQmxvY2suaGFzaCwKCQkgICAgcHJvZ3JhbTogcHJvZ3JhbSwKCQkgICAgaW52ZXJzZTogaW52ZXJzZSwKCQkgICAgb3BlblN0cmlwOiBvcGVuQmxvY2suc3RyaXAsCgkJICAgIGludmVyc2VTdHJpcDogaW52ZXJzZVN0cmlwLAoJCSAgICBjbG9zZVN0cmlwOiBjbG9zZSAmJiBjbG9zZS5zdHJpcCwKCQkgICAgbG9jOiB0aGlzLmxvY0luZm8obG9jSW5mbykKCQkgIH07CgkJfQoKCQlmdW5jdGlvbiBwcmVwYXJlUHJvZ3JhbShzdGF0ZW1lbnRzLCBsb2MpIHsKCQkgIGlmICghbG9jICYmIHN0YXRlbWVudHMubGVuZ3RoKSB7CgkJICAgIHZhciBmaXJzdExvYyA9IHN0YXRlbWVudHNbMF0ubG9jLAoJCSAgICAgICAgbGFzdExvYyA9IHN0YXRlbWVudHNbc3RhdGVtZW50cy5sZW5ndGggLSAxXS5sb2M7CgoJCSAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqLwoJCSAgICBpZiAoZmlyc3RMb2MgJiYgbGFzdExvYykgewoJCSAgICAgIGxvYyA9IHsKCQkgICAgICAgIHNvdXJjZTogZmlyc3RMb2Muc291cmNlLAoJCSAgICAgICAgc3RhcnQ6IHsKCQkgICAgICAgICAgbGluZTogZmlyc3RMb2Muc3RhcnQubGluZSwKCQkgICAgICAgICAgY29sdW1uOiBmaXJzdExvYy5zdGFydC5jb2x1bW4KCQkgICAgICAgIH0sCgkJICAgICAgICBlbmQ6IHsKCQkgICAgICAgICAgbGluZTogbGFzdExvYy5lbmQubGluZSwKCQkgICAgICAgICAgY29sdW1uOiBsYXN0TG9jLmVuZC5jb2x1bW4KCQkgICAgICAgIH0KCQkgICAgICB9OwoJCSAgICB9CgkJICB9CgoJCSAgcmV0dXJuIHsKCQkgICAgdHlwZTogJ1Byb2dyYW0nLAoJCSAgICBib2R5OiBzdGF0ZW1lbnRzLAoJCSAgICBzdHJpcDoge30sCgkJICAgIGxvYzogbG9jCgkJICB9OwoJCX0KCgkJZnVuY3Rpb24gcHJlcGFyZVBhcnRpYWxCbG9jayhvcGVuLCBwcm9ncmFtLCBjbG9zZSwgbG9jSW5mbykgewoJCSAgdmFsaWRhdGVDbG9zZShvcGVuLCBjbG9zZSk7CgoJCSAgcmV0dXJuIHsKCQkgICAgdHlwZTogJ1BhcnRpYWxCbG9ja1N0YXRlbWVudCcsCgkJICAgIG5hbWU6IG9wZW4ucGF0aCwKCQkgICAgcGFyYW1zOiBvcGVuLnBhcmFtcywKCQkgICAgaGFzaDogb3Blbi5oYXNoLAoJCSAgICBwcm9ncmFtOiBwcm9ncmFtLAoJCSAgICBvcGVuU3RyaXA6IG9wZW4uc3RyaXAsCgkJICAgIGNsb3NlU3RyaXA6IGNsb3NlICYmIGNsb3NlLnN0cmlwLAoJCSAgICBsb2M6IHRoaXMubG9jSW5mbyhsb2NJbmZvKQoJCSAgfTsKCQl9CgoJLyoqKi8gfSwKCS8qIDMwICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJLyogZXNsaW50LWRpc2FibGUgbmV3LWNhcCAqLwoKCQkndXNlIHN0cmljdCc7CgoJCXZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKVsnZGVmYXVsdCddOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoJCWV4cG9ydHMuQ29tcGlsZXIgPSBDb21waWxlcjsKCQlleHBvcnRzLnByZWNvbXBpbGUgPSBwcmVjb21waWxlOwoJCWV4cG9ydHMuY29tcGlsZSA9IGNvbXBpbGU7CgoJCXZhciBfZXhjZXB0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKCgkJdmFyIF9leGNlcHRpb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhjZXB0aW9uKTsKCgkJdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CgoJCXZhciBfYXN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7CgoJCXZhciBfYXN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2FzdCk7CgoJCXZhciBzbGljZSA9IFtdLnNsaWNlOwoKCQlmdW5jdGlvbiBDb21waWxlcigpIHt9CgoJCS8vIHRoZSBmb3VuZEhlbHBlciByZWdpc3RlciB3aWxsIGRpc2FtYmlndWF0ZSBoZWxwZXIgbG9va3VwIGZyb20gZmluZGluZyBhCgkJLy8gZnVuY3Rpb24gaW4gYSBjb250ZXh0LiBUaGlzIGlzIG5lY2Vzc2FyeSBmb3IgbXVzdGFjaGUgY29tcGF0aWJpbGl0eSwgd2hpY2gKCQkvLyByZXF1aXJlcyB0aGF0IGNvbnRleHQgZnVuY3Rpb25zIGluIGJsb2NrcyBhcmUgZXZhbHVhdGVkIGJ5IGJsb2NrSGVscGVyTWlzc2luZywKCQkvLyBhbmQgdGhlbiBwcm9jZWVkIGFzIGlmIHRoZSByZXN1bHRpbmcgdmFsdWUgd2FzIHByb3ZpZGVkIHRvIGJsb2NrSGVscGVyTWlzc2luZy4KCgkJQ29tcGlsZXIucHJvdG90eXBlID0gewoJCSAgY29tcGlsZXI6IENvbXBpbGVyLAoKCQkgIGVxdWFsczogZnVuY3Rpb24gZXF1YWxzKG90aGVyKSB7CgkJICAgIHZhciBsZW4gPSB0aGlzLm9wY29kZXMubGVuZ3RoOwoJCSAgICBpZiAob3RoZXIub3Bjb2Rlcy5sZW5ndGggIT09IGxlbikgewoJCSAgICAgIHJldHVybiBmYWxzZTsKCQkgICAgfQoKCQkgICAgZm9yICh2YXIgaSA9IDA7IA==", "base64"));
  res.write(new Buffer("aSA8IGxlbjsgaSsrKSB7CgkJICAgICAgdmFyIG9wY29kZSA9IHRoaXMub3Bjb2Rlc1tpXSwKCQkgICAgICAgICAgb3RoZXJPcGNvZGUgPSBvdGhlci5vcGNvZGVzW2ldOwoJCSAgICAgIGlmIChvcGNvZGUub3Bjb2RlICE9PSBvdGhlck9wY29kZS5vcGNvZGUgfHwgIWFyZ0VxdWFscyhvcGNvZGUuYXJncywgb3RoZXJPcGNvZGUuYXJncykpIHsKCQkgICAgICAgIHJldHVybiBmYWxzZTsKCQkgICAgICB9CgkJICAgIH0KCgkJICAgIC8vIFdlIGtub3cgdGhhdCBsZW5ndGggaXMgdGhlIHNhbWUgYmV0d2VlbiB0aGUgdHdvIGFycmF5cyBiZWNhdXNlIHRoZXkgYXJlIGRpcmVjdGx5IHRpZWQKCQkgICAgLy8gdG8gdGhlIG9wY29kZSBiZWhhdmlvciBhYm92ZS4KCQkgICAgbGVuID0gdGhpcy5jaGlsZHJlbi5sZW5ndGg7CgkJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKCQkgICAgICBpZiAoIXRoaXMuY2hpbGRyZW5baV0uZXF1YWxzKG90aGVyLmNoaWxkcmVuW2ldKSkgewoJCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJCSAgICAgIH0KCQkgICAgfQoKCQkgICAgcmV0dXJuIHRydWU7CgkJICB9LAoKCQkgIGd1aWQ6IDAsCgoJCSAgY29tcGlsZTogZnVuY3Rpb24gY29tcGlsZShwcm9ncmFtLCBvcHRpb25zKSB7CgkJICAgIHRoaXMuc291cmNlTm9kZSA9IFtdOwoJCSAgICB0aGlzLm9wY29kZXMgPSBbXTsKCQkgICAgdGhpcy5jaGlsZHJlbiA9IFtdOwoJCSAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zOwoJCSAgICB0aGlzLnN0cmluZ1BhcmFtcyA9IG9wdGlvbnMuc3RyaW5nUGFyYW1zOwoJCSAgICB0aGlzLnRyYWNrSWRzID0gb3B0aW9ucy50cmFja0lkczsKCgkJICAgIG9wdGlvbnMuYmxvY2tQYXJhbXMgPSBvcHRpb25zLmJsb2NrUGFyYW1zIHx8IFtdOwoKCQkgICAgLy8gVGhlc2UgY2hhbmdlcyB3aWxsIHByb3BhZ2F0ZSB0byB0aGUgb3RoZXIgY29tcGlsZXIgY29tcG9uZW50cwoJCSAgICB2YXIga25vd25IZWxwZXJzID0gb3B0aW9ucy5rbm93bkhlbHBlcnM7CgkJICAgIG9wdGlvbnMua25vd25IZWxwZXJzID0gewoJCSAgICAgICdoZWxwZXJNaXNzaW5nJzogdHJ1ZSwKCQkgICAgICAnYmxvY2tIZWxwZXJNaXNzaW5nJzogdHJ1ZSwKCQkgICAgICAnZWFjaCc6IHRydWUsCgkJICAgICAgJ2lmJzogdHJ1ZSwKCQkgICAgICAndW5sZXNzJzogdHJ1ZSwKCQkgICAgICAnd2l0aCc6IHRydWUsCgkJICAgICAgJ2xvZyc6IHRydWUsCgkJICAgICAgJ2xvb2t1cCc6IHRydWUKCQkgICAgfTsKCQkgICAgaWYgKGtub3duSGVscGVycykgewoJCSAgICAgIGZvciAodmFyIF9uYW1lIGluIGtub3duSGVscGVycykgewoJCSAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi8KCQkgICAgICAgIGlmIChfbmFtZSBpbiBrbm93bkhlbHBlcnMpIHsKCQkgICAgICAgICAgb3B0aW9ucy5rbm93bkhlbHBlcnNbX25hbWVdID0ga25vd25IZWxwZXJzW19uYW1lXTsKCQkgICAgICAgIH0KCQkgICAgICB9CgkJICAgIH0KCgkJICAgIHJldHVybiB0aGlzLmFjY2VwdChwcm9ncmFtKTsKCQkgIH0sCgoJCSAgY29tcGlsZVByb2dyYW06IGZ1bmN0aW9uIGNvbXBpbGVQcm9ncmFtKHByb2dyYW0pIHsKCQkgICAgdmFyIGNoaWxkQ29tcGlsZXIgPSBuZXcgdGhpcy5jb21waWxlcigpLAoJCSAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuZXctY2FwCgkJICAgIHJlc3VsdCA9IGNoaWxkQ29tcGlsZXIuY29tcGlsZShwcm9ncmFtLCB0aGlzLm9wdGlvbnMpLAoJCSAgICAgICAgZ3VpZCA9IHRoaXMuZ3VpZCsrOwoKCQkgICAgdGhpcy51c2VQYXJ0aWFsID0gdGhpcy51c2VQYXJ0aWFsIHx8IHJlc3VsdC51c2VQYXJ0aWFsOwoKCQkgICAgdGhpcy5jaGlsZHJlbltndWlkXSA9IHJlc3VsdDsKCQkgICAgdGhpcy51c2VEZXB0aHMgPSB0aGlzLnVzZURlcHRocyB8fCByZXN1bHQudXNlRGVwdGhzOwoKCQkgICAgcmV0dXJuIGd1aWQ7CgkJICB9LAoKCQkgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KG5vZGUpIHsKCQkgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IFNhbml0eSBjb2RlICovCgkJICAgIGlmICghdGhpc1tub2RlLnR5cGVdKSB7CgkJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ1Vua25vd24gdHlwZTogJyArIG5vZGUudHlwZSwgbm9kZSk7CgkJICAgIH0KCgkJICAgIHRoaXMuc291cmNlTm9kZS51bnNoaWZ0KG5vZGUpOwoJCSAgICB2YXIgcmV0ID0gdGhpc1tub2RlLnR5cGVdKG5vZGUpOwoJCSAgICB0aGlzLnNvdXJjZU5vZGUuc2hpZnQoKTsKCQkgICAgcmV0dXJuIHJldDsKCQkgIH0sCgoJCSAgUHJvZ3JhbTogZnVuY3Rpb24gUHJvZ3JhbShwcm9ncmFtKSB7CgkJICAgIHRoaXMub3B0aW9ucy5ibG9ja1BhcmFtcy51bnNoaWZ0KHByb2dyYW0uYmxvY2tQYXJhbXMpOwoKCQkgICAgdmFyIGJvZHkgPSBwcm9ncmFtLmJvZHksCgkJICAgICAgICBib2R5TGVuZ3RoID0gYm9keS5sZW5ndGg7CgkJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYm9keUxlbmd0aDsgaSsrKSB7CgkJICAgICAgdGhpcy5hY2NlcHQoYm9keVtpXSk7CgkJICAgIH0KCgkJICAgIHRoaXMub3B0aW9ucy5ibG9ja1BhcmFtcy5zaGlmdCgpOwoKCQkgICAgdGhpcy5pc1NpbXBsZSA9IGJvZHlMZW5ndGggPT09IDE7CgkJICAgIHRoaXMuYmxvY2tQYXJhbXMgPSBwcm9ncmFtLmJsb2NrUGFyYW1zID8gcHJvZ3JhbS5ibG9ja1BhcmFtcy5sZW5ndGggOiAwOwoKCQkgICAgcmV0dXJuIHRoaXM7CgkJICB9LAoKCQkgIEJsb2NrU3RhdGVtZW50OiBmdW5jdGlvbiBCbG9ja1N0YXRlbWVudChibG9jaykgewoJCSAgICB0cmFuc2Zvcm1MaXRlcmFsVG9QYXRoKGJsb2NrKTsKCgkJICAgIHZhciBwcm9ncmFtID0gYmxvY2sucHJvZ3JhbSwKCQkgICAgICAgIGludmVyc2UgPSBibG9jay5pbnZlcnNlOwoKCQkgICAgcHJvZ3JhbSA9IHByb2dyYW0gJiYgdGhpcy5jb21waWxlUHJvZ3JhbShwcm9ncmFtKTsKCQkgICAgaW52ZXJzZSA9IGludmVyc2UgJiYgdGhpcy5jb21waWxlUHJvZ3JhbShpbnZlcnNlKTsKCgkJICAgIHZhciB0eXBlID0gdGhpcy5jbGFzc2lmeVNleHByKGJsb2NrKTsKCgkJICAgIGlmICh0eXBlID09PSAnaGVscGVyJykgewoJCSAgICAgIHRoaXMuaGVscGVyU2V4cHIoYmxvY2ssIHByb2dyYW0sIGludmVyc2UpOwoJCSAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdzaW1wbGUnKSB7CgkJICAgICAgdGhpcy5zaW1wbGVTZXhwcihibG9jayk7CgoJCSAgICAgIC8vIG5vdyB0aGF0IHRoZSBzaW1wbGUgbXVzdGFjaGUgaXMgcmVzb2x2ZWQsIHdlIG5lZWQgdG8KCQkgICAgICAvLyBldmFsdWF0ZSBpdCBieSBleGVjdXRpbmcgYGJsb2NrSGVscGVyTWlzc2luZ2AKCQkgICAgICB0aGlzLm9wY29kZSgncHVzaFByb2dyYW0nLCBwcm9ncmFtKTsKCQkgICAgICB0aGlzLm9wY29kZSgncHVzaFByb2dyYW0nLCBpbnZlcnNlKTsKCQkgICAgICB0aGlzLm9wY29kZSgnZW1wdHlIYXNoJyk7CgkJICAgICAgdGhpcy5vcGNvZGUoJ2Jsb2NrVmFsdWUnLCBibG9jay5wYXRoLm9yaWdpbmFsKTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICB0aGlzLmFtYmlndW91c1NleHByKGJsb2NrLCBwcm9ncmFtLCBpbnZlcnNlKTsKCgkJICAgICAgLy8gbm93IHRoYXQgdGhlIHNpbXBsZSBtdXN0YWNoZSBpcyByZXNvbHZlZCwgd2UgbmVlZCB0bwoJCSAgICAgIC8vIGV2YWx1YXRlIGl0IGJ5IGV4ZWN1dGluZyBgYmxvY2tIZWxwZXJNaXNzaW5nYAoJCSAgICAgIHRoaXMub3Bjb2RlKCdwdXNoUHJvZ3JhbScsIHByb2dyYW0pOwoJCSAgICAgIHRoaXMub3Bjb2RlKCdwdXNoUHJvZ3JhbScsIGludmVyc2UpOwoJCSAgICAgIHRoaXMub3Bjb2RlKCdlbXB0eUhhc2gnKTsKCQkgICAgICB0aGlzLm9wY29kZSgnYW1iaWd1b3VzQmxvY2tWYWx1ZScpOwoJCSAgICB9CgoJCSAgICB0aGlzLm9wY29kZSgnYXBwZW5kJyk7CgkJICB9LAoKCQkgIERlY29yYXRvckJsb2NrOiBmdW5jdGlvbiBEZWNvcmF0b3JCbG9jayhkZWNvcmF0b3IpIHsKCQkgICAgdmFyIHByb2dyYW0gPSBkZWNvcmF0b3IucHJvZ3JhbSAmJiB0aGlzLmNvbXBpbGVQcm9ncmFtKGRlY29yYXRvci5wcm9ncmFtKTsKCQkgICAgdmFyIHBhcmFtcyA9IHRoaXMuc2V0dXBGdWxsTXVzdGFjaGVQYXJhbXMoZGVjb3JhdG9yLCBwcm9ncmFtLCB1bmRlZmluZWQpLAoJCSAgICAgICAgcGF0aCA9IGRlY29yYXRvci5wYXRoOwoKCQkgICAgdGhpcy51c2VEZWNvcmF0b3JzID0gdHJ1ZTsKCQkgICAgdGhpcy5vcGNvZGUoJ3JlZ2lzdGVyRGVjb3JhdG9yJywgcGFyYW1zLmxlbmd0aCwgcGF0aC5vcmlnaW5hbCk7CgkJICB9LAoKCQkgIFBhcnRpYWxTdGF0ZW1lbnQ6IGZ1bmN0aW9uIFBhcnRpYWxTdGF0ZW1lbnQocGFydGlhbCkgewoJCSAgICB0aGlzLnVzZVBhcnRpYWwgPSB0cnVlOwoKCQkgICAgdmFyIHByb2dyYW0gPSBwYXJ0aWFsLnByb2dyYW07CgkJICAgIGlmIChwcm9ncmFtKSB7CgkJICAgICAgcHJvZ3JhbSA9IHRoaXMuY29tcGlsZVByb2dyYW0ocGFydGlhbC5wcm9ncmFtKTsKCQkgICAgfQoKCQkgICAgdmFyIHBhcmFtcyA9IHBhcnRpYWwucGFyYW1zOwoJCSAgICBpZiAocGFyYW1zLmxlbmd0aCA+IDEpIHsKCQkgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnVW5zdXBwb3J0ZWQgbnVtYmVyIG9mIHBhcnRpYWwgYXJndW1lbnRzOiAnICsgcGFyYW1zLmxlbmd0aCwgcGFydGlhbCk7CgkJICAgIH0gZWxzZSBpZiAoIXBhcmFtcy5sZW5ndGgpIHsKCQkgICAgICBpZiAodGhpcy5vcHRpb25zLmV4cGxpY2l0UGFydGlhbENvbnRleHQpIHsKCQkgICAgICAgIHRoaXMub3Bjb2RlKCdwdXNoTGl0ZXJhbCcsICd1bmRlZmluZWQnKTsKCQkgICAgICB9IGVsc2UgewoJCSAgICAgICAgcGFyYW1zLnB1c2goeyB0eXBlOiAnUGF0aEV4cHJlc3Npb24nLCBwYXJ0czogW10sIGRlcHRoOiAwIH0pOwoJCSAgICAgIH0KCQkgICAgfQoKCQkgICAgdmFyIHBhcnRpYWxOYW1lID0gcGFydGlhbC5uYW1lLm9yaWdpbmFsLAoJCSAgICAgICAgaXNEeW5hbWljID0gcGFydGlhbC5uYW1lLnR5cGUgPT09ICdTdWJFeHByZXNzaW9uJzsKCQkgICAgaWYgKGlzRHluYW1pYykgewoJCSAgICAgIHRoaXMuYWNjZXB0KHBhcnRpYWwubmFtZSk7CgkJICAgIH0KCgkJICAgIHRoaXMuc2V0dXBGdWxsTXVzdGFjaGVQYXJhbXMocGFydGlhbCwgcHJvZ3JhbSwgdW5kZWZpbmVkLCB0cnVlKTsKCgkJICAgIHZhciBpbmRlbnQgPSBwYXJ0aWFsLmluZGVudCB8fCAnJzsKCQkgICAgaWYgKHRoaXMub3B0aW9ucy5wcmV2ZW50SW5kZW50ICYmIGluZGVudCkgewoJCSAgICAgIHRoaXMub3Bjb2RlKCdhcHBlbmRDb250ZW50JywgaW5kZW50KTsKCQkgICAgICBpbmRlbnQgPSAnJzsKCQkgICAgfQoKCQkgICAgdGhpcy5vcGNvZGUoJ2ludm9rZVBhcnRpYWwnLCBpc0R5bmFtaWMsIHBhcnRpYWxOYW1lLCBpbmRlbnQpOwoJCSAgICB0aGlzLm9wY29kZSgnYXBwZW5kJyk7CgkJICB9LAoJCSAgUGFydGlhbEJsb2NrU3RhdGVtZW50OiBmdW5jdGlvbiBQYXJ0aWFsQmxvY2tTdGF0ZW1lbnQocGFydGlhbEJsb2NrKSB7CgkJICAgIHRoaXMuUGFydGlhbFN0YXRlbWVudChwYXJ0aWFsQmxvY2spOwoJCSAgfSwKCgkJICBNdXN0YWNoZVN0YXRlbWVudDogZnVuY3Rpb24gTXVzdGFjaGVTdGF0ZW1lbnQobXVzdGFjaGUpIHsKCQkgICAgdGhpcy5TdWJFeHByZXNzaW9uKG11c3RhY2hlKTsKCgkJICAgIGlmIChtdXN0YWNoZS5lc2NhcGVkICYmICF0aGlzLm9wdGlvbnMubm9Fc2NhcGUpIHsKCQkgICAgICB0aGlzLm9wY29kZSgnYXBwZW5kRXNjYXBlZCcpOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHRoaXMub3Bjb2RlKCdhcHBlbmQnKTsKCQkgICAgfQoJCSAgfSwKCQkgIERlY29yYXRvcjogZnVuY3Rpb24gRGVjb3JhdG9yKGRlY29yYXRvcikgewoJCSAgICB0aGlzLkRlY29yYXRvckJsb2NrKGRlY29yYXRvcik7CgkJICB9LAoKCQkgIENvbnRlbnRTdGF0ZW1lbnQ6IGZ1bmN0aW9uIENvbnRlbnRTdGF0ZW1lbnQoY29udGVudCkgewoJCSAgICBpZiAoY29udGVudC52YWx1ZSkgewoJCSAgICAgIHRoaXMub3Bjb2RlKCdhcHBlbmRDb250ZW50JywgY29udGVudC52YWx1ZSk7CgkJICAgIH0KCQkgIH0sCgoJCSAgQ29tbWVudFN0YXRlbWVudDogZnVuY3Rpb24gQ29tbWVudFN0YXRlbWVudCgpIHt9LAoKCQkgIFN1YkV4cHJlc3Npb246IGZ1bmN0aW9uIFN1YkV4cHJlc3Npb24oc2V4cHIpIHsKCQkgICAgdHJhbnNmb3JtTGl0ZXJhbFRvUGF0aChzZXhwcik7CgkJICAgIHZhciB0eXBlID0gdGhpcy5jbGFzc2lmeVNleHByKHNleHByKTsKCgkJICAgIGlmICh0eXBlID09PSAnc2ltcGxlJykgewoJCSAgICAgIHRoaXMuc2ltcGxlU2V4cHIoc2V4cHIpOwoJCSAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdoZWxwZXInKSB7CgkJICAgICAgdGhpcy5oZWxwZXJTZXhwcihzZXhwcik7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgdGhpcy5hbWJpZ3VvdXNTZXhwcihzZXhwcik7CgkJICAgIH0KCQkgIH0sCgkJICBhbWJpZ3VvdXNTZXhwcjogZnVuY3Rpb24gYW1iaWd1b3VzU2V4cHIoc2V4cHIsIHByb2dyYW0sIGludmVyc2UpIHsKCQkgICAgdmFyIHBhdGggPSBzZXhwci5wYXRoLAoJCSAgICAgICAgbmFtZSA9IHBhdGgucGFydHNbMF0sCgkJICAgICAgICBpc0Jsb2NrID0gcHJvZ3JhbSAhPSBudWxsIHx8IGludmVyc2UgIT0gbnVsbDsKCgkJICAgIHRoaXMub3Bjb2RlKCdnZXRDb250ZXh0JywgcGF0aC5kZXB0aCk7CgoJCSAgICB0aGlzLm9wY29kZSgncHVzaFByb2dyYW0nLCBwcm9ncmFtKTsKCQkgICAgdGhpcy5vcGNvZGUoJ3B1c2hQcm9ncmFtJywgaW52ZXJzZSk7CgoJCSAgICBwYXRoLnN0cmljdCA9IHRydWU7CgkJICAgIHRoaXMuYWNjZXB0KHBhdGgpOwoKCQkgICAgdGhpcy5vcGNvZGUoJ2ludm9rZUFtYmlndW91cycsIG5hbWUsIGlzQmxvY2spOwoJCSAgfSwKCgkJICBzaW1wbGVTZXhwcjogZnVuY3Rpb24gc2ltcGxlU2V4cHIoc2V4cHIpIHsKCQkgICAgdmFyIHBhdGggPSBzZXhwci5wYXRoOwoJCSAgICBwYXRoLnN0cmljdCA9IHRydWU7CgkJICAgIHRoaXMuYWNjZXB0KHBhdGgpOwoJCSAgICB0aGlzLm9wY29kZSgncmVzb2x2ZVBvc3NpYmxlTGFtYmRhJyk7CgkJICB9LAoKCQkgIGhlbHBlclNleHByOiBmdW5jdGlvbiBoZWxwZXJTZXhwcihzZXhwciwgcHJvZ3JhbSwgaW52ZXJzZSkgewoJCSAgICB2YXIgcGFyYW1zID0gdGhpcy5zZXR1cEZ1bGxNdXN0YWNoZVBhcmFtcyhzZXhwciwgcHJvZ3JhbSwgaW52ZXJzZSksCgkJICAgICAgICBwYXRoID0gc2V4cHIucGF0aCwKCQkgICAgICAgIG5hbWUgPSBwYXRoLnBhcnRzWzBdOwoKCQkgICAgaWYgKHRoaXMub3B0aW9ucy5rbm93bkhlbHBlcnNbbmFtZV0pIHsKCQkgICAgICB0aGlzLm9wY29kZSgnaW52b2tlS25vd25IZWxwZXInLCBwYXJhbXMubGVuZ3RoLCBuYW1lKTsKCQkgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMua25vd25IZWxwZXJzT25seSkgewoJCSAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdZb3Ugc3BlY2lmaWVkIGtub3duSGVscGVyc09ubHksIGJ1dCB1c2VkIHRoZSB1bmtub3duIGhlbHBlciAnICsgbmFtZSwgc2V4cHIpOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHBhdGguc3RyaWN0ID0gdHJ1ZTsKCQkgICAgICBwYXRoLmZhbHN5ID0gdHJ1ZTsKCgkJICAgICAgdGhpcy5hY2NlcHQocGF0aCk7CgkJICAgICAgdGhpcy5vcGNvZGUoJ2ludm9rZUhlbHBlcicsIHBhcmFtcy5sZW5ndGgsIHBhdGgub3JpZ2luYWwsIF9hc3QyWydkZWZhdWx0J10uaGVscGVycy5zaW1wbGVJZChwYXRoKSk7CgkJICAgIH0KCQkgIH0sCgoJCSAgUGF0aEV4cHJlc3Npb246IGZ1bmN0aW9uIFBhdGhFeHByZXNzaW9uKHBhdGgpIHsKCQkgICAgdGhpcy5hZGREZXB0aChwYXRoLmRlcHRoKTsKCQkgICAgdGhpcy5vcGNvZGUoJ2dldENvbnRleHQnLCBwYXRoLmRlcHRoKTsKCgkJICAgIHZhciBuYW1lID0gcGF0aC5wYXJ0c1swXSwKCQkgICAgICAgIHNjb3BlZCA9IF9hc3QyWydkZWZhdWx0J10uaGVscGVycy5zY29wZWRJZChwYXRoKSwKCQkgICAgICAgIGJsb2NrUGFyYW1JZCA9ICFwYXRoLmRlcHRoICYmICFzY29wZWQgJiYgdGhpcy5ibG9ja1BhcmFtSW5kZXgobmFtZSk7CgoJCSAgICBpZiAoYmxvY2tQYXJhbUlkKSB7CgkJICAgICAgdGhpcy5vcGNvZGUoJ2xvb2t1cEJsb2NrUGFyYW0nLCBibG9ja1BhcmFtSWQsIHBhdGgucGFydHMpOwoJCSAgICB9IGVsc2UgaWYgKCFuYW1lKSB7CgkJICAgICAgLy8gQ29udGV4dCByZWZlcmVuY2UsIGkuZS4gYHt7Zm9vIC59fWAgb3IgYHt7Zm9vIC4ufX1gCgkJICAgICAgdGhpcy5vcGNvZGUoJ3B1c2hDb250ZXh0Jyk7CgkJICAgIH0gZWxzZSBpZiAocGF0aC5kYXRhKSB7CgkJICAgICAgdGhpcy5vcHRpb25zLmRhdGEgPSB0cnVlOwoJCSAgICAgIHRoaXMub3Bjb2RlKCdsb29rdXBEYXRhJywgcGF0aC5kZXB0aCwgcGF0aC5wYXJ0cywgcGF0aC5zdHJpY3QpOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHRoaXMub3Bjb2RlKCdsb29rdXBPbkNvbnRleHQnLCBwYXRoLnBhcnRzLCBwYXRoLmZhbHN5LCBwYXRoLnN0cmljdCwgc2NvcGVkKTsKCQkgICAgfQoJCSAgfSwKCgkJICBTdHJpbmdMaXRlcmFsOiBmdW5jdGlvbiBTdHJpbmdMaXRlcmFsKHN0cmluZykgewoJCSAgICB0aGlzLm9wY29kZSgncHVzaFN0cmluZycsIHN0cmluZy52YWx1ZSk7CgkJICB9LAoKCQkgIE51bWJlckxpdGVyYWw6IGZ1bmN0aW9uIE51bWJlckxpdGVyYWwobnVtYmVyKSB7CgkJICAgIHRoaXMub3Bjb2RlKCdwdXNoTGl0ZXJhbCcsIG51bWJlci52YWx1ZSk7CgkJICB9LAoKCQkgIEJvb2xlYW5MaXRlcmFsOiBmdW5jdGlvbiBCb29sZWFuTGl0ZXJhbChib29sKSB7CgkJICAgIHRoaXMub3Bjb2RlKCdwdXNoTGl0ZXJhbCcsIGJvb2wudmFsdWUpOwoJCSAgfSwKCgkJICBVbmRlZmluZWRMaXRlcmFsOiBmdW5jdGlvbiBVbmRlZmluZWRMaXRlcmFsKCkgewoJCSAgICB0aGlzLm9wY29kZSgncHVzaExpdGVyYWwnLCAndW5kZWZpbmVkJyk7CgkJICB9LAoKCQkgIE51bGxMaXRlcmFsOiBmdW5jdGlvbiBOdWxsTGl0ZXJhbCgpIHsKCQkgICAgdGhpcy5vcGNvZGUoJ3B1c2hMaXRlcmFsJywgJ251bGwnKTsKCQkgIH0sCgoJCSAgSGFzaDogZnVuY3Rpb24gSGFzaChoYXNoKSB7CgkJICAgIHZhciBwYWlycyA9IGhhc2gucGFpcnMsCgkJICAgICAgICBpID0gMCwKCQkgICAgICAgIGwgPSBwYWlycy5sZW5ndGg7CgoJCSAgICB0aGlzLm9wY29kZSgncHVzaEhhc2gnKTsKCgkJICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7CgkJICAgICAgdGhpcy5wdXNoUGFyYW0ocGFpcnNbaV0udmFsdWUpOwoJCSAgICB9CgkJICAgIHdoaWxlIChpLS0pIHsKCQkgICAgICB0aGlzLm9wY29kZSgnYXNzaWduVG9IYXNoJywgcGFpcnNbaV0ua2V5KTsKCQkgICAgfQoJCSAgICB0aGlzLm9wY29kZSgncG9wSGFzaCcpOwoJCSAgfSwKCgkJICAvLyBIRUxQRVJTCgkJICBvcGNvZGU6IGZ1bmN0aW9uIG9wY29kZShuYW1lKSB7CgkJICAgIHRoaXMub3Bjb2Rlcy5wdXNoKHsgb3Bjb2RlOiBuYW1lLCBhcmdzOiBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSksIGxvYzogdGhpcy5zb3VyY2VOb2RlWzBdLmxvYyB9KTsKCQkgIH0sCgoJCSAgYWRkRGVwdGg6IGZ1bmN0aW9uIGFkZERlcHRoKGRlcHRoKSB7CgkJICAgIGlmICghZGVwdGgpIHsKCQkgICAgICByZXR1cm47CgkJICAgIH0KCgkJICAgIHRoaXMudXNlRGVwdGhzID0gdHJ1ZTsKCQkgIH0sCgoJCSAgY2xhc3NpZnlTZXhwcjogZnVuY3Rpb24gY2xhc3NpZnlTZXhwcihzZXhwcikgewoJCSAgICB2YXIgaXNTaW1wbGUgPSBfYXN0MlsnZGVmYXVsdCddLmhlbHBlcnMuc2ltcGxlSWQoc2V4cHIucGF0aCk7CgoJCSAgICB2YXIgaXNCbG9ja1BhcmFtID0gaXNTaW1wbGUgJiYgISF0aGlzLmJsb2NrUGFyYW1JbmRleChzZXhwci5wYXRoLnBhcnRzWzBdKTsKCgkJICAgIC8vIGEgbXVzdGFjaGUgaXMgYW4gZWxpZ2libGUgaGVscGVyIGlmOgoJCSAgICAvLyAqIGl0cyBpZCBpcyBzaW1wbGUgKGEgc2luZ2xlIHBhcnQsIG5vdCBgdGhpc2Agb3IgYC4uYCkKCQkgICAgdmFyIGlzSGVscGVyID0gIWlzQmxvY2tQYXJhbSAmJiBfYXN0MlsnZGVmYXVsdCddLmhlbHBlcnMuaGVscGVyRXhwcmVzc2lvbihzZXhwcik7CgoJCSAgICAvLyBpZiBhIG11c3RhY2hlIGlzIGFuIGVsaWdpYmxlIGhlbHBlciBidXQgbm90IGEgZGVmaW5pdGUKCQkgICAgLy8gaGVscGVyLCBpdCBpcyBhbWJpZ3VvdXMsIGFuZCB3aWxsIGJlIHJlc29sdmVkIGluIGEgbGF0ZXIKCQkgICAgLy8gcGFzcyBvciBhdCBydW50aW1lLgoJCSAgICB2YXIgaXNFbGlnaWJsZSA9ICFpc0Jsb2NrUGFyYW0gJiYgKGlzSGVscGVyIHx8IGlzU2ltcGxlKTsKCgkJICAgIC8vIGlmIGFtYmlndW91cywgd2UgY2FuIHBvc3NpYmx5IHJlc29sdmUgdGhlIGFtYmlndWl0eSBub3cKCQkgICAgLy8gQW4gZWxpZ2libGUgaGVscGVyIGlzIG9uZSB0aGF0IGRvZXMgbm90IGhhdmUgYSBjb21wbGV4IHBhdGgsIGkuZS4gYHRoaXMuZm9vYCwgYC4uL2Zvb2AgZXRjLgoJCSAgICBpZiAoaXNFbGlnaWJsZSAmJiAhaXNIZWxwZXIpIHsKCQkgICAgICB2YXIgX25hbWUyID0gc2V4cHIucGF0aC5wYXJ0c1swXSwKCQkgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9uczsKCgkJICAgICAgaWYgKG9wdGlvbnMua25vd25IZWxwZXJzW19uYW1lMl0pIHsKCQkgICAgICAgIGlzSGVscGVyID0gdHJ1ZTsKCQkgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMua25vd25IZWxwZXJzT25seSkgewoJCSAgICAgICAgaXNFbGlnaWJsZSA9IGZhbHNlOwoJCSAgICAgIH0KCQkgICAgfQoKCQkgICAgaWYgKGlzSGVscGVyKSB7CgkJICAgICAgcmV0dXJuICdoZWxwZXInOwoJCSAgICB9IGVsc2UgaWYgKGlzRWxpZ2libGUpIHsKCQkgICAgICByZXR1cm4gJ2FtYmlndW91cyc7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgcmV0dXJuICdzaW1wbGUnOwoJCSAgICB9CgkJICB9LAoKCQkgIHB1c2hQYXJhbXM6IGZ1bmN0aW9uIHB1c2hQYXJhbXMocGFyYW1zKSB7CgkJICAgIGZvciAodmFyIGkgPSAwLCBsID0gcGFyYW1zLmxlbmd0aDsgaSA8IGw7IGkrKykgewoJCSAgICAgIHRoaXMucHVzaFBhcmFtKHBhcmFtc1tpXSk7CgkJICAgIH0KCQkgIH0sCgoJCSAgcHVzaFBhcmFtOiBmdW5jdGlvbiBwdXNoUGFyYW0odmFsKSB7CgkJICAgIHZhciB2YWx1ZSA9IHZhbC52YWx1ZSAhPSBudWxsID8gdmFsLnZhbHVlIDogdmFsLm9yaWdpbmFsIHx8ICcnOwoKCQkgICAgaWYgKHRoaXMuc3RyaW5nUGFyYW1zKSB7CgkJICAgICAgaWYgKHZhbHVlLnJlcGxhY2UpIHsKCQkgICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvXihcLj9cLlwvKSovZywgJycpLnJlcGxhY2UoL1wvL2csICcuJyk7CgkJICAgICAgfQoKCQkgICAgICBpZiAodmFsLmRlcHRoKSB7CgkJICAgICAgICB0aGlzLmFkZERlcHRoKHZhbC5kZXB0aCk7CgkJICAgICAgfQoJCSAgICAgIHRoaXMub3Bjb2RlKCdnZXRDb250ZXh0JywgdmFsLmRlcHRoIHx8IDApOwoJCSAgICAgIHRoaXMub3Bjb2RlKCdwdXNoU3RyaW5nUGFyYW0nLCB2YWx1ZSwgdmFsLnR5cGUpOwoKCQkgICAgICBpZiAodmFsLnR5cGUgPT09ICdTdWJFeHByZXNzaW9uJykgewoJCSAgICAgICAgLy8gU3ViRXhwcmVzc2lvbnMgZ2V0IGV2YWx1YXRlZCBhbmQgcGFzc2VkIGluCgkJICAgICAgICAvLyBpbiBzdHJpbmcgcGFyYW1zIG1vZGUuCgkJICAgICAgICB0aGlzLmFjY2VwdCh2YWwpOwoJCSAgICAgIH0KCQkgICAgfSBlbHNlIHsKCQkgICAgICBpZiAodGhpcy50cmFja0lkcykgewoJCSAgICAgICAgdmFyIGJsb2NrUGFyYW1JbmRleCA9IHVuZGVmaW5lZDsKCQkgICAgICAgIGlmICh2YWwucGFydHMgJiYgIV9hc3QyWydkZWZhdWx0J10uaGVscGVycy5zY29wZWRJZCh2YWwpICYmICF2YWwuZGVwdGgpIHsKCQkgICAgICAgICAgYmxvY2tQYXJhbUluZGV4ID0gdGhpcy5ibG9ja1BhcmFtSW5kZXgodmFsLnBhcnRzWzBdKTsKCQkgICAgICAgIH0KCQkgICAgICAgIGlmIChibG9ja1BhcmFtSW5kZXgpIHsKCQkgICAgICAgICAgdmFyIGJsb2NrUGFyYW1DaGlsZCA9IHZhbC5wYXJ0cy5zbGljZSgxKS5qb2luKCcuJyk7CgkJICAgICAgICAgIHRoaXMub3Bjb2RlKCdwdXNoSWQnLCAnQmxvY2tQYXJhbScsIGJsb2NrUGFyYW1JbmRleCwgYmxvY2tQYXJhbUNoaWxkKTsKCQkgICAgICAgIH0gZWxzZSB7CgkJICAgICAgICAgIHZhbHVlID0gdmFsLm9yaWdpbmFsIHx8IHZhbHVlOwoJCSAgICAgICAgICBpZiAodmFsdWUucmVwbGFjZSkgewoJCSAgICAgICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvXnRoaXMoPzpcLnwkKS8sICcnKS5yZXBsYWNlKC9eXC5cLy8sICcnKS5yZXBsYWNlKC9eXC4kLywgJycpOwoJCSAgICAgICAgICB9CgoJCSAgICAgICAgICB0aGlzLm9wY29kZSgncHVzaElkJywgdmFsLnR5cGUsIHZhbHVlKTsKCQkgICAgICAgIH0KCQkgICAgICB9CgkJICAgICAgdGhpcy5hY2NlcHQodmFsKTsKCQkgICAgfQoJCSAgfSwKCgkJICBzZXR1cEZ1bGxNdXN0YWNoZVBhcmFtczogZnVuY3Rpb24gc2V0dXBGdWxsTXVzdGFjaGVQYXJhbXMoc2V4cHIsIHByb2dyYW0sIGludmVyc2UsIG9taXRFbXB0eSkgewoJCSAgICB2YXIgcGFyYW1zID0gc2V4cHIucGFyYW1zOwoJCSAgICB0aGlzLnB1c2hQYXJhbXMocGFyYW1zKTsKCgkJICAgIHRoaXMub3Bjb2RlKCdwdXNoUHJvZ3JhbScsIHByb2dyYW0pOwoJCSAgICB0aGlzLm9wY29kZSgncHVzaFByb2dyYW0nLCBpbnZlcnNlKTsKCgkJICAgIGlmIChzZXhwci5oYXNoKSB7CgkJICAgICAgdGhpcy5hY2NlcHQoc2V4cHIuaGFzaCk7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgdGhpcy5vcGNvZGUoJ2VtcHR5SGFzaCcsIG9taXRFbXB0eSk7CgkJICAgIH0KCgkJICAgIHJldHVybiBwYXJhbXM7CgkJICB9LAoKCQkgIGJsb2NrUGFyYW1JbmRleDogZnVuY3Rpb24gYmxvY2tQYXJhbUluZGV4KG5hbWUpIHsKCQkgICAgZm9yICh2YXIgZGVwdGggPSAwLCBsZW4gPSB0aGlzLm9wdGlvbnMuYmxvY2tQYXJhbXMubGVuZ3RoOyBkZXB0aCA8IGxlbjsgZGVwdGgrKykgewoJCSAgICAgIHZhciBibG9ja1BhcmFtcyA9IHRoaXMub3B0aW9ucy5ibG9ja1BhcmFtc1tkZXB0aF0sCgkJICAgICAgICAgIHBhcmFtID0gYmxvY2tQYXJhbXMgJiYgX3V0aWxzLmluZGV4T2YoYmxvY2tQYXJhbXMsIG5hbWUpOwoJCSAgICAgIGlmIChibG9ja1BhcmFtcyAmJiBwYXJhbSA+PSAwKSB7CgkJICAgICAgICByZXR1cm4gW2RlcHRoLCBwYXJhbV07CgkJICAgICAgfQoJCSAgICB9CgkJICB9CgkJfTsKCgkJZnVuY3Rpb24gcHJlY29tcGlsZShpbnB1dCwgb3B0aW9ucywgZW52KSB7CgkJICBpZiAoaW5wdXQgPT0gbnVsbCB8fCB0eXBlb2YgaW5wdXQgIT09ICdzdHJpbmcnICYmIGlucHV0LnR5cGUgIT09ICdQcm9ncmFtJykgewoJCSAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnWW91IG11c3QgcGFzcyBhIHN0cmluZyBvciBIYW5kbGViYXJzIEFTVCB0byBIYW5kbGViYXJzLnByZWNvbXBpbGUuIFlvdSBwYXNzZWQgJyArIGlucHV0KTsKCQkgIH0KCgkJICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCQkgIGlmICghKCdkYXRhJyBpbiBvcHRpb25zKSkgewoJCSAgICBvcHRpb25zLmRhdGEgPSB0cnVlOwoJCSAgfQoJCSAgaWYgKG9wdGlvbnMuY29tcGF0KSB7CgkJICAgIG9wdGlvbnMudXNlRGVwdGhzID0gdHJ1ZTsKCQkgIH0KCgkJICB2YXIgYXN0ID0gZW52LnBhcnNlKGlucHV0LCBvcHRpb25zKSwKCQkgICAgICBlbnZpcm9ubWVudCA9IG5ldyBlbnYuQ29tcGlsZXIoKS5jb21waWxlKGFzdCwgb3B0aW9ucyk7CgkJICByZXR1cm4gbmV3IGVudi5KYXZhU2NyaXB0Q29tcGlsZXIoKS5jb21waWxlKGVudmlyb25tZW50LCBvcHRpb25zKTsKCQl9CgoJCWZ1bmN0aW9uIGNvbXBpbGUoaW5wdXQsIG9wdGlvbnMsIGVudikgewoJCSAgaWYgKG9wdGlvbnMgPT09IHVuZGVmaW5lZCkgb3B0aW9ucyA9IHt9OwoKCQkgIGlmIChpbnB1dCA9PSBudWxsIHx8IHR5cGVvZiBpbnB1dCAhPT0gJ3N0cmluZycgJiYgaW5wdXQudHlwZSAhPT0gJ1Byb2dyYW0nKSB7CgkJICAgIHRocm93IG5ldyBfZXhjZXB0aW9uMlsnZGVmYXVsdCddKCdZb3UgbXVzdCBwYXNzIGEgc3RyaW5nIG9yIEhhbmRsZWJhcnMgQVNUIHRvIEhhbmRsZWJhcnMuY29tcGlsZS4gWW91IHBhc3NlZCAnICsgaW5wdXQpOwoJCSAgfQoKCQkgIGlmICghKCdkYXRhJyBpbiBvcHRpb25zKSkgewoJCSAgICBvcHRpb25zLmRhdGEgPSB0cnVlOwoJCSAgfQoJCSAgaWYgKG9wdGlvbnMuY29tcGF0KSB7CgkJICAgIG9wdGlvbnMudXNlRGVwdGhzID0gdHJ1ZTsKCQkgIH0KCgkJICB2YXIgY29tcGlsZWQgPSB1bmRlZmluZWQ7CgoJCSAgZnVuY3Rpb24gY29tcGlsZUlucHV0KCkgewoJCSAgICB2YXIgYXN0ID0gZW52LnBhcnNlKGlucHV0LCBvcHRpb25zKSwKCQkgICAgICAgIGVudmlyb25tZW50ID0gbmV3IGVudi5Db21waWxlcigpLmNvbXBpbGUoYXN0LCBvcHRpb25zKSwKCQkgICAgICAgIHRlbXBsYXRlU3BlYyA9IG5ldyBlbnYuSmF2YVNjcmlwdENvbXBpbGVyKCkuY29tcGlsZShlbnZpcm9ubWVudCwgb3B0aW9ucywgdW5kZWZpbmVkLCB0cnVlKTsKCQkgICAgcmV0dXJuIGVudi50ZW1wbGF0ZSh0ZW1wbGF0ZVNwZWMpOwoJCSAgfQoKCQkgIC8vIFRlbXBsYXRlIGlzIG9ubHkgY29tcGlsZWQgb24gZmlyc3QgdXNlIGFuZCBjYWNoZWQgYWZ0ZXIgdGhhdCBwb2ludC4KCQkgIGZ1bmN0aW9uIHJldChjb250ZXh0LCBleGVjT3B0aW9ucykgewoJCSAgICBpZiAoIWNvbXBpbGVkKSB7CgkJICAgICAgY29tcGlsZWQgPSBjb21waWxlSW5wdXQoKTsKCQkgICAgfQoJCSAgICByZXR1cm4gY29tcGlsZWQuY2FsbCh0aGlzLCBjb250ZXh0LCBleGVjT3B0aW9ucyk7CgkJICB9CgkJICByZXQuX3NldHVwID0gZnVuY3Rpb24gKHNldHVwT3B0aW9ucykgewoJCSAgICBpZiAoIWNvbXBpbGVkKSB7CgkJICAgICAgY29tcGlsZWQgPSBjb21waWxlSW5wdXQoKTsKCQkgICAgfQoJCSAgICByZXR1cm4gY29tcGlsZWQuX3NldHVwKHNldHVwT3B0aW9ucyk7CgkJICB9OwoJCSAgcmV0Ll9jaGlsZCA9IGZ1bmN0aW9uIChpLCBkYXRhLCBibG9ja1BhcmFtcywgZGVwdGhzKSB7CgkJICAgIGlmICghY29tcGlsZWQpIHsKCQkgICAgICBjb21waWxlZCA9IGNvbXBpbGVJbnB1dCgpOwoJCSAgICB9CgkJICAgIHJldHVybiBjb21waWxlZC5fY2hpbGQoaSwgZGF0YSwgYmxvY2tQYXJhbXMsIGRlcHRocyk7CgkJICB9OwoJCSAgcmV0dXJuIHJldDsKCQl9CgoJCWZ1bmN0aW9uIGFyZ0VxdWFscyhhLCBiKSB7CgkJICBpZiAoYSA9PT0gYikgewoJCSAgICByZXR1cm4gdHJ1ZTsKCQkgIH0KCgkJICBpZiAoX3V0aWxzLmlzQXJyYXkoYSkgJiYgX3V0aWxzLmlzQXJyYXkoYikgJiYgYS5sZW5ndGggPT09IGIubGVuZ3RoKSB7CgkJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykgewoJCSAgICAgIGlmICghYXJnRXF1YWxzKGFbaV0sIGJbaV0pKSB7CgkJICAgICAgICByZXR1cm4gZmFsc2U7CgkJICAgICAgfQoJCSAgICB9CgkJICAgIHJldHVybiB0cnVlOwoJCSAgfQoJCX0KCgkJZnVuY3Rpb24gdHJhbnNmb3JtTGl0ZXJhbFRvUGF0aChzZXhwcikgewoJCSAgaWYgKCFzZXhwci5wYXRoLnBhcnRzKSB7CgkJICAgIHZhciBsaXRlcmFsID0gc2V4cHIucGF0aDsKCQkgICAgLy8gQ2FzdGluZyB0byBzdHJpbmcgaGVyZSB0byBtYWtlIGZhbHNlIGFuZCAwIGxpdGVyYWwgdmFsdWVzIHBsYXkgbmljZWx5IHdpdGggdGhlIHJlc3QKCQkgICAgLy8gb2YgdGhlIHN5c3RlbS4KCQkgICAgc2V4cHIucGF0aCA9IHsKCQkgICAgICB0eXBlOiAnUGF0aEV4cHJlc3Npb24nLAoJCSAgICAgIGRhdGE6IGZhbHNlLAoJCSAgICAgIGRlcHRoOiAwLAoJCSAgICAgIHBhcnRzOiBbbGl0ZXJhbC5vcmlnaW5hbCArICcnXSwKCQkgICAgICBvcmlnaW5hbDogbGl0ZXJhbC5vcmlnaW5hbCArICcnLAoJCSAgICAgIGxvYzogbGl0ZXJhbC5sb2MKCQkgICAgfTsKCQkgIH0KCQl9CgoJLyoqKi8gfSwKCS8qIDMxICovCgkvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkJJ3VzZSBzdHJpY3QnOwoKCQl2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSlbJ2RlZmF1bHQnXTsKCgkJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgkJdmFyIF9iYXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTsKCgkJdmFyIF9leGNlcHRpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwoKCQl2YXIgX2V4Y2VwdGlvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGNlcHRpb24pOwoKCQl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKCgkJdmFyIF9jb2RlR2VuID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMik7CgoJCXZhciBfY29kZUdlbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb2RlR2VuKTsKCgkJZnVuY3Rpb24gTGl0ZXJhbCh2YWx1ZSkgewoJCSAgdGhpcy52YWx1ZSA9IHZhbHVlOwoJCX0KCgkJZnVuY3Rpb24gSmF2YVNjcmlwdENvbXBpbGVyKCkge30KCgkJSmF2YVNjcmlwdENvbXBpbGVyLnByb3RvdHlwZSA9IHsKCQkgIC8vIFBVQkxJQyBBUEk6IFlvdSBjYW4gb3ZlcnJpZGUgdGhlc2UgbWV0aG9kcyBpbiBhIHN1YmNsYXNzIHRvIHByb3ZpZGUKCQkgIC8vIGFsdGVybmF0aXZlIGNvbXBpbGVkIGZvcm1zIGZvciBuYW1lIGxvb2t1cCBhbmQgYnVmZmVyaW5nIHNlbWFudGljcwoJCSAgbmFtZUxvb2t1cDogZnVuY3Rpb24gbmFtZUxvb2t1cChwYXJlbnQsIG5hbWUgLyogLCB0eXBlKi8pIHsKCQkgICAgaWYgKEphdmFTY3JpcHRDb21waWxlci5pc1ZhbGlkSmF2YVNjcmlwdFZhcmlhYmxlTmFtZShuYW1lKSkgewoJCSAgICAgIHJldHVybiBbcGFyZW50LCAnLicsIG5hbWVdOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHJldHVybiBbcGFyZW50LCAnWycsIEpTT04uc3RyaW5naWZ5KG5hbWUpLCAnXSddOwoJCSAgICB9CgkJICB9LAoJCSAgZGVwdGhlZExvb2t1cDogZnVuY3Rpb24gZGVwdGhlZExvb2t1cChuYW1lKSB7CgkJICAgIHJldHVybiBbdGhpcy5hbGlhc2FibGUoJ2NvbnRhaW5lci5sb29rdXAnKSwgJyhkZXB0aHMsICInLCBuYW1lLCAnIiknXTsKCQkgIH0sCgoJCSAgY29tcGlsZXJJbmZvOiBmdW5jdGlvbiBjb21waWxlckluZm8oKSB7CgkJICAgIHZhciByZXZpc2lvbiA9IF9iYXNlLkNPTVBJTEVSX1JFVklTSU9OLAoJCSAgICAgICAgdmVyc2lvbnMgPSBfYmFzZS5SRVZJU0lPTl9DSEFOR0VTW3JldmlzaW9uXTsKCQkgICAgcmV0dXJuIFtyZXZpc2lvbiwgdmVyc2lvbnNdOwoJCSAgfSwKCgkJICBhcHBlbmRUb0J1ZmZlcjogZnVuY3Rpb24gYXBwZW5kVG9CdWZmZXIoc291cmNlLCBsb2NhdGlvbiwgZXhwbGljaXQpIHsKCQkgICAgLy8gRm9yY2UgYSBzb3VyY2UgYXMgdGhpcyBzaW1wbGlmaWVzIHRoZSBtZXJnZSBsb2dpYy4KCQkgICAgaWYgKCFfdXRpbHMuaXNBcnJheShzb3VyY2UpKSB7CgkJICAgICAgc291cmNlID0gW3NvdXJjZV07CgkJICAgIH0KCQkgICAgc291cmNlID0gdGhpcy5zb3VyY2Uud3JhcChzb3VyY2UsIGxvY2F0aW9uKTsKCgkJICAgIGlmICh0aGlzLmVudmlyb25tZW50LmlzU2ltcGxlKSB7CgkJICAgICAgcmV0dXJuIFsncmV0dXJuICcsIHNvdXJjZSwgJzsnXTsKCQkgICAgfSBlbHNlIGlmIChleHBsaWNpdCkgewoJCSAgICAgIC8vIFRoaXMgaXMgYSBjYXNlIHdoZXJlIHRoZSBidWZmZXIgb3BlcmF0aW9uIG9jY3VycyBhcyBhIGNoaWxkIG9mIGFub3RoZXIKCQkgICAgICAvLyBjb25zdHJ1Y3QsIGdlbmVyYWxseSBicmFjZXMuIFdlIGhhdmUgdG8gZXhwbGljaXRseSBvdXRwdXQgdGhlc2UgYnVmZmVyCgkJICAgICAgLy8gb3BlcmF0aW9ucyB0byBlbnN1cmUgdGhhdCB0aGUgZW1pdHRlZCBjb2RlIGdvZXMgaW4gdGhlIGNvcnJlY3QgbG9jYXRpb24uCgkJICAgICAgcmV0dXJuIFsnYnVmZmVyICs9ICcsIHNvdXJjZSwgJzsnXTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICBzb3VyY2UuYXBwZW5kVG9CdWZmZXIgPSB0cnVlOwoJCSAgICAgIHJldHVybiBzb3VyY2U7CgkJICAgIH0KCQkgIH0sCgoJCSAgaW5pdGlhbGl6ZUJ1ZmZlcjogZnVuY3Rpb24gaW5pdGlhbGl6ZUJ1ZmZlcigpIHsKCQkgICAgcmV0dXJuIHRoaXMucXVvdGVkU3RyaW5nKCcnKTsKCQkgIH0sCgkJICAvLyBFTkQgUFVCTElDIEFQSQoKCQkgIGNvbXBpbGU6IGZ1bmN0aW9uIGNvbXBpbGUoZW52aXJvbm1lbnQsIG9wdGlvbnMsIGNvbnRleHQsIGFzT2JqZWN0KSB7CgkJICAgIHRoaXMuZW52aXJvbm1lbnQgPSBlbnZpcm9ubWVudDsKCQkgICAgdGhpcy5vcHRpb25zID0gb3B0aW9uczsKCQkgICAgdGhpcy5zdHJpbmdQYXJhbXMgPSB0aGlzLm9wdGlvbnMuc3RyaW5nUGFyYW1zOwoJCSAgICB0aGlzLnRyYWNrSWRzID0gdGhpcy5vcHRpb25zLnRyYWNrSWRzOwoJCSAgICB0aGlzLnByZWNvbXBpbGUgPSAhYXNPYmplY3Q7CgoJCSAgICB0aGlzLm5hbWUgPSB0aGlzLmVudmlyb25tZW50Lm5hbWU7CgkJICAgIHRoaXMuaXNDaGlsZCA9ICEhY29udGV4dDsKCQkgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dCB8fCB7CgkJICAgICAgZGVjb3JhdG9yczogW10sCgkJICAgICAgcHJvZ3JhbXM6IFtdLAoJCSAgICAgIGVudmlyb25tZW50czogW10KCQkgICAgfTsKCgkJICAgIHRoaXMucHJlYW1ibGUoKTsKCgkJICAgIHRoaXMuc3RhY2tTbG90ID0gMDsKCQkgICAgdGhpcy5zdGFja1ZhcnMgPSBbXTsKCQkgICAgdGhpcy5hbGlhc2VzID0ge307CgkJICAgIHRoaXMucmVnaXN0ZXJzID0geyBsaXN0OiBbXSB9OwoJCSAgICB0aGlzLmhhc2hlcyA9IFtdOwoJCSAgICB0aGlzLmNvbXBpbGVTdGFjayA9IFtdOwoJCSAgICB0aGlzLmlubGluZVN0YWNrID0gW107CgkJICAgIHRoaXMuYmxvY2tQYXJhbXMgPSBbXTsKCgkJICAgIHRoaXMuY29tcGlsZUNoaWxkcmVuKGVudmlyb25tZW50LCBvcHRpb25zKTsKCgkJICAgIHRoaXMudXNlRGVwdGhzID0gdGhpcy51c2VEZXB0aHMgfHwgZW52aXJvbm1lbnQudXNlRGVwdGhzIHx8IGVudmlyb25tZW50LnVzZURlY29yYXRvcnMgfHwgdGhpcy5vcHRpb25zLmNvbXBhdDsKCQkgICAgdGhpcy51c2VCbG9ja1BhcmFtcyA9IHRoaXMudXNlQmxvY2tQYXJhbXMgfHwgZW52aXJvbm1lbnQudXNlQmxvY2tQYXJhbXM7CgoJCSAgICB2YXIgb3Bjb2RlcyA9IGVudmlyb25tZW50Lm9wY29kZXMsCgkJICAgICAgICBvcGNvZGUgPSB1bmRlZmluZWQsCgkJICAgICAgICBmaXJzdExvYyA9IHVuZGVmaW5lZCwKCQkgICAgICAgIGkgPSB1bmRlZmluZWQsCgkJICAgICAgICBsID0gdW5kZWZpbmVkOwoKCQkgICAgZm9yIChpID0gMCwgbCA9IG9wY29kZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkJICAgICAgb3Bjb2RlID0gb3Bjb2Rlc1tpXTsKCgkJICAgICAgdGhpcy5zb3VyY2UuY3VycmVudExvY2F0aW9uID0gb3Bjb2RlLmxvYzsKCQkgICAgICBmaXJzdExvYyA9IGZpcnN0TG9jIHx8IG9wY29kZS5sb2M7CgkJICAgICAgdGhpc1tvcGNvZGUub3Bjb2RlXS5hcHBseSh0aGlzLCBvcGNvZGUuYXJncyk7CgkJICAgIH0KCgkJICAgIC8vIEZsdXNoIGFueSB0cmFpbGluZyBjb250ZW50IHRoYXQgbWlnaHQgYmUgcGVuZGluZy4KCQkgICAgdGhpcy5zb3VyY2UuY3VycmVudExvY2F0aW9uID0gZmlyc3RMb2M7CgkJICAgIHRoaXMucHVzaFNvdXJjZSgnJyk7CgoJCSAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoJCSAgICBpZiAodGhpcy5zdGFja1Nsb3QgfHwgdGhpcy5pbmxpbmVTdGFjay5sZW5ndGggfHwgdGhpcy5jb21waWxlU3RhY2subGVuZ3RoKSB7CgkJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ0NvbXBpbGUgY29tcGxldGVkIHdpdGggY29udGVudCBsZWZ0IG9uIHN0YWNrJyk7CgkJICAgIH0KCgkJICAgIGlmICghdGhpcy5kZWNvcmF0b3JzLmlzRW1wdHkoKSkgewoJCSAgICAgIHRoaXMudXNlRGVjb3JhdG9ycyA9IHRydWU7CgoJCSAgICAgIHRoaXMuZGVjb3JhdG9ycy5wcmVwZW5kKCd2YXIgZGVjb3JhdG9ycyA9IGNvbnRhaW5lci5kZWNvcmF0b3JzO1xuJyk7CgkJICAgICAgdGhpcy5kZWNvcmF0b3JzLnB1c2goJ3JldHVybiBmbjsnKTsKCgkJICAgICAgaWYgKGFzT2JqZWN0KSB7CgkJICAgICAgICB0aGlzLmRlY29yYXRvcnMgPSBGdW5jdGlvbi5hcHBseSh0aGlzLCBbJ2ZuJywgJ3Byb3BzJywgJ2NvbnRhaW5lcicsICdkZXB0aDAnLCAnZGF0YScsICdibG9ja1BhcmFtcycsICdkZXB0aHMnLCB0aGlzLmRlY29yYXRvcnMubWVyZ2UoKV0pOwoJCSAgICAgIH0gZWxzZSB7CgkJICAgICAgICB0aGlzLmRlY29yYXRvcnMucHJlcGVuZCgnZnVuY3Rpb24oZm4sIHByb3BzLCBjb250YWluZXIsIGRlcHRoMCwgZGF0YSwgYmxvY2tQYXJhbXMsIGRlcHRocykge1xuJyk7CgkJICAgICAgICB0aGlzLmRlY29yYXRvcnMucHVzaCgnfVxuJyk7CgkJICAgICAgICB0aGlzLmRlY29yYXRvcnMgPSB0aGlzLmRlY29yYXRvcnMubWVyZ2UoKTsKCQkgICAgICB9CgkJICAgIH0gZWxzZSB7CgkJICAgICAgdGhpcy5kZWNvcmF0b3JzID0gdW5kZWZpbmVkOwoJCSAgICB9CgoJCSAgICB2YXIgZm4gPSB0aGlzLmNyZWF0ZUZ1bmN0aW9uQ29udGV4dChhc09iamVjdCk7CgkJICAgIGlmICghdGhpcy5pc0NoaWxkKSB7CgkJICAgICAgdmFyIHJldCA9IHsKCQkgICAgICAgIGNvbXBpbGVyOiB0aGlzLmNvbXBpbGVySW5mbygpLAoJCSAgICAgICAgbWFpbjogZm4KCQkgICAgICB9OwoKCQkgICAgICBpZiAodGhpcy5kZWNvcmF0b3JzKSB7CgkJICAgICAgICByZXQubWFpbl9kID0gdGhpcy5kZWNvcmF0b3JzOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGNhbWVsY2FzZQoJCSAgICAgICAgcmV0LnVzZURlY29yYXRvcnMgPSB0cnVlOwoJCSAgICAgIH0KCgkJICAgICAgdmFyIF9jb250ZXh0ID0gdGhpcy5jb250ZXh0OwoJCSAgICAgIHZhciBwcm9ncmFtcyA9IF9jb250ZXh0LnByb2dyYW1zOwoJCSAgICAgIHZhciBkZWNvcmF0b3JzID0gX2NvbnRleHQuZGVjb3JhdG9yczsKCgkJICAgICAgZm9yIChpID0gMCwgbCA9IHByb2dyYW1zLmxlbmd0aDsgaSA8IGw7IGkrKykgewoJCSAgICAgICAgaWYgKHByb2dyYW1zW2ldKSB7CgkJICAgICAgICAgIHJldFtpXSA9IHByb2dyYW1zW2ldOwoJCSAgICAgICAgICBpZiAoZGVjb3JhdG9yc1tpXSkgewoJCSAgICAgICAgICAgIHJldFtpICsgJ19kJ10gPSBkZWNvcmF0b3JzW2ldOwoJCSAgICAgICAgICAgIHJldC51c2VEZWNvcmF0b3JzID0gdHJ1ZTsKCQkgICAgICAgICAgfQoJCSAgICAgICAgfQoJCSAgICAgIH0KCgkJICAgICAgaWYgKHRoaXMuZW52aXJvbm1lbnQudXNlUGFydGlhbCkgewoJCSAgICAgICAgcmV0LnVzZVBhcnRpYWwgPSB0cnVlOwoJCSAgICAgIH0KCQkgICAgICBpZiAodGhpcy5vcHRpb25zLmRhdGEpIHsKCQkgICAgICAgIHJldC51c2VEYXRhID0gdHJ1ZTsKCQkgICAgICB9CgkJICAgICAgaWYgKHRoaXMudXNlRGVwdGhzKSB7CgkJICAgICAgICByZXQudXNlRGVwdGhzID0gdHJ1ZTsKCQkgICAgICB9CgkJICAgICAgaWYgKHRoaXMudXNlQmxvY2tQYXJhbXMpIHsKCQkgICAgICAgIHJldC51c2VCbG9ja1BhcmFtcyA9IHRydWU7CgkJICAgICAgfQoJCSAgICAgIGlmICh0aGlzLm9wdGlvbnMuY29tcGF0KSB7CgkJICAgICAgICByZXQuY29tcGF0ID0gdHJ1ZTsKCQkgICAgICB9CgoJCSAgICAgIGlmICghYXNPYmplY3QpIHsKCQkgICAgICAgIHJldC5jb21waWxlciA9IEpTT04uc3RyaW5naWZ5KHJldC5jb21waWxlcik7CgoJCSAgICAgICAgdGhpcy5zb3VyY2UuY3VycmVudExvY2F0aW9uID0geyBzdGFydDogeyBsaW5lOiAxLCBjb2x1bW46IDAgfSB9OwoJCSAgICAgICAgcmV0ID0gdGhpcy5vYmplY3RMaXRlcmFsKHJldCk7CgoJCSAgICAgICAgaWYgKG9wdGlvbnMuc3JjTmFtZSkgewoJCSAgICAgICAgICByZXQgPSByZXQudG9TdHJpbmdXaXRoU291cmNlTWFwKHsgZmlsZTogb3B0aW9ucy5kZXN0TmFtZSB9KTsKCQkgICAgICAgICAgcmV0Lm1hcCA9IHJldC5tYXAgJiYgcmV0Lm1hcC50b1N0cmluZygpOwoJCSAgICAgICAgfSBlbHNlIHsKCQkgICAgICAgICAgcmV0ID0gcmV0LnRvU3RyaW5nKCk7CgkJICAgICAgICB9CgkJICAgICAgfSBlbHNlIHsKCQkgICAgICAgIHJldC5jb21waWxlck9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7CgkJICAgICAgfQoKCQkgICAgICByZXR1cm4gcmV0OwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHJldHVybiBmbjsKCQkgICAgfQoJCSAgfSwKCgkJICBwcmVhbWJsZTogZnVuY3Rpb24gcHJlYW1ibGUoKSB7CgkJICAgIC8vIHRyYWNrIHRoZSBsYXN0IGNvbnRleHQgcHVzaGVkIGludG8gcGxhY2UgdG8gYWxsb3cgc2tpcHBpbmcgdGhlCgkJICAgIC8vIGdldENvbnRleHQgb3Bjb2RlIHdoZW4gaXQgd291bGQgYmUgYSBub29wCgkJICAgIHRoaXMubGFzdENvbnRleHQgPSAwOwoJCSAgICB0aGlzLnNvdXJjZSA9IG5ldyBfY29kZUdlbjJbJ2RlZmF1bHQnXSh0aGlzLm9wdGlvbnMuc3JjTmFtZSk7CgkJICAgIHRoaXMuZGVjb3JhdG9ycyA9IG5ldyBfY29kZUdlbjJbJ2RlZmF1bHQnXSh0aGlzLm9wdGlvbnMuc3JjTmFtZSk7CgkJICB9LAoKCQkgIGNyZWF0ZUZ1bmN0aW9uQ29udGV4dDogZnVuY3Rpb24gY3JlYXRlRnVuY3Rpb25Db250ZXh0KGFzT2JqZWN0KSB7CgkJICAgIHZhciB2YXJEZWNsYXJhdGlvbnMgPSAnJzsKCgkJICAgIHZhciBsb2NhbHMgPSB0aGlzLnN0YWNrVmFycy5jb25jYXQodGhpcy5yZWdpc3RlcnMubGlzdCk7CgkJICAgIGlmIChsb2NhbHMubGVuZ3RoID4gMCkgewoJCSAgICAgIHZhckRlY2xhcmF0aW9ucyArPSAnLCAnICsgbG9jYWxzLmpvaW4oJywgJyk7CgkJICAgIH0KCgkJICAgIC8vIEdlbmVyYXRlIG1pbmltaXplciBhbGlhcyBtYXBwaW5ncwoJCSAgICAvLwoJCSAgICAvLyBXaGVuIHVzaW5nIHRydWUgU291cmNlTm9kZXMsIHRoaXMgd2lsbCB1cGRhdGUgYWxsIHJlZmVyZW5jZXMgdG8gdGhlIGdpdmVuIGFsaWFzCgkJICAgIC8vIGFzIHRoZSBzb3VyY2Ugbm9kZXMgYXJlIHJldXNlZCBpbiBzaXR1LiBGb3IgdGhlIG5vbi1zb3VyY2Ugbm9kZSBjb21waWxhdGlvbiBtb2RlLAoJCSAgICAvLyBhbGlhc2VzIHdpbGwgbm90IGJlIHVzZWQsIGJ1dCB0aGlzIGNhc2UgaXMgYWxyZWFkeSBiZWluZyBydW4gb24gdGhlIGNsaWVudCBhbmQKCQkgICAgLy8gd2UgYXJlbid0IGNvbmNlcm4gYWJvdXQgbWluaW1pemluZyB0aGUgdGVtcGxhdGUgc2l6ZS4KCQkgICAgdmFyIGFsaWFzQ291bnQgPSAwOwoJCSAgICBmb3IgKHZhciBhbGlhcyBpbiB0aGlzLmFsaWFzZXMpIHsKCQkgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGd1YXJkLWZvci1pbgoJCSAgICAgIHZhciBub2RlID0gdGhpcy5hbGlhc2VzW2FsaWFzXTsKCgkJICAgICAgaWYgKHRoaXMuYWxpYXNlcy5oYXNPd25Qcm9wZXJ0eShhbGlhcykgJiYgbm9kZS5jaGlsZHJlbiAmJiBub2RlLnJlZmVyZW5jZUNvdW50ID4gMSkgewoJCSAgICAgICAgdmFyRGVjbGFyYXRpb25zICs9ICcsIGFsaWFzJyArICsrYWxpYXNDb3VudCArICc9JyArIGFsaWFzOwoJCSAgICAgICAgbm9kZS5jaGlsZHJlblswXSA9ICdhbGlhcycgKyBhbGlhc0NvdW50OwoJCSAgICAgIH0KCQkgICAgfQoKCQkgICAgdmFyIHBhcmFtcyA9IFsnY29udGFpbmVyJywgJ2RlcHRoMCcsICdoZWxwZXJzJywgJ3BhcnRpYWxzJywgJ2RhdGEnXTsKCgkJICAgIGlmICh0aGlzLnVzZUJsb2NrUGFyYW1zIHx8IHRoaXMudXNlRGVwdGhzKSB7CgkJICAgICAgcGFyYW1zLnB1c2goJ2Jsb2NrUGFyYW1zJyk7CgkJICAgIH0KCQkgICAgaWYgKHRoaXMudXNlRGVwdGhzKSB7CgkJICAgICAgcGFyYW1zLnB1c2goJ2RlcHRocycpOwoJCSAgICB9CgoJCSAgICAvLyBQZXJmb3JtIGEgc2Vjb25kIHBhc3Mgb3ZlciB0aGUgb3V0cHV0IHRvIG1lcmdlIGNvbnRlbnQgd2hlbiBwb3NzaWJsZQoJCSAgICB2YXIgc291cmNlID0gdGhpcy5tZXJnZVNvdXJjZSh2YXJEZWNsYXJhdGlvbnMpOwoKCQkgICAgaWYgKGFzT2JqZWN0KSB7CgkJICAgICAgcGFyYW1zLnB1c2goc291cmNlKTsKCgkJICAgICAgcmV0dXJuIEZ1bmN0aW9uLmFwcGx5KHRoaXMsIHBhcmFtcyk7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgcmV0dXJuIHRoaXMuc291cmNlLndyYXAoWydmdW5jdGlvbignLCBwYXJhbXMuam9pbignLCcpLCAnKSB7XG4gICcsIHNvdXJjZSwgJ30nXSk7CgkJICAgIH0KCQkgIH0sCgkJICBtZXJnZVNvdXJjZTogZnVuY3Rpb24gbWVyZ2VTb3VyY2UodmFyRGVjbGFyYXRpb25zKSB7CgkJICAgIHZhciBpc1NpbXBsZSA9IHRoaXMuZW52aXJvbm1lbnQuaXNTaW1wbGUsCgkJICAgICAgICBhcHBlbmRPbmx5ID0gIXRoaXMuZm9yY2VCdWZmZXIsCgkJICAgICAgICBhcHBlbmRGaXJzdCA9IHVuZGVmaW5lZCwKCQkgICAgICAgIHNvdXJjZVNlZW4gPSB1bmRlZmluZWQsCgkJICAgICAgICBidWZmZXJTdGFydCA9IHVuZGVmaW5lZCwKCQkgICAgICAgIGJ1ZmZlckVuZCA9IHVuZGVmaW5lZDsKCQkgICAgdGhpcy5zb3VyY2UuZWFjaChmdW5jdGlvbiAobGluZSkgewoJCSAgICAgIGlmIChsaW5lLmFwcGVuZFRvQnVmZmVyKSB7CgkJICAgICAgICBpZiAoYnVmZmVyU3RhcnQpIHsKCQkgICAgICAgICAgbGluZS5wcmVwZW5kKCcgICsgJyk7CgkJICAgICAgICB9IGVsc2UgewoJCSAgICAgICAgICBidWZmZXJTdGFydCA9IGxpbmU7CgkJICAgICAgICB9CgkJICAgICAgICBidWZmZXJFbmQgPSBsaW5lOwoJCSAgICAgIH0gZWxzZSB7CgkJICAgICAgICBpZiAoYnVmZmVyU3RhcnQpIHsKCQkgICAgICAgICAgaWYgKCFzb3VyY2VTZWVuKSB7CgkJICAgICAgICAgICAgYXBwZW5kRmlyc3QgPSB0cnVlOwoJCSAgICAgICAgICB9IGVsc2UgewoJCSAgICAgICAgICAgIGJ1ZmZlclN0YXJ0LnByZXBlbmQoJ2J1ZmZlciArPSAnKTsKCQkgICAgICAgICAgfQoJCSAgICAgICAgICBidWZmZXJFbmQuYWRkKCc7Jyk7CgkJICAgICAgICAgIGJ1ZmZlclN0YXJ0ID0gYnVmZmVyRW5kID0gdW5kZWZpbmVkOwoJCSAgICAgICAgfQoKCQkgICAgICAgIHNvdXJjZVNlZW4gPSB0cnVlOwoJCSAgICAgICAgaWYgKCFpc1NpbXBsZSkgewoJCSAgICAgICAgICBhcHBlbmRPbmx5ID0gZmFsc2U7CgkJICAgICAgICB9CgkJICAgICAgfQoJCSAgICB9KTsKCgkJICAgIGlmIChhcHBlbmRPbmx5KSB7CgkJICAgICAgaWYgKGJ1ZmZlclN0YXJ0KSB7CgkJICAgICAgICBidWZmZXJTdGFydC5wcmVwZW5kKCdyZXR1cm4gJyk7CgkJICAgICAgICBidWZmZXJFbmQuYWRkKCc7Jyk7CgkJICAgICAgfSBlbHNlIGlmICghc291cmNlU2VlbikgewoJCSAgICAgICAgdGhpcy5zb3VyY2UucHVzaCgncmV0dXJuICIiOycpOwoJCSAgICAgIH0KCQkgICAgfSBlbHNlIHsKCQkgICAgICB2YXJEZWNsYXJhdGlvbnMgKz0gJywgYnVmZmVyID0gJyArIChhcHBlbmRGaXJzdCA/ICcnIDogdGhpcy5pbml0aWFsaXplQnVmZmVyKCkpOwoKCQkgICAgICBpZiAoYnVmZmVyU3RhcnQpIHsKCQkgICAgICAgIGJ1ZmZlclN0YXJ0LnByZXBlbmQoJ3JldHVybiBidWZmZXIgKyAnKTsKCQkgICAgICAgIGJ1ZmZlckVuZC5hZGQoJzsnKTsKCQkgICAgICB9IGVsc2UgewoJCSAgICAgICAgdGhpcy5zb3VyY2UucHVzaCgncmV0dXJuIGJ1ZmZlcjsnKTsKCQkgICAgICB9CgkJICAgIH0KCgkJICAgIGlmICh2YXJEZWNsYXJhdGlvbnMpIHsKCQkgICAgICB0aGlzLnNvdXJjZS5wcmVwZW5kKCd2YXIgJyArIHZhckRlY2xhcmF0aW9ucy5zdWJzdHJpbmcoMikgKyAoYXBwZW5kRmlyc3QgPyAnJyA6ICc7XG4nKSk7CgkJICAgIH0KCgkJICAgIHJldHVybiB0aGlzLnNvdXJjZS5tZXJnZSgpOwoJCSAgfSwKCgkJICAvLyBbYmxvY2tWYWx1ZV0KCQkgIC8vCgkJICAvLyBPbiBzdGFjaywgYmVmb3JlOiBoYXNoLCBpbnZlcnNlLCBwcm9ncmFtLCB2YWx1ZQoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiByZXR1cm4gdmFsdWUgb2YgYmxvY2tIZWxwZXJNaXNzaW5nCgkJICAvLwoJCSAgLy8gVGhlIHB1cnBvc2Ugb2YgdGhpcyBvcGNvZGUgaXMgdG8gdGFrZSBhIGJsb2NrIG9mIHRoZSBmb3JtCgkJICAvLyBge3sjdGhpcy5mb299fS4uLnt7L3RoaXMuZm9vfX1gLCByZXNvbHZlIHRoZSB2YWx1ZSBvZiBgZm9vYCwgYW5kCgkJICAvLyByZXBsYWNlIGl0IG9uIHRoZSBzdGFjayB3aXRoIHRoZSByZXN1bHQgb2YgcHJvcGVybHkKCQkgIC8vIGludm9raW5nIGJsb2NrSGVscGVyTWlzc2luZy4KCQkgIGJsb2NrVmFsdWU6IGZ1bmN0aW9uIGJsb2NrVmFsdWUobmFtZSkgewoJCSAgICB2YXIgYmxvY2tIZWxwZXJNaXNzaW5nID0gdGhpcy5hbGlhc2FibGUoJ2hlbHBlcnMuYmxvY2tIZWxwZXJNaXNzaW5nJyksCgkJICAgICAgICBwYXJhbXMgPSBbdGhpcy5jb250ZXh0TmFtZSgwKV07CgkJICAgIHRoaXMuc2V0dXBIZWxwZXJBcmdzKG5hbWUsIDAsIHBhcmFtcyk7CgoJCSAgICB2YXIgYmxvY2tOYW1lID0gdGhpcy5wb3BTdGFjaygpOwoJCSAgICBwYXJhbXMuc3BsaWNlKDEsIDAsIGJsb2NrTmFtZSk7CgoJCSAgICB0aGlzLnB1c2godGhpcy5zb3VyY2UuZnVuY3Rpb25DYWxsKGJsb2NrSGVscGVyTWlzc2luZywgJ2NhbGwnLCBwYXJhbXMpKTsKCQkgIH0sCgoJCSAgLy8gW2FtYmlndW91c0Jsb2NrVmFsdWVdCgkJICAvLwoJCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogaGFzaCwgaW52ZXJzZSwgcHJvZ3JhbSwgdmFsdWUKCQkgIC8vIENvbXBpbGVyIHZhbHVlLCBiZWZvcmU6IGxhc3RIZWxwZXI9dmFsdWUgb2YgbGFzdCBmb3VuZCBoZWxwZXIsIGlmIGFueQoJCSAgLy8gT24gc3RhY2ssIGFmdGVyLCBpZiBubyBsYXN0SGVscGVyOiBzYW1lIGFzIFtibG9ja1ZhbHVlXQoJCSAgLy8gT24gc3RhY2ssIGFmdGVyLCBpZiBsYXN0SGVscGVyOiB2YWx1ZQoJCSAgYW1iaWd1b3VzQmxvY2tWYWx1ZTogZnVuY3Rpb24gYW1iaWd1b3VzQmxvY2tWYWx1ZSgpIHsKCQkgICAgLy8gV2UncmUgYmVpbmcgYSBiaXQgY2hlZWt5IGFuZCByZXVzaW5nIHRoZSBvcHRpb25zIHZhbHVlIGZyb20gdGhlIHByaW9yIGV4ZWMKCQkgICAgdmFyIGJsb2NrSGVscGVyTWlzc2luZyA9IHRoaXMuYWxpYXNhYmxlKCdoZWxwZXJzLmJsb2NrSGVscGVyTWlzc2luZycpLAoJCSAgICAgICAgcGFyYW1zID0gW3RoaXMuY29udGV4dE5hbWUoMCldOwoJCSAgICB0aGlzLnNldHVwSGVscGVyQXJncygnJywgMCwgcGFyYW1zLCB0cnVlKTsKCgkJICAgIHRoaXMuZmx1c2hJbmxpbmUoKTsKCgkJICAgIHZhciBjdXJyZW50ID0gdGhpcy50b3BTdGFjaygpOwoJCSAgICBwYXJhbXMuc3BsaWNlKDEsIDAsIGN1cnJlbnQpOwoKCQkgICAgdGhpcy5wdXNoU291cmNlKFsnaWYgKCEnLCB0aGlzLmxhc3RIZWxwZXIsICcpIHsgJywgY3VycmVudCwgJyA9ICcsIHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbChibG9ja0hlbHBlck1pc3NpbmcsICdjYWxsJywgcGFyYW1zKSwgJ30nXSk7CgkJICB9LAoKCQkgIC8vIFthcHBlbmRDb250ZW50XQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IC4uLgoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiAuLi4KCQkgIC8vCgkJICAvLyBBcHBlbmRzIHRoZSBzdHJpbmcgdmFsdWUgb2YgYGNvbnRlbnRgIHRvIHRoZSBjdXJyZW50IGJ1ZmZlcgoJCSAgYXBwZW5kQ29udGVudDogZnVuY3Rpb24gYXBwZW5kQ29udGVudChjb250ZW50KSB7CgkJICAgIGlmICh0aGlzLnBlbmRpbmdDb250ZW50KSB7CgkJICAgICAgY29udGVudCA9IHRoaXMucGVuZGluZ0NvbnRlbnQgKyBjb250ZW50OwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHRoaXMucGVuZGluZ0xvY2F0aW9uID0gdGhpcy5zb3VyY2UuY3VycmVudExvY2F0aW9uOwoJCSAgICB9CgoJCSAgICB0aGlzLnBlbmRpbmdDb250ZW50ID0gY29udGVudDsKCQkgIH0sCgoJCSAgLy8gW2FwcGVuZF0KCQkgIC8vCgkJICAvLyBPbiBzdGFjaywgYmVmb3JlOiB2YWx1ZSwgLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IC4uLgoJCSAgLy8KCQkgIC8vIENvZXJjZXMgYHZhbHVlYCB0byBhIFN0cmluZyBhbmQgYXBwZW5kcyBpdCB0byB0aGUgY3VycmVudCBidWZmZXIuCgkJICAvLwoJCSAgLy8gSWYgYHZhbHVlYCBpcyB0cnV0aHksIG9yIDAsIGl0IGlzIGNvZXJjZWQgaW50byBhIHN0cmluZyBhbmQgYXBwZW5kZWQKCQkgIC8vIE90aGVyd2lzZSwgdGhlIGVtcHR5IHN0cmluZyBpcyBhcHBlbmRlZAoJCSAgYXBwZW5kOiBmdW5jdGlvbiBhcHBlbmQoKSB7CgkJICAgIGlmICh0aGlzLmlzSW5saW5lKCkpIHsKCQkgICAgICB0aGlzLnJlcGxhY2VTdGFjayhmdW5jdGlvbiAoY3VycmVudCkgewoJCSAgICAgICAgcmV0dXJuIFsnICE9IG51bGwgPyAnLCBjdXJyZW50LCAnIDogIiInXTsKCQkgICAgICB9KTsKCgkJICAgICAgdGhpcy5wdXNoU291cmNlKHRoaXMuYXBwZW5kVG9CdWZmZXIodGhpcy5wb3BTdGFjaygpKSk7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgdmFyIGxvY2FsID0gdGhpcy5wb3BTdGFjaygpOwoJCSAgICAgIHRoaXMucHVzaFNvdXJjZShbJ2lmICgnLCBsb2NhbCwgJyAhPSBudWxsKSB7ICcsIHRoaXMuYXBwZW5kVG9CdWZmZXIobG9jYWwsIHVuZGVmaW5lZCwgdHJ1ZSksICcgfSddKTsKCQkgICAgICBpZiAodGhpcy5lbnZpcm9ubWVudC5pc1NpbXBsZSkgewoJCSAgICAgICAgdGhpcy5wdXNoU291cmNlKFsnZWxzZSB7ICcsIHRoaXMuYXBwZW5kVG9CdWZmZXIoIicnIiwgdW5kZWZpbmVkLCB0cnVlKSwgJyB9J10pOwoJCSAgICAgIH0KCQkgICAgfQoJCSAgfSwKCgkJICAvLyBbYXBwZW5kRXNjYXBlZF0KCQkgIC8vCgkJICAvLyBPbiBzdGFjaywgYmVmb3JlOiB2YWx1ZSwgLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IC4uLgoJCSAgLy8KCQkgIC8vIEVzY2FwZSBgdmFsdWVgIGFuZCBhcHBlbmQgaXQgdG8gdGhlIGJ1ZmZlcgoJCSAgYXBwZW5kRXNjYXBlZDogZnVuY3Rpb24gYXBwZW5kRXNjYXBlZCgpIHsKCQkgICAgdGhpcy5wdXNoU291cmNlKHRoaXMuYXBwZW5kVG9CdWZmZXIoW3RoaXMuYWxpYXNhYmxlKCdjb250YWluZXIuZXNjYXBlRXhwcmVzc2lvbicpLCAnKCcsIHRoaXMucG9wU3RhY2soKSwgJyknXSkpOwoJCSAgfSwKCgkJICAvLyBbZ2V0Q29udGV4dF0KCQkgIC8vCgkJICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi4KCQkgIC8vIE9uIHN0YWNrLCBhZnRlcjogLi4uCgkJICAvLyBDb21waWxlciB2YWx1ZSwgYWZ0ZXI6IGxhc3RDb250ZXh0PWRlcHRoCgkJICAvLwoJCSAgLy8gU2V0IHRoZSB2YWx1ZSBvZiB0aGUgYGxhc3RDb250ZXh0YCBjb21waWxlciB2YWx1ZSB0byB0aGUgZGVwdGgKCQkgIGdldENvbnRleHQ6IGZ1bmN0aW9uIGdldENvbnRleHQoZGVwdGgpIHsKCQkgICAgdGhpcy5sYXN0Q29udGV4dCA9IGRlcHRoOwoJCSAgfSwKCgkJICAvLyBbcHVzaENvbnRleHRdCgkJICAvLwoJCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IGN1cnJlbnRDb250ZXh0LCAuLi4KCQkgIC8vCgkJICAvLyBQdXNoZXMgdGhlIHZhbHVlIG9mIHRoZSBjdXJyZW50IGNvbnRleHQgb250byB0aGUgc3RhY2suCgkJICBwdXNoQ29udGV4dDogZnVuY3Rpb24gcHVzaENvbnRleHQoKSB7CgkJICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCh0aGlzLmNvbnRleHROYW1lKHRoaXMubGFzdENvbnRleHQpKTsKCQkgIH0sCgoJCSAgLy8gW2xvb2t1cE9uQ29udGV4dF0KCQkgIC8vCgkJICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi4KCQkgIC8vIE9uIHN0YWNrLCBhZnRlcjogY3VycmVudENvbnRleHRbbmFtZV0sIC4uLgoJCSAgLy8KCQkgIC8vIExvb2tzIHVwIHRoZSB2YWx1ZSBvZiBgbmFtZWAgb24gdGhlIGN1cnJlbnQgY29udGV4dCBhbmQgcHVzaGVzCgkJICAvLyBpdCBvbnRvIHRoZSBzdGFjay4KCQkgIGxvb2t1cE9uQ29udGV4dDogZnVuY3Rpb24gbG9va3VwT25Db250ZXh0KHBhcnRzLCBmYWxzeSwgc3RyaWN0LCBzY29wZWQpIHsKCQkgICAgdmFyIGkgPSAwOwoKCQkgICAgaWYgKCFzY29wZWQgJiYgdGhpcy5vcHRpb25zLmNvbXBhdCAmJiAhdGhpcy5sYXN0Q29udGV4dCkgewoJCSAgICAgIC8vIFRoZSBkZXB0aGVkIHF1ZXJ5IGlzIGV4cGVjdGVkIHRvIGhhbmRsZSB0aGUgdW5kZWZpbmVkIGxvZ2ljIGZvciB0aGUgcm9vdCBsZXZlbCB0aGF0CgkJICAgICAgLy8gaXMgaW1wbGVtZW50ZWQgYmVsb3csIHNvIHdlIGV2YWx1YXRlIHRoYXQgZGlyZWN0bHkgaW4gY29tcGF0IG1vZGUKCQkgICAgICB0aGlzLnB1c2godGhpcy5kZXB0aGVkTG9va3VwKHBhcnRzW2krK10pKTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICB0aGlzLnB1c2hDb250ZXh0KCk7CgkJICAgIH0KCgkJICAgIHRoaXMucmVzb2x2ZVBhdGgoJ2NvbnRleHQnLCBwYXJ0cywgaSwgZmFsc3ksIHN0cmljdCk7CgkJICB9LAoKCQkgIC8vIFtsb29rdXBCbG9ja1BhcmFtXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IC4uLgoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiBibG9ja1BhcmFtW25hbWVdLCAuLi4KCQkgIC8vCgkJICAvLyBMb29rcyB1cCB0aGUgdmFsdWUgb2YgYHBhcnRzYCBvbiB0aGUgZ2l2ZW4gYmxvY2sgcGFyYW0gYW5kIHB1c2hlcwoJCSAgLy8gaXQgb250byB0aGUgc3RhY2suCgkJICBsb29rdXBCbG9ja1BhcmFtOiBmdW5jdGlvbiBsb29rdXBCbG9ja1BhcmFtKGJsb2NrUGFyYW1JZCwgcGFydHMpIHsKCQkgICAgdGhpcy51c2VCbG9ja1BhcmFtcyA9IHRydWU7CgoJCSAgICB0aGlzLnB1c2goWydibG9ja1BhcmFtc1snLCBibG9ja1BhcmFtSWRbMF0sICddWycsIGJsb2NrUGFyYW1JZFsxXSwgJ10nXSk7CgkJICAgIHRoaXMucmVzb2x2ZVBhdGgoJ2NvbnRleHQnLCBwYXJ0cywgMSk7CgkJICB9LAoKCQkgIC8vIFtsb29rdXBEYXRhXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IC4uLgoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiBkYXRhLCAuLi4KCQkgIC8vCgkJICAvLyBQdXNoIHRoZSBkYXRhIGxvb2t1cCBvcGVyYXRvcgoJCSAgbG9va3VwRGF0YTogZnVuY3Rpb24gbG9va3VwRGF0YShkZXB0aCwgcGFydHMsIHN0cmljdCkgewoJCSAgICBpZiAoIWRlcHRoKSB7CgkJICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKCdkYXRhJyk7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKCdjb250YWluZXIuZGF0YShkYXRhLCAnICsgZGVwdGggKyAnKScpOwoJCSAgICB9CgoJCSAgICB0aGlzLnJlc29sdmVQYXRoKCdkYXRhJywgcGFydHMsIDAsIHRydWUsIHN0cmljdCk7CgkJICB9LAoKCQkgIHJlc29sdmVQYXRoOiBmdW5jdGlvbiByZXNvbHZlUGF0aCh0eXBlLCBwYXJ0cywgaSwgZmFsc3ksIHN0cmljdCkgewoJCSAgICAvLyBpc3RhbmJ1bCBpZ25vcmUgbmV4dAoKCQkgICAgdmFyIF90aGlzID0gdGhpczsKCgkJICAgIGlmICh0aGlzLm9wdGlvbnMuc3RyaWN0IHx8IHRoaXMub3B0aW9ucy5hc3N1bWVPYmplY3RzKSB7CgkJICAgICAgdGhpcy5wdXNoKHN0cmljdExvb2t1cCh0aGlzLm9wdGlvbnMuc3RyaWN0ICYmIHN0cmljdCwgdGhpcywgcGFydHMsIHR5cGUpKTsKCQkgICAgICByZXR1cm47CgkJICAgIH0KCgkJICAgIHZhciBsZW4gPSBwYXJ0cy5sZW5ndGg7CgkJICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHsKCQkgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1sb29wLWZ1bmMgKi8KCQkgICAgICB0aGlzLnJlcGxhY2VTdGFjayhmdW5jdGlvbiAoY3VycmVudCkgewoJCSAgICAgICAgdmFyIGxvb2t1cCA9IF90aGlzLm5hbWVMb29rdXAoY3VycmVudCwgcGFydHNbaV0sIHR5cGUpOwoJCSAgICAgICAgLy8gV2Ugd2FudCB0byBlbnN1cmUgdGhhdCB6ZXJvIGFuZCBmYWxzZSBhcmUgaGFuZGxlZCBwcm9wZXJseSBpZiB0aGUgY29udGV4dCAoZmFsc3kgZmxhZykKCQkgICAgICAgIC8vIG5lZWRzIHRvIGhhdmUgdGhlIHNwZWNpYWwgaGFuZGxpbmcgZm9yIHRoZXNlIHZhbHVlcy4KCQkgICAgICAgIGlmICghZmFsc3kpIHsKCQkgICAgICAgICAgcmV0dXJuIFsnICE9IG51bGwgPyAnLCBsb29rdXAsICcgOiAnLCBjdXJyZW50XTsKCQkgICAgICAgIH0gZWxzZSB7CgkJICAgICAgICAgIC8vIE90aGVyd2lzZSB3ZSBjYW4gdXNlIGdlbmVyaWMgZmFsc3kgaGFuZGxpbmcKCQkgICAgICAgICAgcmV0dXJuIFsnICYmICcsIGxvb2t1cF07CgkJICAgICAgICB9CgkJICAgICAgfSk7CgkJICAgICAgLyogZXNsaW50LWVuYWJsZSBuby1sb29wLWZ1bmMgKi8KCQkgICAgfQoJCSAgfSwKCgkJICAvLyBbcmVzb2x2ZVBvc3NpYmxlTGFtYmRhXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IHZhbHVlLCAuLi4KCQkgIC8vIE9uIHN0YWNrLCBhZnRlcjogcmVzb2x2ZWQgdmFsdWUsIC4uLgoJCSAgLy8KCQkgIC8vIElmIHRoZSBgdmFsdWVgIGlzIGEgbGFtYmRhLCByZXBsYWNlIGl0IG9uIHRoZSBzdGFjayBieQoJCSAgLy8gdGhlIHJldHVybiB2YWx1ZSBvZiB0aGUgbGFtYmRhCgkJICByZXNvbHZlUG9zc2libGVMYW1iZGE6IGZ1bmN0aW9uIHJlc29sdmVQb3NzaWJsZUxhbWJkYSgpIHsKCQkgICAgdGhpcy5wdXNoKFt0aGlzLmFsaWFzYWJsZSgnY29udGFpbmVyLmxhbWJkYScpLCAnKCcsIHRoaXMucG9wU3RhY2soKSwgJywgJywgdGhpcy5jb250ZXh0TmFtZSgwKSwgJyknXSk7CgkJICB9LAoKCQkgIC8vIFtwdXNoU3RyaW5nUGFyYW1dCgkJICAvLwoJCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IHN0cmluZywgY3VycmVudENvbnRleHQsIC4uLgoJCSAgLy8KCQkgIC8vIFRoaXMgb3Bjb2RlIGlzIGRlc2lnbmVkIGZvciB1c2UgaW4gc3RyaW5nIG1vZGUsIHdoaWNoCgkJICAvLyBwcm92aWRlcyB0aGUgc3RyaW5nIHZhbHVlIG9mIGEgcGFyYW1ldGVyIGFsb25nIHdpdGggaXRzCgkJICAvLyBkZXB0aCByYXRoZXIgdGhhbiByZXNvbHZpbmcgaXQgaW1tZWRpYXRlbHkuCgkJICBwdXNoU3RyaW5nUGFyYW06IGZ1bmN0aW9uIHB1c2hTdHJpbmdQYXJhbShzdHJpbmcsIHR5cGUpIHsKCQkgICAgdGhpcy5wdXNoQ29udGV4dCgpOwoJCSAgICB0aGlzLnB1c2hTdHJpbmcodHlwZSk7CgoJCSAgICAvLyBJZiBpdCdzIGEgc3ViZXhwcmVzc2lvbiwgdGhlIHN0cmluZyByZXN1bHQKCQkgICAgLy8gd2lsbCBiZSBwdXNoZWQgYWZ0ZXIgdGhpcyBvcGNvZGUuCgkJICAgIGlmICh0eXBlICE9PSAnU3ViRXhwcmVzc2lvbicpIHsKCQkgICAgICBpZiAodHlwZW9mIHN0cmluZyA9PT0gJ3N0cmluZycpIHsKCQkgICAgICAgIHRoaXMucHVzaFN0cmluZyhzdHJpbmcpOwoJCSAgICAgIH0gZWxzZSB7CgkJICAgICAgICB0aGlzLnB1c2hTdGFja0xpdGVyYWwoc3RyaW5nKTsKCQkgICAgICB9CgkJICAgIH0KCQkgIH0sCgoJCSAgZW1wdHlIYXNoOiBmdW5jdGlvbiBlbXB0eUhhc2gob21pdEVtcHR5KSB7CgkJICAgIGlmICh0aGlzLnRyYWNrSWRzKSB7CgkJICAgICAgdGhpcy5wdXNoKCd7fScpOyAvLyBoYXNoSWRzCgkJICAgIH0KCQkgICAgaWYgKHRoaXMuc3RyaW5nUGFyYW1zKSB7CgkJICAgICAgdGhpcy5wdXNoKCd7fScpOyAvLyBoYXNoQ29udGV4dHMKCQkgICAgICB0aGlzLnB1c2goJ3t9Jyk7IC8vIGhhc2hUeXBlcwoJCSAgICB9CgkJICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbChvbWl0RW1wdHkgPyAndW5kZWZpbmVkJyA6ICd7fScpOwoJCSAgfSwKCQkgIHB1c2hIYXNoOiBmdW5jdGlvbiBwdXNoSGFzaCgpIHsKCQkgICAgaWYgKHRoaXMuaGFzaCkgewoJCSAgICAgIHRoaXMuaGFzaGVzLnB1c2godGhpcy5oYXNoKTsKCQkgICAgfQoJCSAgICB0aGlzLmhhc2ggPSB7IHZhbHVlczogW10sIHR5cGVzOiBbXSwgY29udGV4dHM6IFtdLCBpZHM6IFtdIH07CgkJICB9LAoJCSAgcG9wSGFzaDogZnVuY3Rpb24gcG9wSGFzaCgpIHsKCQkgICAgdmFyIGhhc2ggPSB0aGlzLmhhc2g7CgkJICAgIHRoaXMuaGFzaCA9IHRoaXMuaGFzaGVzLnBvcCgpOwoKCQkgICAgaWYgKHRoaXMudHJhY2tJZHMpIHsKCQkgICAgICB0aGlzLnB1c2godGhpcy5vYmplY3RMaXRlcmFsKGhhc2guaWRzKSk7CgkJICAgIH0KCQkgICAgaWYgKHRoaXMuc3RyaW5nUGFyYW1zKSB7CgkJICAgICAgdGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbChoYXNoLmNvbnRleHRzKSk7CgkJICAgICAgdGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbChoYXNoLnR5cGVzKSk7CgkJICAgIH0KCgkJICAgIHRoaXMucHVzaCh0aGlzLm9iamVjdExpdGVyYWwoaGFzaC52YWx1ZXMpKTsKCQkgIH0sCgoJCSAgLy8gW3B1c2hTdHJpbmddCgkJICAvLwoJCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IHF1b3RlZFN0cmluZyhzdHJpbmcpLCAuLi4KCQkgIC8vCgkJICAvLyBQdXNoIGEgcXVvdGVkIHZlcnNpb24gb2YgYHN0cmluZ2Agb250byB0aGUgc3RhY2sKCQkgIHB1c2hTdHJpbmc6IGZ1bmN0aW9uIHB1c2hTdHJpbmcoc3RyaW5nKSB7CgkJICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCh0aGlzLnF1b3RlZFN0cmluZyhzdHJpbmcpKTsKCQkgIH0sCgoJCSAgLy8gW3B1c2hMaXRlcmFsXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IC4uLgoJCSAgLy8gT24gc3RhY2ssIGFmdGVyOiB2YWx1ZSwgLi4uCgkJICAvLwoJCSAgLy8gUHVzaGVzIGEgdmFsdWUgb250byB0aGUgc3RhY2suIFRoaXMgb3BlcmF0aW9uIHByZXZlbnRzCgkJICAvLyB0aGUgY29tcGlsZXIgZnJvbSBjcmVhdGluZyBhIHRlbXBvcmFyeSB2YXJpYWJsZSB0byBob2xkCgkJICAvLyBpdC4KCQkgIHB1c2hMaXRlcmFsOiBmdW5jdGlvbiBwdXNoTGl0ZXJhbCh2YWx1ZSkgewoJCSAgICB0aGlzLnB1c2hTdGFja0xpdGVyYWwodmFsdWUpOwoJCSAgfSwKCgkJICAvLyBbcHVzaFByb2dyYW1dCgkJICAvLwoJCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IHByb2dyYW0oZ3VpZCksIC4uLgoJCSAgLy8KCQkgIC8vIFB1c2ggYSBwcm9ncmFtIGV4cHJlc3Npb24gb250byB0aGUgc3RhY2suIFRoaXMgdGFrZXMKCQkgIC8vIGEgY29tcGlsZS10aW1lIGd1aWQgYW5kIGNvbnZlcnRzIGl0IGludG8gYSBydW50aW1lLWFjY2Vzc2libGUKCQkgIC8vIGV4cHJlc3Npb24uCgkJICBwdXNoUHJvZ3JhbTogZnVuY3Rpb24gcHVzaFByb2dyYW0oZ3VpZCkgewoJCSAgICBpZiAoZ3VpZCAhPSBudWxsKSB7CgkJICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKHRoaXMucHJvZ3JhbUV4cHJlc3Npb24oZ3VpZCkpOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbChudWxsKTsKCQkgICAgfQoJCSAgfSwKCgkJICAvLyBbcmVnaXN0ZXJEZWNvcmF0b3JdCgkJICAvLwoJCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogaGFzaCwgcHJvZ3JhbSwgcGFyYW1zLi4uLCAuLi4KCQkgIC8vIE9uIHN0YWNrLCBhZnRlcjogLi4uCgkJICAvLwoJCSAgLy8gUG9wcyBvZmYgdGhlIGRlY29yYXRvcidzIHBhcmFtZXRlcnMsIGludm9rZXMgdGhlIGRlY29yYXRvciwKCQkgIC8vIGFuZCBpbnNlcnRzIHRoZSBkZWNvcmF0b3IgaW50byB0aGUgZGVjb3JhdG9ycyBsaXN0LgoJCSAgcmVnaXN0ZXJEZWNvcmF0b3I6IGZ1bmN0aW9uIHJlZ2lzdGVyRGVjb3JhdG9yKHBhcmFtU2l6ZSwgbmFtZSkgewoJCSAgICB2YXIgZm91bmREZWNvcmF0b3IgPSB0aGlzLm5hbWVMb29rdXAoJ2RlY29yYXRvcnMnLCBuYW1lLCAnZGVjb3JhdG9yJyksCgkJICAgICAgICBvcHRpb25zID0gdGhpcy5zZXR1cEhlbHBlckFyZ3MobmFtZSwgcGFyYW1TaXplKTsKCgkJICAgIHRoaXMuZGVjb3JhdG9ycy5wdXNoKFsnZm4gPSAnLCB0aGlzLmRlY29yYXRvcnMuZnVuY3Rpb25DYWxsKGZvdW5kRGVjb3JhdG9yLCAnJywgWydmbicsICdwcm9wcycsICdjb250YWluZXInLCBvcHRpb25zXSksICcgfHwgZm47J10pOwoJCSAgfSwKCgkJICAvLyBbaW52b2tlSGVscGVyXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IGhhc2gsIGludmVyc2UsIHByb2dyYW0sIHBhcmFtcy4uLiwgLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IHJlc3VsdCBvZiBoZWxwZXIgaW52b2NhdGlvbgoJCSAgLy8KCQkgIC8vIFBvcHMgb2ZmIHRoZSBoZWxwZXIncyBwYXJhbWV0ZXJzLCBpbnZva2VzIHRoZSBoZWxwZXIsCgkJICAvLyBhbmQgcHVzaGVzIHRoZSBoZWxwZXIncyByZXR1cm4gdmFsdWUgb250byB0aGUgc3RhY2suCgkJICAvLwoJCSAgLy8gSWYgdGhlIGhlbHBlciBpcyBub3QgZm91bmQsIGBoZWxwZXJNaXNzaW5nYCBpcyBjYWxsZWQuCgkJICBpbnZva2VIZWxwZXI6IGZ1bmN0aW9uIGludm9rZUhlbHBlcihwYXJhbVNpemUsIG5hbWUsIGlzU2ltcGxlKSB7CgkJICAgIHZhciBub25IZWxwZXIgPSB0aGlzLnBvcFN0YWNrKCksCgkJICAgICAgICBoZWxwZXIgPSB0aGlzLnNldHVwSGVscGVyKHBhcmFtU2l6ZSwgbmFtZSksCgkJICAgICAgICBzaW1wbGUgPSBpc1NpbXBsZSA/IFtoZWxwZXIubmFtZSwgJyB8fCAnXSA6ICcnOwoKCQkgICAgdmFyIGxvb2t1cCA9IFsnKCddLmNvbmNhdChzaW1wbGUsIG5vbkhlbHBlcik7CgkJICAgIGlmICghdGhpcy5vcHRpb25zLnN0cmljdCkgewoJCSAgICAgIGxvb2t1cC5wdXNoKCcgfHwgJywgdGhpcy5hbGlhc2FibGUoJ2hlbHBlcnMuaGVscGVyTWlzc2luZycpKTsKCQkgICAgfQoJCSAgICBsb29rdXAucHVzaCgnKScpOwoKCQkgICAgdGhpcy5wdXNoKHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbChsb29rdXAsICdjYWxsJywgaGVscGVyLmNhbGxQYXJhbXMpKTsKCQkgIH0sCgoJCSAgLy8gW2ludm9rZUtub3duSGVscGVyXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IGhhc2gsIGludmVyc2UsIHByb2dyYW0sIHBhcmFtcy4uLiwgLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IHJlc3VsdCBvZiBoZWxwZXIgaW52b2NhdGlvbgoJCSAgLy8KCQkgIC8vIFRoaXMgb3BlcmF0aW9uIGlzIHVzZWQgd2hlbiB0aGUgaGVscGVyIGlzIGtub3duIHRvIGV4aXN0LAoJCSAgLy8gc28gYSBgaGVscGVyTWlzc2luZ2AgZmFsbGJhY2sgaXMgbm90IHJlcXVpcmVkLgoJCSAgaW52b2tlS25vd25IZWxwZXI6IGZ1bmN0aW9uIGludm9rZUtub3duSGVscGVyKHBhcmFtU2l6ZSwgbmFtZSkgewoJCSAgICB2YXIgaGVscGVyID0gdGhpcy5zZXR1cEhlbHBlcihwYXJhbVNpemUsIG5hbWUpOwoJCSAgICB0aGlzLnB1c2godGhpcy5zb3VyY2UuZnVuY3Rpb25DYWxsKGhlbHBlci5uYW1lLCAnY2FsbCcsIGhlbHBlci5jYWxsUGFyYW1zKSk7CgkJICB9LAoKCQkgIC8vIFtpbnZva2VBbWJpZ3VvdXNdCgkJICAvLwoJCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogaGFzaCwgaW52ZXJzZSwgcHJvZ3JhbSwgcGFyYW1zLi4uLCAuLi4KCQkgIC8vIE9uIHN0YWNrLCBhZnRlcjogcmVzdWx0IG9mIGRpc2FtYmlndWF0aW9uCgkJICAvLwoJCSAgLy8gVGhpcyBvcGVyYXRpb24gaXMgdXNlZCB3aGVuIGFuIGV4cHJlc3Npb24gbGlrZSBge3tmb299fWAKCQkgIC8vIGlzIHByb3ZpZGVkLCBidXQgd2UgZG9uJ3Qga25vdyBhdCBjb21waWxlLXRpbWUgd2hldGhlciBpdAoJCSAgLy8gaXMgYSBoZWxwZXIgb3IgYSBwYXRoLgoJCSAgLy8KCQkgIC8vIFRoaXMgb3BlcmF0aW9uIGVtaXRzIG1vcmUgY29kZSB0aGFuIHRoZSBvdGhlciBvcHRpb25zLAoJCSAgLy8gYW5kIGNhbiBiZSBhdm9pZGVkIGJ5IHBhc3NpbmcgdGhlIGBrbm93bkhlbHBlcnNgIGFuZAoJCSAgLy8gYGtub3duSGVscGVyc09ubHlgIGZsYWdzIGF0IGNvbXBpbGUtdGltZS4KCQkgIGludm9rZUFtYmlndW91czogZnVuY3Rpb24gaW52b2tlQW1iaWd1b3VzKG5hbWUsIGhlbHBlckNhbGwpIHsKCQkgICAgdGhpcy51c2VSZWdpc3RlcignaGVscGVyJyk7CgoJCSAgICB2YXIgbm9uSGVscGVyID0gdGhpcy5wb3BTdGFjaygpOwoKCQkgICAgdGhpcy5lbXB0eUhhc2goKTsKCQkgICAgdmFyIGhlbHBlciA9IHRoaXMuc2V0dXBIZWxwZXIoMCwgbmFtZSwgaGVscGVyQ2FsbCk7CgoJCSAgICB2YXIgaGVscGVyTmFtZSA9IHRoaXMubGFzdEhlbHBlciA9IHRoaXMubmFtZUxvb2t1cCgnaGVscGVycycsIG5hbWUsICdoZWxwZXInKTsKCgkJICAgIHZhciBsb29rdXAgPSBbJygnLCAnKGhlbHBlciA9ICcsIGhlbHBlck5hbWUsICcgfHwgJywgbm9uSGVscGVyLCAnKSddOwoJCSAgICBpZiAoIXRoaXMub3B0aW9ucy5zdHJpY3QpIHsKCQkgICAgICBsb29rdXBbMF0gPSAnKGhlbHBlciA9ICc7CgkJICAgICAgbG9va3VwLnB1c2goJyAhPSBudWxsID8gaGVscGVyIDogJywgdGhpcy5hbGlhc2FibGUoJ2hlbHBlcnMuaGVscGVyTWlzc2luZycpKTsKCQkgICAgfQoKCQkgICAgdGhpcy5wdXNoKFsnKCcsIGxvb2t1cCwgaGVscGVyLnBhcmFtc0luaXQgPyBbJyksKCcsIGhlbHBlci5wYXJhbXNJbml0XSA6IFtdLCAnKSwnLCAnKHR5cGVvZiBoZWxwZXIgPT09ICcsIHRoaXMuYWxpYXNhYmxlKCciZnVuY3Rpb24iJyksICcgPyAnLCB0aGlzLnNvdXJjZS5mdW5jdGlvbkNhbGwoJ2hlbHBlcicsICdjYWxsJywgaGVscGVyLmNhbGxQYXJhbXMpLCAnIDogaGVscGVyKSknXSk7CgkJICB9LAoKCQkgIC8vIFtpbnZva2VQYXJ0aWFsXQoJCSAgLy8KCQkgIC8vIE9uIHN0YWNrLCBiZWZvcmU6IGNvbnRleHQsIC4uLgoJCSAgLy8gT24gc3RhY2sgYWZ0ZXI6IHJlc3VsdCBvZiBwYXJ0aWFsIGludm9jYXRpb24KCQkgIC8vCgkJICAvLyBUaGlzIG9wZXJhdGlvbiBwb3BzIG9mZiBhIGNvbnRleHQsIGludm9rZXMgYSBwYXJ0aWFsIHdpdGggdGhhdCBjb250ZXh0LAoJCSAgLy8gYW5kIHB1c2hlcyB0aGUgcmVzdWx0IG9mIHRoZSBpbnZvY2F0aW9uIGJhY2suCgkJICBpbnZva2VQYXJ0aWFsOiBmdW5jdGlvbiBpbnZva2VQYXJ0aWFsKGlzRHluYW1pYywgbmFtZSwgaW5kZW50KSB7CgkJICAgIHZhciBwYXJhbXMgPSBbXSwKCQkgICAgICAgIG9wdGlvbnMgPSB0aGlzLnNldHVwUGFyYW1zKG5hbWUsIDEsIHBhcmFtcyk7CgoJCSAgICBpZiAoaXNEeW5hbWljKSB7CgkJICAgICAgbmFtZSA9IHRoaXMucG9wU3RhY2soKTsKCQkgICAgICBkZWxldGUgb3B0aW9ucy5uYW1lOwoJCSAgICB9CgoJCSAgICBpZiAoaW5kZW50KSB7CgkJICAgICAgb3B0aW9ucy5pbmRlbnQgPSBKU09OLnN0cmluZ2lmeShpbmRlbnQpOwoJCSAgICB9CgkJICAgIG9wdGlvbnMuaGVscGVycyA9ICdoZWxwZXJzJzsKCQkgICAgb3B0aW9ucy5wYXJ0aWFscyA9ICdwYXJ0aWFscyc7CgkJICAgIG9wdGlvbnMuZGVjb3JhdG9ycyA9ICdjb250YWluZXIuZGVjb3JhdG9ycyc7CgoJCSAgICBpZiAoIWlzRHluYW1pYykgewoJCSAgICAgIHBhcmFtcy51bnNoaWZ0KHRoaXMubmFtZUxvb2t1cCgncGFydGlhbHMnLCBuYW1lLCAncGFydGlhbCcpKTsKCQkgICAgfSBlbHNlIHsKCQkgICAgICBwYXJhbXMudW5zaGlmdChuYW1lKTsKCQkgICAgfQoKCQkgICAgaWYgKHRoaXMub3B0aW9ucy5jb21wYXQpIHsKCQkgICAgICBvcHRpb25zLmRlcHRocyA9ICdkZXB0aHMnOwoJCSAgICB9CgkJICAgIG9wdGlvbnMgPSB0aGlzLm9iamVjdExpdGVyYWwob3B0aW9ucyk7CgkJICAgIHBhcmFtcy5wdXNoKG9wdGlvbnMpOwoKCQkgICAgdGhpcy5wdXNoKHRoaXMuc291cmNlLmZ1bmN0aW9uQ2FsbCgnY29udGFpbmVyLmludm9rZVBhcnRpYWwnLCAnJywgcGFyYW1zKSk7CgkJICB9LAoKCQkgIC8vIFthc3NpZ25Ub0hhc2hdCgkJICAvLwoJCSAgLy8gT24gc3RhY2ssIGJlZm9yZTogdmFsdWUsIC4uLiwgaGFzaCwgLi4uCgkJICAvLyBPbiBzdGFjaywgYWZ0ZXI6IC4uLiwgaGFzaCwgLi4uCgkJICAvLwoJCSAgLy8gUG9wcyBhIHZhbHVlIG9mZiB0aGUgc3RhY2sgYW5kIGFzc2lnbnMgaXQgdG8gdGhlIGN1cnJlbnQgaGFzaAoJCSAgYXNzaWduVG9IYXNoOiBmdW5jdGlvbiBhc3NpZ25Ub0hhc2goa2V5KSB7CgkJICAgIHZhciB2YWx1ZSA9IHRoaXMucG9wU3RhY2soKSwKCQkgICAgICAgIGNvbnRleHQgPSB1bmRlZmluZWQsCgkJICAgICAgICB0eXBlID0gdW5kZWZpbmVkLAoJCSAgICAgICAgaWQgPSB1bmRlZmluZWQ7CgoJCSAgICBpZiAodGhpcy50cmFja0lkcykgewoJCSAgICAgIGlkID0gdGhpcy5wb3BTdGFjaygpOwoJCSAgICB9CgkJICAgIGlmICh0aGlzLnN0cmluZ1BhcmFtcykgewoJCSAgICAgIHR5cGUgPSB0aGlzLnBvcFN0YWNrKCk7CgkJICAgICAgY29udGV4dCA9IHRoaXMucG9wU3RhY2soKTsKCQkgICAgfQoKCQkgICAgdmFyIGhhc2ggPSB0aGlzLmhhc2g7CgkJICAgIGlmIChjb250ZXh0KSB7CgkJICAgICAgaGFzaC5jb250ZXh0c1trZXldID0gY29udGV4dDsKCQkgICAgfQoJCSAgICBpZiAodHlwZSkgewoJCSAgICAgIGhhc2gudHlwZXNba2V5XSA9IHR5cGU7CgkJICAgIH0KCQkgICAgaWYgKGlkKSB7CgkJICAgICAgaGFzaC5pZHNba2V5XSA9IGlkOwoJCSAgICB9CgkJICAgIGhhc2gudmFsdWVzW2tleV0gPSB2YWx1ZTsKCQkgIH0sCgoJCSAgcHVzaElkOiBmdW5jdGlvbiBwdXNoSWQodHlwZSwgbmFtZSwgY2hpbGQpIHsKCQkgICAgaWYgKHR5cGUgPT09ICdCbG9ja1BhcmFtJykgewoJCSAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCgnYmxvY2tQYXJhbXNbJyArIG5hbWVbMF0gKyAnXS5wYXRoWycgKyBuYW1lWzFdICsgJ10nICsgKGNoaWxkID8gJyArICcgKyBKU09OLnN0cmluZ2lmeSgnLicgKyBjaGlsZCkgOiAnJykpOwoJCSAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdQYXRoRXhwcmVzc2lvbicpIHsKCQkgICAgICB0aGlzLnB1c2hTdHJpbmcobmFtZSk7CgkJICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ1N1YkV4cHJlc3Npb24nKSB7CgkJICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKCd0cnVlJyk7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKCdudWxsJyk7CgkJICAgIH0KCQkgIH0sCgoJCSAgLy8gSEVMUEVSUwoKCQkgIGNvbXBpbGVyOiBKYXZhU2NyaXB0Q29tcGlsZXIsCgoJCSAgY29tcGlsZUNoaWxkcmVuOiBmdW5jdGlvbiBjb21waWxlQ2hpbGRyZW4oZW52aXJvbm1lbnQsIG9wdGlvbnMpIHsKCQkgICAgdmFyIGNoaWxkcmVuID0gZW52aXJvbm1lbnQuY2hpbGRyZW4sCgkJICAgICAgICBjaGlsZCA9IHVuZGVmaW5lZCwKCQkgICAgICAgIGNvbXBpbGVyID0gdW5kZWZpbmVkOwoKCQkgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBsOyBpKyspIHsKCQkgICAgICBjaGlsZCA9IGNoaWxkcmVuW2ldOwoJCSAgICAgIGNvbXBpbGVyID0gbmV3IHRoaXMuY29tcGlsZXIoKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuZXctY2FwCgoJCSAgICAgIHZhciBleGlzdGluZyA9IHRoaXMubWF0Y2hFeGlzdGluZ1Byb2dyYW0oY2hpbGQpOwoKCQkgICAgICBpZiAoZXhpc3RpbmcgPT0gbnVsbCkgewoJCSAgICAgICAgdGhpcy5jb250ZXh0LnByb2dyYW1zLnB1c2goJycpOyAvLyBQbGFjZWhvbGRlciB0byBwcmV2ZW50IG5hbWUgY29uZmxpY3RzIGZvciBuZXN0ZWQgY2hpbGRyZW4KCQkgICAgICAgIHZhciBpbmRleCA9IHRoaXMuY29udGV4dC5wcm9ncmFtcy5sZW5ndGg7CgkJICAgICAgICBjaGlsZC5pbmRleCA9IGluZGV4OwoJCSAgICAgICAgY2hpbGQubmFtZSA9ICdwcm9ncmFtJyArIGluZGV4OwoJCSAgICAgICAgdGhpcy5jb250ZXh0LnByb2dyYW1zW2luZGV4XSA9IGNvbXBpbGVyLmNvbXBpbGUoY2hpbGQsIG9wdGlvbnMsIHRoaXMuY29udGV4dCwgIXRoaXMucHJlY29tcGlsZSk7CgkJICAgICAgICB0aGlzLmNvbnRleHQuZGVjb3JhdG9yc1tpbmRleF0gPSBjb21waWxlci5kZWNvcmF0b3JzOwoJCSAgICAgICAgdGhpcy5jb250ZXh0LmVudmlyb25tZW50c1tpbmRleF0gPSBjaGlsZDsKCgkJICAgICAgICB0aGlzLnVzZURlcHRocyA9IHRoaXMudXNlRGVwdGhzIHx8IGNvbXBpbGVyLnVzZURlcHRoczsKCQkgICAgICAgIHRoaXMudXNlQmxvY2tQYXJhbXMgPSB0aGlzLnVzZUJsb2NrUGFyYW1zIHx8IGNvbXBpbGVyLnVzZUJsb2NrUGFyYW1zOwoJCSAgICAgICAgY2hpbGQudXNlRGVwdGhzID0gdGhpcy51c2VEZXB0aHM7CgkJICAgICAgICBjaGlsZC51c2VCbG9ja1BhcmFtcyA9IHRoaXMudXNlQmxvY2tQYXJhbXM7CgkJICAgICAgfSBlbHNlIHsKCQkgICAgICAgIGNoaWxkLmluZGV4ID0gZXhpc3RpbmcuaW5kZXg7CgkJICAgICAgICBjaGlsZC5uYW1lID0gJ3Byb2dyYW0nICsgZXhpc3RpbmcuaW5kZXg7CgoJCSAgICAgICAgdGhpcy51c2VEZXB0aHMgPSB0aGlzLnVzZURlcHRocyB8fCBleGlzdGluZy51c2VEZXB0aHM7CgkJICAgICAgICB0aGlzLnVzZUJsb2NrUGFyYW1zID0gdGhpcy51c2VCbG9ja1BhcmFtcyB8fCBleGlzdGluZy51c2VCbG9ja1BhcmFtczsKCQkgICAgICB9CgkJICAgIH0KCQkgIH0sCgkJICBtYXRjaEV4aXN0aW5nUHJvZ3JhbTogZnVuY3Rpb24gbWF0Y2hFeGlzdGluZ1Byb2dyYW0oY2hpbGQpIHsKCQkgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuY29udGV4dC5lbnZpcm9ubWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKCQkgICAgICB2YXIgZW52aXJvbm1lbnQgPSB0aGlzLmNvbnRleHQuZW52aXJvbm1lbnRzW2ldOwoJCSAgICAgIGlmIChlbnZpcm9ubWVudCAmJiBlbnZpcm9ubWVudC5lcXVhbHMoY2hpbGQpKSB7CgkJICAgICAgICByZXR1cm4gZW52aXJvbm1lbnQ7CgkJICAgICAgfQoJCSAgICB9CgkJICB9LAoKCQkgIHByb2dyYW1FeHByZXNzaW9uOiBmdW5jdGlvbiBwcm9ncmFtRXhwcmVzc2lvbihndWlkKSB7CgkJICAgIHZhciBjaGlsZCA9IHRoaXMuZW52aXJvbm1lbnQuY2hpbGRyZW5bZ3VpZF0sCgkJICAgICAgICBwcm9ncmFtUGFyYW1zID0gW2NoaWxkLmluZGV4LCAnZGF0YScsIGNoaWxkLmJsb2NrUGFyYW1zXTsKCgkJICAgIGlmICh0aGlzLnVzZUJsb2NrUGFyYW1zIHx8IHRoaXMudXNlRGVwdGhzKSB7CgkJICAgICAgcHJvZ3JhbVBhcmFtcy5wdXNoKCdibG9ja1BhcmFtcycpOwoJCSAgICB9CgkJICAgIGlmICh0aGlzLnVzZURlcHRocykgewoJCSAgICAgIHByb2dyYW1QYXJhbXMucHVzaCgnZGVwdGhzJyk7CgkJICAgIH0KCgkJICAgIHJldHVybiAnY29udGFpbmVyLnByb2dyYW0oJyArIHByb2dyYW1QYXJhbXMuam9pbignLCAnKSArICcpJzsKCQkgIH0sCgoJCSAgdXNlUmVnaXN0ZXI6IGZ1bmN0aW9uIHVzZVJlZ2lzdGVyKG5hbWUpIHsKCQkgICAgaWYgKCF0aGlzLnJlZ2lzdGVyc1tuYW1lXSkgewoJCSAgICAgIHRoaXMucmVnaXN0ZXJzW25hbWVdID0gdHJ1ZTsKCQkgICAgICB0aGlzLnJlZ2lzdGVycy5saXN0LnB1c2gobmFtZSk7CgkJICAgIH0KCQkgIH0sCgoJCSAgcHVzaDogZnVuY3Rpb24gcHVzaChleHByKSB7CgkJICAgIGlmICghKGV4cHIgaW5zdGFuY2VvZiBMaXRlcmFsKSkgewoJCSAgICAgIGV4cHIgPSB0aGlzLnNvdXJjZS53cmFwKGV4cHIpOwoJCSAgICB9CgoJCSAgICB0aGlzLmlubGluZVN0YWNrLnB1c2goZXhwcik7CgkJICAgIHJldHVybiBleHByOwoJCSAgfSwKCgkJICBwdXNoU3RhY2tMaXRlcmFsOiBmdW5jdGlvbiBwdXNoU3RhY2tMaXRlcmFsKGl0ZW0pIHsKCQkgICAgdGhpcy5wdXNoKG5ldyBMaXRlcmFsKGl0ZW0pKTsKCQkgIH0sCgoJCSAgcHVzaFNvdXJjZTogZnVuY3Rpb24gcHVzaFNvdXJjZShzb3VyY2UpIHsKCQkgICAgaWYgKHRoaXMucGVuZGluZ0NvbnRlbnQpIHsKCQkgICAgICB0aGlzLnNvdXJjZS5wdXNoKHRoaXMuYXBwZW5kVG9CdWZmZXIodGhpcy5zb3VyY2UucXVvdGVkU3RyaW5nKHRoaXMucGVuZGluZ0NvbnRlbnQpLCB0aGlzLnBlbmRpbmdMb2NhdGlvbikpOwoJCSAgICAgIHRoaXMucGVuZGluZ0NvbnRlbnQgPSB1bmRlZmluZWQ7CgkJICAgIH0KCgkJICAgIGlmIChzb3VyY2UpIHsKCQkgICAgICB0aGlzLnNvdXJjZS5wdXNoKHNvdXJjZSk7CgkJICAgIH0KCQkgIH0sCgoJCSAgcmVwbGFjZVN0YWNrOiBmdW5jdGlvbiByZXBsYWNlU3RhY2soY2FsbGJhY2spIHsKCQkgICAgdmFyIHByZWZpeCA9IFsnKCddLAoJCSAgICAgICAgc3RhY2sgPSB1bmRlZmluZWQsCgkJICAgICAgICBjcmVhdGVkU3RhY2sgPSB1bmRlZmluZWQsCgkJICAgICAgICB1c2VkTGl0ZXJhbCA9IHVuZGVmaW5lZDsKCgkJICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCgkJICAgIGlmICghdGhpcy5pc0lubGluZSgpKSB7CgkJICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24yWydkZWZhdWx0J10oJ3JlcGxhY2VTdGFjayBvbiBub24taW5saW5lJyk7CgkJICAgIH0KCgkJICAgIC8vIFdlIHdhbnQgdG8gbWVyZ2UgdGhlIGlubGluZSBzdGF0ZW1lbnQgaW50byB0aGUgcmVwbGFjZW1lbnQgc3RhdGVtZW50IHZpYSAnLCcKCQkgICAgdmFyIHRvcCA9IHRoaXMucG9wU3RhY2sodHJ1ZSk7CgoJCSAgICBpZiAodG9wIGluc3RhbmNlb2YgTGl0ZXJhbCkgewoJCSAgICAgIC8vIExpdGVyYWxzIGRvIG5vdCBuZWVkIHRvIGJlIGlubGluZWQKCQkgICAgICBzdGFjayA9IFt0b3AudmFsdWVdOwoJCSAgICAgIHByZWZpeCA9IFsnKCcsIHN0YWNrXTsKCQkgICAgICB1c2VkTGl0ZXJhbCA9IHRydWU7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgLy8gR2V0IG9yIGNyZWF0ZSB0aGUgY3VycmVudCBzdGFjayBuYW1lIGZvciB1c2UgYnkgdGhlIGlubGluZQoJCSAgICAgIGNyZWF0ZWRTdGFjayA9IHRydWU7CgkJICAgICAgdmFyIF9uYW1lID0gdGhpcy5pbmNyU3RhY2soKTsKCgkJICAgICAgcHJlZml4ID0gWycoKCcsIHRoaXMucHVzaChfbmFtZSksICcgPSAnLCB0b3AsICcpJ107CgkJICAgICAgc3RhY2sgPSB0aGlzLnRvcFN0YWNrKCk7CgkJICAgIH0KCgkJICAgIHZhciBpdGVtID0gY2FsbGJhY2suY2FsbCh0aGlzLCBzdGFjayk7CgoJCSAgICBpZiAoIXVzZWRMaXRlcmFsKSB7CgkJICAgICAgdGhpcy5wb3BTdGFjaygpOwoJCSAgICB9CgkJICAgIGlmIChjcmVhdGVkU3RhY2spIHsKCQkgICAgICB0aGlzLnN0YWNrU2xvdC0tOwoJCSAgICB9CgkJICAgIHRoaXMucHVzaChwcmVmaXguY29uY2F0KGl0ZW0sICcpJykpOwoJCSAgfSwKCgkJICBpbmNyU3RhY2s6IGZ1bmN0aW9uIGluY3JTdGFjaygpIHsKCQkgICAgdGhpcy5zdGFja1Nsb3QrKzsKCQkgICAgaWYgKHRoaXMuc3RhY2tTbG90ID4gdGhpcy5zdGFja1ZhcnMubGVuZ3RoKSB7CgkJICAgICAgdGhpcy5zdGFja1ZhcnMucHVzaCgnc3RhY2snICsgdGhpcy5zdGFja1Nsb3QpOwoJCSAgICB9CgkJICAgIHJldHVybiB0aGlzLnRvcFN0YWNrTmFtZSgpOwoJCSAgfSwKCQkgIHRvcFN0YWNrTmFtZTogZnVuY3Rpb24gdG9wU3RhY2tOYW1lKCkgewoJCSAgICByZXR1cm4gJ3N0YWNrJyArIHRoaXMuc3RhY2tTbG90OwoJCSAgfSwKCQkgIGZsdXNoSW5saW5lOiBmdW5jdGlvbiBmbHVzaElubGluZSgpIHsKCQkgICAgdmFyIGlubGluZVN0YWNrID0gdGhpcy5pbmxpbmVTdGFjazsKCQkgICAgdGhpcy5pbmxpbmVTdGFjayA9IFtdOwoJCSAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gaW5saW5lU3RhY2subGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKCQkgICAgICB2YXIgZW50cnkgPSBpbmxpbmVTdGFja1tpXTsKCQkgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KCQkgICAgICBpZiAoZW50cnkgaW5zdGFuY2VvZiBMaXRlcmFsKSB7CgkJICAgICAgICB0aGlzLmNvbXBpbGVTdGFjay5wdXNoKGVudHJ5KTsKCQkgICAgICB9IGVsc2UgewoJCSAgICAgICAgdmFyIHN0YWNrID0gdGhpcy5pbmNyU3RhY2soKTsKCQkgICAgICAgIHRoaXMucHVzaFNvdXJjZShbc3RhY2ssICcgPSAnLCBlbnRyeSwgJzsnXSk7CgkJICAgICAgICB0aGlzLmNvbXBpbGVTdGFjay5wdXNoKHN0YWNrKTsKCQkgICAgICB9CgkJICAgIH0KCQkgIH0sCgkJICBpc0lubGluZTogZnVuY3Rpb24gaXNJbmxpbmUoKSB7CgkJICAgIHJldHVybiB0aGlzLmlubGluZVN0YWNrLmxlbmd0aDsKCQkgIH0sCgoJCSAgcG9wU3RhY2s6IGZ1bmN0aW9uIHBvcFN0YWNrKHdyYXBwZWQpIHsKCQkgICAgdmFyIGlubGluZSA9IHRoaXMuaXNJbmxpbmUoKSwKCQkgICAgICAgIGl0ZW0gPSAoaW5saW5lID8gdGhpcy5pbmxpbmVTdGFjayA6IHRoaXMuY29tcGlsZVN0YWNrKS5wb3AoKTsKCgkJICAgIGlmICghd3JhcHBlZCAmJiBpdGVtIGluc3RhbmNlb2YgTGl0ZXJhbCkgewoJCSAgICAgIHJldHVybiBpdGVtLnZhbHVlOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIGlmICghaW5saW5lKSB7CgkJICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoJCSAgICAgICAgaWYgKCF0aGlzLnN0YWNrU2xvdCkgewoJCSAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbjJbJ2RlZmF1bHQnXSgnSW52YWxpZCBzdGFjayBwb3AnKTsKCQkgICAgICAgIH0KCQkgICAgICAgIHRoaXMuc3RhY2tTbG90LS07CgkJICAgICAgfQoJCSAgICAgIHJldHVybiBpdGVtOwoJCSAgICB9CgkJICB9LAoKCQkgIHRvcFN0YWNrOiBmdW5jdGlvbiB0b3BTdGFjaygpIHsKCQkgICAgdmFyIHN0YWNrID0gdGhpcy5pc0lubGluZSgpID8gdGhpcy5pbmxpbmVTdGFjayA6IHRoaXMuY29tcGlsZVN0YWNrLAoJCSAgICAgICAgaXRlbSA9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdOwoKCQkgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCgkJICAgIGlmIChpdGVtIGluc3RhbmNlb2YgTGl0ZXJhbCkgewoJCSAgICAgIHJldHVybiBpdGVtLnZhbHVlOwoJCSAgICB9IGVsc2UgewoJCSAgICAgIHJldHVybiBpdGVtOwoJCSAgICB9CgkJICB9LAoKCQkgIGNvbnRleHROYW1lOiBmdW5jdGlvbiBjb250ZXh0TmFtZShjb250ZXh0KSB7CgkJICAgIGlmICh0aGlzLnVzZURlcHRocyAmJiBjb250ZXh0KSB7CgkJICAgICAgcmV0dXJuICdkZXB0aHNbJyArIGNvbnRleHQgKyAnXSc7CgkJICAgIH0gZWxzZSB7CgkJICAgICAgcmV0dXJuICdkZXB0aCcgKyBjb250ZXh0OwoJCSAgICB9CgkJICB9LAoKCQkgIHF1b3RlZFN0cmluZzogZnVuY3Rpb24gcXVvdGVkU3RyaW5nKHN0cikgewoJCSAgICByZXR1cm4gdGhpcy5zb3VyY2UucXVvdGVkU3RyaW5nKHN0cik7CgkJICB9LAoKCQkgIG9iamVjdExpdGVyYWw6IGZ1bmN0aW9uIG9iamVjdExpdGVyYWwob2JqKSB7CgkJICAgIHJldHVybiB0aGlzLnNvdXJjZS5vYmplY3RMaXRlcmFsKG9iaik7CgkJICB9LAoKCQkgIGFsaWFzYWJsZTogZnVuY3Rpb24gYWxpYXNhYmxlKG5hbWUpIHsKCQkgICAgdmFyIHJldCA9IHRoaXMuYWxpYXNlc1tuYW1lXTsKCQkgICAgaWYgKHJldCkgewoJCSAgICAgIHJldC5yZWZlcmVuY2VDb3VudCsrOwoJCSAgICAgIHJldHVybiByZXQ7CgkJICAgIH0KCgkJICAgIHJldCA9IHRoaXMuYWxpYXNlc1tuYW1lXSA9IHRoaXMuc291cmNlLndyYXAobmFtZSk7CgkJICAgIHJldC5hbGlhc2FibGUgPSB0cnVlOwoJCSAgICByZXQucmVmZXJlbmNlQ291bnQgPSAxOwoKCQkgICAgcmV0dXJuIHJldDsKCQkgIH0sCgoJCSAgc2V0dXBIZWxwZXI6IGZ1bmN0aW9uIHNldHVwSGVscGVyKHBhcmFtU2l6ZSwgbmFtZSwgYmxvY2tIZWxwZXIpIHsKCQkgICAgdmFyIHBhcmFtcyA9IFtdLAoJCSAgICAgICAgcGFyYW1zSW5pdCA9IHRoaXMuc2V0dXBIZWxwZXJBcmdzKG5hbWUsIHBhcmFtU2l6ZSwgcGFyYW1zLCBibG9ja0hlbHBlcik7CgkJICAgIHZhciBmb3VuZEhlbHBlciA9IHRoaXMubmFtZUxvb2t1cCgnaGVscGVycycsIG5hbWUsICdoZWxwZXInKSwKCQkgICAgICAgIGNhbGxDb250ZXh0ID0gdGhpcy5hbGlhc2FibGUodGhpcy5jb250ZXh0TmFtZSgwKSArICcgIT0gbnVsbCA/ICcgKyB0aGlzLmNvbnRleHROYW1lKDApICsgJyA6IHt9Jyk7CgoJCSAgICByZXR1cm4gewoJCSAgICAgIHBhcmFtczogcGFyYW1zLAoJCSAgICAgIHBhcmFtc0luaXQ6IHBhcmFtc0luaXQsCgkJICAgICAgbmFtZTogZm91bmRIZWxwZXIsCgkJICAgICAgY2FsbFBhcmFtczogW2NhbGxDb250ZXh0XS5jb25jYXQocGFyYW1zKQoJCSAgICB9OwoJCSAgfSwKCgkJICBzZXR1cFBhcmFtczogZnVuY3Rpb24gc2V0dXBQYXJhbXMoaGVscGVyLCBwYXJhbVNpemUsIHBhcmFtcykgewoJCSAgICB2YXIgb3B0aW9ucyA9IHt9LAoJCSAgICAgICAgY29udGV4dHMgPSBbXSwKCQkgICAgICAgIHR5cGVzID0gW10sCgkJICAgICAgICBpZHMgPSBbXSwKCQkgICAgICAgIG9iamVjdEFyZ3MgPSAhcGFyYW1zLAoJCSAgICAgICAgcGFyYW0gPSB1bmRlZmluZWQ7CgoJCSAgICBpZiAob2JqZWN0QXJncykgewoJCSAgICAgIHBhcmFtcyA9IFtdOwoJCSAgICB9CgoJCSAgICBvcHRpb25zLm5hbWUgPSB0aGlzLnF1b3RlZFN0cmluZyhoZWxwZXIpOwoJCSAgICBvcHRpb25zLmhhc2ggPSB0aGlzLnBvcFN0YWNrKCk7CgoJCSAgICBpZiAodGhpcy50cmFja0lkcykgewoJCSAgICAgIG9wdGlvbnMuaGFzaElkcyA9IHRoaXMucG9wU3RhY2soKTsKCQkgICAgfQoJCSAgICBpZiAodGhpcy5zdHJpbmdQYXJhbXMpIHsKCQkgICAgICBvcHRpb25zLmhhc2hUeXBlcyA9IHRoaXMucG9wU3RhY2soKTsKCQkgICAgICBvcHRpb25zLmhhc2hDb250ZXh0cyA9IHRoaXMucG9wU3RhY2soKTsKCQkgICAgfQoKCQkgICAgdmFyIGludmVyc2UgPSB0aGlzLnBvcFN0YWNrKCksCgkJICAgICAgICBwcm9ncmFtID0gdGhpcy5wb3BTdGFjaygpOwoKCQkgICAgLy8gQXZvaWQgc2V0dGluZyBmbiBhbmQgaW52ZXJzZSBpZiBuZWl0aGVyIGFyZSBzZXQuIFRoaXMgYWxsb3dzCgkJICAgIC8vIGhlbHBlcnMgdG8gZG8gYSBjaGVjayBmb3IgYGlmIChvcHRpb25zLmZuKWAKCQkgICAgaWYgKHByb2dyYW0gfHwgaW52ZXJzZSkgewoJCSAgICAgIG9wdGlvbnMuZm4gPSBwcm9ncmFtIHx8ICdjb250YWluZXIubm9vcCc7CgkJICAgICAgb3B0aW9ucy5pbnZlcnNlID0gaW52ZXJzZSB8fCAnY29udGFpbmVyLm5vb3AnOwoJCSAgICB9CgoJCSAgICAvLyBUaGUgcGFyYW1ldGVycyBnbyBvbiB0byB0aGUgc3RhY2sgaW4gb3JkZXIgKG1ha2luZyBzdXJlIHRoYXQgdGhleSBhcmUgZXZhbHVhdGVkIGluIG9yZGVyKQoJCSAgICAvLyBzbyB3ZSBuZWVkIHRvIHBvcCB0aGVtIG9mZiB0aGUgc3RhY2sgaW4gcmV2ZXJzZSBvcmRlcgoJCSAgICB2YXIgaSA9IHBhcmFtU2l6ZTsKCQkgICAgd2hpbGUgKGktLSkgewoJCSAgICAgIHBhcmFtID0gdGhpcy5wb3BTdGFjaygpOwoJCSAgICAgIHBhcmFtc1tpXSA9IHBhcmFtOwoKCQkgICAgICBpZiAodGhpcy50cmFja0lkcykgewoJCSAgICAgICAgaWRzW2ldID0gdGhpcy5wb3BTdGFjaygpOwoJCSAgICAgIH0KCQkgICAgICBpZiAodGhpcy5zdHJpbmdQYXJhbXMpIHsKCQkgICAgICAgIHR5cGVzW2ldID0gdGhpcy5wb3BTdGFjaygpOwoJCSAgICAgICAgY29udGV4dHNbaV0gPSB0aGlzLnBvcFN0YWNrKCk7CgkJICAgICAgfQoJCSAgICB9CgoJCSAgICBpZiAob2JqZWN0QXJncykgewoJCSAgICAgIG9wdGlvbnMuYXJncyA9IHRoaXMuc291cmNlLmdlbmVyYXRlQXJyYXkocGFyYW1zKTsKCQkgICAgfQoKCQkgICAgaWYgKHRoaXMudHJhY2tJZHMpIHsKCQkgICAgICBvcHRpb25zLmlkcyA9IHRoaXMuc291cmNlLmdlbmVyYXRlQXJyYXkoaWRzKTsKCQkgICAgfQoJCSAgICBpZiAodGhpcy5zdHJpbmdQYXJhbXMpIHsKCQkgICAgICBvcHRpb25zLnR5cGVzID0gdGhpcy5zb3VyY2UuZ2VuZXJhdGVBcnJheSh0eXBlcyk7CgkJICAgICAgb3B0aW9ucy5jb250ZXh0cyA9IHRoaXMuc291cmNlLmdlbmVyYXRlQXJyYXkoY29udGV4dHMpOwoJCSAgICB9CgoJCSAgICBpZiAodGhpcy5vcHRpb25zLmRhdGEpIHsKCQkgICAgICBvcHRpb25zLmRhdGEgPSAnZGF0YSc7CgkJICAgIH0KCQkgICAgaWYgKHRoaXMudXNlQmxvY2tQYXJhbXMpIHsKCQkgICAgICBvcHRpb25zLmJsb2NrUGFyYW1zID0gJ2Jsb2NrUGFyYW1zJzsKCQkgICAgfQoJCSAgICByZXR1cm4gb3B0aW9uczsKCQkgIH0sCgoJCSAgc2V0dXBIZWxwZXJBcmdzOiBmdW5jdGlvbiBzZXR1cEhlbHBlckFyZ3MoaGVscGVyLCBwYXJhbVNpemUsIHBhcmFtcywgdXNlUmVnaXN0ZXIpIHsKCQkgICAgdmFyIG9wdGlvbnMgPSB0aGlzLnNldHVwUGFyYW1zKGhlbHBlciwgcGFyYW1TaXplLCBwYXJhbXMpOwoJCSAgICBvcHRpb25zID0gdGhpcy5vYmplY3RMaXRlcmFsKG9wdGlvbnMpOwoJCSAgICBpZiAodXNlUmVnaXN0ZXIpIHsKCQkgICAgICB0aGlzLnVzZVJlZ2lzdGVyKCdvcHRpb25zJyk7CgkJICAgICAgcGFyYW1zLnB1c2goJ29wdGlvbnMnKTsKCQkgICAgICByZXR1cm4gWydvcHRpb25zPScsIG9wdGlvbnNdOwoJCSAgICB9IGVsc2UgaWYgKHBhcmFtcykgewoJCSAgICAgIHBhcmFtcy5wdXNoKG9wdGlvbnMpOwoJCSAgICAgIHJldHVybiAnJzsKCQkgICAgfSBlbHNlIHsKCQkgICAgICByZXR1cm4gb3B0aW9uczsKCQkgICAgfQoJCSAgfQoJCX07CgoJCShmdW5jdGlvbiAoKSB7CgkJICB2YXIgcmVzZXJ2ZWRXb3JkcyA9ICgnYnJlYWsgZWxzZSBuZXcgdmFyJyArICcgY2FzZSBmaW5hbGx5IHJldHVybiB2b2lkJyArICcgY2F0Y2ggZm9yIHN3aXRjaCB3aGlsZScgKyAnIGNvbnRpbnVlIGZ1bmN0aW9uIHRoaXMgd2l0aCcgKyAnIGRlZmF1bHQgaWYgdGhyb3cnICsgJyBkZWxldGUgaW4gdHJ5JyArICcgZG8gaW5zdGFuY2VvZiB0eXBlb2YnICsgJyBhYnN0cmFjdCBlbnVtIGludCBzaG9ydCcgKyAnIGJvb2xlYW4gZXhwb3J0IGludGVyZmFjZSBzdGF0aWMnICsgJyBieXRlIGV4dGVuZHMgbG9uZyBzdXBlcicgKyAnIGNoYXIgZmluYWwgbmF0aXZlIHN5bmNocm9uaXplZCcgKyAnIGNsYXNzIGZsb2F0IHBhY2thZ2UgdGhyb3dzJyArICcgY29uc3QgZ290byBwcml2YXRlIHRyYW5zaWVudCcgKyAnIGRlYnVnZ2VyIGltcGxlbWVudHMgcHJvdGVjdGVkIHZvbGF0aWxlJyArICcgZG91YmxlIGltcG9ydCBwdWJsaWMgbGV0IHlpZWxkIGF3YWl0JyArICcgbnVsbCB0cnVlIGZhbHNlJykuc3BsaXQoJyAnKTsKCgkJICB2YXIgY29tcGlsZXJXb3JkcyA9IEphdmFTY3JpcHRDb21waWxlci5SRVNFUlZFRF9XT1JEUyA9IHt9OwoKCQkgIGZvciAodmFyIGkgPSAwLCBsID0gcmVzZXJ2ZWRXb3Jkcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKCQkgICAgY29tcGlsZXJXb3Jkc1tyZXNlcnZlZFdvcmRzW2ldXSA9IHRydWU7CgkJICB9CgkJfSkoKTsKCgkJSmF2YVNjcmlwdENvbXBpbGVyLmlzVmFsaWRKYXZhU2NyaXB0VmFyaWFibGVOYW1lID0gZnVuY3Rpb24gKG5hbWUpIHsKCQkgIHJldHVybiAhSmF2YVNjcmlwdENvbXBpbGVyLlJFU0VSVkVEX1dPUkRTW25hbWVdICYmIC9eW2EtekEtWl8kXVswLTlhLXpBLVpfJF0qJC8udGVzdChuYW1lKTsKCQl9OwoKCQlmdW5jdGlvbiBzdHJpY3RMb29rdXAocmVxdWlyZVRlcm1pbmFsLCBjb21waWxlciwgcGFydHMsIHR5cGUpIHsKCQkgIHZhciBzdGFjayA9IGNvbXBpbGVyLnBvcFN0YWNrKCksCgkJICAgICAgaSA9IDAsCgkJICAgICAgbGVuID0gcGFydHMubGVuZ3RoOwoJCSAgaWYgKHJlcXVpcmVUZXJtaW5hbCkgewoJCSAgICBsZW4tLTsKCQkgIH0KCgkJICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7CgkJICAgIHN0YWNrID0gY29tcGlsZXIubmFtZUxvb2t1cChzdGFjaywgcGFydHNbaV0sIHR5cGUpOwoJCSAgfQoKCQkgIGlmIChyZXF1aXJlVGVybWluYWwpIHsKCQkgICAgcmV0dXJuIFtjb21waWxlci5hbGlhc2FibGUoJ2NvbnRhaW5lci5zdHJpY3QnKSwgJygnLCBzdGFjaywgJywgJywgY29tcGlsZXIucXVvdGVkU3RyaW5nKHBhcnRzW2ldKSwgJyknXTsKCQkgIH0gZWxzZSB7CgkJICAgIHJldHVybiBzdGFjazsKCQkgIH0KCQl9CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IEphdmFTY3JpcHRDb21waWxlcjsKCQltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9LAoJLyogMzIgKi8KCS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCQkvKiBnbG9iYWwgZGVmaW5lICovCgkJJ3VzZSBzdHJpY3QnOwoKCQlleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCQl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKCgkJdmFyIFNvdXJjZU5vZGUgPSB1bmRlZmluZWQ7CgoJCXRyeSB7CgkJICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoJCSAgaWYgKGZhbHNlKSB7CgkJICAgIC8vIFdlIGRvbid0IHN1cHBvcnQgdGhpcyBpbiBBTUQgZW52aXJvbm1lbnRzLiBGb3IgdGhlc2UgZW52aXJvbm1lbnRzLCB3ZSBhc3VzbWUgdGhhdAoJCSAgICAvLyB0aGV5IGFyZSBydW5uaW5nIG9uIHRoZSBicm93c2VyIGFuZCB0aHVzIGhhdmUgbm8gbmVlZCBmb3IgdGhlIHNvdXJjZS1tYXAgbGlicmFyeS4KCQkgICAgdmFyIFNvdXJjZU1hcCA9IHJlcXVpcmUoJ3NvdXJjZS1tYXAnKTsKCQkgICAgU291cmNlTm9kZSA9IFNvdXJjZU1hcC5Tb3VyY2VOb2RlOwoJCSAgfQoJCX0gY2F0Y2ggKGVycikge30KCQkvKiBOT1AgKi8KCgkJLyogaXN0YW5idWwgaWdub3JlIGlmOiB0ZXN0ZWQgYnV0IG5vdCBjb3ZlcmVkIGluIGlzdGFuYnVsIGR1ZSB0byBkaXN0IGJ1aWxkICAqLwoJCWlmICghU291cmNlTm9kZSkgewoJCSAgU291cmNlTm9kZSA9IGZ1bmN0aW9uIChsaW5lLCBjb2x1bW4sIHNyY0ZpbGUsIGNodW5rcykgewoJCSAgICB0aGlzLnNyYyA9ICcnOwoJCSAgICBpZiAoY2h1bmtzKSB7CgkJICAgICAgdGhpcy5hZGQoY2h1bmtzKTsKCQkgICAgfQoJCSAgfTsKCQkgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCgkJICBTb3VyY2VOb2RlLnByb3RvdHlwZSA9IHsKCQkgICAgYWRkOiBmdW5jdGlvbiBhZGQoY2h1bmtzKSB7CgkJICAgICAgaWYgKF91dGlscy5pc0FycmF5KGNodW5rcykpIHsKCQkgICAgICAgIGNodW5rcyA9IGNodW5rcy5qb2luKCcnKTsKCQkgICAgICB9CgkJICAgICAgdGhpcy5zcmMgKz0gY2h1bmtzOwoJCSAgICB9LAoJCSAgICBwcmVwZW5kOiBmdW5jdGlvbiBwcmVwZW5kKGNodW5rcykgewoJCSAgICAgIGlmIChfdXRpbHMuaXNBcnJheShjaHVua3MpKSB7CgkJICAgICAgICBjaHVua3MgPSBjaHVua3Muam9pbignJyk7CgkJICAgICAgfQoJCSAgICAgIHRoaXMuc3JjID0gY2h1bmtzICsgdGhpcy5zcmM7CgkJICAgIH0sCgkJICAgIHRvU3RyaW5nV2l0aFNvdXJjZU1hcDogZnVuY3Rpb24gdG9TdHJpbmdXaXRoU291cmNlTWFwKCkgewoJCSAgICAgIHJldHVybiB7IGNvZGU6IHRoaXMudG9TdHJpbmcoKSB9OwoJCSAgICB9LAoJCSAgICB0b1N0cmluZzogZnVuY3Rpb24gdG9TdHJpbmcoKSB7CgkJICAgICAgcmV0dXJuIHRoaXMuc3JjOwoJCSAgICB9CgkJICB9OwoJCX0KCgkJZnVuY3Rpb24gY2FzdENodW5rKGNodW5rLCBjb2RlR2VuLCBsb2MpIHsKCQkgIGlmIChfdXRpbHMuaXNBcnJheShjaHVuaykpIHsKCQkgICAgdmFyIHJldCA9IFtdOwoKCQkgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNodW5rLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CgkJICAgICAgcmV0LnB1c2goY29kZUdlbi53cmFwKGNodW5rW2ldLCBsb2MpKTsKCQkgICAgfQoJCSAgICByZXR1cm4gcmV0OwoJCSAgfSBlbHNlIGlmICh0eXBlb2YgY2h1bmsgPT09ICdib29sZWFuJyB8fCB0eXBlb2YgY2h1bmsgPT09ICdudW1iZXInKSB7CgkJICAgIC8vIEhhbmRsZSBwcmltaXRpdmVzIHRoYXQgdGhlIFNvdXJjZU5vZGUgd2lsbCB0aHJvdyB1cCBvbgoJCSAgICByZXR1cm4gY2h1bmsgKyAnJzsKCQkgIH0KCQkgIHJldHVybiBjaHVuazsKCQl9CgoJCWZ1bmN0aW9uIENvZGVHZW4oc3JjRmlsZSkgewoJCSAgdGhpcy5zcmNGaWxlID0gc3JjRmlsZTsKCQkgIHRoaXMuc291cmNlID0gW107CgkJfQoKCQlDb2RlR2VuLnByb3RvdHlwZSA9IHsKCQkgIGlzRW1wdHk6IGZ1bmN0aW9uIGlzRW1wdHkoKSB7CgkJICAgIHJldHVybiAhdGhpcy5zb3VyY2UubGVuZ3RoOwoJCSAgfSwKCQkgIHByZXBlbmQ6IGZ1bmN0aW9uIHByZXBlbmQoc291cmNlLCBsb2MpIHsKCQkgICAgdGhpcy5zb3VyY2UudW5zaGlmdCh0aGlzLndyYXAoc291cmNlLCBsb2MpKTsKCQkgIH0sCgkJICBwdXNoOiBmdW5jdGlvbiBwdXNoKHNvdXJjZSwgbG9jKSB7CgkJICAgIHRoaXMuc291cmNlLnB1c2godGhpcy53cmFwKHNvdXJjZSwgbG9jKSk7CgkJICB9LAoKCQkgIG1lcmdlOiBmdW5jdGlvbiBtZXJnZSgpIHsKCQkgICAgdmFyIHNvdXJjZSA9IHRoaXMuZW1wdHkoKTsKCQkgICAgdGhpcy5lYWNoKGZ1bmN0aW9uIChsaW5lKSB7CgkJICAgICAgc291cmNlLmFkZChbJyAgJywgbGluZSwgJ1xuJ10pOwoJCSAgICB9KTsKCQkgICAgcmV0dXJuIHNvdXJjZTsKCQkgIH0sCgoJCSAgZWFjaDogZnVuY3Rpb24gZWFjaChpdGVyKSB7CgkJICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLnNvdXJjZS5sZW5ndGg7IGkgPCBsZW47IGkrKykgewoJCSAgICAgIGl0ZXIodGhpcy5zb3VyY2VbaV0pOwoJCSAgICB9CgkJICB9LAoKCQkgIGVtcHR5OiBmdW5jdGlvbiBlbXB0eSgpIHsKCQkgICAgdmFyIGxvYyA9IHRoaXMuY3VycmVudExvY2F0aW9uIHx8IHsgc3RhcnQ6IHt9IH07CgkJICAgIHJldHVybiBuZXcgU291cmNlTm9kZShsb2Muc3RhcnQubGluZSwgbG9jLnN0YXJ0LmNvbHVtbiwgdGhpcy5zcmNGaWxlKTsKCQkgIH0sCgkJICB3cmFwOiBmdW5jdGlvbiB3cmFwKGNodW5rKSB7CgkJICAgIHZhciBsb2MgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyB0aGlzLmN1cnJlbnRMb2NhdGlvbiB8fCB7IHN0YXJ0OiB7fSB9IDogYXJndW1lbnRzWzFdOwoKCQkgICAgaWYgKGNodW5rIGluc3RhbmNlb2YgU291cmNlTm9kZSkgewoJCSAgICAgIHJldHVybiBjaHVuazsKCQkgICAgfQoKCQkgICAgY2h1bmsgPSBjYXN0Q2h1bmsoY2h1bmssIHRoaXMsIGxvYyk7CgoJCSAgICByZXR1cm4gbmV3IFNvdXJjZU5vZGUobG9jLnN0YXJ0LmxpbmUsIGxvYy5zdGFydC5jb2x1bW4sIHRoaXMuc3JjRmlsZSwgY2h1bmspOwoJCSAgfSwKCgkJICBmdW5jdGlvbkNhbGw6IGZ1bmN0aW9uIGZ1bmN0aW9uQ2FsbChmbiwgdHlwZSwgcGFyYW1zKSB7CgkJICAgIHBhcmFtcyA9IHRoaXMuZ2VuZXJhdGVMaXN0KHBhcmFtcyk7CgkJICAgIHJldHVybiB0aGlzLndyYXAoW2ZuLCB0eXBlID8gJy4nICsgdHlwZSArICcoJyA6ICcoJywgcGFyYW1zLCAnKSddKTsKCQkgIH0sCgoJCSAgcXVvdGVkU3RyaW5nOiBmdW5jdGlvbiBxdW90ZWRTdHJpbmcoc3RyKSB7CgkJICAgIHJldHVybiAnIicgKyAoc3RyICsgJycpLnJlcGxhY2UoL1xcL2csICdcXFxcJykucmVwbGFjZSgvIi9nLCAnXFwiJykucmVwbGFjZSgvXG4vZywgJ1xcbicpLnJlcGxhY2UoL1xyL2csICdcXHInKS5yZXBsYWNlKC9cdTIwMjgvZywgJ1xcdTIwMjgnKSAvLyBQZXIgRWNtYS0yNjIgNy4zICsgNy44LjQKCQkgICAgLnJlcGxhY2UoL1x1MjAyOS9nLCAnXFx1MjAyOScpICsgJyInOwoJCSAgfSwKCgkJICBvYmplY3RMaXRlcmFsOiBmdW5jdGlvbiBvYmplY3RMaXRlcmFsKG9iaikgewoJCSAgICB2YXIgcGFpcnMgPSBbXTsKCgkJICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKCQkgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHsKCQkgICAgICAgIHZhciB2YWx1ZSA9IGNhc3RDaHVuayhvYmpba2V5XSwgdGhpcyk7CgkJICAgICAgICBpZiAodmFsdWUgIT09ICd1bmRlZmluZWQnKSB7CgkJICAgICAgICAgIHBhaXJzLnB1c2goW3RoaXMucXVvdGVkU3RyaW5nKGtleSksICc6JywgdmFsdWVdKTsKCQkgICAgICAgIH0KCQkgICAgICB9CgkJICAgIH0KCgkJICAgIHZhciByZXQgPSB0aGlzLmdlbmVyYXRlTGlzdChwYWlycyk7CgkJICAgIHJldC5wcmVwZW5kKCd7Jyk7CgkJICAgIHJldC5hZGQoJ30nKTsKCQkgICAgcmV0dXJuIHJldDsKCQkgIH0sCgoJCSAgZ2VuZXJhdGVMaXN0OiBmdW5jdGlvbiBnZW5lcmF0ZUxpc3QoZW50cmllcykgewoJCSAgICB2YXIgcmV0ID0gdGhpcy5lbXB0eSgpOwoKCQkgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGVudHJpZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKCQkgICAgICBpZiAoaSkgewoJCSAgICAgICAgcmV0LmFkZCgnLCcpOwoJCSAgICAgIH0KCgkJICAgICAgcmV0LmFkZChjYXN0Q2h1bmsoZW50cmllc1tpXSwgdGhpcykpOwoJCSAgICB9CgoJCSAgICByZXR1cm4gcmV0OwoJCSAgfSwKCgkJICBnZW5lcmF0ZUFycmF5OiBmdW5jdGlvbiBnZW5lcmF0ZUFycmF5KGVudHJpZXMpIHsKCQkgICAgdmFyIHJldCA9IHRoaXMuZ2VuZXJhdGVMaXN0KGVudHJpZXMpOwoJCSAgICByZXQucHJlcGVuZCgnWycpOwoJCSAgICByZXQuYWRkKCddJyk7CgoJCSAgICByZXR1cm4gcmV0OwoJCSAgfQoJCX07CgoJCWV4cG9ydHNbJ2RlZmF1bHQnXSA9IENvZGVHZW47CgkJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfQoJLyoqKioqKi8gXSkKCX0pOwoJOwoKLyoqKi8gfSwKLyogNiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187J3VzZSBzdHJpY3QnOwoKCSEoX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyA9IFtfX3dlYnBhY2tfcmVxdWlyZV9fKDcpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpXSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSBmdW5jdGlvbiAoXywgQ29va2llKSB7CgoJICB2YXIgU0VDVVJFRF9DT09LSUUgPSAvXmh0dHBzLy50ZXN0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKTsKCgkgIHJldHVybiB7CgkgICAgc2V0Q29va2llOiBmdW5jdGlvbiBzZXRDb29raWUobmFtZSwgdmFsdWUsIG9wdGlvbnMpIHsKCSAgICAgIENvb2tpZS5zZXQobmFtZSwgdmFsdWUsIF8uZGVmYXVsdHMob3B0aW9ucyB8fCB7fSwgewoJICAgICAgICBzZWN1cmU6IFNFQ1VSRURfQ09PS0lFLAoJICAgICAgICBwYXRoOiAnLycKCSAgICAgIH0pKTsKCSAgICB9LAoKCSAgICBnZXRDb29raWU6IGZ1bmN0aW9uIGdldENvb2tpZSgpIHsKCSAgICAgIHJldHVybiBDb29raWUuZ2V0LmFwcGx5KENvb2tpZSwgYXJndW1lbnRzKTsKCSAgICB9LAoKCSAgICByZW1vdmVDb29raWU6IGZ1bmN0aW9uIHJlbW92ZUNvb2tpZSgpIHsKCSAgICAgIHJldHVybiBDb29raWUucmVtb3ZlLmFwcGx5KENvb2tpZSwgYXJndW1lbnRzKTsKCSAgICB9CgkgIH07Cgl9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7CgovKioqLyB9LAovKiA3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsndXNlIHN0cmljdCc7CgoJLyogZXNsaW50IG9rdGEvZW5mb3JjZS1yZXF1aXJlanMtbmFtZXM6IDAsIG9rdGEvbm8tc3BlY2lmaWMtbWV0aG9kczogMCwgb2t0YS9uby1zcGVjaWZpYy1tb2R1bGVzOiAwICovCgkhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbX193ZWJwYWNrX3JlcXVpcmVfXyg4KSwgX193ZWJwYWNrX3JlcXVpcmVfXyg1KV0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24gKHVuZGVyc2NvcmUsIEhhbmRsZWJhcnMpIHsKCgkgIHZhciBfID0gdW5kZXJzY29yZS5ub0NvbmZsaWN0KCk7CgoJICBfLm1peGluKHsKCgkgICAgcmVzdWx0Q3R4OiBmdW5jdGlvbiByZXN1bHRDdHgob2JqZWN0LCBwcm9wZXJ0eSwgY29udGV4dCwgZGVmYXVsdFZhbHVlKSB7CgkgICAgICB2YXIgdmFsdWUgPSBfLmlzT2JqZWN0KG9iamVjdCkgPyBvYmplY3RbcHJvcGVydHldIDogdm9pZCAwOwoJICAgICAgaWYgKF8uaXNGdW5jdGlvbih2YWx1ZSkpIHsKCSAgICAgICAgdmFsdWUgPSB2YWx1ZS5jYWxsKGNvbnRleHQgfHwgb2JqZWN0KTsKCSAgICAgIH0KCSAgICAgIGlmICh2YWx1ZSkgewoJICAgICAgICByZXR1cm4gdmFsdWU7CgkgICAgICB9IGVsc2UgewoJICAgICAgICByZXR1cm4gIV8uaXNVbmRlZmluZWQoZGVmYXVsdFZhbHVlKSA/IGRlZmF1bHRWYWx1ZSA6IHZhbHVlOwoJICAgICAgfQoJICAgIH0sCgoJICAgIGlzSW50ZWdlcjogZnVuY3Rpb24gaXNJbnRlZ2VyKHgpIHsKCSAgICAgIHJldHVybiBfLmlzTnVtYmVyKHgpICYmIHggJSAxID09PSAwOwoJICAgIH0sCgoJICAgIHRlbXBsYXRlOiBmdW5jdGlvbiB0ZW1wbGF0ZShzb3VyY2UsIGRhdGEpIHsKCSAgICAgIHZhciB0ZW1wbGF0ZSA9IEhhbmRsZWJhcnMuY29tcGlsZShzb3VyY2UpOwoJICAgICAgcmV0dXJuIGRhdGEgPyB0ZW1wbGF0ZShkYXRhKSA6IGZ1bmN0aW9uIChkYXRhKSB7CgkgICAgICAgIHJldHVybiB0ZW1wbGF0ZShkYXRhKTsKCSAgICAgIH07CgkgICAgfQoKCSAgfSk7CgoJICByZXR1cm4gXzsKCX0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTsKCi8qKiovIH0sCi8qIDggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8vICAgICBVbmRlcnNjb3JlLmpzIDEuOC4zCgkvLyAgICAgaHR0cDovL3VuZGVyc2NvcmVqcy5vcmcKCS8vICAgICAoYykgMjAwOS0yMDE1IEplcmVteSBBc2hrZW5hcywgRG9jdW1lbnRDbG91ZCBhbmQgSW52ZXN0aWdhdGl2ZSBSZXBvcnRlcnMgJiBFZGl0b3JzCgkvLyAgICAgVW5kZXJzY29yZSBtYXkgYmUgZnJlZWx5IGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4KCgkoZnVuY3Rpb24oKSB7CgoJICAvLyBCYXNlbGluZSBzZXR1cAoJICAvLyAtLS0tLS0tLS0tLS0tLQoKCSAgLy8gRXN0YWJsaXNoIHRoZSByb290IG9iamVjdCwgYHdpbmRvd2AgaW4gdGhlIGJyb3dzZXIsIG9yIGBleHBvcnRzYCBvbiB0aGUgc2VydmVyLgoJICB2YXIgcm9vdCA9IHRoaXM7CgoJICAvLyBTYXZlIHRoZSBwcmV2aW91cyB2YWx1ZSBvZiB0aGUgYF9gIHZhcmlhYmxlLgoJICB2YXIgcHJldmlvdXNVbmRlcnNjb3JlID0gcm9vdC5fOwoKCSAgLy8gU2F2ZSBieXRlcyBpbiB0aGUgbWluaWZpZWQgKGJ1dCBub3QgZ3ppcHBlZCkgdmVyc2lvbjoKCSAgdmFyIEFycmF5UHJvdG8gPSBBcnJheS5wcm90b3R5cGUsIE9ialByb3RvID0gT2JqZWN0LnByb3RvdHlwZSwgRnVuY1Byb3RvID0gRnVuY3Rpb24ucHJvdG90eXBlOwoKCSAgLy8gQ3JlYXRlIHF1aWNrIHJlZmVyZW5jZSB2YXJpYWJsZXMgZm9yIHNwZWVkIGFjY2VzcyB0byBjb3JlIHByb3RvdHlwZXMuCgkgIHZhcgoJICAgIHB1c2ggICAgICAgICAgICAgPSBBcnJheVByb3RvLnB1c2gsCgkgICAgc2xpY2UgICAgICAgICAgICA9IEFycmF5UHJvdG8uc2xpY2UsCgkgICAgdG9TdHJpbmcgICAgICAgICA9IE9ialByb3RvLnRvU3RyaW5nLAoJICAgIGhhc093blByb3BlcnR5ICAgPSBPYmpQcm90by5oYXNPd25Qcm9wZXJ0eTsKCgkgIC8vIEFsbCAqKkVDTUFTY3JpcHQgNSoqIG5hdGl2ZSBmdW5jdGlvbiBpbXBsZW1lbnRhdGlvbnMgdGhhdCB3ZSBob3BlIHRvIHVzZQoJICAvLyBhcmUgZGVjbGFyZWQgaGVyZS4KCSAgdmFyCgkgICAgbmF0aXZlSXNBcnJheSAgICAgID0gQXJyYXkuaXNBcnJheSwKCSAgICBuYXRpdmVLZXlzICAgICAgICAgPSBPYmplY3Qua2V5cywKCSAgICBuYXRpdmVCaW5kICAgICAgICAgPSBGdW5jUHJvdG8uYmluZCwKCSAgICBuYXRpdmVDcmVhdGUgICAgICAgPSBPYmplY3QuY3JlYXRlOwoKCSAgLy8gTmFrZWQgZnVuY3Rpb24gcmVmZXJlbmNlIGZvciBzdXJyb2dhdGUtcHJvdG90eXBlLXN3YXBwaW5nLgoJICB2YXIgQ3RvciA9IGZ1bmN0aW9uKCl7fTsKCgkgIC8vIENyZWF0ZSBhIHNhZmUgcmVmZXJlbmNlIHRvIHRoZSBVbmRlcnNjb3JlIG9iamVjdCBmb3IgdXNlIGJlbG93LgoJICB2YXIgXyA9IGZ1bmN0aW9uKG9iaikgewoJICAgIGlmIChvYmogaW5zdGFuY2VvZiBfKSByZXR1cm4gb2JqOwoJICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBfKSkgcmV0dXJuIG5ldyBfKG9iaik7CgkgICAgdGhpcy5fd3JhcHBlZCA9IG9iajsKCSAgfTsKCgkgIC8vIEV4cG9ydCB0aGUgVW5kZXJzY29yZSBvYmplY3QgZm9yICoqTm9kZS5qcyoqLCB3aXRoCgkgIC8vIGJhY2t3YXJkcy1jb21wYXRpYmlsaXR5IGZvciB0aGUgb2xkIGByZXF1aXJlKClgIEFQSS4gSWYgd2UncmUgaW4KCSAgLy8gdGhlIGJyb3dzZXIsIGFkZCBgX2AgYXMgYSBnbG9iYWwgb2JqZWN0LgoJICBpZiAodHJ1ZSkgewoJICAgIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykgewoJICAgICAgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gXzsKCSAgICB9CgkgICAgZXhwb3J0cy5fID0gXzsKCSAgfSBlbHNlIHsKCSAgICByb290Ll8gPSBfOwoJICB9CgoJICAvLyBDdXJyZW50IHZlcnNpb24uCgkgIF8uVkVSU0lPTiA9ICcxLjguMyc7CgoJICAvLyBJbnRlcm5hbCBmdW5jdGlvbiB0aGF0IHJldHVybnMgYW4gZWZmaWNpZW50IChmb3IgY3VycmVudCBlbmdpbmVzKSB2ZXJzaW9uCgkgIC8vIG9mIHRoZSBwYXNzZWQtaW4gY2FsbGJhY2ssIHRvIGJlIHJlcGVhdGVkbHkgYXBwbGllZCBpbiBvdGhlciBVbmRlcnNjb3JlCgkgIC8vIGZ1bmN0aW9ucy4KCSAgdmFyIG9wdGltaXplQ2IgPSBmdW5jdGlvbihmdW5jLCBjb250ZXh0LCBhcmdDb3VudCkgewoJICAgIGlmIChjb250ZXh0ID09PSB2b2lkIDApIHJldHVybiBmdW5jOwoJICAgIHN3aXRjaCAoYXJnQ291bnQgPT0gbnVsbCA/IDMgOiBhcmdDb3VudCkgewoJICAgICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHsKCSAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbChjb250ZXh0LCB2YWx1ZSk7CgkgICAgICB9OwoJICAgICAgY2FzZSAyOiByZXR1cm4gZnVuY3Rpb24odmFsdWUsIG90aGVyKSB7CgkgICAgICAgIHJldHVybiBmdW5jLmNhbGwoY29udGV4dCwgdmFsdWUsIG90aGVyKTsKCSAgICAgIH07CgkgICAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHsKCSAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pOwoJICAgICAgfTsKCSAgICAgIGNhc2UgNDogcmV0dXJuIGZ1bmN0aW9uKGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHsKCSAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbChjb250ZXh0LCBhY2N1bXVsYXRvciwgdmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKTsKCSAgICAgIH07CgkgICAgfQoJICAgIHJldHVybiBmdW5jdGlvbigpIHsKCSAgICAgIHJldHVybiBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3VtZW50cyk7CgkgICAgfTsKCSAgfTsKCgkgIC8vIEEgbW9zdGx5LWludGVybmFsIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIGNhbGxiYWNrcyB0aGF0IGNhbiBiZSBhcHBsaWVkCgkgIC8vIHRvIGVhY2ggZWxlbWVudCBpbiBhIGNvbGxlY3Rpb24sIHJldHVybmluZyB0aGUgZGVzaXJlZCByZXN1bHQg4oCUIGVpdGhlcgoJICAvLyBpZGVudGl0eSwgYW4gYXJiaXRyYXJ5IGNhbGxiYWNrLCBhIHByb3BlcnR5IG1hdGNoZXIsIG9yIGEgcHJvcGVydHkgYWNjZXNzb3IuCgkgIHZhciBjYiA9IGZ1bmN0aW9uKHZhbHVlLCBjb250ZXh0LCBhcmdDb3VudCkgewoJICAgIGlmICh2YWx1ZSA9PSBudWxsKSByZXR1cm4gXy5pZGVudGl0eTsKCSAgICBpZiAoXy5pc0Z1bmN0aW9uKHZhbHVlKSkgcmV0dXJuIG9wdGltaXplQ2IodmFsdWUsIGNvbnRleHQsIGFyZ0NvdW50KTsKCSAgICBpZiAoXy5pc09iamVjdCh2YWx1ZSkpIHJldHVybiBfLm1hdGNoZXIodmFsdWUpOwoJICAgIHJldHVybiBfLnByb3BlcnR5KHZhbHVlKTsKCSAgfTsKCSAgXy5pdGVyYXRlZSA9IGZ1bmN0aW9uKHZhbHVlLCBjb250ZXh0KSB7CgkgICAgcmV0dXJuIGNiKHZhbHVlLCBjb250ZXh0LCBJbmZpbml0eSk7CgkgIH07CgoJICAvLyBBbiBpbnRlcm5hbCBmdW5jdGlvbiBmb3IgY3JlYXRpbmcgYXNzaWduZXIgZnVuY3Rpb25zLgoJICB2YXIgY3JlYXRlQXNzaWduZXIgPSBmdW5jdGlvbihrZXlzRnVuYywgdW5kZWZpbmVkT25seSkgewoJICAgIHJldHVybiBmdW5jdGlvbihvYmopIHsKCSAgICAgIHZhciBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoOwoJICAgICAgaWYgKGxlbmd0aCA8IDIgfHwgb2JqID09IG51bGwpIHJldHVybiBvYmo7CgkgICAgICBmb3IgKHZhciBpbmRleCA9IDE7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaW5kZXhdLAoJICAgICAgICAgICAga2V5cyA9IGtleXNGdW5jKHNvdXJjZSksCgkgICAgICAgICAgICBsID0ga2V5cy5sZW5ndGg7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbDsgaSsrKSB7CgkgICAgICAgICAgdmFyIGtleSA9IGtleXNbaV07CgkgICAgICAgICAgaWYgKCF1bmRlZmluZWRPbmx5IHx8IG9ialtrZXldID09PSB2b2lkIDApIG9ialtrZXldID0gc291cmNlW2tleV07CgkgICAgICAgIH0KCSAgICAgIH0KCSAgICAgIHJldHVybiBvYmo7CgkgICAgfTsKCSAgfTsKCgkgIC8vIEFuIGludGVybmFsIGZ1bmN0aW9uIGZvciBjcmVhdGluZyBhIG5ldyBvYmplY3QgdGhhdCBpbmhlcml0cyBmcm9tIGFub3RoZXIuCgkgIHZhciBiYXNlQ3JlYXRlID0gZnVuY3Rpb24ocHJvdG90eXBlKSB7CgkgICAgaWYgKCFfLmlzT2JqZWN0KHByb3RvdHlwZSkpIHJldHVybiB7fTsKCSAgICBpZiAobmF0aXZlQ3JlYXRlKSByZXR1cm4gbmF0aXZlQ3JlYXRlKHByb3RvdHlwZSk7CgkgICAgQ3Rvci5wcm90b3R5cGUgPSBwcm90b3R5cGU7CgkgICAgdmFyIHJlc3VsdCA9IG5ldyBDdG9yOwoJICAgIEN0b3IucHJvdG90eXBlID0gbnVsbDsKCSAgICByZXR1cm4gcmVzdWx0OwoJICB9OwoKCSAgdmFyIHByb3BlcnR5ID0gZnVuY3Rpb24oa2V5KSB7CgkgICAgcmV0dXJuIGZ1bmN0aW9uKG9iaikgewoJICAgICAgcmV0dXJuIG9iaiA9PSBudWxsID8gdm9pZCAwIDogb2JqW2tleV07CgkgICAgfTsKCSAgfTsKCgkgIC8vIEhlbHBlciBmb3IgY29sbGVjdGlvbiBtZXRob2RzIHRvIGRldGVybWluZSB3aGV0aGVyIGEgY29sbGVjdGlvbgoJICAvLyBzaG91bGQgYmUgaXRlcmF0ZWQgYXMgYW4gYXJyYXkgb3IgYXMgYW4gb2JqZWN0CgkgIC8vIFJlbGF0ZWQ6IGh0dHA6Ly9wZW9wbGUubW96aWxsYS5vcmcvfmpvcmVuZG9yZmYvZXM2LWRyYWZ0Lmh0bWwjc2VjLXRvbGVuZ3RoCgkgIC8vIEF2b2lkcyBhIHZlcnkgbmFzdHkgaU9TIDggSklUIGJ1ZyBvbiBBUk0tNjQuICMyMDk0CgkgIHZhciBNQVhfQVJSQVlfSU5ERVggPSBNYXRoLnBvdygyLCA1MykgLSAxOwoJICB2YXIgZ2V0TGVuZ3RoID0gcHJvcGVydHkoJ2xlbmd0aCcpOwoJICB2YXIgaXNBcnJheUxpa2UgPSBmdW5jdGlvbihjb2xsZWN0aW9uKSB7CgkgICAgdmFyIGxlbmd0aCA9IGdldExlbmd0aChjb2xsZWN0aW9uKTsKCSAgICByZXR1cm4gdHlwZW9mIGxlbmd0aCA9PSAnbnVtYmVyJyAmJiBsZW5ndGggPj0gMCAmJiBsZW5ndGggPD0gTUFYX0FSUkFZX0lOREVYOwoJICB9OwoKCSAgLy8gQ29sbGVjdGlvbiBGdW5jdGlvbnMKCSAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgkgIC8vIFRoZSBjb3JuZXJzdG9uZSwgYW4gYGVhY2hgIGltcGxlbWVudGF0aW9uLCBha2EgYGZvckVhY2hgLgoJICAvLyBIYW5kbGVzIHJhdyBvYmplY3RzIGluIGFkZGl0aW9uIHRvIGFycmF5LWxpa2VzLiBUcmVhdHMgYWxsCgkgIC8vIHNwYXJzZSBhcnJheS1saWtlcyBhcyBpZiB0aGV5IHdlcmUgZGVuc2UuCgkgIF8uZWFjaCA9IF8uZm9yRWFjaCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHsKCSAgICBpdGVyYXRlZSA9IG9wdGltaXplQ2IoaXRlcmF0ZWUsIGNvbnRleHQpOwoJICAgIHZhciBpLCBsZW5ndGg7CgkgICAgaWYgKGlzQXJyYXlMaWtlKG9iaikpIHsKCSAgICAgIGZvciAoaSA9IDAsIGxlbmd0aCA9IG9iai5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICBpdGVyYXRlZShvYmpbaV0sIGksIG9iaik7CgkgICAgICB9CgkgICAgfSBlbHNlIHsKCSAgICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaik7CgkgICAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBrZXlzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CgkgICAgICAgIGl0ZXJhdGVlKG9ialtrZXlzW2ldXSwga2V5c1tpXSwgb2JqKTsKCSAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIG9iajsKCSAgfTsKCgkgIC8vIFJldHVybiB0aGUgcmVzdWx0cyBvZiBhcHBseWluZyB0aGUgaXRlcmF0ZWUgdG8gZWFjaCBlbGVtZW50LgoJICBfLm1hcCA9IF8uY29sbGVjdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHsKCSAgICBpdGVyYXRlZSA9IGNiKGl0ZXJhdGVlLCBjb250ZXh0KTsKCSAgICB2YXIga2V5cyA9ICFpc0FycmF5TGlrZShvYmopICYmIF8ua2V5cyhvYmopLAoJICAgICAgICBsZW5ndGggPSAoa2V5cyB8fCBvYmopLmxlbmd0aCwKCSAgICAgICAgcmVzdWx0cyA9IEFycmF5KGxlbmd0aCk7CgkgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgewoJICAgICAgdmFyIGN1cnJlbnRLZXkgPSBrZXlzID8ga2V5c1tpbmRleF0gOiBpbmRleDsKCSAgICAgIHJlc3VsdHNbaW5kZXhdID0gaXRlcmF0ZWUob2JqW2N1cnJlbnRLZXldLCBjdXJyZW50S2V5LCBvYmopOwoJICAgIH0KCSAgICByZXR1cm4gcmVzdWx0czsKCSAgfTsKCgkgIC8vIENyZWF0ZSBhIHJlZHVjaW5nIGZ1bmN0aW9uIGl0ZXJhdGluZyBsZWZ0IG9yIHJpZ2h0LgoJICBmdW5jdGlvbiBjcmVhdGVSZWR1Y2UoZGlyKSB7CgkgICAgLy8gT3B0aW1pemVkIGl0ZXJhdG9yIGZ1bmN0aW9uIGFzIHVzaW5nIGFyZ3VtZW50cy5sZW5ndGgKCSAgICAvLyBpbiB0aGUgbWFpbiBmdW5jdGlvbiB3aWxsIGRlb3B0aW1pemUgdGhlLCBzZWUgIzE5OTEuCgkgICAgZnVuY3Rpb24gaXRlcmF0b3Iob2JqLCBpdGVyYXRlZSwgbWVtbywga2V5cywgaW5kZXgsIGxlbmd0aCkgewoJICAgICAgZm9yICg7IGluZGV4ID49IDAgJiYgaW5kZXggPCBsZW5ndGg7IGluZGV4ICs9IGRpcikgewoJICAgICAgICB2YXIgY3VycmVudEtleSA9IGtleXMgPyBrZXlzW2luZGV4XSA6IGluZGV4OwoJICAgICAgICBtZW1vID0gaXRlcmF0ZWUobWVtbywgb2JqW2N1cnJlbnRLZXldLCBjdXJyZW50S2V5LCBvYmopOwoJICAgICAgfQoJICAgICAgcmV0dXJuIG1lbW87CgkgICAgfQoKCSAgICByZXR1cm4gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgbWVtbywgY29udGV4dCkgewoJICAgICAgaXRlcmF0ZWUgPSBvcHRpbWl6ZUNiKGl0ZXJhdGVlLCBjb250ZXh0LCA0KTsKCSAgICAgIHZhciBrZXlzID0gIWlzQXJyYXlMaWtlKG9iaikgJiYgXy5rZXlzKG9iaiksCgkgICAgICAgICAgbGVuZ3RoID0gKGtleXMgfHwgb2JqKS5sZW5ndGgsCgkgICAgICAgICAgaW5kZXggPSBkaXIgPiAwID8gMCA6IGxlbmd0aCAtIDE7CgkgICAgICAvLyBEZXRlcm1pbmUgdGhlIGluaXRpYWwgdmFsdWUgaWYgbm9uZSBpcyBwcm92aWRlZC4KCSAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMykgewoJICAgICAgICBtZW1vID0gb2JqW2tleXMgPyBrZXlzW2luZGV4XSA6IGluZGV4XTsKCSAgICAgICAgaW5kZXggKz0gZGlyOwoJICAgICAgfQoJICAgICAgcmV0dXJuIGl0ZXJhdG9yKG9iaiwgaXRlcmF0ZWUsIG1lbW8sIGtleXMsIGluZGV4LCBsZW5ndGgpOwoJICAgIH07CgkgIH0KCgkgIC8vICoqUmVkdWNlKiogYnVpbGRzIHVwIGEgc2luZ2xlIHJlc3VsdCBmcm9tIGEgbGlzdCBvZiB2YWx1ZXMsIGFrYSBgaW5qZWN0YCwKCSAgLy8gb3IgYGZvbGRsYC4KCSAgXy5yZWR1Y2UgPSBfLmZvbGRsID0gXy5pbmplY3QgPSBjcmVhdGVSZWR1Y2UoMSk7CgoJICAvLyBUaGUgcmlnaHQtYXNzb2NpYXRpdmUgdmVyc2lvbiBvZiByZQ==", "base64"));
  res.write(new Buffer("ZHVjZSwgYWxzbyBrbm93biBhcyBgZm9sZHJgLgoJICBfLnJlZHVjZVJpZ2h0ID0gXy5mb2xkciA9IGNyZWF0ZVJlZHVjZSgtMSk7CgoJICAvLyBSZXR1cm4gdGhlIGZpcnN0IHZhbHVlIHdoaWNoIHBhc3NlcyBhIHRydXRoIHRlc3QuIEFsaWFzZWQgYXMgYGRldGVjdGAuCgkgIF8uZmluZCA9IF8uZGV0ZWN0ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHsKCSAgICB2YXIga2V5OwoJICAgIGlmIChpc0FycmF5TGlrZShvYmopKSB7CgkgICAgICBrZXkgPSBfLmZpbmRJbmRleChvYmosIHByZWRpY2F0ZSwgY29udGV4dCk7CgkgICAgfSBlbHNlIHsKCSAgICAgIGtleSA9IF8uZmluZEtleShvYmosIHByZWRpY2F0ZSwgY29udGV4dCk7CgkgICAgfQoJICAgIGlmIChrZXkgIT09IHZvaWQgMCAmJiBrZXkgIT09IC0xKSByZXR1cm4gb2JqW2tleV07CgkgIH07CgoJICAvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyB0aGF0IHBhc3MgYSB0cnV0aCB0ZXN0LgoJICAvLyBBbGlhc2VkIGFzIGBzZWxlY3RgLgoJICBfLmZpbHRlciA9IF8uc2VsZWN0ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHsKCSAgICB2YXIgcmVzdWx0cyA9IFtdOwoJICAgIHByZWRpY2F0ZSA9IGNiKHByZWRpY2F0ZSwgY29udGV4dCk7CgkgICAgXy5lYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7CgkgICAgICBpZiAocHJlZGljYXRlKHZhbHVlLCBpbmRleCwgbGlzdCkpIHJlc3VsdHMucHVzaCh2YWx1ZSk7CgkgICAgfSk7CgkgICAgcmV0dXJuIHJlc3VsdHM7CgkgIH07CgoJICAvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyBmb3Igd2hpY2ggYSB0cnV0aCB0ZXN0IGZhaWxzLgoJICBfLnJlamVjdCA9IGZ1bmN0aW9uKG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KSB7CgkgICAgcmV0dXJuIF8uZmlsdGVyKG9iaiwgXy5uZWdhdGUoY2IocHJlZGljYXRlKSksIGNvbnRleHQpOwoJICB9OwoKCSAgLy8gRGV0ZXJtaW5lIHdoZXRoZXIgYWxsIG9mIHRoZSBlbGVtZW50cyBtYXRjaCBhIHRydXRoIHRlc3QuCgkgIC8vIEFsaWFzZWQgYXMgYGFsbGAuCgkgIF8uZXZlcnkgPSBfLmFsbCA9IGZ1bmN0aW9uKG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KSB7CgkgICAgcHJlZGljYXRlID0gY2IocHJlZGljYXRlLCBjb250ZXh0KTsKCSAgICB2YXIga2V5cyA9ICFpc0FycmF5TGlrZShvYmopICYmIF8ua2V5cyhvYmopLAoJICAgICAgICBsZW5ndGggPSAoa2V5cyB8fCBvYmopLmxlbmd0aDsKCSAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7CgkgICAgICB2YXIgY3VycmVudEtleSA9IGtleXMgPyBrZXlzW2luZGV4XSA6IGluZGV4OwoJICAgICAgaWYgKCFwcmVkaWNhdGUob2JqW2N1cnJlbnRLZXldLCBjdXJyZW50S2V5LCBvYmopKSByZXR1cm4gZmFsc2U7CgkgICAgfQoJICAgIHJldHVybiB0cnVlOwoJICB9OwoKCSAgLy8gRGV0ZXJtaW5lIGlmIGF0IGxlYXN0IG9uZSBlbGVtZW50IGluIHRoZSBvYmplY3QgbWF0Y2hlcyBhIHRydXRoIHRlc3QuCgkgIC8vIEFsaWFzZWQgYXMgYGFueWAuCgkgIF8uc29tZSA9IF8uYW55ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHsKCSAgICBwcmVkaWNhdGUgPSBjYihwcmVkaWNhdGUsIGNvbnRleHQpOwoJICAgIHZhciBrZXlzID0gIWlzQXJyYXlMaWtlKG9iaikgJiYgXy5rZXlzKG9iaiksCgkgICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoOwoJICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHsKCSAgICAgIHZhciBjdXJyZW50S2V5ID0ga2V5cyA/IGtleXNbaW5kZXhdIDogaW5kZXg7CgkgICAgICBpZiAocHJlZGljYXRlKG9ialtjdXJyZW50S2V5XSwgY3VycmVudEtleSwgb2JqKSkgcmV0dXJuIHRydWU7CgkgICAgfQoJICAgIHJldHVybiBmYWxzZTsKCSAgfTsKCgkgIC8vIERldGVybWluZSBpZiB0aGUgYXJyYXkgb3Igb2JqZWN0IGNvbnRhaW5zIGEgZ2l2ZW4gaXRlbSAodXNpbmcgYD09PWApLgoJICAvLyBBbGlhc2VkIGFzIGBpbmNsdWRlc2AgYW5kIGBpbmNsdWRlYC4KCSAgXy5jb250YWlucyA9IF8uaW5jbHVkZXMgPSBfLmluY2x1ZGUgPSBmdW5jdGlvbihvYmosIGl0ZW0sIGZyb21JbmRleCwgZ3VhcmQpIHsKCSAgICBpZiAoIWlzQXJyYXlMaWtlKG9iaikpIG9iaiA9IF8udmFsdWVzKG9iaik7CgkgICAgaWYgKHR5cGVvZiBmcm9tSW5kZXggIT0gJ251bWJlcicgfHwgZ3VhcmQpIGZyb21JbmRleCA9IDA7CgkgICAgcmV0dXJuIF8uaW5kZXhPZihvYmosIGl0ZW0sIGZyb21JbmRleCkgPj0gMDsKCSAgfTsKCgkgIC8vIEludm9rZSBhIG1ldGhvZCAod2l0aCBhcmd1bWVudHMpIG9uIGV2ZXJ5IGl0ZW0gaW4gYSBjb2xsZWN0aW9uLgoJICBfLmludm9rZSA9IGZ1bmN0aW9uKG9iaiwgbWV0aG9kKSB7CgkgICAgdmFyIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMik7CgkgICAgdmFyIGlzRnVuYyA9IF8uaXNGdW5jdGlvbihtZXRob2QpOwoJICAgIHJldHVybiBfLm1hcChvYmosIGZ1bmN0aW9uKHZhbHVlKSB7CgkgICAgICB2YXIgZnVuYyA9IGlzRnVuYyA/IG1ldGhvZCA6IHZhbHVlW21ldGhvZF07CgkgICAgICByZXR1cm4gZnVuYyA9PSBudWxsID8gZnVuYyA6IGZ1bmMuYXBwbHkodmFsdWUsIGFyZ3MpOwoJICAgIH0pOwoJICB9OwoKCSAgLy8gQ29udmVuaWVuY2UgdmVyc2lvbiBvZiBhIGNvbW1vbiB1c2UgY2FzZSBvZiBgbWFwYDogZmV0Y2hpbmcgYSBwcm9wZXJ0eS4KCSAgXy5wbHVjayA9IGZ1bmN0aW9uKG9iaiwga2V5KSB7CgkgICAgcmV0dXJuIF8ubWFwKG9iaiwgXy5wcm9wZXJ0eShrZXkpKTsKCSAgfTsKCgkgIC8vIENvbnZlbmllbmNlIHZlcnNpb24gb2YgYSBjb21tb24gdXNlIGNhc2Ugb2YgYGZpbHRlcmA6IHNlbGVjdGluZyBvbmx5IG9iamVjdHMKCSAgLy8gY29udGFpbmluZyBzcGVjaWZpYyBga2V5OnZhbHVlYCBwYWlycy4KCSAgXy53aGVyZSA9IGZ1bmN0aW9uKG9iaiwgYXR0cnMpIHsKCSAgICByZXR1cm4gXy5maWx0ZXIob2JqLCBfLm1hdGNoZXIoYXR0cnMpKTsKCSAgfTsKCgkgIC8vIENvbnZlbmllbmNlIHZlcnNpb24gb2YgYSBjb21tb24gdXNlIGNhc2Ugb2YgYGZpbmRgOiBnZXR0aW5nIHRoZSBmaXJzdCBvYmplY3QKCSAgLy8gY29udGFpbmluZyBzcGVjaWZpYyBga2V5OnZhbHVlYCBwYWlycy4KCSAgXy5maW5kV2hlcmUgPSBmdW5jdGlvbihvYmosIGF0dHJzKSB7CgkgICAgcmV0dXJuIF8uZmluZChvYmosIF8ubWF0Y2hlcihhdHRycykpOwoJICB9OwoKCSAgLy8gUmV0dXJuIHRoZSBtYXhpbXVtIGVsZW1lbnQgKG9yIGVsZW1lbnQtYmFzZWQgY29tcHV0YXRpb24pLgoJICBfLm1heCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHsKCSAgICB2YXIgcmVzdWx0ID0gLUluZmluaXR5LCBsYXN0Q29tcHV0ZWQgPSAtSW5maW5pdHksCgkgICAgICAgIHZhbHVlLCBjb21wdXRlZDsKCSAgICBpZiAoaXRlcmF0ZWUgPT0gbnVsbCAmJiBvYmogIT0gbnVsbCkgewoJICAgICAgb2JqID0gaXNBcnJheUxpa2Uob2JqKSA/IG9iaiA6IF8udmFsdWVzKG9iaik7CgkgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gb2JqLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CgkgICAgICAgIHZhbHVlID0gb2JqW2ldOwoJICAgICAgICBpZiAodmFsdWUgPiByZXN1bHQpIHsKCSAgICAgICAgICByZXN1bHQgPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgICAgfQoJICAgIH0gZWxzZSB7CgkgICAgICBpdGVyYXRlZSA9IGNiKGl0ZXJhdGVlLCBjb250ZXh0KTsKCSAgICAgIF8uZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewoJICAgICAgICBjb21wdXRlZCA9IGl0ZXJhdGVlKHZhbHVlLCBpbmRleCwgbGlzdCk7CgkgICAgICAgIGlmIChjb21wdXRlZCA+IGxhc3RDb21wdXRlZCB8fCBjb21wdXRlZCA9PT0gLUluZmluaXR5ICYmIHJlc3VsdCA9PT0gLUluZmluaXR5KSB7CgkgICAgICAgICAgcmVzdWx0ID0gdmFsdWU7CgkgICAgICAgICAgbGFzdENvbXB1dGVkID0gY29tcHV0ZWQ7CgkgICAgICAgIH0KCSAgICAgIH0pOwoJICAgIH0KCSAgICByZXR1cm4gcmVzdWx0OwoJICB9OwoKCSAgLy8gUmV0dXJuIHRoZSBtaW5pbXVtIGVsZW1lbnQgKG9yIGVsZW1lbnQtYmFzZWQgY29tcHV0YXRpb24pLgoJICBfLm1pbiA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHsKCSAgICB2YXIgcmVzdWx0ID0gSW5maW5pdHksIGxhc3RDb21wdXRlZCA9IEluZmluaXR5LAoJICAgICAgICB2YWx1ZSwgY29tcHV0ZWQ7CgkgICAgaWYgKGl0ZXJhdGVlID09IG51bGwgJiYgb2JqICE9IG51bGwpIHsKCSAgICAgIG9iaiA9IGlzQXJyYXlMaWtlKG9iaikgPyBvYmogOiBfLnZhbHVlcyhvYmopOwoJICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IG9iai5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICB2YWx1ZSA9IG9ialtpXTsKCSAgICAgICAgaWYgKHZhbHVlIDwgcmVzdWx0KSB7CgkgICAgICAgICAgcmVzdWx0ID0gdmFsdWU7CgkgICAgICAgIH0KCSAgICAgIH0KCSAgICB9IGVsc2UgewoJICAgICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCk7CgkgICAgICBfLmVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHsKCSAgICAgICAgY29tcHV0ZWQgPSBpdGVyYXRlZSh2YWx1ZSwgaW5kZXgsIGxpc3QpOwoJICAgICAgICBpZiAoY29tcHV0ZWQgPCBsYXN0Q29tcHV0ZWQgfHwgY29tcHV0ZWQgPT09IEluZmluaXR5ICYmIHJlc3VsdCA9PT0gSW5maW5pdHkpIHsKCSAgICAgICAgICByZXN1bHQgPSB2YWx1ZTsKCSAgICAgICAgICBsYXN0Q29tcHV0ZWQgPSBjb21wdXRlZDsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfQoJICAgIHJldHVybiByZXN1bHQ7CgkgIH07CgoJICAvLyBTaHVmZmxlIGEgY29sbGVjdGlvbiwgdXNpbmcgdGhlIG1vZGVybiB2ZXJzaW9uIG9mIHRoZQoJICAvLyBbRmlzaGVyLVlhdGVzIHNodWZmbGVdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRmlzaGVy4oCTWWF0ZXNfc2h1ZmZsZSkuCgkgIF8uc2h1ZmZsZSA9IGZ1bmN0aW9uKG9iaikgewoJICAgIHZhciBzZXQgPSBpc0FycmF5TGlrZShvYmopID8gb2JqIDogXy52YWx1ZXMob2JqKTsKCSAgICB2YXIgbGVuZ3RoID0gc2V0Lmxlbmd0aDsKCSAgICB2YXIgc2h1ZmZsZWQgPSBBcnJheShsZW5ndGgpOwoJICAgIGZvciAodmFyIGluZGV4ID0gMCwgcmFuZDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHsKCSAgICAgIHJhbmQgPSBfLnJhbmRvbSgwLCBpbmRleCk7CgkgICAgICBpZiAocmFuZCAhPT0gaW5kZXgpIHNodWZmbGVkW2luZGV4XSA9IHNodWZmbGVkW3JhbmRdOwoJICAgICAgc2h1ZmZsZWRbcmFuZF0gPSBzZXRbaW5kZXhdOwoJICAgIH0KCSAgICByZXR1cm4gc2h1ZmZsZWQ7CgkgIH07CgoJICAvLyBTYW1wbGUgKipuKiogcmFuZG9tIHZhbHVlcyBmcm9tIGEgY29sbGVjdGlvbi4KCSAgLy8gSWYgKipuKiogaXMgbm90IHNwZWNpZmllZCwgcmV0dXJucyBhIHNpbmdsZSByYW5kb20gZWxlbWVudC4KCSAgLy8gVGhlIGludGVybmFsIGBndWFyZGAgYXJndW1lbnQgYWxsb3dzIGl0IHRvIHdvcmsgd2l0aCBgbWFwYC4KCSAgXy5zYW1wbGUgPSBmdW5jdGlvbihvYmosIG4sIGd1YXJkKSB7CgkgICAgaWYgKG4gPT0gbnVsbCB8fCBndWFyZCkgewoJICAgICAgaWYgKCFpc0FycmF5TGlrZShvYmopKSBvYmogPSBfLnZhbHVlcyhvYmopOwoJICAgICAgcmV0dXJuIG9ialtfLnJhbmRvbShvYmoubGVuZ3RoIC0gMSldOwoJICAgIH0KCSAgICByZXR1cm4gXy5zaHVmZmxlKG9iaikuc2xpY2UoMCwgTWF0aC5tYXgoMCwgbikpOwoJICB9OwoKCSAgLy8gU29ydCB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uIHByb2R1Y2VkIGJ5IGFuIGl0ZXJhdGVlLgoJICBfLnNvcnRCeSA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHsKCSAgICBpdGVyYXRlZSA9IGNiKGl0ZXJhdGVlLCBjb250ZXh0KTsKCSAgICByZXR1cm4gXy5wbHVjayhfLm1hcChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewoJICAgICAgcmV0dXJuIHsKCSAgICAgICAgdmFsdWU6IHZhbHVlLAoJICAgICAgICBpbmRleDogaW5kZXgsCgkgICAgICAgIGNyaXRlcmlhOiBpdGVyYXRlZSh2YWx1ZSwgaW5kZXgsIGxpc3QpCgkgICAgICB9OwoJICAgIH0pLnNvcnQoZnVuY3Rpb24obGVmdCwgcmlnaHQpIHsKCSAgICAgIHZhciBhID0gbGVmdC5jcml0ZXJpYTsKCSAgICAgIHZhciBiID0gcmlnaHQuY3JpdGVyaWE7CgkgICAgICBpZiAoYSAhPT0gYikgewoJICAgICAgICBpZiAoYSA+IGIgfHwgYSA9PT0gdm9pZCAwKSByZXR1cm4gMTsKCSAgICAgICAgaWYgKGEgPCBiIHx8IGIgPT09IHZvaWQgMCkgcmV0dXJuIC0xOwoJICAgICAgfQoJICAgICAgcmV0dXJuIGxlZnQuaW5kZXggLSByaWdodC5pbmRleDsKCSAgICB9KSwgJ3ZhbHVlJyk7CgkgIH07CgoJICAvLyBBbiBpbnRlcm5hbCBmdW5jdGlvbiB1c2VkIGZvciBhZ2dyZWdhdGUgImdyb3VwIGJ5IiBvcGVyYXRpb25zLgoJICB2YXIgZ3JvdXAgPSBmdW5jdGlvbihiZWhhdmlvcikgewoJICAgIHJldHVybiBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7CgkgICAgICB2YXIgcmVzdWx0ID0ge307CgkgICAgICBpdGVyYXRlZSA9IGNiKGl0ZXJhdGVlLCBjb250ZXh0KTsKCSAgICAgIF8uZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCkgewoJICAgICAgICB2YXIga2V5ID0gaXRlcmF0ZWUodmFsdWUsIGluZGV4LCBvYmopOwoJICAgICAgICBiZWhhdmlvcihyZXN1bHQsIHZhbHVlLCBrZXkpOwoJICAgICAgfSk7CgkgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgIH07CgoJICAvLyBHcm91cHMgdGhlIG9iamVjdCdzIHZhbHVlcyBieSBhIGNyaXRlcmlvbi4gUGFzcyBlaXRoZXIgYSBzdHJpbmcgYXR0cmlidXRlCgkgIC8vIHRvIGdyb3VwIGJ5LCBvciBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgY3JpdGVyaW9uLgoJICBfLmdyb3VwQnkgPSBncm91cChmdW5jdGlvbihyZXN1bHQsIHZhbHVlLCBrZXkpIHsKCSAgICBpZiAoXy5oYXMocmVzdWx0LCBrZXkpKSByZXN1bHRba2V5XS5wdXNoKHZhbHVlKTsgZWxzZSByZXN1bHRba2V5XSA9IFt2YWx1ZV07CgkgIH0pOwoKCSAgLy8gSW5kZXhlcyB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uLCBzaW1pbGFyIHRvIGBncm91cEJ5YCwgYnV0IGZvcgoJICAvLyB3aGVuIHlvdSBrbm93IHRoYXQgeW91ciBpbmRleCB2YWx1ZXMgd2lsbCBiZSB1bmlxdWUuCgkgIF8uaW5kZXhCeSA9IGdyb3VwKGZ1bmN0aW9uKHJlc3VsdCwgdmFsdWUsIGtleSkgewoJICAgIHJlc3VsdFtrZXldID0gdmFsdWU7CgkgIH0pOwoKCSAgLy8gQ291bnRzIGluc3RhbmNlcyBvZiBhbiBvYmplY3QgdGhhdCBncm91cCBieSBhIGNlcnRhaW4gY3JpdGVyaW9uLiBQYXNzCgkgIC8vIGVpdGhlciBhIHN0cmluZyBhdHRyaWJ1dGUgdG8gY291bnQgYnksIG9yIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZQoJICAvLyBjcml0ZXJpb24uCgkgIF8uY291bnRCeSA9IGdyb3VwKGZ1bmN0aW9uKHJlc3VsdCwgdmFsdWUsIGtleSkgewoJICAgIGlmIChfLmhhcyhyZXN1bHQsIGtleSkpIHJlc3VsdFtrZXldKys7IGVsc2UgcmVzdWx0W2tleV0gPSAxOwoJICB9KTsKCgkgIC8vIFNhZmVseSBjcmVhdGUgYSByZWFsLCBsaXZlIGFycmF5IGZyb20gYW55dGhpbmcgaXRlcmFibGUuCgkgIF8udG9BcnJheSA9IGZ1bmN0aW9uKG9iaikgewoJICAgIGlmICghb2JqKSByZXR1cm4gW107CgkgICAgaWYgKF8uaXNBcnJheShvYmopKSByZXR1cm4gc2xpY2UuY2FsbChvYmopOwoJICAgIGlmIChpc0FycmF5TGlrZShvYmopKSByZXR1cm4gXy5tYXAob2JqLCBfLmlkZW50aXR5KTsKCSAgICByZXR1cm4gXy52YWx1ZXMob2JqKTsKCSAgfTsKCgkgIC8vIFJldHVybiB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGFuIG9iamVjdC4KCSAgXy5zaXplID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gMDsKCSAgICByZXR1cm4gaXNBcnJheUxpa2Uob2JqKSA/IG9iai5sZW5ndGggOiBfLmtleXMob2JqKS5sZW5ndGg7CgkgIH07CgoJICAvLyBTcGxpdCBhIGNvbGxlY3Rpb24gaW50byB0d28gYXJyYXlzOiBvbmUgd2hvc2UgZWxlbWVudHMgYWxsIHNhdGlzZnkgdGhlIGdpdmVuCgkgIC8vIHByZWRpY2F0ZSwgYW5kIG9uZSB3aG9zZSBlbGVtZW50cyBhbGwgZG8gbm90IHNhdGlzZnkgdGhlIHByZWRpY2F0ZS4KCSAgXy5wYXJ0aXRpb24gPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkgewoJICAgIHByZWRpY2F0ZSA9IGNiKHByZWRpY2F0ZSwgY29udGV4dCk7CgkgICAgdmFyIHBhc3MgPSBbXSwgZmFpbCA9IFtdOwoJICAgIF8uZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBrZXksIG9iaikgewoJICAgICAgKHByZWRpY2F0ZSh2YWx1ZSwga2V5LCBvYmopID8gcGFzcyA6IGZhaWwpLnB1c2godmFsdWUpOwoJICAgIH0pOwoJICAgIHJldHVybiBbcGFzcywgZmFpbF07CgkgIH07CgoJICAvLyBBcnJheSBGdW5jdGlvbnMKCSAgLy8gLS0tLS0tLS0tLS0tLS0tCgoJICAvLyBHZXQgdGhlIGZpcnN0IGVsZW1lbnQgb2YgYW4gYXJyYXkuIFBhc3NpbmcgKipuKiogd2lsbCByZXR1cm4gdGhlIGZpcnN0IE4KCSAgLy8gdmFsdWVzIGluIHRoZSBhcnJheS4gQWxpYXNlZCBhcyBgaGVhZGAgYW5kIGB0YWtlYC4gVGhlICoqZ3VhcmQqKiBjaGVjawoJICAvLyBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBfLm1hcGAuCgkgIF8uZmlyc3QgPSBfLmhlYWQgPSBfLnRha2UgPSBmdW5jdGlvbihhcnJheSwgbiwgZ3VhcmQpIHsKCSAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIHZvaWQgMDsKCSAgICBpZiAobiA9PSBudWxsIHx8IGd1YXJkKSByZXR1cm4gYXJyYXlbMF07CgkgICAgcmV0dXJuIF8uaW5pdGlhbChhcnJheSwgYXJyYXkubGVuZ3RoIC0gbik7CgkgIH07CgoJICAvLyBSZXR1cm5zIGV2ZXJ5dGhpbmcgYnV0IHRoZSBsYXN0IGVudHJ5IG9mIHRoZSBhcnJheS4gRXNwZWNpYWxseSB1c2VmdWwgb24KCSAgLy8gdGhlIGFyZ3VtZW50cyBvYmplY3QuIFBhc3NpbmcgKipuKiogd2lsbCByZXR1cm4gYWxsIHRoZSB2YWx1ZXMgaW4KCSAgLy8gdGhlIGFycmF5LCBleGNsdWRpbmcgdGhlIGxhc3QgTi4KCSAgXy5pbml0aWFsID0gZnVuY3Rpb24oYXJyYXksIG4sIGd1YXJkKSB7CgkgICAgcmV0dXJuIHNsaWNlLmNhbGwoYXJyYXksIDAsIE1hdGgubWF4KDAsIGFycmF5Lmxlbmd0aCAtIChuID09IG51bGwgfHwgZ3VhcmQgPyAxIDogbikpKTsKCSAgfTsKCgkgIC8vIEdldCB0aGUgbGFzdCBlbGVtZW50IG9mIGFuIGFycmF5LiBQYXNzaW5nICoqbioqIHdpbGwgcmV0dXJuIHRoZSBsYXN0IE4KCSAgLy8gdmFsdWVzIGluIHRoZSBhcnJheS4KCSAgXy5sYXN0ID0gZnVuY3Rpb24oYXJyYXksIG4sIGd1YXJkKSB7CgkgICAgaWYgKGFycmF5ID09IG51bGwpIHJldHVybiB2b2lkIDA7CgkgICAgaWYgKG4gPT0gbnVsbCB8fCBndWFyZCkgcmV0dXJuIGFycmF5W2FycmF5Lmxlbmd0aCAtIDFdOwoJICAgIHJldHVybiBfLnJlc3QoYXJyYXksIE1hdGgubWF4KDAsIGFycmF5Lmxlbmd0aCAtIG4pKTsKCSAgfTsKCgkgIC8vIFJldHVybnMgZXZlcnl0aGluZyBidXQgdGhlIGZpcnN0IGVudHJ5IG9mIHRoZSBhcnJheS4gQWxpYXNlZCBhcyBgdGFpbGAgYW5kIGBkcm9wYC4KCSAgLy8gRXNwZWNpYWxseSB1c2VmdWwgb24gdGhlIGFyZ3VtZW50cyBvYmplY3QuIFBhc3NpbmcgYW4gKipuKiogd2lsbCByZXR1cm4KCSAgLy8gdGhlIHJlc3QgTiB2YWx1ZXMgaW4gdGhlIGFycmF5LgoJICBfLnJlc3QgPSBfLnRhaWwgPSBfLmRyb3AgPSBmdW5jdGlvbihhcnJheSwgbiwgZ3VhcmQpIHsKCSAgICByZXR1cm4gc2xpY2UuY2FsbChhcnJheSwgbiA9PSBudWxsIHx8IGd1YXJkID8gMSA6IG4pOwoJICB9OwoKCSAgLy8gVHJpbSBvdXQgYWxsIGZhbHN5IHZhbHVlcyBmcm9tIGFuIGFycmF5LgoJICBfLmNvbXBhY3QgPSBmdW5jdGlvbihhcnJheSkgewoJICAgIHJldHVybiBfLmZpbHRlcihhcnJheSwgXy5pZGVudGl0eSk7CgkgIH07CgoJICAvLyBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBvZiBhIHJlY3Vyc2l2ZSBgZmxhdHRlbmAgZnVuY3Rpb24uCgkgIHZhciBmbGF0dGVuID0gZnVuY3Rpb24oaW5wdXQsIHNoYWxsb3csIHN0cmljdCwgc3RhcnRJbmRleCkgewoJICAgIHZhciBvdXRwdXQgPSBbXSwgaWR4ID0gMDsKCSAgICBmb3IgKHZhciBpID0gc3RhcnRJbmRleCB8fCAwLCBsZW5ndGggPSBnZXRMZW5ndGgoaW5wdXQpOyBpIDwgbGVuZ3RoOyBpKyspIHsKCSAgICAgIHZhciB2YWx1ZSA9IGlucHV0W2ldOwoJICAgICAgaWYgKGlzQXJyYXlMaWtlKHZhbHVlKSAmJiAoXy5pc0FycmF5KHZhbHVlKSB8fCBfLmlzQXJndW1lbnRzKHZhbHVlKSkpIHsKCSAgICAgICAgLy9mbGF0dGVuIGN1cnJlbnQgbGV2ZWwgb2YgYXJyYXkgb3IgYXJndW1lbnRzIG9iamVjdAoJICAgICAgICBpZiAoIXNoYWxsb3cpIHZhbHVlID0gZmxhdHRlbih2YWx1ZSwgc2hhbGxvdywgc3RyaWN0KTsKCSAgICAgICAgdmFyIGogPSAwLCBsZW4gPSB2YWx1ZS5sZW5ndGg7CgkgICAgICAgIG91dHB1dC5sZW5ndGggKz0gbGVuOwoJICAgICAgICB3aGlsZSAoaiA8IGxlbikgewoJICAgICAgICAgIG91dHB1dFtpZHgrK10gPSB2YWx1ZVtqKytdOwoJICAgICAgICB9CgkgICAgICB9IGVsc2UgaWYgKCFzdHJpY3QpIHsKCSAgICAgICAgb3V0cHV0W2lkeCsrXSA9IHZhbHVlOwoJICAgICAgfQoJICAgIH0KCSAgICByZXR1cm4gb3V0cHV0OwoJICB9OwoKCSAgLy8gRmxhdHRlbiBvdXQgYW4gYXJyYXksIGVpdGhlciByZWN1cnNpdmVseSAoYnkgZGVmYXVsdCksIG9yIGp1c3Qgb25lIGxldmVsLgoJICBfLmZsYXR0ZW4gPSBmdW5jdGlvbihhcnJheSwgc2hhbGxvdykgewoJICAgIHJldHVybiBmbGF0dGVuKGFycmF5LCBzaGFsbG93LCBmYWxzZSk7CgkgIH07CgoJICAvLyBSZXR1cm4gYSB2ZXJzaW9uIG9mIHRoZSBhcnJheSB0aGF0IGRvZXMgbm90IGNvbnRhaW4gdGhlIHNwZWNpZmllZCB2YWx1ZShzKS4KCSAgXy53aXRob3V0ID0gZnVuY3Rpb24oYXJyYXkpIHsKCSAgICByZXR1cm4gXy5kaWZmZXJlbmNlKGFycmF5LCBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpOwoJICB9OwoKCSAgLy8gUHJvZHVjZSBhIGR1cGxpY2F0ZS1mcmVlIHZlcnNpb24gb2YgdGhlIGFycmF5LiBJZiB0aGUgYXJyYXkgaGFzIGFscmVhZHkKCSAgLy8gYmVlbiBzb3J0ZWQsIHlvdSBoYXZlIHRoZSBvcHRpb24gb2YgdXNpbmcgYSBmYXN0ZXIgYWxnb3JpdGhtLgoJICAvLyBBbGlhc2VkIGFzIGB1bmlxdWVgLgoJICBfLnVuaXEgPSBfLnVuaXF1ZSA9IGZ1bmN0aW9uKGFycmF5LCBpc1NvcnRlZCwgaXRlcmF0ZWUsIGNvbnRleHQpIHsKCSAgICBpZiAoIV8uaXNCb29sZWFuKGlzU29ydGVkKSkgewoJICAgICAgY29udGV4dCA9IGl0ZXJhdGVlOwoJICAgICAgaXRlcmF0ZWUgPSBpc1NvcnRlZDsKCSAgICAgIGlzU29ydGVkID0gZmFsc2U7CgkgICAgfQoJICAgIGlmIChpdGVyYXRlZSAhPSBudWxsKSBpdGVyYXRlZSA9IGNiKGl0ZXJhdGVlLCBjb250ZXh0KTsKCSAgICB2YXIgcmVzdWx0ID0gW107CgkgICAgdmFyIHNlZW4gPSBbXTsKCSAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gZ2V0TGVuZ3RoKGFycmF5KTsgaSA8IGxlbmd0aDsgaSsrKSB7CgkgICAgICB2YXIgdmFsdWUgPSBhcnJheVtpXSwKCSAgICAgICAgICBjb21wdXRlZCA9IGl0ZXJhdGVlID8gaXRlcmF0ZWUodmFsdWUsIGksIGFycmF5KSA6IHZhbHVlOwoJICAgICAgaWYgKGlzU29ydGVkKSB7CgkgICAgICAgIGlmICghaSB8fCBzZWVuICE9PSBjb21wdXRlZCkgcmVzdWx0LnB1c2godmFsdWUpOwoJICAgICAgICBzZWVuID0gY29tcHV0ZWQ7CgkgICAgICB9IGVsc2UgaWYgKGl0ZXJhdGVlKSB7CgkgICAgICAgIGlmICghXy5jb250YWlucyhzZWVuLCBjb21wdXRlZCkpIHsKCSAgICAgICAgICBzZWVuLnB1c2goY29tcHV0ZWQpOwoJICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTsKCSAgICAgICAgfQoJICAgICAgfSBlbHNlIGlmICghXy5jb250YWlucyhyZXN1bHQsIHZhbHVlKSkgewoJICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7CgkgICAgICB9CgkgICAgfQoJICAgIHJldHVybiByZXN1bHQ7CgkgIH07CgoJICAvLyBQcm9kdWNlIGFuIGFycmF5IHRoYXQgY29udGFpbnMgdGhlIHVuaW9uOiBlYWNoIGRpc3RpbmN0IGVsZW1lbnQgZnJvbSBhbGwgb2YKCSAgLy8gdGhlIHBhc3NlZC1pbiBhcnJheXMuCgkgIF8udW5pb24gPSBmdW5jdGlvbigpIHsKCSAgICByZXR1cm4gXy51bmlxKGZsYXR0ZW4oYXJndW1lbnRzLCB0cnVlLCB0cnVlKSk7CgkgIH07CgoJICAvLyBQcm9kdWNlIGFuIGFycmF5IHRoYXQgY29udGFpbnMgZXZlcnkgaXRlbSBzaGFyZWQgYmV0d2VlbiBhbGwgdGhlCgkgIC8vIHBhc3NlZC1pbiBhcnJheXMuCgkgIF8uaW50ZXJzZWN0aW9uID0gZnVuY3Rpb24oYXJyYXkpIHsKCSAgICB2YXIgcmVzdWx0ID0gW107CgkgICAgdmFyIGFyZ3NMZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoOwoJICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBnZXRMZW5ndGgoYXJyYXkpOyBpIDwgbGVuZ3RoOyBpKyspIHsKCSAgICAgIHZhciBpdGVtID0gYXJyYXlbaV07CgkgICAgICBpZiAoXy5jb250YWlucyhyZXN1bHQsIGl0ZW0pKSBjb250aW51ZTsKCSAgICAgIGZvciAodmFyIGogPSAxOyBqIDwgYXJnc0xlbmd0aDsgaisrKSB7CgkgICAgICAgIGlmICghXy5jb250YWlucyhhcmd1bWVudHNbal0sIGl0ZW0pKSBicmVhazsKCSAgICAgIH0KCSAgICAgIGlmIChqID09PSBhcmdzTGVuZ3RoKSByZXN1bHQucHVzaChpdGVtKTsKCSAgICB9CgkgICAgcmV0dXJuIHJlc3VsdDsKCSAgfTsKCgkgIC8vIFRha2UgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiBvbmUgYXJyYXkgYW5kIGEgbnVtYmVyIG9mIG90aGVyIGFycmF5cy4KCSAgLy8gT25seSB0aGUgZWxlbWVudHMgcHJlc2VudCBpbiBqdXN0IHRoZSBmaXJzdCBhcnJheSB3aWxsIHJlbWFpbi4KCSAgXy5kaWZmZXJlbmNlID0gZnVuY3Rpb24oYXJyYXkpIHsKCSAgICB2YXIgcmVzdCA9IGZsYXR0ZW4oYXJndW1lbnRzLCB0cnVlLCB0cnVlLCAxKTsKCSAgICByZXR1cm4gXy5maWx0ZXIoYXJyYXksIGZ1bmN0aW9uKHZhbHVlKXsKCSAgICAgIHJldHVybiAhXy5jb250YWlucyhyZXN0LCB2YWx1ZSk7CgkgICAgfSk7CgkgIH07CgoJICAvLyBaaXAgdG9nZXRoZXIgbXVsdGlwbGUgbGlzdHMgaW50byBhIHNpbmdsZSBhcnJheSAtLSBlbGVtZW50cyB0aGF0IHNoYXJlCgkgIC8vIGFuIGluZGV4IGdvIHRvZ2V0aGVyLgoJICBfLnppcCA9IGZ1bmN0aW9uKCkgewoJICAgIHJldHVybiBfLnVuemlwKGFyZ3VtZW50cyk7CgkgIH07CgoJICAvLyBDb21wbGVtZW50IG9mIF8uemlwLiBVbnppcCBhY2NlcHRzIGFuIGFycmF5IG9mIGFycmF5cyBhbmQgZ3JvdXBzCgkgIC8vIGVhY2ggYXJyYXkncyBlbGVtZW50cyBvbiBzaGFyZWQgaW5kaWNlcwoJICBfLnVuemlwID0gZnVuY3Rpb24oYXJyYXkpIHsKCSAgICB2YXIgbGVuZ3RoID0gYXJyYXkgJiYgXy5tYXgoYXJyYXksIGdldExlbmd0aCkubGVuZ3RoIHx8IDA7CgkgICAgdmFyIHJlc3VsdCA9IEFycmF5KGxlbmd0aCk7CgoJICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHsKCSAgICAgIHJlc3VsdFtpbmRleF0gPSBfLnBsdWNrKGFycmF5LCBpbmRleCk7CgkgICAgfQoJICAgIHJldHVybiByZXN1bHQ7CgkgIH07CgoJICAvLyBDb252ZXJ0cyBsaXN0cyBpbnRvIG9iamVjdHMuIFBhc3MgZWl0aGVyIGEgc2luZ2xlIGFycmF5IG9mIGBba2V5LCB2YWx1ZV1gCgkgIC8vIHBhaXJzLCBvciB0d28gcGFyYWxsZWwgYXJyYXlzIG9mIHRoZSBzYW1lIGxlbmd0aCAtLSBvbmUgb2Yga2V5cywgYW5kIG9uZSBvZgoJICAvLyB0aGUgY29ycmVzcG9uZGluZyB2YWx1ZXMuCgkgIF8ub2JqZWN0ID0gZnVuY3Rpb24obGlzdCwgdmFsdWVzKSB7CgkgICAgdmFyIHJlc3VsdCA9IHt9OwoJICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBnZXRMZW5ndGgobGlzdCk7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgaWYgKHZhbHVlcykgewoJICAgICAgICByZXN1bHRbbGlzdFtpXV0gPSB2YWx1ZXNbaV07CgkgICAgICB9IGVsc2UgewoJICAgICAgICByZXN1bHRbbGlzdFtpXVswXV0gPSBsaXN0W2ldWzFdOwoJICAgICAgfQoJICAgIH0KCSAgICByZXR1cm4gcmVzdWx0OwoJICB9OwoKCSAgLy8gR2VuZXJhdG9yIGZ1bmN0aW9uIHRvIGNyZWF0ZSB0aGUgZmluZEluZGV4IGFuZCBmaW5kTGFzdEluZGV4IGZ1bmN0aW9ucwoJICBmdW5jdGlvbiBjcmVhdGVQcmVkaWNhdGVJbmRleEZpbmRlcihkaXIpIHsKCSAgICByZXR1cm4gZnVuY3Rpb24oYXJyYXksIHByZWRpY2F0ZSwgY29udGV4dCkgewoJICAgICAgcHJlZGljYXRlID0gY2IocHJlZGljYXRlLCBjb250ZXh0KTsKCSAgICAgIHZhciBsZW5ndGggPSBnZXRMZW5ndGgoYXJyYXkpOwoJICAgICAgdmFyIGluZGV4ID0gZGlyID4gMCA/IDAgOiBsZW5ndGggLSAxOwoJICAgICAgZm9yICg7IGluZGV4ID49IDAgJiYgaW5kZXggPCBsZW5ndGg7IGluZGV4ICs9IGRpcikgewoJICAgICAgICBpZiAocHJlZGljYXRlKGFycmF5W2luZGV4XSwgaW5kZXgsIGFycmF5KSkgcmV0dXJuIGluZGV4OwoJICAgICAgfQoJICAgICAgcmV0dXJuIC0xOwoJICAgIH07CgkgIH0KCgkgIC8vIFJldHVybnMgdGhlIGZpcnN0IGluZGV4IG9uIGFuIGFycmF5LWxpa2UgdGhhdCBwYXNzZXMgYSBwcmVkaWNhdGUgdGVzdAoJICBfLmZpbmRJbmRleCA9IGNyZWF0ZVByZWRpY2F0ZUluZGV4RmluZGVyKDEpOwoJICBfLmZpbmRMYXN0SW5kZXggPSBjcmVhdGVQcmVkaWNhdGVJbmRleEZpbmRlcigtMSk7CgoJICAvLyBVc2UgYSBjb21wYXJhdG9yIGZ1bmN0aW9uIHRvIGZpZ3VyZSBvdXQgdGhlIHNtYWxsZXN0IGluZGV4IGF0IHdoaWNoCgkgIC8vIGFuIG9iamVjdCBzaG91bGQgYmUgaW5zZXJ0ZWQgc28gYXMgdG8gbWFpbnRhaW4gb3JkZXIuIFVzZXMgYmluYXJ5IHNlYXJjaC4KCSAgXy5zb3J0ZWRJbmRleCA9IGZ1bmN0aW9uKGFycmF5LCBvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7CgkgICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCwgMSk7CgkgICAgdmFyIHZhbHVlID0gaXRlcmF0ZWUob2JqKTsKCSAgICB2YXIgbG93ID0gMCwgaGlnaCA9IGdldExlbmd0aChhcnJheSk7CgkgICAgd2hpbGUgKGxvdyA8IGhpZ2gpIHsKCSAgICAgIHZhciBtaWQgPSBNYXRoLmZsb29yKChsb3cgKyBoaWdoKSAvIDIpOwoJICAgICAgaWYgKGl0ZXJhdGVlKGFycmF5W21pZF0pIDwgdmFsdWUpIGxvdyA9IG1pZCArIDE7IGVsc2UgaGlnaCA9IG1pZDsKCSAgICB9CgkgICAgcmV0dXJuIGxvdzsKCSAgfTsKCgkgIC8vIEdlbmVyYXRvciBmdW5jdGlvbiB0byBjcmVhdGUgdGhlIGluZGV4T2YgYW5kIGxhc3RJbmRleE9mIGZ1bmN0aW9ucwoJICBmdW5jdGlvbiBjcmVhdGVJbmRleEZpbmRlcihkaXIsIHByZWRpY2F0ZUZpbmQsIHNvcnRlZEluZGV4KSB7CgkgICAgcmV0dXJuIGZ1bmN0aW9uKGFycmF5LCBpdGVtLCBpZHgpIHsKCSAgICAgIHZhciBpID0gMCwgbGVuZ3RoID0gZ2V0TGVuZ3RoKGFycmF5KTsKCSAgICAgIGlmICh0eXBlb2YgaWR4ID09ICdudW1iZXInKSB7CgkgICAgICAgIGlmIChkaXIgPiAwKSB7CgkgICAgICAgICAgICBpID0gaWR4ID49IDAgPyBpZHggOiBNYXRoLm1heChpZHggKyBsZW5ndGgsIGkpOwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgbGVuZ3RoID0gaWR4ID49IDAgPyBNYXRoLm1pbihpZHggKyAxLCBsZW5ndGgpIDogaWR4ICsgbGVuZ3RoICsgMTsKCSAgICAgICAgfQoJICAgICAgfSBlbHNlIGlmIChzb3J0ZWRJbmRleCAmJiBpZHggJiYgbGVuZ3RoKSB7CgkgICAgICAgIGlkeCA9IHNvcnRlZEluZGV4KGFycmF5LCBpdGVtKTsKCSAgICAgICAgcmV0dXJuIGFycmF5W2lkeF0gPT09IGl0ZW0gPyBpZHggOiAtMTsKCSAgICAgIH0KCSAgICAgIGlmIChpdGVtICE9PSBpdGVtKSB7CgkgICAgICAgIGlkeCA9IHByZWRpY2F0ZUZpbmQoc2xpY2UuY2FsbChhcnJheSwgaSwgbGVuZ3RoKSwgXy5pc05hTik7CgkgICAgICAgIHJldHVybiBpZHggPj0gMCA/IGlkeCArIGkgOiAtMTsKCSAgICAgIH0KCSAgICAgIGZvciAoaWR4ID0gZGlyID4gMCA/IGkgOiBsZW5ndGggLSAxOyBpZHggPj0gMCAmJiBpZHggPCBsZW5ndGg7IGlkeCArPSBkaXIpIHsKCSAgICAgICAgaWYgKGFycmF5W2lkeF0gPT09IGl0ZW0pIHJldHVybiBpZHg7CgkgICAgICB9CgkgICAgICByZXR1cm4gLTE7CgkgICAgfTsKCSAgfQoKCSAgLy8gUmV0dXJuIHRoZSBwb3NpdGlvbiBvZiB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhbiBpdGVtIGluIGFuIGFycmF5LAoJICAvLyBvciAtMSBpZiB0aGUgaXRlbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhlIGFycmF5LgoJICAvLyBJZiB0aGUgYXJyYXkgaXMgbGFyZ2UgYW5kIGFscmVhZHkgaW4gc29ydCBvcmRlciwgcGFzcyBgdHJ1ZWAKCSAgLy8gZm9yICoqaXNTb3J0ZWQqKiB0byB1c2UgYmluYXJ5IHNlYXJjaC4KCSAgXy5pbmRleE9mID0gY3JlYXRlSW5kZXhGaW5kZXIoMSwgXy5maW5kSW5kZXgsIF8uc29ydGVkSW5kZXgpOwoJICBfLmxhc3RJbmRleE9mID0gY3JlYXRlSW5kZXhGaW5kZXIoLTEsIF8uZmluZExhc3RJbmRleCk7CgoJICAvLyBHZW5lcmF0ZSBhbiBpbnRlZ2VyIEFycmF5IGNvbnRhaW5pbmcgYW4gYXJpdGhtZXRpYyBwcm9ncmVzc2lvbi4gQSBwb3J0IG9mCgkgIC8vIHRoZSBuYXRpdmUgUHl0aG9uIGByYW5nZSgpYCBmdW5jdGlvbi4gU2VlCgkgIC8vIFt0aGUgUHl0aG9uIGRvY3VtZW50YXRpb25dKGh0dHA6Ly9kb2NzLnB5dGhvbi5vcmcvbGlicmFyeS9mdW5jdGlvbnMuaHRtbCNyYW5nZSkuCgkgIF8ucmFuZ2UgPSBmdW5jdGlvbihzdGFydCwgc3RvcCwgc3RlcCkgewoJICAgIGlmIChzdG9wID09IG51bGwpIHsKCSAgICAgIHN0b3AgPSBzdGFydCB8fCAwOwoJICAgICAgc3RhcnQgPSAwOwoJICAgIH0KCSAgICBzdGVwID0gc3RlcCB8fCAxOwoKCSAgICB2YXIgbGVuZ3RoID0gTWF0aC5tYXgoTWF0aC5jZWlsKChzdG9wIC0gc3RhcnQpIC8gc3RlcCksIDApOwoJICAgIHZhciByYW5nZSA9IEFycmF5KGxlbmd0aCk7CgoJICAgIGZvciAodmFyIGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyssIHN0YXJ0ICs9IHN0ZXApIHsKCSAgICAgIHJhbmdlW2lkeF0gPSBzdGFydDsKCSAgICB9CgoJICAgIHJldHVybiByYW5nZTsKCSAgfTsKCgkgIC8vIEZ1bmN0aW9uIChhaGVtKSBGdW5jdGlvbnMKCSAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tCgoJICAvLyBEZXRlcm1pbmVzIHdoZXRoZXIgdG8gZXhlY3V0ZSBhIGZ1bmN0aW9uIGFzIGEgY29uc3RydWN0b3IKCSAgLy8gb3IgYSBub3JtYWwgZnVuY3Rpb24gd2l0aCB0aGUgcHJvdmlkZWQgYXJndW1lbnRzCgkgIHZhciBleGVjdXRlQm91bmQgPSBmdW5jdGlvbihzb3VyY2VGdW5jLCBib3VuZEZ1bmMsIGNvbnRleHQsIGNhbGxpbmdDb250ZXh0LCBhcmdzKSB7CgkgICAgaWYgKCEoY2FsbGluZ0NvbnRleHQgaW5zdGFuY2VvZiBib3VuZEZ1bmMpKSByZXR1cm4gc291cmNlRnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTsKCSAgICB2YXIgc2VsZiA9IGJhc2VDcmVhdGUoc291cmNlRnVuYy5wcm90b3R5cGUpOwoJICAgIHZhciByZXN1bHQgPSBzb3VyY2VGdW5jLmFwcGx5KHNlbGYsIGFyZ3MpOwoJICAgIGlmIChfLmlzT2JqZWN0KHJlc3VsdCkpIHJldHVybiByZXN1bHQ7CgkgICAgcmV0dXJuIHNlbGY7CgkgIH07CgoJICAvLyBDcmVhdGUgYSBmdW5jdGlvbiBib3VuZCB0byBhIGdpdmVuIG9iamVjdCAoYXNzaWduaW5nIGB0aGlzYCwgYW5kIGFyZ3VtZW50cywKCSAgLy8gb3B0aW9uYWxseSkuIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBGdW5jdGlvbi5iaW5kYCBpZgoJICAvLyBhdmFpbGFibGUuCgkgIF8uYmluZCA9IGZ1bmN0aW9uKGZ1bmMsIGNvbnRleHQpIHsKCSAgICBpZiAobmF0aXZlQmluZCAmJiBmdW5jLmJpbmQgPT09IG5hdGl2ZUJpbmQpIHJldHVybiBuYXRpdmVCaW5kLmFwcGx5KGZ1bmMsIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7CgkgICAgaWYgKCFfLmlzRnVuY3Rpb24oZnVuYykpIHRocm93IG5ldyBUeXBlRXJyb3IoJ0JpbmQgbXVzdCBiZSBjYWxsZWQgb24gYSBmdW5jdGlvbicpOwoJICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpOwoJICAgIHZhciBib3VuZCA9IGZ1bmN0aW9uKCkgewoJICAgICAgcmV0dXJuIGV4ZWN1dGVCb3VuZChmdW5jLCBib3VuZCwgY29udGV4dCwgdGhpcywgYXJncy5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7CgkgICAgfTsKCSAgICByZXR1cm4gYm91bmQ7CgkgIH07CgoJICAvLyBQYXJ0aWFsbHkgYXBwbHkgYSBmdW5jdGlvbiBieSBjcmVhdGluZyBhIHZlcnNpb24gdGhhdCBoYXMgaGFkIHNvbWUgb2YgaXRzCgkgIC8vIGFyZ3VtZW50cyBwcmUtZmlsbGVkLCB3aXRob3V0IGNoYW5naW5nIGl0cyBkeW5hbWljIGB0aGlzYCBjb250ZXh0LiBfIGFjdHMKCSAgLy8gYXMgYSBwbGFjZWhvbGRlciwgYWxsb3dpbmcgYW55IGNvbWJpbmF0aW9uIG9mIGFyZ3VtZW50cyB0byBiZSBwcmUtZmlsbGVkLgoJICBfLnBhcnRpYWwgPSBmdW5jdGlvbihmdW5jKSB7CgkgICAgdmFyIGJvdW5kQXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKCSAgICB2YXIgYm91bmQgPSBmdW5jdGlvbigpIHsKCSAgICAgIHZhciBwb3NpdGlvbiA9IDAsIGxlbmd0aCA9IGJvdW5kQXJncy5sZW5ndGg7CgkgICAgICB2YXIgYXJncyA9IEFycmF5KGxlbmd0aCk7CgkgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CgkgICAgICAgIGFyZ3NbaV0gPSBib3VuZEFyZ3NbaV0gPT09IF8gPyBhcmd1bWVudHNbcG9zaXRpb24rK10gOiBib3VuZEFyZ3NbaV07CgkgICAgICB9CgkgICAgICB3aGlsZSAocG9zaXRpb24gPCBhcmd1bWVudHMubGVuZ3RoKSBhcmdzLnB1c2goYXJndW1lbnRzW3Bvc2l0aW9uKytdKTsKCSAgICAgIHJldHVybiBleGVjdXRlQm91bmQoZnVuYywgYm91bmQsIHRoaXMsIHRoaXMsIGFyZ3MpOwoJICAgIH07CgkgICAgcmV0dXJuIGJvdW5kOwoJICB9OwoKCSAgLy8gQmluZCBhIG51bWJlciBvZiBhbiBvYmplY3QncyBtZXRob2RzIHRvIHRoYXQgb2JqZWN0LiBSZW1haW5pbmcgYXJndW1lbnRzCgkgIC8vIGFyZSB0aGUgbWV0aG9kIG5hbWVzIHRvIGJlIGJvdW5kLiBVc2VmdWwgZm9yIGVuc3VyaW5nIHRoYXQgYWxsIGNhbGxiYWNrcwoJICAvLyBkZWZpbmVkIG9uIGFuIG9iamVjdCBiZWxvbmcgdG8gaXQuCgkgIF8uYmluZEFsbCA9IGZ1bmN0aW9uKG9iaikgewoJICAgIHZhciBpLCBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoLCBrZXk7CgkgICAgaWYgKGxlbmd0aCA8PSAxKSB0aHJvdyBuZXcgRXJyb3IoJ2JpbmRBbGwgbXVzdCBiZSBwYXNzZWQgZnVuY3Rpb24gbmFtZXMnKTsKCSAgICBmb3IgKGkgPSAxOyBpIDwgbGVuZ3RoOyBpKyspIHsKCSAgICAgIGtleSA9IGFyZ3VtZW50c1tpXTsKCSAgICAgIG9ialtrZXldID0gXy5iaW5kKG9ialtrZXldLCBvYmopOwoJICAgIH0KCSAgICByZXR1cm4gb2JqOwoJICB9OwoKCSAgLy8gTWVtb2l6ZSBhbiBleHBlbnNpdmUgZnVuY3Rpb24gYnkgc3RvcmluZyBpdHMgcmVzdWx0cy4KCSAgXy5tZW1vaXplID0gZnVuY3Rpb24oZnVuYywgaGFzaGVyKSB7CgkgICAgdmFyIG1lbW9pemUgPSBmdW5jdGlvbihrZXkpIHsKCSAgICAgIHZhciBjYWNoZSA9IG1lbW9pemUuY2FjaGU7CgkgICAgICB2YXIgYWRkcmVzcyA9ICcnICsgKGhhc2hlciA/IGhhc2hlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIDoga2V5KTsKCSAgICAgIGlmICghXy5oYXMoY2FjaGUsIGFkZHJlc3MpKSBjYWNoZVthZGRyZXNzXSA9IGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCSAgICAgIHJldHVybiBjYWNoZVthZGRyZXNzXTsKCSAgICB9OwoJICAgIG1lbW9pemUuY2FjaGUgPSB7fTsKCSAgICByZXR1cm4gbWVtb2l6ZTsKCSAgfTsKCgkgIC8vIERlbGF5cyBhIGZ1bmN0aW9uIGZvciB0aGUgZ2l2ZW4gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcywgYW5kIHRoZW4gY2FsbHMKCSAgLy8gaXQgd2l0aCB0aGUgYXJndW1lbnRzIHN1cHBsaWVkLgoJICBfLmRlbGF5ID0gZnVuY3Rpb24oZnVuYywgd2FpdCkgewoJICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpOwoJICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CgkgICAgICByZXR1cm4gZnVuYy5hcHBseShudWxsLCBhcmdzKTsKCSAgICB9LCB3YWl0KTsKCSAgfTsKCgkgIC8vIERlZmVycyBhIGZ1bmN0aW9uLCBzY2hlZHVsaW5nIGl0IHRvIHJ1biBhZnRlciB0aGUgY3VycmVudCBjYWxsIHN0YWNrIGhhcwoJICAvLyBjbGVhcmVkLgoJICBfLmRlZmVyID0gXy5wYXJ0aWFsKF8uZGVsYXksIF8sIDEpOwoKCSAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCB3aGVuIGludm9rZWQsIHdpbGwgb25seSBiZSB0cmlnZ2VyZWQgYXQgbW9zdCBvbmNlCgkgIC8vIGR1cmluZyBhIGdpdmVuIHdpbmRvdyBvZiB0aW1lLiBOb3JtYWxseSwgdGhlIHRocm90dGxlZCBmdW5jdGlvbiB3aWxsIHJ1bgoJICAvLyBhcyBtdWNoIGFzIGl0IGNhbiwgd2l0aG91dCBldmVyIGdvaW5nIG1vcmUgdGhhbiBvbmNlIHBlciBgd2FpdGAgZHVyYXRpb247CgkgIC8vIGJ1dCBpZiB5b3UnZCBsaWtlIHRvIGRpc2FibGUgdGhlIGV4ZWN1dGlvbiBvbiB0aGUgbGVhZGluZyBlZGdlLCBwYXNzCgkgIC8vIGB7bGVhZGluZzogZmFsc2V9YC4gVG8gZGlzYWJsZSBleGVjdXRpb24gb24gdGhlIHRyYWlsaW5nIGVkZ2UsIGRpdHRvLgoJICBfLnRocm90dGxlID0gZnVuY3Rpb24oZnVuYywgd2FpdCwgb3B0aW9ucykgewoJICAgIHZhciBjb250ZXh0LCBhcmdzLCByZXN1bHQ7CgkgICAgdmFyIHRpbWVvdXQgPSBudWxsOwoJICAgIHZhciBwcmV2aW91cyA9IDA7CgkgICAgaWYgKCFvcHRpb25zKSBvcHRpb25zID0ge307CgkgICAgdmFyIGxhdGVyID0gZnVuY3Rpb24oKSB7CgkgICAgICBwcmV2aW91cyA9IG9wdGlvbnMubGVhZGluZyA9PT0gZmFsc2UgPyAwIDogXy5ub3coKTsKCSAgICAgIHRpbWVvdXQgPSBudWxsOwoJICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTsKCSAgICAgIGlmICghdGltZW91dCkgY29udGV4dCA9IGFyZ3MgPSBudWxsOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uKCkgewoJICAgICAgdmFyIG5vdyA9IF8ubm93KCk7CgkgICAgICBpZiAoIXByZXZpb3VzICYmIG9wdGlvbnMubGVhZGluZyA9PT0gZmFsc2UpIHByZXZpb3VzID0gbm93OwoJICAgICAgdmFyIHJlbWFpbmluZyA9IHdhaXQgLSAobm93IC0gcHJldmlvdXMpOwoJICAgICAgY29udGV4dCA9IHRoaXM7CgkgICAgICBhcmdzID0gYXJndW1lbnRzOwoJICAgICAgaWYgKHJlbWFpbmluZyA8PSAwIHx8IHJlbWFpbmluZyA+IHdhaXQpIHsKCSAgICAgICAgaWYgKHRpbWVvdXQpIHsKCSAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7CgkgICAgICAgICAgdGltZW91dCA9IG51bGw7CgkgICAgICAgIH0KCSAgICAgICAgcHJldmlvdXMgPSBub3c7CgkgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7CgkgICAgICAgIGlmICghdGltZW91dCkgY29udGV4dCA9IGFyZ3MgPSBudWxsOwoJICAgICAgfSBlbHNlIGlmICghdGltZW91dCAmJiBvcHRpb25zLnRyYWlsaW5nICE9PSBmYWxzZSkgewoJICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgcmVtYWluaW5nKTsKCSAgICAgIH0KCSAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgfTsKCgkgIC8vIFJldHVybnMgYSBmdW5jdGlvbiwgdGhhdCwgYXMgbG9uZyBhcyBpdCBjb250aW51ZXMgdG8gYmUgaW52b2tlZCwgd2lsbCBub3QKCSAgLy8gYmUgdHJpZ2dlcmVkLiBUaGUgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgaXQgc3RvcHMgYmVpbmcgY2FsbGVkIGZvcgoJICAvLyBOIG1pbGxpc2Vjb25kcy4gSWYgYGltbWVkaWF0ZWAgaXMgcGFzc2VkLCB0cmlnZ2VyIHRoZSBmdW5jdGlvbiBvbiB0aGUKCSAgLy8gbGVhZGluZyBlZGdlLCBpbnN0ZWFkIG9mIHRoZSB0cmFpbGluZy4KCSAgXy5kZWJvdW5jZSA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSkgewoJICAgIHZhciB0aW1lb3V0LCBhcmdzLCBjb250ZXh0LCB0aW1lc3RhbXAsIHJlc3VsdDsKCgkgICAgdmFyIGxhdGVyID0gZnVuY3Rpb24oKSB7CgkgICAgICB2YXIgbGFzdCA9IF8ubm93KCkgLSB0aW1lc3RhbXA7CgoJICAgICAgaWYgKGxhc3QgPCB3YWl0ICYmIGxhc3QgPj0gMCkgewoJICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCAtIGxhc3QpOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgdGltZW91dCA9IG51bGw7CgkgICAgICAgIGlmICghaW1tZWRpYXRlKSB7CgkgICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTsKCSAgICAgICAgICBpZiAoIXRpbWVvdXQpIGNvbnRleHQgPSBhcmdzID0gbnVsbDsKCSAgICAgICAgfQoJICAgICAgfQoJICAgIH07CgoJICAgIHJldHVybiBmdW5jdGlvbigpIHsKCSAgICAgIGNvbnRleHQgPSB0aGlzOwoJICAgICAgYXJncyA9IGFyZ3VtZW50czsKCSAgICAgIHRpbWVzdGFtcCA9IF8ubm93KCk7CgkgICAgICB2YXIgY2FsbE5vdyA9IGltbWVkaWF0ZSAmJiAhdGltZW91dDsKCSAgICAgIGlmICghdGltZW91dCkgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHdhaXQpOwoJICAgICAgaWYgKGNhbGxOb3cpIHsKCSAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTsKCSAgICAgICAgY29udGV4dCA9IGFyZ3MgPSBudWxsOwoJICAgICAgfQoKCSAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgfTsKCgkgIC8vIFJldHVybnMgdGhlIGZpcnN0IGZ1bmN0aW9uIHBhc3NlZCBhcyBhbiBhcmd1bWVudCB0byB0aGUgc2Vjb25kLAoJICAvLyBhbGxvd2luZyB5b3UgdG8gYWRqdXN0IGFyZ3VtZW50cywgcnVuIGNvZGUgYmVmb3JlIGFuZCBhZnRlciwgYW5kCgkgIC8vIGNvbmRpdGlvbmFsbHkgZXhlY3V0ZSB0aGUgb3JpZ2luYWwgZnVuY3Rpb24uCgkgIF8ud3JhcCA9IGZ1bmN0aW9uKGZ1bmMsIHdyYXBwZXIpIHsKCSAgICByZXR1cm4gXy5wYXJ0aWFsKHdyYXBwZXIsIGZ1bmMpOwoJICB9OwoKCSAgLy8gUmV0dXJucyBhIG5lZ2F0ZWQgdmVyc2lvbiBvZiB0aGUgcGFzc2VkLWluIHByZWRpY2F0ZS4KCSAgXy5uZWdhdGUgPSBmdW5jdGlvbihwcmVkaWNhdGUpIHsKCSAgICByZXR1cm4gZnVuY3Rpb24oKSB7CgkgICAgICByZXR1cm4gIXByZWRpY2F0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJICAgIH07CgkgIH07CgoJICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCBpcyB0aGUgY29tcG9zaXRpb24gb2YgYSBsaXN0IG9mIGZ1bmN0aW9ucywgZWFjaAoJICAvLyBjb25zdW1pbmcgdGhlIHJldHVybiB2YWx1ZSBvZiB0aGUgZnVuY3Rpb24gdGhhdCBmb2xsb3dzLgoJICBfLmNvbXBvc2UgPSBmdW5jdGlvbigpIHsKCSAgICB2YXIgYXJncyA9IGFyZ3VtZW50czsKCSAgICB2YXIgc3RhcnQgPSBhcmdzLmxlbmd0aCAtIDE7CgkgICAgcmV0dXJuIGZ1bmN0aW9uKCkgewoJICAgICAgdmFyIGkgPSBzdGFydDsKCSAgICAgIHZhciByZXN1bHQgPSBhcmdzW3N0YXJ0XS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJICAgICAgd2hpbGUgKGktLSkgcmVzdWx0ID0gYXJnc1tpXS5jYWxsKHRoaXMsIHJlc3VsdCk7CgkgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgIH07CgoJICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCB3aWxsIG9ubHkgYmUgZXhlY3V0ZWQgb24gYW5kIGFmdGVyIHRoZSBOdGggY2FsbC4KCSAgXy5hZnRlciA9IGZ1bmN0aW9uKHRpbWVzLCBmdW5jKSB7CgkgICAgcmV0dXJuIGZ1bmN0aW9uKCkgewoJICAgICAgaWYgKC0tdGltZXMgPCAxKSB7CgkgICAgICAgIHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgkgICAgICB9CgkgICAgfTsKCSAgfTsKCgkgIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgb25seSBiZSBleGVjdXRlZCB1cCB0byAoYnV0IG5vdCBpbmNsdWRpbmcpIHRoZSBOdGggY2FsbC4KCSAgXy5iZWZvcmUgPSBmdW5jdGlvbih0aW1lcywgZnVuYykgewoJICAgIHZhciBtZW1vOwoJICAgIHJldHVybiBmdW5jdGlvbigpIHsKCSAgICAgIGlmICgtLXRpbWVzID4gMCkgewoJICAgICAgICBtZW1vID0gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJICAgICAgfQoJICAgICAgaWYgKHRpbWVzIDw9IDEpIGZ1bmMgPSBudWxsOwoJICAgICAgcmV0dXJuIG1lbW87CgkgICAgfTsKCSAgfTsKCgkgIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgZXhlY3V0ZWQgYXQgbW9zdCBvbmUgdGltZSwgbm8gbWF0dGVyIGhvdwoJICAvLyBvZnRlbiB5b3UgY2FsbCBpdC4gVXNlZnVsIGZvciBsYXp5IGluaXRpYWxpemF0aW9uLgoJICBfLm9uY2UgPSBfLnBhcnRpYWwoXy5iZWZvcmUsIDIpOwoKCSAgLy8gT2JqZWN0IEZ1bmN0aW9ucwoJICAvLyAtLS0tLS0tLS0tLS0tLS0tCgoJICAvLyBLZXlzIGluIElFIDwgOSB0aGF0IHdvbid0IGJlIGl0ZXJhdGVkIGJ5IGBmb3Iga2V5IGluIC4uLmAgYW5kIHRodXMgbWlzc2VkLgoJICB2YXIgaGFzRW51bUJ1ZyA9ICF7dG9TdHJpbmc6IG51bGx9LnByb3BlcnR5SXNFbnVtZXJhYmxlKCd0b1N0cmluZycpOwoJICB2YXIgbm9uRW51bWVyYWJsZVByb3BzID0gWyd2YWx1ZU9mJywgJ2lzUHJvdG90eXBlT2YnLCAndG9TdHJpbmcnLAoJICAgICAgICAgICAgICAgICAgICAgICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsICdoYXNPd25Qcm9wZXJ0eScsICd0b0xvY2FsZVN0cmluZyddOwoKCSAgZnVuY3Rpb24gY29sbGVjdE5vbkVudW1Qcm9wcyhvYmosIGtleXMpIHsKCSAgICB2YXIgbm9uRW51bUlkeCA9IG5vbkVudW1lcmFibGVQcm9wcy5sZW5ndGg7CgkgICAgdmFyIGNvbnN0cnVjdG9yID0gb2JqLmNvbnN0cnVjdG9yOwoJICAgIHZhciBwcm90byA9IChfLmlzRnVuY3Rpb24oY29uc3RydWN0b3IpICYmIGNvbnN0cnVjdG9yLnByb3RvdHlwZSkgfHwgT2JqUHJvdG87CgoJICAgIC8vIENvbnN0cnVjdG9yIGlzIGEgc3BlY2lhbCBjYXNlLgoJICAgIHZhciBwcm9wID0gJ2NvbnN0cnVjdG9yJzsKCSAgICBpZiAoXy5oYXMob2JqLCBwcm9wKSAmJiAhXy5jb250YWlucyhrZXlzLCBwcm9wKSkga2V5cy5wdXNoKHByb3ApOwoKCSAgICB3aGlsZSAobm9uRW51bUlkeC0tKSB7CgkgICAgICBwcm9wID0gbm9uRW51bWVyYWJsZVByb3BzW25vbkVudW1JZHhdOwoJICAgICAgaWYgKHByb3AgaW4gb2JqICYmIG9ialtwcm9wXSAhPT0gcHJvdG9bcHJvcF0gJiYgIV8uY29udGFpbnMoa2V5cywgcHJvcCkpIHsKCSAgICAgICAga2V5cy5wdXNoKHByb3ApOwoJICAgICAgfQoJICAgIH0KCSAgfQoKCSAgLy8gUmV0cmlldmUgdGhlIG5hbWVzIG9mIGFuIG9iamVjdCdzIG93biBwcm9wZXJ0aWVzLgoJICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgT2JqZWN0LmtleXNgCgkgIF8ua2V5cyA9IGZ1bmN0aW9uKG9iaikgewoJICAgIGlmICghXy5pc09iamVjdChvYmopKSByZXR1cm4gW107CgkgICAgaWYgKG5hdGl2ZUtleXMpIHJldHVybiBuYXRpdmVLZXlzKG9iaik7CgkgICAgdmFyIGtleXMgPSBbXTsKCSAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSBpZiAoXy5oYXMob2JqLCBrZXkpKSBrZXlzLnB1c2goa2V5KTsKCSAgICAvLyBBaGVtLCBJRSA8IDkuCgkgICAgaWYgKGhhc0VudW1CdWcpIGNvbGxlY3ROb25FbnVtUHJvcHMob2JqLCBrZXlzKTsKCSAgICByZXR1cm4ga2V5czsKCSAgfTsKCgkgIC8vIFJldHJpZXZlIGFsbCB0aGUgcHJvcGVydHkgbmFtZXMgb2YgYW4gb2JqZWN0LgoJICBfLmFsbEtleXMgPSBmdW5jdGlvbihvYmopIHsKCSAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIFtdOwoJICAgIHZhciBrZXlzID0gW107CgkgICAgZm9yICh2YXIga2V5IGluIG9iaikga2V5cy5wdXNoKGtleSk7CgkgICAgLy8gQWhlbSwgSUUgPCA5LgoJICAgIGlmIChoYXNFbnVtQnVnKSBjb2xsZWN0Tm9uRW51bVByb3BzKG9iaiwga2V5cyk7CgkgICAgcmV0dXJuIGtleXM7CgkgIH07CgoJICAvLyBSZXRyaWV2ZSB0aGUgdmFsdWVzIG9mIGFuIG9iamVjdCdzIHByb3BlcnRpZXMuCgkgIF8udmFsdWVzID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgdmFyIGtleXMgPSBfLmtleXMob2JqKTsKCSAgICB2YXIgbGVuZ3RoID0ga2V5cy5sZW5ndGg7CgkgICAgdmFyIHZhbHVlcyA9IEFycmF5KGxlbmd0aCk7CgkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgdmFsdWVzW2ldID0gb2JqW2tleXNbaV1dOwoJICAgIH0KCSAgICByZXR1cm4gdmFsdWVzOwoJICB9OwoKCSAgLy8gUmV0dXJucyB0aGUgcmVzdWx0cyBvZiBhcHBseWluZyB0aGUgaXRlcmF0ZWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBvYmplY3QKCSAgLy8gSW4gY29udHJhc3QgdG8gXy5tYXAgaXQgcmV0dXJucyBhbiBvYmplY3QKCSAgXy5tYXBPYmplY3QgPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7CgkgICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCk7CgkgICAgdmFyIGtleXMgPSAgXy5rZXlzKG9iaiksCgkgICAgICAgICAgbGVuZ3RoID0ga2V5cy5sZW5ndGgsCgkgICAgICAgICAgcmVzdWx0cyA9IHt9LAoJICAgICAgICAgIGN1cnJlbnRLZXk7CgkgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7CgkgICAgICAgIGN1cnJlbnRLZXkgPSBrZXlzW2luZGV4XTsKCSAgICAgICAgcmVzdWx0c1tjdXJyZW50S2V5XSA9IGl0ZXJhdGVlKG9ialtjdXJyZW50S2V5XSwgY3VycmVudEtleSwgb2JqKTsKCSAgICAgIH0KCSAgICAgIHJldHVybiByZXN1bHRzOwoJICB9OwoKCSAgLy8gQ29udmVydCBhbiBvYmplY3QgaW50byBhIGxpc3Qgb2YgYFtrZXksIHZhbHVlXWAgcGFpcnMuCgkgIF8ucGFpcnMgPSBmdW5jdGlvbihvYmopIHsKCSAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopOwoJICAgIHZhciBsZW5ndGggPSBrZXlzLmxlbmd0aDsKCSAgICB2YXIgcGFpcnMgPSBBcnJheShsZW5ndGgpOwoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKCSAgICAgIHBhaXJzW2ldID0gW2tleXNbaV0sIG9ialtrZXlzW2ldXV07CgkgICAgfQoJICAgIHJldHVybiBwYWlyczsKCSAgfTsKCgkgIC8vIEludmVydCB0aGUga2V5cyBhbmQgdmFsdWVzIG9mIGFuIG9iamVjdC4gVGhlIHZhbHVlcyBtdXN0IGJlIHNlcmlhbGl6YWJsZS4KCSAgXy5pbnZlcnQgPSBmdW5jdGlvbihvYmopIHsKCSAgICB2YXIgcmVzdWx0ID0ge307CgkgICAgdmFyIGtleXMgPSBfLmtleXMob2JqKTsKCSAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgcmVzdWx0W29ialtrZXlzW2ldXV0gPSBrZXlzW2ldOwoJICAgIH0KCSAgICByZXR1cm4gcmVzdWx0OwoJICB9OwoKCSAgLy8gUmV0dXJuIGEgc29ydGVkIGxpc3Qgb2YgdGhlIGZ1bmN0aW9uIG5hbWVzIGF2YWlsYWJsZSBvbiB0aGUgb2JqZWN0LgoJICAvLyBBbGlhc2VkIGFzIGBtZXRob2RzYAoJICBfLmZ1bmN0aW9ucyA9IF8ubWV0aG9kcyA9IGZ1bmN0aW9uKG9iaikgewoJICAgIHZhciBuYW1lcyA9IFtdOwoJICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKCSAgICAgIGlmIChfLmlzRnVuY3Rpb24ob2JqW2tleV0pKSBuYW1lcy5wdXNoKGtleSk7CgkgICAgfQoJICAgIHJldHVybiBuYW1lcy5zb3J0KCk7CgkgIH07CgoJICAvLyBFeHRlbmQgYSBnaXZlbiBvYmplY3Qgd2l0aCBhbGwgdGhlIHByb3BlcnRpZXMgaW4gcGFzc2VkLWluIG9iamVjdChzKS4KCSAgXy5leHRlbmQgPSBjcmVhdGVBc3NpZ25lcihfLmFsbEtleXMpOwoKCSAgLy8gQXNzaWducyBhIGdpdmVuIG9iamVjdCB3aXRoIGFsbCB0aGUgb3duIHByb3BlcnRpZXMgaW4gdGhlIHBhc3NlZC1pbiBvYmplY3QocykKCSAgLy8gKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL09iamVjdC9hc3NpZ24pCgkgIF8uZXh0ZW5kT3duID0gXy5hc3NpZ24gPSBjcmVhdGVBc3NpZ25lcihfLmtleXMpOwoKCSAgLy8gUmV0dXJucyB0aGUgZmlyc3Qga2V5IG9uIGFuIG9iamVjdCB0aGF0IHBhc3NlcyBhIHByZWRpY2F0ZSB0ZXN0CgkgIF8uZmluZEtleSA9IGZ1bmN0aW9uKG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KSB7CgkgICAgcHJlZGljYXRlID0gY2IocHJlZGljYXRlLCBjb250ZXh0KTsKCSAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopLCBrZXk7CgkgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGtleXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHsKCSAgICAgIGtleSA9IGtleXNbaV07CgkgICAgICBpZiAocHJlZGljYXRlKG9ialtrZXldLCBrZXksIG9iaikpIHJldHVybiBrZXk7CgkgICAgfQoJICB9OwoKCSAgLy8gUmV0dXJuIGEgY29weSBvZiB0aGUgb2JqZWN0IG9ubHkgY29udGFpbmluZyB0aGUgd2hpdGVsaXN0ZWQgcHJvcGVydGllcy4KCSAgXy5waWNrID0gZnVuY3Rpb24ob2JqZWN0LCBvaXRlcmF0ZWUsIGNvbnRleHQpIHsKCSAgICB2YXIgcmVzdWx0ID0ge30sIG9iaiA9IG9iamVjdCwgaXRlcmF0ZWUsIGtleXM7CgkgICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0OwoJICAgIGlmIChfLmlzRnVuY3Rpb24ob2l0ZXJhdGVlKSkgewoJICAgICAga2V5cyA9IF8uYWxsS2V5cyhvYmopOwoJICAgICAgaXRlcmF0ZWUgPSBvcHRpbWl6ZUNiKG9pdGVyYXRlZSwgY29udGV4dCk7CgkgICAgfSBlbHNlIHsKCSAgICAgIGtleXMgPSBmbGF0dGVuKGFyZ3VtZW50cywgZmFsc2UsIGZhbHNlLCAxKTsKCSAgICAgIGl0ZXJhdGVlID0gZnVuY3Rpb24odmFsdWUsIGtleSwgb2JqKSB7IHJldHVybiBrZXkgaW4gb2JqOyB9OwoJICAgICAgb2JqID0gT2JqZWN0KG9iaik7CgkgICAgfQoJICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBrZXlzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CgkgICAgICB2YXIga2V5ID0ga2V5c1tpXTsKCSAgICAgIHZhciB2YWx1ZSA9IG9ialtrZXldOwoJICAgICAgaWYgKGl0ZXJhdGVlKHZhbHVlLCBrZXksIG9iaikpIHJlc3VsdFtrZXldID0gdmFsdWU7CgkgICAgfQoJICAgIHJldHVybiByZXN1bHQ7CgkgIH07CgoJICAgLy8gUmV0dXJuIGEgY29weSBvZiB0aGUgb2JqZWN0IHdpdGhvdXQgdGhlIGJsYWNrbGlzdGVkIHByb3BlcnRpZXMuCgkgIF8ub21pdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHsKCSAgICBpZiAoXy5pc0Z1bmN0aW9uKGl0ZXJhdGVlKSkgewoJICAgICAgaXRlcmF0ZWUgPSBfLm5lZ2F0ZShpdGVyYXRlZSk7CgkgICAgfSBlbHNlIHsKCSAgICAgIHZhciBrZXlzID0gXy5tYXAoZmxhdHRlbihhcmd1bWVudHMsIGZhbHNlLCBmYWxzZSwgMSksIFN0cmluZyk7CgkgICAgICBpdGVyYXRlZSA9IGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHsKCSAgICAgICAgcmV0dXJuICFfLmNvbnRhaW5zKGtleXMsIGtleSk7CgkgICAgICB9OwoJICAgIH0KCSAgICByZXR1cm4gXy5waWNrKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpOwoJICB9OwoKCSAgLy8gRmlsbCBpbiBhIGdpdmVuIG9iamVjdCB3aXRoIGRlZmF1bHQgcHJvcGVydGllcy4KCSAgXy5kZWZhdWx0cyA9IGNyZWF0ZUFzc2lnbmVyKF8uYWxsS2V5cywgdHJ1ZSk7CgoJICAvLyBDcmVhdGVzIGFuIG9iamVjdCB0aGF0IGluaGVyaXRzIGZyb20gdGhlIGdpdmVuIHByb3RvdHlwZSBvYmplY3QuCgkgIC8vIElmIGFkZGl0aW9uYWwgcHJvcGVydGllcyBhcmUgcHJvdmlkZWQgdGhlbiB0aGV5IHdpbGwgYmUgYWRkZWQgdG8gdGhlCgkgIC8vIGNyZWF0ZWQgb2JqZWN0LgoJICBfLmNyZWF0ZSA9IGZ1bmN0aW9uKHByb3RvdHlwZSwgcHJvcHMpIHsKCSAgICB2YXIgcmVzdWx0ID0gYmFzZUNyZWF0ZShwcm90b3R5cGUpOwoJICAgIGlmIChwcm9wcykgXy5leHRlbmRPd24ocmVzdWx0LCBwcm9wcyk7CgkgICAgcmV0dXJuIHJlc3VsdDsKCSAgfTsKCgkgIC8vIENyZWF0ZSBhIChzaGFsbG93LWNsb25lZCkgZHVwbGljYXRlIG9mIGFuIG9iamVjdC4KCSAgXy5jbG9uZSA9IGZ1bmN0aW9uKG9iaikgewoJICAgIGlmICghXy5pc09iamVjdChvYmopKSByZXR1cm4gb2JqOwoJICAgIHJldHVybiBfLmlzQXJyYXkob2JqKSA/IG9iai5zbGljZSgpIDogXy5leHRlbmQoe30sIG9iaik7CgkgIH07CgoJICAvLyBJbnZva2VzIGludGVyY2VwdG9yIHdpdGggdGhlIG9iaiwgYW5kIHRoZW4gcmV0dXJucyBvYmouCgkgIC8vIFRoZSBwcmltYXJ5IHB1cnBvc2Ugb2YgdGhpcyBtZXRob2QgaXMgdG8gInRhcCBpbnRvIiBhIG1ldGhvZCBjaGFpbiwgaW4KCSAgLy8gb3JkZXIgdG8gcGVyZm9ybSBvcGVyYXRpb25zIG9uIGludGVybWVkaWF0ZSByZXN1bHRzIHdpdGhpbiB0aGUgY2hhaW4uCgkgIF8udGFwID0gZnVuY3Rpb24ob2JqLCBpbnRlcmNlcHRvcikgewoJICAgIGludGVyY2VwdG9yKG9iaik7CgkgICAgcmV0dXJuIG9iajsKCSAgfTsKCgkgIC8vIFJldHVybnMgd2hldGhlciBhbiBvYmplY3QgaGFzIGEgZ2l2ZW4gc2V0IG9mIGBrZXk6dmFsdWVgIHBhaXJzLgoJICBfLmlzTWF0Y2ggPSBmdW5jdGlvbihvYmplY3QsIGF0dHJzKSB7CgkgICAgdmFyIGtleXMgPSBfLmtleXMoYXR0cnMpLCBsZW5ndGggPSBrZXlzLmxlbmd0aDsKCSAgICBpZiAob2JqZWN0ID09IG51bGwpIHJldHVybiAhbGVuZ3RoOwoJICAgIHZhciBvYmogPSBPYmplY3Qob2JqZWN0KTsKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CgkgICAgICB2YXIga2V5ID0ga2V5c1tpXTsKCSAgICAgIGlmIChhdHRyc1trZXldICE9PSBvYmpba2V5XSB8fCAhKGtleSBpbiBvYmopKSByZXR1cm4gZmFsc2U7CgkgICAgfQoJICAgIHJldHVybiB0cnVlOwoJICB9OwoKCgkgIC8vIEludGVybmFsIHJlY3Vyc2l2ZSBjb21wYXJpc29uIGZ1bmN0aW9uIGZvciBgaXNFcXVhbGAuCgkgIHZhciBlcSA9IGZ1bmN0aW9uKGEsIGIsIGFTdGFjaywgYlN0YWNrKSB7CgkgICAgLy8gSWRlbnRpY2FsIG9iamVjdHMgYXJlIGVxdWFsLiBgMCA9PT0gLTBgLCBidXQgdGhleSBhcmVuJ3QgaWRlbnRpY2FsLgoJICAgIC8vIFNlZSB0aGUgW0hhcm1vbnkgYGVnYWxgIHByb3Bvc2FsXShodHRwOi8vd2lraS5lY21hc2NyaXB0Lm9yZy9kb2t1LnBocD9pZD1oYXJtb255OmVnYWwpLgoJICAgIGlmIChhID09PSBiKSByZXR1cm4gYSAhPT0gMCB8fCAxIC8gYSA9PT0gMSAvIGI7CgkgICAgLy8gQSBzdHJpY3QgY29tcGFyaXNvbiBpcyBuZWNlc3NhcnkgYmVjYXVzZSBgbnVsbCA9PSB1bmRlZmluZWRgLgoJICAgIGlmIChhID09IG51bGwgfHwgYiA9PSBudWxsKSByZXR1cm4gYSA9PT0gYjsKCSAgICAvLyBVbndyYXAgYW55IHdyYXBwZWQgb2JqZWN0cy4KCSAgICBpZiAoYSBpbnN0YW5jZW9mIF8pIGEgPSBhLl93cmFwcGVkOwoJICAgIGlmIChiIGluc3RhbmNlb2YgXykgYiA9IGIuX3dyYXBwZWQ7CgkgICAgLy8gQ29tcGFyZSBgW1tDbGFzc11dYCBuYW1lcy4KCSAgICB2YXIgY2xhc3NOYW1lID0gdG9TdHJpbmcuY2FsbChhKTsKCSAgICBpZiAoY2xhc3NOYW1lICE9PSB0b1N0cmluZy5jYWxsKGIpKSByZXR1cm4gZmFsc2U7CgkgICAgc3dpdGNoIChjbGFzc05hbWUpIHsKCSAgICAgIC8vIFN0cmluZ3MsIG51bWJlcnMsIHJlZ3VsYXIgZXhwcmVzc2lvbnMsIGRhdGVzLCBhbmQgYm9vbGVhbnMgYXJlIGNvbXBhcmVkIGJ5IHZhbHVlLgoJICAgICAgY2FzZSAnW29iamVjdCBSZWdFeHBdJzoKCSAgICAgIC8vIFJlZ0V4cHMgYXJlIGNvZXJjZWQgdG8gc3RyaW5ncyBmb3IgY29tcGFyaXNvbiAoTm90ZTogJycgKyAvYS9pID09PSAnL2EvaScpCgkgICAgICBjYXNlICdbb2JqZWN0IFN0cmluZ10nOgoJICAgICAgICAvLyBQcmltaXRpdmVzIGFuZCB0aGVpciBjb3JyZXNwb25kaW5nIG9iamVjdCB3cmFwcGVycyBhcmUgZXF1aXZhbGVudDsgdGh1cywgYCI1ImAgaXMKCSAgICAgICAgLy8gZXF1aXZhbGVudCB0byBgbmV3IFN0cmluZygiNSIpYC4KCSAgICAgICAgcmV0dXJuICcnICsgYSA9PT0gJycgKyBiOwoJICAgICAgY2FzZSAnW29iamVjdCBOdW1iZXJdJzoKCSAgICAgICAgLy8gYE5hTmBzIGFyZSBlcXVpdmFsZW50LCBidXQgbm9uLXJlZmxleGl2ZS4KCSAgICAgICAgLy8gT2JqZWN0KE5hTikgaXMgZXF1aXZhbGVudCB0byBOYU4KCSAgICAgICAgaWYgKCthICE9PSArYSkgcmV0dXJuICtiICE9PSArYjsKCSAgICAgICAgLy8gQW4gYGVnYWxgIGNvbXBhcmlzb24gaXMgcGVyZm9ybWVkIGZvciBvdGhlciBudW1lcmljIHZhbHVlcy4KCSAgICAgICAgcmV0dXJuICthID09PSAwID8gMSAvICthID09PSAxIC8gYiA6ICthID09PSArYjsKCSAgICAgIGNhc2UgJ1tvYmplY3QgRGF0ZV0nOgoJICAgICAgY2FzZSAnW29iamVjdCBCb29sZWFuXSc6CgkgICAgICAgIC8vIENvZXJjZSBkYXRlcyBhbmQgYm9vbGVhbnMgdG8gbnVtZXJpYyBwcmltaXRpdmUgdmFsdWVzLiBEYXRlcyBhcmUgY29tcGFyZWQgYnkgdGhlaXIKCSAgICAgICAgLy8gbWlsbGlzZWNvbmQgcmVwcmVzZW50YXRpb25zLiBOb3RlIHRoYXQgaW52YWxpZCBkYXRlcyB3aXRoIG1pbGxpc2Vjb25kIHJlcHJlc2VudGF0aW9ucwoJICAgICAgICAvLyBvZiBgTmFOYCBhcmUgbm90IGVxdWl2YWxlbnQuCgkgICAgICAgIHJldHVybiArYSA9PT0gK2I7CgkgICAgfQoKCSAgICB2YXIgYXJlQXJyYXlzID0gY2xhc3NOYW1lID09PSAnW29iamVjdCBBcnJheV0nOwoJICAgIGlmICghYXJlQXJyYXlzKSB7CgkgICAgICBpZiAodHlwZW9mIGEgIT0gJ29iamVjdCcgfHwgdHlwZW9mIGIgIT0gJ29iamVjdCcpIHJldHVybiBmYWxzZTsKCgkgICAgICAvLyBPYmplY3RzIHdpdGggZGlmZmVyZW50IGNvbnN0cnVjdG9ycyBhcmUgbm90IGVxdWl2YWxlbnQsIGJ1dCBgT2JqZWN0YHMgb3IgYEFycmF5YHMKCSAgICAgIC8vIGZyb20gZGlmZmVyZW50IGZyYW1lcyBhcmUuCgkgICAgICB2YXIgYUN0b3IgPSBhLmNvbnN0cnVjdG9yLCBiQ3RvciA9IGIuY29uc3RydWN0b3I7CgkgICAgICBpZiAoYUN0b3IgIT09IGJDdG9yICYmICEoXy5pc0Z1bmN0aW9uKGFDdG9yKSAmJiBhQ3RvciBpbnN0YW5jZW9mIGFDdG9yICYmCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5pc0Z1bmN0aW9uKGJDdG9yKSAmJiBiQ3RvciBpbnN0YW5jZW9mIGJDdG9yKQoJICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAoJ2NvbnN0cnVjdG9yJyBpbiBhICYmICdjb25zdHJ1Y3RvcicgaW4gYikpIHsKCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgfQoJICAgIH0KCSAgICAvLyBBc3N1bWUgZXF1YWxpdHkgZm9yIGN5Y2xpYyBzdHJ1Y3R1cmVzLiBUaGUgYWxnb3JpdGhtIGZvciBkZXRlY3RpbmcgY3ljbGljCgkgICAgLy8gc3RydWN0dXJlcyBpcyBhZGFwdGVkIGZyb20gRVMgNS4xIHNlY3Rpb24gMTUuMTIuMywgYWJzdHJhY3Qgb3BlcmF0aW9uIGBKT2AuCgoJICAgIC8vIEluaXRpYWxpemluZyBzdGFjayBvZiB0cmF2ZXJzZWQgb2JqZWN0cy4KCSAgICAvLyBJdCdzIGRvbmUgaGVyZSBzaW5jZSB3ZSBvbmx5IG5lZWQgdGhlbSBmb3Igb2JqZWN0cyBhbmQgYXJyYXlzIGNvbXBhcmlzb24uCgkgICAgYVN0YWNrID0gYVN0YWNrIHx8IFtdOwoJICAgIGJTdGFjayA9IGJTdGFjayB8fCBbXTsKCSAgICB2YXIgbGVuZ3RoID0gYVN0YWNrLmxlbmd0aDsKCSAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgIC8vIExpbmVhciBzZWFyY2guIFBlcmZvcm1hbmNlIGlzIGludmVyc2VseSBwcm9wb3J0aW9uYWwgdG8gdGhlIG51bWJlciBvZgoJICAgICAgLy8gdW5pcXVlIG5lc3RlZCBzdHJ1Y3R1cmVzLgoJICAgICAgaWYgKGFTdGFja1tsZW5ndGhdID09PSBhKSByZXR1cm4gYlN0YWNrW2xlbmd0aF0gPT09IGI7CgkgICAgfQoKCSAgICAvLyBBZGQgdGhlIGZpcnN0IG9iamVjdCB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuCgkgICAgYVN0YWNrLnB1c2goYSk7CgkgICAgYlN0YWNrLnB1c2goYik7CgoJICAgIC8vIFJlY3Vyc2l2ZWx5IGNvbXBhcmUgb2JqZWN0cyBhbmQgYXJyYXlzLgoJICAgIGlmIChhcmVBcnJheXMpIHsKCSAgICAgIC8vIENvbXBhcmUgYXJyYXkgbGVuZ3RocyB0byBkZXRlcm1pbmUgaWYgYSBkZWVwIGNvbXBhcmlzb24gaXMgbmVjZXNzYXJ5LgoJICAgICAgbGVuZ3RoID0gYS5sZW5ndGg7CgkgICAgICBpZiAobGVuZ3RoICE9PSBiLmxlbmd0aCkgcmV0dXJuIGZhbHNlOwoJICAgICAgLy8gRGVlcCBjb21wYXJlIHRoZSBjb250ZW50cywgaWdub3Jpbmcgbm9uLW51bWVyaWMgcHJvcGVydGllcy4KCSAgICAgIHdoaWxlIChsZW5ndGgtLSkgewoJICAgICAgICBpZiAoIWVxKGFbbGVuZ3RoXSwgYltsZW5ndGhdLCBhU3RhY2ssIGJTdGFjaykpIHJldHVybiBmYWxzZTsKCSAgICAgIH0KCSAgICB9IGVsc2UgewoJICAgICAgLy8gRGVlcCBjb21wYXJlIG9iamVjdHMuCgkgICAgICB2YXIga2V5cyA9IF8ua2V5cyhhKSwga2V5OwoJICAgICAgbGVuZ3RoID0ga2V5cy5sZW5ndGg7CgkgICAgICAvLyBFbnN1cmUgdGhhdCBib3RoIG9iamVjdHMgY29udGFpbiB0aGUgc2FtZSBudW1iZXIgb2YgcHJvcGVydGllcyBiZWZvcmUgY29tcGFyaW5nIGRlZXAgZXF1YWxpdHkuCgkgICAgICBpZiAoXy5rZXlzKGIpLmxlbmd0aCAhPT0gbGVuZ3RoKSByZXR1cm4gZmFsc2U7CgkgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgLy8gRGVlcCBjb21wYXJlIGVhY2ggbWVtYmVyCgkgICAgICAgIGtleSA9IGtleXNbbGVuZ3RoXTsKCSAgICAgICAgaWYgKCEoXy5oYXMoYiwga2V5KSAmJiBlcShhW2tleV0sIGJba2V5XSwgYVN0YWNrLCBiU3RhY2spKSkgcmV0dXJuIGZhbHNlOwoJICAgICAgfQoJICAgIH0KCSAgICAvLyBSZW1vdmUgdGhlIGZpcnN0IG9iamVjdCBmcm9tIHRoZSBzdGFjayBvZiB0cmF2ZXJzZWQgb2JqZWN0cy4KCSAgICBhU3RhY2sucG9wKCk7CgkgICAgYlN0YWNrLnBvcCgpOwoJICAgIHJldHVybiB0cnVlOwoJICB9OwoKCSAgLy8gUGVyZm9ybSBhIGRlZXAgY29tcGFyaXNvbiB0byBjaGVjayBpZiB0d28gb2JqZWN0cyBhcmUgZXF1YWwuCgkgIF8uaXNFcXVhbCA9IGZ1bmN0aW9uKGEsIGIpIHsKCSAgICByZXR1cm4gZXEoYSwgYik7CgkgIH07CgoJICAvLyBJcyBhIGdpdmVuIGFycmF5LCBzdHJpbmcsIG9yIG9iamVjdCBlbXB0eT8KCSAgLy8gQW4gImVtcHR5IiBvYmplY3QgaGFzIG5vIGVudW1lcmFibGUgb3duLXByb3BlcnRpZXMuCgkgIF8uaXNFbXB0eSA9IGZ1bmN0aW9uKG9iaikgewoJICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIHRydWU7CgkgICAgaWYgKGlzQXJyYXlMaWtlKG9iaikgJiYgKF8uaXNBcnJheShvYmopIHx8IF8uaXNTdHJpbmcob2JqKSB8fCBfLmlzQXJndW1lbnRzKG9iaikpKSByZXR1cm4gb2JqLmxlbmd0aCA9PT0gMDsKCSAgICByZXR1cm4gXy5rZXlzKG9iaikubGVuZ3RoID09PSAwOwoJICB9OwoKCSAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIERPTSBlbGVtZW50PwoJICBfLmlzRWxlbWVudCA9IGZ1bmN0aW9uKG9iaikgewoJICAgIHJldHVybiAhIShvYmogJiYgb2JqLm5vZGVUeXBlID09PSAxKTsKCSAgfTsKCgkgIC8vIElzIGEgZ2l2ZW4gdmFsdWUgYW4gYXJyYXk/CgkgIC8vIERlbGVnYXRlcyB0byBFQ01BNSdzIG5hdGl2ZSBBcnJheS5pc0FycmF5CgkgIF8uaXNBcnJheSA9IG5hdGl2ZUlzQXJyYXkgfHwgZnVuY3Rpb24ob2JqKSB7CgkgICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgQXJyYXldJzsKCSAgfTsKCgkgIC8vIElzIGEgZ2l2ZW4gdmFyaWFibGUgYW4gb2JqZWN0PwoJICBfLmlzT2JqZWN0ID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgdmFyIHR5cGUgPSB0eXBlb2Ygb2JqOwoJICAgIHJldHVybiB0eXBlID09PSAnZnVuY3Rpb24nIHx8IHR5cGUgPT09ICdvYmplY3QnICYmICEhb2JqOwoJICB9OwoKCSAgLy8gQWRkIHNvbWUgaXNUeXBlIG1ldGhvZHM6IGlzQXJndW1lbnRzLCBpc0Z1bmN0aW9uLCBpc1N0cmluZywgaXNOdW1iZXIsIGlzRGF0ZSwgaXNSZWdFeHAsIGlzRXJyb3IuCgkgIF8uZWFjaChbJ0FyZ3VtZW50cycsICdGdW5jdGlvbicsICdTdHJpbmcnLCAnTnVtYmVyJywgJ0RhdGUnLCAnUmVnRXhwJywgJ0Vycm9yJ10sIGZ1bmN0aW9uKG5hbWUpIHsKCSAgICBfWydpcycgKyBuYW1lXSA9IGZ1bmN0aW9uKG9iaikgewoJICAgICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgJyArIG5hbWUgKyAnXSc7CgkgICAgfTsKCSAgfSk7CgoJICAvLyBEZWZpbmUgYSBmYWxsYmFjayB2ZXJzaW9uIG9mIHRoZSBtZXRob2QgaW4gYnJvd3NlcnMgKGFoZW0sIElFIDwgOSksIHdoZXJlCgkgIC8vIHRoZXJlIGlzbid0IGFueSBpbnNwZWN0YWJsZSAiQXJndW1lbnRzIiB0eXBlLgoJICBpZiAoIV8uaXNBcmd1bWVudHMoYXJndW1lbnRzKSkgewoJICAgIF8uaXNBcmd1bWVudHMgPSBmdW5jdGlvbihvYmopIHsKCSAgICAgIHJldHVybiBfLmhhcyhvYmosICdjYWxsZWUnKTsKCSAgICB9OwoJICB9CgoJICAvLyBPcHRpbWl6ZSBgaXNGdW5jdGlvbmAgaWYgYXBwcm9wcmlhdGUuIFdvcmsgYXJvdW5kIHNvbWUgdHlwZW9mIGJ1Z3MgaW4gb2xkIHY4LAoJICAvLyBJRSAxMSAoIzE2MjEpLCBhbmQgaW4gU2FmYXJpIDggKCMxOTI5KS4KCSAgaWYgKHR5cGVvZiAvLi8gIT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgSW50OEFycmF5ICE9ICdvYmplY3QnKSB7CgkgICAgXy5pc0Z1bmN0aW9uID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgICByZXR1cm4gdHlwZW9mIG9iaiA9PSAnZnVuY3Rpb24nIHx8IGZhbHNlOwoJICAgIH07CgkgIH0KCgkgIC8vIElzIGEgZ2l2ZW4gb2JqZWN0IGEgZmluaXRlIG51bWJlcj8KCSAgXy5pc0Zpbml0ZSA9IGZ1bmN0aW9uKG9iaikgewoJICAgIHJldHVybiBpc0Zpbml0ZShvYmopICYmICFpc05hTihwYXJzZUZsb2F0KG9iaikpOwoJICB9OwoKCSAgLy8gSXMgdGhlIGdpdmVuIHZhbHVlIGBOYU5gPyAoTmFOIGlzIHRoZSBvbmx5IG51bWJlciB3aGljaCBkb2VzIG5vdCBlcXVhbCBpdHNlbGYpLgoJICBfLmlzTmFOID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgcmV0dXJuIF8uaXNOdW1iZXIob2JqKSAmJiBvYmogIT09ICtvYmo7CgkgIH07CgoJICAvLyBJcyBhIGdpdmVuIHZhbHVlIGEgYm9vbGVhbj8KCSAgXy5pc0Jvb2xlYW4gPSBmdW5jdGlvbihvYmopIHsKCSAgICByZXR1cm4gb2JqID09PSB0cnVlIHx8IG9iaiA9PT0gZmFsc2UgfHwgdG9TdHJpbmcuY2FsbChvYmopID09PSAnW29iamVjdCBCb29sZWFuXSc7CgkgIH07CgoJICAvLyBJcyBhIGdpdmVuIHZhbHVlIGVxdWFsIHRvIG51bGw/CgkgIF8uaXNOdWxsID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgcmV0dXJuIG9iaiA9PT0gbnVsbDsKCSAgfTsKCgkgIC8vIElzIGEgZ2l2ZW4gdmFyaWFibGUgdW5kZWZpbmVkPwoJICBfLmlzVW5kZWZpbmVkID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgcmV0dXJuIG9iaiA9PT0gdm9pZCAwOwoJICB9OwoKCSAgLy8gU2hvcnRjdXQgZnVuY3Rpb24gZm9yIGNoZWNraW5nIGlmIGFuIG9iamVjdCBoYXMgYSBnaXZlbiBwcm9wZXJ0eSBkaXJlY3RseQoJICAvLyBvbiBpdHNlbGYgKGluIG90aGVyIHdvcmRzLCBub3Qgb24gYSBwcm90b3R5cGUpLgoJICBfLmhhcyA9IGZ1bmN0aW9uKG9iaiwga2V5KSB7CgkgICAgcmV0dXJuIG9iaiAhPSBudWxsICYmIGhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpOwoJICB9OwoKCSAgLy8gVXRpbGl0eSBGdW5jdGlvbnMKCSAgLy8gLS0tLS0tLS0tLS0tLS0tLS0KCgkgIC8vIFJ1biBVbmRlcnNjb3JlLmpzIGluICpub0NvbmZsaWN0KiBtb2RlLCByZXR1cm5pbmcgdGhlIGBfYCB2YXJpYWJsZSB0byBpdHMKCSAgLy8gcHJldmlvdXMgb3duZXIuIFJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIFVuZGVyc2NvcmUgb2JqZWN0LgoJICBfLm5vQ29uZmxpY3QgPSBmdW5jdGlvbigpIHsKCSAgICByb290Ll8gPSBwcmV2aW91c1VuZGVyc2NvcmU7CgkgICAgcmV0dXJuIHRoaXM7CgkgIH07CgoJICAvLyBLZWVwIHRoZSBpZGVudGl0eSBmdW5jdGlvbiBhcm91bmQgZm9yIGRlZmF1bHQgaXRlcmF0ZWVzLgoJICBfLmlkZW50aXR5ID0gZnVuY3Rpb24odmFsdWUpIHsKCSAgICByZXR1cm4gdmFsdWU7CgkgIH07CgoJICAvLyBQcmVkaWNhdGUtZ2VuZXJhdGluZyBmdW5jdGlvbnMuIE9mdGVuIHVzZWZ1bCBvdXRzaWRlIG9mIFVuZGVyc2NvcmUuCgkgIF8uY29uc3RhbnQgPSBmdW5jdGlvbih2YWx1ZSkgewoJICAgIHJldHVybiBmdW5jdGlvbigpIHsKCSAgICAgIHJldHVybiB2YWx1ZTsKCSAgICB9OwoJICB9OwoKCSAgXy5ub29wID0gZnVuY3Rpb24oKXt9OwoKCSAgXy5wcm9wZXJ0eSA9IHByb3BlcnR5OwoKCSAgLy8gR2VuZXJhdGVzIGEgZnVuY3Rpb24gZm9yIGEgZ2l2ZW4gb2JqZWN0IHRoYXQgcmV0dXJucyBhIGdpdmVuIHByb3BlcnR5LgoJICBfLnByb3BlcnR5T2YgPSBmdW5jdGlvbihvYmopIHsKCSAgICByZXR1cm4gb2JqID09IG51bGwgPyBmdW5jdGlvbigpe30gOiBmdW5jdGlvbihrZXkpIHsKCSAgICAgIHJldHVybiBvYmpba2V5XTsKCSAgICB9OwoJICB9OwoKCSAgLy8gUmV0dXJucyBhIHByZWRpY2F0ZSBmb3IgY2hlY2tpbmcgd2hldGhlciBhbiBvYmplY3QgaGFzIGEgZ2l2ZW4gc2V0IG9mCgkgIC8vIGBrZXk6dmFsdWVgIHBhaXJzLgoJICBfLm1hdGNoZXIgPSBfLm1hdGNoZXMgPSBmdW5jdGlvbihhdHRycykgewoJICAgIGF0dHJzID0gXy5leHRlbmRPd24oe30sIGF0dHJzKTsKCSAgICByZXR1cm4gZnVuY3Rpb24ob2JqKSB7CgkgICAgICByZXR1cm4gXy5pc01hdGNoKG9iaiwgYXR0cnMpOwoJICAgIH07CgkgIH07CgoJICAvLyBSdW4gYSBmdW5jdGlvbiAqKm4qKiB0aW1lcy4KCSAgXy50aW1lcyA9IGZ1bmN0aW9uKG4sIGl0ZXJhdGVlLCBjb250ZXh0KSB7CgkgICAgdmFyIGFjY3VtID0gQXJyYXkoTWF0aC5tYXgoMCwgbikpOwoJICAgIGl0ZXJhdGVlID0gb3B0aW1pemVDYihpdGVyYXRlZSwgY29udGV4dCwgMSk7CgkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIGFjY3VtW2ldID0gaXRlcmF0ZWUoaSk7CgkgICAgcmV0dXJuIGFjY3VtOwoJICB9OwoKCSAgLy8gUmV0dXJuIGEgcmFuZG9tIGludGVnZXIgYmV0d2VlbiBtaW4gYW5kIG1heCAoaW5jbHVzaXZlKS4KCSAgXy5yYW5kb20gPSBmdW5jdGlvbihtaW4sIG1heCkgewoJICAgIGlmIChtYXggPT0gbnVsbCkgewoJICAgICAgbWF4ID0gbWluOwoJICAgICAgbWluID0gMDsKCSAgICB9CgkgICAgcmV0dXJuIG1pbiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSk7CgkgIH07CgoJICAvLyBBIChwb3NzaWJseSBmYXN0ZXIpIHdheSB0byBnZXQgdGhlIGN1cnJlbnQgdGltZXN0YW1wIGFzIGFuIGludGVnZXIuCgkgIF8ubm93ID0gRGF0ZS5ub3cgfHwgZnVuY3Rpb24oKSB7CgkgICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpOwoJICB9OwoKCSAgIC8vIExpc3Qgb2YgSFRNTCBlbnRpdGllcyBmb3IgZXNjYXBpbmcuCgkgIHZhciBlc2NhcGVNYXAgPSB7CgkgICAgJyYnOiAnJmFtcDsnLAoJICAgICc8JzogJyZsdDsnLAoJICAgICc+JzogJyZndDsnLAoJICAgICciJzogJyZxdW90OycsCgkgICAgIiciOiAnJiN4Mjc7JywKCSAgICAnYCc6ICcmI3g2MDsnCgkgIH07CgkgIHZhciB1bmVzY2FwZU1hcCA9IF8uaW52ZXJ0KGVzY2FwZU1hcCk7CgoJICAvLyBGdW5jdGlvbnMgZm9yIGVzY2FwaW5nIGFuZCB1bmVzY2FwaW5nIHN0cmluZ3MgdG8vZnJvbSBIVE1MIGludGVycG9sYXRpb24uCgkgIHZhciBjcmVhdGVFc2NhcGVyID0gZnVuY3Rpb24obWFwKSB7CgkgICAgdmFyIGVzY2FwZXIgPSBmdW5jdGlvbihtYXRjaCkgewoJICAgICAgcmV0dXJuIG1hcFttYXRjaF07CgkgICAgfTsKCSAgICAvLyBSZWdleGVzIGZvciBpZGVudGlmeWluZyBhIGtleSB0aGF0IG5lZWRzIHRvIGJlIGVzY2FwZWQKCSAgICB2YXIgc291cmNlID0gJyg/OicgKyBfLmtleXMobWFwKS5qb2luKCd8JykgKyAnKSc7CgkgICAgdmFyIHRlc3RSZWdleHAgPSBSZWdFeHAoc291cmNlKTsKCSAgICB2YXIgcmVwbGFjZVJlZ2V4cCA9IFJlZ0V4cChzb3VyY2UsICdnJyk7CgkgICAgcmV0dXJuIGZ1bmN0aW9uKHN0cmluZykgewoJICAgICAgc3RyaW5nID0gc3RyaW5nID09IG51bGwgPyAnJyA6ICcnICsgc3RyaW5nOwoJICAgICAgcmV0dXJuIHRlc3RSZWdleHAudGVzdChzdHJpbmcpID8gc3RyaW5nLnJlcGxhY2UocmVwbGFjZVJlZ2V4cCwgZXNjYXBlcikgOiBzdHJpbmc7CgkgICAgfTsKCSAgfTsKCSAgXy5lc2NhcGUgPSBjcmVhdGVFc2NhcGVyKGVzY2FwZU1hcCk7CgkgIF8udW5lc2NhcGUgPSBjcmVhdGVFc2NhcGVyKHVuZXNjYXBlTWFwKTsKCgkgIC8vIElmIHRoZSB2YWx1ZSBvZiB0aGUgbmFtZWQgYHByb3BlcnR5YCBpcyBhIGZ1bmN0aW9uIHRoZW4gaW52b2tlIGl0IHdpdGggdGhlCgkgIC8vIGBvYmplY3RgIGFzIGNvbnRleHQ7IG90aGVyd2lzZSwgcmV0dXJuIGl0LgoJICBfLnJlc3VsdCA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHksIGZhbGxiYWNrKSB7CgkgICAgdmFyIHZhbHVlID0gb2JqZWN0ID09IG51bGwgPyB2b2lkIDAgOiBvYmplY3RbcHJvcGVydHldOwoJICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwKSB7CgkgICAgICB2YWx1ZSA9IGZhbGxiYWNrOwoJICAgIH0KCSAgICByZXR1cm4gXy5pc0Z1bmN0aW9uKHZhbHVlKSA/IHZhbHVlLmNhbGwob2JqZWN0KSA6IHZhbHVlOwoJICB9OwoKCSAgLy8gR2VuZXJhdGUgYSB1bmlxdWUgaW50ZWdlciBpZCAodW5pcXVlIHdpdGhpbiB0aGUgZW50aXJlIGNsaWVudCBzZXNzaW9uKS4KCSAgLy8gVXNlZnVsIGZvciB0ZW1wb3JhcnkgRE9NIGlkcy4KCSAgdmFyIGlkQ291bnRlciA9IDA7CgkgIF8udW5pcXVlSWQgPSBmdW5jdGlvbihwcmVmaXgpIHsKCSAgICB2YXIgaWQgPSArK2lkQ291bnRlciArICcnOwoJICAgIHJldHVybiBwcmVmaXggPyBwcmVmaXggKyBpZCA6IGlkOwoJICB9OwoKCSAgLy8gQnkgZGVmYXVsdCwgVW5kZXJzY29yZSB1c2VzIEVSQi1zdHlsZSB0ZW1wbGF0ZSBkZWxpbWl0ZXJzLCBjaGFuZ2UgdGhlCgkgIC8vIGZvbGxvd2luZyB0ZW1wbGF0ZSBzZXR0aW5ncyB0byB1c2UgYWx0ZXJuYXRpdmUgZGVsaW1pdGVycy4KCSAgXy50ZW1wbGF0ZVNldHRpbmdzID0gewoJICAgIGV2YWx1YXRlICAgIDogLzwlKFtcc1xTXSs/KSU+L2csCgkgICAgaW50ZXJwb2xhdGUgOiAvPCU9KFtcc1xTXSs/KSU+L2csCgkgICAgZXNjYXBlICAgICAgOiAvPCUtKFtcc1xTXSs/KSU+L2cKCSAgfTsKCgkgIC8vIFdoZW4gY3VzdG9taXppbmcgYHRlbXBsYXRlU2V0dGluZ3NgLCBpZiB5b3UgZG9uJ3Qgd2FudCB0byBkZWZpbmUgYW4KCSAgLy8gaW50ZXJwb2xhdGlvbiwgZXZhbHVhdGlvbiBvciBlc2NhcGluZyByZWdleCwgd2UgbmVlZCBvbmUgdGhhdCBpcwoJICAvLyBndWFyYW50ZWVkIG5vdCB0byBtYXRjaC4KCSAgdmFyIG5vTWF0Y2ggPSAvKC4pXi87CgoJICAvLyBDZXJ0YWluIGNoYXJhY3RlcnMgbmVlZCB0byBiZSBlc2NhcGVkIHNvIHRoYXQgdGhleSBjYW4gYmUgcHV0IGludG8gYQoJICAvLyBzdHJpbmcgbGl0ZXJhbC4KCSAgdmFyIGVzY2FwZXMgPSB7CgkgICAgIiciOiAgICAgICInIiwKCSAgICAnXFwnOiAgICAgJ1xcJywKCSAgICAnXHInOiAgICAgJ3InLAoJICAgICdcbic6ICAgICAnbicsCgkgICAgJ1x1MjAyOCc6ICd1MjAyOCcsCgkgICAgJ1x1MjAyOSc6ICd1MjAyOScKCSAgfTsKCgkgIHZhciBlc2NhcGVyID0gL1xcfCd8XHJ8XG58XHUyMDI4fFx1MjAyOS9nOwoKCSAgdmFyIGVzY2FwZUNoYXIgPSBmdW5jdGlvbihtYXRjaCkgewoJICAgIHJldHVybiAnXFwnICsgZXNjYXBlc1ttYXRjaF07CgkgIH07CgoJICAvLyBKYXZhU2NyaXB0IG1pY3JvLXRlbXBsYXRpbmcsIHNpbWlsYXIgdG8gSm9obiBSZXNpZydzIGltcGxlbWVudGF0aW9uLgoJICAvLyBVbmRlcnNjb3JlIHRlbXBsYXRpbmcgaGFuZGxlcyBhcmJpdHJhcnkgZGVsaW1pdGVycywgcHJlc2VydmVzIHdoaXRlc3BhY2UsCgkgIC8vIGFuZCBjb3JyZWN0bHkgZXNjYXBlcyBxdW90ZXMgd2l0aGluIGludGVycG9sYXRlZCBjb2RlLgoJICAvLyBOQjogYG9sZFNldHRpbmdzYCBvbmx5IGV4aXN0cyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkuCgkgIF8udGVtcGxhdGUgPSBmdW5jdGlvbih0ZXh0LCBzZXR0aW5ncywgb2xkU2V0dGluZ3MpIHsKCSAgICBpZiAoIXNldHRpbmdzICYmIG9sZFNldHRpbmdzKSBzZXR0aW5ncyA9IG9sZFNldHRpbmdzOwoJICAgIHNldHRpbmdzID0gXy5kZWZhdWx0cyh7fSwgc2V0dGluZ3MsIF8udGVtcGxhdGVTZXR0aW5ncyk7CgoJICAgIC8vIENvbWJpbmUgZGVsaW1pdGVycyBpbnRvIG9uZSByZWd1bGFyIGV4cHJlc3Npb24gdmlhIGFsdGVybmF0aW9uLgoJICAgIHZhciBtYXRjaGVyID0gUmVnRXhwKFsKCSAgICAgIChzZXR0aW5ncy5lc2NhcGUgfHwgbm9NYXRjaCkuc291cmNlLAoJICAgICAgKHNldHRpbmdzLmludGVycG9sYXRlIHx8IG5vTWF0Y2gpLnNvdXJjZSwKCSAgICAgIChzZXR0aW5ncy5ldmFsdWF0ZSB8fCBub01hdGNoKS5zb3VyY2UKCSAgICBdLmpvaW4oJ3wnKSArICd8JCcsICdnJyk7CgoJICAgIC8vIENvbXBpbGUgdGhlIHRlbXBsYXRlIHNvdXJjZSwgZXNjYXBpbmcgc3RyaW5nIGxpdGVyYWxzIGFwcHJvcHJpYXRlbHkuCgkgICAgdmFyIGluZGV4ID0gMDsKCSAgICB2YXIgc291cmNlID0gIl9fcCs9JyI7CgkgICAgdGV4dC5yZXBsYWNlKG1hdGNoZXIsIGZ1bmN0aW9uKG1hdGNoLCBlc2NhcGUsIGludGVycG9sYXRlLCBldmFsdWF0ZSwgb2Zmc2V0KSB7CgkgICAgICBzb3VyY2UgKz0gdGV4dC5zbGljZShpbmRleCwgb2Zmc2V0KS5yZXBsYWNlKGVzY2FwZXIsIGVzY2FwZUNoYXIpOwoJICAgICAgaW5kZXggPSBvZmZzZXQgKyBtYXRjaC5sZW5ndGg7CgoJICAgICAgaWYgKGVzY2FwZSkgewoJICAgICAgICBzb3VyY2UgKz0gIicrXG4oKF9fdD0oIiArIGVzY2FwZSArICIpKT09bnVsbD8nJzpfLmVzY2FwZShfX3QpKStcbiciOwoJICAgICAgfSBlbHNlIGlmIChpbnRlcnBvbGF0ZSkgewoJICAgICAgICBzb3VyY2UgKz0gIicrXG4oKF9fdD0oIiArIGludGVycG9sYXRlICsgIikpPT1udWxsPycnOl9fdCkrXG4nIjsKCSAgICAgIH0gZWxzZSBpZiAoZXZhbHVhdGUpIHsKCSAgICAgICAgc291cmNlICs9ICInO1xuIiArIGV2YWx1YXRlICsgIlxuX19wKz0nIjsKCSAgICAgIH0KCgkgICAgICAvLyBBZG9iZSBWTXMgbmVlZCB0aGUgbWF0Y2ggcmV0dXJuZWQgdG8gcHJvZHVjZSB0aGUgY29ycmVjdCBvZmZlc3QuCgkgICAgICByZXR1cm4gbWF0Y2g7CgkgICAgfSk7CgkgICAgc291cmNlICs9ICInO1xuIjsKCgkgICAgLy8gSWYgYSB2YXJpYWJsZSBpcyBub3Qgc3BlY2lmaWVkLCBwbGFjZSBkYXRhIHZhbHVlcyBpbiBsb2NhbCBzY29wZS4KCSAgICBpZiAoIXNldHRpbmdzLnZhcmlhYmxlKSBzb3VyY2UgPSAnd2l0aChvYmp8fHt9KXtcbicgKyBzb3VyY2UgKyAnfVxuJzsKCgkgICAgc291cmNlID0gInZhciBfX3QsX19wPScnLF9faj1BcnJheS5wcm90b3R5cGUuam9pbiwiICsKCSAgICAgICJwcmludD1mdW5jdGlvbigpe19fcCs9X19qLmNhbGwoYXJndW1lbnRzLCcnKTt9O1xuIiArCgkgICAgICBzb3VyY2UgKyAncmV0dXJuIF9fcDtcbic7CgoJICAgIHRyeSB7CgkgICAgICB2YXIgcmVuZGVyID0gbmV3IEZ1bmN0aW9uKHNldHRpbmdzLnZhcmlhYmxlIHx8ICdvYmonLCAnXycsIHNvdXJjZSk7CgkgICAgfSBjYXRjaCAoZSkgewoJICAgICAgZS5zb3VyY2UgPSBzb3VyY2U7CgkgICAgICB0aHJvdyBlOwoJICAgIH0KCgkgICAgdmFyIHRlbXBsYXRlID0gZnVuY3Rpb24oZGF0YSkgewoJICAgICAgcmV0dXJuIHJlbmRlci5jYWxsKHRoaXMsIGRhdGEsIF8pOwoJICAgIH07CgoJICAgIC8vIFByb3ZpZGUgdGhlIGNvbXBpbGVkIHNvdXJjZSBhcyBhIGNvbnZlbmllbmNlIGZvciBwcmVjb21waWxhdGlvbi4KCSAgICB2YXIgYXJndW1lbnQgPSBzZXR0aW5ncy52YXJpYWJsZSB8fCAnb2JqJzsKCSAgICB0ZW1wbGF0ZS5zb3VyY2UgPSAnZnVuY3Rpb24oJyArIGFyZ3VtZW50ICsgJyl7XG4nICsgc291cmNlICsgJ30nOwoKCSAgICByZXR1cm4gdGVtcGxhdGU7CgkgIH07CgoJICAvLyBBZGQgYSAiY2hhaW4iIGZ1bmN0aW9uLiBTdGFydCBjaGFpbmluZyBhIHdyYXBwZWQgVW5kZXJzY29yZSBvYmplY3QuCgkgIF8uY2hhaW4gPSBmdW5jdGlvbihvYmopIHsKCSAgICB2YXIgaW5zdGFuY2UgPSBfKG9iaik7CgkgICAgaW5zdGFuY2UuX2NoYWluID0gdHJ1ZTsKCSAgICByZXR1cm4gaW5zdGFuY2U7CgkgIH07CgoJICAvLyBPT1AKCSAgLy8gLS0tLS0tLS0tLS0tLS0tCgkgIC8vIElmIFVuZGVyc2NvcmUgaXMgY2FsbGVkIGFzIGEgZnVuY3Rpb24sIGl0IHJldHVybnMgYSB3cmFwcGVkIG9iamVjdCB0aGF0CgkgIC8vIGNhbiBiZSB1c2VkIE9PLXN0eWxlLiBUaGlzIHdyYXBwZXIgaG9sZHMgYWx0ZXJlZCB2ZXJzaW9ucyBvZiBhbGwgdGhlCgkgIC8vIHVuZGVyc2NvcmUgZnVuY3Rpb25zLiBXcmFwcGVkIG9iamVjdHMgbWF5IGJlIGNoYWluZWQuCgoJICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gY29udGludWUgY2hhaW5pbmcgaW50ZXJtZWRpYXRlIHJlc3VsdHMuCgkgIHZhciByZXN1bHQgPSBmdW5jdGlvbihpbnN0YW5jZSwgb2JqKSB7CgkgICAgcmV0dXJuIGluc3RhbmNlLl9jaGFpbiA/IF8ob2JqKS5jaGFpbigpIDogb2JqOwoJICB9OwoKCSAgLy8gQWRkIHlvdXIgb3duIGN1c3RvbSBmdW5jdGlvbnMgdG8gdGhlIFVuZGVyc2NvcmUgb2JqZWN0LgoJICBfLm1peGluID0gZnVuY3Rpb24ob2JqKSB7CgkgICAgXy5lYWNoKF8uZnVuY3Rpb25zKG9iaiksIGZ1bmN0aW9uKG5hbWUpIHsKCSAgICAgIHZhciBmdW5jID0gX1tuYW1lXSA9IG9ialtuYW1lXTsKCSAgICAgIF8ucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oKSB7CgkgICAgICAgIHZhciBhcmdzID0gW3RoaXMuX3dyYXBwZWRdOwoJICAgICAgICBwdXNoLmFwcGx5KGFyZ3MsIGFyZ3VtZW50cyk7CgkgICAgICAgIHJldHVybiByZXN1bHQodGhpcywgZnVuYy5hcHBseShfLCBhcmdzKSk7CgkgICAgICB9OwoJICAgIH0pOwoJICB9OwoKCSAgLy8gQWRkIGFsbCBvZiB0aGUgVW5kZXJzY29yZSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIgb2JqZWN0LgoJICBfLm1peGluKF8pOwoKCSAgLy8gQWRkIGFsbCBtdXRhdG9yIEFycmF5IGZ1bmN0aW9ucyB0byB0aGUgd3JhcHBlci4KCSAgXy5lYWNoKFsncG9wJywgJ3B1c2gnLCAncmV2ZXJzZScsICdzaGlmdCcsICdzb3J0JywgJ3NwbGljZScsICd1bnNoaWZ0J10sIGZ1bmN0aW9uKG5hbWUpIHsKCSAgICB2YXIgbWV0aG9kID0gQXJyYXlQcm90b1tuYW1lXTsKCSAgICBfLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uKCkgewoJICAgICAgdmFyIG9iaiA9IHRoaXMuX3dyYXBwZWQ7CgkgICAgICBtZXRob2QuYXBwbHkob2JqLCBhcmd1bWVudHMpOwoJICAgICAgaWYgKChuYW1lID09PSAnc2hpZnQnIHx8IG5hbWUgPT09ICdzcGxpY2UnKSAmJiBvYmoubGVuZ3RoID09PSAwKSBkZWxldGUgb2JqWzBdOwoJICAgICAgcmV0dXJuIHJlc3VsdCh0aGlzLCBvYmopOwoJICAgIH07CgkgIH0pOwoKCSAgLy8gQWRkIGFsbCBhY2Nlc3NvciBBcnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuCgkgIF8uZWFjaChbJ2NvbmNhdCcsICdqb2luJywgJ3NsaWNlJ10sIGZ1bmN0aW9uKG5hbWUpIHsKCSAgICB2YXIgbWV0aG9kID0gQXJyYXlQcm90b1tuYW1lXTsKCSAgICBfLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uKCkgewoJICAgICAgcmV0dXJuIHJlc3VsdCh0aGlzLCBtZXRob2QuYXBwbHkodGhpcy5fd3JhcHBlZCwgYXJndW1lbnRzKSk7CgkgICAgfTsKCSAgfSk7CgoJICAvLyBFeHRyYWN0cyB0aGUgcmVzdWx0IGZyb20gYSB3cmFwcGVkIGFuZCBjaGFpbmVkIG9iamVjdC4KCSAgXy5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbigpIHsKCSAgICByZXR1cm4gdGhpcy5fd3JhcHBlZDsKCSAgfTsKCgkgIC8vIFByb3ZpZGUgdW53cmFwcGluZyBwcm94eSBmb3Igc29tZSBtZXRob2RzIHVzZWQgaW4gZW5naW5lIG9wZXJhdGlvbnMKCSAgLy8gc3VjaCBhcyBhcml0aG1ldGljIGFuZCBKU09OIHN0cmluZ2lmaWNhdGlvbi4KCSAgXy5wcm90b3R5cGUudmFsdWVPZiA9IF8ucHJvdG90eXBlLnRvSlNPTiA9IF8ucHJvdG90eXBlLnZhbHVlOwoKCSAgXy5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHsKCSAgICByZXR1cm4gJycgKyB0aGlzLl93cmFwcGVkOwoJICB9OwoKCSAgLy8gQU1EIHJlZ2lzdHJhdGlvbiBoYXBwZW5zIGF0IHRoZSBlbmQgZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBBTUQgbG9hZGVycwoJICAvLyB0aGF0IG1heSBub3QgZW5mb3JjZSBuZXh0LXR1cm4gc2VtYW50aWNzIG9uIG1vZHVsZXMuIEV2ZW4gdGhvdWdoIGdlbmVyYWwKCSAgLy8gcHJhY3RpY2UgZm9yIEFNRCByZWdpc3RyYXRpb24gaXMgdG8gYmUgYW5vbnltb3VzLCB1bmRlcnNjb3JlIHJlZ2lzdGVycwoJICAvLyBhcyBhIG5hbWVkIG1vZHVsZSBiZWNhdXNlLCBsaWtlIGpRdWVyeSwgaXQgaXMgYSBiYXNlIGxpYnJhcnkgdGhhdCBpcwoJICAvLyBwb3B1bGFyIGVub3VnaCB0byBiZSBidW5kbGVkIGluIGEgdGhpcmQgcGFydHkgbGliLCBidXQgbm90IGJlIHBhcnQgb2YKCSAgLy8gYW4gQU1EIGxvYWQgcmVxdWVzdC4gVGhvc2UgY2FzZXMgY291bGQgZ2VuZXJhdGUgYW4gZXJyb3Igd2hlbiBhbgoJICAvLyBhbm9ueW1vdXMgZGVmaW5lKCkgaXMgY2FsbGVkIG91dHNpZGUgb2YgYSBsb2FkZXIgcmVxdWVzdC4KCSAgaWYgKHRydWUpIHsKCSAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbXSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSBmdW5jdGlvbigpIHsKCSAgICAgIHJldHVybiBfOwoJICAgIH0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTsKCSAgfQoJfS5jYWxsKHRoaXMpKTsKCgovKioqLyB9LAovKiA5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8qIQoJICogSmF2YVNjcmlwdCBDb29raWUgdjIuMS4wCgkgKiBodHRwczovL2dpdGh1Yi5jb20vanMtY29va2llL2pzLWNvb2tpZQoJICoKCSAqIENvcHlyaWdodCAyMDA2LCAyMDE1IEtsYXVzIEhhcnRsICYgRmFnbmVyIEJyYWNrCgkgKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UKCSAqLwoJKGZ1bmN0aW9uIChmYWN0b3J5KSB7CgkJaWYgKHRydWUpIHsKCQkJIShfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18gPSAoZmFjdG9yeSksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gKHR5cGVvZiBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18gPT09ICdmdW5jdGlvbicgPyAoX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fLmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXywgZXhwb3J0cywgbW9kdWxlKSkgOiBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7CgkJfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHsKCQkJbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7CgkJfSBlbHNlIHsKCQkJdmFyIF9PbGRDb29raWVzID0gd2luZG93LkNvb2tpZXM7CgkJCXZhciBhcGkgPSB3aW5kb3cuQ29va2llcyA9IGZhY3RvcnkoKTsKCQkJYXBpLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7CgkJCQl3aW5kb3cuQ29va2llcyA9IF9PbGRDb29raWVzOwoJCQkJcmV0dXJuIGFwaTsKCQkJfTsKCQl9Cgl9KGZ1bmN0aW9uICgpIHsKCQlmdW5jdGlvbiBleHRlbmQgKCkgewoJCQl2YXIgaSA9IDA7CgkJCXZhciByZXN1bHQgPSB7fTsKCQkJZm9yICg7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKCQkJCXZhciBhdHRyaWJ1dGVzID0gYXJndW1lbnRzWyBpIF07CgkJCQlmb3IgKHZhciBrZXkgaW4gYXR0cmlidXRlcykgewoJCQkJCXJlc3VsdFtrZXldID0gYXR0cmlidXRlc1trZXldOwoJCQkJfQoJCQl9CgkJCXJldHVybiByZXN1bHQ7CgkJfQoKCQlmdW5jdGlvbiBpbml0IChjb252ZXJ0ZXIpIHsKCQkJZnVuY3Rpb24gYXBpIChrZXksIHZhbHVlLCBhdHRyaWJ1dGVzKSB7CgkJCQl2YXIgcmVzdWx0OwoKCQkJCS8vIFdyaXRlCgoJCQkJaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7CgkJCQkJYXR0cmlidXRlcyA9IGV4dGVuZCh7CgkJCQkJCXBhdGg6ICcvJwoJCQkJCX0sIGFwaS5kZWZhdWx0cywgYXR0cmlidXRlcyk7CgoJCQkJCWlmICh0eXBlb2YgYXR0cmlidXRlcy5leHBpcmVzID09PSAnbnVtYmVyJykgewoJCQkJCQl2YXIgZXhwaXJlcyA9IG5ldyBEYXRlKCk7CgkJCQkJCWV4cGlyZXMuc2V0TWlsbGlzZWNvbmRzKGV4cGlyZXMuZ2V0TWlsbGlzZWNvbmRzKCkgKyBhdHRyaWJ1dGVzLmV4cGlyZXMgKiA4NjRlKzUpOwoJCQkJCQlhdHRyaWJ1dGVzLmV4cGlyZXMgPSBleHBpcmVzOwoJCQkJCX0KCgkJCQkJdHJ5IHsKCQkJCQkJcmVzdWx0ID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpOwoJCQkJCQlpZiAoL15bXHtcW10vLnRlc3QocmVzdWx0KSkgewoJCQkJCQkJdmFsdWUgPSByZXN1bHQ7CgkJCQkJCX0KCQkJCQl9IGNhdGNoIChlKSB7fQoKCQkJCQlpZiAoIWNvbnZlcnRlci53cml0ZSkgewoJCQkJCQl2YWx1ZSA9IGVuY29kZVVSSUNvbXBvbmVudChTdHJpbmcodmFsdWUpKQoJCQkJCQkJLnJlcGxhY2UoLyUoMjN8MjR8MjZ8MkJ8M0F8M0N8M0V8M0R8MkZ8M0Z8NDB8NUJ8NUR8NUV8NjB8N0J8N0R8N0MpL2csIGRlY29kZVVSSUNvbXBvbmVudCk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJdmFsdWUgPSBjb252ZXJ0ZXIud3JpdGUodmFsdWUsIGtleSk7CgkJCQkJfQoKCQkJCQlrZXkgPSBlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGtleSkpOwoJCQkJCWtleSA9IGtleS5yZXBsYWNlKC8lKDIzfDI0fDI2fDJCfDVFfDYwfDdDKS9nLCBkZWNvZGVVUklDb21wb25lbnQpOwoJCQkJCWtleSA9IGtleS5yZXBsYWNlKC9bXChcKV0vZywgZXNjYXBlKTsKCgkJCQkJcmV0dXJuIChkb2N1bWVudC5jb29raWUgPSBbCgkJCQkJCWtleSwgJz0nLCB2YWx1ZSwKCQkJCQkJYXR0cmlidXRlcy5leHBpcmVzICYmICc7IGV4cGlyZXM9JyArIGF0dHJpYnV0ZXMuZXhwaXJlcy50b1VUQ1N0cmluZygpLCAvLyB1c2UgZXhwaXJlcyBhdHRyaWJ1dGUsIG1heC1hZ2UgaXMgbm90IHN1cHBvcnRlZCBieSBJRQoJCQkJCQlhdHRyaWJ1dGVzLnBhdGggICAgJiYgJzsgcGF0aD0nICsgYXR0cmlidXRlcy5wYXRoLAoJCQkJCQlhdHRyaWJ1dGVzLmRvbWFpbiAgJiYgJzsgZG9tYWluPScgKyBhdHRyaWJ1dGVzLmRvbWFpbiwKCQkJCQkJYXR0cmlidXRlcy5zZWN1cmUgPyAnOyBzZWN1cmUnIDogJycKCQkJCQldLmpvaW4oJycpKTsKCQkJCX0KCgkJCQkvLyBSZWFkCgoJCQkJaWYgKCFrZXkpIHsKCQkJCQlyZXN1bHQgPSB7fTsKCQkJCX0KCgkJCQkvLyBUbyBwcmV2ZW50IHRoZSBmb3IgbG9vcCBpbiB0aGUgZmlyc3QgcGxhY2UgYXNzaWduIGFuIGVtcHR5IGFycmF5CgkJCQkvLyBpbiBjYXNlIHRoZXJlIGFyZSBubyBjb29raWVzIGF0IGFsbC4gQWxzbyBwcmV2ZW50cyBvZGQgcmVzdWx0IHdoZW4KCQkJCS8vIGNhbGxpbmcgImdldCgpIgoJCQkJdmFyIGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUgPyBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsgJykgOiBbXTsKCQkJCXZhciByZGVjb2RlID0gLyglWzAtOUEtWl17Mn0pKy9nOwoJCQkJdmFyIGkgPSAwOwoKCQkJCWZvciAoOyBpIDwgY29va2llcy5sZW5ndGg7IGkrKykgewoJCQkJCXZhciBwYXJ0cyA9IGNvb2tpZXNbaV0uc3BsaXQoJz0nKTsKCQkJCQl2YXIgbmFtZSA9IHBhcnRzWzBdLnJlcGxhY2UocmRlY29kZSwgZGVjb2RlVVJJQ29tcG9uZW50KTsKCQkJCQl2YXIgY29va2llID0gcGFydHMuc2xpY2UoMSkuam9pbignPScpOwoKCQkJCQlpZiAoY29va2llLmNoYXJBdCgwKSA9PT0gJyInKSB7CgkJCQkJCWNvb2tpZSA9IGNvb2tpZS5zbGljZSgxLCAtMSk7CgkJCQkJfQoKCQkJCQl0cnkgewoJCQkJCQljb29raWUgPSBjb252ZXJ0ZXIucmVhZCA/CgkJCQkJCQljb252ZXJ0ZXIucmVhZChjb29raWUsIG5hbWUpIDogY29udmVydGVyKGNvb2tpZSwgbmFtZSkgfHwKCQkJCQkJCWNvb2tpZS5yZXBsYWNlKHJkZWNvZGUsIGRlY29kZVVSSUNvbXBvbmVudCk7CgoJCQkJCQlpZiAodGhpcy5qc29uKSB7CgkJCQkJCQl0cnkgewoJCQkJCQkJCWNvb2tpZSA9IEpTT04ucGFyc2UoY29va2llKTsKCQkJCQkJCX0gY2F0Y2ggKGUpIHt9CgkJCQkJCX0KCgkJCQkJCWlmIChrZXkgPT09IG5hbWUpIHsKCQkJCQkJCXJlc3VsdCA9IGNvb2tpZTsKCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgoJCQkJCQlpZiAoIWtleSkgewoJCQkJCQkJcmVzdWx0W25hbWVdID0gY29va2llOwoJCQkJCQl9CgkJCQkJfSBjYXRjaCAoZSkge30KCQkJCX0KCgkJCQlyZXR1cm4gcmVzdWx0OwoJCQl9CgoJCQlhcGkuZ2V0ID0gYXBpLnNldCA9IGFwaTsKCQkJYXBpLmdldEpTT04gPSBmdW5jdGlvbiAoKSB7CgkJCQlyZXR1cm4gYXBpLmFwcGx5KHsKCQkJCQlqc29uOiB0cnVlCgkJCQl9LCBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cykpOwoJCQl9OwoJCQlhcGkuZGVmYXVsdHMgPSB7fTsKCgkJCWFwaS5yZW1vdmUgPSBmdW5jdGlvbiAoa2V5LCBhdHRyaWJ1dGVzKSB7CgkJCQlhcGkoa2V5LCAnJywgZXh0ZW5kKGF0dHJpYnV0ZXMsIHsKCQkJCQlleHBpcmVzOiAtMQoJCQkJfSkpOwoJCQl9OwoKCQkJYXBpLndpdGhDb252ZXJ0ZXIgPSBpbml0OwoKCQkJcmV0dXJuIGFwaTsKCQl9CgoJCXJldHVybiBpbml0KGZ1bmN0aW9uICgpIHt9KTsKCX0pKTsKCgovKioqLyB9LAovKiAxMCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkhKG1vZHVsZS5leHBvcnRzID0gewoJICAiY291bnRyeSI6ICJjb3VudHJ5LmQ1NTNlNGRhZWQ5ZDBjNGMzNzhhMzBkNzdkOWY3ZTNjIiwKCSAgImNvdW50cnlfY3MiOiAiY291bnRyeV9jcy44NmE2ZTc5NDgxNDk3ODU1MGZlM2QwMGIyZTAyYTFjYiIsCgkgICJjb3VudHJ5X2RhIjogImNvdW50cnlfZGEuMTM5OGU5YTlhMzZhODg4MWM5MmY0NGJiZDI3NDYyNWYiLAoJICAiY291bnRyeV9kZSI6ICJjb3VudHJ5X2RlLjM2MjNlYTg2MGJiOTgyZjM1YmU4OGQ3MzNmODUwMzRhIiwKCSAgImNvdW50cnlfZXMiOiAiY291bnRyeV9lcy4zMjA3MTY5YjBjNTMwN2M0MTRmZjlhMGUwNzYxM2QzMiIsCgkgICJjb3VudHJ5X2ZpIjogImNvdW50cnlfZmkuMzhiM2JjZjA1YTQyYTZjNDQwODVhYTU1YzczNTcyOTkiLAoJICAiY291bnRyeV9mciI6ICJjb3VudHJ5X2ZyLjk2MDZlODI2MGViMDk0NDc1ZjVkM2VjY2E4ZGVmMTRiIiwKCSAgImNvdW50cnlfaHUiOiAiY291bnRyeV9odS43NWY0MjE0ZGY1MTQxY2VkMzAwZDY0ZmVlMGM5MTExZSIsCgkgICJjb3VudHJ5X2lkIjogImNvdW50cnlfaWQuMDE5MzkxMzIxMmYxZmI3MGI5ZDIzNGEyOTc5NDIzOGMiLAoJICAiY291bnRyeV9pbiI6ICJjb3VudHJ5X2luLjAxOTM5MTMyMTJmMWZiNzBiOWQyMzRhMjk3OTQyMzhjIiwKCSAgImNvdW50cnlfaXQiOiAiY291bnRyeV9pdC4yN2E3NTdmMTNmZTBmY2RiODRiZmJiYmNiNGE0YzQ2NSIsCgkgICJjb3VudHJ5X2phIjogImNvdW50cnlfamEuZWE5ZTExNGRjYzcwYjIyOGNiZGFlZjVmNGU2YzA4NWQiLAoJICAiY291bnRyeV9rbyI6ICJjb3VudHJ5X2tvLmVjOGYzOTAyMGFjOTQ3N2UyZjgwMGI4NjU3ZmY2OGU2IiwKCSAgImNvdW50cnlfbXMiOiAiY291bnRyeV9tcy40ZDQ5MmEzOWRkYmU2MTBhODIyMmRmMzJjMzQxZDUxNCIsCgkgICJjb3VudHJ5X25sX05MIjogImNvdW50cnlfbmxfTkwuM2VmMTViOWFiYzFkMzcwZjc3NThiZGZkMGQ2YTczNmEiLAoJICAiY291bnRyeV9wbCI6ICJjb3VudHJ5X3BsLjM4ZjA3MWNhOTcyNDY4OTAzNGZhMDE0YjE1M2I2Mzg3IiwKCSAgImNvdW50cnlfcHRfQlIiOiAiY291bnRyeV9wdF9CUi40NmQxYzVhMmZkMGNhODg0ZWE1OTkzNjk1YmQ1MmQ3MiIsCgkgICJjb3VudHJ5X3JvIjogImNvdW50cnlfcm8uYTMzZDdhNDc2MDUwNmE1ZDAyZmYwODQ4MTliYjYxMTAiLAoJICAiY291bnRyeV9ydSI6ICJjb3VudHJ5X3J1LmNhYjcwYjEzYTg3ZjlkMjc0YmJlZThjNWFkNzk0MTFjIiwKCSAgImNvdW50cnlfc3YiOiAiY291bnRyeV9zdi5iMjg2OWE5OTJjZjQ2NjBkMDAwMGYzMTgwZjFiN2UyMSIsCgkgICJjb3VudHJ5X3RoIjogImNvdW50cnlfdGguYzY3YWVlZTk4ZGEwNTE5YjRlMDUxZWEwMzA5MDMzMjIiLAoJICAiY291bnRyeV91ayI6ICJjb3VudHJ5X3VrLjg5ZWVhNTZkMTk3ZWUzNjkzYjRmNjVkZDBkOGQzYTZhIiwKCSAgImNvdW50cnlfemhfQ04iOiAiY291bnRyeV96aF9DTi4wNmZjNWFlMTNhNDllMjRjZTBjNmJmNzYzYTk2NzAxNiIsCgkgICJjb3VudHJ5X3poX1RXIjogImNvdW50cnlfemhfVFcuYmY2M2ZkNzYyYzFmZTFlMjVmNWE4ZjRjNDkzNTI5ZTUiLAoJICAibG9naW4iOiAibG9naW4uMWVhODFkMDc5ZTM2ODgyODE2YzU5OTI2ODUzYWM3NDIiLAoJICAibG9naW5fY3MiOiAibG9naW5fY3MuNDEyZTZmMmQxNzUzNzJkMDMzZDVhZGNjMTBhMzQzNTIiLAoJICAibG9naW5fZGEiOiAibG9naW5fZGEuOTZhMDgyMzQyZWVmZDA3MzQyOWY3OTkxZWZhY2QwZGQiLAoJICAibG9naW5fZGUiOiAibG9naW5fZGUuYjg3Mzc0YzcwNzZlNjExZmU0NGRkYjMxZjc0OWZiZTEiLAoJICAibG9naW5fZXMiOiAibG9naW5fZXMuMzQ3ZGVhNDFmY2ZhZGZjN2NiOTc0MjY3OTI3NjQ0ZjYiLAoJICAibG9naW5fZmkiOiAibG9naW5fZmkuMDQzZDM5N2ZlMmNhNzE4YThjY2Q1YzljZDllM2I3OTQiLAoJICAibG9naW5fZnIiOiAibG9naW5fZnIuYTQ2NjNkOTUxZTYwZTcxMThhMTU5N2IyZTBlMzc2OTAiLAoJICAibG9naW5faHUiOiAibG9naW5faHUuMWFhMmIzZGE2MDAwYTdiODU2MzdhNDI0ZWE1YjhiNmMiLAoJICAibG9naW5faWQiOiAibG9naW5faWQuMzVjMjBmMGY5ZGNmMDZiNWM0ODVjZDhhOTYxMWU2YmUiLAoJICAibG9naW5faW4iOiAibG9naW5faW4uMzVjMjBmMGY5ZGNmMDZiNWM0ODVjZDhhOTYxMWU2YmUiLAoJICAibG9naW5faXQiOiAibG9naW5faXQuMzkyYTJkMzdhNTY3NGRiZDQ4OWRhOWZkNzM2NmMxNjYiLAoJICAibG9naW5famEiOiAibG9naW5famEuNGUyOWRiNzgzYzY4NTBlYjA4NjA2OWJlNDU0YmM3YzYiLAoJICAibG9naW5fa28iOiAibG9naW5fa28uN2UwNGJiNzhhYjcyYWI4YTM1MDdhZTkyMTIwNzExN2EiLAoJICAibG9naW5fbXMiOiAibG9naW5fbXMuMGQxY2UzOGIxM2IwYjFlNmI5ZmE2NzRkNGMxZTE2MjciLAoJICAibG9naW5fbmxfTkwiOiAibG9naW5fbmxfTkwuMjM2YTNkNTVmMzVhOWI0MWQyMWNmNjQzODYwZjk4OTAiLAoJICAibG9naW5fcGwiOiAibG9naW5fcGwuMWQ0ZmI3NWUyZjY0OTY0N2Q5MmFlZGMzODVlNjdhYTMiLAoJICAibG9naW5fcHRfQlIiOiAibG9naW5fcHRfQlIuM2IxYmRkNzI5MDBkMTQzYzQwMTU0Njc5ZjgwMWNmYjQiLAoJICAibG9naW5fcm8iOiAibG9naW5fcm8uODNkNTlhZTkyMzFhNzlmNmZiMGVlMDE2YmJiNjQ5YzQiLAoJICAibG9naW5fcnUiOiAibG9naW5fcnUuMGRiYjVhYTMzYTc0MDFkMWM0OGU5Y2FmNjYyNDljN2IiLAoJICAibG9naW5fc3YiOiAibG9naW5fc3YuZGNjYTM4OGE1NzY4ODQzMDYyYTFhMWYwYzA4MjBlOTciLAoJICAibG9naW5fdGgiOiAibG9naW5fdGguMTVmYmZmYWRmNjQ1NzRmZGJmYmJkMzFlYzAwNmYyMjYiLAoJICAibG9naW5fdWsiOiAibG9naW5fdWsuYTM2ZGJlYjAxMzZmYzk4NWY5NDcxMzBhZjUzYTExZTEiLAoJICAibG9naW5femhfQ04iOiAibG9naW5femhfQ04uYzU2OWM5NWMzYTM0YTE3MmI5YTIzOTI3OGMwNjliMDciLAoJICAibG9naW5femhfVFciOiAibG9naW5femhfVFcuY2RiZjRjYzRlZmE5ZTA4ZDA0YTAyZTJhMTNhMmViZjUiCgl9KTsKCi8qKiovIH0sCi8qIDExICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsvKiEKCSAqIGpRdWVyeSBCcm93c2VyIFBsdWdpbiAwLjEuMAoJICogaHR0cHM6Ly9naXRodWIuY29tL2dhYmNlYi9qcXVlcnktYnJvd3Nlci1wbHVnaW4KCSAqCgkgKiBPcmlnaW5hbCBqcXVlcnktYnJvd3NlciBjb2RlIENvcHlyaWdodCAyMDA1LCAyMDE1IGpRdWVyeSBGb3VuZGF0aW9uLCBJbmMuIGFuZCBvdGhlciBjb250cmlidXRvcnMKCSAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UKCSAqCgkgKiBNb2RpZmljYXRpb25zIENvcHlyaWdodCAyMDE1IEdhYnJpZWwgQ2VicmlhbgoJICogaHR0cHM6Ly9naXRodWIuY29tL2dhYmNlYgoJICoKCSAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZQoJICoKCSAqIERhdGU6IDA1LTA3LTIwMTUKCSAqLwoJLypnbG9iYWwgd2luZG93OiBmYWxzZSAqLwoKCShmdW5jdGlvbiAoZmFjdG9yeSkgewoJICBpZiAodHJ1ZSkgewoJICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS4KCSAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbX193ZWJwYWNrX3JlcXVpcmVfXyg0KV0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24gKCQpIHsKCSAgICAgIHJldHVybiBmYWN0b3J5KCQpOwoJICAgIH0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTsKCSAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlLmV4cG9ydHMgPT09ICdvYmplY3QnKSB7CgkgICAgLy8gTm9kZS1saWtlIGVudmlyb25tZW50CgkgICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoJ2pxdWVyeScpKTsKCSAgfSBlbHNlIHsKCSAgICAvLyBCcm93c2VyIGdsb2JhbHMKCSAgICBmYWN0b3J5KHdpbmRvdy5qUXVlcnkpOwoJICB9Cgl9KGZ1bmN0aW9uKGpRdWVyeSkgewoJICAidXNlIHN0cmljdCI7CgoJICBmdW5jdGlvbiB1YU1hdGNoKCB1YSApIHsKCSAgICAvLyBJZiBhbiBVQSBpcyBub3QgcHJvdmlkZWQsIGRlZmF1bHQgdG8gdGhlIGN1cnJlbnQgYnJvd3NlciBVQS4KCSAgICBpZiAoIHVhID09PSB1bmRlZmluZWQgKSB7CgkgICAgICB1YSA9IHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50OwoJICAgIH0KCSAgICB1YSA9IHVhLnRvTG93ZXJDYXNlKCk7CgoJICAgIHZhciBtYXRjaCA9IC8oZWRnZSlcLyhbXHcuXSspLy5leGVjKCB1YSApIHx8CgkgICAgICAgIC8ob3ByKVtcL10oW1x3Ll0rKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKGNocm9tZSlbIFwvXShbXHcuXSspLy5leGVjKCB1YSApIHx8CgkgICAgICAgIC8oaWVtb2JpbGUpW1wvXShbXHcuXSspLy5leGVjKCB1YSApIHx8CgkgICAgICAgIC8odmVyc2lvbikoYXBwbGV3ZWJraXQpWyBcL10oW1x3Ll0rKS4qKHNhZmFyaSlbIFwvXShbXHcuXSspLy5leGVjKCB1YSApIHx8CgkgICAgICAgIC8od2Via2l0KVsgXC9dKFtcdy5dKykuKih2ZXJzaW9uKVsgXC9dKFtcdy5dKykuKihzYWZhcmkpWyBcL10oW1x3Ll0rKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKHdlYmtpdClbIFwvXShbXHcuXSspLy5leGVjKCB1YSApIHx8CgkgICAgICAgIC8ob3BlcmEpKD86Lip2ZXJzaW9ufClbIFwvXShbXHcuXSspLy5leGVjKCB1YSApIHx8CgkgICAgICAgIC8obXNpZSkgKFtcdy5dKykvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgdWEuaW5kZXhPZigidHJpZGVudCIpID49IDAgJiYgLyhydikoPzo6fCApKFtcdy5dKykvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgdWEuaW5kZXhPZigiY29tcGF0aWJsZSIpIDwgMCAmJiAvKG1vemlsbGEpKD86Lio/IHJ2OihbXHcuXSspfCkvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgW107CgoJICAgIHZhciBwbGF0Zm9ybV9tYXRjaCA9IC8oaXBhZCkvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgLyhpcG9kKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKHdpbmRvd3MgcGhvbmUpLy5leGVjKCB1YSApIHx8CgkgICAgICAgIC8oaXBob25lKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKGtpbmRsZSkvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgLyhzaWxrKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKGFuZHJvaWQpLy5leGVjKCB1YSApIHx8CgkgICAgICAgIC8od2luKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKG1hYykvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgLyhsaW51eCkvLmV4ZWMoIHVhICkgfHwKCSAgICAgICAgLyhjcm9zKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKHBsYXlib29rKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKGJiKS8uZXhlYyggdWEgKSB8fAoJICAgICAgICAvKGJsYWNrYmVycnkpLy5leGVjKCB1YSApIHx8CgkgICAgICAgIFtdOwoKCSAgICB2YXIgYnJvd3NlciA9IHt9LAoJICAgICAgICBtYXRjaGVkID0gewoJICAgICAgICAgIGJyb3dzZXI6IG1hdGNoWyA1IF0gfHwgbWF0Y2hbIDMgXSB8fCBtYXRjaFsgMSBdIHx8ICIiLAoJICAgICAgICAgIHZlcnNpb246IG1hdGNoWyAyIF0gfHwgbWF0Y2hbIDQgXSB8fCAiMCIsCgkgICAgICAgICAgdmVyc2lvbk51bWJlcjogbWF0Y2hbIDQgXSB8fCBtYXRjaFsgMiBdIHx8ICIwIiwKCSAgICAgICAgICBwbGF0Zm9ybTogcGxhdGZvcm1fbWF0Y2hbIDAgXSB8fCAiIgoJICAgICAgICB9OwoKCSAgICBpZiAoIG1hdGNoZWQuYnJvd3NlciApIHsKCSAgICAgIGJyb3dzZXJbIG1hdGNoZWQuYnJvd3NlciBdID0gdHJ1ZTsKCSAgICAgIGJyb3dzZXIudmVyc2lvbiA9IG1hdGNoZWQudmVyc2lvbjsKCSAgICAgIGJyb3dzZXIudmVyc2lvbk51bWJlciA9IHBhcnNlSW50KG1hdGNoZWQudmVyc2lvbk51bWJlciwgMTApOwoJICAgIH0KCgkgICAgaWYgKCBtYXRjaGVkLnBsYXRmb3JtICkgewoJICAgICAgYnJvd3NlclsgbWF0Y2hlZC5wbGF0Zm9ybSBdID0gdHJ1ZTsKCSAgICB9CgoJICAgIC8vIFRoZXNlIGFyZSBhbGwgY29uc2lkZXJlZCBtb2JpbGUgcGxhdGZvcm1zLCBtZWFuaW5nIHRoZXkgcnVuIGEgbW9iaWxlIGJyb3dzZXIKCSAgICBpZiAoIGJyb3dzZXIuYW5kcm9pZCB8fCBicm93c2VyLmJiIHx8IGJyb3dzZXIuYmxhY2tiZXJyeSB8fCBicm93c2VyLmlwYWQgfHwgYnJvd3Nlci5pcGhvbmUgfHwKCSAgICAgIGJyb3dzZXIuaXBvZCB8fCBicm93c2VyLmtpbmRsZSB8fCBicm93c2VyLnBsYXlib29rIHx8IGJyb3dzZXIuc2lsayB8fCBicm93c2VyWyAid2luZG93cyBwaG9uZSIgXSkgewoJICAgICAgYnJvd3Nlci5tb2JpbGUgPSB0cnVlOwoJICAgIH0KCgkgICAgLy8gVGhlc2UgYXJlIGFsbCBjb25zaWRlcmVkIGRlc2t0b3AgcGxhdGZvcm1zLCBtZWFuaW5nIHRoZXkgcnVuIGEgZGVza3RvcCBicm93c2VyCgkgICAgaWYgKCBicm93c2VyLmNyb3MgfHwgYnJvd3Nlci5tYWMgfHwgYnJvd3Nlci5saW51eCB8fCBicm93c2VyLndpbiApIHsKCSAgICAgIGJyb3dzZXIuZGVza3RvcCA9IHRydWU7CgkgICAgfQoKCSAgICAvLyBDaHJvbWUsIE9wZXJhIDE1KyBhbmQgU2FmYXJpIGFyZSB3ZWJraXQgYmFzZWQgYnJvd3NlcnMKCSAgICBpZiAoIGJyb3dzZXIuY2hyb21lIHx8IGJyb3dzZXIub3ByIHx8IGJyb3dzZXIuc2FmYXJpICkgewoJICAgICAgYnJvd3Nlci53ZWJraXQgPSB0cnVlOwoJICAgIH0KCgkgICAgLy8gSUUxMSBoYXMgYSBuZXcgdG9rZW4gc28gd2Ugd2lsbCBhc3NpZ24gaXQgbXNpZSB0byBhdm9pZCBicmVha2luZyBjaGFuZ2VzCgkgICAgaWYgKCBicm93c2VyLnJ2IHx8IGJyb3dzZXIuaWVtb2JpbGUpIHsKCSAgICAgIHZhciBpZSA9ICJtc2llIjsKCgkgICAgICBtYXRjaGVkLmJyb3dzZXIgPSBpZTsKCSAgICAgIGJyb3dzZXJbaWVdID0gdHJ1ZTsKCSAgICB9CgoJICAgIC8vIEVkZ2UgaXMgb2ZmaWNpYWxseSBrbm93biBhcyBNaWNyb3NvZnQgRWRnZSwgc28gcmV3cml0ZSB0aGUga2V5IHRvIG1hdGNoCgkgICAgaWYgKCBicm93c2VyLmVkZ2UgKSB7CgkgICAgICBkZWxldGUgYnJvd3Nlci5lZGdlOwoJICAgICAgdmFyIG1zZWRnZSA9ICJtc2VkZ2UiOwoKCSAgICAgIG1hdGNoZWQuYnJvd3NlciA9IG1zZWRnZTsKCSAgICAgIGJyb3dzZXJbbXNlZGdlXSA9IHRydWU7CgkgICAgfQoKCSAgICAvLyBCbGFja2JlcnJ5IGJyb3dzZXJzIGFyZSBtYXJrZWQgYXMgU2FmYXJpIG9uIEJsYWNrQmVycnkKCSAgICBpZiAoIGJyb3dzZXIuc2FmYXJpICYmIGJyb3dzZXIuYmxhY2tiZXJyeSApIHsKCSAgICAgIHZhciBibGFja2JlcnJ5ID0gImJsYWNrYmVycnkiOwoKCSAgICAgIG1hdGNoZWQuYnJvd3NlciA9IGJsYWNrYmVycnk7CgkgICAgICBicm93c2VyW2JsYWNrYmVycnldID0gdHJ1ZTsKCSAgICB9CgoJICAgIC8vIFBsYXlib29rIGJyb3dzZXJzIGFyZSBtYXJrZWQgYXMgU2FmYXJpIG9uIFBsYXlib29rCgkgICAgaWYgKCBicm93c2VyLnNhZmFyaSAmJiBicm93c2VyLnBsYXlib29rICkgewoJICAgICAgdmFyIHBsYXlib29rID0gInBsYXlib29rIjsKCgkgICAgICBtYXRjaGVkLmJyb3dzZXIgPSBwbGF5Ym9vazsKCSAgICAgIGJyb3dzZXJbcGxheWJvb2tdID0gdHJ1ZTsKCSAgICB9CgoJICAgIC8vIEJCMTAgaXMgYSBuZXdlciBPUyB2ZXJzaW9uIG9mIEJsYWNrQmVycnkKCSAgICBpZiAoIGJyb3dzZXIuYmIgKSB7CgkgICAgICB2YXIgYmIgPSAiYmxhY2tiZXJyeSI7CgoJICAgICAgbWF0Y2hlZC5icm93c2VyID0gYmI7CgkgICAgICBicm93c2VyW2JiXSA9IHRydWU7CgkgICAgfQoKCSAgICAvLyBPcGVyYSAxNSsgYXJlIGlkZW50aWZpZWQgYXMgb3ByCgkgICAgaWYgKCBicm93c2VyLm9wciApIHsKCSAgICAgIHZhciBvcGVyYSA9ICJvcGVyYSI7CgoJICAgICAgbWF0Y2hlZC5icm93c2VyID0gb3BlcmE7CgkgICAgICBicm93c2VyW29wZXJhXSA9IHRydWU7CgkgICAgfQoKCSAgICAvLyBTdG9jayBBbmRyb2lkIGJyb3dzZXJzIGFyZSBtYXJrZWQgYXMgU2FmYXJpIG9uIEFuZHJvaWQuCgkgICAgaWYgKCBicm93c2VyLnNhZmFyaSAmJiBicm93c2VyLmFuZHJvaWQgKSB7CgkgICAgICB2YXIgYW5kcm9pZCA9ICJhbmRyb2lkIjsKCgkgICAgICBtYXRjaGVkLmJyb3dzZXIgPSBhbmRyb2lkOwoJICAgICAgYnJvd3NlclthbmRyb2lkXSA9IHRydWU7CgkgICAgfQoKCSAgICAvLyBLaW5kbGUgYnJvd3NlcnMgYXJlIG1hcmtlZCBhcyBTYWZhcmkgb24gS2luZGxlCgkgICAgaWYgKCBicm93c2VyLnNhZmFyaSAmJiBicm93c2VyLmtpbmRsZSApIHsKCSAgICAgIHZhciBraW5kbGUgPSAia2luZGxlIjsKCgkgICAgICBtYXRjaGVkLmJyb3dzZXIgPSBraW5kbGU7CgkgICAgICBicm93c2VyW2tpbmRsZV0gPSB0cnVlOwoJICAgIH0KCgkgICAgIC8vIEtpbmRsZSBTaWxrIGJyb3dzZXJzIGFyZSBtYXJrZWQgYXMgU2FmYXJpIG9uIEtpbmRsZQoJICAgIGlmICggYnJvd3Nlci5zYWZhcmkgJiYgYnJvd3Nlci5zaWxrICkgewoJICAgICAgdmFyIHNpbGsgPSAic2lsayI7CgoJICAgICAgbWF0Y2hlZC5icm93c2VyID0gc2lsazsKCSAgICAgIGJyb3dzZXJbc2lsa10gPSB0cnVlOwoJICAgIH0KCgkgICAgLy8gQXNzaWduIHRoZSBuYW1lIGFuZCBwbGF0Zm9ybSB2YXJpYWJsZQoJICAgIGJyb3dzZXIubmFtZSA9IG1hdGNoZWQuYnJvd3NlcjsKCSAgICBicm93c2VyLnBsYXRmb3JtID0gbWF0Y2hlZC5wbGF0Zm9ybTsKCSAgICByZXR1cm4gYnJvd3NlcjsKCSAgfQoKCSAgLy8gUnVuIHRoZSBtYXRjaGluZyBwcm9jZXNzLCBhbHNvIGFzc2lnbiB0aGUgZnVuY3Rpb24gdG8gdGhlIHJldHVybmVkIG9iamVjdAoJICAvLyBmb3IgbWFudWFsLCBqUXVlcnktZnJlZSB1c2UgaWYgZGVzaXJlZAoJICB3aW5kb3cualFCcm93c2VyID0gdWFNYXRjaCggd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQgKTsKCSAgd2luZG93LmpRQnJvd3Nlci51YU1hdGNoID0gdWFNYXRjaDsKCgkgIC8vIE9ubHkgYXNzaWduIHRvIGpRdWVyeS5icm93c2VyIGlmIGpRdWVyeSBpcyBsb2FkZWQKCSAgaWYgKCBqUXVlcnkgKSB7CgkgICAgalF1ZXJ5LmJyb3dzZXIgPSB3aW5kb3cualFCcm93c2VyOwoJICB9CgoJICByZXR1cm4gd2luZG93LmpRQnJvd3NlcjsKCX0pKTsKCgovKioqLyB9LAovKiAxMiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187J3VzZSBzdHJpY3QnOwoKCS8vIFNpbXBsZSBjbGFzcyB0aGF0IHBvc3RzIGxvZ2luIGRhdGEgdG8gdGhlIGFjY291bnQgY2hvb3NlciBkaXNjb3ZlcnkgdXJsIG9uCgkvLyBzdWNjZXNzZnVsIGxvZ2lucy4gVGhpcyB1cmwgaXMgYSBjcm9zcyBvcmlnaW4gb2t0YSBkb21haW4gdGhhdCBjYW4gYmUKCS8vIGFjY2Vzc2VkIGJ5IGFueSBva3RhIG9yaWdpbiBpbnRlcmVzdGVkIGluIHNlZWluZyB3aGljaCBhY2NvdW50cyB0aGUgY3VycmVudAoJLy8gdXNlciBoYXMgc2lnbmVkIGludG8uCgkhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbX193ZWJwYWNrX3JlcXVpcmVfXyg0KSwgX193ZWJwYWNrX3JlcXVpcmVfXyg1KV0sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24gKCQsIEhhbmRsZWJhcnMpIHsKCgkgIC8vIE1heCB0aW1lIHRvIHdhaXQgZm9yIGEgcmVzcG9uc2UgZnJvbSBhY2NvdW50IGNob29zZXIgaWZyYW1lIGFmdGVyCgkgIC8vIGxvZ2luIG1lc3NhZ2UgaXMgc2VudC4KCSAgdmFyIE1BWF9XQUlUID0gMTAwMDsKCgkgIHZhciBpZnJhbWVUcGwgPSBIYW5kbGViYXJzLmNvbXBpbGUoJ1wKCSAgICA8aWZyYW1lIGRhdGEtc2U9ImFjY291bnQtY2hvb3NlciIgc3JjPSJ7e3NyY319IiBzdHlsZT0iZGlzcGxheTpub25lIj48L2lmcmFtZT5cCgkgICcpOwoKCSAgZnVuY3Rpb24gQWNjb3VudENob29zZXIob3B0aW9ucykgewoJICAgIHZhciBpZnJhbWUgPSAkKGlmcmFtZVRwbCh7IHNyYzogb3B0aW9ucy5kaXNjb3ZlcnlVcmwgfSkpOwoJICAgIHRoaXMuZGlzY292ZXJ5VXJsID0gb3B0aW9ucy5kaXNjb3ZlcnlVcmw7CgkgICAgdGhpcy5pZnJhbWUgPSBpZnJhbWUuZ2V0KDApOwoJICAgICQoZnVuY3Rpb24gKCkgewoJICAgICAgJCgnYm9keScpLmFwcGVuZChpZnJhbWUpOwoJICAgIH0pOwoJICB9CgoJICAvLyBQb3N0cyBsb2dpbiBtZXNzYWdlIHRvIGFjY291bnQgY2hvb3NlciBpZnJhbWUuIFRoZSBhY2NvdW50IGNob29zZXIKCSAgLy8gd2lsbCBzdG9yZSB0aGlzIGRhdGEgaW4gbG9jYWxTdG9yYWdlIGZvciBmdXR1cmUgY3Jvc3Mgb3JpZ2luIGFjY2Vzcy4KCSAgQWNjb3VudENob29zZXIucHJvdG90eXBlLmxvZ2luID0gZnVuY3Rpb24gKHVzZXJQcm9maWxlLCBjYikgewoJICAgIHZhciBtc2csIG1hdGNoZXMsIHRhcmdldE9yaWdpbiwgbWF4VGltZW91dDsKCgkgICAgbXNnID0gewoJICAgICAgbWVzc2FnZVR5cGU6ICdsb2dpbicsCgkgICAgICBkaXNwbGF5TmFtZTogdXNlclByb2ZpbGUuZmlyc3ROYW1lICsgJyAnICsgdXNlclByb2ZpbGUubGFzdE5hbWUsCgkgICAgICBsb2dpbjogdXNlclByb2ZpbGUubG9naW4KCSAgICB9OwoKCSAgICAvLyBBdXRvbWF0aWNhbGx5IHJlZGlyZWN0IGFmdGVyIE1BWF9XQUlUIG1zIGluIHRoZSBldmVudCB0aGF0IHRoZSBhY2NvdW50CgkgICAgLy8gY2hvb3NlciBkb21haW4gaXMgdG9vIHNsb3cgdG8gcmVzcG9uZC4KCSAgICBtYXhUaW1lb3V0ID0gc2V0VGltZW91dChjYiwgTUFYX1dBSVQpOwoKCSAgICBtYXRjaGVzID0gbmV3IFJlZ0V4cCgnXmh0dHBzPzovL1teL10rJykuZXhlYyh0aGlzLmRpc2NvdmVyeVVybCk7CgkgICAgdGFyZ2V0T3JpZ2luID0gbWF0Y2hlcyA/IG1hdGNoZXNbMF0gOiBudWxsOwoKCSAgICBpZiAodGFyZ2V0T3JpZ2luKSB7CgkgICAgICAvLyAxLiBTZXR1cCB0aGUgcmVzcG9uc2UgbWVzc2FnZSBoYW5kbGVyCgkgICAgICAkKHdpbmRvdykub24oJ21lc3NhZ2UuYWNjb3VudENob29zZXInLCBmdW5jdGlvbiAoZSkgewoJICAgICAgICAvLyBPbmx5IGxpc3RlbiB0byBtZXNzYWdlcyBmcm9tIHRoZSBkaXNjb3ZlcnkgZG9tYWluCgkgICAgICAgIGlmIChlLm9yaWdpbmFsRXZlbnQub3JpZ2luICE9PSB0YXJnZXRPcmlnaW4pIHsKCSAgICAgICAgICByZXR1cm47CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGUub3JpZ2luYWxFdmVudC5kYXRhLm1lc3NhZ2VUeXBlID09PSAncHJvY2Vzc2VkX2xvZ2luJykgewoJICAgICAgICAgICQod2luZG93KS5vZmYoJ21lc3NhZ2UuYWNjb3VudENob29zZXInKTsKCSAgICAgICAgICBjbGVhclRpbWVvdXQobWF4VGltZW91dCk7CgkgICAgICAgICAgY2IoKTsKCSAgICAgICAgfQoJICAgICAgfSk7CgoJICAgICAgLy8gMi4gU2VuZCB0aGUgdXNlciBwcm9maWxlIGRhdGEgdG8gdGhlIGFjY291bnQgY2hvb3NlciBvcmlnaW4KCSAgICAgIHRoaXMuaWZyYW1lLmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UobXNnLCB0YXJnZXRPcmlnaW4pOwoJICAgIH0KCSAgfTsKCgkgIHJldHVybiBBY2NvdW50Q2hvb3NlcjsKCX0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTsKCi8qKiovIH0sCi8qIDEzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsndXNlIHN0cmljdCc7CgoJLy8gUG9ydGVkIG92ZXIgZnJvbSB0aGUgb3JpZ2luYWwgaW1wbGVtZW50YXRpb246CgkvLyAvanMvc2VjdGlvbnMvbW9iaWxlLXNzby1sb2dpbi5qcwoJLyogZXNsaW50IGNhbWVsY2FzZTogMCAqLwoJIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW19fd2VicGFja19yZXF1aXJlX18oNCksIF9fd2VicGFja19yZXF1aXJlX18oMyksIF9fd2VicGFja19yZXF1aXJlX18oNSldLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uICgkLCBVdGlsLCBIYW5kbGViYXJzKSB7CgoJICB2YXIgdHBsID0gSGFuZGxlYmFycy5jb21waWxlLAoJICAgICAgdG9rZW5UcGwgPSB0cGwoJy9vYXV0aDIvdG9rZW4/Y2xpZW50X2lkPXt7Y2xpZW50SWR9fSZncmFudF90eXBlPXNlc3Npb24mY29kZT17e2NsaWVudENvZGV9fScpLAoJICAgICAgY29kZVRwbCA9IHRwbCgnL29hdXRoMi9jb2RlP2NsaWVudF9pZD17e2NsaWVudElkfX0nKSwKCSAgICAgIG9rdGFTU09UcGwgPSB0cGwoJ29rdGFzc286Ly92MS9vYXV0aC92YWxpZGF0ZS97e3VzZXJDb2RlfX0nKSwKCSAgICAgIG9rdGFVbml2ZXJzYWxMaW5rVHBsID0gdHBsKCd7e2RvbWFpbn19L2F1dGgvb2t0YW1vYmlsZS8/c2l0ZU5hbWU9e3tzaXRlTmFtZX19Jm9yZz17e29yZ319JyArICcmdXNlck5hbWU9e3t1c2VyTmFtZX19JmFwcE5hbWU9e3thcHBOYW1lfX0mYXBwRXh0ZXJuYWxLZXk9e3thcHBFeHRlcm5hbEtleX19JyArICcmYXBwTGlua0lkPXt7YXBwTGlua0lkfX0mdXNlckNvZGU9e3t1c2VyQ29kZX19JnJlZGlyZWN0VXJsPXt7cmVkaXJlY3RVcmx9fScgKyAnJnRpbWVvdXRJbnRlcnZhbD17e3RpbWVvdXRJbnRlcnZhbH19JyksCgkgICAgICBtb2JpbGVMaW5rID0gJ2h0dHBzOi8vaXR1bmVzLmFwcGxlLmNvbS91cy9hcHAvb2t0YS1tb2JpbGUvaWQ1ODA3MDkyNTE/bXQ9OCc7CgoJICAvKiBlc2xpbnQgbWF4LXBhcmFtczogWzIsIDZdLCBtYXgtc3RhdGVtZW50czogWzIsIDI5XSAqLwoJICByZXR1cm4gZnVuY3Rpb24gaW5pdE1vYmlsZVNTTyhmcm9tVXJpLCBwYXJhbXMpIHsKCSAgICB2YXIgbGlua1BhcmFtcyA9IHBhcmFtczsKCSAgICB2YXIgb2t0YU1vYmlsZSA9IHsKCSAgICAgIGNsaWVudENvZGU6IHVuZGVmaW5lZCwKCSAgICAgIHVzZXJDb2RlOiB1bmRlZmluZWQsCgkgICAgICBwb2xsSW50ZXJ2YWw6IDUwMDAsCgkgICAgICAvLyAxMCBtaW50dWVzIC0tIE9rdGEgT0F1dGggY29kZSBleHBpcmF0aW9uIHRpbWU7IHNlZSBPa3RhT0F1dGgyMFNlcnZpY2UuT0FVVEhfQ09ERV9FWFBJUkFUSU9OX01JTlVURVMKCSAgICAgIHRpbWVvdXRJbnRlcnZhbDogNjAwMDAwLAoJICAgICAgY2xpZW50SWQ6ICdjYXBoeGNRS1BPVk9JSlVHQVhJQycsCgkgICAgICByZXF1aXJlVXNlclRyaWdnZXI6IHRydWUsCgkgICAgICBtYW51YWxMb2dpbjogZmFsc2UKCSAgICB9OwoKCSAgICB2YXIgdGltZW91dFRpbWVNczsKCgkgICAgdmFyIHNjcmVlbnMgPSB7CgkgICAgICBhY2Nlc3NTY3JlZW5JZDogJ21vYmlsZVNTT19hY2Nlc3MnLAoJICAgICAgb3BlbmluZ1NjcmVlbklkOiAnbW9iaWxlU1NPX29wZW5pbmcnLAoJICAgICAgbG9hZGluZ1NjcmVlbklkOiAnbW9iaWxlU1NPX2xvYWRpbmcnLAoJICAgICAgdHJhZGl0aW9uYWxMb2dpblNjcmVlbklkOiAnbW9iaWxlU1NPX3RyYWRpdGlvbmFsTG9naW4nLAoJICAgICAgZXJyb3JTY3JlZW5JZDogJ21vYmlsZVNTT19lcnJvcicKCSAgICB9OwoKCSAgICBmdW5jdGlvbiBzaG93U2NyZWVuKHNjcmVlbklkKSB7CgkgICAgICAkLmVhY2goc2NyZWVucywgZnVuY3Rpb24gKGtleSwgdmFsKSB7CgkgICAgICAgICQoJyMnICsgdmFsKS50b2dnbGUodmFsID09PSBzY3JlZW5JZCk7CgkgICAgICB9KTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIHVzZXJDb2RlU3VjY2Vzc0NhbGxiYWNrKHVzZXJDb2RlKSB7CgkgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IG9rdGFTU09UcGwoeyB1c2VyQ29kZTogdXNlckNvZGUgfSk7CgkgICAgfQoKCSAgICBmdW5jdGlvbiB1c2VyQ29kZVN1Y2Nlc3NDYWxsYmFja0ZvclVpbnZlcnNhbExpbmsobGlua1BhcmFtcykgewoJICAgICAgdmFyIGxpbmsgPSBva3RhVW5pdmVyc2FsTGlua1RwbCh7IGRvbWFpbjogbGlua1BhcmFtcy5kb21haW4sCgkgICAgICAgIHNpdGVOYW1lOiBsaW5rUGFyYW1zLnNpdGVOYW1lLAoJICAgICAgICBvcmc6IGxpbmtQYXJhbXMub3JnLAoJICAgICAgICB1c2VyTmFtZTogbGlua1BhcmFtcy51c2VyTmFtZSwKCSAgICAgICAgYXBwTmFtZTogbGlua1BhcmFtcy5hcHBOYW1lLAoJICAgICAgICBhcHBFeHRlcm5hbEtleTogbGlua1BhcmFtcy5hcHBFeHRlcm5hbEtleSwKCSAgICAgICAgYXBwTGlua0lkOiBsaW5rUGFyYW1zLmFwcA==", "base64"));
  res.write(new Buffer("TGlua0lkLAoJICAgICAgICB1c2VyQ29kZTogbGlua1BhcmFtcy51c2VyQ29kZSwKCSAgICAgICAgcmVkaXJlY3RVcmw6IGxpbmtQYXJhbXMucmVkaXJlY3RVcmwsCgkgICAgICAgIHRpbWVvdXRJbnRlcnZhbDogb2t0YU1vYmlsZS50aW1lb3V0SW50ZXJ2YWwKCSAgICAgIH0pOwoJICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBsaW5rOwoJICAgIH0KCgkgICAgZnVuY3Rpb24gcG9sbE9uT0F1dGhDb2RlKCkgewoJICAgICAgaWYgKG9rdGFNb2JpbGUubWFudWFsTG9naW4pIHsKCSAgICAgICAgcmV0dXJuOwoJICAgICAgfQoKCSAgICAgIHZhciBjdXJyZW50VGltZU1zID0gRGF0ZS5ub3coKTsKCSAgICAgIGlmICh0aW1lb3V0VGltZU1zICE9PSB1bmRlZmluZWQgJiYgY3VycmVudFRpbWVNcyA+IHRpbWVvdXRUaW1lTXMpIHsKCSAgICAgICAgc2hvd1NjcmVlbihzY3JlZW5zLmVycm9yU2NyZWVuSWQpOwoJICAgICAgfQoKCSAgICAgIGlmIChva3RhTW9iaWxlLnRpbWVvdXRUaW1lTXMgPT09IHVuZGVmaW5lZCB8fCBjdXJyZW50VGltZU1zIDw9IHRpbWVvdXRUaW1lTXMgKyBva3RhTW9iaWxlLnRpbWVvdXRJbnRlcnZhbCAqIDEwKSB7CgkgICAgICAgICQuYWpheCh7CgkgICAgICAgICAgdHlwZTogJ1BPU1QnLAoJICAgICAgICAgIHVybDogdG9rZW5UcGwoeyBjbGllbnRJZDogb2t0YU1vYmlsZS5jbGllbnRJZCwgY2xpZW50Q29kZTogb2t0YU1vYmlsZS5jbGllbnRDb2RlIH0pLAoJICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsCgkgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gc3VjY2VzcyhkYXRhKSB7CgkgICAgICAgICAgICBpZiAoZGF0YS5zZXNzaW9uICYmIGRhdGEuc2Vzc2lvbi5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAgIFV0aWwucG9zdFRvVXJsKGZyb21VcmksICQoJ2JvZHknKSk7CgkgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICBzZXRUaW1lb3V0KHBvbGxPbk9BdXRoQ29kZSwgb2t0YU1vYmlsZS5wb2xsSW50ZXJ2YWwpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0sCgkgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIGVycm9yKCkgewoJICAgICAgICAgICAgc2V0VGltZW91dChwb2xsT25PQXV0aENvZGUsIG9rdGFNb2JpbGUucG9sbEludGVydmFsKTsKCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgfQoJICAgIH0KCgkgICAgZnVuY3Rpb24gcmVxdWVzdE9BdXRoQ29kZSgpIHsKCSAgICAgIHRpbWVvdXRUaW1lTXMgPSBEYXRlLm5vdygpICsgb2t0YU1vYmlsZS50aW1lb3V0SW50ZXJ2YWw7CgkgICAgICAkLmFqYXgoewoJICAgICAgICB0eXBlOiAnUE9TVCcsCgkgICAgICAgIHVybDogY29kZVRwbCh7IGNsaWVudElkOiBva3RhTW9iaWxlLmNsaWVudElkIH0pLAoJICAgICAgICBkYXRhVHlwZTogJ2pzb24nLAoJICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKGRhdGEpIHsKCSAgICAgICAgICBva3RhTW9iaWxlLmNsaWVudENvZGUgPSBkYXRhLmNsaWVudF9jb2RlOwoJICAgICAgICAgIG9rdGFNb2JpbGUudXNlckNvZGUgPSBkYXRhLnVzZXJfY29kZTsKCgkgICAgICAgICAgc2hvd1NjcmVlbihzY3JlZW5zLm9wZW5pbmdTY3JlZW5JZCk7CgkgICAgICAgICAgc2V0VGltZW91dChwb2xsT25PQXV0aENvZGUsIG9rdGFNb2JpbGUucG9sbEludGVydmFsKTsKCSAgICAgICAgICB1c2VyQ29kZVN1Y2Nlc3NDYWxsYmFjayhkYXRhLnVzZXJfY29kZSk7CgkgICAgICAgIH0sCgkgICAgICAgIGVycm9yOiBmdW5jdGlvbiBlcnJvcigpIHsKCSAgICAgICAgICBzaG93U2NyZWVuKHNjcmVlbnMuZXJyb3JTY3JlZW5JZCk7CgkgICAgICAgIH0KCSAgICAgIH0pOwoJICAgIH0KCgkgICAgZnVuY3Rpb24gcmVxdWVzdE9BdXRoQ29kZUZvclVpbnZlcnNhbExpbmsoKSB7CgkgICAgICB0aW1lb3V0VGltZU1zID0gRGF0ZS5ub3coKSArIG9rdGFNb2JpbGUudGltZW91dEludGVydmFsOwoJICAgICAgJC5hamF4KHsKCSAgICAgICAgdHlwZTogJ1BPU1QnLAoJICAgICAgICB1cmw6IGNvZGVUcGwoeyBjbGllbnRJZDogb2t0YU1vYmlsZS5jbGllbnRJZCB9KSwKCSAgICAgICAgZGF0YVR5cGU6ICdqc29uJywKCSAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gc3VjY2VzcyhkYXRhKSB7CgkgICAgICAgICAgb2t0YU1vYmlsZS5jbGllbnRDb2RlID0gZGF0YS5jbGllbnRfY29kZTsKCSAgICAgICAgICBva3RhTW9iaWxlLnVzZXJDb2RlID0gZGF0YS51c2VyX2NvZGU7CgkgICAgICAgICAgbGlua1BhcmFtcy51c2VyQ29kZSA9IGRhdGEudXNlcl9jb2RlOwoKCSAgICAgICAgICBzZXRUaW1lb3V0KHBvbGxPbk9BdXRoQ29kZSwgb2t0YU1vYmlsZS5wb2xsSW50ZXJ2YWwpOwoJICAgICAgICAgICQoJyNtb2JpbGVEZXZpY2VUcnVzdExvZ2luQnV0dG9uJykuY2xpY2sobGF1bmNoT2t0YU1vYmlsZUZvclVuaXZlcnNhbExpbmspOwoJICAgICAgICAgICQoJyNtb2JpbGVEZXZpY2VUcnVzdEV4cGlyZWRMb2dpbkJ1dHRvbicpLmNsaWNrKHB1cmVMYXVuY2hPa3RhTW9iaWxlRm9yVW5pdmVyc2FsTGluayk7CgkgICAgICAgIH0sCgkgICAgICAgIGVycm9yOiBmdW5jdGlvbiBlcnJvcigpIHsKCSAgICAgICAgICBzaG93U2NyZWVuKHNjcmVlbnMuZXJyb3JTY3JlZW5JZCk7CgkgICAgICAgIH0KCSAgICAgIH0pOwoJICAgIH0KCgkgICAgZnVuY3Rpb24gbGF1bmNoT2t0YU1vYmlsZUZvclVuaXZlcnNhbExpbmsoKSB7CgkgICAgICBzaG93U2NyZWVuKHNjcmVlbnMubG9hZGluZ1NjcmVlbklkKTsKCSAgICAgIHVzZXJDb2RlU3VjY2Vzc0NhbGxiYWNrRm9yVWludmVyc2FsTGluayhsaW5rUGFyYW1zKTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIHB1cmVMYXVuY2hPa3RhTW9iaWxlRm9yVW5pdmVyc2FsTGluaygpIHsKCSAgICAgIHVzZXJDb2RlU3VjY2Vzc0NhbGxiYWNrRm9yVWludmVyc2FsTGluayhsaW5rUGFyYW1zKTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIHNob3dUcmFkaXRpb25hbExvZ2luKCkgewoJICAgICAgLy8gTm90ZTogVGhpcyBkaWZmZXJzIGZyb20gdGhlIG9yaWdpbmFsIGltcGxlbWVudGF0aW9uIGluIHRoYXQgaXQganVzdAoJICAgICAgLy8gdG9nZ2xlcyB0byB0aGUgbmV3IGxvZ2luIGZsb3cKCSAgICAgIC8vIDEuIFJlbW92ZSBhbGwgc2NyZWVucwoJICAgICAgc2hvd1NjcmVlbigpOwoJICAgICAgb2t0YU1vYmlsZS5tYW51YWxMb2dpbiA9IHRydWU7CgkgICAgICAvLyAyLiBEaXNwbGF5IG5ldyBsb2dpbiBmbG93LCBtaW51cyBmb290ZXIKCSAgICAgICQoJyNzaWduaW4tY29udGFpbmVyJykuc2hvdygpOwoJICAgICAgJCgnI21vYmlsZVNTT19vdmVybGF5JykuaGlkZSgpOwoJICAgIH0KCgkgICAgZnVuY3Rpb24gaW5pdCgpIHsKCSAgICAgIGlmIChva3RhTW9iaWxlLnJlcXVpcmVVc2VyVHJpZ2dlciA9PT0gZmFsc2UpIHsKCSAgICAgICAgb2t0YU1vYmlsZS5zaG93U2NyZWVuKHNjcmVlbnMub3BlbmluZ1NjcmVlbklkKTsKCSAgICAgICAgcmVxdWVzdE9BdXRoQ29kZSgpOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgaWYgKGxpbmtQYXJhbXMgJiYgbGlua1BhcmFtcy5kb21haW4pIHsKCSAgICAgICAgICByZXF1ZXN0T0F1dGhDb2RlRm9yVWludmVyc2FsTGluaygpOwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICQoJyNtb2JpbGVTU09Mb2dpbkJ1dHRvbicpLmNsaWNrKHJlcXVlc3RPQXV0aENvZGUpOwoJICAgICAgICB9CgkgICAgICB9CgoJICAgICAgJCgnI2dldE9rdGFNb2JpbGVCdXR0b24nKS5jbGljayhmdW5jdGlvbiAoKSB7CgkgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbW9iaWxlTGluazsKCSAgICAgIH0pOwoKCSAgICAgICQoJyN0cmFkaXRpb25hbExvZ2luQnV0dG9uLCAjcmV0dXJuVG9Mb2dpbkJ1dHRvbicpLmNsaWNrKHNob3dUcmFkaXRpb25hbExvZ2luKTsKCSAgICB9CgoJICAgICQoaW5pdCk7CgkgIH07Cgl9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7CgovKioqLyB9LAovKiAxNCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsvKiEKCSAqIGpRdWVyeSBTbWFydCBCYW5uZXIKCSAqIENvcHlyaWdodCAoYykgMjAxMiBBcm5vbGQgRGFuaWVscyA8YXJub2xkQGphc255Lm5ldD4KCSAqIEJhc2VkIG9uICdqUXVlcnkgU21hcnQgV2ViIEFwcCBCYW5uZXInIGJ5IEt1cnQgWmVuaXNlayBAIGt6ZW5pLmNvbQoJICovCgkoZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHsKCSAgaWYgKHRydWUpIHsKCSAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbX193ZWJwYWNrX3JlcXVpcmVfXyg0KV0sIF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyA9IChmYWN0b3J5KSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSAodHlwZW9mIF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyA9PT0gJ2Z1bmN0aW9uJyA/IChfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXykpIDogX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpOwoJICB9IGVsc2UgewoJICAgIGZhY3Rvcnkocm9vdC5qUXVlcnkpOwoJICB9Cgl9KSh0aGlzLCBmdW5jdGlvbiAoJCkgewoJICAgIHZhciBTbWFydEJhbm5lciA9IGZ1bmN0aW9uIChvcHRpb25zKSB7CgkgICAgICAgIHRoaXMub3JpZ0h0bWxNYXJnaW4gPSBwYXJzZUZsb2F0KCQoJ2h0bWwnKS5jc3MoJ21hcmdpbi10b3AnKSk7IC8vIEdldCB0aGUgb3JpZ2luYWwgbWFyZ2luLXRvcCBvZiB0aGUgSFRNTCBlbGVtZW50IHNvIHdlIGNhbiB0YWtlIHRoYXQgaW50byBhY2NvdW50CgkgICAgICAgIHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCAkLnNtYXJ0YmFubmVyLmRlZmF1bHRzLCBvcHRpb25zKTsKCgkgICAgICAgIHZhciBzdGFuZGFsb25lID0gbmF2aWdhdG9yLnN0YW5kYWxvbmU7IC8vIENoZWNrIGlmIGl0J3MgYWxyZWFkeSBhIHN0YW5kYWxvbmUgd2ViIGFwcCBvciBydW5uaW5nIHdpdGhpbiBhIHdlYnVpIHZpZXcgb2YgYW4gYXBwIChub3QgbW9iaWxlIHNhZmFyaSkKCSAgICAgICAgdmFyIFVBID0gbmF2aWdhdG9yLnVzZXJBZ2VudDsKCgkgICAgICAgIC8vIERldGVjdCBiYW5uZXIgdHlwZSAoaU9TIG9yIEFuZHJvaWQpCgkgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZm9yY2UpIHsKCSAgICAgICAgICAgIHRoaXMudHlwZSA9IHRoaXMub3B0aW9ucy5mb3JjZTsKCSAgICAgICAgfSBlbHNlIGlmIChVQS5tYXRjaCgvV2luZG93cyBQaG9uZS9pKSAhPT0gbnVsbCAmJiBVQS5tYXRjaCgvRWRnZXxUb3VjaC9pKSAhPT0gbnVsbCkgewoJICAgICAgICAgICAgdGhpcy50eXBlID0gJ3dpbmRvd3MnOwoJICAgICAgICB9IGVsc2UgaWYgKFVBLm1hdGNoKC9pUGhvbmV8aVBvZC9pKSAhPT0gbnVsbCB8fCAoVUEubWF0Y2goL2lQYWQvKSAmJiB0aGlzLm9wdGlvbnMuaU9TVW5pdmVyc2FsQXBwKSkgewoJICAgICAgICAgICAgaWYgKFVBLm1hdGNoKC9TYWZhcmkvaSkgIT09IG51bGwgJiYKCSAgICAgICAgICAgICAgIChVQS5tYXRjaCgvQ3JpT1MvaSkgIT09IG51bGwgfHwKCSAgICAgICAgICAgICAgIHdpbmRvdy5OdW1iZXIoVUEuc3Vic3RyKFVBLmluZGV4T2YoJ09TICcpICsgMywgMykucmVwbGFjZSgnXycsICcuJykpIDwgNikpIHRoaXMudHlwZSA9ICdpb3MnOyAvLyBDaGVjayB3ZWJ2aWV3IGFuZCBuYXRpdmUgc21hcnQgYmFubmVyIHN1cHBvcnQgKGlPUyA2KykKCSAgICAgICAgfSBlbHNlIGlmIChVQS5tYXRjaCgvXGJTaWxrXC8oLipcYk1vYmlsZSBTYWZhcmlcYik/LykgfHwgVUEubWF0Y2goL1xiS0Zcdy8pIHx8IFVBLm1hdGNoKCdLaW5kbGUgRmlyZScpKSB7CgkgICAgICAgICAgICB0aGlzLnR5cGUgPSAna2luZGxlJzsKCSAgICAgICAgfSBlbHNlIGlmIChVQS5tYXRjaCgvQW5kcm9pZC9pKSAhPT0gbnVsbCkgewoJICAgICAgICAgICAgdGhpcy50eXBlID0gJ2FuZHJvaWQnOwoJICAgICAgICB9CgoJICAgICAgICAvLyBEb24ndCBzaG93IGJhbm5lciBpZiBkZXZpY2UgaXNuJ3QgaU9TIG9yIEFuZHJvaWQsIHdlYnNpdGUgaXMgbG9hZGVkIGluIGFwcCBvciB1c2VyIGRpc21pc3NlZCBiYW5uZXIKCSAgICAgICAgaWYgKCF0aGlzLnR5cGUgfHwgc3RhbmRhbG9uZSB8fCB0aGlzLmdldENvb2tpZSgnc2ItY2xvc2VkJykgfHwgdGhpcy5nZXRDb29raWUoJ3NiLWluc3RhbGxlZCcpKSB7CgkgICAgICAgICAgICByZXR1cm47CgkgICAgICAgIH0KCgkgICAgICAgIC8vIENhbGN1bGF0ZSBzY2FsZQoJICAgICAgICB0aGlzLnNjYWxlID0gdGhpcy5vcHRpb25zLnNjYWxlID09ICdhdXRvJyA/ICQod2luZG93KS53aWR0aCgpIC8gd2luZG93LnNjcmVlbi53aWR0aCA6IHRoaXMub3B0aW9ucy5zY2FsZTsKCSAgICAgICAgaWYgKHRoaXMuc2NhbGUgPCAxKSB0aGlzLnNjYWxlID0gMTsKCgkgICAgICAgIC8vIEdldCBpbmZvIGZyb20gbWV0YSBkYXRhCgkgICAgICAgIHZhciBtZXRhID0gJCh0aGlzLnR5cGUgPT0gJ2FuZHJvaWQnID8gJ21ldGFbbmFtZT0iZ29vZ2xlLXBsYXktYXBwIl0nIDoKCSAgICAgICAgICAgIHRoaXMudHlwZSA9PSAnaW9zJyA/ICdtZXRhW25hbWU9ImFwcGxlLWl0dW5lcy1hcHAiXScgOgoJICAgICAgICAgICAgdGhpcy50eXBlID09ICdraW5kbGUnID8gJ21ldGFbbmFtZT0ia2luZGxlLWZpcmUtYXBwIl0nIDogJ21ldGFbbmFtZT0ibXNBcHBsaWNhdGlvbi1JRCJdJyk7CgkgICAgICAgIGlmIChtZXRhLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwoKCSAgICAgICAgLy8gRm9yIFdpbmRvd3MgU3RvcmUgYXBwcywgZ2V0IHRoZSBQYWNrYWdlRmFtaWx5TmFtZSBmb3IgcHJvdG9jb2wgbGF1bmNoCgkgICAgICAgIGlmICh0aGlzLnR5cGUgPT0gJ3dpbmRvd3MnKSB7CgkgICAgICAgICAgICB0aGlzLmFwcElkID0gJCgnbWV0YVtuYW1lPSJtc0FwcGxpY2F0aW9uLVBhY2thZ2VGYW1pbHlOYW1lIl0nKS5hdHRyKCdjb250ZW50Jyk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAvLyBUcnkgdG8gcHVsbCB0aGUgYXBwSWQgb3V0IG9mIHRoZSBtZXRhIHRhZyBhbmQgc3RvcmUgdGhlIHJlc3VsdAoJICAgICAgICAgICAgdmFyIHBhcnNlZE1ldGFDb250ZW50ID0gL2FwcC1pZD0oW15ccyxdKykvLmV4ZWMobWV0YS5hdHRyKCdjb250ZW50JykpOwoKCSAgICAgICAgICAgIGlmKHBhcnNlZE1ldGFDb250ZW50KSB7CgkgICAgICAgICAgICAgIHRoaXMuYXBwSWQgPSBwYXJzZWRNZXRhQ29udGVudFsxXTsKCSAgICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoKCSAgICAgICAgdGhpcy50aXRsZSA9IHRoaXMub3B0aW9ucy50aXRsZSA/IHRoaXMub3B0aW9ucy50aXRsZSA6IG1ldGEuZGF0YSgndGl0bGUnKSB8fCAkKCd0aXRsZScpLnRleHQoKS5yZXBsYWNlKC9ccypbfFwtwrddLiokLywgJycpOwoJICAgICAgICB0aGlzLmF1dGhvciA9IHRoaXMub3B0aW9ucy5hdXRob3IgPyB0aGlzLm9wdGlvbnMuYXV0aG9yIDogbWV0YS5kYXRhKCdhdXRob3InKSB8fCAoJCgnbWV0YVtuYW1lPSJhdXRob3IiXScpLmxlbmd0aCA/ICQoJ21ldGFbbmFtZT0iYXV0aG9yIl0nKS5hdHRyKCdjb250ZW50JykgOiB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUpOwoJICAgICAgICB0aGlzLmljb25VcmwgPSBtZXRhLmRhdGEoJ2ljb24tdXJsJyk7CgkgICAgICAgIHRoaXMucHJpY2UgPSBtZXRhLmRhdGEoJ3ByaWNlJyk7CgoJICAgICAgICAvLyBTZXQgZGVmYXVsdCBvbkluc3RhbGwgY2FsbGJhY2sgaWYgbm90IHNldCBpbiBvcHRpb25zCgkgICAgICAgIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLm9uSW5zdGFsbCA9PT0gJ2Z1bmN0aW9uJykgewoJICAgICAgICAgICAgdGhpcy5vcHRpb25zLm9uSW5zdGFsbCA9IHRoaXMub3B0aW9ucy5vbkluc3RhbGw7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICB0aGlzLm9wdGlvbnMub25JbnN0YWxsID0gZnVuY3Rpb24gKCkge307CgkgICAgICAgIH0KCgkgICAgICAgIC8vIFNldCBkZWZhdWx0IG9uQ2xvc2UgY2FsbGJhY2sgaWYgbm90IHNldCBpbiBvcHRpb25zCgkgICAgICAgIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLm9uQ2xvc2UgPT09ICdmdW5jdGlvbicpIHsKCSAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbkNsb3NlID0gdGhpcy5vcHRpb25zLm9uQ2xvc2U7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICB0aGlzLm9wdGlvbnMub25DbG9zZSA9IGZ1bmN0aW9uICgpIHt9OwoJICAgICAgICB9CgoJICAgICAgICAvLyBDcmVhdGUgYmFubmVyCgkgICAgICAgIHRoaXMuY3JlYXRlKCk7CgkgICAgICAgIHRoaXMuc2hvdygpOwoJICAgICAgICB0aGlzLmxpc3RlbigpOwoJICAgIH07CgoJICAgIFNtYXJ0QmFubmVyLnByb3RvdHlwZSA9IHsKCgkgICAgICAgIGNvbnN0cnVjdG9yOiBTbWFydEJhbm5lcgoKCSAgICAgICwgY3JlYXRlOiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICB2YXIgaWNvblVSTDsKCSAgICAgICAgICAgIHZhciBsaW5rID0gKHRoaXMub3B0aW9ucy51cmwgPyB0aGlzLm9wdGlvbnMudXJsIDogKHRoaXMudHlwZSA9PSAnd2luZG93cycgPyAnbXMtd2luZG93cy1zdG9yZTpuYXZpZ2F0ZT9hcHBpZD0nIDogKHRoaXMudHlwZSA9PSAnYW5kcm9pZCcgPyAnbWFya2V0Oi8vZGV0YWlscz9pZD0nIDogKHRoaXMudHlwZSA9PSAna2luZGxlJyA/ICdhbXpuOi8vYXBwcy9hbmRyb2lkP2FzaW49JyA6ICdodHRwczovL2l0dW5lcy5hcHBsZS5jb20vJyArIHRoaXMub3B0aW9ucy5hcHBTdG9yZUxhbmd1YWdlICsgJy9hcHAvaWQnKSkpICsgdGhpcy5hcHBJZCk7CgkgICAgICAgICAgICB2YXIgcHJpY2UgPSB0aGlzLnByaWNlIHx8IHRoaXMub3B0aW9ucy5wcmljZTsKCSAgICAgICAgICAgIHZhciBpblN0b3JlID0gcHJpY2UgPyBwcmljZSArICcgLSAnICsgKHRoaXMudHlwZSA9PSAnYW5kcm9pZCcgPyB0aGlzLm9wdGlvbnMuaW5Hb29nbGVQbGF5IDogdGhpcy50eXBlID09ICdraW5kbGUnID8gdGhpcy5vcHRpb25zLmluQW1hem9uQXBwU3RvcmUgOiB0aGlzLnR5cGUgPT0gJ2lvcycgPyB0aGlzLm9wdGlvbnMuaW5BcHBTdG9yZSA6IHRoaXMub3B0aW9ucy5pbldpbmRvd3NTdG9yZSkgOiAnJzsKCSAgICAgICAgICAgIHZhciBnbG9zcyA9IHRoaXMub3B0aW9ucy5pY29uR2xvc3MgPT09IG51bGwgPyAodGhpcy50eXBlPT0naW9zJykgOiB0aGlzLm9wdGlvbnMuaWNvbkdsb3NzOwoKCSAgICAgICAgICAgIGlmICh0aGlzLnR5cGUgPT0gJ2FuZHJvaWQnICYmIHRoaXMub3B0aW9ucy5Hb29nbGVQbGF5UGFyYW1zKSB7CgkgICAgICAgICAgICAgIGxpbmsgPSBsaW5rICsgJyZyZWZlcnJlcj0nICsgdGhpcy5vcHRpb25zLkdvb2dsZVBsYXlQYXJhbXM7CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgdmFyIGJhbm5lciA9ICc8ZGl2IGlkPSJzbWFydGJhbm5lciIgY2xhc3M9IicgKyB0aGlzLnR5cGUgKyAnIj48ZGl2IGNsYXNzPSJzYi1jb250YWluZXIiPjxhIGhyZWY9IiMiIGNsYXNzPSJzYi1jbG9zZSI+JnRpbWVzOzwvYT48c3BhbiBjbGFzcz0ic2ItaWNvbiI+PC9zcGFuPjxkaXYgY2xhc3M9InNiLWluZm8iPjxzdHJvbmc+JyArIHRoaXMudGl0bGUgKyAnPC9zdHJvbmc+PHNwYW4+JyArIHRoaXMuYXV0aG9yICsgJzwvc3Bhbj48c3Bhbj4nICsgaW5TdG9yZSArICc8L3NwYW4+PC9kaXY+PGEgaHJlZj0iJyArIGxpbmsgKyAnIiBjbGFzcz0ic2ItYnV0dG9uIj48c3Bhbj4nICsgdGhpcy5vcHRpb25zLmJ1dHRvbiArICc8L3NwYW4+PC9hPjwvZGl2PjwvZGl2Pic7CgkgICAgICAgICAgICAodGhpcy5vcHRpb25zLmxheWVyKSA/ICQodGhpcy5vcHRpb25zLmFwcGVuZFRvU2VsZWN0b3IpLmFwcGVuZChiYW5uZXIpIDogJCh0aGlzLm9wdGlvbnMuYXBwZW5kVG9TZWxlY3RvcikucHJlcGVuZChiYW5uZXIpOwoKCSAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaWNvbikgewoJICAgICAgICAgICAgICAgIGljb25VUkwgPSB0aGlzLm9wdGlvbnMuaWNvbjsKCSAgICAgICAgICAgIH0gZWxzZSBpZih0aGlzLmljb25VcmwpIHsKCSAgICAgICAgICAgICAgICBpY29uVVJMID0gdGhpcy5pY29uVXJsOwoJICAgICAgICAgICAgfSBlbHNlIGlmICgkKCdsaW5rW3JlbD0iYXBwbGUtdG91Y2gtaWNvbi1wcmVjb21wb3NlZCJdJykubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgIGljb25VUkwgPSAkKCdsaW5rW3JlbD0iYXBwbGUtdG91Y2gtaWNvbi1wcmVjb21wb3NlZCJdJykuYXR0cignaHJlZicpOwoJICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaWNvbkdsb3NzID09PSBudWxsKSBnbG9zcyA9IGZhbHNlOwoJICAgICAgICAgICAgfSBlbHNlIGlmICgkKCdsaW5rW3JlbD0iYXBwbGUtdG91Y2gtaWNvbiJdJykubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgIGljb25VUkwgPSAkKCdsaW5rW3JlbD0iYXBwbGUtdG91Y2gtaWNvbiJdJykuYXR0cignaHJlZicpOwoJICAgICAgICAgICAgfSBlbHNlIGlmICgkKCdtZXRhW25hbWU9Im1zQXBwbGljYXRpb24tVGlsZUltYWdlIl0nKS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAgIGljb25VUkwgPSAkKCdtZXRhW25hbWU9Im1zQXBwbGljYXRpb24tVGlsZUltYWdlIl0nKS5hdHRyKCdjb250ZW50Jyk7CgkgICAgICAgICAgICB9IGVsc2UgaWYgKCQoJ21ldGFbbmFtZT0ibXNhcHBsaWNhdGlvbi1UaWxlSW1hZ2UiXScpLmxlbmd0aCA+IDApIHsgLyogcmVkdW5kYW50IGJlY2F1c2UgbXMgZG9jcyBzaG93IHR3byBjYXNlIHVzYWdlcyAqLwoJICAgICAgICAgICAgICBpY29uVVJMID0gJCgnbWV0YVtuYW1lPSJtc2FwcGxpY2F0aW9uLVRpbGVJbWFnZSJdJykuYXR0cignY29udGVudCcpOwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIGlmIChpY29uVVJMKSB7CgkgICAgICAgICAgICAgICAgJCgnI3NtYXJ0YmFubmVyIC5zYi1pY29uJykuY3NzKCdiYWNrZ3JvdW5kLWltYWdlJywndXJsKCcgKyBpY29uVVJMICsgJyknKTsKCSAgICAgICAgICAgICAgICBpZiAoZ2xvc3MpICQoJyNzbWFydGJhbm5lciAuc2ItaWNvbicpLmFkZENsYXNzKCdnbG9zcycpOwoJICAgICAgICAgICAgfSBlbHNlewoJICAgICAgICAgICAgICAgICQoJyNzbWFydGJhbm5lcicpLmFkZENsYXNzKCduby1pY29uJyk7CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgdGhpcy5iYW5uZXJIZWlnaHQgPSAkKCcjc21hcnRiYW5uZXInKS5vdXRlckhlaWdodCgpICsgMjsKCgkgICAgICAgICAgICBpZiAodGhpcy5zY2FsZSA+IDEpIHsKCSAgICAgICAgICAgICAgICAkKCcjc21hcnRiYW5uZXInKQoJICAgICAgICAgICAgICAgICAgICAuY3NzKCd0b3AnLCBwYXJzZUZsb2F0KCQoJyNzbWFydGJhbm5lcicpLmNzcygndG9wJykpICogdGhpcy5zY2FsZSkKCSAgICAgICAgICAgICAgICAgICAgLmNzcygnaGVpZ2h0JywgcGFyc2VGbG9hdCgkKCcjc21hcnRiYW5uZXInKS5jc3MoJ2hlaWdodCcpKSAqIHRoaXMuc2NhbGUpCgkgICAgICAgICAgICAgICAgICAgIC5oaWRlKCk7CgkgICAgICAgICAgICAgICAgJCgnI3NtYXJ0YmFubmVyIC5zYi1jb250YWluZXInKQoJICAgICAgICAgICAgICAgICAgICAuY3NzKCctd2Via2l0LXRyYW5zZm9ybScsICdzY2FsZSgnICsgdGhpcy5zY2FsZSArICcpJykKCSAgICAgICAgICAgICAgICAgICAgLmNzcygnLW1zaWUtdHJhbnNmb3JtJywgJ3NjYWxlKCcgKyB0aGlzLnNjYWxlICsgJyknKQoJICAgICAgICAgICAgICAgICAgICAuY3NzKCctbW96LXRyYW5zZm9ybScsICdzY2FsZSgnICsgdGhpcy5zY2FsZSArICcpJykKCSAgICAgICAgICAgICAgICAgICAgLmNzcygnd2lkdGgnLCAkKHdpbmRvdykud2lkdGgoKSAvIHRoaXMuc2NhbGUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgJCgnI3NtYXJ0YmFubmVyJykuY3NzKCdwb3NpdGlvbicsICh0aGlzLm9wdGlvbnMubGF5ZXIpID8gJ2Fic29sdXRlJyA6ICdzdGF0aWMnKTsKCSAgICAgICAgfQoKCSAgICAgICwgbGlzdGVuOiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICAkKCcjc21hcnRiYW5uZXIgLnNiLWNsb3NlJykub24oJ2NsaWNrJywkLnByb3h5KHRoaXMuY2xvc2UsIHRoaXMpKTsKCSAgICAgICAgICAgICQoJyNzbWFydGJhbm5lciAuc2ItYnV0dG9uJykub24oJ2NsaWNrJywkLnByb3h5KHRoaXMuaW5zdGFsbCwgdGhpcykpOwoJICAgICAgICB9CgoJICAgICAgLCBzaG93OiBmdW5jdGlvbiAoY2FsbGJhY2spIHsKCSAgICAgICAgICAgIHZhciBiYW5uZXIgPSAkKCcjc21hcnRiYW5uZXInKTsKCSAgICAgICAgICAgIGJhbm5lci5zdG9wKCk7CgoJICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5sYXllcikgewoJICAgICAgICAgICAgICAgIGJhbm5lci5hbmltYXRlKHt0b3A6IDAsIGRpc3BsYXk6ICdibG9jayd9LCB0aGlzLm9wdGlvbnMuc3BlZWRJbikuYWRkQ2xhc3MoJ3Nob3duJykuc2hvdygpOwoJICAgICAgICAgICAgICAgICQodGhpcy5wdXNoU2VsZWN0b3IpLmFuaW1hdGUoe3BhZGRpbmdUb3A6IHRoaXMub3JpZ0h0bWxNYXJnaW4gKyAodGhpcy5iYW5uZXJIZWlnaHQgKiB0aGlzLnNjYWxlKX0sIHRoaXMub3B0aW9ucy5zcGVlZEluLCAnc3dpbmcnLCBjYWxsYmFjayk7CgkgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgIGlmICgkLnN1cHBvcnQudHJhbnNpdGlvbikgewoJICAgICAgICAgICAgICAgICAgICBiYW5uZXIuYW5pbWF0ZSh7dG9wOjB9LHRoaXMub3B0aW9ucy5zcGVlZEluKS5hZGRDbGFzcygnc2hvd24nKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zaXRpb25DYWxsYmFjayA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICQoJ2h0bWwnKS5yZW1vdmVDbGFzcygnc2ItYW5pbWF0aW9uJyk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9OwoJICAgICAgICAgICAgICAgICAgICAkKHRoaXMucHVzaFNlbGVjdG9yKS5hZGRDbGFzcygnc2ItYW5pbWF0aW9uJykub25lKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCwgdHJhbnNpdGlvbkNhbGxiYWNrKS5lbXVsYXRlVHJhbnNpdGlvbkVuZCh0aGlzLm9wdGlvbnMuc3BlZWRJbikuY3NzKCdtYXJnaW4tdG9wJywgdGhpcy5vcmlnSHRtbE1hcmdpbiArICh0aGlzLmJhbm5lckhlaWdodCAqIHRoaXMuc2NhbGUpKTsKCSAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICBiYW5uZXIuc2xpZGVEb3duKHRoaXMub3B0aW9ucy5zcGVlZEluKS5hZGRDbGFzcygnc2hvd24nKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCgkgICAgICAsIGhpZGU6IGZ1bmN0aW9uIChjYWxsYmFjaykgewoJICAgICAgICAgICAgdmFyIGJhbm5lciA9ICQoJyNzbWFydGJhbm5lcicpOwoJICAgICAgICAgICAgYmFubmVyLnN0b3AoKTsKCgkgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmxheWVyKSB7CgkgICAgICAgICAgICAgICAgYmFubmVyLmFuaW1hdGUoe3RvcDogLTEgKiB0aGlzLmJhbm5lckhlaWdodCAqIHRoaXMuc2NhbGUsIGRpc3BsYXk6ICdibG9jayd9LCB0aGlzLm9wdGlvbnMuc3BlZWRJbikucmVtb3ZlQ2xhc3MoJ3Nob3duJyk7CgkgICAgICAgICAgICAgICAgJCh0aGlzLnB1c2hTZWxlY3RvcikuYW5pbWF0ZSh7cGFkZGluZ1RvcDogdGhpcy5vcmlnSHRtbE1hcmdpbn0sIHRoaXMub3B0aW9ucy5zcGVlZEluLCAnc3dpbmcnLCBjYWxsYmFjayk7CgkgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgIGlmICgkLnN1cHBvcnQudHJhbnNpdGlvbikgewoJICAgICAgICAgICAgICAgICAgICBpZiAoIHRoaXMudHlwZSAhPT0gJ2FuZHJvaWQnICkKCSAgICAgICAgICAgICAgICAgICAgICBiYW5uZXIuY3NzKCd0b3AnLCAtMSAqIHRoaXMuYmFubmVySGVpZ2h0ICogdGhpcy5zY2FsZSkucmVtb3ZlQ2xhc3MoJ3Nob3duJyk7CgkgICAgICAgICAgICAgICAgICAgIGVsc2UKCSAgICAgICAgICAgICAgICAgICAgICBiYW5uZXIuY3NzKHtkaXNwbGF5Oidub25lJ30pLnJlbW92ZUNsYXNzKCdzaG93bicpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNpdGlvbkNhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgJCgnaHRtbCcpLnJlbW92ZUNsYXNzKCdzYi1hbmltYXRpb24nKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH07CgkgICAgICAgICAgICAgICAgICAgICQodGhpcy5wdXNoU2VsZWN0b3IpLmFkZENsYXNzKCdzYi1hbmltYXRpb24nKS5vbmUoJC5zdXBwb3J0LnRyYW5zaXRpb24uZW5kLCB0cmFuc2l0aW9uQ2FsbGJhY2spLmVtdWxhdGVUcmFuc2l0aW9uRW5kKHRoaXMub3B0aW9ucy5zcGVlZE91dCkuY3NzKCdtYXJnaW4tdG9wJywgdGhpcy5vcmlnSHRtbE1hcmdpbik7CgkgICAgICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgYmFubmVyLnNsaWRlVXAodGhpcy5vcHRpb25zLnNwZWVkT3V0KS5yZW1vdmVDbGFzcygnc2hvd24nKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCgkgICAgICAsIGNsb3NlOiBmdW5jdGlvbiAoZSkgewoJICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoJICAgICAgICAgICAgdGhpcy5oaWRlKCk7CgkgICAgICAgICAgICB0aGlzLnNldENvb2tpZSgnc2ItY2xvc2VkJywndHJ1ZScsdGhpcy5vcHRpb25zLmRheXNIaWRkZW4pOwoJICAgICAgICAgICAgdGhpcy5vcHRpb25zLm9uQ2xvc2UoZSk7CgkgICAgICAgIH0KCgkgICAgICAsIGluc3RhbGw6IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmhpZGVPbkluc3RhbGwpIHsKCSAgICAgICAgICAgICAgICB0aGlzLmhpZGUoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHRoaXMuc2V0Q29va2llKCdzYi1pbnN0YWxsZWQnLCd0cnVlJyx0aGlzLm9wdGlvbnMuZGF5c1JlbWluZGVyKTsKCSAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbkluc3RhbGwoZSk7CgkgICAgICAgIH0KCgkgICAgICAsIHNldENvb2tpZTogZnVuY3Rpb24gKG5hbWUsIHZhbHVlLCBleGRheXMpIHsKCSAgICAgICAgICAgIHZhciBleGRhdGUgPSBuZXcgRGF0ZSgpOwoJICAgICAgICAgICAgZXhkYXRlLnNldERhdGUoZXhkYXRlLmdldERhdGUoKSArIGV4ZGF5cyk7CgkgICAgICAgICAgICB2YWx1ZSA9IGVuY29kZVVSSSh2YWx1ZSkgKyAoKGV4ZGF5cyA9PT0gbnVsbCkgPyAnJyA6ICc7IGV4cGlyZXM9JyArIGV4ZGF0ZS50b1VUQ1N0cmluZygpKTsKCSAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IG5hbWUgKyAnPScgKyB2YWx1ZSArICc7IHBhdGg9LzsnOwoJICAgICAgICB9CgoJICAgICAgLCBnZXRDb29raWU6IGZ1bmN0aW9uIChuYW1lKSB7CgkgICAgICAgICAgICB2YXIgaSx4LHksQVJSY29va2llcyA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgiOyIpOwoJICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IEFSUmNvb2tpZXMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgICAgICB4ID0gQVJSY29va2llc1tpXS5zdWJzdHIoMCxBUlJjb29raWVzW2ldLmluZGV4T2YoIj0iKSk7CgkgICAgICAgICAgICAgICAgeSA9IEFSUmNvb2tpZXNbaV0uc3Vic3RyKEFSUmNvb2tpZXNbaV0uaW5kZXhPZigiPSIpICsgMSk7CgkgICAgICAgICAgICAgICAgeCA9IHgucmVwbGFjZSgvXlxzK3xccyskL2csIiIpOwoJICAgICAgICAgICAgICAgIGlmICh4ID09IG5hbWUpIHsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSSh5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoKCSAgICAgIC8vIERlbW8gb25seQoJICAgICAgLCBzd2l0Y2hUeXBlOiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzOwoKCSAgICAgICAgICB0aGlzLmhpZGUoZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgICB0aGF0LnR5cGUgPSB0aGF0LnR5cGUgPT0gJ2FuZHJvaWQnID8gJ2lvcycgOiAnYW5kcm9pZCc7CgkgICAgICAgICAgICAgIHZhciBtZXRhID0gJCh0aGF0LnR5cGUgPT0gJ2FuZHJvaWQnID8gJ21ldGFbbmFtZT0iZ29vZ2xlLXBsYXktYXBwIl0nIDogJ21ldGFbbmFtZT0iYXBwbGUtaXR1bmVzLWFwcCJdJykuYXR0cignY29udGVudCcpOwoJICAgICAgICAgICAgICB0aGF0LmFwcElkID0gL2FwcC1pZD0oW15ccyxdKykvLmV4ZWMobWV0YSlbMV07CgoJICAgICAgICAgICAgICAkKCcjc21hcnRiYW5uZXInKS5kZXRhY2goKTsKCSAgICAgICAgICAgICAgdGhhdC5jcmVhdGUoKTsKCSAgICAgICAgICAgICAgdGhhdC5zaG93KCk7CgkgICAgICAgICAgfSk7CgkgICAgICB9CgkgICAgfTsKCgkgICAgJC5zbWFydGJhbm5lciA9IGZ1bmN0aW9uIChvcHRpb24pIHsKCSAgICAgICAgdmFyICR3aW5kb3cgPSAkKHdpbmRvdyk7CgkgICAgICAgIHZhciBkYXRhID0gJHdpbmRvdy5kYXRhKCdzbWFydGJhbm5lcicpOwoJICAgICAgICB2YXIgb3B0aW9ucyA9IHR5cGVvZiBvcHRpb24gPT0gJ29iamVjdCcgJiYgb3B0aW9uOwoJICAgICAgICBpZiAoIWRhdGEpICR3aW5kb3cuZGF0YSgnc21hcnRiYW5uZXInLCAoZGF0YSA9IG5ldyBTbWFydEJhbm5lcihvcHRpb25zKSkpOwoJICAgICAgICBpZiAodHlwZW9mIG9wdGlvbiA9PSAnc3RyaW5nJykgZGF0YVtvcHRpb25dKCk7CgkgICAgfTsKCgkgICAgLy8gb3ZlcnJpZGUgdGhlc2UgZ2xvYmFsbHkgaWYgeW91IGxpa2UgKHRoZXkgYXJlIGFsbCBvcHRpb25hbCkKCSAgICAkLnNtYXJ0YmFubmVyLmRlZmF1bHRzID0gewoJICAgICAgICB0aXRsZTogbnVsbCwgLy8gV2hhdCB0aGUgdGl0bGUgb2YgdGhlIGFwcCBzaG91bGQgYmUgaW4gdGhlIGJhbm5lciAoZGVmYXVsdHMgdG8gPHRpdGxlPikKCSAgICAgICAgYXV0aG9yOiBudWxsLCAvLyBXaGF0IHRoZSBhdXRob3Igb2YgdGhlIGFwcCBzaG91bGQgYmUgaW4gdGhlIGJhbm5lciAoZGVmYXVsdHMgdG8gPG1ldGEgbmFtZT0iYXV0aG9yIj4gb3IgaG9zdG5hbWUpCgkgICAgICAgIHByaWNlOiAnRlJFRScsIC8vIFByaWNlIG9mIHRoZSBhcHAKCSAgICAgICAgYXBwU3RvcmVMYW5ndWFnZTogJ3VzJywgLy8gTGFuZ3VhZ2UgY29kZSBmb3IgQXBwIFN0b3JlCgkgICAgICAgIGluQXBwU3RvcmU6ICdPbiB0aGUgQXBwIFN0b3JlJywgLy8gVGV4dCBvZiBwcmljZSBmb3IgaU9TCgkgICAgICAgIGluR29vZ2xlUGxheTogJ0luIEdvb2dsZSBQbGF5JywgLy8gVGV4dCBvZiBwcmljZSBmb3IgQW5kcm9pZAoJICAgICAgICBpbkFtYXpvbkFwcFN0b3JlOiAnSW4gdGhlIEFtYXpvbiBBcHBzdG9yZScsCgkgICAgICAgIGluV2luZG93c1N0b3JlOiAnSW4gdGhlIFdpbmRvd3MgU3RvcmUnLCAvL1RleHQgb2YgcHJpY2UgZm9yIFdpbmRvd3MKCSAgICAgICAgR29vZ2xlUGxheVBhcmFtczogbnVsbCwgLy8gQWRpdGlvbmFsIHBhcmFtZXRlcnMgZm9yIHRoZSBtYXJrZXQKCSAgICAgICAgaWNvbjogbnVsbCwgLy8gVGhlIFVSTCBvZiB0aGUgaWNvbiAoZGVmYXVsdHMgdG8gPG1ldGEgbmFtZT0iYXBwbGUtdG91Y2gtaWNvbiI+KQoJICAgICAgICBpY29uR2xvc3M6IG51bGwsIC8vIEZvcmNlIGdsb3NzIGVmZmVjdCBmb3IgaU9TIGV2ZW4gZm9yIHByZWNvbXBvc2VkCgkgICAgICAgIGJ1dHRvbjogJ1ZJRVcnLCAvLyBUZXh0IGZvciB0aGUgaW5zdGFsbCBidXR0b24KCSAgICAgICAgdXJsOiBudWxsLCAvLyBUaGUgVVJMIGZvciB0aGUgYnV0dG9uLiBLZWVwIG51bGwgaWYgeW91IHdhbnQgdGhlIGJ1dHRvbiB0byBsaW5rIHRvIHRoZSBhcHAgc3RvcmUuCgkgICAgICAgIHNjYWxlOiAnYXV0bycsIC8vIFNjYWxlIGJhc2VkIG9uIHZpZXdwb3J0IHNpemUgKHNldCB0byAxIHRvIGRpc2FibGUpCgkgICAgICAgIHNwZWVkSW46IDMwMCwgLy8gU2hvdyBhbmltYXRpb24gc3BlZWQgb2YgdGhlIGJhbm5lcgoJICAgICAgICBzcGVlZE91dDogNDAwLCAvLyBDbG9zZSBhbmltYXRpb24gc3BlZWQgb2YgdGhlIGJhbm5lcgoJICAgICAgICBkYXlzSGlkZGVuOiAxNSwgLy8gRHVyYXRpb24gdG8gaGlkZSB0aGUgYmFubmVyIGFmdGVyIGJlaW5nIGNsb3NlZCAoMCA9IGFsd2F5cyBzaG93IGJhbm5lcikKCSAgICAgICAgZGF5c1JlbWluZGVyOiA5MCwgLy8gRHVyYXRpb24gdG8gaGlkZSB0aGUgYmFubmVyIGFmdGVyICJWSUVXIiBpcyBjbGlja2VkICpzZXBhcmF0ZSBmcm9tIHdoZW4gdGhlIGNsb3NlIGJ1dHRvbiBpcyBjbGlja2VkKiAoMCA9IGFsd2F5cyBzaG93IGJhbm5lcikKCSAgICAgICAgZm9yY2U6IG51bGwsIC8vIENob29zZSAnaW9zJywgJ2FuZHJvaWQnIG9yICd3aW5kb3dzJy4gRG9uJ3QgZG8gYSBicm93c2VyIGNoZWNrLCBqdXN0IGFsd2F5cyBzaG93IHRoaXMgYmFubmVyCgkgICAgICAgIGhpZGVPbkluc3RhbGw6IHRydWUsIC8vIEhpZGUgdGhlIGJhbm5lciBhZnRlciAiVklFVyIgaXMgY2xpY2tlZC4KCSAgICAgICAgbGF5ZXI6IGZhbHNlLCAvLyBEaXNwbGF5IGFzIG92ZXJsYXkgbGF5ZXIgb3Igc2xpZGUgZG93biB0aGUgcGFnZQoJICAgICAgICBpT1NVbml2ZXJzYWxBcHA6IHRydWUsIC8vIElmIHRoZSBpT1MgQXBwIGlzIGEgdW5pdmVyc2FsIGFwcCBmb3IgYm90aCBpUGFkIGFuZCBpUGhvbmUsIGRpc3BsYXkgU21hcnQgQmFubmVyIHRvIGlQYWQgdXNlcnMsIHRvby4KCSAgICAgICAgYXBwZW5kVG9TZWxlY3RvcjogJ2JvZHknLCAvL0FwcGVuZCB0aGUgYmFubmVyIHRvIGEgc3BlY2lmaWMgc2VsZWN0b3IKCSAgICAgICAgcHVzaFNlbGVjdG9yOiAnaHRtbCcgLy8gV2hhdCBlbGVtZW50IGlzIGdvaW5nIHRvIHB1c2ggdGhlIHNpdGUgY29udGVudCBkb3duOyB0aGlzIGlzIHdoZXJlIHRoZSBiYW5uZXIgYXBwZW5kIGFuaW1hdGlvbiB3aWxsIHN0YXJ0LgoJICAgIH07CgoJICAgICQuc21hcnRiYW5uZXIuQ29uc3RydWN0b3IgPSBTbWFydEJhbm5lcjsKCgoJICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICAgIC8vIEJvb3RzdHJhcCB0cmFuc2l0aW9uCgkgICAgLy8gQ29weXJpZ2h0IDIwMTEtMjAxNCBUd2l0dGVyLCBJbmMuCgkgICAgLy8gTGljZW5zZWQgdW5kZXIgTUlUIChodHRwczovL2dpdGh1Yi5jb20vdHdicy9ib290c3RyYXAvYmxvYi9tYXN0ZXIvTElDRU5TRSkKCgkgICAgZnVuY3Rpb24gdHJhbnNpdGlvbkVuZCAoKSB7CgkgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NtYXJ0YmFubmVyJyk7CgoJICAgICAgICB2YXIgdHJhbnNFbmRFdmVudE5hbWVzID0gewoJICAgICAgICAgICAgV2Via2l0VHJhbnNpdGlvbjogJ3dlYmtpdFRyYW5zaXRpb25FbmQnLAoJICAgICAgICAgICAgTW96VHJhbnNpdGlvbjogJ3RyYW5zaXRpb25lbmQnLAoJICAgICAgICAgICAgT1RyYW5zaXRpb246ICdvVHJhbnNpdGlvbkVuZCBvdHJhbnNpdGlvbmVuZCcsCgkgICAgICAgICAgICB0cmFuc2l0aW9uOiAndHJhbnNpdGlvbmVuZCcKCSAgICAgICAgfTsKCgkgICAgICAgIGZvciAodmFyIG5hbWUgaW4gdHJhbnNFbmRFdmVudE5hbWVzKSB7CgkgICAgICAgICAgICBpZiAoZWwuc3R5bGVbbmFtZV0gIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgIHJldHVybiB7ZW5kOiB0cmFuc0VuZEV2ZW50TmFtZXNbbmFtZV19OwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgoJICAgICAgICByZXR1cm4gZmFsc2U7IC8vIGV4cGxpY2l0IGZvciBpZTggKCAgLl8uKQoJICAgIH0KCgkgICAgaWYgKCQuc3VwcG9ydC50cmFuc2l0aW9uICE9PSB1bmRlZmluZWQpCgkgICAgICAgIHJldHVybjsgLy8gUHJldmVudCBjb25mbGljdCB3aXRoIFR3aXR0ZXIgQm9vdHN0cmFwCgoJICAgIC8vIGh0dHA6Ly9ibG9nLmFsZXhtYWNjYXcuY29tL2Nzcy10cmFuc2l0aW9ucwoJICAgICQuZm4uZW11bGF0ZVRyYW5zaXRpb25FbmQgPSBmdW5jdGlvbiAoZHVyYXRpb24pIHsKCSAgICAgICAgdmFyIGNhbGxlZCA9IGZhbHNlLCAkZWwgPSB0aGlzOwoJICAgICAgICAkKHRoaXMpLm9uZSgkLnN1cHBvcnQudHJhbnNpdGlvbi5lbmQsIGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGNhbGxlZCA9IHRydWU7CgkgICAgICAgIH0pOwoJICAgICAgICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAoIWNhbGxlZCkgJCgkZWwpLnRyaWdnZXIoJC5zdXBwb3J0LnRyYW5zaXRpb24uZW5kKTsKCSAgICAgICAgfTsKCSAgICAgICAgc2V0VGltZW91dChjYWxsYmFjaywgZHVyYXRpb24pOwoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoKCSAgICAkKGZ1bmN0aW9uICgpIHsKCSAgICAgICAgJC5zdXBwb3J0LnRyYW5zaXRpb24gPSB0cmFuc2l0aW9uRW5kKCk7CgkgICAgfSk7CgkgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgoJfSk7CgoKLyoqKi8gfQovKioqKioqLyBdKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWFpbi1sb2dpbnBhZ2UucGFjay5qcy5tYXA=", "base64"));
  res.end();

  return __filename;
};
